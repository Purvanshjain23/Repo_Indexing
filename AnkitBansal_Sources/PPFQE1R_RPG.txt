     H/TITLE Edt Company Item Spc  ER  Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/28/22  Time  : 11:53:07
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPPFQE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Company Item Spc  ER  Edit record(1 screen)
      *
     FCABZREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Company Item              Retrieval index       NV
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPOARREL4IF  E           K        DISK
      * RSQ : Packaging Item            Co/Item Code
      *
     FPOCAREL1IF  E           K        DISK
      * RTV : Packaging Type            Retrieval index
      *
     FPMFDREL2IF  E           K        DISK
      * RSQ : Company Item Ext          RTV, select Active
      *
     FPDKNCPL4IF  E           K        DISK
      * RSQ : Order Detail Schedule     Co/Itm/Whs/PDte
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FPDJIREL0IF  E           K        DISK
      * RTV : Item Category             Retrieval index
      *
     FPBBFREL1IF  E           K        DISK
      * RTV : PS Production Capacity    Retrieval index
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAB0RELLIF  E           K        DISK
      * RSQ : Item Balance              Item Only
      *
     FOMFZREL0IF  E           K        DISK
      * RTV : Commodity Group           Retrieval index
      *
     FPDJIREL2IF  E           K        DISK
      * RSQ : Item Category             Item/co
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPDI5REL6IF  E           K        DISK
      * RSQ : PS Production Department  Department/Co
      *
     FCAAMREL3IF  E           K        DISK
      * RTV : Unit of Measure           Active Records
      *
     FCAAIREL3IF  E           K        DISK
      * RTV : Quality Level             Active Only
      *
     FPDILREL3IF  E           K        DISK
      * RTV : Item Level                Active Only
      *
     FCABJREL5IF  E           K        DISK
      * RTV : Vendor                    Retrieve Active Records
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FOMFZREL2IF  E           K        DISK
      * RTV : Commodity Group           Active Only
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : Price Method Header       Retrieval index
      *
     FPDI5REL1IF  E           K        DISK
      * RTV : PS Production Department  Retrieval index
      *
     FPDJGREL1IF  E           K        DISK
      * RTV : Item Category Packaging   Retrieval index
      *
     FPMG1REL0IF  E           K        DISK
      * RTV : PM R/M Type Master        Retrieval index
      *
     FPMG2REL1IF  E           K        DISK
      * RTV : PM Line Master            Retrieval index
      *
     FPDLLREL1IF  E           K        DISK
      * RTV : PS Primal Group           Retrieval index
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCABZREL0UF  E           K        DISK
      * UPD : Company Item              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    #L7         7  1
     E                    AR1        30  1               ARRAY 2
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 040  5 0A
     E                    W1END   7 040  5 0A
     E                    W1NAM   7 040 10
      * Long constants
     E                    @CN#    1  12  6   @CN    25
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WAAIC3
     I              ABADTX                          WAADTX
     I              ABACNA                          WAACNA
     I              ABADNA                          WAADNA
     I              ABAENA                          WAAENA
     I              ABAJNA                          WAAJNA
     I              ABBTTX                          WABTTX
     I              ABBVTX                          WABVTX
     I              ABBWTX                          WABWTX
     I              ABA2NA                          WAA2NA
     I              ABABTX                          WAABTX
     I              ABBGCD                          WABGCD
     I              ABKXCD                          WAKXCD
     I              ABUVST                          WAUVST
     I              ABUWST                          WAUWST
     I              ABUXST                          WAUXST
     I              ABVSST                          WAVSST
     I              ABAATM                          WAAATM
     I              ABAYNA                          WAAYNA
     I              ABA0NA                          WAA0NA
     I              ABAXDT                          WAAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@JIREU7
      * Item Category             Item/co
      * Renamed input format fields
     I              JIAIC3                          WCAIC3
     I              JIUSNB                          WCUSNB
     I              JISLCD                          WCSLCD
     I              JIAUNA                          WCAUNA
     I              JIOHNX                          WCOHNX
     I              JICNAA                          WCCNAA
     I              JIUVST                          WCUVST
     I              JIUWST                          WCUWST
     I              JIUXST                          WCUXST
     I              JIVSST                          WCVSST
     I              JIAATM                          WCAATM
     I              JIAYNA                          WCAYNA
     I              JIA0NA                          WCA0NA
     I              JIAXDT                          WCAXDT
      *
     I@FZREVP
      * Commodity Group           Active Only
      * Renamed input format fields
     I              FZLRCD                          WDLRCD
     I              FZJ4NA                          WDJ4NA
     I              FZAICD                          WDAICD
     I              FZUVST                          WDUVST
     I              FZUWST                          WDUWST
     I              FZUXST                          WDUXST
     I              FZVSST                          WDVSST
     I              FZAATM                          WDAATM
     I              FZAYNA                          WDAYNA
     I              FZA0NA                          WDA0NA
     I              FZAXDT                          WDAXDT
      *
     I@I5REUJ
      * PS Production Department  Retrieval index
      * Renamed input format fields
     I              I5AIC3                          WEAIC3
     I              I5R3CD                          WER3CD
     I              I5MYNA                          WEMYNA
     I              I5DPT1                          WEDPT1
     I              I5UVST                          WEUVST
     I              I5UWST                          WEUWST
     I              I5UXST                          WEUXST
     I              I5VSST                          WEVSST
     I              I5AATM                          WEAATM
     I              I5AYNA                          WEAYNA
     I              I5A0NA                          WEA0NA
     I              I5AXDT                          WEAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSCABZREL0
      * UPD : Company Item              Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            605
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     IYARDCS      DS                            605
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item
      * B : RST Company Number
     I                                    P   1   20P1AIC3
      * B : RST Item Code
     I                                    P   3   60P1HGCD
      * N :  Description Line One
     I                                        7  36 P1AVNA
      * N :  Description Line Two
     I                                       37  66 P1AWNA
      * N :  Item Label Line 1
     I                                       67  98 P1L7NA
      * N :  Item Label Line 2
     I                                       99 130 P1L8NA
      * N :  Item Label Line 3
     I                                      131 162 P1L6NA
      * N :  Item Label Line 4
     I                                      163 194 P1MFNA
      * N :  U/M - Primary
     I                                      195 196 P1ADCD
      * N :  Conversion Factor 1
     I                                    P 197 2014P1AWPC
      * N :  Operation Factor 1
     I                                      202 202 P1LXST
      * N :  U/M - Second
     I                                      203 204 P1AECD
      * N :  Conversion Factor 2
     I                                    P 205 2094P1AXPC
      * N :  Operation Factor 2
     I                                      210 210 P1LYST
      * N :  U/M - Third
     I                                      211 212 P1AFCD
      * N :  U/M - Pricing
     I                                      213 214 P1AICD
      * N :  Unit Weight
     I                                    P 215 2202P1AIWG
      * N :  Quality Level
     I                                      221 222 P1HICD
      * N :  Item Level
     I                                      223 224 P1RBCD
      * N :  Production Date Control
     I                                      225 225 P1FZST
      * N :  Catch Weight Status
     I                                      226 226 P1AVST
      * N :  Minimum Weight Per Case
     I                                    P 227 2322P1CZWG
      * N :  Maximum Weight Per Case
     I                                    P 233 2382P1C0WG
      * N :  Number Cases On A Pallet
     I                                    P 239 2410P1URTN
      * N :  Vendor - Item Default
     I                                    P 242 2460P1AJC8
      * N :  Item Structure Class Code
     I                                    P 247 2480P1RINB
      * N :  Item Structure Group Code
     I                                    P 249 2500P1RHNB
      * N :  Item Structure Type Code
     I                                    P 251 2520P1RGNB
      * N :  Default Commod Mark basis
     I                                      253 255 P1LNCD
      * N :  Transportation Temp
     I                                    P 256 2570P1TFNB
      * N :  Item Type Code
     I                                      258 260 P1N0CD
      * N :  Package Type Code
     I                                      261 261 P1X4ST
      * N :  Maximum Audit Value
     I                                    P 262 2672P1TMVA
      * N :  Minimum Audit Value
     I                                    P 268 2732P1TNVA
      * N :  Market Overage
     I                                    P 274 2794P1BLPR
      * N :  Standard Overage/Underage
     I                                    P 280 2854P1BMPR
      * N :  Commodity Price Group
     I                                      286 292 P1LRCD
      * N :  Item Pricing Operation
     I                                      293 293 P1U9ST
      * N :  Item Pricing Constant
     I                                    P 294 2994P1CMCO
      * N :  Default Warehouse
     I                                      300 302 P1Q1CD
      * N :  Price Method Default
     I                                      303 305 P1Q8CD
      * N :  Fresh Chilling Time
     I                                    P 306 3082P1CHTM
      * N :  Base/Conv/Loss Item
     I                                      309 310 P1QZCD
      * N :  Variety/Rendered/Cut
     I                                      311 311 P1XWST
      * N :  Frozen Make to Order Sts
     I                                      312 312 P1XXST
      * N :  Credit Item Status
     I                                      313 313 P1VMST
      * N :  Std Weight/Head (Var/Ren)
     I                                    P 314 3192P1SWGH
      * N :  Pieces Per Head
     I                                    P 320 3230P1PPHE
      * N :  Department Code
     I                                      324 329 P1R3CD
      * N :  Group for Packaging
     I                                      330 330 P1SDCD
      * N :  Item Category Number 1
     I                                    P 331 3320P1ICN1
      * N :  MTO Code
     I                                      333 335 P1SVCD
      * N :  Item Category Number 2
     I                                    P 336 3370P1ICN2
      * N :  Transp Equip Type
     I                                      338 340 P1SWCD
      * N :  Item Category Number 3
     I                                    P 341 3420P1V2NB
      * N :  Item Category Code 3
     I                                      343 345 P1SXCD
      * N :  Item Category Number 4
     I                                    P 346 3470P1ITCN
      * N :  G/L Sub Code
     I                                      348 350 P1SYCD
      * N :  Item Category Number 5
     I                                    P 351 3520P1ITC5
      * N :  Item Structure Sub Class
     I                                      353 355 P1SZCD
      * N :  Item Category Number 6
     I                                    P 356 3570P1ICN6
      * N :  Item Primal Sched Report
     I                                      358 360 P1S0CD
      * N :  Item Category Number 7
     I                                    P 361 3620P1ICN7
      * N :  Item Exc Man Prc Excp
     I                                      363 365 P1S1CD
      * N :  Item Category Number 8
     I                                    P 366 3670P1ICN8
      * N :  Item Prod Sched Send PFS
     I                                      368 370 P1S2CD
      * N :  Item Category Number 9
     I                                    P 371 3720P1ICN9
      * N :  Item Category Code 9
     I                                      373 375 P1S3CD
      * N :  Item Category Number 10
     I                                    P 376 3770P1ICN0
      * N :  Item Category Code 10
     I                                      378 380 P1S4CD
      * N :  Pallet Tare Weight
     I                                    P 381 3832P1SFNB
      * N :  Misc Tare Weight
     I                                    P 384 3862P1A3WG
      * N :  Production Lead Days
     I                                    P 387 3880P1SJNB
      * N :  Packaging Code
     I                                      389 391 P1LLCD
      * N :  Item Market Code
     I                                      392 394 P1LMCD
      * N :  TF Co-Ownership Sts
     I                                      395 395 P1P3ST
      * N :  Agrimetrics group
     I                                    P 396 3970P1SKNB
      * N :  Agrimetrics pack
     I                                    P 398 3980P1SLNB
      * N :  Agrimetrics grade
     I                                    P 399 4000P1SMNB
      * N :  PA Base Avail Rpt Include
     I                                      401 401 P1P4ST
      * N :  PM Pounds per Hour
     I                                    P 402 4074P1CFNB
      * N :  Item Frt Overage /Prc UM
     I                                    P 408 4114P1CGNB
      * N :  Packages per case
     I                                    P 412 4154P1ILNB
      * N :  Use/Freeze/Sell By Days
     I                                    P 416 4170P1CHNB
      * N :  PM Batch Size
     I                                    P 418 4234P1CINB
      * N :  Package Level size
     I                                    P 424 4294P1CJNB
      * N :  Partial Item Code
     I                                    P 430 4330P1CMNB
      * N :  WIP Item Code
     I                                    P 434 4370P1CNNB
      * N :  WIP Reject Code
     I                                    P 438 4410P1CRNB
      * N :  Std Costing Unit Weight
     I                                    P 442 4462P1CSNB
      * N :  FP Std Green Weight
     I                                    P 447 4512P1CVNB
      * N :  PM Standard LBS Man/Hr
     I                                    P 452 4574P1CWNB
      * N :  PM Raw Meat LBS/Hr
     I                                    P 458 4634P1CXNB
      * N :  PM Formula LBS/Hr
     I                                    P 464 4694P1CZNB
      * N :  PM Finished LBS/Hr
     I                                    P 470 4754P1C0NB
      * N :  SH Unused (was broker)
     I                                      476 478 P1N1CD
      * N :  PM R/M Type Code
     I                                    P 479 4800P1B4NB
      * N :  PM Line Number
     I                                    P 481 4830P1B5NB
      * N :  Seconds Item
     I                                      484 484 P1X5ST
      * N :  Print on Realization Rpt
     I                                      485 486 P1X6ST
      * N :  Unit Weight Change Sts
     I                                      487 489 P1X7ST
      * N :  Piece Count Item
     I                                      490 490 P1PCCT
      * N :  Pieces Per Bag
     I                                    P 491 4940P1BDNB
      * N :  Bags Per Unit
     I                                    P 495 4980P1BJNB
      * N :  Export/Domestic
     I                                      499 499 P1SUST
      * N :  Print On Schedule
     I                                      500 500 P1SVST
      * N :  Fresh Inv Allocation Seq
     I                                      501 501 P1SYST
      * N :  Fresh Sched As Ordered
     I                                      502 502 P1SZST
      * N :  Frozen Inv Allocation Seq
     I                                      503 503 P1S1ST
      * N :  Primal Group Code
     I                                      504 509 P1XRCD
      * N :  Item Target Price
     I                                    P 510 5152P1F5WG
      * N :  Minimum Piece Weight
     I                                    P 516 5212P1F6WG
      * N :  Maximum Piece Weight
     I                                    P 522 5272P1F7WG
      * N :  Seaboard Equivalent Item
     I                                    P 528 5310P1BLNB
      * N :  Production Qty /Shift
     I                                    P 532 5350P1BNNB
      * N :  Scheduling Position Grade
     I                                      536 536 P1S2ST
      * N :  Sold 100% Frozen
     I                                      537 537 P1S4ST
      * N :  Maximum Shifts
     I                                      538 538 P1S5ST
      * N :  Value Added Sts
     I                                      539 539 P1S6ST
      * N :  Label Type
     I                                      540 541 P1S8ST
      * N :  Default Workcenter
     I                                      542 544 P1TDST
      * N :  Record Status
     I                                      545 545 P1VSST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Enterprise Code 1
     I                                       10  13 P2DQCD
      * N :  Enterprise Code 2
     I                                       14  25 P2DRCD
      * N :  Salesperson Code
     I                                       26  28 P2BCCD
      * N :  System Date Format
     I                                       29  31 P2B8NA
      * N :  User Profile Name
     I                                       32  41 P2AJVN
      * N :  Allow Multi-Company
     I                                       42  42 P2I6ST
      * N :  Default Printer
     I                                       43  52 P2MPNA
      * N :  First Time Flag
     I                                       53  53 P2TAST
      * N :  Name
     I                                       54  83 P2ADTX
      * N :  System Value Alpha
     I                                       84 123 P2BXTX
      * N :  Access Denied (Y/N)
     I                                      124 124 P2WVST
     IP3PARM      DS
      * N :  Change Plant Floor USR
     I                                        1   1 P3ZQST
     IP4PARM      DS
      * FLD: AS Product
      * N :  AS Add/Change/Delete
     I                                        1   1 P4Y5ST
     IP5PARM      DS
      * FLD: *Arrays
      * N :  PRT Printer Device
     I                                        1  10 P5WRST
      * N :  PRT Hold Output Sts
     I                                       11  14 P5WSST
      * N :  PRT Save Output Sts
     I                                       15  18 P5WTST
      * N :  PRT Number of Copies
     I                                       19  200P5DYNB
      * N :  PRT Night Queue Run Sts
     I                                       21  21 P5WUST
      * N :  PRT Night Queue
     I                                       22  31 P5BVVN
      * N :  Program name USR
     I                                       32  41 P5BMVN
      * N :  Program Name$ USR
     I                                       42  51 P5BWVN
      * N :  Display Prt Opt Pmt USR
     I                                       52  55 P5XFST
     IP6PARM      DS
      * N : MAP System Value Numeric
     I                                    P   1   85P6M8NB
     IP7PARM      DS
      * N :  Box iD
     I                                    P   1   40P7BOXI
     IP8PARM      DS
      * N :  USR Output Only Status
     I                                        1   1 P8E5ST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Item Category is not Fnd'
      * Item Category Code USR
     I                                        1   3 ZA0001
      * Message data for 'Box Id is Not Found'
      * Box iD
     I                                    P   1   40ZA0002
      * Message data for 'Box Id Required'
      * Box iD
     I                                    P   1   40ZA0003
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0004
      * Company Number
     I                                        4   6 ZA0005
      * Message data for 'Catch weight weight reqd'
      * Message data for 'Conversion Factor 1 req'd'
      * Message data for 'Operation Factor 1 req'd'
      * Message data for 'U/M 2 required if U/M 3'
      * U/M - Second
     I                                        1   2 ZA0006
      * Conversion Factor 1
     I                                    P   3   74ZA0007
      * Message data for 'Conversion Factor 2 req'd'
      * Message data for 'Operation Factor 2 req'd'
      * Message data for 'Conv Fct1 Not = Unit Wgt'
      * Message data for 'Conv Fct2 Not = Unit Wgt'
      * Conversion Factor 2
     I                                    P   1   54ZA0008
      * Message data for 'U/M-base not equal 1,2or3'
      * U/M - Primary
     I                                        1   2 ZA0009
      * U/M - Second
     I                                        3   4 ZA0010
      * U/M - Third
     I                                        5   6 ZA0011
      * Message data for 'Com Group U/M must= U/M P'
      * Commodity Price Group
     I                                        1   7 ZA0012
      * Message data for 'Pieces per Bag req'
      * Pieces Per Bag
     I                                    P   1   40ZA0013
      * Message data for 'Bags per Unit req'
      * Bags Per Unit
     I                                    P   1   40ZA0014
      * Message data for 'Audit Value Min gt Max'
      * Message data for 'Std Wght Head can't be BL'
      * Std Weight/Head (Var/Ren)
     I                                    P   1   62ZA0015
      * Message data for 'Invalid WIP Item Code'
      * WIP Item Code
     I                                        1   7 ZA0016
      * Message data for 'Base/Cov/Fab can't be BL'
      * Base/Conv/Loss Item
     I                                        1   2 ZA0017
      * Message data for 'Min Wgt > Unit'
      * Minimum Weight Per Case
     I                                    P   1   62ZA0018
      * Message data for 'Max Wgt < Unit'
      * Maximum Weight Per Case
     I                                    P   1   62ZA0019
      * Message data for 'GL Sub Code is Req'
      * Message data for 'GL Sub Code is Invalid'
      * Message data for 'Item Label Required'
      * Item Label Line 1
     I                                        1  32 ZA0020
      * Message data for 'Export/Domestic Req'
      * Export/Domestic
     I                                        1   1 ZA0021
      * Message data for 'Fresh Inv Allocation Seq'
      * Fresh Inv Allocation Seq
     I                                        1   1 ZA0022
      * Message data for 'Fresh Sched As Ordered rq'
      * Fresh Sched As Ordered
     I                                        1   1 ZA0023
      * Message data for 'Frozn Inv Alloc Seq rq'
      * Frozen Inv Allocation Seq
     I                                        1   1 ZA0024
      * Message data for 'Commdty Mrkt Can't be BL'
      * Default Commod Mark basis
     I                                        1   3 ZA0025
      * Message data for 'Commdty Group Can't be BL'
      * Commodity Price Group
     I                                        1   7 ZA0026
      * Message data for 'Prices for group not avai'
      * Default Commod Mark basis
     I                                        1   3 ZA0027
      * Commodity Price Group
     I                                        4  10 ZA0028
      * Message data for 'Item Structure Type Req'
      * Item Structure Type Code
     I                                    P   1   20ZA0029
      * Message data for 'Item Structure Group Req'
      * Item Structure Group Code
     I                                    P   1   20ZA0030
      * Message data for 'Item Structure Class Req'
      * Item Structure Class Code
     I                                    P   1   20ZA0031
      * Message data for 'Partial/Reject <5 digits'
      * Partial Item Code
     I                                        1   7 ZA0032
      * Message data for 'Partial/Reject = FG/WP'
      * Partial Item Code
     I                                        1   7 ZA0033
      * Message data for 'Partial/Reject Itm Exist'
      * Partial Item Code
     I                                        1   7 ZA0034
      * Message data for 'Partial/Reject Itm Exist'
      * Partial Item Code
     I                                        1   7 ZA0035
      * Message data for 'Partial/Reject <5 digits'
      * Partial Item Code
     I                                        1   7 ZA0036
      * Message data for 'Partial/Reject = FG/WP'
      * Partial Item Code
     I                                        1   7 ZA0037
      * Message data for 'Partial/Reject Itm Exist'
      * Partial Item Code
     I                                        1   7 ZA0038
      * Message data for 'Partial/Reject Itm Exist'
      * Partial Item Code
     I                                        1   7 ZA0039
      * Message data for 'Credit Item Must be FG'
      * Credit Item Status
     I                                        1   1 ZA0040
      * Message data for 'Base/Cov/Fab can't be BL'
      * Base/Conv/Loss Item
     I                                        1   2 ZA0041
      * Message data for 'Vrty/Rend/Cut can't be BL'
      * Variety/Rendered/Cut
     I                                        1   1 ZA0042
      * Message data for 'Whse is Mandatory for FG'
      * Default Warehouse
     I                                        1   3 ZA0043
      * Message data for 'PS Production Departme NF'
      * Department Code
     I                                        1   6 ZA0044
      * Message data for 'RM item must be a base'
      * Item Type Code
     I                                        1   3 ZA0045
      * Base/Conv/Loss Item
     I                                        4   5 ZA0046
      * Message data for 'Package type can't be BLK'
      * Package Type Code
     I                                        1   1 ZA0047
      * Message data for 'Credit Item Must be FG'
      * Credit Item Status
     I                                        1   1 ZA0048
      * Message data for 'Item belongs w/other BOM'
      * Item Code
     I                                        1   7 ZA0049
      * Message data for 'PS Production Capacity NF'
      * PS Prod Capacity Code
     I                                        1   6 ZA0050
      * Message data for 'Incl on Prod Sched Y/N'
      * Item Prod Sched Send PFS
     I                                        1   3 ZA0051
      * Message data for 'Item Change Notification'
      * Text USR 20
     I                                        1  20 ZA0052
      * Weight 9.2 USR
     I                                    P  21  252ZA0053
      * Text 1 Length USR
     I                                       26  26 ZA0054
      * Message data for 'Item Change Notification'
      * Text USR 20
     I                                        1  20 ZA0055
      * Weight 9.2 USR
     I                                    P  21  252ZA0056
      * Text 1 Length USR
     I                                       26  26 ZA0057
      * Message data for 'Item Change Notification'
      * Text USR 20
     I                                        1  20 ZA0058
      * Weight 9.2 USR
     I                                    P  21  252ZA0059
      * Text 1 Length USR
     I                                       26  26 ZA0060
      * Message data for 'Item Change Notification'
      * Text USR 20
     I                                        1  20 ZA0061
      * Weight 9.2 USR
     I                                    P  21  252ZA0062
      * Text 1 Length USR
     I                                       26  26 ZA0063
      * Message data for 'Item Change Notification'
      * Text USR 20
     I                                        1  20 ZA0064
      * Weight 9.2 USR
     I                                    P  21  252ZA0065
      * Text 1 Length USR
     I                                       26  26 ZA0066
      * Message data for 'Item Change Notification'
      * Text USR 20
     I                                        1  20 ZA0067
      * Weight 9.2 USR
     I                                    P  21  252ZA0068
      * Text 1 Length USR
     I                                       26  26 ZA0069
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0070
      * Application Code
     I                                       11  16 ZA0071
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0072
      * Application Code
     I                                       11  16 ZA0073
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM P1AIC3    WP0001  30       Company Number
     C           P1HGCD    PARM P1HGCD    WP0002  70       Item Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1HGCD    OREQ *ZERO                      Item Code
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3
     C                     Z-ADD#1HGCD    BZHGCD
     C           KRTV      CHAIN@BZREJU              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
      * Send message 'Company Item           NF'
     C                     MOVEL'USR0326' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * PAR = DB1 By name
     C                     Z-ADDBZAIC3    P1AIC3           Company Number
     C                     Z-ADDBZHGCD    P1HGCD           Item Code
     C                     MOVELBZAVNA    P1AVNA           Description Lin
     C                     MOVELBZAWNA    P1AWNA           Description Lin
     C                     MOVELBZL7NA    P1L7NA           Item Label Line
     C                     MOVELBZL8NA    P1L8NA           Item Label Line
     C                     MOVELBZL6NA    P1L6NA           Item Label Line
     C                     MOVELBZMFNA    P1MFNA           Item Label Line
     C                     MOVELBZADCD    P1ADCD           U/M - Primary
     C                     Z-ADDBZAWPC    P1AWPC           Conversion Fact
     C                     MOVELBZLXST    P1LXST           Operation Facto
     C                     MOVELBZAECD    P1AECD           U/M - Second
     C                     Z-ADDBZAXPC    P1AXPC           Conversion Fact
     C                     MOVELBZLYST    P1LYST           Operation Facto
     C                     MOVELBZAFCD    P1AFCD           U/M - Third
     C                     MOVELBZAICD    P1AICD           U/M - Pricing
     C                     Z-ADDBZAIWG    P1AIWG           Unit Weight
     C                     MOVELBZHICD    P1HICD           Quality Level
     C                     MOVELBZRBCD    P1RBCD           Item Level
     C                     MOVELBZFZST    P1FZST           Production Date
     C                     MOVELBZAVST    P1AVST           Catch Weight St
     C                     Z-ADDBZCZWG    P1CZWG           Minimum Weight
     C                     Z-ADDBZC0WG    P1C0WG           Maximum Weight
     C                     Z-ADDBZURTN    P1URTN           Number Cases On
     C                     Z-ADDBZAJC8    P1AJC8           Vendor - Item D
     C                     Z-ADDBZRINB    P1RINB           Item Structure
     C                     Z-ADDBZRHNB    P1RHNB           Item Structure
     C                     Z-ADDBZRGNB    P1RGNB           Item Structure
     C                     MOVELBZLNCD    P1LNCD           Default Commod
     C                     Z-ADDBZTFNB    P1TFNB           Transportation
     C                     MOVELBZN0CD    P1N0CD           Item Type Code
     C                     MOVELBZX4ST    P1X4ST           Package Type Co
     C                     Z-ADDBZTMVA    P1TMVA           Maximum Audit V
     C                     Z-ADDBZTNVA    P1TNVA           Minimum Audit V
     C                     Z-ADDBZBLPR    P1BLPR           Market Overage
     C                     Z-ADDBZBMPR    P1BMPR           Standard Overag
     C                     MOVELBZLRCD    P1LRCD           Commodity Price
     C                     MOVELBZU9ST    P1U9ST           Item Pricing Op
     C                     Z-ADDBZCMCO    P1CMCO           Item Pricing Co
     C                     MOVELBZQ1CD    P1Q1CD           Default Warehou
     C                     MOVELBZQ8CD    P1Q8CD           Price Method De
     C                     Z-ADDBZCHTM    P1CHTM           Fresh Chilling
     C                     MOVELBZQZCD    P1QZCD           Base/Conv/Loss
     C                     MOVELBZXWST    P1XWST           Variety/Rendere
     C                     MOVELBZXXST    P1XXST           Frozen Make to
     C                     MOVELBZVMST    P1VMST           Credit Item Sta
     C                     Z-ADDBZSWGH    P1SWGH           Std Weight/Head
     C                     Z-ADDBZPPHE    P1PPHE           Pieces Per Head
     C                     MOVELBZR3CD    P1R3CD           Department Code
     C                     MOVELBZSDCD    P1SDCD           Group for Packa
     C                     Z-ADDBZICN1    P1ICN1           Item Category N
     C                     MOVELBZSVCD    P1SVCD           MTO Code
     C                     Z-ADDBZICN2    P1ICN2           Item Category N
     C                     MOVELBZSWCD    P1SWCD           Transp Equip Ty
     C                     Z-ADDBZV2NB    P1V2NB           Item Category N
     C                     MOVELBZSXCD    P1SXCD           Item Category C
     C                     Z-ADDBZITCN    P1ITCN           Item Category N
     C                     MOVELBZSYCD    P1SYCD           G/L Sub Code
     C                     Z-ADDBZITC5    P1ITC5           Item Category N
     C                     MOVELBZSZCD    P1SZCD           Item Structure
     C                     Z-ADDBZICN6    P1ICN6           Item Category N
     C                     MOVELBZS0CD    P1S0CD           Item Primal Sch
     C                     Z-ADDBZICN7    P1ICN7           Item Category N
     C                     MOVELBZS1CD    P1S1CD           Item Exc Man Pr
     C                     Z-ADDBZICN8    P1ICN8           Item Category N
     C                     MOVELBZS2CD    P1S2CD           Item Prod Sched
     C                     Z-ADDBZICN9    P1ICN9           Item Category N
     C                     MOVELBZS3CD    P1S3CD           Item Category C
     C                     Z-ADDBZICN0    P1ICN0           Item Category N
     C                     MOVELBZS4CD    P1S4CD           Item Category C
     C                     Z-ADDBZSFNB    P1SFNB           Pallet Tare Wei
     C                     Z-ADDBZA3WG    P1A3WG           Misc Tare Weigh
     C                     Z-ADDBZSJNB    P1SJNB           Production Lead
     C                     MOVELBZLLCD    P1LLCD           Packaging Code
     C                     MOVELBZLMCD    P1LMCD           Item Market Cod
     C                     MOVELBZP3ST    P1P3ST           TF Co-Ownership
     C                     Z-ADDBZSKNB    P1SKNB           Agrimetrics gro
     C                     Z-ADDBZSLNB    P1SLNB           Agrimetrics pac
     C                     Z-ADDBZSMNB    P1SMNB           Agrimetrics gra
     C                     MOVELBZP4ST    P1P4ST           PA Base Avail R
     C                     Z-ADDBZCFNB    P1CFNB           PM Pounds per H
     C                     Z-ADDBZCGNB    P1CGNB           Item Frt Overag
     C                     Z-ADDBZILNB    P1ILNB           Packages per ca
     C                     Z-ADDBZCHNB    P1CHNB           Use/Freeze/Sell
     C                     Z-ADDBZCINB    P1CINB           PM Batch Size
     C                     Z-ADDBZCJNB    P1CJNB           Package Level s
     C                     Z-ADDBZCMNB    P1CMNB           Partial Item Co
     C                     Z-ADDBZCNNB    P1CNNB           WIP Item Code
     C                     Z-ADDBZCRNB    P1CRNB           WIP Reject Code
     C                     Z-ADDBZCSNB    P1CSNB           Std Costing Uni
     C                     Z-ADDBZCVNB    P1CVNB           FP Std Green We
     C                     Z-ADDBZCWNB    P1CWNB           PM Standard LBS
     C                     Z-ADDBZCXNB    P1CXNB           PM Raw Meat LBS
     C                     Z-ADDBZCZNB    P1CZNB           PM Formula LBS/
     C                     Z-ADDBZC0NB    P1C0NB           PM Finished LBS
     C                     MOVELBZN1CD    P1N1CD           SH Unused (was
     C                     Z-ADDBZB4NB    P1B4NB           PM R/M Type Cod
     C                     Z-ADDBZB5NB    P1B5NB           PM Line Number
     C                     MOVELBZX5ST    P1X5ST           Seconds Item
     C                     MOVELBZX6ST    P1X6ST           Print on Realiz
     C                     MOVELBZX7ST    P1X7ST           Unit Weight Cha
     C                     MOVELBZPCCT    P1PCCT           Piece Count Ite
     C                     Z-ADDBZBDNB    P1BDNB           Pieces Per Bag
     C                     Z-ADDBZBJNB    P1BJNB           Bags Per Unit
     C                     MOVELBZSUST    P1SUST           Export/Domestic
     C                     MOVELBZSVST    P1SVST           Print On Schedu
     C                     MOVELBZSYST    P1SYST           Fresh Inv Alloc
     C                     MOVELBZSZST    P1SZST           Fresh Sched As
     C                     MOVELBZS1ST    P1S1ST           Frozen Inv Allo
     C                     MOVELBZXRCD    P1XRCD           Primal Group Co
     C                     Z-ADDBZF5WG    P1F5WG           Item Target Pri
     C                     Z-ADDBZF6WG    P1F6WG           Minimum Piece W
     C                     Z-ADDBZF7WG    P1F7WG           Maximum Piece W
     C                     Z-ADDBZBLNB    P1BLNB           Seaboard Equiva
     C                     Z-ADDBZBNNB    P1BNNB           Production Qty
     C                     MOVELBZS2ST    P1S2ST           Scheduling Posi
     C                     MOVELBZS4ST    P1S4ST           Sold 100% Froze
     C                     MOVELBZS5ST    P1S5ST           Maximum Shifts
     C                     MOVELBZS6ST    P1S6ST           Value Added Sts
     C                     MOVELBZS8ST    P1S8ST           Label Type
     C                     MOVELBZTDST    P1TDST           Default Workcen
     C                     MOVELBZVSST    P1VSST           Record Status
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBZAIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DADTX    P      Name
      * Move of various fields to screens and get descriptions.
     C                     EXSR UASUBR                     Move of various
      * allow boxid to be input
      * CASE:
      *  - c1 OR c3
      *   |- c1    : DTL.Item Type Code is Raw Material
      *   |- c3    : DTL.Item Type Code is Packaging and Supplies
      *   '-
     C           #1N0CD    IFEQ 'RM'                       *IF
     C           #1N0CD    OREQ 'PS'                       *OR
     C                     MOVEL'N'       YL0001           Allow BoxId to
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0001           Allow BoxId to
     C                     END                             *FI
      * Unit Weight Rules with Update on Company Item
     C                     EXSR UBSUBR                     Unit Weight Rul
      * CASE: WRK.Allow Weight Input is yes
     C           WUIFST    IFEQ 'Y'                        *IF
      * uom second is lb move unt wgt/conv-1
      * CASE: DTL.U/M - Second is Pounds
     C           #1AECD    IFEQ 'LB'                       *IF
     C                     Z-ADD#1AIWG    #1AWPC           Conversion Fact
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AWPC    #1AWPC           Conversion Fact
     C                     END                             *FI
      * uom third is lb move unt wgt/conv-2
      * CASE: DTL.U/M - Third is Pounds
     C           #1AFCD    IFEQ 'LB'                       *IF
     C                     Z-ADD#1AIWG    #1AXPC           Conversion Fact
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AXPC    #1AXPC           Conversion Fact
     C                     END                             *FI
     C                     END                             *FI
      * Rtv CIE for Item      RT - Company Item Ext  * 
     C                     EXSR SERVGN
      * DTL.Condition Desc. 3  USR = Condition name of DTL.Allocation Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1946762   Y2LSNO  70       List number
     C                     PARM #DENST    W0INVL 25        Allocation Meth
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHNTX    PARM           W0CNNM 25        Condition Desc.
      *
      * FP1054 Display Produce on Day of week if FG and Converted
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Item Type Code is Finished Good
      *   |- c2    : DB1.Base/Conv/Loss Item is Converted
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BZN0CD    IFEQ 'FG'                       *IF
     C           BZQZCD    IFEQ 'C'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0004           USR Display 1
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       YL0004           USR Display 1
     C                     END                             *FI
     C                     MOVEL'N'       P8E5ST           USR Output Only
     C                     MOVEL*BLANK    #DSETX           Text USR 23
      * FP1054 Output Plan Prod Sts if allocated orders exist
      * CASE: DTL.Plan Production Sts is Yes
     C           #DEMST    IFEQ *BLANK                     *IF
      * Rtv Orders Alloc y/n  RT - Order Detail Schedule  * 
     C                     EXSR SFRVGN
      * CASE: PAR.USR Output Only Status is yes
     C           P8E5ST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   #DSETX           Text USR 23
     C                     END                             *FI
     C                     END                             *FI
      * DTL.Condition Desc. 2  USR = Condition name of DTL.Default Workce
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1743203   Y2LSNO  70       List number
     C                     PARM #1TDST    W0INVL 25        Default Workcen
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Rtv Record Status     RT - Item Default  * 
     C                     EXSR SHRVGN
      * IF Inactve/Deleted and the Item Dft is too, dont allow chg here.R
      * CASE: DTL.Record Status is Deleted & Inactive
     C           #1VSST    IFEQ 'D'                        *IF
     C           #1VSST    OREQ 'I'
      * CASE: DTL.Record Status 1 Usr is Deleted & Inactive
     C           #DYPSX    IFEQ 'D'                        *IF
     C           #DYPSX    OREQ 'I'
     C                     MOVEL'Y'       YL0006           Output Only 1 U
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    #DYMTX           Text USR 8
      * Populate the record status text for Primal Grp Report
      * CASE: DTL.Item Category Code 6 is Entered
     C           #1S0CD    IFGT *BLANK                     *IF
     C                     Z-ADD06        #1ICN6           Item Category N
     C                     MOVEL*BLANK    WUH3TX           Return Code Usr
      * Val Item Category     Rt - Item Category  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0011           Company Number
     C                     Z-ADD06        WL0012           Item Category N
     C                     MOVEL#1S0CD    WL0013    P      Item Category C
     C                     MOVELWUH3TX    WL0014    P      Return Code Usr
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUH3TX    P      Return Code Usr
     C                     MOVELWL0015    WUE4ST    P      Record Status 3
      * DTL.Text USR 8 = Condition name of WRK.Record Status 3 usr
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM WUE4ST    W0INVL 25        Record Status 3
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DYMTX    PARM           W0CNNM 25        Text USR 8
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD00        #1ICN6           Item Category N
     C                     END                             *FI
      * RTV PS Prod Cap Desc  RT - PS Production Capacity  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKUAA    WL0016    P      PS Prod Capacit
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    #DUVNA    P      PS Prod Capacit
     C                     END
      *
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,002                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           YPMTFD    IFNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Item Code required
     C           #1HGCD    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Validate Default Workcenter
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1TDST'  IFEQ YPMTFD
      * Default Workcenter
     C                     MOVEL#1TDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHTDST
     C                     SELEC
     C           W0INVL    WHEQ 'AL'                       AL
     C                     Z-ADD1         ZHTDST
     C           W0INVL    WHEQ 'CB'                       CB
     C                     Z-ADD2         ZHTDST
     C           W0INVL    WHEQ 'EX'                       EX
     C                     Z-ADD3         ZHTDST
     C           W0INVL    WHEQ 'PF'                       PF
     C                     Z-ADD4         ZHTDST
     C           W0INVL    WHEQ 'PP'                       PP
     C                     Z-ADD5         ZHTDST
     C           W0INVL    WHEQ 'ST'                       ST
     C                     Z-ADD6         ZHTDST
     C           W0INVL    WHEQ 'VM'                       VM
     C                     Z-ADD7         ZHTDST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD8         ZHTDST
     C                     ENDSL
     C                     EXFMTZGTDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHTDST    WHEQ 1
     C                     MOVEL'AL'      W0INVL           AL
     C           ZHTDST    WHEQ 2
     C                     MOVEL'CB'      W0INVL           CB
     C           ZHTDST    WHEQ 3
     C                     MOVEL'EX'      W0INVL           EX
     C           ZHTDST    WHEQ 4
     C                     MOVEL'PF'      W0INVL           PF
     C           ZHTDST    WHEQ 5
     C                     MOVEL'PP'      W0INVL           PP
     C           ZHTDST    WHEQ 6
     C                     MOVEL'ST'      W0INVL           ST
     C           ZHTDST    WHEQ 7
     C                     MOVEL'VM'      W0INVL           VM
     C           ZHTDST    WHEQ 8
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1TDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate CIE Use Age Days over Max
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DEPST'  IFEQ YPMTFD
      * CIE Use Age Days over Max
     C                     MOVEL#DEPST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHEPST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHEPST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHEPST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHEPST
     C                     ENDSL
     C                     EXFMTZGEPST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHEPST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHEPST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHEPST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DEPST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Print On Schedule
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1SVST'  IFEQ YPMTFD
      * Print On Schedule
     C                     MOVEL#1SVST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSVST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHSVST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHSVST
     C                     ENDSL
     C                     EXFMTZGSVST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSVST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHSVST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1SVST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Allocation Method
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DENST'  IFEQ YPMTFD
      * Allocation Method
     C                     MOVEL#DENST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHENST
     C                     SELEC
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD1         ZHENST
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD2         ZHENST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD3         ZHENST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD4         ZHENST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD5         ZHENST
     C                     ENDSL
     C                     EXFMTZGENST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHENST    WHEQ 1
     C                     MOVEL'F'       W0INVL           F
     C           ZHENST    WHEQ 2
     C                     MOVEL'B'       W0INVL           B
     C           ZHENST    WHEQ 3
     C                     MOVEL'S'       W0INVL           S
     C           ZHENST    WHEQ 4
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C           ZHENST    WHEQ 5
     C                     MOVEL'I'       W0INVL           I
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DENST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Plan Production Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DEMST'  IFEQ YPMTFD
      * Plan Production Sts
     C                     MOVEL#DEMST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHEMST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHEMST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD2         ZHEMST
     C                     ENDSL
     C                     EXFMTZGEMST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHEMST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHEMST    WHEQ 2
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DEMST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Sunday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DD0ST'  IFEQ YPMTFD
      * Produce on Sunday Sts
     C                     MOVEL#DD0ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHD0ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHD0ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHD0ST
     C                     ENDSL
     C                     EXFMTZGD0ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHD0ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHD0ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DD0ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Monday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DD2ST'  IFEQ YPMTFD
      * Produce on Monday Sts
     C                     MOVEL#DD2ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHD2ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHD2ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHD2ST
     C                     ENDSL
     C                     EXFMTZGD2ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHD2ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHD2ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DD2ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Tuesday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DD6ST'  IFEQ YPMTFD
      * Produce on Tuesday Sts
     C                     MOVEL#DD6ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHD6ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHD6ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHD6ST
     C                     ENDSL
     C                     EXFMTZGD6ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHD6ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHD6ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DD6ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Wednesday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DWESP'  IFEQ YPMTFD
      * Produce on Wednesday Sts
     C                     MOVEL#DWESP    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHWESP
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHWESP
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHWESP
     C                     ENDSL
     C                     EXFMTZGWESP
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHWESP    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHWESP    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DWESP
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Thursday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DEDST'  IFEQ YPMTFD
      * Produce on Thursday Sts
     C                     MOVEL#DEDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHEDST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHEDST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHEDST
     C                     ENDSL
     C                     EXFMTZGEDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHEDST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHEDST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DEDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Friday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DEFST'  IFEQ YPMTFD
      * Produce on Friday Sts
     C                     MOVEL#DEFST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHEFST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHEFST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHEFST
     C                     ENDSL
     C                     EXFMTZGEFST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHEFST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHEFST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DEFST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Produce on Saturday Sts
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DEHST'  IFEQ YPMTFD
      * Produce on Saturday Sts
     C                     MOVEL#DEHST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHEHST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHEHST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHEHST
     C                     ENDSL
     C                     EXFMTZGEHST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHEHST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHEHST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DEHST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate CIE MPR Report to USDA
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DEQST'  IFEQ YPMTFD
      * CIE MPR Report to USDA
     C                     MOVEL#DEQST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHEQST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHEQST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHEQST
     C           W0INVL    WHEQ *BLANK                     *BLANK
     C                     Z-ADD3         ZHEQST
     C                     ENDSL
     C                     EXFMTZGEQST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHEQST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHEQST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHEQST    WHEQ 3
     C                     MOVEL*BLANK    W0INVL           *BLANK
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DEQST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Record Status
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1VSST'  IFEQ YPMTFD
      * Record Status
     C                     MOVEL#1VSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHVSST
     C                     SELEC
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD1         ZHVSST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZHVSST
     C                     ENDSL
     C                     EXFMTZGVSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHVSST    WHEQ 1
     C                     MOVEL'A'       W0INVL           A
     C           ZHVSST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1VSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * F4=Prompt.
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Default Warehouse
     C           W0CFL     IFEQ '#1Q1CD'                   *IF
      * SEL ShipCo/Warehouse   SR - Warehouse  * 
     C                     CALL 'PPHQSRR'              90  SEL ShipCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #1Q1CD    PARM #1Q1CD    WQ0007  3        Warehouse Code
     C                     PARM #1AIC3    WQ0008  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPHQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Item Category Code 6
     C           W0CFL     IFEQ '#1S0CD'                   *IF
      * Sel Primal Group Rpt  SL - Item Category  * 
     C                     CALL 'PBDYSRR'              90  Sel Primal Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0009  30       Company Number
     C                     PARM 06        WQ0010  20       Item Category N
     C           #1S0CD    PARM #1S0CD    WQ0011  3        Item Category C
     C           WUAUNA    PARM WUAUNA    WQ0012 30        Description
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBDYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.CIE Capacity Code
     C           W0CFL     IFEQ '#DKUAA'                   *IF
      * Sel PS Prod Capacity   SL - PS Production Capacity  * 
     C                     CALL 'PBK0SRR'              90  Sel PS Prod Cap
     C                     PARM *BLANK    W0RTN   7
     C           #DKUAA    PARM #DKUAA    WQ0013  6        PS Prod Capacit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBK0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'N'       W0DCF            *Defer confirm
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0001           Company Number
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DADTX    P      Name
     C                     MOVEL*BLANK    WUE4ST           Record Status 3
      * Move of various fields to screens and get descriptions.
     C                     EXSR UCSUBR                     Move of various
     C                     MOVEL*BLANK    #DYMTX           Text USR 8
      * Validate Item Category 06 - Primal Group Report for Scheduling
      * CASE: DTL.Item Category Code 6 is Entered
     C           #1S0CD    IFGT *BLANK                     *IF
     C                     Z-ADD06        #1ICN6           Item Category N
     C                     MOVEL*BLANK    WUH3TX           Return Code Usr
      * Val Item Category     Rt - Item Category  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0011           Company Number
     C                     Z-ADD06        WL0012           Item Category N
     C                     MOVEL#1S0CD    WL0013    P      Item Category C
     C                     MOVELWUH3TX    WL0014    P      Return Code Usr
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0014    WUH3TX    P      Return Code Usr
     C                     MOVELWL0015    WUE4ST    P      Record Status 3
      * CASE: WRK.Return Code Usr is Not Blank
     C           WUH3TX    IFNE *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1S0CD    ZA0001           Item Primal Sch
      * Send message 'Item Category is not Fnd'
     C                     MOVEL'USR4522' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
      * DTL.Text USR 8 = Condition name of WRK.Record Status 3 usr
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM WUE4ST    W0INVL 25        Record Status 3
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DYMTX    PARM           W0CNNM 25        Text USR 8
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD00        #1ICN6           Item Category N
     C                     END                             *FI
      * Box validation
      * CASE: LCL.Allow BoxId to Chg Usr is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Val Box-Company Item   RT - Company Item  * 
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
     C                     Z-ADD#DBOXI    ZA0002           Box iD
      * Send message 'Box Id is Not Found'
     C                     MOVEL'USR3375' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Check for Box ID  - CO/ITEM validation and NCP
      * CASE: co/item validation - for Box ID - NCP
      *  - c1 AND c2
      *   |- c1    : DTL.Box iD is Not Entered
      *   |- c2    : DTL.Item Structure Type Code is NE 900
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DBOXI    IFEQ *ZERO                      *IF
     C           #1RGNB    IFNE 900                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     Z-ADD#DBOXI    ZA0003           Box iD
      * Send message 'Box Id Required'
     C                     MOVEL'USR3119' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Item Type Code is Packaging and Supplies
     C           #1N0CD    IFEQ 'PS'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL Shipping Co WHS   RT - Warehouse  * 
     C                     EXSR SLRVGN
      * CASE: DTL.Warehouse Description is equal to blank
     C           #DF8NA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1Q1CD    ZA0004           Default Warehou
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0005           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0005           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Co-Packer - move unit wgt to conversion factor 1
      * CASE: DTL.Item Structure Type Code is NE 900
     C           #1RGNB    IFNE 900                        *IF
     C                     Z-ADD#1AIWG    #1AWPC           Conversion Fact
     C                     END                             *FI
      * Unit Weight Rules with Update on Company Item
     C                     EXSR UDSUBR                     Unit Weight Rul
      * CASE: WRK.Allow Weight Input is yes
     C           WUIFST    IFEQ 'Y'                        *IF
      * uom second is lb move unt wgt/conv-1
      * CASE: DTL.U/M - Second is Pounds
     C           #1AECD    IFEQ 'LB'                       *IF
     C                     Z-ADD#1AIWG    #1AWPC           Conversion Fact
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AWPC    #1AWPC           Conversion Fact
     C                     END                             *FI
      * uom third is lb move unt wgt/conv-2
      * CASE: DTL.U/M - Third is Pounds
     C           #1AFCD    IFEQ 'LB'                       *IF
     C                     Z-ADD#1AIWG    #1AXPC           Conversion Fact
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#1AXPC    #1AXPC           Conversion Fact
     C                     END                             *FI
     C                     END                             *FI
      * Val Item Fields Rules  IF - Item Default  * 
     C                     EXSR SMINFN
      * DTL.Condition Desc. 2  USR = Condition name of DTL.Default Workce
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1743203   Y2LSNO  70       List number
     C                     PARM #1TDST    W0INVL 25        Default Workcen
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Validation of Item with other BOM
      * CASE: DTL.Record Status is Deleted & Inactive
     C           #1VSST    IFEQ 'D'                        *IF
     C           #1VSST    OREQ 'I'
     C                     MOVEL*BLANK    YL0015           Record Found -
      * Val Item Bom Rltnshps XF - Item Bill Of Material  * 
     C                     CALL 'PNJ9XFR'              90  Val Item Bom Rl
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0024  30       Company Number
     C                     PARM #1HGCD    WQ0025  70       Component Item
     C           YL0015    PARM YL0015    WQ0026  1        Record Found -
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNJ9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Record Found - ItmBom Usr is Record Found
     C           YL0015    IFEQ 'Y'                        *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0049           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0049           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Item belongs w/other BOM'
     C                     MOVEL'USR4174' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * DTL.Condition Desc. 3  USR = Condition name of DTL.Allocation Met
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1946762   Y2LSNO  70       List number
     C                     PARM #DENST    W0INVL 25        Allocation Meth
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHNTX    PARM           W0CNNM 25        Condition Desc.
      *
      * CASE: DTL.CIE Capacity Code is Not Entered
     C           #DKUAA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV PS Prod Cap Desc  RT - PS Production Capacity  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DKUAA    WL0016    P      PS Prod Capacit
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0017    #DUVNA    P      PS Prod Capacit
      * CASE: DTL.PS Prod Capacity Desc is equal to blank
     C           #DUVNA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DKUAA    ZA0050           CIE Capacity Co
      * Send message 'PS Production Capacity NF'
     C                     MOVEL'USR4671' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9942  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * E3787 JJH 08/04/15 - Validation for Inclu on Prod Schedule
      * SNDERRMSG if Incl on Prod Schedule NE Y or N.
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Item Prod Sched Send PFS is Yes
      *   |- c2    : DTL.Item Prod Sched Send PFS is No
      *   '-
     C           #1S2CD    IFEQ 'Y'                        *IF
     C           #1S2CD    OREQ 'N'                        *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1S2CD    ZA0051           Item Prod Sched
      * Send message 'Incl on Prod Sched Y/N'
     C                     MOVEL'USR4812' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9944  *
      *
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Unit of Measure
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Level
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Vendor
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Group
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Structure Type
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Commodity Group
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Price Method Header
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PS Production Department
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Item Category Packaging
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PM R/M Type Master
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PM Line Master
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to PS Primal Group
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * F4 on Box Id
      * CASE: F4 on Box id
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is CF04
      *   |- c2    : PGM.*Cursor field <IS> DTL.Box iD
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DBOXI'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * SEL Box Items only     SR - Company Item  * 
     C                     CALL 'POSGSRR'              90  SEL Box Items o
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0044  30       Company Number
     C           #DBOXI    PARM #DBOXI    WQ0045  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POSGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Edit Bill of Material
      * CASE: DTL.*CMD key is CF09
     C           *IN09     IFEQ '1'                        *IF
      * CASE: DTL.Item Type Code is Packaging and Supplies
     C           #1N0CD    IFEQ 'PS'                       *IF
      * 8/02/01   PK0224  Dont allow for packaging/supplies
      * Send message 'Function key not allowed'
     C                     MOVEL'USR1833' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'S'       YL0016           BOM Type Usr
      * Edt Bill of Material  ET - Company Item  * 
     C                     CALL 'PPGIETR'              90  Edt Bill of Mat
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0046  30       Company Number
     C                     PARM #1HGCD    WQ0047  70       Item Code
     C                     PARM YL0016    WQ0048  1        BOM Type Usr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPGIETR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Allocation Method required
     C           #DENST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9941  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Record Status required
     C           #1VSST    IFEQ *BLANK                     IF
     C           *IN74     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9953  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
     C                     MOVEL'00'      WUKTTX           Alpha Zeros 2
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Company Item Spec  IF - Company Item  * 
     C                     EXSR STINFN
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YARDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1AIC3    IFEQ *ZERO                      Company Number
     C           P1HGCD    OREQ *ZERO                      Item Code
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUIFST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           P8E5ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C                     MOVEL'0'       *IN75
     C                     MOVEL'0'       *IN76
     C           YL0004    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN75
     C                     MOVEL'1'       *IN76
     C                     END                             *FI
     C                     MOVEL'0'       *IN74
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN74
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1L7NA           Item Label Line
     C                     MOVEL*BLANK    #1L8NA           Item Label Line
     C                     MOVEL*BLANK    #1L6NA           Item Label Line
     C                     MOVEL*BLANK    #1MFNA           Item Label Line
     C                     Z-ADD*ZERO     #1URTN           Number Cases On
     C                     MOVEL*BLANK    #1X7ST           Unit Weight Cha
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     Z-ADD*ZERO     #DFVWG           Nominal Weight
     C                     Z-ADD*ZERO     #1C0WG           Maximum Weight
     C                     Z-ADD*ZERO     #1CZWG           Minimum Weight
     C                     MOVEL*BLANK    #1S5ST           Maximum Shifts
     C                     Z-ADD*ZERO     #1AWPC           Conversion Fact
     C                     MOVEL*BLANK    #1LXST           Operation Facto
     C                     MOVEL*BLANK    #1AECD           U/M - Second
     C                     Z-ADD*ZERO     #1AXPC           Conversion Fact
     C                     MOVEL*BLANK    #1LYST           Operation Facto
     C                     MOVEL*BLANK    #1AFCD           U/M - Third
     C                     MOVEL*BLANK    #1AICD           U/M - Pricing
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     Z-ADD*ZERO     #1AJC8           Vendor - Item D
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     MOVEL*BLANK    #1LNCD           Default Commod
     C                     Z-ADD*ZERO     #1TFNB           Transportation
     C                     MOVEL*BLANK    #1X4ST           Package Type Co
     C                     Z-ADD*ZERO     #1TMVA           Maximum Audit V
     C                     Z-ADD*ZERO     #1TNVA           Minimum Audit V
     C                     Z-ADD*ZERO     #1BLPR           Market Overage
     C                     Z-ADD*ZERO     #1BMPR           Standard Overag
     C                     MOVEL*BLANK    #1LRCD           Commodity Price
     C                     MOVEL*BLANK    #1U9ST           Item Pricing Op
     C                     Z-ADD*ZERO     #1CMCO           Item Pricing Co
     C                     MOVEL*BLANK    #1Q8CD           Price Method De
     C                     Z-ADD*ZERO     #1CHTM           Fresh Chilling
     C                     MOVEL*BLANK    #1QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    #1XWST           Variety/Rendere
     C                     MOVEL*BLANK    #1XXST           Frozen Make to
     C                     MOVEL*BLANK    #1VMST           Credit Item Sta
     C                     Z-ADD*ZERO     #1PPHE           Pieces Per Head
     C                     MOVEL*BLANK    #1R3CD           Department Code
     C                     MOVEL*BLANK    #1SDCD           Group for Packa
     C                     Z-ADD*ZERO     #1ICN1           Item Category N
     C                     MOVEL*BLANK    #1SVCD           MTO Code
     C                     Z-ADD*ZERO     #1ICN2           Item Category N
     C                     MOVEL*BLANK    #1SWCD           Transp Equip Ty
     C                     Z-ADD*ZERO     #1V2NB           Item Category N
     C                     Z-ADD*ZERO     #1ITCN           Item Category N
     C                     MOVEL*BLANK    #1SYCD           G/L Sub Code
     C                     Z-ADD*ZERO     #1ITC5           Item Category N
     C                     MOVEL*BLANK    #1SZCD           Item Structure
     C                     Z-ADD*ZERO     #1ICN6           Item Category N
     C                     Z-ADD*ZERO     #1ICN7           Item Category N
     C                     MOVEL*BLANK    #1S1CD           Item Exc Man Pr
     C                     Z-ADD*ZERO     #1ICN8           Item Category N
     C                     Z-ADD*ZERO     #1ICN9           Item Category N
     C                     MOVEL*BLANK    #1S3CD           Item Category C
     C                     Z-ADD*ZERO     #1ICN0           Item Category N
     C                     Z-ADD*ZERO     #1SFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     #1SJNB           Production Lead
     C                     MOVEL*BLANK    #1LLCD           Packaging Code
     C                     MOVEL*BLANK    #1LMCD           Item Market Cod
     C                     MOVEL*BLANK    #1P3ST           TF Co-Ownership
     C                     Z-ADD*ZERO     #1SKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     #1SLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     #1SMNB           Agrimetrics gra
     C                     MOVEL*BLANK    #1P4ST           PA Base Avail R
     C                     Z-ADD*ZERO     #1CFNB           PM Pounds per H
     C                     Z-ADD*ZERO     #1CGNB           Item Frt Overag
     C                     Z-ADD*ZERO     #1ILNB           Packages per ca
     C                     Z-ADD*ZERO     #1CHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     #1CINB           PM Batch Size
     C                     Z-ADD*ZERO     #1CJNB           Package Level s
     C                     Z-ADD*ZERO     #1CMNB           Partial Item Co
     C                     Z-ADD*ZERO     #1CNNB           WIP Item Code
     C                     Z-ADD*ZERO     #1CRNB           WIP Reject Code
     C                     Z-ADD*ZERO     #1CSNB           Std Costing Uni
     C                     Z-ADD*ZERO     #1CVNB           FP Std Green We
     C                     Z-ADD*ZERO     #1CWNB           PM Standard LBS
     C                     Z-ADD*ZERO     #1CXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     #1CZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     #1C0NB           PM Finished LBS
     C                     MOVEL*BLANK    #1N1CD           SH Unused (was
     C                     Z-ADD*ZERO     #1B4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     #1B5NB           PM Line Number
     C                     MOVEL*BLANK    #1X5ST           Seconds Item
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL*BLANK    #1PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     #1BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #1BJNB           Bags Per Unit
     C                     MOVEL*BLANK    #1SUST           Export/Domestic
     C                     MOVEL*BLANK    #1SXCD           Item Category C
     C                     MOVEL*BLANK    #1S4CD           Item Category C
     C                     MOVEL*BLANK    #1SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    #1SZST           Fresh Sched As
     C                     MOVEL*BLANK    #1S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    #1XTCD           Item Meat Cost
     C                     MOVEL*BLANK    #1XUCD           UPC Code 2
     C                     Z-ADD*ZERO     #1F5WG           Item Target Pri
     C                     Z-ADD*ZERO     #1F6WG           Minimum Piece W
     C                     Z-ADD*ZERO     #1F7WG           Maximum Piece W
     C                     Z-ADD*ZERO     #1BLNB           Seaboard Equiva
     C                     MOVEL*BLANK    #1S2ST           Scheduling Posi
     C                     MOVEL*BLANK    #1S4ST           Sold 100% Froze
     C                     MOVEL*BLANK    #1S6ST           Value Added Sts
     C                     MOVEL*BLANK    #1S8ST           Label Type
     C                     MOVEL*BLANK    #1S9ST           Item TF Exempt
     C                     MOVEL*BLANK    #1TCST           Item TF Classif
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #DADTX           Name
     C                     MOVEL*BLANK    #1AVNA           Description Lin
     C                     MOVEL*BLANK    #1AWNA           Description Lin
     C                     MOVEL*BLANK    #1N0CD           Item Type Code
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     Z-ADD*ZERO     #DBOXI           Box iD
     C                     MOVEL*BLANK    #1ADCD           U/M - Primary
     C                     MOVEL*BLANK    #1Q1CD           Default Warehou
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     MOVEL*BLANK    #1TDST           Default Workcen
     C                     MOVEL*BLANK    #DHMTX           Condition Desc.
     C                     Z-ADD*ZERO     #1AIWG           Unit Weight
     C                     Z-ADD*ZERO     #1A3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    #DEPST           CIE Use Age Day
     C                     Z-ADD*ZERO     #1BNNB           Production Qty
     C                     Z-ADD*ZERO     #1SWGH           Std Weight/Head
     C                     MOVEL*BLANK    #1SVST           Print On Schedu
     C                     MOVEL*BLANK    #1S0CD           Item Primal Sch
     C                     MOVEL*BLANK    #DYMTX           Text USR 8
     C                     MOVEL*BLANK    #1XRCD           Primal Group Co
     C                     MOVEL*BLANK    #DENST           Allocation Meth
     C                     MOVEL*BLANK    #DHNTX           Condition Desc.
     C                     MOVEL*BLANK    #DKUAA           CIE Capacity Co
     C                     MOVEL*BLANK    #DUVNA           PS Prod Capacit
     C                     MOVEL*BLANK    #DEMST           Plan Production
     C                     MOVEL*BLANK    #DSETX           Text USR 23
     C                     MOVEL*BLANK    #1S2CD           Item Prod Sched
     C                     MOVEL*BLANK    #DD0ST           Produce on Sund
     C                     MOVEL*BLANK    #DD2ST           Produce on Mond
     C                     MOVEL*BLANK    #DD6ST           Produce on Tues
     C                     MOVEL*BLANK    #DWESP           Produce on Wedn
     C                     MOVEL*BLANK    #DEDST           Produce on Thur
     C                     MOVEL*BLANK    #DEFST           Produce on Frid
     C                     MOVEL*BLANK    #DEHST           Produce on Satu
     C                     MOVEL*BLANK    #DEQST           CIE MPR Report
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     MOVEL*BLANK    #DHKNA           Status Descript
     C                     MOVEL*BLANK    #DYPSX           Record Status 1
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BZREJU fields to screen
      *================================================================
     C                     MOVELBZL7NA    #1L7NA           Item Label Line
     C                     MOVELBZL8NA    #1L8NA           Item Label Line
     C                     MOVELBZL6NA    #1L6NA           Item Label Line
     C                     MOVELBZMFNA    #1MFNA           Item Label Line
     C                     Z-ADDBZURTN    #1URTN           Number Cases On
     C                     MOVELBZX7ST    #1X7ST           Unit Weight Cha
     C                     MOVELBZAVST    #1AVST           Catch Weight St
     C                     Z-ADDBZC0WG    #1C0WG           Maximum Weight
     C                     Z-ADDBZCZWG    #1CZWG           Minimum Weight
     C                     MOVELBZS5ST    #1S5ST           Maximum Shifts
     C                     Z-ADDBZAWPC    #1AWPC           Conversion Fact
     C                     MOVELBZLXST    #1LXST           Operation Facto
     C                     MOVELBZAECD    #1AECD           U/M - Second
     C                     Z-ADDBZAXPC    #1AXPC           Conversion Fact
     C                     MOVELBZLYST    #1LYST           Operation Facto
     C                     MOVELBZAFCD    #1AFCD           U/M - Third
     C                     MOVELBZAICD    #1AICD           U/M - Pricing
     C                     MOVELBZHICD    #1HICD           Quality Level
     C                     MOVELBZRBCD    #1RBCD           Item Level
     C                     MOVELBZFZST    #1FZST           Production Date
     C                     Z-ADDBZAJC8    #1AJC8           Vendor - Item D
     C                     Z-ADDBZRINB    #1RINB           Item Structure
     C                     Z-ADDBZRHNB    #1RHNB           Item Structure
     C                     Z-ADDBZRGNB    #1RGNB           Item Structure
     C                     MOVELBZLNCD    #1LNCD           Default Commod
     C                     Z-ADDBZTFNB    #1TFNB           Transportation
     C                     MOVELBZX4ST    #1X4ST           Package Type Co
     C                     Z-ADDBZTMVA    #1TMVA           Maximum Audit V
     C                     Z-ADDBZTNVA    #1TNVA           Minimum Audit V
     C                     Z-ADDBZBLPR    #1BLPR           Market Overage
     C                     Z-ADDBZBMPR    #1BMPR           Standard Overag
     C                     MOVELBZLRCD    #1LRCD           Commodity Price
     C                     MOVELBZU9ST    #1U9ST           Item Pricing Op
     C                     Z-ADDBZCMCO    #1CMCO           Item Pricing Co
     C                     MOVELBZQ8CD    #1Q8CD           Price Method De
     C                     Z-ADDBZCHTM    #1CHTM           Fresh Chilling
     C                     MOVELBZQZCD    #1QZCD           Base/Conv/Loss
     C                     MOVELBZXWST    #1XWST           Variety/Rendere
     C                     MOVELBZXXST    #1XXST           Frozen Make to
     C                     MOVELBZVMST    #1VMST           Credit Item Sta
     C                     Z-ADDBZPPHE    #1PPHE           Pieces Per Head
     C                     MOVELBZR3CD    #1R3CD           Department Code
     C                     MOVELBZSDCD    #1SDCD           Group for Packa
     C                     Z-ADDBZICN1    #1ICN1           Item Category N
     C                     MOVELBZSVCD    #1SVCD           MTO Code
     C                     Z-ADDBZICN2    #1ICN2           Item Category N
     C                     MOVELBZSWCD    #1SWCD           Transp Equip Ty
     C                     Z-ADDBZV2NB    #1V2NB           Item Category N
     C                     Z-ADDBZITCN    #1ITCN           Item Category N
     C                     MOVELBZSYCD    #1SYCD           G/L Sub Code
     C                     Z-ADDBZITC5    #1ITC5           Item Category N
     C                     MOVELBZSZCD    #1SZCD           Item Structure
     C                     Z-ADDBZICN6    #1ICN6           Item Category N
     C                     Z-ADDBZICN7    #1ICN7           Item Category N
     C                     MOVELBZS1CD    #1S1CD           Item Exc Man Pr
     C                     Z-ADDBZICN8    #1ICN8           Item Category N
     C                     Z-ADDBZICN9    #1ICN9           Item Category N
     C                     MOVELBZS3CD    #1S3CD           Item Category C
     C                     Z-ADDBZICN0    #1ICN0           Item Category N
     C                     Z-ADDBZSFNB    #1SFNB           Pallet Tare Wei
     C                     Z-ADDBZSJNB    #1SJNB           Production Lead
     C                     MOVELBZLLCD    #1LLCD           Packaging Code
     C                     MOVELBZLMCD    #1LMCD           Item Market Cod
     C                     MOVELBZP3ST    #1P3ST           TF Co-Ownership
     C                     Z-ADDBZSKNB    #1SKNB           Agrimetrics gro
     C                     Z-ADDBZSLNB    #1SLNB           Agrimetrics pac
     C                     Z-ADDBZSMNB    #1SMNB           Agrimetrics gra
     C                     MOVELBZP4ST    #1P4ST           PA Base Avail R
     C                     Z-ADDBZCFNB    #1CFNB           PM Pounds per H
     C                     Z-ADDBZCGNB    #1CGNB           Item Frt Overag
     C                     Z-ADDBZILNB    #1ILNB           Packages per ca
     C                     Z-ADDBZCHNB    #1CHNB           Use/Freeze/Sell
     C                     Z-ADDBZCINB    #1CINB           PM Batch Size
     C                     Z-ADDBZCJNB    #1CJNB           Package Level s
     C                     Z-ADDBZCMNB    #1CMNB           Partial Item Co
     C                     Z-ADDBZCNNB    #1CNNB           WIP Item Code
     C                     Z-ADDBZCRNB    #1CRNB           WIP Reject Code
     C                     Z-ADDBZCSNB    #1CSNB           Std Costing Uni
     C                     Z-ADDBZCVNB    #1CVNB           FP Std Green We
     C                     Z-ADDBZCWNB    #1CWNB           PM Standard LBS
     C                     Z-ADDBZCXNB    #1CXNB           PM Raw Meat LBS
     C                     Z-ADDBZCZNB    #1CZNB           PM Formula LBS/
     C                     Z-ADDBZC0NB    #1C0NB           PM Finished LBS
     C                     MOVELBZN1CD    #1N1CD           SH Unused (was
     C                     Z-ADDBZB4NB    #1B4NB           PM R/M Type Cod
     C                     Z-ADDBZB5NB    #1B5NB           PM Line Number
     C                     MOVELBZX5ST    #1X5ST           Seconds Item
     C                     MOVELBZX6ST    #1X6ST           Print on Realiz
     C                     MOVELBZPCCT    #1PCCT           Piece Count Ite
     C                     Z-ADDBZBDNB    #1BDNB           Pieces Per Bag
     C                     Z-ADDBZBJNB    #1BJNB           Bags Per Unit
     C                     MOVELBZSUST    #1SUST           Export/Domestic
     C                     MOVELBZSXCD    #1SXCD           Item Category C
     C                     MOVELBZS4CD    #1S4CD           Item Category C
     C                     MOVELBZSYST    #1SYST           Fresh Inv Alloc
     C                     MOVELBZSZST    #1SZST           Fresh Sched As
     C                     MOVELBZS1ST    #1S1ST           Frozen Inv Allo
     C                     MOVELBZXTCD    #1XTCD           Item Meat Cost
     C                     MOVELBZXUCD    #1XUCD           UPC Code 2
     C                     Z-ADDBZF5WG    #1F5WG           Item Target Pri
     C                     Z-ADDBZF6WG    #1F6WG           Minimum Piece W
     C                     Z-ADDBZF7WG    #1F7WG           Maximum Piece W
     C                     Z-ADDBZBLNB    #1BLNB           Seaboard Equiva
     C                     MOVELBZS2ST    #1S2ST           Scheduling Posi
     C                     MOVELBZS4ST    #1S4ST           Sold 100% Froze
     C                     MOVELBZS6ST    #1S6ST           Value Added Sts
     C                     MOVELBZS8ST    #1S8ST           Label Type
     C                     MOVELBZS9ST    #1S9ST           Item TF Exempt
     C                     MOVELBZTCST    #1TCST           Item TF Classif
     C                     MOVELBZUVST    #1UVST           EDI Status 1
     C                     MOVELBZUWST    #1UWST           EDI Status 2
     C                     MOVELBZUXST    #1UXST           EDI Status 3
     C                     Z-ADDBZAATM    #1AATM           Job Time
     C                     MOVELBZAYNA    #1AYNA           User Id
     C                     MOVELBZA0NA    #1A0NA           Job Name
     C                     Z-ADDBZAXDT    #1AXDT           Job Date
     C                     Z-ADDBZAIC3    #1AIC3           Company Number
     C                     Z-ADDBZHGCD    #1HGCD           Item Code
     C                     MOVELBZAVNA    #1AVNA           Description Lin
     C                     MOVELBZAWNA    #1AWNA           Description Lin
     C                     MOVELBZN0CD    #1N0CD           Item Type Code
     C                     MOVELBZADCD    #1ADCD           U/M - Primary
     C                     MOVELBZQ1CD    #1Q1CD           Default Warehou
     C                     MOVELBZTDST    #1TDST           Default Workcen
     C                     Z-ADDBZAIWG    #1AIWG           Unit Weight
     C                     Z-ADDBZA3WG    #1A3WG           Misc Tare Weigh
     C                     Z-ADDBZBNNB    #1BNNB           Production Qty
     C                     Z-ADDBZSWGH    #1SWGH           Std Weight/Head
     C                     MOVELBZSVST    #1SVST           Print On Schedu
     C                     MOVELBZS0CD    #1S0CD           Item Primal Sch
     C                     MOVELBZXRCD    #1XRCD           Primal Group Co
     C                     MOVELBZS2CD    #1S2CD           Item Prod Sched
     C                     MOVELBZVSST    #1VSST           Record Status
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP6M8NB    #PM8NB           System Value Nu
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
      * Check reference to Company Name and Address
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * USER: Initialize key screen
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0003    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Warehouse Descr
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    WL0004           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Package Item Type RT - Packaging Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN ARAIC3    WQSC01           Company Number
     C           *LIKE     DEFN ARHGCD    WQSC02           Item Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
      * Setup key
     C                     Z-ADDWL0005    WQSC01           Company Number
     C                     Z-ADDWL0007    WQSC02           Item Code
      * Establish starting position
     C           KRSSC     SETLL@ARREOE                    *
     C           KRSSC     READE@ARREOE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2982' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Pckg Item Type
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Pckg Item Type is Bags
     C           ARI5SX    IFEQ 'BG'                       *IF
     C           ARI5SX    OREQ 'B2'
     C           ARI5SX    OREQ 'B1'
     C           ARI5SX    OREQ 'B4'
     C           ARI5SX    OREQ 'B5'
     C           ARI5SX    OREQ 'B3'
     C           ARI5SX    OREQ 'P1'
     C           ARI5SX    OREQ 'P2'
      * PAR = DB1 By name
     C                     MOVELARI5SX    WL0006           Pckg Item Type
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@ARREOE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Incl in Misc Tare RT - Packaging Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           CAAIC3           Company Number
     C                     KFLD           CAI5SX           Pckg Item Type
      * Setup key
     C                     Z-ADDWL0008    CAAIC3           Company Number
     C                     MOVELWL0009    CAI5SX           Pckg Item Type
      * Establish starting position
     C           KRSSD     CHAIN@CARENX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3168' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0010           Incl in Misc Ta
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELCAM0SX    WL0010           Incl in Misc Ta
     C                     GOTO SDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv CIE for Item      RT - Company Item Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FDAIC3    WQSE01           Company Number
     C           *LIKE     DEFN FDHGCD    WQSE02           Item Code
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Item Code
      * Setup key
     C                     Z-ADDBZAIC3    WQSE01           Company Number
     C                     Z-ADDBZHGCD    WQSE02           Item Code
      * Establish starting position
     C           KRSSE     SETLL@FDREAW                    *
     C           KRSSE     READE@FDREAW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4125' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DD0ST           Produce on Sund
     C                     MOVEL*BLANK    #DD2ST           Produce on Mond
     C                     MOVEL*BLANK    #DD6ST           Produce on Tues
     C                     MOVEL*BLANK    #DWESP           Produce on Wedn
     C                     MOVEL*BLANK    #DEDST           Produce on Thur
     C                     MOVEL*BLANK    #DEFST           Produce on Frid
     C                     MOVEL*BLANK    #DEHST           Produce on Satu
     C                     MOVEL*BLANK    #DEMST           Plan Production
     C                     MOVEL*BLANK    #DENST           Allocation Meth
     C                     MOVEL*BLANK    #DEPST           CIE Use Age Day
     C                     MOVEL*BLANK    #DEQST           CIE MPR Report
     C                     MOVEL*BLANK    #DKUAA           CIE Capacity Co
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFDD0ST    #DD0ST           Produce on Sund
     C                     MOVELFDD2ST    #DD2ST           Produce on Mond
     C                     MOVELFDD6ST    #DD6ST           Produce on Tues
     C                     MOVELFDWESP    #DWESP           Produce on Wedn
     C                     MOVELFDEDST    #DEDST           Produce on Thur
     C                     MOVELFDEFST    #DEFST           Produce on Frid
     C                     MOVELFDEHST    #DEHST           Produce on Satu
     C                     MOVELFDEMST    #DEMST           Plan Production
     C                     MOVELFDENST    #DENST           Allocation Meth
     C                     MOVELFDEPST    #DEPST           CIE Use Age Day
     C                     MOVELFDEQST    #DEQST           CIE MPR Report
     C                     MOVELFDKUAA    #DKUAA           CIE Capacity Co
     C           KRSSE     READE@FDREAW                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Orders Alloc y/n  RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    P8E5ST           USR Output Only
      * Declare restrictor key work fields
     C           *LIKE     DEFN KNAIC3    WQSF01           Company Number
     C           *LIKE     DEFN KNHGCD    WQSF02           Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Item Code
      * Setup key
     C                     Z-ADDBZAIC3    WQSF01           Company Number
     C                     Z-ADDBZHGCD    WQSF02           Item Code
      * Establish starting position
     C           KRSSF     SETLL@KNCPVP                    *
     C           KRSSF     READE@KNCPVP                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.OD Weight Scheduled is Greater than zero
      *   |- c2    : DB1.OD Weight Inv Sched is Greater than zero
      *   '-
     C           KNFLWG    IFGT 0                          *IF
     C           KNF3WG    ORGT 0                          *OR
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * CASE: LCL.Header Status is Not Comp/Canc/Conf
     C           YL0005    IFEQ 'L'                        *IF
     C           YL0005    OREQ 'A'
     C           YL0005    OREQ 'E'
     C           YL0005    OREQ 'H'
     C                     MOVEL'Y'       P8E5ST           USR Output Only
     C                     GOTO SFEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@KNCPVP                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDKNAIC3    BEAIC3           Company Number
     C                     Z-ADDKNC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    YL0005           Header Status
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Record Status     RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADDBZHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSSH     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DYPSX           Record Status 1
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELBYVSST    #DYPSX           Record Status 1
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Val Item Category     Rt - Item Category  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     Z-ADDWL0011    JIAIC3           Company Number
     C                     Z-ADDWL0012    JIUSNB           Item Category N
     C                     MOVELWL0013    JISLCD           Item Category C
      * Establish starting position
     C           KRSSI     CHAIN@JIREXX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1854' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0014           Return Code Usr
     C                     MOVEL*BLANK    WL0015           Record Status 3
     C                     MOVEL'Y2U0005' WL0014           Return Code Usr
     C                     MOVEL*BLANK    WL0015           Record Status 3
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVEL*BLANK    WL0014           Return Code Usr
     C                     MOVELJIVSST    WL0015           Record Status 3
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV PS Prod Cap Desc  RT - PS Production Capacity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BFSFAA           PS Prod Capacit
      * Setup key
     C                     MOVELWL0016    BFSFAA           PS Prod Capacit
      * Establish starting position
     C           KRSSJ     CHAIN@BFRERV              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4671' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0017           PS Prod Capacit
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBFUVNA    WL0017           PS Prod Capacit
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Box-Company Item   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    W0RTN            *Return code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#DBOXI    BZHGCD           Item Code
      * Establish starting position
     C           KRSSK     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Item Type Code is Packaging and Supplies
      *   |- c2    : DB1.Package Type Code is Box Kit
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BZN0CD    IFEQ 'PS'                       *IF
     C           BZX4ST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Record Status is Deleted & Inactive
     C           BZVSST    IFEQ 'D'                        *IF
     C           BZVSST    OREQ 'I'
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * VAL Shipping Co WHS   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBBWC3    WQSL01           Shipping Compan
     C           *LIKE     DEFN WBAJCD    WQSL02           Warehouse Code
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Shipping Compan
     C                     KFLD           WQSL02           Warehouse Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSL01           Shipping Compan
     C                     MOVEL#1Q1CD    WQSL02           Warehouse Code
      * Establish starting position
     C           KRSSL     SETLL@ADREWA                    *
     C           KRSSL     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBF8NA    #DF8NA           Warehouse Descr
     C           KRSSL     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMINFN    BEGSR
      *================================================================
      * Val Item Fields Rules  IF - Item Default  * 
      *================================================================
      * Val Item Fields Rules  IF
      * Special Note will need Catch Weight Sts Before image
      * when populating the parms.
      * Field validation without Item Type
     C                     EXSR UESUBR                     Field validatio
      * Item Type validation rules and field validation
     C                     EXSR UGSUBR                     Item Type valid
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv On Hand Qty Item   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0007           Quantity on Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0HGCD    WQSN01           Item Code
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    WQSN01           Item Code
      * Establish starting position
     C           KRSSN     SETLL@B0REAF                    *
     C           KRSSN     READE@B0REAF                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B0DDQT    YL0007           Quantity on Han
     C           KRSSN     READE@B0REAF                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Commod U/M         RT - Commodity Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           FZLRCD           Commodity Price
      * Setup key
     C                     MOVEL#1LRCD    FZLRCD           Commodity Price
      * Establish starting position
     C           KRSSO     CHAIN@FZREDN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1220' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0008           U/M - Pricing
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFZAICD    YL0008           U/M - Pricing
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Item Type Code     RT - Item Default  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD#1CNNB    BYHGCD           Item Code
      * Establish starting position
     C           KRSSP     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Item Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYN0CD    YL0009           Item Type Code
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Item Category /Itm RT - Item Category  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCUSNB    WQSQ01           Item Category N
     C           *LIKE     DEFN WCSLCD    WQSQ02           Item Category C
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Item Category N
     C                     KFLD           WQSQ02           Item Category C
      * Setup key
     C                     Z-ADD04        WQSQ01           Item Category N
     C                     MOVEL#1SYCD    WQSQ02           Item Category C
      * Establish starting position
     C           KRSSQ     SETLL@JIREU7                    *
     C           KRSSQ     READE@JIREU7                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1854' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     MOVELWCAUNA    YL0011           Description
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@JIREU7                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Last Market PrcDte RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F0LQCD    WQSR01           Commodity Marke
     C           *LIKE     DEFN F0LRCD    WQSR02           Commodity Price
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Commodity Marke
     C                     KFLD           WQSR02           Commodity Price
      * Setup key
     C                     MOVEL#1LNCD    WQSR01           Commodity Marke
     C                     MOVEL#1LRCD    WQSR02           Commodity Price
      * Establish starting position
     C           KRSSR     SETLL@F0CPEP                    *
     C           KRSSR     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0013           Market Price Da
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDF0EQDT    YL0013           Market Price Da
     C                     GOTO SREXIT                     *QUIT
     C           KRSSR     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Prod Dept valid   RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN I5R3CD    WQSS01           Department Code
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Department Code
      * Setup key
     C                     MOVEL#1R3CD    WQSS01           Department Code
      * Establish starting position
     C           KRSSS     SETLL@I5REU5                    *
     C           KRSSS     READE@I5REU5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1757' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUMYNA           Department Desc
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELI5MYNA    WUMYNA           Department Desc
     C                     GOTO SSEXIT                     *QUIT
     C           KRSSS     READE@I5REU5                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STINFN    BEGSR
      *================================================================
      * Chg Company Item Spec  IF - Company Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        EDI Status 1
     C                     MOVEL*BLANK    WN0002  1        EDI Status 2
     C                     MOVEL*BLANK    WN0003  1        EDI Status 3
     C                     MOVEL*BLANK    WN0004 12        UPC Code 2
     C                     MOVEL*BLANK    WN0005  2        Item TF Exempt
     C                     MOVEL*BLANK    WN0006  3        Item TF Classif
      *
      * Chg Company Item Spec  IF
      * Chg Company Item Spec  CH - Company Item  * 
     C                     EXSR SUCHRC
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Plt Floor Intrfc, Item Str Chg, Pricing Audit. BOXID - BOM
     C                     EXSR UKSUBR                     Plt Floor Intrf
     C                     END                             *FI
      *  FP1054 RMC- update the days and plan prod sts, alloc mthd
      *  E2073  RMC- update Use age days over max
      *  E2247  RMC- update CIE MPR report to usda
      *  E2885  RMC- update CIE capacity code
      * Rtv Upd CIE frm ItmSpcXF - Company Item Ext  * 
     C                     CALL 'PMF5XFR'              90  Rtv Upd CIE frm
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0285  30       Company Number
     C                     PARM #1HGCD    WQ0286  70       Item Code
     C                     PARM #DD0ST    WQ0287  1        Produce on Sund
     C                     PARM #DD2ST    WQ0288  1        Produce on Mond
     C                     PARM #DD6ST    WQ0289  1        Produce on Tues
     C                     PARM #DWESP    WQ0290  1        Produce on Wedn
     C                     PARM #DEDST    WQ0291  1        Produce on Thur
     C                     PARM #DEFST    WQ0292  1        Produce on Frid
     C                     PARM #DEHST    WQ0293  1        Produce on Satu
     C                     PARM #DEMST    WQ0294  1        Plan Production
     C                     PARM #DENST    WQ0295  1        Allocation Meth
     C                     PARM #DEPST    WQ0296  2        CIE Use Age Day
     C                     PARM #DEQST    WQ0297  2        CIE MPR Report
     C                     PARM #DKUAA    WQ0298  6        CIE Capacity Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMF5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     994546*
     C                     SETON                     474849*
     C                     SETON                     505143*
     C                     SETON                     413652*
     C                     SETON                     42    *
     C                     END
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Company Item Spec  CH - Company Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0007 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0008  60       Job Time
     C                     MOVEL*BLANK    WN0009 10        User Id
     C                     MOVEL*BLANK    WN0010 10        Job Name
     C                     Z-ADD*ZERO     WN0011  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BZREJV
     C                     Z-ADD#1AIC3    BZAIC3           Company Number
     C                     Z-ADD#1HGCD    BZHGCD           Item Code
      *
     C           KLCHSU    KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
     C           KLCHSU    CHAIN@BZREJV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CABZREL0'MDACP
     C                     MOVEL'@BZREJV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * USER: Processing after Data read
      * Notification of change
     C                     EXSR UJSUBR                     Notification of
      * RMC added 2.28.22
      * CASE: DB1.Record Status NE PAR.Record Status
     C           BZVSST    IFNE #1VSST                     *IF
      * Rtv Chg Pckg BOM to I XF - Packaging BOM  * 
     C                     CALL 'PUV2XFR'              90  Rtv Chg Pckg BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BZAIC3    WQ0056  30       Company Number
     C                     PARM BZHGCD    WQ0057  70       Item Code
     C                     PARM #1VSST    WQ0058  1        Record Status
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUV2XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9953  *
     C                     END
     C                     END                             *FI
      * Move non-key fields to @BZREJV
     C                     MOVEL#1AVNA    BZAVNA    P      Description Lin
     C                     MOVEL#1AWNA    BZAWNA    P      Description Lin
     C                     MOVEL#1L7NA    BZL7NA    P      Item Label Line
     C                     MOVEL#1L8NA    BZL8NA    P      Item Label Line
     C                     MOVEL#1L6NA    BZL6NA    P      Item Label Line
     C                     MOVEL#1MFNA    BZMFNA    P      Item Label Line
     C                     MOVEL#1ADCD    BZADCD    P      U/M - Primary
     C                     Z-ADD#1AWPC    BZAWPC           Conversion Fact
     C                     MOVEL#1LXST    BZLXST    P      Operation Facto
     C                     MOVEL#1AECD    BZAECD    P      U/M - Second
     C                     Z-ADD#1AXPC    BZAXPC           Conversion Fact
     C                     MOVEL#1LYST    BZLYST    P      Operation Facto
     C                     MOVEL#1AFCD    BZAFCD    P      U/M - Third
     C                     MOVEL#1AICD    BZAICD    P      U/M - Pricing
     C                     Z-ADD#1AIWG    BZAIWG           Unit Weight
     C                     MOVEL#1HICD    BZHICD    P      Quality Level
     C                     MOVEL#1RBCD    BZRBCD    P      Item Level
     C                     MOVEL#1FZST    BZFZST    P      Production Date
     C                     MOVEL#1AVST    BZAVST    P      Catch Weight St
     C                     Z-ADD#1CZWG    BZCZWG           Minimum Weight
     C                     Z-ADD#1C0WG    BZC0WG           Maximum Weight
     C                     Z-ADD#1URTN    BZURTN           Number Cases On
     C                     Z-ADD#1AJC8    BZAJC8           Vendor - Item D
     C                     Z-ADD#1RINB    BZRINB           Item Structure
     C                     Z-ADD#1RHNB    BZRHNB           Item Structure
     C                     Z-ADD#1RGNB    BZRGNB           Item Structure
     C                     MOVEL#1LNCD    BZLNCD    P      Default Commod
     C                     Z-ADD#1TFNB    BZTFNB           Transportation
     C                     MOVEL#1N0CD    BZN0CD    P      Item Type Code
     C                     MOVEL#1X4ST    BZX4ST    P      Package Type Co
     C                     Z-ADD#1TMVA    BZTMVA           Maximum Audit V
     C                     Z-ADD#1TNVA    BZTNVA           Minimum Audit V
     C                     Z-ADD#1BLPR    BZBLPR           Market Overage
     C                     Z-ADD#1BMPR    BZBMPR           Standard Overag
     C                     MOVEL#1LRCD    BZLRCD    P      Commodity Price
     C                     MOVEL#1U9ST    BZU9ST    P      Item Pricing Op
     C                     Z-ADD#1CMCO    BZCMCO           Item Pricing Co
     C                     MOVEL#1Q1CD    BZQ1CD    P      Default Warehou
     C                     MOVEL#1Q8CD    BZQ8CD    P      Price Method De
     C                     Z-ADD#1CHTM    BZCHTM           Fresh Chilling
     C                     MOVEL#1QZCD    BZQZCD    P      Base/Conv/Loss
     C                     MOVEL#1XWST    BZXWST    P      Variety/Rendere
     C                     MOVEL#1XXST    BZXXST    P      Frozen Make to
     C                     MOVEL#1VMST    BZVMST    P      Credit Item Sta
     C                     Z-ADD#1SWGH    BZSWGH           Std Weight/Head
     C                     Z-ADD#1PPHE    BZPPHE           Pieces Per Head
     C                     MOVEL#1R3CD    BZR3CD    P      Department Code
     C                     MOVEL#1SDCD    BZSDCD    P      Group for Packa
     C                     Z-ADD#1ICN1    BZICN1           Item Category N
     C                     MOVEL#1SVCD    BZSVCD    P      MTO Code
     C                     Z-ADD#1ICN2    BZICN2           Item Category N
     C                     MOVEL#1SWCD    BZSWCD    P      Transp Equip Ty
     C                     Z-ADD#1V2NB    BZV2NB           Item Category N
     C                     MOVEL#1SXCD    BZSXCD    P      Item Category C
     C                     Z-ADD#1ITCN    BZITCN           Item Category N
     C                     MOVEL#1SYCD    BZSYCD    P      G/L Sub Code
     C                     Z-ADD#1ITC5    BZITC5           Item Category N
     C                     MOVEL#1SZCD    BZSZCD    P      Item Structure
     C                     Z-ADD#1ICN6    BZICN6           Item Category N
     C                     MOVEL#1S0CD    BZS0CD    P      Item Primal Sch
     C                     Z-ADD#1ICN7    BZICN7           Item Category N
     C                     MOVEL#1S1CD    BZS1CD    P      Item Exc Man Pr
     C                     Z-ADD#1ICN8    BZICN8           Item Category N
     C                     MOVEL#1S2CD    BZS2CD    P      Item Prod Sched
     C                     Z-ADD#1ICN9    BZICN9           Item Category N
     C                     MOVEL#1S3CD    BZS3CD    P      Item Category C
     C                     Z-ADD#1ICN0    BZICN0           Item Category N
     C                     MOVEL#1S4CD    BZS4CD    P      Item Category C
     C                     Z-ADD#1SFNB    BZSFNB           Pallet Tare Wei
     C                     Z-ADD#1A3WG    BZA3WG           Misc Tare Weigh
     C                     Z-ADD#1SJNB    BZSJNB           Production Lead
     C                     MOVEL#1LLCD    BZLLCD    P      Packaging Code
     C                     MOVEL#1LMCD    BZLMCD    P      Item Market Cod
     C                     MOVEL#1P3ST    BZP3ST    P      TF Co-Ownership
     C                     Z-ADD#1SKNB    BZSKNB           Agrimetrics gro
     C                     Z-ADD#1SLNB    BZSLNB           Agrimetrics pac
     C                     Z-ADD#1SMNB    BZSMNB           Agrimetrics gra
     C                     MOVEL#1P4ST    BZP4ST    P      PA Base Avail R
     C                     Z-ADD#1CFNB    BZCFNB           PM Pounds per H
     C                     Z-ADD#1CGNB    BZCGNB           Item Frt Overag
     C                     Z-ADD#1ILNB    BZILNB           Packages per ca
     C                     Z-ADD#1CHNB    BZCHNB           Use/Freeze/Sell
     C                     Z-ADD#1CINB    BZCINB           PM Batch Size
     C                     Z-ADD#1CJNB    BZCJNB           Package Level s
     C                     Z-ADD#1CMNB    BZCMNB           Partial Item Co
     C                     Z-ADD#1CNNB    BZCNNB           WIP Item Code
     C                     Z-ADD#1CRNB    BZCRNB           WIP Reject Code
     C                     Z-ADD#1CSNB    BZCSNB           Std Costing Uni
     C                     Z-ADD#1CVNB    BZCVNB           FP Std Green We
     C                     Z-ADD#1CWNB    BZCWNB           PM Standard LBS
     C                     Z-ADD#1CXNB    BZCXNB           PM Raw Meat LBS
     C                     Z-ADD#1CZNB    BZCZNB           PM Formula LBS/
     C                     Z-ADD#1C0NB    BZC0NB           PM Finished LBS
     C                     MOVEL#1N1CD    BZN1CD    P      SH Unused (was
     C                     Z-ADD#1B4NB    BZB4NB           PM R/M Type Cod
     C                     Z-ADD#1B5NB    BZB5NB           PM Line Number
     C                     MOVEL#1X5ST    BZX5ST    P      Seconds Item
     C                     MOVEL#1X6ST    BZX6ST    P      Print on Realiz
     C                     MOVEL#1X7ST    BZX7ST    P      Unit Weight Cha
     C                     MOVEL#1PCCT    BZPCCT    P      Piece Count Ite
     C                     Z-ADD#1BDNB    BZBDNB           Pieces Per Bag
     C                     Z-ADD#1BJNB    BZBJNB           Bags Per Unit
     C                     MOVEL#1SUST    BZSUST    P      Export/Domestic
     C                     MOVEL#1SVST    BZSVST    P      Print On Schedu
     C                     MOVEL#1SYST    BZSYST    P      Fresh Inv Alloc
     C                     MOVEL#1SZST    BZSZST    P      Fresh Sched As
     C                     MOVEL#1S1ST    BZS1ST    P      Frozen Inv Allo
     C                     MOVEL#1XRCD    BZXRCD    P      Primal Group Co
     C                     MOVEL#1XTCD    BZXTCD    P      Item Meat Cost
     C                     Z-ADD#1F5WG    BZF5WG           Item Target Pri
     C                     Z-ADD#1F6WG    BZF6WG           Minimum Piece W
     C                     Z-ADD#1F7WG    BZF7WG           Maximum Piece W
     C                     Z-ADD#1BLNB    BZBLNB           Seaboard Equiva
     C                     Z-ADD#1BNNB    BZBNNB           Production Qty
     C                     MOVEL#1S2ST    BZS2ST    P      Scheduling Posi
     C                     MOVEL#1S4ST    BZS4ST    P      Sold 100% Froze
     C                     MOVEL#1S5ST    BZS5ST    P      Maximum Shifts
     C                     MOVEL#1S6ST    BZS6ST    P      Value Added Sts
     C                     MOVEL#1S8ST    BZS8ST    P      Label Type
     C                     MOVEL#1S9ST    BZS9ST    P      Item TF Exempt
     C                     MOVEL#1TCST    BZTCST    P      Item TF Classif
     C                     MOVEL#1TDST    BZTDST    P      Default Workcen
     C                     MOVEL#1UVST    BZUVST    P      EDI Status 1
     C                     MOVEL#1UWST    BZUWST    P      EDI Status 2
     C                     MOVEL#1UXST    BZUXST    P      EDI Status 3
     C                     MOVEL#1VSST    BZVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     BZAATM           Job Time
     C                     MOVEL##USR     BZAYNA           User Id
     C                     MOVEL##JOB     BZA0NA           Job Name
     C                     Z-ADD##JDT     BZAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BZREJV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADDBZAIC3    KMAIC3           Company Number
     C                     MOVEL@CN,012   KMV8CD           Company Value C
      * Establish starting position
     C           KRSSV     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKMBXTX    WUCLAA           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0012    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSSW     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    P2I6ST           Allow Multi-Com
     C                     MOVELDRMPNA    P2MPNA           Default Printer
     C                     MOVELDRBCCD    P2BCCD           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0028           Company Number
     C                     MOVELDRBUVN    WN0013           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0018    DTAJVN           User Profile Na
     C                     MOVELWL0019    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSX     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0020           Company Number
     C                     MOVELDTAJCD    WL0021           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSY01           Application Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSY01           Application Cod
     C                     MOVEL'C/S'     WQSY01           Application Cod
      * Establish starting position
     C           KRSSY     SETLL@DNRESF                    *
     C           KRSSY     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C           KRSSY     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSZ01           Application Cod
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSZ01           Application Cod
      * Establish starting position
     C           KRSSZ     SETLL@DNRESF                    *
     C           KRSSZ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSZ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Move of various fields to screens and get descriptions.
      *================================================================
      * Populate descriptions and conditions
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Item Type Code
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294118   Y2LSNO  70       List number
     C                     PARM #1N0CD    W0INVL 25        Item Type Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Q1CD    WL0003    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DF8NA    P      Warehouse Descr
      * Rtv Box ID for Item   XF - Item Bill Of Material  * 
     C                     CALL 'PPOEXFR'              90  Rtv Box ID for
     C                     PARM *BLANK    W0RTN   7
     C                     PARM BZAIC3    WQ0001  30       Company Number
     C                     PARM BZHGCD    WQ0002  70       Item Code
     C           #DBOXI    PARM *ZERO     WQ0003  70       Component Item
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPOEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADD#DBOXI    P7BOXI           Box iD
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Unit Weight Rules with Update on Company Item
      *================================================================
      * Set Allow Weight to Yes,
     C                     MOVEL'Y'       WUIFST           Allow Weight In
      * CASE: DTL.Item Type Code is FG/WP
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'WP'
      * If Catch Weight Sts = N (Std Weight every time)
      *                         (Unit weight will be maintained at itemlv
      * If Catch Weight Sts = Y (Unit weight will be maintained at complv
      * CASE: DTL.Catch Weight Status is no
     C           #1AVST    IFEQ 'N'                        *IF
      * Unit wgt is updated from the chg of Unit Wgt on the Item Default
     C                     MOVEL'N'       WUIFST           Allow Weight In
     C                     ELSE
      * CASE: DTL.Catch Weight Status is yes
     C           #1AVST    IFEQ 'Y'                        *IF
      * Once a company item has been created then the unit weight will
      * be maintained at the CoItem.  Item default unit's weight
      * will be displayed only.
     C                     MOVEL'Y'       WUIFST           Allow Weight In
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Item Type Code is Packaging and Supplies
     C           #1N0CD    IFEQ 'PS'                       *IF
      * Once a company item has been created then the unit weight will
      * be maintained at the CoItem.  Item default unit's weight
      * will be displayed only.
      * E00221 10/02/08 RMC - for PS: box weights not allowed if "BX" is
      * Included in Misc Tare. those wts are maintained in the edit packa
      * Rtv Package Item Type RT - Packaging Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDBZAIC3    WL0005           Company Number
     C                     Z-ADDBZHGCD    WL0007           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0002    P      Pckg Item Type
      * Rtv Incl in Misc Tare RT - Packaging Type  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     MOVELYL0002    WL0009    P      Pckg Item Type
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0003    P      Incl in Misc Ta
      * CASE: LCL.Incl in Misc Tare is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUIFST           Allow Weight In
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUIFST           Allow Weight In
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Item Type Code is Raw Material
     C           #1N0CD    IFEQ 'RM'                       *IF
      * Unit wgt is updated from the chg of Unit Wgt on the Item Default
     C                     MOVEL'N'       WUIFST           Allow Weight In
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Move of various fields to screens and get descriptions.
      *================================================================
      * Populate descriptions and conditions
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Item Type Code
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294118   Y2LSNO  70       List number
     C                     PARM #1N0CD    W0INVL 25        Item Type Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Status Description = Condition name of DTL.Record Status
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 25        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * 2nd -- Screen 2
      * RTV Whse Descrip       RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1Q1CD    WL0003    P      Warehouse Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DF8NA    P      Warehouse Descr
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Unit Weight Rules with Update on Company Item
      *================================================================
      * Set Allow Weight to Yes,
     C                     MOVEL'Y'       WUIFST           Allow Weight In
      * CASE: DTL.Item Type Code is FG/WP
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'WP'
      * If Catch Weight Sts = N (Std Weight every time)
      *                         (Unit weight will be maintained at itemlv
      * If Catch Weight Sts = Y (Unit weight will be maintained at complv
      * susan check
      * CASE: DTL.Catch Weight Status is no
     C           #1AVST    IFEQ 'N'                        *IF
      * Unit wgt is updated from the chg of Unit Wgt on the Item Default
     C                     MOVEL'N'       WUIFST           Allow Weight In
     C                     ELSE
      * CASE: DTL.Catch Weight Status is yes
     C           #1AVST    IFEQ 'Y'                        *IF
      * Once a company item has been created then the unit weight will
      * be maintained at the CoItem.  Item default unit's weight
      * will be displayed only.
     C                     MOVEL'Y'       WUIFST           Allow Weight In
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Item Type Code is Packaging and Supplies
     C           #1N0CD    IFEQ 'PS'                       *IF
      * Once a company item has been created then the unit weight will
      * be maintained at the CoItem.  Item default unit's weight
      * will be displayed only.
      * E00221 10/02/08 RMC - for PS: box weights not allowed if "BX" is
      * Included in Misc Tare. those wts are maintained in the edit packa
      * Rtv Package Item Type RT - Packaging Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0005           Company Number
     C                     Z-ADD#1HGCD    WL0007           Item Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    YL0002    P      Pckg Item Type
      * Rtv Incl in Misc Tare RT - Packaging Type  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1AIC3    WL0008           Company Number
     C                     MOVELYL0002    WL0009    P      Pckg Item Type
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0010    YL0003    P      Incl in Misc Ta
      * CASE: LCL.Incl in Misc Tare is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUIFST           Allow Weight In
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUIFST           Allow Weight In
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.Item Type Code is Raw Material
     C           #1N0CD    IFEQ 'RM'                       *IF
      * Unit wgt is updated from the chg of Unit Wgt on the Item Default
     C                     MOVEL'N'       WUIFST           Allow Weight In
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Field validation without Item Type
      *================================================================
      * The following fields are being vaidated for all items with the
      * exceptions of Co-Packer.  Co-Packer we do not make and the
      * item structure type = 900.  When you see NCP,
      * that means only validate on a Non Co-Packer Item
      * CASE: PR2.Item Type Code is Packaging and Supplies
     C           #1N0CD    IFEQ 'PS'                       *IF
      * dont validate weight and conv factors for BOXES
     C                     ELSE
      * CASE: *OTHERWISE
      * Unit weight is required if Active Item
      * CASE: PR2.Unit Weight is Equal to zero
     C           #1AIWG    IFEQ 0                          *IF
      * CASE: PR2.Record Status is Active
     C           #1VSST    IFEQ 'A'                        *IF
      * Setup message data for message
      * Send message 'Catch weight weight reqd'
     C                     MOVEL'USR0514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Unit of measure, conversion, & oper, validation and data changes.
     C                     EXSR UFSUBR                     Unit of measure
      * If Second UM is LB, then Conversion Factor 1 must be = Unit Weigh
      * CASE: PR2.U/M - Second Dft is Pounds
     C           #1AECD    IFEQ 'LB'                       *IF
      * CASE: PR2.Conversion Factor 1 NE PR2.Unit Weight
     C           #1AWPC    IFNE #1AIWG                     *IF
      * Setup message data for message
      * Send message 'Conv Fct1 Not = Unit Wgt'
     C                     MOVEL'USR2320' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Third UM is LB, then Conversion Factor 1 must be = Unit Weight
      * CASE: PR2.U/M - Third Dft is Pounds
     C           #1AFCD    IFEQ 'LB'                       *IF
      * CASE: PR2.Conversion Factor 2 NE PR2.Unit Weight
     C           #1AXPC    IFNE #1AIWG                     *IF
      * Setup message data for message
     C                     Z-ADD#1AXPC    ZA0008           Conversion Fact
      * Send message 'Conv Fct2 Not = Unit Wgt'
     C                     MOVEL'USR2321' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Pricing UOM must be set up as primary, second or third UOM
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PR2.U/M - Pricing Dft NE PR2.U/M - Primary Dft
      *   |- c2    : PR2.U/M - Pricing Dft NE PR2.U/M - Second Dft
      *   |- c3    : PR2.U/M - Pricing Dft NE PR2.U/M - Third Dft
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AICD    IFNE #1ADCD                     *IF
     C           #1AICD    IFNE #1AECD                     *IF
     C           #1AICD    IFNE #1AFCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1ADCD    ZA0009           U/M - Primary D
     C                     MOVEL#1AECD    ZA0010           U/M - Second Df
     C                     MOVEL#1AFCD    ZA0011           U/M - Third Dft
      * Send message 'U/M-base not equal 1,2or3'
     C                     MOVEL'USR0543' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Chg mode and Catch wgt sts is chg send info msg - NCP
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : PR3.Catch Weight Status NE PR2.Catch Weight Status
      *   |- c2    : PR1.*Program mode is *CHANGE
      *   |- c3    : PR2.Item Structure Type Code is NE 900
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AVST    IFNE #1AVST                     *IF
     C           W0PMD     IFEQ 'CHG'                      *IF
     C           #1RGNB    IFNE 900                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv On Hand Qty Item   RT - Item Balance  * 
     C                     EXSR SNRVGN
      * CASE: LCL.Quantity on Hand - U/M1 is not equal zero
     C           YL0007    IFNE 0                          *IF
      * Send message 'Catch Weight Status CHG'
     C                     MOVEL'USR1974' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Edit Commodity Group U/M to EQ Pricing U/M
      * CASE: PR2.Commodity Price Group is Not Blank
     C           #1LRCD    IFNE *BLANK                     *IF
      * RTV Commod U/M         RT - Commodity Group  * 
     C                     EXSR SORVGN
      * CASE: PR2.U/M - Pricing Dft NE LCL.U/M - Pricing
     C           #1AICD    IFNE YL0008                     *IF
      * Setup message data for message
     C                     MOVEL#1LRCD    ZA0012           Commodity Price
      * Send message 'Com Group U/M must= U/M P'
     C                     MOVEL'USR2165' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If a Pieces Count Item then Pieces/Bags and Pieces/Unit required
      * CASE: PR2.Piece Count Item is yes
     C           #1PCCT    IFEQ 'Y'                        *IF
      * CASE: PR2.Pieces Per Bag is EQ Zero
     C           #1BDNB    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1BDNB    ZA0013           Pieces Per Bag
      * Send message 'Pieces per Bag req'
     C                     MOVEL'USR2517' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PR2.Bags Per Unit is EQ Zero
     C           #1BJNB    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1BJNB    ZA0014           Bags Per Unit
      * Send message 'Bags per Unit req'
     C                     MOVEL'USR2518' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #1BJNB           Bags Per Unit
     C                     END                             *FI
      * Minimum Audit Value cant be greater than Maximum audit value
      * CASE: PR2.Minimum Audit Value GT PR2.Maximum Audit Value
     C           #1TNVA    IFGT #1TMVA                     *IF
      * Setup message data for message
      * Send message 'Audit Value Min gt Max'
     C                     MOVEL'USR3405' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Variety/Rendered then Std Weight/Head (Var/Ren) is required
      * CASE: PR2.Variety/Rendered/Cut is Variety/Rendered
     C           #1XWST    IFEQ 'R'                        *IF
     C           #1XWST    OREQ 'V'
      * CASE: PR2.Std Weight/Head (Var/Ren) is Equal to zero
     C           #1SWGH    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1SWGH    ZA0015           Std Weight/Head
      * Send message 'Std Wght Head can't be BL'
     C                     MOVEL'USR1866' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9938  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Minimum Wgt Per Case cannot be greater than Maximum Wgt Per Case
      * CASE: PR2.Minimum Weight Per Case GT PR2.Maximum Weight Per Case
     C           #1CZWG    IFGT #1C0WG                     *IF
      * Send message 'Weight Min LE Max'
     C                     MOVEL'USR2274' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Wip Item Code is entered, Item Type Code can not be = WIP -NCP
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PR2.WIP Item Code is Entered
      *   |- c2    : PR2.Item Structure Type Code is NE 900
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1CNNB    IFNE 0                          *IF
     C           #1RGNB    IFNE 900                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Item Type Code     RT - Item Default  * 
     C                     EXSR SPRVGN
      * CASE: LCL.Item Type Code USR is Work in Process
     C           YL0009    IFEQ 'WP'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert WIP Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CNNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CNNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0016           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0016           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Invalid WIP Item Code'
     C                     MOVEL'USR3276' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Unit of measure, conversion, & oper, validation and data changes
      *================================================================
      * If U/M 2 entered then Conv. Factor 1 & operation 1 is required
      * CASE: PR2.U/M - Second Dft is Entered
     C           #1AECD    IFNE *BLANK                     *IF
      * CASE: PR2.Conversion Factor 1 is Not Entered
     C           #1AWPC    IFEQ 0                          *IF
      * Setup message data for message
      * Send message 'Conversion Factor 1 req'd'
     C                     MOVEL'USR0364' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PR2.Operation Factor 1 is Not Entered
     C           #1LXST    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'Operation Factor 1 req'd'
     C                     MOVEL'USR1011' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If U/M 3 entered then U/M 2, Conv. 2 & operation 2 required
      * CASE: PR2.U/M - Third Dft is Entered
     C           #1AFCD    IFNE *BLANK                     *IF
      * CASE: PR2.U/M - Second Dft is Not Entered
     C           #1AECD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1AECD    ZA0006           U/M - Second Df
     C                     Z-ADD#1AWPC    ZA0007           Conversion Fact
      * Send message 'U/M 2 required if U/M 3'
     C                     MOVEL'USR0886' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PR2.Conversion Factor 2 is Not Entered
     C           #1AXPC    IFEQ 0                          *IF
      * Setup message data for message
      * Send message 'Conversion Factor 2 req'd'
     C                     MOVEL'USR0365' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: PR2.Operation Factor 2 is Not Entered
     C           #1LYST    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'Operation Factor 2 req'd'
     C                     MOVEL'USR1012' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Clear conversion/operation factor 1 if u/m 2 not entered
      * CASE: PR2.U/M - Second Dft is Not Entered
     C           #1AECD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1AWPC           Conversion Fact
     C                     MOVEL*BLANK    #1LXST           Operation Facto
     C                     END                             *FI
      * Clear conversion/operation 2 if u/m 3 not entered
      * CASE: PR2.U/M - Third Dft is Not Entered
     C           #1AFCD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1AXPC           Conversion Fact
     C                     MOVEL*BLANK    #1LYST           Operation Facto
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Item Type validation rules and field validation
      *================================================================
      * The following fields are being vaidated for all items with the
      * exceptions of Co-Packer.  Co-Packer we do not make and the
      * item structure type = 900.
      * CASE: PR2.Item Type Code is Meat
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
     C           #1N0CD    OREQ 'WP'
      * If not a finished good, print on realization rpt = N
      * CASE: PR2.Item Type Code is Not Finished Good
     C           #1N0CD    IFNE 'FG'                       *IF
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1S6ST           Value Added Sts
     C                     END                             *FI
     C                     MOVELYL0010    #1X4ST           Package Type Co
      * Finished Goods Only
      * CASE: PR2.Item Type Code is Finished Good
     C           #1N0CD    IFEQ 'FG'                       *IF
      * Variety/Rendered/Cut = Cut then Base/Conv/Loss Item is required
      * CASE: PR2.Variety/Rendered/Cut is Cut
     C           #1XWST    IFEQ 'C'                        *IF
      * CASE: PR2.Base/Conv/Loss Item is Blank
     C           #1QZCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1QZCD    ZA0017           Base/Conv/Loss
      * Send message 'Base/Cov/Fab can't be BL'
     C                     MOVEL'USR1865' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Minimum Weight Per Case w/Unit Weight
      * CASE: PR2.Minimum Weight Per Case GT PR2.Unit Weight
     C           #1CZWG    IFGT #1AIWG                     *IF
      * Setup message data for message
     C                     Z-ADD#1CZWG    ZA0018           Minimum Weight
      * Send message 'Min Wgt > Unit'
     C                     MOVEL'USR2285' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Validate Maximum Weight Per Case w/Unit Weight
      * CASE: PR2.Maximum Weight Per Case LT PR2.Unit Weight
     C           #1C0WG    IFLT #1AIWG                     *IF
      * Setup message data for message
     C                     Z-ADD#1C0WG    ZA0019           Maximum Weight
      * Send message 'Max Wgt < Unit'
     C                     MOVEL'USR2286' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Validate Category code 4 (GL Sub Code) is req & must be valid cat
      * CASE: PR2.G/L Sub Code is Not Entered
     C           #1SYCD    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'GL Sub Code is Req'
     C                     MOVEL'USR3251' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Item Category /Itm RT - Item Category  * 
     C                     EXSR SQRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * Setup message data for message
      * Send message 'GL Sub Code is Invalid'
     C                     MOVEL'USR3252' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for Label Line 1 empty allow only on CoPacker
      * CASE: PR2.Item Label Line 1 is Entered
     C           #1L7NA    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PR2.Item Structure Type Code is EQ 900
     C           #1RGNB    IFEQ 900                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1L7NA    ZA0020           Item Label Line
      * Send message 'Item Label Required'
     C                     MOVEL'USR3179' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Convert Label 1 to Upper Case
      * CASE: PR2.Item Label Line 1 is Entered
     C           #1L7NA    IFNE *BLANK                     *IF
      * CVT to Upper w/SpclChr US - /UT User Source  * 
     C                     MOVEA#1L7NA    AR1              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR1,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 's'
     C                     MOVEL'S'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 't'
     C                     MOVEL'T'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR1,Y1
     C                     ELSE
     C           AR1,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR1,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR1       #1L7NA           LOAD OUTPUT
     C                     END                             *FI
      * CASE: PR4.Item Validation USR is Company Item
     C           'C'       IFEQ 'C'                        *IF
      * Require Miscellaneous Weight per Damon 2/19/13 if not type 740
      * CASE: misc tare wgt is = 0 and class n=740
      *  - c1 AND c2
      *   |- c1    : PR2.Misc Tare Weight is equal to zero
      *   |- c2    : PR2.Item Structure Type Code is ne 740
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1A3WG    IFEQ 0                          *IF
     C           #1RGNB    IFNE 740                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Send message 'Misc Tare Weight Req'
     C                     MOVEL'USR3112' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Finished Goods and Raw Material
      * CASE: PR2.Item Type Code is Finished Good/Raw Matrl
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
      * Export/Domestic is required
      * CASE: PR2.Export/Domestic EQ LCL.BLANK 1               USR
     C           #1SUST    IFEQ YL0012                     *IF
      * Setup message data for message
     C                     MOVEL#1SUST    ZA0021           Export/Domestic
      * Send message 'Export/Domestic Req'
     C                     MOVEL'USR2515' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Fresh Inv Allocation Seq is required
      * CASE: PR2.Fresh Inv Allocation Seq EQ LCL.BLANK 1               U
     C           #1SYST    IFEQ YL0012                     *IF
      * Setup message data for message
     C                     MOVEL#1SYST    ZA0022           Fresh Inv Alloc
      * Send message 'Fresh Inv Allocation Seq'
     C                     MOVEL'USR2521' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Fresh Sched As Ordered is required
      * CASE: PR2.Fresh Sched As Ordered EQ LCL.BLANK 1               USR
     C           #1SZST    IFEQ YL0012                     *IF
      * Setup message data for message
     C                     MOVEL#1SZST    ZA0023           Fresh Sched As
      * Send message 'Fresh Sched As Ordered rq'
     C                     MOVEL'USR2519' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Frozen Sched As Ordered is required
      * CASE: PR2.Frozen Sched As Ordered EQ LCL.BLANK 1               US
     C           #1S1ST    IFEQ YL0012                     *IF
      * Setup message data for message
     C                     MOVEL#1S1ST    ZA0024           Frozen Inv Allo
      * Send message 'Frozn Inv Alloc Seq rq'
     C                     MOVEL'USR2520' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Default commodity market basis is required
      * CASE: PR2.Default Commod Mark basis is Not Entered
     C           #1LNCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1LNCD    ZA0025           Default Commod
      * Send message 'Commdty Mrkt Can't be BL'
     C                     MOVEL'USR1862' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Commodity price group is required
      * CASE: PR2.Commodity Price Group is Not entered
     C           #1LRCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1LRCD    ZA0026           Commodity Price
      * Send message 'Commdty Group Can't be BL'
     C                     MOVEL'USR1863' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Validate Market & Price Group combiniation.
     C                     EXSR UHSUBR                     Validate Market
     C                     END                             *FI
      * Finished Goods and Work in Process
      * CASE: PR2.Item Type Code is FG/WP
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'WP'
      * Item Structure Type Code is required
      * CASE: PR2.Item Structure Type Code is Not Entered
     C           #1RGNB    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1RGNB    ZA0029           Item Structure
      * Send message 'Item Structure Type Req'
     C                     MOVEL'USR3233' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Item Structure Group Code is required
      * CASE: PR2.Item Structure Group Code is Not Entered
     C           #1RHNB    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1RHNB    ZA0030           Item Structure
      * Send message 'Item Structure Group Req'
     C                     MOVEL'USR3234' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Item Structure Class Code is required
      * CASE: PR2.Item Structure Class Code is Equal Zero
     C           #1RINB    IFEQ 0                          *IF
      * Setup message data for message
     C                     Z-ADD#1RINB    ZA0031           Item Structure
      * Send message 'Item Structure Class Req'
     C                     MOVEL'USR3235' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Partial Item Code & Reject Code Valid - Non CoPacker Item only
     C                     EXSR UISUBR                     Partial Item Co
     C                     ELSE
      * CASE: *OTHERWISE
      * If credit item status is yes, item type must be FG or WP
      * CASE: PR2.Credit Item Status is yes
     C           #1VMST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1VMST    ZA0040           Credit Item Sta
      * Send message 'Credit Item Must be FG'
     C                     MOVEL'USR1943' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Variety/Rendered/Cut is Cut, then Base/Conv/Loss Item is req
      * CASE: PR2.Variety/Rendered/Cut is Cut
     C           #1XWST    IFEQ 'C'                        *IF
      * Base/Conv/Loss must be entered
      * CASE: PR2.Base/Conv/Loss Item is Blank
     C           #1QZCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1QZCD    ZA0041           Base/Conv/Loss
      * Send message 'Base/Cov/Fab can't be BL'
     C                     MOVEL'USR1865' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Variety/Rendered/Cut must be entered
      * CASE: PR2.Variety/Rendered/Cut is Not Entered
     C           #1XWST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1XWST    ZA0042           Variety/Rendere
      * Send message 'Vrty/Rend/Cut can't be BL'
     C                     MOVEL'USR1861' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Default Warehouse
      * CASE: PR4.Item Validation USR is Company Item
     C           'C'       IFEQ 'C'                        *IF
      * Warehouse must be entered
      * CASE: PR2.Default Warehouse is Warehouse Code Blank
     C           #1Q1CD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1Q1CD    ZA0043           Default Warehou
      * Send message 'Whse is Mandatory for FG'
     C                     MOVEL'USR1893' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Department code
      * CASE: PR2.Department Code NE WRK.BLANK
     C           #1R3CD    IFNE WUGSTX                     *IF
      * Rtv Prod Dept valid   RT - PS Production Department  * 
     C                     EXSR SSRVGN
      * CASE: WRK.Department Description is equal to blank
     C           WUMYNA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1R3CD    ZA0044           Department Code
      * Send message 'PS Production Departme NF'
     C                     MOVEL'USR1757' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Raw Material only
      * CASE: PR2.Item Type Code is Raw Material
     C           #1N0CD    IFEQ 'RM'                       *IF
      * Base/Conv/Loss Item is required to be Base
      * CASE: PR2.Base/Conv/Loss Item is Base
     C           #1QZCD    IFEQ 'B'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1N0CD    ZA0045           Item Type Code
     C                     MOVEL#1QZCD    ZA0046           Base/Conv/Loss
      * Send message 'RM item must be a base'
     C                     MOVEL'USR2160' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PR2.Item Type Code is Packaging and Supplies
     C           #1N0CD    IFEQ 'PS'                       *IF
      * If not a finished good, print on realization rpt = N
      * CASE: PR2.Item Type Code is Not Finished Good
     C           #1N0CD    IFNE 'FG'                       *IF
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1S6ST           Value Added Sts
     C                     END                             *FI
      * Package type must be entered for item type 'PS'
      * CASE: PR2.Package Type Code is *ALL values
     C           #1X4ST    IFEQ 'B'                        *IF
     C           #1X4ST    OREQ 'O'
     C           #1X4ST    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1X4ST    ZA0047           Package Type Co
      * Send message 'Package type can't be BLK'
     C                     MOVEL'USR1906' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * If credit item status is yes, item type must be FG or WP
      * CASE: PR2.Credit Item Status is yes
     C           #1VMST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     MOVEL#1VMST    ZA0048           Credit Item Sta
      * Send message 'Credit Item Must be FG'
     C                     MOVEL'USR1943' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Validate Market & Price Group combiniation.
      *================================================================
      * CASE: PR2.Item Type Code is Finished Good/Raw Matrl
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
      * RTV Last Market PrcDte RT - Commodity Mrkt Price  * 
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1LNCD    ZA0027           Default Commod
     C                     MOVEL#1LRCD    ZA0028           Commodity Price
      * Send message 'Prices for group not avai'
     C                     MOVEL'USR2836' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Partial Item Code & Reject Code Valid - Non CoPacker Item only
      *================================================================
      * CASE: PR2.Item Structure Type Code is NE 900
     C           #1RGNB    IFNE 900                        *IF
      * VAL: Partial Code - Do not validation on Co-Packer
      * CASE: PR2.Partial Item Code is Entered
     C           #1CMNB    IFNE 0                          *IF
      * Val Itm/Prt or Reject  XF - Item Default  * 
     C                     CALL 'PPGBXFR'              90  Val Itm/Prt or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HGCD    WQ0014  70       Item Code
     C                     PARM #1CMNB    WQ0015  70       Partial Item Co
     C                     PARM #1CMNB    WQ0016  70       WIP Reject Code
     C                     PARM #1CMNB    WQ0017  70       Item Code
     C           YL0014    PARM YL0014    WQ0018  1        Item Code Error
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPGBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Item Code Error Sts Usr is Greater then 5 Positions
     C           YL0014    IFEQ 'G'                        *IF
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0032           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0032           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject <5 digits'
     C                     MOVEL'USR3229' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: LCL.Item Code Error Sts Usr is Item Code FG/WIP Error
     C           YL0014    IFEQ 'I'                        *IF
      * Partial code can not be a finished goods or WIP
      * Ready by Partial Code -- Item Default By Item code
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0033           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0033           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject = FG/WP'
     C                     MOVEL'USR3230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: LCL.Item Code Error Sts Usr is Partial Item Code Fnd Err
     C           YL0014    IFEQ 'P'                        *IF
      * Partial code can not exist for another Partial code
      * Ready by Partial Code -- Item Default By Partial Code
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0034           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0034           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject Itm Exist'
     C                     MOVEL'USR3231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: LCL.Item Code Error Sts Usr is Reject Item Code Fnd Err
     C           YL0014    IFEQ 'R'                        *IF
      * Partial code can not exist for another Reject
      * Ready by Partial Code -- Item Default By Reject
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0035           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0035           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject Itm Exist'
     C                     MOVEL'USR3231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VAL: Reject Code - Do not validation on Co-Packer
      * CASE: PR2.WIP Reject Code is Entered
     C           #1CRNB    IFNE 0                          *IF
      * Val Itm/Prt or Reject  XF - Item Default  * 
     C                     CALL 'PPGBXFR'              90  Val Itm/Prt or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HGCD    WQ0019  70       Item Code
     C                     PARM #1CRNB    WQ0020  70       Partial Item Co
     C                     PARM #1CRNB    WQ0021  70       WIP Reject Code
     C                     PARM #1CRNB    WQ0022  70       Item Code
     C           YL0014    PARM YL0014    WQ0023  1        Item Code Error
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPGBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Item Code Error Sts Usr is Greater then 5 Positions
     C           YL0014    IFEQ 'G'                        *IF
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0036           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0036           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject <5 digits'
     C                     MOVEL'USR3229' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: LCL.Item Code Error Sts Usr is Item Code FG/WIP Error
     C           YL0014    IFEQ 'I'                        *IF
      * Reject code can not be a finished goods or WIP
      * Ready by Reject Code -- Item Default By Item code
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0037           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0037           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject = FG/WP'
     C                     MOVEL'USR3230' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: LCL.Item Code Error Sts Usr is Partial Item Code Fnd Err
     C           YL0014    IFEQ 'P'                        *IF
      * Reject code can not exist for another Partial code
      * Ready by Reject Code -- Item Default by Partial Code
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0038           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0038           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject Itm Exist'
     C                     MOVEL'USR3231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: LCL.Item Code Error Sts Usr is Reject Item Code Fnd Err
     C           YL0014    IFEQ 'R'                        *IF
      * Reject code can not exist for another Reject
      * Read by Reject Code --_Item Default by Reject Code
      * Setup message data for message
      * Convert Partial Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1CMNB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1CMNB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0039           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0039           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Partial/Reject Itm Exist'
     C                     MOVEL'USR3231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Notification of change
      *================================================================
     C                     MOVEL*BLANK    YL0017           Company Number
     C                     MOVELBZAIC3    YL0017           Company Number
     C                     MOVEL*BLANK    YL0018           Item Code Txt
     C                     MOVELBZHGCD    YL0018           Item Code Txt
     C                     Z-ADD1         ZQ      50
     C           'Type:'   CAT  BZN0CD:ZQ YL0019    P      Text USR 8
     C                     Z-ADD1         ZQ      50
     C           @CN,004   CAT  ##USR:ZQ  YL0020    P      Text USR 20
     C                     Z-ADD1         ZQ      50
     C           @CN,005   CAT  YL0017:ZQ YL0021    P      Note: Text Usr
     C                     Z-ADD1         ZQ      50
     C           YL0021    CAT  YL0018:ZQ YL0021    P      Note: Text Usr
     C                     Z-ADD1         ZQ      50
     C           YL0021    CAT  YL0019:ZQ YL0021    P      Note: Text Usr
     C                     Z-ADD1         ZQ      50
     C           YL0021    CAT  YL0020:ZQ YL0021    P      Note: Text Usr
      * Packaging & Supply
      * CASE: DB1.Item Type Code is Packaging and Supplies
     C           BZN0CD    IFEQ 'PS'                       *IF
      * Box Unit Weight
      * CASE: DB1.Unit Weight NE PAR.Unit Weight
     C           BZAIWG    IFNE #1AIWG                     *IF
     C                     MOVEL'Y'       YL0022           Change Flag USR
      * Setup message data for message
     C                     MOVEL@CN,006   ZA0052           Text USR 20
     C                     Z-ADD#1AIWG    ZA0053           Unit Weight
     C                     MOVEL*BLANK    ZA0054           Text 1 Length U
      * Retrieve message Item Change Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0023    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
      * Finished Goods
      * CASE: DB1.Item Type Code is Finished Goods
     C           BZN0CD    IFEQ 'FG'                       *IF
      * Misc Tare Weight
      * CASE: PAR.Misc Tare Weight NE DB1.Misc Tare Weight
     C           #1A3WG    IFNE BZA3WG                     *IF
     C                     MOVEL'Y'       YL0022           Change Flag USR
      * Setup message data for message
     C                     MOVEL@CN,007   ZA0055           Text USR 20
     C                     Z-ADD#1A3WG    ZA0056           Misc Tare Weigh
     C                     MOVEL','       ZA0057           Text 1 Length U
      * Retrieve message Item Change Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0023    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * Minimum Weight Per Case
      * CASE: PAR.Minimum Weight Per Case NE DB1.Minimum Weight Per Case
     C           #1CZWG    IFNE BZCZWG                     *IF
     C                     MOVEL'Y'       YL0022           Change Flag USR
      * Setup message data for message
     C                     MOVEL@CN,008   ZA0058           Text USR 20
     C                     Z-ADD#1CZWG    ZA0059           Minimum Weight
     C                     MOVEL','       ZA0060           Text 1 Length U
      * Retrieve message Item Change Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0024    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * Maximum Weight Per Case
      * CASE: PAR.Maximum Weight Per Case NE DB1.Maximum Weight Per Case
     C           #1C0WG    IFNE BZC0WG                     *IF
     C                     MOVEL'Y'       YL0022           Change Flag USR
      * Setup message data for message
     C                     MOVEL@CN,009   ZA0061           Text USR 20
     C                     Z-ADD#1C0WG    ZA0062           Maximum Weight
     C                     MOVEL','       ZA0063           Text 1 Length U
      * Retrieve message Item Change Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0025    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * Pieces per Bag
      * CASE: PAR.Pieces Per Bag NE DB1.Pieces Per Bag
     C           #1BDNB    IFNE BZBDNB                     *IF
     C                     MOVEL'Y'       YL0022           Change Flag USR
      * Setup message data for message
     C                     MOVEL@CN,010   ZA0064           Text USR 20
     C                     Z-ADD#1BDNB    ZA0065           Pieces Per Bag
     C                     MOVEL','       ZA0066           Text 1 Length U
      * Retrieve message Item Change Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0026    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
      * Bags per Unit
      * CASE: PAR.Bags Per Unit NE DB1.Bags Per Unit
     C           #1BJNB    IFNE BZBJNB                     *IF
     C                     MOVEL'Y'       YL0022           Change Flag USR
      * Setup message data for message
     C                     MOVEL@CN,011   ZA0067           Text USR 20
     C                     Z-ADD#1BJNB    ZA0068           Bags Per Unit
     C                     MOVEL','       ZA0069           Text 1 Length U
      * Retrieve message Item Change Notification
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2RVMGC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR3138' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C           YL0027    PARM           W0MTX 132        Returned messag
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Change Flag USR is Yes
     C           YL0022    IFEQ 'Y'                        *IF
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SVRVGN
      * SND Pager Msg-Long-50 UP - /UT User Programs  * 
     C                     CALL 'PPFVUPC'              90  SND Pager Msg-L
     C                     PARM WUCLAA    WQ0049 10        DL List ID
     C                     PARM YL0021    WQ0050 50        Note: Text Usr
     C                     PARM YL0023    WQ0051 40        Office Message
     C                     PARM YL0024    WQ0052 40        Office Message
     C                     PARM YL0025    WQ0053 40        Office Message
     C                     PARM YL0026    WQ0054 40        Office Message
     C                     PARM YL0027    WQ0055 40        Office Message
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPFVUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Plt Floor Intrfc, Item Str Chg, Pricing Audit. BOXID - BOM
      *================================================================
      * Chg Co/Itm EffOthfls   XF - Company Item  * 
     C                     CALL 'PPGPXFR'              90  Chg Co/Itm EffO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0059  30       Company Number
     C                     PARM #1HGCD    WQ0060  70       Item Code
     C                     PARM #1AVNA    WQ0061 30        Description Lin
     C                     PARM #1AWNA    WQ0062 30        Description Lin
     C                     PARM #1L7NA    WQ0063 32        Item Label Line
     C                     PARM #1L8NA    WQ0064 32        Item Label Line
     C                     PARM #1L6NA    WQ0065 32        Item Label Line
     C                     PARM #1MFNA    WQ0066 32        Item Label Line
     C                     PARM #1ADCD    WQ0067  2        U/M - Primary
     C                     PARM #1AWPC    WQ0068  94       Conversion Fact
     C                     PARM #1LXST    WQ0069  1        Operation Facto
     C                     PARM #1AECD    WQ0070  2        U/M - Second
     C                     PARM #1AXPC    WQ0071  94       Conversion Fact
     C                     PARM #1LYST    WQ0072  1        Operation Facto
     C                     PARM #1AFCD    WQ0073  2        U/M - Third
     C                     PARM #1AICD    WQ0074  2        U/M - Pricing
     C                     PARM #1AIWG    WQ0075 112       Unit Weight
     C                     PARM #1HICD    WQ0076  2        Quality Level
     C                     PARM #1RBCD    WQ0077  2        Item Level
     C                     PARM #1FZST    WQ0078  1        Production Date
     C                     PARM #1AVST    WQ0079  1        Catch Weight St
     C                     PARM #1CZWG    WQ0080 112       Minimum Weight
     C                     PARM #1C0WG    WQ0081 112       Maximum Weight
     C                     PARM #1URTN    WQ0082  50       Number Cases On
     C                     PARM #1AJC8    WQ0083  80       Vendor - Item D
     C                     PARM #1RINB    WQ0084  30       Item Structure
     C                     PARM #1RHNB    WQ0085  30       Item Structure
     C                     PARM #1RGNB    WQ0086  30       Item Structure
     C                     PARM #1LNCD    WQ0087  3        Default Commod
     C                     PARM #1TFNB    WQ0088  30       Transportation
     C                     PARM #1N0CD    WQ0089  3        Item Type Code
     C                     PARM #1X4ST    WQ0090  1        Package Type Co
     C                     PARM #1TMVA    WQ0091 112       Maximum Audit V
     C                     PARM #1TNVA    WQ0092 112       Minimum Audit V
     C                     PARM #1BLPR    WQ0093 114       Market Overage
     C                     PARM #1BMPR    WQ0094 114       Standard Overag
     C                     PARM #1LRCD    WQ0095  7        Commodity Price
     C                     PARM #1U9ST    WQ0096  1        Item Pricing Op
     C                     PARM #1CMCO    WQ0097 114       Item Pricing Co
     C                     PARM #1Q1CD    WQ0098  3        Default Warehou
     C                     PARM #1Q8CD    WQ0099  3        Price Method De
     C                     PARM #1CHTM    WQ0100  52       Fresh Chilling
     C                     PARM #1QZCD    WQ0101  2        Base/Conv/Loss
     C                     PARM #1XWST    WQ0102  1        Variety/Rendere
     C                     PARM #1XXST    WQ0103  1        Frozen Make to
     C                     PARM #1VMST    WQ0104  1        Credit Item Sta
     C                     PARM #1SWGH    WQ0105 112       Std Weight/Head
     C                     PARM #1PPHE    WQ0106  70       Pieces Per Head
     C                     PARM #1R3CD    WQ0107  6        Department Code
     C                     PARM #1SDCD    WQ0108  1        Group for Packa
     C                     PARM #1ICN1    WQ0109  20       Item Category N
     C                     PARM #1SVCD    WQ0110  3        MTO Code
     C                     PARM #1ICN2    WQ0111  20       Item Category N
     C                     PARM #1SWCD    WQ0112  3        Transp Equip Ty
     C                     PARM #1V2NB    WQ0113  20       Item Category N
     C                     PARM #1SXCD    WQ0114  3        Item Category C
     C                     PARM #1ITCN    WQ0115  20       Item Category N
     C                     PARM #1SYCD    WQ0116  3        G/L Sub Code
     C                     PARM #1SFNB    WQ0117  52       Pallet Tare Wei
     C                     PARM #1A3WG    WQ0118  52       Misc Tare Weigh
     C                     PARM #1SJNB    WQ0119  30       Production Lead
     C                     PARM #1LLCD    WQ0120  3        Packaging Code
     C                     PARM #1LMCD    WQ0121  3        Item Market Cod
     C                     PARM #1P3ST    WQ0122  1        TF Co-Ownership
     C                     PARM #1SKNB    WQ0123  20       Agrimetrics gro
     C                     PARM #1SLNB    WQ0124  10       Agrimetrics pac
     C                     PARM #1SMNB    WQ0125  20       Agrimetrics gra
     C                     PARM #1P4ST    WQ0126  1        PA Base Avail R
     C                     PARM #1CFNB    WQ0127 114       PM Pounds per H
     C                     PARM #1CGNB    WQ0128  74       Item Frt Overag
     C                     PARM #1ILNB    WQ0129  74       Packages per ca
     C                     PARM #1CHNB    WQ0130  30       Use/Freeze/Sell
     C                     PARM #1CINB    WQ0131 114       PM Batch Size
     C                     PARM #1CJNB    WQ0132 114       Package Level s
     C                     PARM #1CMNB    WQ0133  70       Partial Item Co
     C                     PARM #1CNNB    WQ0134  70       WIP Item Code
     C                     PARM #1CRNB    WQ0135  70       WIP Reject Code
     C                     PARM #1CSNB    WQ0136  92       Std Costing Uni
     C                     PARM #1CVNB    WQ0137  92       FP Std Green We
     C                     PARM #1CWNB    WQ0138 114       PM Standard LBS
     C                     PARM #1CXNB    WQ0139 114       PM Raw Meat LBS
     C                     PARM #1CZNB    WQ0140 114       PM Formula LBS/
     C                     PARM #1C0NB    WQ0141 114       PM Finished LBS
     C                     PARM #1N1CD    WQ0142  3        SH Unused (was
     C                     PARM #1B4NB    WQ0143  30       PM R/M Type Cod
     C                     PARM #1B5NB    WQ0144  50       PM Line Number
     C                     PARM #1X5ST    WQ0145  1        Seconds Item
     C                     PARM #1X6ST    WQ0146  2        Print on Realiz
     C                     PARM #1X7ST    WQ0147  3        Unit Weight Cha
     C                     PARM #1PCCT    WQ0148  1        Piece Count Ite
     C                     PARM #1BDNB    WQ0149  70       Pieces Per Bag
     C                     PARM #1BJNB    WQ0150  70       Bags Per Unit
     C                     PARM #1SUST    WQ0151  1        Export/Domestic
     C                     PARM #1SVST    WQ0152  1        Print On Schedu
     C                     PARM #1SYST    WQ0153  1        Fresh Inv Alloc
     C                     PARM #1SZST    WQ0154  1        Fresh Sched As
     C                     PARM #1S1ST    WQ0155  1        Frozen Inv Allo
     C                     PARM #1XRCD    WQ0156  6        Primal Group Co
     C                     PARM #1XTCD    WQ0157 12        Item Meat Cost
     C                     PARM #1XUCD    WQ0158 12        UPC Code 2
     C                     PARM #1F5WG    WQ0159 112       Item Target Pri
     C                     PARM #1F6WG    WQ0160 112       Minimum Piece W
     C                     PARM #1F7WG    WQ0161 112       Maximum Piece W
     C                     PARM #1BLNB    WQ0162  70       Seaboard Equiva
     C                     PARM #1BNNB    WQ0163  70       Production Qty
     C                     PARM #1S2ST    WQ0164  1        Scheduling Posi
     C                     PARM #1S4ST    WQ0165  1        Sold 100% Froze
     C                     PARM #1S5ST    WQ0166  1        Maximum Shifts
     C                     PARM #1S6ST    WQ0167  1        Value Added Sts
     C                     PARM #1S8ST    WQ0168  2        Label Type
     C                     PARM #1TDST    WQ0169  3        Default Workcen
     C                     PARM #1VSST    WQ0170  1        Record Status
     C                     PARM P1ADCD    WQ0171  2        U/M - Primary
     C                     PARM P1AECD    WQ0172  2        U/M - Second
     C                     PARM P1AFCD    WQ0173  2        U/M - Third
     C                     PARM P1AICD    WQ0174  2        U/M - Pricing
     C                     PARM P1AVST    WQ0175  1        Catch Weight St
     C                     PARM P1AVNA    WQ0176 30        Description Lin
     C                     PARM P1AWNA    WQ0177 30        Description Lin
     C                     PARM P1AWPC    WQ0178  94       Conversion Fact
     C                     PARM P1AXPC    WQ0179  94       Conversion Fact
     C                     PARM P1AIWG    WQ0180 112       Unit Weight
     C                     PARM P1FZST    WQ0181  1        Production Date
     C                     PARM P1A3WG    WQ0182  52       Misc Tare Weigh
     C                     PARM P1AIC3    WQ0183  30       Company Number
     C                     PARM P1HGCD    WQ0184  70       Item Code
     C                     PARM P1AJC8    WQ0185  80       Vendor - Item D
     C                     PARM P1HICD    WQ0186  2        Quality Level
     C                     PARM P1LXST    WQ0187  1        Operation Facto
     C                     PARM P1LYST    WQ0188  1        Operation Facto
     C                     PARM P1RGNB    WQ0189  30       Item Structure
     C                     PARM P1RHNB    WQ0190  30       Item Structure
     C                     PARM P1RINB    WQ0191  30       Item Structure
     C                     PARM P1LLCD    WQ0192  3        Packaging Code
     C                     PARM P1LMCD    WQ0193  3        Item Market Cod
     C                     PARM P1SFNB    WQ0194  52       Pallet Tare Wei
     C                     PARM P1SJNB    WQ0195  30       Production Lead
     C                     PARM P1P3ST    WQ0196  1        TF Co-Ownership
     C                     PARM P1SKNB    WQ0197  20       Agrimetrics gro
     C                     PARM P1SLNB    WQ0198  10       Agrimetrics pac
     C                     PARM P1SMNB    WQ0199  20       Agrimetrics gra
     C                     PARM P1P4ST    WQ0200  1        PA Base Avail R
     C                     PARM P1LNCD    WQ0201  3        Default Commod
     C                     PARM P1LRCD    WQ0202  7        Commodity Price
     C                     PARM P1TFNB    WQ0203  30       Transportation
     C                     PARM P1B4NB    WQ0204  30       PM R/M Type Cod
     C                     PARM P1B5NB    WQ0205  50       PM Line Number
     C                     PARM P1N0CD    WQ0206  3        Item Type Code
     C                     PARM P1CFNB    WQ0207 114       PM Pounds per H
     C                     PARM P1CGNB    WQ0208  74       Item Frt Overag
     C                     PARM P1CHNB    WQ0209  30       Use/Freeze/Sell
     C                     PARM P1CINB    WQ0210 114       PM Batch Size
     C                     PARM P1CJNB    WQ0211 114       Package Level s
     C                     PARM P1CMNB    WQ0212  70       Partial Item Co
     C                     PARM P1CNNB    WQ0213  70       WIP Item Code
     C                     PARM P1CRNB    WQ0214  70       WIP Reject Code
     C                     PARM P1CSNB    WQ0215  92       Std Costing Uni
     C                     PARM P1CVNB    WQ0216  92       FP Std Green We
     C                     PARM P1CWNB    WQ0217 114       PM Standard LBS
     C                     PARM P1CXNB    WQ0218 114       PM Raw Meat LBS
     C                     PARM P1CZNB    WQ0219 114       PM Formula LBS/
     C                     PARM P1C0NB    WQ0220 114       PM Finished LBS
     C                     PARM P1N1CD    WQ0221  3        SH Unused (was
     C                     PARM P1ILNB    WQ0222  74       Packages per ca
     C                     PARM P1CZWG    WQ0223 112       Minimum Weight
     C                     PARM P1C0WG    WQ0224 112       Maximum Weight
     C                     PARM P1URTN    WQ0225  50       Number Cases On
     C                     PARM P1L6NA    WQ0226 32        Item Label Line
     C                     PARM P1L7NA    WQ0227 32        Item Label Line
     C                     PARM P1L8NA    WQ0228 32        Item Label Line
     C                     PARM P1MFNA    WQ0229 32        Item Label Line
     C                     PARM P1TMVA    WQ0230 112       Maximum Audit V
     C                     PARM P1TNVA    WQ0231 112       Minimum Audit V
     C                     PARM P1BLPR    WQ0232 114       Market Overage
     C                     PARM P1BMPR    WQ0233 114       Standard Overag
     C                     PARM P1CHTM    WQ0234  52       Fresh Chilling
     C                     PARM P1QZCD    WQ0235  2        Base/Conv/Loss
     C                     PARM P1Q1CD    WQ0236  3        Default Warehou
     C                     PARM P1Q8CD    WQ0237  3        Price Method De
     C                     PARM P1RBCD    WQ0238  2        Item Level
     C                     PARM P1U9ST    WQ0239  1        Item Pricing Op
     C                     PARM P1CMCO    WQ0240 114       Item Pricing Co
     C                     PARM P1VMST    WQ0241  1        Credit Item Sta
     C                     PARM P1VSST    WQ0242  1        Record Status
     C                     PARM P1R3CD    WQ0243  6        Department Code
     C                     PARM P1SWGH    WQ0244 112       Std Weight/Head
     C                     PARM P1SDCD    WQ0245  1        Group for Packa
     C                     PARM P1PPHE    WQ0246  70       Pieces Per Head
     C                     PARM P1XWST    WQ0247  1        Variety/Rendere
     C                     PARM P1XXST    WQ0248  1        Frozen Make to
     C                     PARM P1ICN1    WQ0249  20       Item Category N
     C                     PARM P1SVCD    WQ0250  3        MTO Code
     C                     PARM P1ICN2    WQ0251  20       Item Category N
     C                     PARM P1SWCD    WQ0252  3        Transp Equip Ty
     C                     PARM P1V2NB    WQ0253  20       Item Category N
     C                     PARM P1SXCD    WQ0254  3        Item Category C
     C                     PARM P1ITCN    WQ0255  20       Item Category N
     C                     PARM P1SYCD    WQ0256  3        G/L Sub Code
     C                     PARM P1X4ST    WQ0257  1        Package Type Co
     C                     PARM P1X5ST    WQ0258  1        Seconds Item
     C                     PARM P1X6ST    WQ0259  2        Print on Realiz
     C                     PARM P1X7ST    WQ0260  3        Unit Weight Cha
     C                     PARM P1XRCD    WQ0261  6        Primal Group Co
     C                     PARM P1PCCT    WQ0262  1        Piece Count Ite
     C                     PARM P1BDNB    WQ0263  70       Pieces Per Bag
     C                     PARM P1BJNB    WQ0264  70       Bags Per Unit
     C                     PARM P1SUST    WQ0265  1        Export/Domestic
     C                     PARM P1SVST    WQ0266  1        Print On Schedu
     C                     PARM P1SYST    WQ0267  1        Fresh Inv Alloc
     C                     PARM P1SZST    WQ0268  1        Fresh Sched As
     C                     PARM P1S1ST    WQ0269  1        Frozen Inv Allo
     C                     PARM #1XTCD    WQ0270 12        Item Meat Cost
     C                     PARM WN0004    WQ0271 12        UPC Code 2
     C                     PARM P1F5WG    WQ0272 112       Item Target Pri
     C                     PARM P1F6WG    WQ0273 112       Minimum Piece W
     C                     PARM P1F7WG    WQ0274 112       Maximum Piece W
     C                     PARM P1BLNB    WQ0275  70       Seaboard Equiva
     C                     PARM P1BNNB    WQ0276  70       Production Qty
     C                     PARM P1S2ST    WQ0277  1        Scheduling Posi
     C                     PARM P1S4ST    WQ0278  1        Sold 100% Froze
     C                     PARM P1S5ST    WQ0279  1        Maximum Shifts
     C                     PARM P1S6ST    WQ0280  1        Value Added Sts
     C                     PARM P1S8ST    WQ0281  2        Label Type
     C                     PARM P1TDST    WQ0282  3        Default Workcen
     C                     PARM #DBOXI    WQ0283  70       Box iD
     C                     PARM P7BOXI    WQ0284  70       Box iD
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPGPXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993432*
     C                     SETON                     383539*
     C                     SETON                     373353*
     C                     SETON                     31    *
     C                     END
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1HGCD' defaulted for 'Item Code'.
     C                     CALL 'PDJISRR'              90  SEL Company/Ite
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0004  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0005  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0006  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLVBWA    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ADCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1ADCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ADCD' defaulted for 'U/M - Primary'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1ADCD    PARM #1ADCD    WQ0027  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ADCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ADCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1ADCD    AMHHCD
     C           KLVCAM    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AECD' defaulted for 'U/M - Second'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AECD    PARM #1AECD    WQ0028  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AECD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AECD    AMHHCD
     C           KLVDAM    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AFCD' defaulted for 'U/M - Third'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AFCD    PARM #1AFCD    WQ0029  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AFCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AFCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AFCD    AMHHCD
     C           KLVEAM    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AICD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AICD' defaulted for 'U/M - Pricing'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AICD    PARM #1AICD    WQ0030  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AICD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AICD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFAM    KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AICD    AMHHCD
     C           KLVFAM    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1HICD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HICD' defaulted for 'Quality Level'.
     C                     CALL 'CABOSRR'              90  SEL Quality Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1HICD    PARM #1HICD    WQ0031  2        Quality Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HICD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HICD    IFEQ *BLANK                     Quality Level
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGAI    KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1HICD    AIHICD
     C           KLVGAI    CHAIN@AIREVD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to Item Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Item Level
     C           YPMTFD    OREQ '#1RBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RBCD' defaulted for 'Item Level'.
     C                     CALL 'PDBPSRR'              90  SEL PD Item Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1RBCD    PARM #1RBCD    WQ0032  2        Item Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RBCD    IFNE *BLANK                     Item Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RBCD    IFEQ *BLANK                     Item Level
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHIL    KLIST
     C                     KFLD           ILRBCD           Item Level
      * Setup key
     C                     MOVEL#1RBCD    ILRBCD
     C           KLVHIL    CHAIN@ILREVH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'Item Level             NF'
     C                     MOVEL'USR1673' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1673' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Vendor
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AJC8'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJC8' defaulted for 'Vendor - Item Default'.
     C                     CALL 'PDE2SRR'              90  SEL Vendor Acti
     C                     PARM *BLANK    W0RTN   7
     C           #1AJC8    PARM #1AJC8    WQ0033  80       Vendor item Def
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJC8    IFNE *ZERO                      Vendor item Def
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJC8    IFEQ *ZERO                      Vendor item Def
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIBJ    KLIST
     C                     KFLD           BJACC8           Vendor item Def
      * Setup key
     C                     Z-ADD#1AJC8    BJACC8
     C           KLVIBJ    CHAIN@BJREU2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Vendor                 NF'
     C                     MOVEL'USR0213' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0213' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0034  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJE9    KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB
     C           KLVJE9    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0035  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKE8    KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    E8RGNB
     C           KLVKE8    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to Commodity Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Price
     C           YPMTFD    OREQ '#1LRCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LRCD' defaulted for 'Commodity Price Group'.
     C                     CALL 'PDECSRR'              90  SEL Commod Grp
     C                     PARM *BLANK    W0RTN   7
     C           #1LRCD    PARM #1LRCD    WQ0036  7        Commodity Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDECSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1LRCD    IFNE *BLANK                     Commodity Price
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LRCD    IFEQ *BLANK                     Commodity Price
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLWD    KLIST
     C                     KFLD           WDLRCD           Commodity Price
      * Setup key
     C                     MOVEL#1LRCD    WDLRCD
     C           KLVLWD    CHAIN@FZREVP              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'Commodity Group        NF'
     C                     MOVEL'USR1220' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1220' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q8CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q8CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1Q8CD' defaulted for 'Price Method Default'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0037  30       Company Number
     C           #1Q8CD    PARM #1Q8CD    WQ0038  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q8CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q8CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMIH    KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3
     C                     MOVEL#1Q8CD    IHQ7CD
     C           KLVMIH    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'Price Method Header    NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to PS Production Department
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1R3CD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Department Code
     C           YPMTFD    OREQ '#1R3CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1R3CD' defaulted for 'Department Code'.
     C                     CALL 'PDCXSRR'              90  Sel Prod. Depar
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0039  30       Company Number
     C           #1R3CD    PARM #1R3CD    WQ0040  6        Department Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCXSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1R3CD    IFNE *BLANK                     Department Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R3CD    IFEQ *BLANK                     Department Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNWE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WER3CD           Department Code
      * Setup key
     C                     Z-ADD#1AIC3    WEAIC3
     C                     MOVEL#1R3CD    WER3CD
     C           KLVNWE    CHAIN@I5REUJ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'PS Production Departme NF'
     C                     MOVEL'USR1757' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1757' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to Item Category Packaging
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1SDCD    WK1X02  1
     C           WK1X02    IFEQ '?'                        Group for Packa
     C           YPMTFD    OREQ '#1SDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1SDCD' defaulted for 'Group for Packaging'.
     C                     CALL 'PDHPSRR'              90  Sel Item Avl Di
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0041  30       Company Number
     C           #1SDCD    PARM #1SDCD    WQ0042  1        Group for Packa
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1SDCD    IFNE *BLANK                     Group for Packa
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1SDCD    IFEQ *BLANK                     Group for Packa
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOJG    KLIST
     C                     KFLD           JGAIC3           Company Number
     C                     KFLD           JGSDCD           Group for Packa
      * Setup key
     C                     Z-ADD#1AIC3    JGAIC3
     C                     MOVEL#1SDCD    JGSDCD
     C           KLVOJG    CHAIN@JGREXH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'Item Category Packagin NF'
     C                     MOVEL'USR1830' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1830' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to PM R/M Type Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B4NB    IFEQ *ZERO                      PM R/M Type Cod
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPG1    KLIST
     C                     KFLD           G1B4NB           PM R/M Type Cod
      * Setup key
     C                     Z-ADD#1B4NB    G1B4NB
     C           KLVPG1    CHAIN@G1REI0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'PM R/M Type Master     NF'
     C                     MOVEL'USR1454' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1454' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to PM Line Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B5NB    IFEQ *ZERO                      PM Line Number
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQG2    KLIST
     C                     KFLD           G2AIC3           Company Number
     C                     KFLD           G2B5NB           PM Line Number
      * Setup key
     C                     Z-ADD#1AIC3    G2AIC3
     C                     Z-ADD#1B5NB    G2B5NB
     C           KLVQG2    CHAIN@G2REIR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'PM Line Master         NF'
     C                     MOVEL'USR1456' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1456' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to PS Primal Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Primal Group Co
     C           YPMTFD    OREQ '#1XRCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XRCD' defaulted for 'Primal Group Code'.
     C                     CALL 'PDAFSRR'              90  Sel PS Primal G
     C                     PARM *BLANK    W0RTN   7
     C           #1XRCD    PARM #1XRCD    WQ0043  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XRCD    IFNE *BLANK                     Primal Group Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VREXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XRCD    IFEQ *BLANK                     Primal Group Co
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRLL    KLIST
     C                     KFLD           LLXRCD           Primal Group Co
      * Setup key
     C                     MOVEL#1XRCD    LLXRCD
     C           KLVRLL    CHAIN@LLREOY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'PS Primal Group        NF'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2505' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'PDL7SRR'              90  SEL Co - Rtn 0
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0299  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDL7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VSEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSWA    KLIST
     C                     KFLD           WAAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WAAIC3
     C           KLVSWA    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1HGCD'  YPMTFD           Item Code
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1TDST'  YPMTFD           Default Workcen
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE070
     C           ZHCSCL    ANDLE071
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DEPST'  YPMTFD           CIE Use Age Day
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1SVST'  YPMTFD           Print On Schedu
     C                     END
      *
     C           ZHCSRW    IFEQ 014
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DENST'  YPMTFD           Allocation Meth
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN77     ANDEQ'0'
     C                     MOVEL'#DEMST'  YPMTFD           Plan Production
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ045
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DD0ST'  YPMTFD           Produce on Sund
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ050
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DD2ST'  YPMTFD           Produce on Mond
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ055
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DD6ST'  YPMTFD           Produce on Tues
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ061
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DWESP'  YPMTFD           Produce on Wedn
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ066
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DEDST'  YPMTFD           Produce on Thur
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ072
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DEFST'  YPMTFD           Produce on Frid
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ077
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN75     ANDEQ'0'
     C                     MOVEL'#DEHST'  YPMTFD           Produce on Satu
     C                     END
      *
     C           ZHCSRW    IFEQ 020
     C           ZHCSCL    ANDGE028
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DEQST'  YPMTFD           CIE MPR Report
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ028
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN74     ANDEQ'0'
     C                     MOVEL'#1VSST'  YPMTFD           Record Status
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AVNA           Description Lin
     C                     MOVEL*BLANK    P1AWNA           Description Lin
     C                     MOVEL*BLANK    P1L7NA           Item Label Line
     C                     MOVEL*BLANK    P1L8NA           Item Label Line
     C                     MOVEL*BLANK    P1L6NA           Item Label Line
     C                     MOVEL*BLANK    P1MFNA           Item Label Line
     C                     MOVEL*BLANK    P1ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P1AWPC           Conversion Fact
     C                     MOVEL*BLANK    P1LXST           Operation Facto
     C                     MOVEL*BLANK    P1AECD           U/M - Second
     C                     Z-ADD*ZERO     P1AXPC           Conversion Fact
     C                     MOVEL*BLANK    P1LYST           Operation Facto
     C                     MOVEL*BLANK    P1AFCD           U/M - Third
     C                     MOVEL*BLANK    P1AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P1AIWG           Unit Weight
     C                     MOVEL*BLANK    P1HICD           Quality Level
     C                     MOVEL*BLANK    P1RBCD           Item Level
     C                     MOVEL*BLANK    P1FZST           Production Date
     C                     MOVEL*BLANK    P1AVST           Catch Weight St
     C                     Z-ADD*ZERO     P1CZWG           Minimum Weight
     C                     Z-ADD*ZERO     P1C0WG           Maximum Weight
     C                     Z-ADD*ZERO     P1URTN           Number Cases On
     C                     Z-ADD*ZERO     P1AJC8           Vendor - Item D
     C                     Z-ADD*ZERO     P1RINB           Item Structure
     C                     Z-ADD*ZERO     P1RHNB           Item Structure
     C                     Z-ADD*ZERO     P1RGNB           Item Structure
     C                     MOVEL*BLANK    P1LNCD           Default Commod
     C                     Z-ADD*ZERO     P1TFNB           Transportation
     C                     MOVEL*BLANK    P1N0CD           Item Type Code
     C                     MOVEL*BLANK    P1X4ST           Package Type Co
     C                     Z-ADD*ZERO     P1TMVA           Maximum Audit V
     C                     Z-ADD*ZERO     P1TNVA           Minimum Audit V
     C                     Z-ADD*ZERO     P1BLPR           Market Overage
     C                     Z-ADD*ZERO     P1BMPR           Standard Overag
     C                     MOVEL*BLANK    P1LRCD           Commodity Price
     C                     MOVEL*BLANK    P1U9ST           Item Pricing Op
     C                     Z-ADD*ZERO     P1CMCO           Item Pricing Co
     C                     MOVEL*BLANK    P1Q1CD           Default Warehou
     C                     MOVEL*BLANK    P1Q8CD           Price Method De
     C                     Z-ADD*ZERO     P1CHTM           Fresh Chilling
     C                     MOVEL*BLANK    P1QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    P1XWST           Variety/Rendere
     C                     MOVEL*BLANK    P1XXST           Frozen Make to
     C                     MOVEL*BLANK    P1VMST           Credit Item Sta
     C                     Z-ADD*ZERO     P1SWGH           Std Weight/Head
     C                     Z-ADD*ZERO     P1PPHE           Pieces Per Head
     C                     MOVEL*BLANK    P1R3CD           Department Code
     C                     MOVEL*BLANK    P1SDCD           Group for Packa
     C                     Z-ADD*ZERO     P1ICN1           Item Category N
     C                     MOVEL*BLANK    P1SVCD           MTO Code
     C                     Z-ADD*ZERO     P1ICN2           Item Category N
     C                     MOVEL*BLANK    P1SWCD           Transp Equip Ty
     C                     Z-ADD*ZERO     P1V2NB           Item Category N
     C                     MOVEL*BLANK    P1SXCD           Item Category C
     C                     Z-ADD*ZERO     P1ITCN           Item Category N
     C                     MOVEL*BLANK    P1SYCD           G/L Sub Code
     C                     Z-ADD*ZERO     P1ITC5           Item Category N
     C                     MOVEL*BLANK    P1SZCD           Item Structure
     C                     Z-ADD*ZERO     P1ICN6           Item Category N
     C                     MOVEL*BLANK    P1S0CD           Item Primal Sch
     C                     Z-ADD*ZERO     P1ICN7           Item Category N
     C                     MOVEL*BLANK    P1S1CD           Item Exc Man Pr
     C                     Z-ADD*ZERO     P1ICN8           Item Category N
     C                     MOVEL*BLANK    P1S2CD           Item Prod Sched
     C                     Z-ADD*ZERO     P1ICN9           Item Category N
     C                     MOVEL*BLANK    P1S3CD           Item Category C
     C                     Z-ADD*ZERO     P1ICN0           Item Category N
     C                     MOVEL*BLANK    P1S4CD           Item Category C
     C                     Z-ADD*ZERO     P1SFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     P1A3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     P1SJNB           Production Lead
     C                     MOVEL*BLANK    P1LLCD           Packaging Code
     C                     MOVEL*BLANK    P1LMCD           Item Market Cod
     C                     MOVEL*BLANK    P1P3ST           TF Co-Ownership
     C                     Z-ADD*ZERO     P1SKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     P1SLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     P1SMNB           Agrimetrics gra
     C                     MOVEL*BLANK    P1P4ST           PA Base Avail R
     C                     Z-ADD*ZERO     P1CFNB           PM Pounds per H
     C                     Z-ADD*ZERO     P1CGNB           Item Frt Overag
     C                     Z-ADD*ZERO     P1ILNB           Packages per ca
     C                     Z-ADD*ZERO     P1CHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     P1CINB           PM Batch Size
     C                     Z-ADD*ZERO     P1CJNB           Package Level s
     C                     Z-ADD*ZERO     P1CMNB           Partial Item Co
     C                     Z-ADD*ZERO     P1CNNB           WIP Item Code
     C                     Z-ADD*ZERO     P1CRNB           WIP Reject Code
     C                     Z-ADD*ZERO     P1CSNB           Std Costing Uni
     C                     Z-ADD*ZERO     P1CVNB           FP Std Green We
     C                     Z-ADD*ZERO     P1CWNB           PM Standard LBS
     C                     Z-ADD*ZERO     P1CXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     P1CZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     P1C0NB           PM Finished LBS
     C                     MOVEL*BLANK    P1N1CD           SH Unused (was
     C                     Z-ADD*ZERO     P1B4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     P1B5NB           PM Line Number
     C                     MOVEL*BLANK    P1X5ST           Seconds Item
     C                     MOVEL*BLANK    P1X6ST           Print on Realiz
     C                     MOVEL*BLANK    P1X7ST           Unit Weight Cha
     C                     MOVEL*BLANK    P1PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     P1BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     P1BJNB           Bags Per Unit
     C                     MOVEL*BLANK    P1SUST           Export/Domestic
     C                     MOVEL*BLANK    P1SVST           Print On Schedu
     C                     MOVEL*BLANK    P1SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    P1SZST           Fresh Sched As
     C                     MOVEL*BLANK    P1S1ST           Frozen Inv Allo
     C                     MOVEL*BLANK    P1XRCD           Primal Group Co
     C                     Z-ADD*ZERO     P1F5WG           Item Target Pri
     C                     Z-ADD*ZERO     P1F6WG           Minimum Piece W
     C                     Z-ADD*ZERO     P1F7WG           Maximum Piece W
     C                     Z-ADD*ZERO     P1BLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     P1BNNB           Production Qty
     C                     MOVEL*BLANK    P1S2ST           Scheduling Posi
     C                     MOVEL*BLANK    P1S4ST           Sold 100% Froze
     C                     MOVEL*BLANK    P1S5ST           Maximum Shifts
     C                     MOVEL*BLANK    P1S6ST           Value Added Sts
     C                     MOVEL*BLANK    P1S8ST           Label Type
     C                     MOVEL*BLANK    P1TDST           Default Workcen
     C                     MOVEL*BLANK    P1VSST           Record Status
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2DQCD           Enterprise Code
     C                     MOVEL*BLANK    P2DRCD           Enterprise Code
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P2TAST           First Time Flag
     C                     MOVEL*BLANK    P2ADTX           Name
     C                     MOVEL*BLANK    P2BXTX           System Value Al
     C                     MOVEL*BLANK    P2WVST           Access Denied (
     C                     MOVEL*BLANK    P3ZQST           Change Plant Fl
     C                     MOVEL*BLANK    P4Y5ST           AS Add/Change/D
     C                     MOVEL*BLANK    P5WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P5WSST           PRT Hold Output
     C                     MOVEL*BLANK    P5WTST           PRT Save Output
     C                     Z-ADD*ZERO     P5DYNB           PRT Number of C
     C                     MOVEL*BLANK    P5WUST           PRT Night Queue
     C                     MOVEL*BLANK    P5BVVN           PRT Night Queue
     C                     MOVEL*BLANK    P5BMVN           Program name US
     C                     MOVEL*BLANK    P5BWVN           Program Name$ U
     C                     MOVEL*BLANK    P5XFST           Display Prt Opt
     C                     Z-ADD*ZERO     P6M8NB           System Value Nu
     C                     Z-ADD*ZERO     P7BOXI           Box iD
     C                     MOVEL*BLANK    P8E5ST           USR Output Only
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Allow Weight Input
     C                     MOVEL*BLANK    WUIFST  1
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Define work field Record Status 3 usr
     C                     MOVEL*BLANK    WUE4ST  1
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCUSNB           Item Category N
     C                     Z-ADD*ZERO     WCOHNX           Item Category T
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Define work field Department Description
     C                     MOVEL*BLANK    WUMYNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Alpha Zeros 2
     C                     MOVEL*BLANK    WUKTTX  2
      * Define work field DL List ID
     C                     MOVEL*BLANK    WUCLAA 10
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SBRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     MOVEL*BLANK    WL0006  2
     C                     Z-ADD*ZERO     WL0007  70
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0008  30
     C                     MOVEL*BLANK    WL0009  2
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  20
     C                     MOVEL*BLANK    WL0013  3
     C                     MOVEL*BLANK    WL0014  7
     C                     MOVEL*BLANK    WL0015  1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0016  6
     C                     MOVEL*BLANK    WL0017 30
      * Define local variables for subroutine SXRVGN.
     C                     MOVEL*BLANK    WL0018 10
     C                     MOVEL*BLANK    WL0019  6
     C                     Z-ADD*ZERO     WL0020  30
     C                     MOVEL*BLANK    WL0021  3
      * Define local work field Allow BoxId to Chg Usr
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Pckg Item Type
     C                     MOVEL*BLANK    YL0002  2
      * Define local work field Incl in Misc Tare
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field USR Display 1
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Output Only 1 USR
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Quantity on Hand - U/M1
     C                     Z-ADD*ZERO     YL0007 112
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0008  2
      * Define local work field Item Type Code USR
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field BLANK
     C                     MOVEL*BLANK    YL0010256
      * Define local work field Description
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field BLANK 1               USR
     C                     MOVEL*BLANK    YL0012 25
      * Define local work field Market Price Date
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Item Code Error Sts Usr
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Record Found - ItmBom Usr
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field BOM Type Usr
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Company Number Alpha
     C                     MOVEL*BLANK    YL0017  3
      * Define local work field Item Code Txt
     C                     MOVEL*BLANK    YL0018  7
      * Define local work field Text USR 8
     C                     MOVEL*BLANK    YL0019  8
      * Define local work field Text USR 20
     C                     MOVEL*BLANK    YL0020 20
      * Define local work field Note: Text Usr - 50
     C                     MOVEL*BLANK    YL0021 50
      * Define local work field Change Flag USR
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field Office Message USR 1
     C                     MOVEL*BLANK    YL0023 40
      * Define local work field Office Message USR 2
     C                     MOVEL*BLANK    YL0024 40
      * Define local work field Office Message USR 3
     C                     MOVEL*BLANK    YL0025 40
      * Define local work field Office Message USR 4
     C                     MOVEL*BLANK    YL0026 40
      * Define local work field Office Message USR 5
     C                     MOVEL*BLANK    YL0027 40
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0028  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0029  3
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0012 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0012           User Profile Na
      *
     C                     MOVEL*BLANK    WN0013 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SWRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,003                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0012    ZA0070           User Profile Na
     C                     MOVEL'C/S'     ZA0071           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0013    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0012    WL0018    P      User Profile Na
     C                     MOVEL'C/S'     WL0019    P      Application Cod
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUAIC3           Company Number
     C                     MOVELWL0021    YL0029    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0013    WL0018    P      User Profile Na
     C                     MOVEL'C/S'     WL0019    P      Application Cod
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    WUAIC3           Company Number
     C                     MOVELWL0021    YL0029    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0029    P2AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0012    ZA0072           User Profile Na
     C                     MOVEL'C/S'     ZA0073           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0028    IFNE 0                          *IF
     C                     Z-ADDYL0028    WUAIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0029    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P2AJCD    PARM *BLANK    WQ0300  3        Warehouse Code
     C                     PARM YL0028    WQ0301  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SYRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Force program into add mode if no item present
      * CASE: PAR.Item Code is Not Entered
     C           P1HGCD    IFEQ *ZERO                      *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
0105101307
** W0END
0105301313
** W0NAM
V1AIC3    V1HGCD
** W1BEG
00796008050105201061013170156401573
01820018470207602085023320234102588
02844028860310003129033560337503381
03401036120361603868038780412404143
04380049090491404919049250493004936
0494105148054040540805445
** W1END
00798008340105801090013460156601597
01826018480207802114023340236502600
02849028870310603141033560337703388
03406036120364003873039070412404165
04382049090491404919049250493004936
0494105149054040541905445
** W1NAM
V1AIC3    #DADTX    V1HGCD    #1AVNA    #1AWNA    #1N0CD    #DHLTX
#DBOXI    #1ADCD    #1Q1CD    #DF8NA    #1TDST    #DHMTX    #1AIWG
#1A3WG    #DEPST    #1BNNB    #1SWGH    #1SVST    #1S0CD    #DYMTX
#1XRCD    #DENST    #DHNTX    #DKUAA    #DUVNA    #DEMST    #DSETX
#1S2CD    #DD0ST    #DD2ST    #DD6ST    #DWESP    #DEDST    #DEFST
#DEHST    #DEQST    #1VSST    #DHKNA    #DYPSX
** @CN
00001 Allocated orders exist.
00002 USR0752
00003 Y2U0005
00004 Changed By:
00005 CO/ITEM:
00006 Unit Weight:
00007 Misc Tare Weight:
00008 Min Wt per Case:
00009 Max Wt per Case:
00010 Pieces per Bag:
00011 Bags per Unit:
00012 PRKSCHED
