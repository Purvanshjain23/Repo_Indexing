// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKPEDTR
// ?Date: 14.08.2025 Time: 02:51:45
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Payment Processing RT) TYPE(RTVOBJ) FILE(PKC4REP)          AB1147409;
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER(WRK.Pmt_Current_Payment_Step);
PARAMETER(WRK.PP_Commission_Paym_Error);
PARAMETER(WRK.PP_Payment_Error);
PARAMETER(WRK.PP_Unused_Nbr_1);
PARAMETER(WRK.PP_Repayment_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

//?Step 5  Payment edits and pre edits  ** Edit **
DO;

// WRK.Pmt Payment Error = CND.No Errors
WRK.Pmt_Payment_Error = 'N';

// Call program Prt Pre-Chk Edit Rep  PF.
CALL PROGRAM(Prt Pre-Chk Edit Rep  PF) ('PKTQPFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('E');
PARAMETER('E');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.Pmt_Payment_Error);

// Call program Prt Pur-Jrn Prm/      PF.
CALL PROGRAM(Prt Pur-Jrn Prm/      PF) ('PKTTPFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('E');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.Pmt_Payment_Error);

// Call program Prt Pur-Jrn Rsl       PF.
CALL PROGRAM(Prt Pur-Jrn Rsl       PF) ('PKTZPFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('E');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('U');
PARAMETER(WRK.Pmt_Payment_Error);

// Call program Prt Payment Edit/Post PF.
CALL PROGRAM(Prt Payment Edit/Post PF) ('PKS2PFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('E');
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER('A');
PARAMETER(WRK.Pmt_Payment_Error);

//?Competitor reports
// Call program Zzz Competitors Total XF.
CALL PROGRAM(Zzz Competitors Total XF) ('PKXWXFR');
PARAMETER(PAR.CC_Company_Number);

// Call program Prt CM Competitor Rpt PF.
CALL PROGRAM(Prt CM Competitor Rpt PF) ('PKX1PFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(*ZERO);
PARAMETER(WRK.CT_Source_Type);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('L');
PARAMETER(PAR.Oms_System_Value_Alpha);

// Call program Prt CM Comp Comparisn PF.
CALL PROGRAM(Prt CM Comp Comparisn PF) ('PKX4PFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(*ZERO);
PARAMETER(WRK.CT_Source_Type);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER(WRK.Pmt_Current_Payment_Date);
PARAMETER('L');
PARAMETER(PAR.Oms_System_Value_Alpha);

ENDDO;

