     H/TITLE Prg Carcass Detail    XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:14:13
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB1CPLCIF  E           K        DISK
      * RSQ : Carcass Detail            Kill Dte (D) / Company
      *
     FPKB1CPLDIF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index Purge
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     I@B1CPVH
      * Carcass Detail            Kill Dte (D) / Company
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
     I@B1CPVI
      * Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WBHMNB
     I              B1BNNB                          WBBNNB
     I              B1BONB                          WBBONB
     I              B1CVNB                          WBCVNB
     I              B1B0DT                          WBB0DT
     I              B1LGNB                          WBLGNB
     I              B1EUNB                          WBEUNB
     I              B1LHNB                          WBLHNB
     I              B1INST                          WBINST
     I              B1BEPR                          WBBEPR
     I              B1ASPC                          WBASPC
     I              B1EWNB                          WBEWNB
     I              B1B4PR                          WBB4PR
     I              B1EYNB                          WBEYNB
     I              B1B1PR                          WBB1PR
     I              B1AVPR                          WBAVPR
     I              B1AUPC                          WBAUPC
     I              B1AWPR                          WBAWPR
     I              B1AXPR                          WBAXPR
     I              B1EZNB                          WBEZNB
     I              B1AYPR                          WBAYPR
     I              B1BBDT                          WBBBDT
     I              B1AKTM                          WBAKTM
     I              B1IQST                          WBIQST
     I              B1EFST                          WBEFST
     I              B1H6NB                          WBH6NB
     I              B1BEPC                          WBBEPC
     I              B1GCST                          WBGCST
     I              B1GDST                          WBGDST
     I              B1GEST                          WBGEST
     I              B1BHPC                          WBBHPC
     I              B1IOST                          WBIOST
     I              B1IPST                          WBIPST
     I              B1LTNB                          WBLTNB
     I              B1JNST                          WBJNST
     I              B1X4NB                          WBX4NB
     I              B1FNPC                          WBFNPC
     I              B1FOPC                          WBFOPC
     I              B1FPPC                          WBFPPC
     I              B1K2ST                          WBK2ST
     I              B1K3ST                          WBK3ST
     I              B1JWPR                          WBJWPR
     I              B1F5PC                          WBF5PC
     I              B1JXPR                          WBJXPR
     I              B1JYPR                          WBJYPR
     I              B1JZPR                          WBJZPR
     I              B1J0PR                          WBJ0PR
     I              B1J1PR                          WBJ1PR
     I              B1J2PR                          WBJ2PR
     I              B1J3PR                          WBJ3PR
     I              B1J4PR                          WBJ4PR
     I              B1UTST                          WBUTST
     I              B1HVCD                          WBHVCD
     I              B1DKJR                          WBDKJR
     I              B1ITJF                          WBITJF
     I              B1IJGR                          WBIJGR
     I              B1ORJE                          WBORJE
     I              B1OTJR                          WBOTJR
     I              B1PEIR                          WBPEIR
     I              B1IEUF                          WBIEUF
     I              B1ORUE                          WBORUE
     I              B1IUTR                          WBIUTR
     I              B1IJRR                          WBIJRR
     I              B1VCST                          WBVCST
     I              B1VDST                          WBVDST
     I              B1VEST                          WBVEST
     I              B1VFST                          WBVFST
     I              B1VGST                          WBVGST
     I              B1ABCD                          WBABCD
     I              B1AACD                          WBAACD
     I              B1AAVN                          WBAAVN
     I              B1AADT                          WBAADT
     I              B1AMTM                          WBAMTM
     I              B1AJST                          WBAJST
     I              B1AHVN                          WBAHVN
     I              B1AGVN                          WBAGVN
     I              B1ABVN                          WBABVN
     I              B1ABDT                          WBABDT
     I              B1ABTM                          WBABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WCHMNB
     I              B1BNNB                          WCBNNB
     I              B1BONB                          WCBONB
     I              B1CVNB                          WCCVNB
     I              B1B0DT                          WCB0DT
     I              B1LGNB                          WCLGNB
     I              B1EUNB                          WCEUNB
     I              B1LHNB                          WCLHNB
     I              B1INST                          WCINST
     I              B1BEPR                          WCBEPR
     I              B1ASPC                          WCASPC
     I              B1EWNB                          WCEWNB
     I              B1B4PR                          WCB4PR
     I              B1EYNB                          WCEYNB
     I              B1B1PR                          WCB1PR
     I              B1AVPR                          WCAVPR
     I              B1AUPC                          WCAUPC
     I              B1AWPR                          WCAWPR
     I              B1AXPR                          WCAXPR
     I              B1EZNB                          WCEZNB
     I              B1AYPR                          WCAYPR
     I              B1BBDT                          WCBBDT
     I              B1AKTM                          WCAKTM
     I              B1IQST                          WCIQST
     I              B1EFST                          WCEFST
     I              B1H6NB                          WCH6NB
     I              B1BEPC                          WCBEPC
     I              B1GCST                          WCGCST
     I              B1GDST                          WCGDST
     I              B1GEST                          WCGEST
     I              B1BHPC                          WCBHPC
     I              B1IOST                          WCIOST
     I              B1IPST                          WCIPST
     I              B1LTNB                          WCLTNB
     I              B1JNST                          WCJNST
     I              B1X4NB                          WCX4NB
     I              B1FNPC                          WCFNPC
     I              B1FOPC                          WCFOPC
     I              B1FPPC                          WCFPPC
     I              B1K2ST                          WCK2ST
     I              B1K3ST                          WCK3ST
     I              B1JWPR                          WCJWPR
     I              B1F5PC                          WCF5PC
     I              B1JXPR                          WCJXPR
     I              B1JYPR                          WCJYPR
     I              B1JZPR                          WCJZPR
     I              B1J0PR                          WCJ0PR
     I              B1J1PR                          WCJ1PR
     I              B1J2PR                          WCJ2PR
     I              B1J3PR                          WCJ3PR
     I              B1J4PR                          WCJ4PR
     I              B1UTST                          WCUTST
     I              B1HVCD                          WCHVCD
     I              B1DKJR                          WCDKJR
     I              B1ITJF                          WCITJF
     I              B1IJGR                          WCIJGR
     I              B1ORJE                          WCORJE
     I              B1OTJR                          WCOTJR
     I              B1PEIR                          WCPEIR
     I              B1IEUF                          WCIEUF
     I              B1ORUE                          WCORUE
     I              B1IUTR                          WCIUTR
     I              B1IJRR                          WCIJRR
     I              B1VCST                          WCVCST
     I              B1VDST                          WCVDST
     I              B1VEST                          WCVEST
     I              B1VFST                          WCVFST
     I              B1VGST                          WCVGST
     I              B1ABCD                          WCABCD
     I              B1AACD                          WCAACD
     I              B1AAVN                          WCAAVN
     I              B1AADT                          WCAADT
     I              B1AMTM                          WCAMTM
     I              B1AJST                          WCAJST
     I              B1AHVN                          WCAHVN
     I              B1AGVN                          WCAGVN
     I              B1ABVN                          WCABVN
     I              B1ABDT                          WCABDT
     I              B1ABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB11    E DSPKB1CPLD
      * UPD : Carcass Detail            Update index Purge
      * Renamed input format fields
     I              B1HMNB                          WBHMNB
     I              B1BNNB                          WBBNNB
     I              B1BONB                          WBBONB
     I              B1CVNB                          WBCVNB
     I              B1B0DT                          WBB0DT
     I              B1LGNB                          WBLGNB
     I              B1EUNB                          WBEUNB
     I              B1LHNB                          WBLHNB
     I              B1INST                          WBINST
     I              B1BEPR                          WBBEPR
     I              B1ASPC                          WBASPC
     I              B1EWNB                          WBEWNB
     I              B1B4PR                          WBB4PR
     I              B1EYNB                          WBEYNB
     I              B1B1PR                          WBB1PR
     I              B1AVPR                          WBAVPR
     I              B1AUPC                          WBAUPC
     I              B1AWPR                          WBAWPR
     I              B1AXPR                          WBAXPR
     I              B1EZNB                          WBEZNB
     I              B1AYPR                          WBAYPR
     I              B1BBDT                          WBBBDT
     I              B1AKTM                          WBAKTM
     I              B1IQST                          WBIQST
     I              B1EFST                          WBEFST
     I              B1H6NB                          WBH6NB
     I              B1BEPC                          WBBEPC
     I              B1GCST                          WBGCST
     I              B1GDST                          WBGDST
     I              B1GEST                          WBGEST
     I              B1BHPC                          WBBHPC
     I              B1IOST                          WBIOST
     I              B1IPST                          WBIPST
     I              B1LTNB                          WBLTNB
     I              B1JNST                          WBJNST
     I              B1X4NB                          WBX4NB
     I              B1FNPC                          WBFNPC
     I              B1FOPC                          WBFOPC
     I              B1FPPC                          WBFPPC
     I              B1K2ST                          WBK2ST
     I              B1K3ST                          WBK3ST
     I              B1JWPR                          WBJWPR
     I              B1F5PC                          WBF5PC
     I              B1JXPR                          WBJXPR
     I              B1JYPR                          WBJYPR
     I              B1JZPR                          WBJZPR
     I              B1J0PR                          WBJ0PR
     I              B1J1PR                          WBJ1PR
     I              B1J2PR                          WBJ2PR
     I              B1J3PR                          WBJ3PR
     I              B1J4PR                          WBJ4PR
     I              B1UTST                          WBUTST
     I              B1HVCD                          WBHVCD
     I              B1DKJR                          WBDKJR
     I              B1ITJF                          WBITJF
     I              B1IJGR                          WBIJGR
     I              B1ORJE                          WBORJE
     I              B1OTJR                          WBOTJR
     I              B1PEIR                          WBPEIR
     I              B1IEUF                          WBIEUF
     I              B1ORUE                          WBORUE
     I              B1IUTR                          WBIUTR
     I              B1IJRR                          WBIJRR
     I              B1VCST                          WBVCST
     I              B1VDST                          WBVDST
     I              B1VEST                          WBVEST
     I              B1VFST                          WBVFST
     I              B1VGST                          WBVGST
     I              B1ABCD                          WBABCD
     I              B1AACD                          WBAACD
     I              B1AAVN                          WBAAVN
     I              B1AADT                          WBAADT
     I              B1AMTM                          WBAMTM
     I              B1AJST                          WBAJST
     I              B1AHVN                          WBAHVN
     I              B1AGVN                          WBAGVN
     I              B1ABVN                          WBABVN
     I              B1ABDT                          WBABDT
     I              B1ABTM                          WBABTM
      *
     IQPKB12    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WCHMNB
     I              B1BNNB                          WCBNNB
     I              B1BONB                          WCBONB
     I              B1CVNB                          WCCVNB
     I              B1B0DT                          WCB0DT
     I              B1LGNB                          WCLGNB
     I              B1EUNB                          WCEUNB
     I              B1LHNB                          WCLHNB
     I              B1INST                          WCINST
     I              B1BEPR                          WCBEPR
     I              B1ASPC                          WCASPC
     I              B1EWNB                          WCEWNB
     I              B1B4PR                          WCB4PR
     I              B1EYNB                          WCEYNB
     I              B1B1PR                          WCB1PR
     I              B1AVPR                          WCAVPR
     I              B1AUPC                          WCAUPC
     I              B1AWPR                          WCAWPR
     I              B1AXPR                          WCAXPR
     I              B1EZNB                          WCEZNB
     I              B1AYPR                          WCAYPR
     I              B1BBDT                          WCBBDT
     I              B1AKTM                          WCAKTM
     I              B1IQST                          WCIQST
     I              B1EFST                          WCEFST
     I              B1H6NB                          WCH6NB
     I              B1BEPC                          WCBEPC
     I              B1GCST                          WCGCST
     I              B1GDST                          WCGDST
     I              B1GEST                          WCGEST
     I              B1BHPC                          WCBHPC
     I              B1IOST                          WCIOST
     I              B1IPST                          WCIPST
     I              B1LTNB                          WCLTNB
     I              B1JNST                          WCJNST
     I              B1X4NB                          WCX4NB
     I              B1FNPC                          WCFNPC
     I              B1FOPC                          WCFOPC
     I              B1FPPC                          WCFPPC
     I              B1K2ST                          WCK2ST
     I              B1K3ST                          WCK3ST
     I              B1JWPR                          WCJWPR
     I              B1F5PC                          WCF5PC
     I              B1JXPR                          WCJXPR
     I              B1JYPR                          WCJYPR
     I              B1JZPR                          WCJZPR
     I              B1J0PR                          WCJ0PR
     I              B1J1PR                          WCJ1PR
     I              B1J2PR                          WCJ2PR
     I              B1J3PR                          WCJ3PR
     I              B1J4PR                          WCJ4PR
     I              B1UTST                          WCUTST
     I              B1HVCD                          WCHVCD
     I              B1DKJR                          WCDKJR
     I              B1ITJF                          WCITJF
     I              B1IJGR                          WCIJGR
     I              B1ORJE                          WCORJE
     I              B1OTJR                          WCOTJR
     I              B1PEIR                          WCPEIR
     I              B1IEUF                          WCIEUF
     I              B1ORUE                          WCORUE
     I              B1IUTR                          WCIUTR
     I              B1IJRR                          WCIJRR
     I              B1VCST                          WCVCST
     I              B1VDST                          WCVDST
     I              B1VEST                          WCVEST
     I              B1VFST                          WCVFST
     I              B1VGST                          WCVGST
     I              B1ABCD                          WCABCD
     I              B1AACD                          WCAACD
     I              B1AAVN                          WCAAVN
     I              B1AADT                          WCAADT
     I              B1AMTM                          WCAMTM
     I              B1AJST                          WCAJST
     I              B1AHVN                          WCAHVN
     I              B1AGVN                          WCAGVN
     I              B1ABVN                          WCABVN
     I              B1ABDT                          WCABDT
     I              B1ABTM                          WCABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  TH Kill Date
     I                                    P   1   40P1B0DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1B0DT    PARM           WP0001  70       TH Kill Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prg Carcass Detail    XF
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      * Prg Carcass Detail    RT - Carcass Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prg Carcass Detail    RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@B1CPVH                    *
     C                     READ @B1CPVH                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** Write purged records to the file in QTEMP.
      * ** Then delete the record from production.
      * Prg Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SBCRRC
      * Prg Carcass Detail    DL - Carcass Detail  * 
     C                     EXSR SCDLRC
     C                     READ @B1CPVH                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Prg Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPVI
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WBLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WBEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WBLHNB           CD Carcass Numb
     C                     MOVELWAINST    WBINST           CD Record Add/D
     C                     Z-ADDWABEPR    WBBEPR           CD Sort Loss
     C                     Z-ADDWAASPC    WBASPC           CD STD Yield
     C                     Z-ADDWAEWNB    WBEWNB           CD Carcass/Hot
     C                     Z-ADDWAB4PR    WBB4PR           CD Base Carcass
     C                     Z-ADDWAEYNB    WBEYNB           CD Crc Value Pe
     C                     Z-ADDWAB1PR    WBB1PR           CD Base Carc Va
     C                     Z-ADDWAAVPR    WBAVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    WBAUPC           CD Lean Percent
     C                     Z-ADDWAAWPR    WBAWPR           CD Lean Premium
     C                     Z-ADDWAAXPR    WBAXPR           CD Lean Premium
     C                     Z-ADDWAEZNB    WBEZNB           CD Gross Value
     C                     Z-ADDWAAYPR    WBAYPR           CD Gross Value
     C                     Z-ADDWABBDT    WBBBDT           CD Kill Date
     C                     Z-ADDWAAKTM    WBAKTM           CD Kill Time
     C                     MOVELWAIQST    WBIQST           CD Shift
     C                     MOVELWAEFST    WBEFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    WBH6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    WBBEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    WBGCST           CD Light Reflec
     C                     MOVELWAGDST    WBGDST           CD Trim Area
     C                     MOVELWAGEST    WBGEST           CD Carcass Sex
     C                     Z-ADDWABHPC    WBBHPC           CD FFLI
     C                     MOVELWAIOST    WBIOST           CD Record Creat
     C                     MOVELWAIPST    WBIPST           CD Record Creat
     C                     Z-ADDWALTNB    WBLTNB           CD LOT
     C                     MOVELWAJNST    WBJNST           CD User Error O
     C                     Z-ADDWAX4NB    WBX4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    WBFNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    WBFOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    WBFPPC           CD Lean Percent
     C                     MOVELWAK2ST    WBK2ST           CD Source Type
     C                     MOVELWAK3ST    WBK3ST           CD Payment Type
     C                     Z-ADDWAJWPR    WBJWPR           CD CA Sort Loss
     C                     Z-ADDWAF5PC    WBF5PC           CD CA Std Yield
     C                     Z-ADDWAJXPR    WBJXPR           CD CA Base Carc
     C                     Z-ADDWAJYPR    WBJYPR           CD CA Crc Value
     C                     Z-ADDWAJZPR    WBJZPR           CD CA Base Carc
     C                     Z-ADDWAJ0PR    WBJ0PR           CD CA Crc Value
     C                     Z-ADDWAJ1PR    WBJ1PR           CD CA Lean Prem
     C                     Z-ADDWAJ2PR    WBJ2PR           CD CA Lean Prem
     C                     Z-ADDWAJ3PR    WBJ3PR           CD CA Gross Val
     C                     Z-ADDWAJ4PR    WBJ4PR           CD CA Gross Val
     C                     MOVELWAUTST    WBUTST           CD Adjust/Add T
     C                     MOVELWAHVCD    WBHVCD           CD Producer Loc
     C                     Z-ADDWADKJR    WBDKJR           CD Loin Eye Inc
     C                     Z-ADDWAITJF    WBITJF           CD Backfat Inch
     C                     Z-ADDWAIJGR    WBIJGR           CD Meat Value F
     C                     Z-ADDWAORJE    WBORJE           CD Lean Prem/Di
     C                     Z-ADDWAOTJR    WBOTJR           CD Fixed Cost F
     C                     Z-ADDWAPEIR    WBPEIR           CD MPR Sort Los
     C                     Z-ADDWAIEUF    WBIEUF           CD Meat Value F
     C                     Z-ADDWAORUE    WBORUE           CD Fixed Cost F
     C                     Z-ADDWAIUTR    WBIUTR           CD Gross Before
     C                     Z-ADDWAIJRR    WBIJRR           CD Gross Before
     C                     MOVELWAVCST    WBVCST           CD Broken Back
     C                     MOVELWAVDST    WBVDST           CD Adjust/Add S
     C                     MOVELWAVEST    WBVEST           CD Unused Sts 3
     C                     MOVELWAVFST    WBVFST           CD Unused Sts 4
     C                     MOVELWAVGST    WBVGST           CD Unused Sts 5
     C                     MOVELWAABCD    WBABCD           PD Producer Cod
     C                     MOVELWAAACD    WBAACD           SR Source Code
     C                     MOVELWAAAVN    WBAAVN           RS User Changed
     C                     Z-ADDWAAADT    WBAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WBAMTM           RS Time Changed
     C                     MOVELWAAJST    WBAJST           RS Record Statu
     C                     MOVELWAAHVN    WBAHVN           RS Job
     C                     MOVELWAAGVN    WBAGVN           RS Program
     C                     MOVELWAABVN    WBABVN           RS User Added
     C                     Z-ADDWAABDT    WBABDT           RS Date Added
     C                     Z-ADDWAABTM    WBABTM           RS Time Added
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBLGNB           CD Scale Sequen
     C                     KFLD           WBEUNB           CD Carcass Numb
     C                     KFLD           WBLHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSB    SETLL@B1CPVI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPVI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * Prg Carcass Detail    DL - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1CPG6
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WCLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WCEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WCLHNB           CD Carcass Numb
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCLGNB           CD Scale Sequen
     C                     KFLD           WCEUNB           CD Carcass Numb
     C                     KFLD           WCLHNB           CD Carcass Numb
     C           KLDLSC    CHAIN@B1CPG6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1CPG6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** 01/26/2009 LJB FP1009
      * ** Remove QTEMP processing, write records to Purge Library
      * ** then delete from production
      * ** 08/16/2007 LJB FP1009
      * ** All the records that are older than the Purge Date will be
      * ** written to QTEMP then deleted from production.
      * ** Remove user validation and company number. Remove date calcula
      * ** this will be done in the calling program and the date will be
      * ** passed in.
      * ** H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
