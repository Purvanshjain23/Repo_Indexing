// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBVSXFR
// ?Date: 14.08.2025 Time: 03:49:31
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(MG Drv Ld Sts L/S/I   RT) TYPE(RTVOBJ) FILE(OPBFCPP)           AC2117901;
PARAMETER(PAR.Load_ID);
PARAMETER(PAR.Load_Status);
{
 //?USER: Initialize routine

 //?If at least one Order on the Load is Invoiced, then do not select
 //?the Load.
 //?Assume that the Load is Locked
 // LCL.Load Status = CND.Lock
 LCL.Load_Status = 'L';

 //?Assume All orders are shipped on the load
 // LCL.All Orders Shipped USR = CND.Yes
 LCL.All_Orders_Shipped_USR = 'Y';

 //?USER: Process Data record

 //?Load Status=Invoiced if At least one order is invoiced
 CASE;

 // IF DB1.Header Status is Complete
 IF DB1.Header_Status = 'C';

 //?If at least one order is invoiced, then the Load is in process
 //?of being invoiced.
 // LCL.Load Status = CND.Invoiced
 LCL.Load_Status = 'I';

 ENDIF;

 //?All Orders Shipped
 CASE;

 // IF DB1.Header Status is Avail/Alloc/Enter/Hold
 IF DB1.Header_Status = 'L'/'A'/'E'/'H';

 // LCL.All Orders Shipped USR = CND.No
 LCL.All_Orders_Shipped_USR = *BLANK;

 ENDIF;

 //?USER: Exit processing

 CASE;

 // IF LCL.Load Status is Invoiced
 IF LCL.Load_Status = 'I';

 // PAR.Load Status = CND.Invoiced
 PAR.Load_Status = 'I';

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF LCL.All Orders Shipped USR is Yes
 IF LCL.All_Orders_Shipped_USR = 'Y';

 // PAR.Load Status = CND.Shipped
 PAR.Load_Status = 'S';

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Load Status = CND.Lock
 PAR.Load_Status = 'L';

 ENDIF;

 ENDIF;

}


