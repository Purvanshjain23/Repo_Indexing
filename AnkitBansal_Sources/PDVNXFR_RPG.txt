     H/TITLE UPD Crt WF AR Ord-Name XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISELOUC
     H* Date          : 08/02/23  Time  : 10:44:33
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FARBECPL2IF  E           K        DISK
      * RSQ : A/R Detail                Co,Date,Inv
      *
     FARBDCPLZIF  E           K        DISK
      * RSQ : A/R Header                Cust/Inv - all
      *
     FPDJ3CPL2IF  E           K        DISK
      * RSQ : A/R Adjustment Type       Co/Type Active Records
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FCABBREL4IF  E           K        DISK
      * RSQ : Customer                  Bill To/Ship To
      *
     FPDK5REL0IF  E           K        DISK                      A
      * UPD : WF A/R Orders by Name     Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BECPME
      * A/R Detail                Co,Date,Inv
      * Renamed input format fields
     I              BFAIC3                          WAAIC3
     I              BFCONB                          WACONB
     I              BFCEST                          WACEST
     I              BFDXNB                          WADXNB
     I              BFUHCD                          WAUHCD
     I              BFBSVA                          WABSVA
     I              BFCPTX                          WACPTX
     I              BFNGNA                          WANGNA
     I              BFB4DT                          WAB4DT
     I              BFDVDT                          WADVDT
     I              BFYXNX                          WAYXNX
     I              BFHYDT                          WAHYDT
     I              BFG4CD                          WAG4CD
     I              BFCKNB                          WACKNB
     I              BFA5ST                          WAA5ST
     I              BFAJST                          WAAJST
     I              BFB1VN                          WAB1VN
     I              BFEAZT                          WAEAZT
     I              BFC1NY                          WAC1NY
     I              BFIZTX                          WAIZTX
     I              BFETSX                          WAETSX
     I              BFW3SX                          WAW3SX
     I              BFW4SX                          WAW4SX
     I              BFW5SX                          WAW5SX
     I              BFW6SX                          WAW6SX
     I              BFW7SX                          WAW7SX
     I              BFW8SX                          WAW8SX
     I              BFQHDT                          WAQHDT
     I              BFQIDT                          WAQIDT
     I              BFQJDT                          WAQJDT
     I              BFQKDT                          WAQKDT
     I              BFQLDT                          WAQLDT
     I              BFGLVL                          WAGLVL
     I              BFGMVL                          WAGMVL
     I              BFGNVL                          WAGNVL
     I              BFGOVL                          WAGOVL
     I              BFGPVL                          WAGPVL
     I              BFUVST                          WAUVST
     I              BFUWST                          WAUWST
     I              BFUXST                          WAUXST
     I              BFAATM                          WAAATM
     I              BFAYNA                          WAAYNA
     I              BFA0NA                          WAA0NA
     I              BFAXDT                          WAAXDT
      *
     I@BDCPAO
      * A/R Header                Cust/Inv - all
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     I@J3CPCZ
      * A/R Adjustment Type       Co/Type Active Records
      * Renamed input format fields
     I              J3AIC3                          WCAIC3
     I              J3UHCD                          WCUHCD
     I              J3NFNA                          WCNFNA
     I              J3EAZT                          WCEAZT
     I              J3IZTX                          WCIZTX
     I              J3UKVA                          WCUKVA
     I              J3A5ST                          WCA5ST
     I              J3GLTS                          WCGLTS
     I              J3SYSC                          WCSYSC
     I              J3UVST                          WCUVST
     I              J3UWST                          WCUWST
     I              J3UXST                          WCUXST
     I              J3VSST                          WCVSST
     I              J3AATM                          WCAATM
     I              J3AYNA                          WCAYNA
     I              J3A0NA                          WCA0NA
     I              J3AXDT                          WCAXDT
      *
     I@BDCPF7
      * A/R Header                Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                          WDAIC3
     I              BDCONB                          WDCONB
     I              BDCEST                          WDCEST
     I              BDUHCD                          WDUHCD
     I              BDBSVA                          WDBSVA
     I              BDAIVA                          WDAIVA
     I              BDAOVA                          WDAOVA
     I              BDBGVA                          WDBGVA
     I              BDAJST                          WDAJST
     I              BDE3ST                          WDE3ST
     I              BDG4CD                          WDG4CD
     I              BDCKNB                          WDCKNB
     I              BDCAC7                          WDCAC7
     I              BDBKC7                          WDBKC7
     I              BDBCCD                          WDBCCD
     I              BDR4CD                          WDR4CD
     I              BDB4DT                          WDB4DT
     I              BDATDT                          WDATDT
     I              BDH0DT                          WDH0DT
     I              BDH3DT                          WDH3DT
     I              BDH4DT                          WDH4DT
     I              BDH5DT                          WDH5DT
     I              BDANC7                          WDANC7
     I              BDCPTX                          WDCPTX
     I              BDBSDY                          WDBSDY
     I              BDUVST                          WDUVST
     I              BDUWST                          WDUWST
     I              BDUXST                          WDUXST
     I              BDAATM                          WDAATM
     I              BDAYNA                          WDAYNA
     I              BDA0NA                          WDA0NA
     I              BDAXDT                          WDAXDT
      *
     I@BBREC1
      * Customer                  Bill To/Ship To
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@K5RELK
      * WF A/R Orders by Name     Update index
      * Renamed input format fields
     I              K5AIC3                          WFAIC3
     I              K5AQTX                          WFAQTX
     I              K5ANC7                          WFANC7
     I              K5DVDT                          WFDVDT
     I              K5CONB                          WFCONB
     I              K5CEST                          WFCEST
     I              K5DXNB                          WFDXNB
     I              K5AWDT                          WFAWDT
     I              K5CAC7                          WFCAC7
     I              K5A1VA                          WFA1VA
     I              K5BSVA                          WFBSVA
     I              K5CPTX                          WFCPTX
     I              K5UHCD                          WFUHCD
     I              K5NGNA                          WFNGNA
     I              K5B4DT                          WFB4DT
     I              K5A5ST                          WFA5ST
     I              K5CKNB                          WFCKNB
     I              K5JMNY                          WFJMNY
     I              K5AYTX                          WFAYTX
     I              K5CHC7                          WFCHC7
     I              K5OVT1                          WFOVT1
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDK51    E DSPDK5REL0
      * UPD : WF A/R Orders by Name     Update index
      * Renamed input format fields
     I              K5AIC3                          WFAIC3
     I              K5AQTX                          WFAQTX
     I              K5ANC7                          WFANC7
     I              K5DVDT                          WFDVDT
     I              K5CONB                          WFCONB
     I              K5CEST                          WFCEST
     I              K5DXNB                          WFDXNB
     I              K5AWDT                          WFAWDT
     I              K5CAC7                          WFCAC7
     I              K5A1VA                          WFA1VA
     I              K5BSVA                          WFBSVA
     I              K5CPTX                          WFCPTX
     I              K5UHCD                          WFUHCD
     I              K5NGNA                          WFNGNA
     I              K5B4DT                          WFB4DT
     I              K5A5ST                          WFA5ST
     I              K5CKNB                          WFCKNB
     I              K5JMNY                          WFJMNY
     I              K5AYTX                          WFAYTX
     I              K5CHC7                          WFCHC7
     I              K5OVT1                          WFOVT1
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Customer Number       NBR
     I                                    P   1   40P2AJNB
     IP3PARM      DS
      * FLD: *Arrays
      * I :  USR From Date Numeric
     I                                    P   1   40P3EQNB
      * I :  Thru Date             USR
     I                                    P   5   80P3OADT
     IP4PARM      DS
      * I :  AR Customer Name
     I                                        1  30 P4AQTX
     IP5PARM      DS
      * FLD: *Arrays
      * I :  USR Adjustment Type 1
     I                                        1   3 P5GEAA
      * I :  USR Adjustment Type 2
     I                                        4   6 P5GFAA
      * I :  USR Adjustment Type 3
     I                                        7   9 P5GGAA
      * I :  USR Adjustment Type 4
     I                                       10  12 P5GHAA
      * I :  USR Adjustment Type 5
     I                                       13  15 P5GIAA
      * I :  USR Adjustment Type 6
     I                                       16  18 P5GJAA
      * I :  USR Adjustment Type 7
     I                                       19  21 P5GKAA
      * I :  USR Adjustment Type 8
     I                                       22  24 P5GLAA
      * I :  USR Adjustment Type 9
     I                                       25  27 P5GMAA
      * I :  USR Adjustment Type 10
     I                                       28  30 P5GNAA
      * I :  USR Company Number 2
     I                                    P  31  320P5B6C3
      * I :  USR Company Number 3
     I                                    P  33  340P5B7C3
     IP6PARM      DS
      * FLD: *Arrays
      * I :  Invoice Suffix
     I                                        1   2 P6CEST
      * I :  Invoice Suffix 2
     I                                        3   4 P6RCSX
      * I :  Invoice Suffix 3
     I                                        5   6 P6RDSX
      * I :  Invoice Suffix 4
     I                                        7   8 P6RESX
      * I :  Invoice Suffix 5
     I                                        9  10 P6RFSX
      * I :  Invoice_Memo Suffix
     I                                       11  12 P6OMST
     IP7PARM      DS
      * I :  Report Type USR
     I                                        1   1 P7QBST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2AJNB    PARM           WP0002  70       Customer Number
     C           P3EQNB    PARM           WP0003  70       USR From Date N
     C           P3OADT    PARM           WP0004  70       Thru Date
     C           P4AQTX    PARM           WP0005 30        AR Customer Nam
     C           P5GEAA    PARM           WP0006  3        USR Adjustment
     C           P5GFAA    PARM           WP0007  3        USR Adjustment
     C           P5GGAA    PARM           WP0008  3        USR Adjustment
     C           P5GHAA    PARM           WP0009  3        USR Adjustment
     C           P5GIAA    PARM           WP0010  3        USR Adjustment
     C           P5GJAA    PARM           WP0011  3        USR Adjustment
     C           P5GKAA    PARM           WP0012  3        USR Adjustment
     C           P5GLAA    PARM           WP0013  3        USR Adjustment
     C           P5GMAA    PARM           WP0014  3        USR Adjustment
     C           P5GNAA    PARM           WP0015  3        USR Adjustment
     C           P5B6C3    PARM           WP0016  30       USR Company Num
     C           P5B7C3    PARM           WP0017  30       USR Company Num
     C           P6CEST    PARM           WP0018  2        Invoice Suffix
     C           P6RCSX    PARM           WP0019  2        Invoice Suffix
     C           P6RDSX    PARM           WP0020  2        Invoice Suffix
     C           P6RESX    PARM           WP0021  2        Invoice Suffix
     C           P6RFSX    PARM           WP0022  2        Invoice Suffix
     C           P6OMST    PARM           WP0023  2        Invoice_Memo Su
     C           P7QBST    PARM           WP0024  1        Report Type USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Crt WF AR Ord-Name XF
      * RTV CRT WF AR Ord-Name RT - A/R Detail  * 
     C                     EXSR SARVGN
      * ***** Changes and comments
     C                     EXSR UASUBR                     ***** Changes a
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV CRT WF AR Ord-Name RT - A/R Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0002  70       AR Customer Num
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WADVDT           Payment/Deposit
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP3EQNB    WADVDT           Payment/Deposit
      * Establish starting position
     C           KPSSA     SETLL@BECPME                    *
     C                     READ @BECPME                  90*
      * Data record not found
     C   90                MOVEL'USR0178' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Select date range
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Payment/Deposit Date GT PAR.Thru Date
      *   |- c2    : DB1.Payment/Deposit Date LT PAR.USR From Date Numeri
      *   '-
     C           WADVDT    IFGT P3OADT                     *IF
     C           WADVDT    ORLT P3EQNB                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Select matching company number(s)                     E009707
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'C'       WUA6T1           First Letter 1
      * Select one company                                    E009707
      * CASE: Test for One Company
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Report Type USR EQ WRK.First Letter 1 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           P7QBST    IFEQ WUA6T1                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0001           *Record selecte
      * Select company number
      * CASE:
      *  - (c1 AND c2)
      *   |- c1    : PAR.Company Number is not equal to zero
      *   |- c2    : PAR.Company Number EQ DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AIC3    IFNE 0                          *IF
     C           P1AIC3    IFEQ WAAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0001           *Record selecte
     C                     END                             *FI
      * set *record selected
      * CASE: LCL.*Record selected is *YES
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'M'       WUA6T1           First Letter 1
      * Select if Multiple Companies was selected             E009707
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Report Type USR EQ WRK.First Letter 1 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           P7QBST    IFEQ WUA6T1                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0001           *Record selecte
      * Select company number
      * CASE:
      *  - (c1 AND c2)
      *   |- c1    : PAR.Company Number is not equal to zero
      *   |- c2    : PAR.Company Number EQ DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AIC3    IFNE 0                          *IF
     C           P1AIC3    IFEQ WAAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0001           *Record selecte
     C                     END                             *FI
      * Select company number 2
      * CASE:
      *  - (c1 AND c2 AND c3)
      *   |- c1    : PAR.USR Company Number 2 is not equal to zero
      *   |- c2    : PAR.USR Company Number 2 EQ DB1.Company Number
      *   |- c3    : LCL.*Record selected is *NO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5B6C3    IFNE 0                          *IF
     C           P5B6C3    IFEQ WAAIC3                     *IF
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0001           *Record selecte
     C                     END                             *FI
      * Select company number 3
      * CASE:
      *  - (c1 AND c2 AND c3)
      *   |- c1    : PAR.USR Company Number 3 is not equal to zero
      *   |- c2    : PAR.USR Company Number 3 EQ DB1.Company Number
      *   |- c3    : LCL.*Record selected is *NO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5B7C3    IFNE 0                          *IF
     C           P5B7C3    IFEQ WAAIC3                     *IF
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0001           *Record selecte
     C                     END                             *FI
      * set *record selected
      * CASE: LCL.*Record selected is *YES
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'A'       WUA6T1           First Letter 1
      * Select all company numbers                            E009707
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PGM.*Record selected is *YES
      *   |- c2    : PAR.Report Type USR EQ WRK.First Letter 1 USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           W0RSL     IFEQ 'Y'                        *IF
     C           P7QBST    IFEQ WUA6T1                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       YL0001           *Record selecte
      * Select if all company parms are zeros (select all)
      * CASE:
      *  - c1 AND c3 AND c4 AND c5
      *   |- c1    : PAR.Company Number is Equal to zero
      *   |- c3    : PAR.USR Company Number 2 is Equal to zero
      *   |- c4    : PAR.USR Company Number 3 is Equal to zero
      *   |- c5    : LCL.*Record selected is *NO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1AIC3    IFEQ 0                          *IF
     C           P5B6C3    IFEQ 0                          *IF
     C           P5B7C3    IFEQ 0                          *IF
     C           YL0001    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0001           *Record selecte
     C                     END                             *FI
      * set *record selected
      * CASE: LCL.*Record selected is *YES
     C           YL0001    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Select by Invoice Suffix if entered                   E009707
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0002           Record Selected
      * Select if no Suffix passed in - all selected
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5 AND c6
      *   |- c1    : PAR.Invoice Suffix is Blank
      *   |- c2    : PAR.Invoice Suffix 2 is Blank
      *   |- c3    : PAR.Invoice Suffix 3 is Blank
      *   |- c4    : PAR.Invoice Suffix 4 is Blank
      *   |- c5    : PAR.Invoice Suffix 5 is Blank
      *   |- c6    : PAR.Invoice/Memo Suffix is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6CEST    IFEQ *BLANK                     *IF
     C           P6RCSX    IFEQ *BLANK                     *IF
     C           P6RDSX    IFEQ *BLANK                     *IF
     C           P6RESX    IFEQ *BLANK                     *IF
     C           P6RFSX    IFEQ *BLANK                     *IF
     C           P6OMST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Only select if Inv Suffix is an allowed value
      * CASE: DB1.Invoice Suffix is CB,CM,DM,IN,OA,RB,Blank
     C           WACEST    IFEQ 'CB'                       *IF
     C           WACEST    OREQ 'CM'
     C           WACEST    OREQ 'DM'
     C           WACEST    OREQ 'IN'
     C           WACEST    OREQ 'OA'
     C           WACEST    OREQ 'RB'
     C           WACEST    OREQ *BLANK
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * Select if Suffix is allowed value and matches passed in
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Invoice Suffix is CB,CM,DM,IN,OA,RB,Blank
      *   |- c2    : LCL.Record Selected       USR is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WACEST    IFEQ 'CB'                       *IF
     C           WACEST    OREQ 'CM'
     C           WACEST    OREQ 'DM'
     C           WACEST    OREQ 'IN'
     C           WACEST    OREQ 'OA'
     C           WACEST    OREQ 'RB'
     C           WACEST    OREQ *BLANK
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Select Invoice Suffix
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Invoice Suffix EQ DB1.Invoice Suffix
      *   |- c2    : LCL.Record Selected       USR is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6CEST    IFEQ WACEST                     *IF
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * Select Invoice Suffix 2
      * CASE:
      *  - c2 AND c3
      *   |- c2    : PAR.Invoice Suffix 2 EQ DB1.Invoice Suffix
      *   |- c3    : LCL.Record Selected       USR is no
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P6RCSX    IFEQ WACEST                     *IF
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * Select Invoice Suffix 3
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Selected       USR is no
      *   |- c2    : PAR.Invoice Suffix 3 EQ DB1.Invoice Suffix
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'N'                        *IF
     C           P6RDSX    IFEQ WACEST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * Select Invoice Suffix 4
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Selected       USR is no
      *   |- c2    : PAR.Invoice Suffix 4 EQ DB1.Invoice Suffix
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'N'                        *IF
     C           P6RESX    IFEQ WACEST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * Select Invoice Suffix 5
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Selected       USR is no
      *   |- c2    : PAR.Invoice Suffix 5 EQ DB1.Invoice Suffix
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'N'                        *IF
     C           P6RFSX    IFEQ WACEST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * Select Invoice/Memo Suffix
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Record Selected       USR is no
      *   |- c2    : PAR.Invoice/Memo Suffix EQ DB1.Invoice Suffix
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'N'                        *IF
     C           P6OMST    IFEQ WACEST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * set *record selected flag
      * CASE: LCL.Record Selected       USR is yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select by A/R Customer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Customer Number       NBR is not equal 0
      *   |- c2    : PGM.*Record selected is *YES
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P2AJNB    IFNE 0                          *IF
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** rtv customer number for invoice being processed
      * VAL A/R Cust by Inv#   RT - A/R Header  * 
     C                     EXSR SBRVGN
      * ** skip this record if invoice isn't for passed in customer
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Select by Adjustment Type if entered                  E009707
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0002           Record Selected
      * If not yet selected, test db1 vs. par adj types
      * CASE: LCL.Record Selected       USR is no
     C           YL0002    IFEQ 'N'                        *IF
      * ** Only select matching Adj Type 1
      * CASE: PAR.USR Adjustment Type 1 EQ DB1.Adjustment Type Code
     C           P5GEAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 2
      * CASE: PAR.USR Adjustment Type 2 EQ DB1.Adjustment Type Code
     C           P5GFAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 3
      * CASE: PAR.USR Adjustment Type 3 EQ DB1.Adjustment Type Code
     C           P5GGAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 4
      * CASE: PAR.USR Adjustment Type 4 EQ DB1.Adjustment Type Code
     C           P5GHAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 5
      * CASE: PAR.USR Adjustment Type 5 EQ DB1.Adjustment Type Code
     C           P5GIAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 6
      * CASE: PAR.USR Adjustment Type 6 EQ DB1.Adjustment Type Code
     C           P5GJAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 7
      * CASE: PAR.USR Adjustment Type 7 EQ DB1.Adjustment Type Code
     C           P5GKAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 8
      * CASE: PAR.USR Adjustment Type 8 EQ DB1.Adjustment Type Code
     C           P5GLAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 9
      * CASE: PAR.USR Adjustment Type 9 EQ DB1.Adjustment Type Code
     C           P5GMAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * ** Only select matching Adj Type 10
      * CASE: PAR.USR Adjustment Type 10 EQ DB1.Adjustment Type Code
     C           P5GNAA    IFEQ WAUHCD                     *IF
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
     C                     END                             *FI
      * If all Adj Types are blanks, test against retrieved values
      * CASE:
      *  - c1 AND (c2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10ANDc11)
      *   |- c1    : LCL.Record Selected       USR is no
      *   |- c2    : PAR.USR Adjustment Type 1 is Not Entered
      *   |- c3    : PAR.USR Adjustment Type 2 is Not Entered
      *   |- c4    : PAR.USR Adjustment Type 3 is Not Entered
      *   |- c5    : PAR.USR Adjustment Type 4 is Not Entered
      *   |- c6    : PAR.USR Adjustment Type 5 is Not Entered
      *   |- c7    : PAR.USR Adjustment Type 6 is Not Entered
      *   |- c8    : PAR.USR Adjustment Type 7 is Not Entered
      *   |- c9    : PAR.USR Adjustment Type 8 is Not Entered
      *   |- c10   : PAR.USR Adjustment Type 9 is Not Entered
      *   |- c11   : PAR.USR Adjustment Type 10 is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'N'                        *IF
     C           P5GEAA    IFEQ *BLANK                     *IF
     C           P5GFAA    IFEQ *BLANK                     *IF
     C           P5GGAA    IFEQ *BLANK                     *IF
     C           P5GHAA    IFEQ *BLANK                     *IF
     C           P5GIAA    IFEQ *BLANK                     *IF
     C           P5GJAA    IFEQ *BLANK                     *IF
     C           P5GKAA    IFEQ *BLANK                     *IF
     C           P5GLAA    IFEQ *BLANK                     *IF
     C           P5GMAA    IFEQ *BLANK                     *IF
     C           P5GNAA    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV A/R Adjust Types   IF
      * RTV A/R Adjust Types  RT - A/R Adjustment Type  * 
     C                     EXSR SCRVGN
      * CASE:
      *  - c1OR c2OR c3OR c4OR c5OR c6OR c7OR c8OR c9OR c10
      *   |- c1    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c2    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c3    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c4    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c5    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c6    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c7    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c8    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c9    : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   |- c10   : DB1.Adjustment Type Code EQ LCL.USR Adjustment Type
      *   '-
     C           WAUHCD    IFEQ YL0003                     *IF
     C           WAUHCD    OREQ YL0004                     *OR
     C           WAUHCD    OREQ YL0005                     *OR
     C           WAUHCD    OREQ YL0006                     *OR
     C           WAUHCD    OREQ YL0007                     *OR
     C           WAUHCD    OREQ YL0008                     *OR
     C           WAUHCD    OREQ YL0009                     *OR
     C           WAUHCD    OREQ YL0010                     *OR
     C           WAUHCD    OREQ YL0011                     *OR
     C           WAUHCD    OREQ YL0012                     *OR
     C                     END                             *FI
     C                     MOVEL'Y'       YL0002           Record Selected
     C                     END                             *FI
      * set *record selected
      * CASE: LCL.Record Selected       USR is yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Populate work file if record is selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * ** Retrieve A/R Customer and Ship To Customer Numbers for invoice
      * RTV A/R Hdr by Co,Inv# RT - A/R Header  * 
     C                     EXSR SDRVGN
      * ** Retrieve A/R Customer name and Parent Number
      * RTV Cust by A/R-ShTo   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUANC7    WL0001           Ship To Custome
     C                     Z-ADDWUANC7    WL0009           AR Customer Num
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0015    P      Customer Name
     C                     MOVELWL0003    YL0016    P      Address Line 1
     C                     MOVELWL0004    YL0017    P      Address Line 2
     C                     MOVELWL0005    YL0018    P      Address Line 3
     C                     MOVELWL0006    YL0019    P      City
     C                     MOVELWL0007    YL0020    P      State Code
     C                     MOVELWL0008    YL0021    P      Zip Postal Code
     C                     Z-ADDWL0010    WUBTC7           Parent Customer
     C                     Z-ADDWL0011    YL0022           AR Credit Limit
     C                     MOVELWL0012    YL0023    P      Ship To Custome
      * ** Retrieve Ship To Customer name for A/R Customer
      * RTV Cust by A/R-ShTo   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUBKC7    WL0001           Ship To Custome
     C                     Z-ADDWUANC7    WL0009           AR Customer Num
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0024    P      Customer Name
     C                     MOVELWL0003    YL0016    P      Address Line 1
     C                     MOVELWL0004    YL0017    P      Address Line 2
     C                     MOVELWL0005    YL0018    P      Address Line 3
     C                     MOVELWL0006    YL0019    P      City
     C                     MOVELWL0007    YL0020    P      State Code
     C                     MOVELWL0008    YL0021    P      Zip Postal Code
     C                     Z-ADDWL0010    YN0023           Parent Customer
     C                     Z-ADDWL0011    YL0022           AR Credit Limit
     C                     MOVELWL0012    YL0023    P      Ship To Custome
      * * If ship to customer number is zeros, blank out the name  E09707
      * CASE: WRK.Ship To Customer is equal to zero
     C           WUBKC7    IFEQ 0                          *IF
     C                     MOVEL*BLANK    YL0024           Customer Name
     C                     END                             *FI
      * ** Retrieve Parent Customer name                      E009707
      * RTV Cust by A/R-ShTo   RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWUCHC7    WL0001           Ship To Custome
     C                     Z-ADDWUCHC7    WL0009           AR Customer Num
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WUOVT1    P      Customer Name
     C                     MOVELWL0003    YL0016    P      Address Line 1
     C                     MOVELWL0004    YL0017    P      Address Line 2
     C                     MOVELWL0005    YL0018    P      Address Line 3
     C                     MOVELWL0006    YL0019    P      City
     C                     MOVELWL0007    YL0020    P      State Code
     C                     MOVELWL0008    YL0021    P      Zip Postal Code
     C                     Z-ADDWL0010    YL0025           Parent Customer
     C                     Z-ADDWL0011    YL0022           AR Credit Limit
     C                     MOVELWL0012    YL0023    P      Ship To Custome
      * ** Write record to the work file                      E009707
      * CRT A/R Orders by Name CR - WF A/R Orders by Name  * 
     C                     EXSR SFCRRC
     C                     END                             *FI
     C                     READ @BECPME                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * VAL A/R Cust by Inv#   RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBANC7    WQSB01           AR Customer Num
     C           *LIKE     DEFN WBCONB    WQSB02           Invoice Number
     C           *LIKE     DEFN WBCEST    WQSB03           Invoice Suffix
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           AR Customer Num
     C                     KFLD           WQSB02           Invoice Number
     C                     KFLD           WQSB03           Invoice Suffix
      * Setup key
     C                     Z-ADDP2AJNB    WQSB01           AR Customer Num
     C                     Z-ADDWACONB    WQSB02           Invoice Number
     C                     MOVELWACEST    WQSB03           Invoice Suffix
      * Establish starting position
     C           KRSSB     SETLL@BDCPAO                    *
     C           KRSSB     READE@BDCPAO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C           KRSSB     READE@BDCPAO                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV A/R Adjust Types  RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WCUHCD           Adjustment Type
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSC01           Company Number
     C                     MOVELYL0013    WCUHCD           Adjustment Type
      * Establish starting position
     C           KPSSC     SETLL@J3CPCZ                    *
     C           KRSSC     READE@J3CPCZ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2041' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If Adj Type is any of the allowed values, put in PAR
      * CASE:
      *  - c1OR c2OR c3OR c4OR c5OR c6OR c7OR c8OR c9OR c10
      *   |- c1    : DB1.Adjustment Type Code is Chargeback
      *   |- c2    : DB1.Adjustment Type Code is Inter Company
      *   |- c3    : DB1.Adjustment Type Code is OA On Account Cash
      *   |- c4    : DB1.Adjustment Type Code is Regular Pay
      *   |- c5    : DB1.Adjustment Type Code is Rebill
      *   |- c6    : DB1.Adjustment Type Code is Write Off Under $150
      *   |- c7    : DB1.Adjustment Type Code is W/O $150 and above
      *   |- c8    : DB1.Adjustment Type Code is WalMart Cash Discount
      *   |- c9    : DB1.Adjustment Type Code is Walmart Warehouse Allowa
      *   |- c10   : DB1.Adjustment Type Code is Offsite Warehouse
      *   '-
     C           WCUHCD    IFEQ 'CB'                       *IF
     C           WCUHCD    OREQ 'ITC'                      *OR
     C           WCUHCD    OREQ 'OA'                       *OR
     C           WCUHCD    OREQ 'PAY'                      *OR
     C           WCUHCD    OREQ 'RB'                       *OR
     C           WCUHCD    OREQ 'WO'                       *OR
     C           WCUHCD    OREQ 'WO1'                      *OR
     C           WCUHCD    OREQ 'WO2'                      *OR
     C           WCUHCD    OREQ 'WO3'                      *OR
     C           WCUHCD    OREQ 'WO4'                      *OR
      * CASE: PAR.USR Adjustment Type 1 is Not Entered
     C           YL0003    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0003           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 2 is Not Entered
     C           YL0004    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0004           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 3 is Not Entered
     C           YL0005    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0005           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 4 is Not Entered
     C           YL0006    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0006           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 5 is Not Entered
     C           YL0007    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0007           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 6 is Not Entered
     C           YL0008    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0008           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 7 is Not Entered
     C           YL0009    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0009           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 8 is Not Entered
     C           YL0010    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0010           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 9 is Not Entered
     C           YL0011    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0011           USR Adjustment
     C                     ELSE
      * CASE: PAR.USR Adjustment Type 10 is Not Entered
     C           YL0012    IFEQ *BLANK                     *IF
     C                     MOVELWCUHCD    YL0012           USR Adjustment
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@J3CPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV A/R Hdr by Co,Inv# RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWAAIC3    WDAIC3           Company Number
     C                     Z-ADDWACONB    WDCONB           Invoice Number
     C                     MOVELWACEST    WDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSD     CHAIN@BDCPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0014           Order Number Re
     C                     Z-ADD*ZERO     WUBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WUANC7           AR Customer Num
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDCAC7    YL0014           Order Number Re
     C                     Z-ADDWDBKC7    WUBKC7           Ship To Custome
     C                     Z-ADDWDANC7    WUANC7           AR Customer Num
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Cust by A/R-ShTo   RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEANC7    WQSE01           AR Customer Num
     C           *LIKE     DEFN WEBKC7    WQSE02           Ship To Custome
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           AR Customer Num
     C                     KFLD           WQSE02           Ship To Custome
      * Setup key
     C                     Z-ADDWL0009    WQSE01           AR Customer Num
     C                     Z-ADDWL0001    WQSE02           Ship To Custome
      * Establish starting position
     C           KRSSE     SETLL@BBREC1                    *
     C           KRSSE     READE@BBREC1                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAYTX    WL0002           Customer Name
     C                     MOVELWEACNA    WL0003           Address Line 1
     C                     MOVELWEADNA    WL0004           Address Line 2
     C                     MOVELWEAENA    WL0005           Address Line 3
     C                     MOVELWEAJNA    WL0006           City
     C                     MOVELWEBGCD    WL0007           State Code
     C                     MOVELWEBTTX    WL0008           Zip Postal Code
     C                     Z-ADDWEBTC7    WL0010           Parent Customer
     C                     Z-ADDWEVHVA    WL0011           AR Credit Limit
     C                     MOVELWERJST    WL0012           Ship To Custome
     C           KRSSE     READE@BBREC1                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT A/R Orders by Name CR - WF A/R Orders by Name  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @K5RELK
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     MOVELYL0015    WFAQTX           AR Customer Nam
     C                     Z-ADDWUANC7    WFANC7           AR Customer Num
     C                     Z-ADDWADVDT    WFDVDT           Payment/Deposit
     C                     Z-ADDWACONB    WFCONB           Invoice Number
     C                     MOVELWACEST    WFCEST           Invoice Suffix
     C                     Z-ADDWADXNB    WFDXNB           Sequence Number
     C                     Z-ADDWAB4DT    WFAWDT           Invoice Date
     C                     Z-ADDYL0014    WFCAC7           Order Number Re
     C                     Z-ADD*ZERO     WFA1VA           Invoice Amount
     C                     Z-ADDWABSVA    WFBSVA           Transaction Amo
     C                     MOVELWACPTX    WFCPTX           A/R Check Numbe
     C                     MOVELWAUHCD    WFUHCD           Adjustment Type
     C                     MOVELWANGNA    WFNGNA           Explanation
     C                     Z-ADDWAB4DT    WFB4DT           Transaction Dat
     C                     MOVELWAA5ST    WFA5ST           Cash/Adj
     C                     Z-ADDWACKNB    WFCKNB           GL Document Num
     C                     Z-ADDWUBKC7    WFJMNY           CUSTOMER NUMBER
     C                     MOVELYL0024    WFAYTX           Customer Name
     C                     Z-ADDWUBTC7    WFCHC7           Parent Number
     C                     MOVELWUOVT1    WFOVT1           Parent Name
      *
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFAQTX           AR Customer Nam
     C                     KFLD           WFANC7           AR Customer Num
     C                     KFLD           WFDVDT           Payment/Deposit
     C                     KFLD           WFCONB           Invoice Number
     C                     KFLD           WFCEST           Invoice Suffix
     C                     KFLD           WFDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSF    SETLL@K5RELK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2391' W0RTN   7
      * Send message 'WF A/R Orders by Name  EX'
     C                     MOVEL'USR2391' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@K5RELK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Changes and comments
      *================================================================
      * ** A/R Customer name is not being passed. It is retrieved in this
      * **   program and written out to the work file
      * Cus Nbr passed in (103904 3000046)
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WACONB           Invoice Number
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WABSVA           Transaction Amo
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WADVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WAYXNX           Deposit Time
     C                     Z-ADD*ZERO     WAHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WACKNB           GL Document Num
     C                     Z-ADD*ZERO     WAC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WAQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WAQIDT           A/R Orig Inv fo
     C                     Z-ADD*ZERO     WAQJDT           A/R Invoice Num
     C                     Z-ADD*ZERO     WAQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WAQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WAGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WAGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WAGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WAGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WAGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field First Letter 1 USR
     C                     MOVEL*BLANK    WUA6T1  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WBAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WBAOVA           Amount Paid
     C                     Z-ADD*ZERO     WBBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WBCKNB           GL Document Num
     C                     Z-ADD*ZERO     WBCAC7           Order Number Re
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBATDT           Due Date
     C                     Z-ADD*ZERO     WBH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WBH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WBH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WBH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WBANC7           AR Customer Num
     C                     Z-ADD*ZERO     WBBSDY           Days to Pay
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCUKVA           Adjustment Limi
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Ship To Customer
     C                     Z-ADD*ZERO     WUBKC7  70
      * Define work field AR Customer Number
     C                     Z-ADD*ZERO     WUANC7  70
      * Define work field Parent Customer
     C                     Z-ADD*ZERO     WUBTC7  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D & B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           AR Customer Num
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           AR Credit Limit
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Parent Number
     C                     Z-ADD*ZERO     WUCHC7  70
      * Define work field Parent Name
     C                     MOVEL*BLANK    WUOVT1 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFANC7           AR Customer Num
     C                     Z-ADD*ZERO     WFDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFAWDT           Invoice Date
     C                     Z-ADD*ZERO     WFCAC7           Order Number Re
     C                     Z-ADD*ZERO     WFA1VA           Invoice Amount
     C                     Z-ADD*ZERO     WFBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WFB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WFCKNB           GL Document Num
     C                     Z-ADD*ZERO     WFJMNY           CUSTOMER NUMBER
     C                     Z-ADD*ZERO     WFCHC7           Parent Number
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 20
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008 11
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011 112
     C                     MOVEL*BLANK    WL0012  1
      * Define local work field *Record selected
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Record Selected       USR
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field USR Adjustment Type 1
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field USR Adjustment Type 2
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field USR Adjustment Type 3
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field USR Adjustment Type 4
     C                     MOVEL*BLANK    YL0006  3
      * Define local work field USR Adjustment Type 5
     C                     MOVEL*BLANK    YL0007  3
      * Define local work field USR Adjustment Type 6
     C                     MOVEL*BLANK    YL0008  3
      * Define local work field USR Adjustment Type 7
     C                     MOVEL*BLANK    YL0009  3
      * Define local work field USR Adjustment Type 8
     C                     MOVEL*BLANK    YL0010  3
      * Define local work field USR Adjustment Type 9
     C                     MOVEL*BLANK    YL0011  3
      * Define local work field USR Adjustment Type 10
     C                     MOVEL*BLANK    YL0012  3
      * Define local work field Text 1 Length USR
     C                     MOVEL*BLANK    YL0013  1
      * Define null work field Adjustment Type Code
     C                     MOVEL*BLANK    YN0001  3
      * Define null work field Transaction Amount
     C                     Z-ADD*ZERO     YN0002 112
      * Define null work field Adjustment Amount
     C                     Z-ADD*ZERO     YN0003 112
      * Define null work field Amount Paid
     C                     Z-ADD*ZERO     YN0004 112
      * Define null work field Remaining Balance Due
     C                     Z-ADD*ZERO     YN0005 112
      * Define null work field A/R Processing Status
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Purge Status
     C                     MOVEL*BLANK    YN0007  1
      * Define null work field Bank Code
     C                     MOVEL*BLANK    YN0008  6
      * Define null work field GL Document Number
     C                     Z-ADD*ZERO     YN0009  80
      * Define local work field Order Number Ref
     C                     Z-ADD*ZERO     YL0014  70
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0010  3
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0011  3
      * Define null work field Transaction Date Code
     C                     Z-ADD*ZERO     YN0012  70
      * Define null work field Due Date
     C                     Z-ADD*ZERO     YN0013  70
      * Define null work field Last Payment Date
     C                     Z-ADD*ZERO     YN0014  70
      * Define null work field Original Inv for CB
     C                     Z-ADD*ZERO     YN0015  70
      * Define null work field Paid in Full Date
     C                     Z-ADD*ZERO     YN0016  70
      * Define null work field Last G/L Post Date
     C                     Z-ADD*ZERO     YN0017  70
      * Define null work field A/R Check Number
     C                     MOVEL*BLANK    YN0018 10
      * Define null work field Days to Pay
     C                     Z-ADD*ZERO     YN0019  50
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0020  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0021  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0022  1
      * Define local work field AR Customer Name
     C                     MOVEL*BLANK    YL0015 30
      * Define local work field Address Line 1
     C                     MOVEL*BLANK    YL0016 30
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0017 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0018 30
      * Define local work field City
     C                     MOVEL*BLANK    YL0019 20
      * Define local work field State Code
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field Zip Postal Code
     C                     MOVEL*BLANK    YL0021 11
      * Define local work field AR Credit Limit
     C                     Z-ADD*ZERO     YL0022 112
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Customer Name
     C                     MOVEL*BLANK    YL0024 30
      * Define null work field Parent Customer
     C                     Z-ADD*ZERO     YN0023  70
      * Define local work field Parent Customer
     C                     Z-ADD*ZERO     YL0025  70
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
