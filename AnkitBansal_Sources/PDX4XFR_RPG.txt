     H/TITLE CHG Deposit Listing    XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 02/23/10  Time  : 13:29:00
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDJ2CPL3IF  E           K        DISK
      * RSQ : A/R Bank Deposit          bank/dep active only
      *
     FARBECPL4IF  E           K        DISK
      * RSQ : A/R Detail                Bank/Date/Time      N
      *
     FCAEBREL3IF  E           K        DISK
      * RTV : Bank Master               Retrieval Active Only
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FPDJ3CPL1IF  E           K        DISK
      * RTV : A/R Adjustment Type       Retrieval index
      *
     FPPA4CPL2IF  E           K        DISK
      * RSQ : A/R Header OA             Bank/DepositDt/DepositTm
      *
     FPDJ3CPL2IF  E           K        DISK
      * RSQ : A/R Adjustment Type       Co/Type Active Records
      *
     FARBECPL1IF  E           K        DISK
      * RTV : A/R Detail                Retrieval index       V
      *
     FARBKCPL1IF  E           K        DISK
      * RTV : A/R Non A/R Cash          Retrieval index       NV
      *
     FCAASREL3IF  E           K        DISK
      * RTV : Company Control           Retrieval Active Only
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCAADREL9IF  E           K        DISK
      * RSQ : Warehouse                 ShipCo/Warehouse
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPDJ5CPL0IF  E           K        DISK                      A
      * UPD : A/R Posting and Reporting Update index
      *
     FARBECPL0UF  E           K        DISK
      * UPD : A/R Detail                Update index
      *
     FARBDCPL0UF  E           K        DISK
      * UPD : A/R Header                Update index
      *
     FARBKCPL0UF  E           K        DISK
      * UPD : A/R Non A/R Cash          Update index
      *
     FPDJ2CPL0UF  E           K        DISK
      * UPD : A/R Bank Deposit          Update index
      *
     E                    UCT        40  1               CENTER TABLE
     I@J2CPCU
      * A/R Bank Deposit          bank/dep active only
      * Renamed input format fields
     I              J2G4CD                          WAG4CD
     I              J2HXDT                          WAHXDT
     I              J2YXNX                          WAYXNX
     I              J2UIVA                          WAUIVA
     I              J2UJVA                          WAUJVA
     I              J2AJST                          WAAJST
     I              J2CKNB                          WACKNB
     I              J2BHNB                          WABHNB
     I              J2BINB                          WABINB
     I              J2E2VL                          WAE2VL
     I              J2E3VL                          WAE3VL
     I              J2E4VL                          WAE4VL
     I              J2E5VL                          WAE5VL
     I              J2E6VL                          WAE6VL
     I              J2E7VL                          WAE7VL
     I              J2E8VL                          WAE8VL
     I              J2E9VL                          WAE9VL
     I              J2FAVL                          WAFAVL
     I              J2FBVL                          WAFBVL
     I              J2FCVL                          WAFCVL
     I              J2FDVL                          WAFDVL
     I              J2HYDT                          WAHYDT
     I              J2UVST                          WAUVST
     I              J2UWST                          WAUWST
     I              J2UXST                          WAUXST
     I              J2VSST                          WAVSST
     I              J2AATM                          WAAATM
     I              J2AYNA                          WAAYNA
     I              J2A0NA                          WAA0NA
     I              J2AXDT                          WAAXDT
      *
     I@BECPYW
      * A/R Detail                Bank/Date/Time      N
      * Renamed input format fields
     I              BFAIC3                          WBAIC3
     I              BFCONB                          WBCONB
     I              BFCEST                          WBCEST
     I              BFDXNB                          WBDXNB
     I              BFUHCD                          WBUHCD
     I              BFBSVA                          WBBSVA
     I              BFCPTX                          WBCPTX
     I              BFNGNA                          WBNGNA
     I              BFB4DT                          WBB4DT
     I              BFDVDT                          WBDVDT
     I              BFYXNX                          WBYXNX
     I              BFHYDT                          WBHYDT
     I              BFG4CD                          WBG4CD
     I              BFCKNB                          WBCKNB
     I              BFA5ST                          WBA5ST
     I              BFAJST                          WBAJST
     I              BFB1VN                          WBB1VN
     I              BFEAZT                          WBEAZT
     I              BFC1NY                          WBC1NY
     I              BFIZTX                          WBIZTX
     I              BFETSX                          WBETSX
     I              BFW3SX                          WBW3SX
     I              BFW4SX                          WBW4SX
     I              BFW5SX                          WBW5SX
     I              BFW6SX                          WBW6SX
     I              BFW7SX                          WBW7SX
     I              BFW8SX                          WBW8SX
     I              BFQHDT                          WBQHDT
     I              BFQIDT                          WBQIDT
     I              BFQJDT                          WBQJDT
     I              BFQKDT                          WBQKDT
     I              BFQLDT                          WBQLDT
     I              BFGLVL                          WBGLVL
     I              BFGMVL                          WBGMVL
     I              BFGNVL                          WBGNVL
     I              BFGOVL                          WBGOVL
     I              BFGPVL                          WBGPVL
     I              BFUVST                          WBUVST
     I              BFUWST                          WBUWST
     I              BFUXST                          WBUXST
     I              BFAATM                          WBAATM
     I              BFAYNA                          WBAYNA
     I              BFA0NA                          WBA0NA
     I              BFAXDT                          WBAXDT
      *
     I@EBREVK
      * Bank Master               Retrieval Active Only
      * Renamed input format fields
     I              EBG4CD                          WCG4CD
     I              EBAUNA                          WCAUNA
     I              EBIVTX                          WCIVTX
     I              EBD4C7                          WCD4C7
     I              EBD5C7                          WCD5C7
     I              EBJOSX                          WCJOSX
     I              EBUVST                          WCUVST
     I              EBUWST                          WCUWST
     I              EBUXST                          WCUXST
     I              EBVSST                          WCVSST
     I              EBAATM                          WCAATM
     I              EBAYNA                          WCAYNA
     I              EBA0NA                          WCA0NA
     I              EBAXDT                          WCAXDT
      *
     I@BDCPF7
      * A/R Header                Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                          WDAIC3
     I              BDCONB                          WDCONB
     I              BDCEST                          WDCEST
     I              BDUHCD                          WDUHCD
     I              BDBSVA                          WDBSVA
     I              BDAIVA                          WDAIVA
     I              BDAOVA                          WDAOVA
     I              BDBGVA                          WDBGVA
     I              BDAJST                          WDAJST
     I              BDE3ST                          WDE3ST
     I              BDG4CD                          WDG4CD
     I              BDCKNB                          WDCKNB
     I              BDCAC7                          WDCAC7
     I              BDBKC7                          WDBKC7
     I              BDBCCD                          WDBCCD
     I              BDR4CD                          WDR4CD
     I              BDB4DT                          WDB4DT
     I              BDATDT                          WDATDT
     I              BDH0DT                          WDH0DT
     I              BDH3DT                          WDH3DT
     I              BDH4DT                          WDH4DT
     I              BDH5DT                          WDH5DT
     I              BDANC7                          WDANC7
     I              BDCPTX                          WDCPTX
     I              BDBSDY                          WDBSDY
     I              BDUVST                          WDUVST
     I              BDUWST                          WDUWST
     I              BDUXST                          WDUXST
     I              BDAATM                          WDAATM
     I              BDAYNA                          WDAYNA
     I              BDA0NA                          WDA0NA
     I              BDAXDT                          WDAXDT
      *
     I@J3CPCQ
      * A/R Adjustment Type       Retrieval index
      * Renamed input format fields
     I              J3AIC3                          WEAIC3
     I              J3UHCD                          WEUHCD
     I              J3NFNA                          WENFNA
     I              J3EAZT                          WEEAZT
     I              J3IZTX                          WEIZTX
     I              J3UKVA                          WEUKVA
     I              J3A5ST                          WEA5ST
     I              J3GLTS                          WEGLTS
     I              J3SYSC                          WESYSC
     I              J3UVST                          WEUVST
     I              J3UWST                          WEUWST
     I              J3UXST                          WEUXST
     I              J3VSST                          WEVSST
     I              J3AATM                          WEAATM
     I              J3AYNA                          WEAYNA
     I              J3A0NA                          WEA0NA
     I              J3AXDT                          WEAXDT
      *
     I@J5CPDL
      * A/R Posting and Reporting Update index
      * Renamed input format fields
     I              J5AIC3                          WFAIC3
     I              J5G4CD                          WFG4CD
     I              J5HXDT                          WFHXDT
     I              J5ANC7                          WFANC7
     I              J5CONB                          WFCONB
     I              J5CEST                          WFCEST
     I              J5DXNB                          WFDXNB
     I              J5UHCD                          WFUHCD
     I              J5BSVA                          WFBSVA
     I              J5CPTX                          WFCPTX
     I              J5C1NY                          WFC1NY
     I              J5IZTX                          WFIZTX
     I              J5H0DT                          WFH0DT
     I              J5ATDT                          WFATDT
     I              J5C4NB                          WFC4NB
     I              J5ABST                          WFABST
     I              J5NGNA                          WFNGNA
     I              J5UJCD                          WFUJCD
     I              J5AJST                          WFAJST
     I              J5ADST                          WFADST
     I              J5CKNB                          WFCKNB
     I              J5BCDT                          WFBCDT
     I              J5BGLC                          WFBGLC
     I              J5GLVL                          WFGLVL
     I              J5UVST                          WFUVST
     I              J5UWST                          WFUWST
     I              J5UXST                          WFUXST
     I              J5VSST                          WFVSST
     I              J5AATM                          WFAATM
     I              J5AYNA                          WFAYNA
     I              J5A0NA                          WFA0NA
     I              J5AXDT                          WFAXDT
      *
     I@BFCPFN
      * A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WGAIC3
     I              BFCONB                          WGCONB
     I              BFCEST                          WGCEST
     I              BFDXNB                          WGDXNB
     I              BFUHCD                          WGUHCD
     I              BFBSVA                          WGBSVA
     I              BFCPTX                          WGCPTX
     I              BFNGNA                          WGNGNA
     I              BFB4DT                          WGB4DT
     I              BFDVDT                          WGDVDT
     I              BFYXNX                          WGYXNX
     I              BFHYDT                          WGHYDT
     I              BFG4CD                          WGG4CD
     I              BFCKNB                          WGCKNB
     I              BFA5ST                          WGA5ST
     I              BFAJST                          WGAJST
     I              BFB1VN                          WGB1VN
     I              BFEAZT                          WGEAZT
     I              BFC1NY                          WGC1NY
     I              BFIZTX                          WGIZTX
     I              BFETSX                          WGETSX
     I              BFW3SX                          WGW3SX
     I              BFW4SX                          WGW4SX
     I              BFW5SX                          WGW5SX
     I              BFW6SX                          WGW6SX
     I              BFW7SX                          WGW7SX
     I              BFW8SX                          WGW8SX
     I              BFQHDT                          WGQHDT
     I              BFQIDT                          WGQIDT
     I              BFQJDT                          WGQJDT
     I              BFQKDT                          WGQKDT
     I              BFQLDT                          WGQLDT
     I              BFGLVL                          WGGLVL
     I              BFGMVL                          WGGMVL
     I              BFGNVL                          WGGNVL
     I              BFGOVL                          WGGOVL
     I              BFGPVL                          WGGPVL
     I              BFUVST                          WGUVST
     I              BFUWST                          WGUWST
     I              BFUXST                          WGUXST
     I              BFAATM                          WGAATM
     I              BFAYNA                          WGAYNA
     I              BFA0NA                          WGA0NA
     I              BFAXDT                          WGAXDT
      *
     I@A4CPYA
      * A/R Header OA             Bank/DepositDt/DepositTm
      * Renamed input format fields
     I              A4AIC3                          WHAIC3
     I              A4CONB                          WHCONB
     I              A4CEST                          WHCEST
     I              A4G4CD                          WHG4CD
     I              A4HXDT                          WHHXDT
     I              A4YXNX                          WHYXNX
     I              A4UTSX                          WHUTSX
      *
     I@J3CPCZ
      * A/R Adjustment Type       Co/Type Active Records
      * Renamed input format fields
     I              J3AIC3                          WIAIC3
     I              J3UHCD                          WIUHCD
     I              J3NFNA                          WINFNA
     I              J3EAZT                          WIEAZT
     I              J3IZTX                          WIIZTX
     I              J3UKVA                          WIUKVA
     I              J3A5ST                          WIA5ST
     I              J3GLTS                          WIGLTS
     I              J3SYSC                          WISYSC
     I              J3UVST                          WIUVST
     I              J3UWST                          WIUWST
     I              J3UXST                          WIUXST
     I              J3VSST                          WIVSST
     I              J3AATM                          WIAATM
     I              J3AYNA                          WIAYNA
     I              J3A0NA                          WIA0NA
     I              J3AXDT                          WIAXDT
      *
     I@BFCPFO
      * A/R Detail                Retrieval index       V
      * Renamed input format fields
     I              BFAIC3                          WJAIC3
     I              BFCONB                          WJCONB
     I              BFCEST                          WJCEST
     I              BFDXNB                          WJDXNB
     I              BFUHCD                          WJUHCD
     I              BFBSVA                          WJBSVA
     I              BFCPTX                          WJCPTX
     I              BFNGNA                          WJNGNA
     I              BFB4DT                          WJB4DT
     I              BFDVDT                          WJDVDT
     I              BFYXNX                          WJYXNX
     I              BFHYDT                          WJHYDT
     I              BFG4CD                          WJG4CD
     I              BFCKNB                          WJCKNB
     I              BFA5ST                          WJA5ST
     I              BFAJST                          WJAJST
     I              BFB1VN                          WJB1VN
     I              BFEAZT                          WJEAZT
     I              BFC1NY                          WJC1NY
     I              BFIZTX                          WJIZTX
     I              BFETSX                          WJETSX
     I              BFW3SX                          WJW3SX
     I              BFW4SX                          WJW4SX
     I              BFW5SX                          WJW5SX
     I              BFW6SX                          WJW6SX
     I              BFW7SX                          WJW7SX
     I              BFW8SX                          WJW8SX
     I              BFQHDT                          WJQHDT
     I              BFQIDT                          WJQIDT
     I              BFQJDT                          WJQJDT
     I              BFQKDT                          WJQKDT
     I              BFQLDT                          WJQLDT
     I              BFGLVL                          WJGLVL
     I              BFGMVL                          WJGMVL
     I              BFGNVL                          WJGNVL
     I              BFGOVL                          WJGOVL
     I              BFGPVL                          WJGPVL
     I              BFUVST                          WJUVST
     I              BFUWST                          WJUWST
     I              BFUXST                          WJUXST
     I              BFAATM                          WJAATM
     I              BFAYNA                          WJAYNA
     I              BFA0NA                          WJA0NA
     I              BFAXDT                          WJAXDT
      *
     I@BDCPFG
      * A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WKAIC3
     I              BDCONB                          WKCONB
     I              BDCEST                          WKCEST
     I              BDUHCD                          WKUHCD
     I              BDBSVA                          WKBSVA
     I              BDAIVA                          WKAIVA
     I              BDAOVA                          WKAOVA
     I              BDBGVA                          WKBGVA
     I              BDAJST                          WKAJST
     I              BDE3ST                          WKE3ST
     I              BDG4CD                          WKG4CD
     I              BDCKNB                          WKCKNB
     I              BDCAC7                          WKCAC7
     I              BDBKC7                          WKBKC7
     I              BDBCCD                          WKBCCD
     I              BDR4CD                          WKR4CD
     I              BDB4DT                          WKB4DT
     I              BDATDT                          WKATDT
     I              BDH0DT                          WKH0DT
     I              BDH3DT                          WKH3DT
     I              BDH4DT                          WKH4DT
     I              BDH5DT                          WKH5DT
     I              BDANC7                          WKANC7
     I              BDCPTX                          WKCPTX
     I              BDBSDY                          WKBSDY
     I              BDUVST                          WKUVST
     I              BDUWST                          WKUWST
     I              BDUXST                          WKUXST
     I              BDAATM                          WKAATM
     I              BDAYNA                          WKAYNA
     I              BDA0NA                          WKA0NA
     I              BDAXDT                          WKAXDT
      *
     I@BKCPGY
      * A/R Non A/R Cash          Retrieval index       NV
      * Renamed input format fields
     I              BKG4CD                          WLG4CD
     I              BKHXDT                          WLHXDT
     I              BKYXNX                          WLYXNX
     I              BKUJCD                          WLUJCD
     I              BKAIC3                          WLAIC3
     I              BKUHCD                          WLUHCD
     I              BKBSVA                          WLBSVA
     I              BKCPTX                          WLCPTX
     I              BKNGNA                          WLNGNA
     I              BKB4DT                          WLB4DT
     I              BKAJST                          WLAJST
     I              BKHYDT                          WLHYDT
     I              BKCKNB                          WLCKNB
     I              BKIZTX                          WLIZTX
     I              BKEAZT                          WLEAZT
     I              BKUVST                          WLUVST
     I              BKUWST                          WLUWST
     I              BKUXST                          WLUXST
     I              BKVSST                          WLVSST
     I              BKAATM                          WLAATM
     I              BKAYNA                          WLAYNA
     I              BKA0NA                          WLA0NA
     I              BKAXDT                          WLAXDT
      *
     I@ASREVL
      * Company Control           Retrieval Active Only
      * Renamed input format fields
     I              ASAIC3                          WMAIC3
     I              ASAXNB                          WMAXNB
     I              ASNGNB                          WMNGNB
     I              ASBZNB                          WMBZNB
     I              ASC5NB                          WMC5NB
     I              ASC3NB                          WMC3NB
     I              ASCYNB                          WMCYNB
     I              ASIONB                          WMIONB
     I              ASI6NB                          WMI6NB
     I              ASDCNB                          WMDCNB
     I              ASC7NB                          WMC7NB
     I              ASC2NB                          WMC2NB
     I              ASC1NB                          WMC1NB
     I              ASL8NB                          WML8NB
     I              ASBANB                          WMBANB
     I              ASCHST                          WMCHST
     I              ASCKST                          WMCKST
     I              ASCIST                          WMCIST
     I              ASCGST                          WMCGST
     I              ASAIPC                          WMAIPC
     I              ASASPC                          WMASPC
     I              ASA2VA                          WMA2VA
     I              ASC2ST                          WMC2ST
     I              ASD8ST                          WMD8ST
     I              ASD7ST                          WMD7ST
     I              ASA8NA                          WMA8NA
     I              ASA9NA                          WMA9NA
     I              ASBANA                          WMBANA
     I              ASBBNA                          WMBBNA
     I              ASEUST                          WMEUST
     I              ASAADY                          WMAADY
     I              ASABDY                          WMABDY
     I              ASACDY                          WMACDY
     I              ASADDY                          WMADDY
     I              ASAEDY                          WMAEDY
     I              ASAFDY                          WMAFDY
     I              ASAGDY                          WMAGDY
     I              ASAHDY                          WMAHDY
     I              ASAENB                          WMAENB
     I              ASALNB                          WMALNB
     I              ASEVNB                          WMEVNB
     I              ASRPOP                          WMRPOP
     I              ASDWNB                          WMDWNB
     I              ASR3NB                          WMR3NB
     I              ASPNST                          WMPNST
     I              ASR4NB                          WMR4NB
     I              ASPOST                          WMPOST
     I              ASSCNB                          WMSCNB
     I              ASVIST                          WMVIST
     I              ASVJST                          WMVJST
     I              ASBVVN                          WMBVVN
     I              ASUVST                          WMUVST
     I              ASUWST                          WMUWST
     I              ASUXST                          WMUXST
     I              ASVSST                          WMVSST
     I              ASAATM                          WMAATM
     I              ASAYNA                          WMAYNA
     I              ASA0NA                          WMA0NA
     I              ASAXDT                          WMAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WOAJVN
     I              DRAUNA                          WOAUNA
     I              DRB8NA                          WOB8NA
     I              DRAHVN                          WOAHVN
     I              DRI6ST                          WOI6ST
     I              DRI7ST                          WOI7ST
     I              DRXMST                          WOXMST
     I              DRXNST                          WOXNST
     I              DRI8ST                          WOI8ST
     I              DRNLNB                          WONLNB
     I              DRMPNA                          WOMPNA
     I              DRBCCD                          WOBCCD
     I              DRAIC3                          WOAIC3
     I              DRDQCD                          WODQCD
     I              DRDRCD                          WODRCD
     I              DRAJCD                          WOAJCD
     I              DRBUVN                          WOBUVN
     I              DRUVST                          WOUVST
     I              DRUWST                          WOUWST
     I              DRUXST                          WOUXST
     I              DRAATM                          WOAATM
     I              DRAYNA                          WOAYNA
     I              DRA0NA                          WOA0NA
     I              DRAXDT                          WOAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WRAJVN
     I              DTDNCD                          WRDNCD
     I              DTAIC3                          WRAIC3
     I              DTDQCD                          WRDQCD
     I              DTDRCD                          WRDRCD
     I              DTAJCD                          WRAJCD
     I              DTJFST                          WRJFST
     I              DTUVST                          WRUVST
     I              DTUWST                          WRUWST
     I              DTUXST                          WRUXST
     I              DTAATM                          WRAATM
     I              DTAYNA                          WRAYNA
     I              DTA0NA                          WRA0NA
     I              DTAXDT                          WRAXDT
      *
     I@ADREWA
      * Warehouse                 ShipCo/Warehouse
      * Renamed input format fields
     I              ADAJCD                          WSAJCD
     I              ADF8NA                          WSF8NA
     I              ADACNA                          WSACNA
     I              ADADNA                          WSADNA
     I              ADAENA                          WSAENA
     I              ADAJNA                          WSAJNA
     I              ADBTTX                          WSBTTX
     I              ADAOCD                          WSAOCD
     I              ADBGCD                          WSBGCD
     I              ADVHST                          WSVHST
     I              ADMPNA                          WSMPNA
     I              ADWPST                          WSWPST
     I              ADXUST                          WSXUST
     I              ADT0ST                          WST0ST
     I              ADT1ST                          WST1ST
     I              ADDBNB                          WSDBNB
     I              ADT2ST                          WST2ST
     I              ADT3ST                          WST3ST
     I              ADT4ST                          WST4ST
     I              ADT6ST                          WST6ST
     I              ADBWC3                          WSBWC3
     I              ADBTC3                          WSBTC3
     I              ADBUC3                          WSBUC3
     I              ADBVC3                          WSBVC3
     I              ADFCAA                          WSFCAA
     I              ADRQSX                          WSRQSX
     I              ADRRSX                          WSRRSX
     I              ADRSSX                          WSRSSX
     I              ADRTSX                          WSRTSX
     I              ADT7ST                          WST7ST
     I              ADT8ST                          WST8ST
     I              ADRNSX                          WSRNSX
     I              ADROSX                          WSROSX
     I              ADRPSX                          WSRPSX
     I              ADUVST                          WSUVST
     I              ADUWST                          WSUWST
     I              ADUXST                          WSUXST
     I              ADVSST                          WSVSST
     I              ADAATM                          WSAATM
     I              ADAYNA                          WSAYNA
     I              ADA0NA                          WSA0NA
     I              ADAXDT                          WSAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WTAIC3
     I              ABADTX                          WTADTX
     I              ABACNA                          WTACNA
     I              ABADNA                          WTADNA
     I              ABAENA                          WTAENA
     I              ABAJNA                          WTAJNA
     I              ABBTTX                          WTBTTX
     I              ABBVTX                          WTBVTX
     I              ABBWTX                          WTBWTX
     I              ABA2NA                          WTA2NA
     I              ABABTX                          WTABTX
     I              ABBGCD                          WTBGCD
     I              ABKXCD                          WTKXCD
     I              ABUVST                          WTUVST
     I              ABUWST                          WTUWST
     I              ABUXST                          WTUXST
     I              ABVSST                          WTVSST
     I              ABAATM                          WTAATM
     I              ABAYNA                          WTAYNA
     I              ABA0NA                          WTA0NA
     I              ABAXDT                          WTAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WVDNCD
     I              DNAUNA                          WVAUNA
     I              DNVKST                          WVVKST
     I              DNRSCD                          WVRSCD
     I              DNUVST                          WVUVST
     I              DNUWST                          WVUWST
     I              DNUXST                          WVUXST
     I              DNAATM                          WVAATM
     I              DNAYNA                          WVAYNA
     I              DNA0NA                          WVA0NA
     I              DNAXDT                          WVAXDT
      *
     I@BKCPGX
      * A/R Non A/R Cash          Update index
      * Renamed input format fields
     I              BKG4CD                          WWG4CD
     I              BKHXDT                          WWHXDT
     I              BKYXNX                          WWYXNX
     I              BKUJCD                          WWUJCD
     I              BKAIC3                          WWAIC3
     I              BKUHCD                          WWUHCD
     I              BKBSVA                          WWBSVA
     I              BKCPTX                          WWCPTX
     I              BKNGNA                          WWNGNA
     I              BKB4DT                          WWB4DT
     I              BKAJST                          WWAJST
     I              BKHYDT                          WWHYDT
     I              BKCKNB                          WWCKNB
     I              BKIZTX                          WWIZTX
     I              BKEAZT                          WWEAZT
     I              BKUVST                          WWUVST
     I              BKUWST                          WWUWST
     I              BKUXST                          WWUXST
     I              BKVSST                          WWVSST
     I              BKAATM                          WWAATM
     I              BKAYNA                          WWAYNA
     I              BKA0NA                          WWA0NA
     I              BKAXDT                          WWAXDT
      *
     I@J2CPCM
      * A/R Bank Deposit          Update index
      * Renamed input format fields
     I              J2G4CD                          WXG4CD
     I              J2HXDT                          WXHXDT
     I              J2YXNX                          WXYXNX
     I              J2UIVA                          WXUIVA
     I              J2UJVA                          WXUJVA
     I              J2AJST                          WXAJST
     I              J2CKNB                          WXCKNB
     I              J2BHNB                          WXBHNB
     I              J2BINB                          WXBINB
     I              J2E2VL                          WXE2VL
     I              J2E3VL                          WXE3VL
     I              J2E4VL                          WXE4VL
     I              J2E5VL                          WXE5VL
     I              J2E6VL                          WXE6VL
     I              J2E7VL                          WXE7VL
     I              J2E8VL                          WXE8VL
     I              J2E9VL                          WXE9VL
     I              J2FAVL                          WXFAVL
     I              J2FBVL                          WXFBVL
     I              J2FCVL                          WXFCVL
     I              J2FDVL                          WXFDVL
     I              J2HYDT                          WXHYDT
     I              J2UVST                          WXUVST
     I              J2UWST                          WXUWST
     I              J2UXST                          WXUXST
     I              J2VSST                          WXVSST
     I              J2AATM                          WXAATM
     I              J2AYNA                          WXAYNA
     I              J2A0NA                          WXA0NA
     I              J2AXDT                          WXAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJ51    E DSPDJ5CPL0
      * UPD : A/R Posting and Reporting Update index
      * Renamed input format fields
     I              J5AIC3                          WFAIC3
     I              J5G4CD                          WFG4CD
     I              J5HXDT                          WFHXDT
     I              J5ANC7                          WFANC7
     I              J5CONB                          WFCONB
     I              J5CEST                          WFCEST
     I              J5DXNB                          WFDXNB
     I              J5UHCD                          WFUHCD
     I              J5BSVA                          WFBSVA
     I              J5CPTX                          WFCPTX
     I              J5C1NY                          WFC1NY
     I              J5IZTX                          WFIZTX
     I              J5H0DT                          WFH0DT
     I              J5ATDT                          WFATDT
     I              J5C4NB                          WFC4NB
     I              J5ABST                          WFABST
     I              J5NGNA                          WFNGNA
     I              J5UJCD                          WFUJCD
     I              J5AJST                          WFAJST
     I              J5ADST                          WFADST
     I              J5CKNB                          WFCKNB
     I              J5BCDT                          WFBCDT
     I              J5BGLC                          WFBGLC
     I              J5GLVL                          WFGLVL
     I              J5UVST                          WFUVST
     I              J5UWST                          WFUWST
     I              J5UXST                          WFUXST
     I              J5VSST                          WFVSST
     I              J5AATM                          WFAATM
     I              J5AYNA                          WFAYNA
     I              J5A0NA                          WFA0NA
     I              J5AXDT                          WFAXDT
      *
     IQARBE1    E DSARBECPL0
      * UPD : A/R Detail                Update index
      * Renamed input format fields
     I              BFAIC3                          WGAIC3
     I              BFCONB                          WGCONB
     I              BFCEST                          WGCEST
     I              BFDXNB                          WGDXNB
     I              BFUHCD                          WGUHCD
     I              BFBSVA                          WGBSVA
     I              BFCPTX                          WGCPTX
     I              BFNGNA                          WGNGNA
     I              BFB4DT                          WGB4DT
     I              BFDVDT                          WGDVDT
     I              BFYXNX                          WGYXNX
     I              BFHYDT                          WGHYDT
     I              BFG4CD                          WGG4CD
     I              BFCKNB                          WGCKNB
     I              BFA5ST                          WGA5ST
     I              BFAJST                          WGAJST
     I              BFB1VN                          WGB1VN
     I              BFEAZT                          WGEAZT
     I              BFC1NY                          WGC1NY
     I              BFIZTX                          WGIZTX
     I              BFETSX                          WGETSX
     I              BFW3SX                          WGW3SX
     I              BFW4SX                          WGW4SX
     I              BFW5SX                          WGW5SX
     I              BFW6SX                          WGW6SX
     I              BFW7SX                          WGW7SX
     I              BFW8SX                          WGW8SX
     I              BFQHDT                          WGQHDT
     I              BFQIDT                          WGQIDT
     I              BFQJDT                          WGQJDT
     I              BFQKDT                          WGQKDT
     I              BFQLDT                          WGQLDT
     I              BFGLVL                          WGGLVL
     I              BFGMVL                          WGGMVL
     I              BFGNVL                          WGGNVL
     I              BFGOVL                          WGGOVL
     I              BFGPVL                          WGGPVL
     I              BFUVST                          WGUVST
     I              BFUWST                          WGUWST
     I              BFUXST                          WGUXST
     I              BFAATM                          WGAATM
     I              BFAYNA                          WGAYNA
     I              BFA0NA                          WGA0NA
     I              BFAXDT                          WGAXDT
      *
     IYARDCS      DS                            201
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQARBD1    E DSARBDCPL0
      * UPD : A/R Header                Update index
      * Renamed input format fields
     I              BDAIC3                          WKAIC3
     I              BDCONB                          WKCONB
     I              BDCEST                          WKCEST
     I              BDUHCD                          WKUHCD
     I              BDBSVA                          WKBSVA
     I              BDAIVA                          WKAIVA
     I              BDAOVA                          WKAOVA
     I              BDBGVA                          WKBGVA
     I              BDAJST                          WKAJST
     I              BDE3ST                          WKE3ST
     I              BDG4CD                          WKG4CD
     I              BDCKNB                          WKCKNB
     I              BDCAC7                          WKCAC7
     I              BDBKC7                          WKBKC7
     I              BDBCCD                          WKBCCD
     I              BDR4CD                          WKR4CD
     I              BDB4DT                          WKB4DT
     I              BDATDT                          WKATDT
     I              BDH0DT                          WKH0DT
     I              BDH3DT                          WKH3DT
     I              BDH4DT                          WKH4DT
     I              BDH5DT                          WKH5DT
     I              BDANC7                          WKANC7
     I              BDCPTX                          WKCPTX
     I              BDBSDY                          WKBSDY
     I              BDUVST                          WKUVST
     I              BDUWST                          WKUWST
     I              BDUXST                          WKUXST
     I              BDAATM                          WKAATM
     I              BDAYNA                          WKAYNA
     I              BDA0NA                          WKA0NA
     I              BDAXDT                          WKAXDT
      *
     IYBRDCS      DS                            134
     IQARBK1    E DSARBKCPL0
      * UPD : A/R Non A/R Cash          Update index
      * Renamed input format fields
     I              BKG4CD                          WWG4CD
     I              BKHXDT                          WWHXDT
     I              BKYXNX                          WWYXNX
     I              BKUJCD                          WWUJCD
     I              BKAIC3                          WWAIC3
     I              BKUHCD                          WWUHCD
     I              BKBSVA                          WWBSVA
     I              BKCPTX                          WWCPTX
     I              BKNGNA                          WWNGNA
     I              BKB4DT                          WWB4DT
     I              BKAJST                          WWAJST
     I              BKHYDT                          WWHYDT
     I              BKCKNB                          WWCKNB
     I              BKIZTX                          WWIZTX
     I              BKEAZT                          WWEAZT
     I              BKUVST                          WWUVST
     I              BKUWST                          WWUWST
     I              BKUXST                          WWUXST
     I              BKVSST                          WWVSST
     I              BKAATM                          WWAATM
     I              BKAYNA                          WWAYNA
     I              BKA0NA                          WWA0NA
     I              BKAXDT                          WWAXDT
      *
     IYCRDCS      DS                            134
     IQPDJ21    E DSPDJ2CPL0
      * UPD : A/R Bank Deposit          Update index
      * Renamed input format fields
     I              J2G4CD                          WXG4CD
     I              J2HXDT                          WXHXDT
     I              J2YXNX                          WXYXNX
     I              J2UIVA                          WXUIVA
     I              J2UJVA                          WXUJVA
     I              J2AJST                          WXAJST
     I              J2CKNB                          WXCKNB
     I              J2BHNB                          WXBHNB
     I              J2BINB                          WXBINB
     I              J2E2VL                          WXE2VL
     I              J2E3VL                          WXE3VL
     I              J2E4VL                          WXE4VL
     I              J2E5VL                          WXE5VL
     I              J2E6VL                          WXE6VL
     I              J2E7VL                          WXE7VL
     I              J2E8VL                          WXE8VL
     I              J2E9VL                          WXE9VL
     I              J2FAVL                          WXFAVL
     I              J2FBVL                          WXFBVL
     I              J2FCVL                          WXFCVL
     I              J2FDVL                          WXFDVL
     I              J2HYDT                          WXHYDT
     I              J2UVST                          WXUVST
     I              J2UWST                          WXUWST
     I              J2UXST                          WXUXST
     I              J2VSST                          WXVSST
     I              J2AATM                          WXAATM
     I              J2AYNA                          WXAYNA
     I              J2A0NA                          WXA0NA
     I              J2AXDT                          WXAXDT
      *
     IYDRDCS      DS                            143
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Bank Deposit
      * I :  Bank Code
     I                                        1   6 P1G4CD
      * I :  Deposit Date
     I                                    P   7  100P1HXDT
      * I :  Deposit Time
     I                                    P  11  130P1YXNX
      * N :  Deposit Amount
     I                                    P  14  192P1UIVA
      * N :  Total Cash Applied
     I                                    P  20  252P1UJVA
      * I :  A/R Processing Status
     I                                       26  26 P1AJST
      * N :  Number of Deposit Checks
     I                                    P  27  290P1BHNB
      * N :  Number of Applied Checks
     I                                    P  30  320P1BINB
     IP2PARM      DS
      * FLD: *Arrays
      * N :  USR Remaining Balance
     I                                    P   1   62P2U8VA
     IP3PARM      DS
      * FLD: *Arrays
      * N :  PRT Description
     I                                        1  25 P3G3TX
      * N :  PRT Printer Device
     I                                       26  35 P3WRST
      * N :  PRT Hold Output Sts
     I                                       36  39 P3WSST
      * N :  PRT Save Output Sts
     I                                       40  43 P3WTST
      * N :  PRT Number of Copies
     I                                       44  450P3DYNB
      * N :  PRT Night Queue
     I                                       46  55 P3BVVN
      * I :  Status - Y or N
     I                                       56  56 P3B8ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1G4CD    PARM           WP0001  6        Bank Code
     C           P1HXDT    PARM           WP0002  70       Deposit Date
     C           P1YXNX    PARM           WP0003  40       Deposit Time
     C           P1AJST    PARM           WP0004  1        A/R Processing
     C           P3B8ST    PARM           WP0005  1        Status - Y or N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CHG Deposit Listing    XF
      * RMC 3/24/05 OMS036 Changes for the Deposit Time
      * RTV Deposit Amounts    RT - A/R Bank Deposit  * 
     C                     EXSR SARVGN
     C           P1UIVA    SUB  P1UJVA    P2U8VA           USR Remaining B
      * Write and update the A/R Detail
      * CHG Post/Report        RT - A/R Detail  * 
     C                     EXSR SBRVGN
      * * RMC OMS036 3/30/05 Read A/R Header OA to update the A/R Header
      * RTV Post/Report Update RT - A/R Header OA  * 
     C                     EXSR SHRVGN
      * Write A/R Post/Report file from A/R Non-A/R Cash File
      * CHG Post/Report        RT - A/R Non A/R Cash  * 
     C                     EXSR SMRVGN
      * Write Credit to cash G/L Record
      * CRT Crd-A/R G/L acct   XF - A/R Posting and Reporting  * 
     C                     CALL 'PDVSXFR'              90  CRT Crd-A/R G/L
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1G4CD    WQ0051  6        Bank Code
     C                     PARM P1HXDT    WQ0052  70       Deposit Date
     C                     PARM P1YXNX    WQ0053  40       Deposit Time
     C                     PARM P1AJST    WQ0054  1        A/R Processing
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDVSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update Processing code for deposit record
      * OMS036 RMC 4/4/05 If update status is yes
      * CASE: PAR.Status - Y or N is yes
     C           P3B8ST    IFEQ 'Y'                        *IF
      * RTV Chg Process Code   RT - A/R Bank Deposit  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
      * Send message 'Report has been printed.'
     C                     MOVEL'USR2100' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Deposit Amounts    RT - A/R Bank Deposit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAG4CD    WQSA02           Bank Code
     C           *LIKE     DEFN WAHXDT    WQSA03           Deposit Date
     C           *LIKE     DEFN WAYXNX    WQSA04           Deposit Time
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Bank Code
     C                     KFLD           WQSA03           Deposit Date
     C                     KFLD           WQSA04           Deposit Time
      * Setup key
     C                     MOVELP1G4CD    WQSA02           Bank Code
     C                     Z-ADDP1HXDT    WQSA03           Deposit Date
     C                     Z-ADDP1YXNX    WQSA04           Deposit Time
      * Establish starting position
     C           KRSSA     SETLL@J2CPCU                    *
     C           KRSSA     READE@J2CPCU                  90*
      * Data record not found
     C   90                MOVEL'USR2039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAUIVA    P1UIVA           Deposit Amount
     C                     Z-ADDWAUJVA    P1UJVA           Total Cash Appl
     C                     Z-ADDWABHNB    P1BHNB           Number of Depos
     C                     Z-ADDWABINB    P1BINB           Number of Appli
     C           KRSSA     READE@J2CPCU                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * CHG Post/Report        RT - A/R Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  30       G/L Posting Com
     C                     MOVEL*BLANK    WN0002  8        G/L ID Code JDE
     C                     Z-ADD*ZERO     WN0003  70       Order Number Re
     C                     Z-ADD*ZERO     WN0004  70       Due Date
     C                     Z-ADD*ZERO     WN0005  70       Last Payment Da
     C                     Z-ADD*ZERO     WN0006  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0007 15        Reference Field
     C                     MOVEL*BLANK    WN0008  1        USR First Time
     C                     MOVEL*BLANK    WN0009  8        USR Bank G/L Ap
     C                     MOVEL*BLANK    WN0010  8        Bank G/L ID Cod
     C                     MOVEL*BLANK    WN0011 30        Adjustment Desc
     C                     MOVEL*BLANK    WN0012  1        Effect on Accou
     C                     Z-ADD*ZERO     WN0013 112       Adjustment Limi
     C                     MOVEL*BLANK    WN0014  3        Cash/Adj
     C                     MOVEL*BLANK    WN0015  1        User Enter G/L
     C                     MOVEL*BLANK    WN0016  1        System Control
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0008           USR First Time
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBG4CD    WQSB02           Bank Code
     C           *LIKE     DEFN WBDVDT    WQSB04           Payment/Deposit
     C           *LIKE     DEFN WBYXNX    WQSB05           Deposit Time
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Bank Code
     C                     KFLD           WQSB04           Payment/Deposit
     C                     KFLD           WQSB05           Deposit Time
      * Setup key
     C                     MOVELP1G4CD    WQSB02           Bank Code
     C                     Z-ADDP1HXDT    WQSB04           Payment/Deposit
     C                     Z-ADDP1YXNX    WQSB05           Deposit Time
      * Establish starting position
     C           KRSSB     SETLL@BECPYW                    *
     C           KRSSB     READE@BECPYW                  90*
      * Data record not found
     C   90                MOVEL'USR0178' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * A/R Detail Copy and Change A/R Processing Code
      * Bank Cash G/L Code
      * RTV Bank G/L           RT - Bank Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1G4CD    WL0001    P      Bank Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WN0009    P      G/L Alpha Code
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBAIC3    WQ0001  30       Company Number
     C                     PARM WN0009    WQ0002  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0003 25        G/L Code Desc U
     C           WN0010    PARM *BLANK    WQ0004  8        G/L Account Id
     C                     PARM WUAT1U    WQ0005  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0006  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0007  1        Record Found US
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Retrieve Info. stored on header written for each detail line
      * RTV Post/Report to G/L RT - A/R Header  * 
     C                     EXSR SDRVGN
      * Create A/R Posting and Reporting File record for A/R Detail File
      * RTV Adj Limits         RT - A/R Adjustment Type  * 
     C                     EXSR SERVGN
      * Cash Adjustments and G/L Code
      * CASE: PAR.Cash/Adj is Cash Adjustment
     C           WN0014    IFEQ 'CSH'                      *IF
     C                     MOVELWN0010    WN0002           G/L ID Code JDE
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBIZTX    WN0002           G/L ID Code JDE
     C                     END                             *FI
      * ** New GMPEC parm added to ARACTRET. If "L" then subledger requir
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WN0002    WQ0008  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0009 12        Cost Center. .
     C                     PARM *BLANK    WQ0010  6        Object Account
     C                     PARM *BLANK    WQ0011  8        Subsidiary . .
     C                     PARM *BLANK    WQ0012 30        Description
     C           WN0001    PARM *ZERO     WQ0013  30       G/L Posting Com
     C           WUHNST    PARM *BLANK    WQ0014  1        JDE Posting Edi
     C           WUUNCD    PARM *BLANK    WQ0015  7        Error Return te
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Default Sub Ledger code if GMPEC="L"               E000512
      * CASE: WRK.JDE Posting Edit Code USR is Ledger Required
     C           WUHNST    IFEQ 'L'                        *IF
     C                     Z-ADDWBGLVL    WUGLVL           G/L Sub-Ledger
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUGLVL           G/L Sub-Ledger
     C                     END                             *FI
      * CRT Post/Report G/L    CR - A/R Posting and Reporting  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0003           Company Number
     C                     MOVELP1G4CD    WL0004    P      Bank Code
     C                     Z-ADDP1HXDT    WL0005           Deposit Date
     C                     Z-ADDWN0006    WL0006           A/R Customer Nu
     C                     Z-ADDWBCONB    WL0007           Invoice Number
     C                     MOVELWBCEST    WL0008    P      Invoice Suffix
     C                     Z-ADDWBDXNB    WL0009           Sequence Number
     C                     MOVELWBUHCD    WL0010    P      Adjustment Type
     C                     Z-ADDWBBSVA    WL0011           Transaction Amo
     C                     MOVELWBCPTX    WL0012    P      A/R Check Numbe
     C                     Z-ADDWN0001    WL0013           G/L Posting Com
     C                     MOVELWN0002    WL0014    P      G/L ID Code JDE
     C                     Z-ADDWN0005    WL0015           Last Payment Da
     C                     Z-ADDWN0004    WL0016           Due Date
     C                     Z-ADDWN0003    WL0017           Order Number
     C                     MOVELWBEAZT    WL0018    P      Effect Cust. Ac
     C                     MOVELWBNGNA    WL0019    P      Explanation
     C                     MOVEL*BLANK    WL0020           Reference Field
     C                     MOVELP1AJST    WL0021    P      A/R Processing
     C                     MOVEL'D'       WL0022    P      Originating Fil
     C                     Z-ADDWBCKNB    WL0023           G/L Document Nu
     C                     Z-ADD*ZERO     WL0024           Post to G/L Dat
     C                     MOVELWN0010    WL0025    P      Bank G/L ID Cod
     C                     Z-ADDWUGLVL    WL0026           G/L Sub-Ledger
     C                     MOVELWBUVST    WL0027    P      EDI Status 1
     C                     MOVELWBUWST    WL0028    P      EDI Status 2
     C                     MOVELWBUXST    WL0029    P      EDI Status 3
     C                     MOVEL'A'       WL0030    P      Record Status
     C                     Z-ADDWBAATM    WL0031           Job Time
     C                     MOVELWBAYNA    WL0032    P      User Id
     C                     MOVELWBA0NA    WL0033    P      Job Name
     C                     Z-ADDWBAXDT    WL0034           Job Date
     C                     EXSR SFCRRC
      * Change A/R Processing Code to Either 'R'-Report or 'A'-Avail to P
      * CASE: PAR.Status - Y or N is yes
     C           P3B8ST    IFEQ 'Y'                        *IF
      * CHG Post/Report G/L    CH - A/R Detail  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSB     READE@BECPYW                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Bank G/L           RT - Bank Master  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCG4CD           Bank Code
      * Setup key
     C                     MOVELWL0001    WCG4CD           Bank Code
      * Establish starting position
     C           KRSSC     CHAIN@EBREVK              90    *
      * Data record not found
     C   90                MOVEL'USR0850' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWCIVTX    WL0002           G/L Alpha Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Post/Report to G/L RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADDWBCONB    WDCONB           Invoice Number
     C                     MOVELWBCEST    WDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSD     CHAIN@BDCPF7              90    *
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDCAC7    WN0003           Order Number Re
     C                     Z-ADDWDATDT    WN0004           Due Date
     C                     Z-ADDWDH0DT    WN0005           Last Payment Da
     C                     Z-ADDWDANC7    WN0006           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Adj Limits         RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEUHCD           Adjustment Type
      * Setup key
     C                     Z-ADDWBAIC3    WEAIC3           Company Number
     C                     MOVELWBUHCD    WEUHCD           Adjustment Type
      * Establish starting position
     C           KRSSE     CHAIN@J3CPCQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2041' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWENFNA    WN0011           Adjustment Desc
     C                     MOVELWEEAZT    WN0012           Effect on Accou
     C                     MOVELWEIZTX    WN0002           G/L ID Code JDE
     C                     Z-ADDWEUKVA    WN0013           Adjustment Limi
     C                     MOVELWEA5ST    WN0014           Cash/Adj
     C                     MOVELWEGLTS    WN0015           User Enter G/L
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT Post/Report G/L    CR - A/R Posting and Reporting  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @J5CPDL
     C                     Z-ADDWL0003    WFAIC3           Company Number
     C                     MOVELWL0004    WFG4CD           Bank Code
     C                     Z-ADDWL0005    WFHXDT           Deposit Date
     C                     Z-ADDWL0006    WFANC7           A/R Customer Nu
     C                     Z-ADDWL0007    WFCONB           Invoice Number
     C                     MOVELWL0008    WFCEST           Invoice Suffix
     C                     Z-ADDWL0009    WFDXNB           Sequence Number
     C                     MOVELWL0010    WFUHCD           Adjustment Type
     C                     Z-ADDWL0011    WFBSVA           Transaction Amo
     C                     MOVELWL0012    WFCPTX           A/R Check Numbe
     C                     Z-ADDWL0013    WFC1NY           G/L Posting Com
     C                     MOVELWL0014    WFIZTX           G/L ID Code JDE
     C                     Z-ADDWL0015    WFH0DT           Last Payment Da
     C                     Z-ADDWL0016    WFATDT           Due Date
     C                     Z-ADDWL0017    WFC4NB           Order Number
     C                     MOVELWL0018    WFABST           Effect Cust. Ac
     C                     MOVELWL0019    WFNGNA           Explanation
     C                     MOVELWL0020    WFUJCD           Reference Field
     C                     MOVELWL0021    WFAJST           A/R Processing
     C                     MOVELWL0022    WFADST           Originating Fil
     C                     Z-ADDWL0023    WFCKNB           G/L Document Nu
     C                     Z-ADDWL0024    WFBCDT           Post to G/L Dat
     C                     MOVELWL0025    WFBGLC           Bank G/L ID Cod
     C                     Z-ADDWL0026    WFGLVL           G/L Sub-Ledger
     C                     MOVELWL0027    WFUVST           EDI Status 1
     C                     MOVELWL0028    WFUWST           EDI Status 2
     C                     MOVELWL0029    WFUXST           EDI Status 3
     C                     MOVELWL0030    WFVSST           Record Status
     C                     Z-ADDWL0031    WFAATM           Job Time
     C                     MOVELWL0032    WFAYNA           User Id
     C                     MOVELWL0033    WFA0NA           Job Name
     C                     Z-ADDWL0034    WFAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSF    KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFG4CD           Bank Code
     C                     KFLD           WFHXDT           Deposit Date
     C                     KFLD           WFANC7           A/R Customer Nu
     C                     KFLD           WFCONB           Invoice Number
     C                     KFLD           WFCEST           Invoice Suffix
     C                     KFLD           WFDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSF    SETLL@J5CPDL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2079' W0RTN   7
      * Send message 'A/R Posting and Report EX'
     C                     MOVEL'USR2079' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@J5CPDL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * CHG Post/Report G/L    CH - A/R Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0017  3        Adjustment Type
     C                     Z-ADD*ZERO     WN0018 112       Transaction Amo
     C                     MOVEL*BLANK    WN0019 10        A/R Check Numbe
     C                     MOVEL*BLANK    WN0020 30        Explanation
     C                     Z-ADD*ZERO     WN0021  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0022  70       Payment/Deposit
     C                     Z-ADD*ZERO     WN0023  70       G/L Post Date
     C                     MOVEL*BLANK    WN0024  6        Bank Code
     C                     Z-ADD*ZERO     WN0025  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0026  3        Cash/Adj
     C                     MOVEL*BLANK    WN0027 10        Originating Pro
     C                     MOVEL*BLANK    WN0028  1        Effect on Accou
     C                     Z-ADD*ZERO     WN0029  30       G/L Posting Com
     C                     MOVEL*BLANK    WN0030  8        G/L ID Code JDE
     C                     MOVEL*BLANK    WN0031  1        Post Adjustment
     C                     MOVEL*BLANK    WN0032  2        A/R TF Exempt C
     C                     MOVEL*BLANK    WN0033  1        A/R Dtl UnUsed
     C                     MOVEL*BLANK    WN0034  1        A/R Dtl UnUsed
     C                     MOVEL*BLANK    WN0035  1        A/R Dtl UnUsed
     C                     MOVEL*BLANK    WN0036  2        A/R Dtl UnUsed
     C                     MOVEL*BLANK    WN0037  2        A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0038  70       TFS Adj Week-En
     C                     Z-ADD*ZERO     WN0039  70       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0040  70       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0041  70       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0042  70       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0043 112       G/L Sub-Ledger
     C                     Z-ADD*ZERO     WN0044 112       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0045 112       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0046 112       A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WN0047 112       A/R Dtl UnUsed
     C                     MOVEL*BLANK    WN0048  1        EDI Status 1
     C                     MOVEL*BLANK    WN0049  1        EDI Status 2
     C                     MOVEL*BLANK    WN0050  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0051  60       Job Time
     C                     MOVEL*BLANK    WN0052 10        User Id
     C                     MOVEL*BLANK    WN0053 10        Job Name
     C                     Z-ADD*ZERO     WN0054  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @BFCPFN
     C                     Z-ADDWBAIC3    WGAIC3           Company Number
     C                     Z-ADDWBCONB    WGCONB           Invoice Number
     C                     MOVELWBCEST    WGCEST    P      Invoice Suffix
     C                     Z-ADDWBDXNB    WGDXNB           Sequence Number
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGCONB           Invoice Number
     C                     KFLD           WGCEST           Invoice Suffix
     C                     KFLD           WGDXNB           Sequence Number
     C           KLCHSG    CHAIN@BFCPFN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBECPL0'MDACP
     C                     MOVEL'@BFCPFN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBE1    YARDCS
      * Move non-key fields to @BFCPFN
     C                     Z-ADDWBYXNX    WGYXNX           Deposit Time
     C                     MOVELP1AJST    WGAJST    P      A/R Processing
      *
      * Set PGM.*Record Data Changed flag
     C           QARBE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QARBE1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@BFCPFN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBECPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Post/Report Update RT - A/R Header OA  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0055  8        USR Bank G/L Ap
     C                     MOVEL*BLANK    WN0056  8        G/L ID Code JDE
     C                     MOVEL*BLANK    WN0057  8        Bank G/L ID Cod
     C                     MOVEL*BLANK    WN0058  3        Adjustment Type
     C                     Z-ADD*ZERO     WN0059 112       Transaction Amo
     C                     Z-ADD*ZERO     WN0060 112       Adjustment Amou
     C                     Z-ADD*ZERO     WN0061 112       Amount Paid
     C                     Z-ADD*ZERO     WN0062 112       Remaining Balan
     C                     Z-ADD*ZERO     WN0063  80       G/L Document Nu
     C                     Z-ADD*ZERO     WN0064  70       Order Number Re
     C                     Z-ADD*ZERO     WN0065  70       Due Date
     C                     Z-ADD*ZERO     WN0066  70       Last Payment Da
     C                     Z-ADD*ZERO     WN0067  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0068 10        A/R Check Numbe
     C                     Z-ADD*ZERO     WN0069  30       G/L Posting Com
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ** 02/23/2010 LJB E000512   Rtv Post Edit Code from JDE. If
      * ** = "L", retrieve G/L Sub Ledger Code from the A/R detail
      * ** else set to zeros
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHG4CD    WQSH01           Bank Code
     C           *LIKE     DEFN WHHXDT    WQSH02           Deposit Date
     C           *LIKE     DEFN WHYXNX    WQSH03           Deposit Time
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Bank Code
     C                     KFLD           WQSH02           Deposit Date
     C                     KFLD           WQSH03           Deposit Time
      * Setup key
     C                     MOVELP1G4CD    WQSH01           Bank Code
     C                     Z-ADDP1HXDT    WQSH02           Deposit Date
     C                     Z-ADDP1YXNX    WQSH03           Deposit Time
      * Establish starting position
     C           KRSSH     SETLL@A4CPYA                    *
     C           KRSSH     READE@A4CPYA                  90*
      * Data record not found
     C   90                MOVEL'USR3460' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC - OMS036 This was copied from the RTV over the A/R Header. We
      *  need to read this to get the OA for the deposit date/time, then
      *    update the a/r header           3/30/05
      * -----------------------------------------------------
      * The OA from the Header created on that Deposit Date with
      *   the Deposit date the Same as the Due Date.  OA is only record t
      *   from the AR Header that is used for the Bank Deposit Listing
      * RTV OA Cash Fields    RT - A/R Header  * 
     C                     EXSR SIRVGN
      * Program from HPE to convert customer code to number ID Code
      * RTV Bank G/L           RT - Bank Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWHG4CD    WL0001    P      Bank Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WN0055    P      G/L Alpha Code
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0016  30       Company Number
     C                     PARM WN0055    WQ0017  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0018 25        G/L Code Desc U
     C           WN0057    PARM *BLANK    WQ0019  8        G/L Account Id
     C                     PARM WUAT1U    WQ0020  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0021  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0022  1        Record Found US
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV G/L Code           RT - A/R Adjustment Type  * 
     C                     EXSR SJRVGN
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WN0056    WQ0023  8        G/L ID Code Alp
     C           WUMCUX    PARM *BLANK    WQ0024 12        Cost Center. .
     C           WUOBJX    PARM *BLANK    WQ0025  6        Object Account
     C           WUSUBX    PARM *BLANK    WQ0026  8        Subsidiary . .
     C                     PARM *BLANK    WQ0027 30        Description
     C           WN0069    PARM *ZERO     WQ0028  30       G/L Posting Com
     C           WUHNST    PARM *BLANK    WQ0029  1        JDE Posting Edi
     C           WUUNCD    PARM *BLANK    WQ0030  7        Error Return te
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Rtv sub ledger code if GMPEC is "L", else set to zeros  E00051
      * CASE: WRK.JDE Posting Edit Code USR is Ledger Required
     C           WUHNST    IFEQ 'L'                        *IF
      * RTV Last Seq. No.      RT - A/R Detail  * 
     C                     EXSR SKRVGN
      * RTV G/L Sub Ledger Cd  XF - A/R Detail  * 
     C                     CALL 'PNG4XFR'              90  RTV G/L Sub Led
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WHAIC3    WQ0031  30       Company Number
     C                     PARM WHCONB    WQ0032  70       Invoice Number
     C                     PARM WHCEST    WQ0033  2        Invoice Suffix
     C                     PARM WUDXNB    WQ0034  30       Sequence Number
     C           WUGLVL    PARM *ZERO     WQ0035 112       G/L Sub-Ledger
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNG4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUGLVL           G/L Sub-Ledger
     C                     END                             *FI
      * *** Create A/R Post/Report Record from A/R Header OAC records
      * CRT Post/Report G/L    CR - A/R Posting and Reporting  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0003           Company Number
     C                     MOVELP1G4CD    WL0004    P      Bank Code
     C                     Z-ADDP1HXDT    WL0005           Deposit Date
     C                     Z-ADDWN0067    WL0006           A/R Customer Nu
     C                     Z-ADDWHCONB    WL0007           Invoice Number
     C                     MOVELWHCEST    WL0008    P      Invoice Suffix
     C                     Z-ADD*ZERO     WL0009           Sequence Number
     C                     MOVELWN0058    WL0010    P      Adjustment Type
     C                     Z-ADDWN0059    WL0011           Transaction Amo
     C                     MOVELWN0068    WL0012    P      A/R Check Numbe
     C                     Z-ADDWN0069    WL0013           G/L Posting Com
     C                     MOVELWN0056    WL0014    P      G/L ID Code JDE
     C                     Z-ADDWN0066    WL0015           Last Payment Da
     C                     Z-ADDWN0065    WL0016           Due Date
     C                     Z-ADDWN0064    WL0017           Order Number
     C                     MOVEL'Y'       WL0018    P      Effect Cust. Ac
     C                     MOVEL*BLANK    WL0019           Explanation
     C                     MOVEL*BLANK    WL0020           Reference Field
     C                     MOVELP1AJST    WL0021    P      A/R Processing
     C                     MOVEL'H'       WL0022    P      Originating Fil
     C                     Z-ADDWN0063    WL0023           G/L Document Nu
     C                     Z-ADD*ZERO     WL0024           Post to G/L Dat
     C                     MOVELWN0057    WL0025    P      Bank G/L ID Cod
     C                     Z-ADDWUGLVL    WL0026           G/L Sub-Ledger
     C                     MOVELWUUVST    WL0027    P      EDI Status 1
     C                     MOVELWUUWST    WL0028    P      EDI Status 2
     C                     MOVELWUUXST    WL0029    P      EDI Status 3
     C                     MOVEL'A'       WL0030    P      Record Status
     C                     Z-ADD##JTM     WL0031           Job Time
     C                     MOVEL##USR     WL0032    P      User Id
     C                     MOVEL##JOB     WL0033    P      Job Name
     C                     Z-ADD##JDT     WL0034           Job Date
     C                     EXSR SFCRRC
      * *** Change A/R Header Processing Code
      * ... RMC 4/4/05  OMS036 - if update sts is yes
      * CASE: PAR.Status - Y or N is yes
     C           P3B8ST    IFEQ 'Y'                        *IF
      * CHG A/R Prcess Cd-Post CH - A/R Header  * 
     C                     EXSR SLCHRC
     C                     END                             *FI
     C           KRSSH     READE@A4CPYA                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV OA Cash Fields    RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWHAIC3    WDAIC3           Company Number
     C                     Z-ADDWHCONB    WDCONB           Invoice Number
     C                     MOVELWHCEST    WDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSI     CHAIN@BDCPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0058           Adjustment Type
     C                     Z-ADD*ZERO     WN0059           Transaction Amo
     C                     Z-ADD*ZERO     WN0060           Adjustment Amou
     C                     Z-ADD*ZERO     WN0061           Amount Paid
     C                     Z-ADD*ZERO     WN0062           Remaining Balan
     C                     MOVEL*BLANK    WUAJST           A/R Processing
     C                     Z-ADD*ZERO     WN0063           G/L Document Nu
     C                     Z-ADD*ZERO     WN0064           Order Number Re
     C                     Z-ADD*ZERO     WN0065           Due Date
     C                     Z-ADD*ZERO     WN0066           Last Payment Da
     C                     Z-ADD*ZERO     WN0067           A/R Customer Nu
     C                     MOVEL*BLANK    WN0068           A/R Check Numbe
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDUHCD    WN0058           Adjustment Type
     C                     Z-ADDWDBSVA    WN0059           Transaction Amo
     C                     Z-ADDWDAIVA    WN0060           Adjustment Amou
     C                     Z-ADDWDAOVA    WN0061           Amount Paid
     C                     Z-ADDWDBGVA    WN0062           Remaining Balan
     C                     MOVELWDAJST    WUAJST           A/R Processing
     C                     Z-ADDWDCKNB    WN0063           G/L Document Nu
     C                     Z-ADDWDCAC7    WN0064           Order Number Re
     C                     Z-ADDWDATDT    WN0065           Due Date
     C                     Z-ADDWDH0DT    WN0066           Last Payment Da
     C                     Z-ADDWDANC7    WN0067           A/R Customer Nu
     C                     MOVELWDCPTX    WN0068           A/R Check Numbe
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV G/L Code           RT - A/R Adjustment Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WIUHCD    WQSJ02           Adjustment Type
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Adjustment Type
      * Setup key
     C                     Z-ADDWHAIC3    WQSJ01           Company Number
     C                     MOVE *BLANK    WQSJ02           Adjustment Type
     C                     MOVEL'OA'      WQSJ02           Adjustment Type
      * Establish starting position
     C           KRSSJ     SETLL@J3CPCZ                    *
     C           KRSSJ     READE@J3CPCZ                  90*
      * Data record not found
     C   90                MOVEL'USR2041' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELWIIZTX    WN0056           G/L ID Code JDE
     C           KRSSJ     READE@J3CPCZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Last Seq. No.      RT - A/R Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WJCONB    WQSK02           Invoice Number
     C           *LIKE     DEFN WJCEST    WQSK03           Invoice Suffix
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Invoice Number
     C                     KFLD           WQSK03           Invoice Suffix
     C                     KFLD           WJDXNB           Sequence Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Invoice Number
     C                     KFLD           WQSK03           Invoice Suffix
      * Setup key
     C                     Z-ADDWHAIC3    WQSK01           Company Number
     C                     Z-ADDWHCONB    WQSK02           Invoice Number
     C                     MOVELWHCEST    WQSK03           Invoice Suffix
     C                     Z-ADDWUDXNB    WJDXNB           Sequence Number
      * Establish starting position
     C           KPSSK     SETLL@BFCPFO                    *
     C           KRSSK     READE@BFCPFO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0178' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WUDXNB           Sequence Number
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWJDXNB    WUDXNB           Sequence Number
     C           KRSSK     READE@BFCPFO                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * CHG A/R Prcess Cd-Post CH - A/R Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0070  3        Adjustment Type
     C                     Z-ADD*ZERO     WN0071 112       Transaction Amo
     C                     Z-ADD*ZERO     WN0072 112       Adjustment Amou
     C                     Z-ADD*ZERO     WN0073 112       Amount Paid
     C                     Z-ADD*ZERO     WN0074 112       Remaining Balan
     C                     MOVEL*BLANK    WN0075  1        Purge Status
     C                     MOVEL*BLANK    WN0076  6        Bank Code
     C                     Z-ADD*ZERO     WN0077  80       G/L Document Nu
     C                     Z-ADD*ZERO     WN0078  70       Order Number Re
     C                     Z-ADD*ZERO     WN0079  70       Ship To Custome
     C                     MOVEL*BLANK    WN0080  3        Salesperson Cod
     C                     MOVEL*BLANK    WN0081  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0082  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0083  70       Due Date
     C                     Z-ADD*ZERO     WN0084  70       Last Payment Da
     C                     Z-ADD*ZERO     WN0085  70       Unused Date Cod
     C                     Z-ADD*ZERO     WN0086  70       Paid in Full Da
     C                     Z-ADD*ZERO     WN0087  70       Last G/L Post D
     C                     Z-ADD*ZERO     WN0088  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0089 10        A/R Check Numbe
     C                     Z-ADD*ZERO     WN0090  50       Days to Pay
     C                     MOVEL*BLANK    WN0091  1        EDI Status 1
     C                     MOVEL*BLANK    WN0092  1        EDI Status 2
     C                     MOVEL*BLANK    WN0093  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0094  60       Job Time
     C                     MOVEL*BLANK    WN0095 10        User Id
     C                     MOVEL*BLANK    WN0096 10        Job Name
     C                     Z-ADD*ZERO     WN0097  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @BDCPFG
     C                     Z-ADDWHAIC3    WKAIC3           Company Number
     C                     Z-ADDWHCONB    WKCONB           Invoice Number
     C                     MOVELWHCEST    WKCEST    P      Invoice Suffix
      *
     C           KLCHSL    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKCONB           Invoice Number
     C                     KFLD           WKCEST           Invoice Suffix
     C           KLCHSL    CHAIN@BDCPFG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBDCPL0'MDACP
     C                     MOVEL'@BDCPFG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBD1    YBRDCS
      * Move non-key fields to @BDCPFG
     C                     MOVELP1AJST    WKAJST    P      A/R Processing
      *
      * Set PGM.*Record Data Changed flag
     C           QARBD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@BDCPFG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * CHG Post/Report        RT - A/R Non A/R Cash  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0098  70       Invoice Number
     C                     Z-ADD*ZERO     WN0099  30       G/L Posting Com
     C                     MOVEL*BLANK    WN0100  8        Bank G/L ID Cod
     C                     MOVEL*BLANK    WN0101  8        USR Bank G/L Ap
     C                     Z-ADD*ZERO     WN0102  70       Next On Acct Ca
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Change Log and comments
     C                     EXSR UASUBR                     ***** Change Lo
      * RTV Next on Account #  RT - Company Control  * 
     C                     EXSR SNRVGN
      *
     C                     MOVEL*BLANK    WN0104 10        User Profile Na
      *
      * VAL Set Int. Acc EXTNL IF
     C                     MOVEL##USR     WN0104           User Profile Na
      *
     C                     MOVEL*BLANK    WN0105 10        User Code Model
      *
      * VAL User/Appl EXTERNAL IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SORVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0105    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0104    WL0035    P      User Profile Na
     C                     MOVEL'A/R'     WL0036    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0003    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0105    WL0035    P      User Profile Na
     C                     MOVEL'A/R'     WL0036    P      Application Cod
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0037    WUAIC3           Company Number
     C                     MOVELWL0038    YL0003    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0003    YN0006           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUWVST           Access Denied (
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUWVST           Access Denied (
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Use User Profile Control company if entered,get whse if the appl
      * CASE: LCL.Company Number is greater than zero
     C           YL0002    IFGT *ZERO                      *IF
     C                     Z-ADDYL0002    WUAIC3           Company Number
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0003    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  RT - Warehouse  * 
     C                     EXSR SQRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWUAIC3    YL0001           Company Number
     C                     MOVELWUWVST    YN0012           Access Denied (
      * If access denied is no, rtv co. name
      * CASE: WRK.Access Denied (Y/N) is no
     C           WUWVST    IFEQ 'N'                        *IF
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
      * RTV Screen Heading     RT
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SSRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Text String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C                     MOVE 'N'       FLAG    1        FLAG
     C           UX        DOWGT0
     C           FLAG      ANDEQ'N'
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     MOVE 'Y'       FLAG
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
      *** ADDED FOR HPE, THERE HEADER FOOTER IS OFF   MEA 042494
     C                     SUB  1         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
     C                     MOVELWUDE40    YN0011           System Value Al
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLG4CD    WQSM01           Bank Code
     C           *LIKE     DEFN WLHXDT    WQSM02           Deposit Date
     C           *LIKE     DEFN WLYXNX    WQSM03           Deposit Time
      * Define keylist
     C           KPSSM     KLIST
     C                     KFLD           WQSM01           Bank Code
     C                     KFLD           WQSM02           Deposit Date
     C                     KFLD           WQSM03           Deposit Time
     C                     KFLD           WLUJCD           Reference Field
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Bank Code
     C                     KFLD           WQSM02           Deposit Date
     C                     KFLD           WQSM03           Deposit Time
      * Setup key
     C                     MOVELP1G4CD    WQSM01           Bank Code
     C                     Z-ADDP1HXDT    WQSM02           Deposit Date
     C                     Z-ADDP1YXNX    WQSM03           Deposit Time
     C                     MOVEL*BLANK    WLUJCD           Reference Field
      * Establish starting position
     C           KPSSM     SETLL@BKCPGY                    *
     C           KRSSM     READE@BKCPGY                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0242' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT                     *QUIT
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c2 AND c3
      *   |- c2    : PAR.Bank Code EQ DB1.Bank Code
      *   |- c3    : PAR.Deposit Date EQ DB1.Deposit Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1G4CD    IFEQ WLG4CD                     *IF
     C           P1HXDT    IFEQ WLHXDT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Bank G/L           RT - Bank Master  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1G4CD    WL0001    P      Bank Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    WN0101    P      G/L Alpha Code
      * Val G/L Act Cde 2 HPE XF - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'PKVBXFR'              90  Val G/L Act Cde
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WUAIC3    WQ0036  30       Company Number
     C                     PARM WN0101    WQ0037  8        G/L Account Cod
     C           WUIYTX    PARM *BLANK    WQ0038 25        G/L Code Desc U
     C           WN0100    PARM *BLANK    WQ0039  8        G/L Account Id
     C                     PARM WUAT1U    WQ0040  3        G/L Account Typ
     C                     PARM WUAT2U    WQ0041  3        G/L Account Typ
     C           WUWXST    PARM *BLANK    WQ0042  1        Record Found US
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKVBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Write A/R Posting and Report file record from Non A/R Cash
     C                     ADD  1         WN0102           Next On Acct Ca
     C                     Z-ADDWN0102    WUCONB           Invoice Number
      * RMC OMS036 12/23/05 get g/l posting co
      * VAL Acct ID JDE-8 dgt  UP - STR Hog Prcr & Eval Sys  * 
     C                     CALL 'ARACTRET'             90  VAL Acct ID JDE
     C                     PARM WLIZTX    WQ0043  8        G/L ID Code Alp
     C                     PARM *BLANK    WQ0044 12        Cost Center. .
     C                     PARM *BLANK    WQ0045  6        Object Account
     C                     PARM *BLANK    WQ0046  8        Subsidiary . .
     C                     PARM *BLANK    WQ0047 30        Description
     C           WN0099    PARM *ZERO     WQ0048  30       G/L Posting Com
     C                     PARM *BLANK    WQ0049  1        JDE Posting Edi
     C                     PARM *BLANK    WQ0050  7        Error Return te
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'ARACTRET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * ** Set subledger code to zeros                        E000512
     C                     Z-ADD*ZERO     YL0005           G/L Sub-Ledger
      * CRT Post/Report G/L    CR - A/R Posting and Reporting  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0001    WL0003           Company Number
     C                     MOVELP1G4CD    WL0004    P      Bank Code
     C                     Z-ADDP1HXDT    WL0005           Deposit Date
     C                     Z-ADD*ZERO     WL0006           A/R Customer Nu
     C                     Z-ADDWUCONB    WL0007           Invoice Number
     C                     MOVEL'NA'      WL0008    P      Invoice Suffix
     C                     Z-ADD*ZERO     WL0009           Sequence Number
     C                     MOVELWLUHCD    WL0010    P      Adjustment Type
     C                     Z-ADDWLBSVA    WL0011           Transaction Amo
     C                     MOVELWLCPTX    WL0012    P      A/R Check Numbe
     C                     Z-ADDWN0099    WL0013           G/L Posting Com
     C                     MOVELWLIZTX    WL0014    P      G/L ID Code JDE
     C                     Z-ADDP1HXDT    WL0015           Last Payment Da
     C                     Z-ADD*ZERO     WL0016           Due Date
     C                     Z-ADD*ZERO     WL0017           Order Number
     C                     MOVELWLEAZT    WL0018    P      Effect Cust. Ac
     C                     MOVELWLNGNA    WL0019    P      Explanation
     C                     MOVELWLUJCD    WL0020    P      Reference Field
     C                     MOVELP1AJST    WL0021    P      A/R Processing
     C                     MOVEL'N'       WL0022    P      Originating Fil
     C                     Z-ADDWLCKNB    WL0023           G/L Document Nu
     C                     Z-ADD*ZERO     WL0024           Post to G/L Dat
     C                     MOVELWN0100    WL0025    P      Bank G/L ID Cod
     C                     Z-ADDYL0005    WL0026           G/L Sub-Ledger
     C                     MOVELWLUVST    WL0027    P      EDI Status 1
     C                     MOVELWLUWST    WL0028    P      EDI Status 2
     C                     MOVELWLUXST    WL0029    P      EDI Status 3
     C                     MOVEL'A'       WL0030    P      Record Status
     C                     Z-ADDWLAATM    WL0031           Job Time
     C                     MOVELWLAYNA    WL0032    P      User Id
     C                     MOVELWLA0NA    WL0033    P      Job Name
     C                     Z-ADDWLAXDT    WL0034           Job Date
     C                     EXSR SFCRRC
      * Update A/R Non A/R Cash Record - A/R Processing Code
      * OMS036 RMC 4/4/05 If update status is yes
      * CASE: PAR.Status - Y or N is yes
     C           P3B8ST    IFEQ 'Y'                        *IF
      * CHG A/R Processing Cde CH - A/R Non A/R Cash  * 
     C                     EXSR SUCHRC
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@BKCPGY                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Next on Account #  RT - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0103  70       USR Next on Acc
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMAIC3           Company Number
      * Setup key
     C                     Z-ADD*ZERO     WMAIC3           Company Number
      * Establish starting position
     C           KRSSN     CHAIN@ASREVL              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWMI6NB    WN0102           Next On Acct Ca
     C                     GOTO SNEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WOAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0104    WOAJVN           User Profile Na
      * Establish starting position
     C           KRSSO     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOAIC3    YL0002           Company Number
     C                     MOVELWOBUVN    WN0105           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WRAJVN           User Profile Na
     C                     KFLD           WRDNCD           Application Cod
      * Setup key
     C                     MOVELWL0035    WRAJVN           User Profile Na
     C                     MOVELWL0036    WRDNCD           Application Cod
      * Establish starting position
     C           KRSSP     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRAIC3    WL0037           Company Number
     C                     MOVELWRAJCD    WL0038           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Prod Whse for Co  RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSBWC3    WQSQ01           Shipping Compan
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Shipping Compan
      * Setup key
     C                     Z-ADDYL0004    WQSQ01           Shipping Compan
      * Establish starting position
     C           KRSSQ     SETLL@ADREWA                    *
     C           KRSSQ     READE@ADREWA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WSVSST    IFEQ 'A'                        *IF
      * CASE: DB1.Production Warehouse Code is Warehouse Code not Blank
     C           WSAOCD    IFNE *BLANK                     *IF
     C                     MOVELWSAOCD    YN0006           Warehouse Code
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@ADREWA                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WTAIC3           Company Number
      * Setup key
     C                     Z-ADDWUAIC3    WTAIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVDNCD    WQSS01           Application Cod
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSS01           Application Cod
     C                     MOVEL'A/R'     WQSS01           Application Cod
      * Establish starting position
     C           KRSSS     SETLL@DNRESF                    *
     C           KRSSS     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WVRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWVAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     C           KRSSS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVDNCD    WQST01           Application Cod
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           Application Cod
      * Setup key
     C                     MOVELWVRSCD    WQST01           Application Cod
      * Establish starting position
     C           KRSST     SETLL@DNRESF                    *
     C           KRSST     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVAUNA    WUAUNA           Description
     C           KRSST     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG A/R Processing Cde CH - A/R Non A/R Cash  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0106  3        Adjustment Type
     C                     Z-ADD*ZERO     WN0107 112       Transaction Amo
     C                     MOVEL*BLANK    WN0108 10        A/R Check Numbe
     C                     MOVEL*BLANK    WN0109 30        Explanation
     C                     Z-ADD*ZERO     WN0110  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0111  70       G/L Post Date
     C                     Z-ADD*ZERO     WN0112  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0113  1        Effect on Accou
     C                     MOVEL*BLANK    WN0114  1        EDI Status 1
     C                     MOVEL*BLANK    WN0115  1        EDI Status 2
     C                     MOVEL*BLANK    WN0116  1        EDI Status 3
     C                     MOVEL*BLANK    WN0117  1        Record Status
     C                     Z-ADD*ZERO     WN0118  60       Job Time
     C                     MOVEL*BLANK    WN0119 10        User Id
     C                     MOVEL*BLANK    WN0120 10        Job Name
     C                     Z-ADD*ZERO     WN0121  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BKCPGX
     C                     MOVELWLG4CD    WWG4CD    P      Bank Code
     C                     Z-ADDWLHXDT    WWHXDT           Deposit Date
     C                     Z-ADDWLYXNX    WWYXNX           Deposit Time
     C                     MOVELWLUJCD    WWUJCD    P      Reference Field
      *
     C           KLCHSU    KLIST
     C                     KFLD           WWG4CD           Bank Code
     C                     KFLD           WWHXDT           Deposit Date
     C                     KFLD           WWYXNX           Deposit Time
     C                     KFLD           WWUJCD           Reference Field
     C           KLCHSU    CHAIN@BKCPGX              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'ARBKCPL0'MDACP
     C                     MOVEL'@BKCPGX' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QARBK1    YCRDCS
      * Move non-key fields to @BKCPGX
     C                     Z-ADDWLAIC3    WWAIC3           Company Number
     C                     MOVELP1AJST    WWAJST    P      A/R Processing
     C                     MOVELWLIZTX    WWIZTX    P      G/L ID Code JDE
      *
      * Set PGM.*Record Data Changed flag
     C           QARBK1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BKCPGX                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKARBKCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Chg Process Code   RT - A/R Bank Deposit  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAG4CD    WQSV02           Bank Code
     C           *LIKE     DEFN WAHXDT    WQSV03           Deposit Date
     C           *LIKE     DEFN WAYXNX    WQSV04           Deposit Time
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV02           Bank Code
     C                     KFLD           WQSV03           Deposit Date
     C                     KFLD           WQSV04           Deposit Time
      * Setup key
     C                     MOVELP1G4CD    WQSV02           Bank Code
     C                     Z-ADDP1HXDT    WQSV03           Deposit Date
     C                     Z-ADDP1YXNX    WQSV04           Deposit Time
      * Establish starting position
     C           KRSSV     SETLL@J2CPCU                    *
     C           KRSSV     READE@J2CPCU                  90*
      * Data record not found
     C   90                MOVEL'USR2039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.A/R Processing Status is Avail. and Posted
     C           WAAJST    IFEQ 'A'                        *IF
     C           WAAJST    OREQ 'P'
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Process Code       CH - A/R Bank Deposit  * 
     C                     EXSR SWCHRC
     C                     END                             *FI
     C           KRSSV     READE@J2CPCU                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCHRC    BEGSR
      *================================================================
      * CHG Process Code       CH - A/R Bank Deposit  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0122 112       Deposit Amount
     C                     Z-ADD*ZERO     WN0123 112       Total Cash Appl
     C                     Z-ADD*ZERO     WN0124  80       G/L Document Nu
     C                     Z-ADD*ZERO     WN0125  50       Number of Depos
     C                     Z-ADD*ZERO     WN0126  50       Number of Appli
     C                     Z-ADD*ZERO     WN0127  70       G/L Post Date
     C                     MOVEL*BLANK    WN0128  1        EDI Status 1
     C                     MOVEL*BLANK    WN0129  1        EDI Status 2
     C                     MOVEL*BLANK    WN0130  1        EDI Status 3
     C                     MOVEL*BLANK    WN0131  1        Record Status
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @J2CPCM
     C                     MOVELP1G4CD    WXG4CD    P      Bank Code
     C                     Z-ADDP1HXDT    WXHXDT           Deposit Date
     C                     Z-ADDP1YXNX    WXYXNX           Deposit Time
      *
     C           KLCHSW    KLIST
     C                     KFLD           WXG4CD           Bank Code
     C                     KFLD           WXHXDT           Deposit Date
     C                     KFLD           WXYXNX           Deposit Time
     C           KLCHSW    CHAIN@J2CPCM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJ2CPL0'MDACP
     C                     MOVEL'@J2CPCM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDJ21    YDRDCS
      * Move non-key fields to @J2CPCM
     C                     MOVELP1AJST    WXAJST    P      A/R Processing
     C                     Z-ADDWAE2VL    WXE2VL           CD TF Internal
     C                     Z-ADDWAE3VL    WXE3VL           CD TF Immediate
     C                     Z-ADDWAE4VL    WXE4VL           CD TF 1 Day Fun
     C                     Z-ADDWAE5VL    WXE5VL           CD TF 2 Day Fun
     C                     Z-ADDWAE6VL    WXE6VL           CD SB Exempt Im
     C                     Z-ADDWAE7VL    WXE7VL           CD SB 1 Day Exe
     C                     Z-ADDWAE8VL    WXE8VL           CD SB 2 Day Exe
     C                     Z-ADDWAE9VL    WXE9VL           SBD Exempt Tota
     C                     Z-ADDWAFAVL    WXFAVL           ARBD Unused Amt
     C                     Z-ADDWAFBVL    WXFBVL           ARBD Unused Amt
     C                     Z-ADDWAFCVL    WXFCVL           ARBD Unused Amt
     C                     Z-ADDWAFDVL    WXFDVL           ARBD Unused Amt
      *
      * Set PGM.*Record Data Changed flag
     C           QPDJ21    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@J2CPCM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDJ2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and comments
      *================================================================
      * ** 02/09/2010 LJB E000512  Default Sub Ledger to Zeros
      * **
      * Get Temporary OA number to use for Reporting file only
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1UIVA           Deposit Amount
     C                     Z-ADD*ZERO     P1UJVA           Total Cash Appl
     C                     Z-ADD*ZERO     P1BHNB           Number of Depos
     C                     Z-ADD*ZERO     P1BINB           Number of Appli
     C                     Z-ADD*ZERO     P2U8VA           USR Remaining B
     C                     MOVEL*BLANK    P3G3TX           PRT Description
     C                     MOVEL*BLANK    P3WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P3WSST           PRT Hold Output
     C                     MOVEL*BLANK    P3WTST           PRT Save Output
     C                     Z-ADD*ZERO     P3DYNB           PRT Number of C
     C                     MOVEL*BLANK    P3BVVN           PRT Night Queue
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHXDT           Deposit Date
     C                     Z-ADD*ZERO     WAYXNX           Deposit Time
     C                     Z-ADD*ZERO     WAUIVA           Deposit Amount
     C                     Z-ADD*ZERO     WAUJVA           Total Cash Appl
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WABHNB           Number of Depos
     C                     Z-ADD*ZERO     WABINB           Number of Appli
     C                     Z-ADD*ZERO     WAE2VL           CD TF Internal
     C                     Z-ADD*ZERO     WAE3VL           CD TF Immediate
     C                     Z-ADD*ZERO     WAE4VL           CD TF 1 Day Fun
     C                     Z-ADD*ZERO     WAE5VL           CD TF 2 Day Fun
     C                     Z-ADD*ZERO     WAE6VL           CD SB Exempt Im
     C                     Z-ADD*ZERO     WAE7VL           CD SB 1 Day Exe
     C                     Z-ADD*ZERO     WAE8VL           CD SB 2 Day Exe
     C                     Z-ADD*ZERO     WAE9VL           SBD Exempt Tota
     C                     Z-ADD*ZERO     WAFAVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WAFBVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WAFCVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WAFDVL           ARBD Unused Amt
     C                     Z-ADD*ZERO     WAHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBDXNB           Sequence Number
     C                     Z-ADD*ZERO     WBBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBDVDT           Payment/Deposit
     C                     Z-ADD*ZERO     WBYXNX           Deposit Time
     C                     Z-ADD*ZERO     WBHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WBQHDT           TFS Adj Week-En
     C                     Z-ADD*ZERO     WBQIDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBQJDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBQKDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBQLDT           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WBGMVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBGNVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBGOVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBGPVL           A/R Dtl UnUsed
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCD4C7           Bank LckBx Numb
     C                     Z-ADD*ZERO     WCD5C7           Bank Default Co
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field G/L Code Desc USR
     C                     MOVEL*BLANK    WUIYTX 25
      * Define work field G/L Account Type 1 USR
     C                     MOVEL*BLANK    WUAT1U  3
      * Define work field G/L Account Type 2 USR
     C                     MOVEL*BLANK    WUAT2U  3
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUWXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WDAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WDAOVA           Amount Paid
     C                     Z-ADD*ZERO     WDBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDCAC7           Order Number Re
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WDATDT           Due Date
     C                     Z-ADD*ZERO     WDH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WDH3DT           Unused Date Cod
     C                     Z-ADD*ZERO     WDH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WDH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBSDY           Days to Pay
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEUKVA           Adjustment Limi
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    WUHNST  1
      * Define work field Error Return text
     C                     MOVEL*BLANK    WUUNCD  7
      * Define work field G/L Sub-Ledger Code
     C                     Z-ADD*ZERO     WUGLVL 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHXDT           Deposit Date
     C                     Z-ADD*ZERO     WFANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WFCONB           Invoice Number
     C                     Z-ADD*ZERO     WFDXNB           Sequence Number
     C                     Z-ADD*ZERO     WFBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WFC1NY           G/L Posting Com
     C                     Z-ADD*ZERO     WFH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WFATDT           Due Date
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WFBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WFGLVL           G/L Sub-Ledger
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHCONB           Invoice Number
     C                     Z-ADD*ZERO     WHHXDT           Deposit Date
     C                     Z-ADD*ZERO     WHYXNX           Deposit Time
      * Define work field A/R Processing Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    WUMCUX 12
      * Define work field Object Account . . . . .
     C                     MOVEL*BLANK    WUOBJX  6
      * Define work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    WUSUBX  8
      * Define work field Sequence Number
     C                     Z-ADD*ZERO     WUDXNB  30
      * Define work field EDI Status 1
     C                     MOVEL*BLANK    WUUVST  1
      * Define work field EDI Status 2
     C                     MOVEL*BLANK    WUUWST  1
      * Define work field EDI Status 3
     C                     MOVEL*BLANK    WUUXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHXDT           Deposit Date
     C                     Z-ADD*ZERO     WLYXNX           Deposit Time
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WLB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WLHYDT           G/L Post Date
     C                     Z-ADD*ZERO     WLCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMAXNB           Current Account
     C                     Z-ADD*ZERO     WMNGNB           Current Account
     C                     Z-ADD*ZERO     WMBZNB           OM Week
     C                     Z-ADD*ZERO     WMC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WMC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WMCYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WMIONB           Next Late Charg
     C                     Z-ADD*ZERO     WMI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WMDCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WMC7NB           Next Customer #
     C                     Z-ADD*ZERO     WMC2NB           Next Inventory
     C                     Z-ADD*ZERO     WMC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WML8NB           Next Contract/P
     C                     Z-ADD*ZERO     WMBANB           Next HPB Batch
     C                     Z-ADD*ZERO     WMAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WMASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WMA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WMAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WMABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WMACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WMADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WMAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WMAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WMAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WMAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WMAENB           Retention Perio
     C                     Z-ADD*ZERO     WMALNB           Retention Perio
     C                     Z-ADD*ZERO     WMEVNB           Retention Perio
     C                     Z-ADD*ZERO     WMRPOP           Retention Perio
     C                     Z-ADD*ZERO     WMDWNB           Retention Perio
     C                     Z-ADD*ZERO     WMR3NB           Next Load ID
     C                     Z-ADD*ZERO     WMR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WMSCNB           Production Numb
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field Company Number
     C                     Z-ADD*ZERO     WUAIC3  30
      * Define work field Access Denied (Y/N)
     C                     MOVEL*BLANK    WUWVST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WONLNB           Entity Number
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WSBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WSBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WSBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WSBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAIC3           Company Number
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Invoice Number
     C                     Z-ADD*ZERO     WUCONB  70
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  6
     C                     MOVEL*BLANK    WL0002  8
      * Define local variables for subroutine SFCRRC.
     C                     Z-ADD*ZERO     WL0003  30
     C                     MOVEL*BLANK    WL0004  6
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  70
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  2
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  3
     C                     Z-ADD*ZERO     WL0011 112
     C                     MOVEL*BLANK    WL0012 10
     C                     Z-ADD*ZERO     WL0013  30
     C                     MOVEL*BLANK    WL0014  8
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  1
     C                     MOVEL*BLANK    WL0019 30
     C                     MOVEL*BLANK    WL0020 15
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     Z-ADD*ZERO     WL0023  80
     C                     Z-ADD*ZERO     WL0024  70
     C                     MOVEL*BLANK    WL0025  8
     C                     Z-ADD*ZERO     WL0026 112
     C                     MOVEL*BLANK    WL0027  1
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     Z-ADD*ZERO     WL0031  60
     C                     MOVEL*BLANK    WL0032 10
     C                     MOVEL*BLANK    WL0033 10
     C                     Z-ADD*ZERO     WL0034  70
      * Define local variables for subroutine SPRVGN.
     C                     MOVEL*BLANK    WL0035 10
     C                     MOVEL*BLANK    WL0036  6
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038  3
      * Define null work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    YN0001 12
      * Define null work field Object Account . . . . .
     C                     MOVEL*BLANK    YN0002  6
      * Define null work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    YN0003  8
      * Define null work field Description
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Description
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0006  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define null work field Salesperson Code
     C                     MOVEL*BLANK    YN0007  3
      * Define null work field Allow Multi-Company
     C                     MOVEL*BLANK    YN0008  1
      * Define null work field Default Printer
     C                     MOVEL*BLANK    YN0009 10
      * Define null work field Name
     C                     MOVEL*BLANK    YN0010 30
      * Define null work field System Value Alpha
     C                     MOVEL*BLANK    YN0011 40
      * Define null work field Access Denied (Y/N)
     C                     MOVEL*BLANK    YN0012  1
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0004  30
      * Define null work field Cost Center. . . . . . .
     C                     MOVEL*BLANK    YN0013 12
      * Define null work field Object Account . . . . .
     C                     MOVEL*BLANK    YN0014  6
      * Define null work field Subsidiary . . . . . . .
     C                     MOVEL*BLANK    YN0015  8
      * Define null work field Description
     C                     MOVEL*BLANK    YN0016 30
      * Define null work field JDE Posting Edit Code USR
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Error Return text
     C                     MOVEL*BLANK    YN0018  7
      * Define local work field G/L Sub-Ledger Code
     C                     Z-ADD*ZERO     YL0005 112
      *================================================================
     CSR         ZZEXIT    ENDSR
