     H/TITLE Cvt Crcs Dtl/Inchmm       Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:14:17
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB1CPL6IF  E           K        DISK
      * RSQ : Carcass Detail            Co/KDte/Tto/Ln%
      *
     FPKB1CPL0UF  E           K        DISK
      * UPD : Carcass Detail            Update index
      *
     I@B1CPO8
      * Carcass Detail            Co/KDte/Tto/Ln%
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WBHMNB
     I              B1BNNB                          WBBNNB
     I              B1BONB                          WBBONB
     I              B1CVNB                          WBCVNB
     I              B1B0DT                          WBB0DT
     I              B1LGNB                          WBLGNB
     I              B1EUNB                          WBEUNB
     I              B1LHNB                          WBLHNB
     I              B1INST                          WBINST
     I              B1BEPR                          WBBEPR
     I              B1ASPC                          WBASPC
     I              B1EWNB                          WBEWNB
     I              B1B4PR                          WBB4PR
     I              B1EYNB                          WBEYNB
     I              B1B1PR                          WBB1PR
     I              B1AVPR                          WBAVPR
     I              B1AUPC                          WBAUPC
     I              B1AWPR                          WBAWPR
     I              B1AXPR                          WBAXPR
     I              B1EZNB                          WBEZNB
     I              B1AYPR                          WBAYPR
     I              B1BBDT                          WBBBDT
     I              B1AKTM                          WBAKTM
     I              B1IQST                          WBIQST
     I              B1EFST                          WBEFST
     I              B1H6NB                          WBH6NB
     I              B1BEPC                          WBBEPC
     I              B1GCST                          WBGCST
     I              B1GDST                          WBGDST
     I              B1GEST                          WBGEST
     I              B1BHPC                          WBBHPC
     I              B1IOST                          WBIOST
     I              B1IPST                          WBIPST
     I              B1LTNB                          WBLTNB
     I              B1JNST                          WBJNST
     I              B1X4NB                          WBX4NB
     I              B1FNPC                          WBFNPC
     I              B1FOPC                          WBFOPC
     I              B1FPPC                          WBFPPC
     I              B1K2ST                          WBK2ST
     I              B1K3ST                          WBK3ST
     I              B1JWPR                          WBJWPR
     I              B1F5PC                          WBF5PC
     I              B1JXPR                          WBJXPR
     I              B1JYPR                          WBJYPR
     I              B1JZPR                          WBJZPR
     I              B1J0PR                          WBJ0PR
     I              B1J1PR                          WBJ1PR
     I              B1J2PR                          WBJ2PR
     I              B1J3PR                          WBJ3PR
     I              B1J4PR                          WBJ4PR
     I              B1UTST                          WBUTST
     I              B1HVCD                          WBHVCD
     I              B1DKJR                          WBDKJR
     I              B1ITJF                          WBITJF
     I              B1IJGR                          WBIJGR
     I              B1ORJE                          WBORJE
     I              B1OTJR                          WBOTJR
     I              B1PEIR                          WBPEIR
     I              B1IEUF                          WBIEUF
     I              B1ORUE                          WBORUE
     I              B1IUTR                          WBIUTR
     I              B1IJRR                          WBIJRR
     I              B1VCST                          WBVCST
     I              B1VDST                          WBVDST
     I              B1VEST                          WBVEST
     I              B1VFST                          WBVFST
     I              B1VGST                          WBVGST
     I              B1ABCD                          WBABCD
     I              B1AACD                          WBAACD
     I              B1AAVN                          WBAAVN
     I              B1AADT                          WBAADT
     I              B1AMTM                          WBAMTM
     I              B1AJST                          WBAJST
     I              B1AHVN                          WBAHVN
     I              B1AGVN                          WBAGVN
     I              B1ABVN                          WBABVN
     I              B1ABDT                          WBABDT
     I              B1ABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WBHMNB
     I              B1BNNB                          WBBNNB
     I              B1BONB                          WBBONB
     I              B1CVNB                          WBCVNB
     I              B1B0DT                          WBB0DT
     I              B1LGNB                          WBLGNB
     I              B1EUNB                          WBEUNB
     I              B1LHNB                          WBLHNB
     I              B1INST                          WBINST
     I              B1BEPR                          WBBEPR
     I              B1ASPC                          WBASPC
     I              B1EWNB                          WBEWNB
     I              B1B4PR                          WBB4PR
     I              B1EYNB                          WBEYNB
     I              B1B1PR                          WBB1PR
     I              B1AVPR                          WBAVPR
     I              B1AUPC                          WBAUPC
     I              B1AWPR                          WBAWPR
     I              B1AXPR                          WBAXPR
     I              B1EZNB                          WBEZNB
     I              B1AYPR                          WBAYPR
     I              B1BBDT                          WBBBDT
     I              B1AKTM                          WBAKTM
     I              B1IQST                          WBIQST
     I              B1EFST                          WBEFST
     I              B1H6NB                          WBH6NB
     I              B1BEPC                          WBBEPC
     I              B1GCST                          WBGCST
     I              B1GDST                          WBGDST
     I              B1GEST                          WBGEST
     I              B1BHPC                          WBBHPC
     I              B1IOST                          WBIOST
     I              B1IPST                          WBIPST
     I              B1LTNB                          WBLTNB
     I              B1JNST                          WBJNST
     I              B1X4NB                          WBX4NB
     I              B1FNPC                          WBFNPC
     I              B1FOPC                          WBFOPC
     I              B1FPPC                          WBFPPC
     I              B1K2ST                          WBK2ST
     I              B1K3ST                          WBK3ST
     I              B1JWPR                          WBJWPR
     I              B1F5PC                          WBF5PC
     I              B1JXPR                          WBJXPR
     I              B1JYPR                          WBJYPR
     I              B1JZPR                          WBJZPR
     I              B1J0PR                          WBJ0PR
     I              B1J1PR                          WBJ1PR
     I              B1J2PR                          WBJ2PR
     I              B1J3PR                          WBJ3PR
     I              B1J4PR                          WBJ4PR
     I              B1UTST                          WBUTST
     I              B1HVCD                          WBHVCD
     I              B1DKJR                          WBDKJR
     I              B1ITJF                          WBITJF
     I              B1IJGR                          WBIJGR
     I              B1ORJE                          WBORJE
     I              B1OTJR                          WBOTJR
     I              B1PEIR                          WBPEIR
     I              B1IEUF                          WBIEUF
     I              B1ORUE                          WBORUE
     I              B1IUTR                          WBIUTR
     I              B1IJRR                          WBIJRR
     I              B1VCST                          WBVCST
     I              B1VDST                          WBVDST
     I              B1VEST                          WBVEST
     I              B1VFST                          WBVFST
     I              B1VGST                          WBVGST
     I              B1ABCD                          WBABCD
     I              B1AACD                          WBAACD
     I              B1AAVN                          WBAAVN
     I              B1AADT                          WBAADT
     I              B1AMTM                          WBAMTM
     I              B1AJST                          WBAJST
     I              B1AHVN                          WBAHVN
     I              B1AGVN                          WBAGVN
     I              B1ABVN                          WBABVN
     I              B1ABDT                          WBABDT
     I              B1ABTM                          WBABTM
      *
     IYARDCS      DS                            267
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I : MAP First Time Flag Usr
     I                                        1   1 P1HBST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HBST    PARM           WP0001  1        First Time Flag
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Cvt Crcs Dtl/Inchmm
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      * Cvt Crcs Dtl/incmmlp - Carcass Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Cvt Crcs Dtl/incmmlp - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WAB0DT           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
      * Setup key
     C                     Z-ADD360       WQSA01           BOH Company Num
     C                     Z-ADD1000214   WAB0DT           TH Kill Date
      * Establish starting position
     C           KPSSA     SETLL@B1CPO8                    *
     C           KRSSA     READE@B1CPO8                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Add
     C           WAINST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       WUM0ST           Calculate All U
      * Clc Inch to MM/Lean%FOM - Carcass Detail  * 
     C                     CALL 'PKINMMLP'             90  Clc Inch to MM/
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAAUPC    WQ0001  31       CD Lean Percent
     C                     PARM WAH6NB    WQ0002  31       CD Backfat Thic
     C                     PARM WABEPC    WQ0003  31       CD Loin-Eye Dep
     C                     PARM WAGCST    WQ0004  31       CD Light Reflec
     C           WUX4NB    PARM WUX4NB    WQ0005  31       CD Backfat Thic
     C           WUFNPC    PARM WUFNPC    WQ0006  31       CD Loin-Eye Dep
     C           WUFOPC    PARM WUFOPC    WQ0007  31       CD Light Reflec
     C           WUFPPC    PARM WUFPPC    WQ0008  31       CD Lean Percent
     C           WUM0ST    PARM WUM0ST    WQ0009  1        Calculate All U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKINMMLP'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Chg Carc Dtl Inch     CH - Carcass Detail  * 
     C                     EXSR SBCHRC
     C                     END                             *FI
     C           KRSSA     READE@B1CPO8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Carc Dtl Inch     CH - Carcass Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        CD Record Add/D
     C                     Z-ADD*ZERO     WN0002  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0003  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0004  51       CD Carcass/Hot
     C                     Z-ADD*ZERO     WN0005  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0006  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0007  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0008  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0009  31       CD Lean Percent
     C                     Z-ADD*ZERO     WN0010  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0011  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0012  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0013  72       CD Gross Value
     C                     Z-ADD*ZERO     WN0014  70       CD Kill Date
     C                     Z-ADD*ZERO     WN0015  60       CD Kill Time
     C                     MOVEL*BLANK    WN0016  1        CD Shift
     C                     MOVEL*BLANK    WN0017  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0018  1        CD Trim Area
     C                     MOVEL*BLANK    WN0019  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0020  31       CD FFLI
     C                     MOVEL*BLANK    WN0021  1        CD Record Creat
     C                     MOVEL*BLANK    WN0022  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0023  50       CD LOT
     C                     MOVEL*BLANK    WN0024  1        CD User Error O
     C                     MOVEL*BLANK    WN0025  1        CD Source Type
     C                     MOVEL*BLANK    WN0026  1        CD Payment Type
     C                     MOVEL*BLANK    WN0027  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0028  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0029  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0030  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0031  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0032  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0033  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0034  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0035  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0036  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0037  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0038  72       CD Gross Before
     C                     MOVEL*BLANK    WN0039  1        CD Broken Back
     C                     MOVEL*BLANK    WN0040  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0041  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0042  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0043  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0044  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0045  3        SR Source Code
     C                     MOVEL*BLANK    WN0046 10        RS User Changed
     C                     Z-ADD*ZERO     WN0047  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0048  60       RS Time Changed
     C                     MOVEL*BLANK    WN0049  1        RS Record Statu
     C                     MOVEL*BLANK    WN0050 10        RS Job
     C                     MOVEL*BLANK    WN0051 10        RS Program
     C                     MOVEL*BLANK    WN0052 10        RS User Added
     C                     Z-ADD*ZERO     WN0053  70       RS Date Added
     C                     Z-ADD*ZERO     WN0054  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1CPG6
     C                     Z-ADDWAHMNB    WBHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WBBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WBBONB           BOL Load Number
     C                     Z-ADDWACVNB    WBCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WBB0DT           TH Kill Date
     C                     Z-ADDWALGNB    WBLGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    WBEUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    WBLHNB           CD Carcass Numb
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHMNB           BOH Company Num
     C                     KFLD           WBBNNB           BOH Buy Order N
     C                     KFLD           WBBONB           BOL Load Number
     C                     KFLD           WBCVNB           TH Tattoo Numbe
     C                     KFLD           WBB0DT           TH Kill Date
     C                     KFLD           WBLGNB           CD Scale Sequen
     C                     KFLD           WBEUNB           CD Carcass Numb
     C                     KFLD           WBLHNB           CD Carcass Numb
     C           KLCHSB    CHAIN@B1CPG6              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB1CPL0'MDACP
     C                     MOVEL'@B1CPG6' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKB11    YARDCS
      * USER: Processing after Data read
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WBAAVN           RS User Changed
     C                     Z-ADD##JDT     WBAADT           RS Date Changed
     C                     Z-ADD##JTM     WBAMTM           RS Time Changed
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
      * Move non-key fields to @B1CPG6
     C                     Z-ADDWAH6NB    WBH6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    WBBEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    WBGCST           CD Light Reflec
     C                     Z-ADDWUX4NB    WBX4NB           CD Backfat Thic
     C                     Z-ADDWUFNPC    WBFNPC           CD Loin-Eye Dep
     C                     Z-ADDWUFOPC    WBFOPC           CD Light Reflec
     C                     Z-ADDWUFPPC    WBFPPC           CD Lean Percent
     C                     Z-ADDWAJWPR    WBJWPR           CD CA Sort Loss
     C                     Z-ADDWAF5PC    WBF5PC           CD CA Std Yield
     C                     Z-ADDWAJXPR    WBJXPR           CD CA Base Carc
     C                     Z-ADDWAJYPR    WBJYPR           CD CA Crc Value
     C                     Z-ADDWAJZPR    WBJZPR           CD CA Base Carc
     C                     Z-ADDWAJ0PR    WBJ0PR           CD CA Crc Value
     C                     Z-ADDWAJ1PR    WBJ1PR           CD CA Lean Prem
     C                     Z-ADDWAJ2PR    WBJ2PR           CD CA Lean Prem
     C                     Z-ADDWAJ3PR    WBJ3PR           CD CA Gross Val
     C                     Z-ADDWAJ4PR    WBJ4PR           CD CA Gross Val
      *
      * Set PGM.*Record Data Changed flag
     C           QPKB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1CPG6                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKB1CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Calculate All Usr
     C                     MOVEL*BLANK    WUM0ST  1
      * Define work field CD Backfat Thickness MM
     C                     Z-ADD*ZERO     WUX4NB  31
      * Define work field CD Loin-Eye Depth MM
     C                     Z-ADD*ZERO     WUFNPC  31
      * Define work field CD Light Reflectance MM
     C                     Z-ADD*ZERO     WUFOPC  31
      * Define work field CD Lean Percent MM
     C                     Z-ADD*ZERO     WUFPPC  31
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
