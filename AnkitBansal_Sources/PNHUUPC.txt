/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PNHUUPC                                       */
/*  PROGRAM NAME:    BUILD MANUAL/FORMULA PRICING WORK FILE        */
/*  PROGRAMMER:      LARA BUSER                                    */
/*  CREATE DATE:     04/27/2009                                    */
/*                                                                 */
/*  FUNCTION:        THIS CL IS CALLED FROM A PROMPT AND           */
/*                   BUILDS A WORK FILE IN QTEMP THAT WILL BE      */
/*                   DOWNLOADED TO AN EXCEL SPREADSHEET.           */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*  SHARON ZURN  02/12/10    ADD PARMS CUSTOMER & ITEM.            */
/*******************************************************************/
 PNHUUPC:    PGM        PARM(&RTNCODE &COMPN &CUSTN &FDATEN &TDATEN +
                          &ITEMN &EMAIL &EMAILFMT)

/*-----------------------------------------------------------------*/
/* PARAMETERS                                                      */
/*-----------------------------------------------------------------*/
             DCL        VAR(&RTNCODE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&COMPN) TYPE(*DEC)
             DCL        VAR(&COMP) TYPE(*DEC) LEN(3 0)
             DCL        VAR(&CUSTN) TYPE(*DEC)
             DCL        VAR(&CUST) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&FDATEN) TYPE(*DEC)
             DCL        VAR(&FDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&FDATEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TDATEN) TYPE(*DEC)
             DCL        VAR(&TDATE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&TDATEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&ITEMN) TYPE(*DEC)
             DCL        VAR(&ITEM) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMAILFMT) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TEXT)  TYPE(*CHAR) LEN(100)
             DCL        VAR(&USRNAME) TYPE(*CHAR) LEN(10)

/*  Create WF IN QTEMP                                             */
             CRTDUPOBJ  OBJ(PNFGCPP) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP) CST(*NO) TRG(*NO)
             MONMSG     MSGID(CPF0000)
             CLRPFM     FILE(PNFGCPP)
             CRTDUPOBJ  OBJ(PNFGCPL0) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(PNFGCPL1) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             MONMSG     MSGID(CPF0000)
             CRTDUPOBJ  OBJ(PNFGCPL2) FROMLIB(*LIBL) OBJTYPE(*FILE) +
                          TOLIB(QTEMP)
             MONMSG     MSGID(CPF0000)

/*-----------------------------------------------------------------*/
             CHGVAR     VAR(&FDATE) VALUE(&FDATEN)
             CHGVAR     VAR(&TDATE) VALUE(&TDATEN)
             CHGVAR     VAR(&COMP) VALUE(&COMPN)
             CHGVAR     VAR(&CUST) VALUE(&CUSTN)
             CHGVAR     VAR(&ITEM) VALUE(&ITEMN)

             CALL       PGM(PNHSXFR) PARM(&RTNCODE &COMP &FDATE +
                          &TDATE &CUST &ITEM)
 /********   CPYF       FROMFILE(PNFGCPP) +
                          TOFILE(OMSDEVGEN/PNFGCPPSV) +
                          MBROPT(*REPLACE) CRTFILE(*YES)  ********/
             MONMSG     MSGID(CPF0000)

/*  Send WF TO AN EXCEL SPREADSHEET                                */
             CHGVAR     VAR(&FDATEA) VALUE(&FDATE)
             CHGVAR     VAR(&TDATEA) VALUE(&TDATE)
             CHGVAR     VAR(&TEXT) VALUE('Manual vs Formula Pricing +
                          Download for' *BCAT &FDATEA *BCAT +
                          'through' *BCAT &TDATEA)
             EXECUTE    VIEW(*LIBL/PNFGCPPA) PCFMT(*XLS) +
                          REPLACE(*YES) RECIPIENT(&EMAIL) EMLMSG(&TEXT)

             RTVUSRPRF  RTNUSRPRF(&USRNAME)
             SNDMSG     MSG('Manual vs Formula Pricing Download has +
                          completed') TOUSR(&USRNAME)

             ENDPGM
