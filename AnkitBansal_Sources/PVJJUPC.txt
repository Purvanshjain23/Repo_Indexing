/*********************************************************************/
/* PROGRAM : PVJJUPC                                                 */
/* DESC    : Exc Prt ABS Freight Rate for a Data range               */
/* DATE    : 01/23/2025                                              */
/* PROJECT : SR3025284 - Email ABS Freight Rate Report               */
/* BY      : Santosh Patil                                           */
/* PURPOSE : Call SEQUEL to print Absorbed Freight Rate Override     */
/*           Variance report as excel & send via ESEND.              */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE     BY  CHANGE DESCRIPTION                                   */
/* -------- --- ---------------------------------------------------- */
/* MM/DD/YY xxx Project ID. Desc                                     */
/*********************************************************************/

             PGM        PARM(&FRDATEA &TODATEA &EMAIL)

             DCL        VAR(&FRDATEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&FRDATE)  TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&TODATEA) TYPE(*CHAR) LEN(7)
             DCL        VAR(&TODATE)  TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&EMAIL)   TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMLMSG)  TYPE(*CHAR) LEN(100) +
                          VALUE('Absorbed Freight Rate Override +
                          Variance Report')
             DCL        VAR(&RTNLIB)  TYPE(*CHAR) LEN(10)

    /* If Current Library is not PRKFLIB, then set 'Test' in Email Msg */
             CALL       PGM(CAQXXFR) PARM(('') ('DTALIB    ') +
                          (&RTNLIB))
             IF         COND(&RTNLIB *NE 'PRKFLIB') THEN(DO)
             CHGVAR     VAR(&EMLMSG) VALUE(&EMLMSG *BCAT '- TEST')
             ENDDO

    /* Create Excel Spreadsheet with Sequel viewpoint & Email to recipent */
             EXECUTE    VIEW(ABSFRTOVRS) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&EMLMSG) +
                          SETVAR((&FRDATE &FRDATEA) (&TODATE &TODATEA))

             ENDPGM
