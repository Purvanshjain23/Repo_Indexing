     H/TITLE Dsp Tattoo Hdr/Defect DR  Display record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Display DBF file records, one at a time
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Display record(1 screen)
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 03/23/21  Time  : 08:53:00
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPWD0D1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Dsp Tattoo Hdr/Defect DR  Display record(1 screen)
      *
     FPKA1CPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Tattoo Header             Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPLATREL1IF  E           K        DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKA2CPL1IF  E           K        DISK
      * RTV : Tattoo Detail             Retrieval index
      *
     FPKFJCPL4IF  E           K        DISK
      * RSQ : Tattoo Pending            Co/Tattoo/BOL
      *
     FPLA8REL1IF  E           K        DISK
      * RTV : Producer Subsidiary       Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPLAECPL2IF  E           K        DISK
      * RSQ : Delivery Sched Detail     BOH Co/BO/BOL/Kill Dt
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
     FPKFJCPL0UF  E           K        DISK
      * UPD : Tattoo Pending            Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@FJCPHV
      * Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WAHONB
     I              FJEZDT                          WAEZDT
     I              FJHSA1                          WAHSA1
     I              FJHMNB                          WAHMNB
     I              FJBNNB                          WABNNB
     I              FJBONB                          WABONB
     I              FJHRA1                          WAHRA1
     I              FJBKTM                          WABKTM
     I              FJWPST                          WAWPST
     I              FJWQST                          WAWQST
     I              FJMIA1                          WAMIA1
     I              FJAAVN                          WAAAVN
     I              FJAADT                          WAAADT
     I              FJAMTM                          WAAMTM
     I              FJAJST                          WAAJST
     I              FJAHVN                          WAAHVN
     I              FJAGVN                          WAAGVN
     I              FJABVN                          WAABVN
     I              FJABDT                          WAABDT
     I              FJABTM                          WAABTM
      *
     I@A8REPM
      * Producer Subsidiary       Retrieval index
      * Renamed input format fields
     I              A8ABCD                          WBABCD
     I              A8OVCD                          WBOVCD
     I              A8V2TX                          WBV2TX
     I              A8DCSS                          WBDCSS
     I              A8DDSS                          WBDDSS
     I              A8DESS                          WBDESS
     I              A8SKA1                          WBSKA1
     I              A8SLA1                          WBSLA1
     I              A8SMA1                          WBSMA1
     I              A8AAVN                          WBAAVN
     I              A8AADT                          WBAADT
     I              A8AMTM                          WBAMTM
     I              A8AJST                          WBAJST
     I              A8AHVN                          WBAHVN
     I              A8AGVN                          WBAGVN
     I              A8ABVN                          WBABVN
     I              A8ABDT                          WBABDT
     I              A8ABTM                          WBABTM
      *
     I@AFCPI4
      * Delivery Tracking         BOH CO/BO/BOL/KillDt
      * Renamed input format fields
     I              AFHONB                          WCHONB
     I              AFE0DT                          WCE0DT
     I              AFE9DT                          WCE9DT
     I              AFAJTH                          WCAJTH
     I              AFH4A1                          WCH4A1
     I              AFFXDT                          WCFXDT
     I              AFJIA1                          WCJIA1
     I              AFIBA1                          WCIBA1
     I              AFW5ST                          WCW5ST
     I              AFICA1                          WCICA1
     I              AFK0CD                          WCK0CD
     I              AFK1CD                          WCK1CD
     I              AFLFCD                          WCLFCD
     I              AFLGCD                          WCLGCD
     I              AFIDA1                          WCIDA1
     I              AFIPA1                          WCIPA1
     I              AFLICD                          WCLICD
     I              AFJ8CD                          WCJ8CD
     I              AFJ9CD                          WCJ9CD
     I              AFMGCD                          WCMGCD
     I              AFXHST                          WCXHST
     I              AFXIST                          WCXIST
     I              AFIEA1                          WCIEA1
     I              AFKBCD                          WCKBCD
     I              AFKZCD                          WCKZCD
     I              AFLHCD                          WCLHCD
     I              AFFADT                          WCFADT
     I              AFAKTH                          WCAKTH
     I              AFBYTH                          WCBYTH
     I              AFW6ST                          WCW6ST
     I              AFXXST                          WCXXST
     I              AFFBDT                          WCFBDT
     I              AFALTH                          WCALTH
     I              AFBVTH                          WCBVTH
     I              AFAMTH                          WCAMTH
     I              AFFCDT                          WCFCDT
     I              AFANTH                          WCANTH
     I              AFBHTH                          WCBHTH
     I              AFFDDT                          WCFDDT
     I              AFAOTH                          WCAOTH
     I              AFBWTH                          WCBWTH
     I              AFAPTH                          WCAPTH
     I              AFFEDT                          WCFEDT
     I              AFAQTH                          WCAQTH
     I              AFARTH                          WCARTH
     I              AFFFDT                          WCFFDT
     I              AFASTH                          WCASTH
     I              AFATTH                          WCATTH
     I              AFFGDT                          WCFGDT
     I              AFAUTH                          WCAUTH
     I              AFFHDT                          WCFHDT
     I              AFAVTH                          WCAVTH
     I              AFAWTH                          WCAWTH
     I              AFBKTH                          WCBKTH
     I              AFBLTH                          WCBLTH
     I              AFXJST                          WCXJST
     I              AFK3CD                          WCK3CD
     I              AFFIDT                          WCFIDT
     I              AFAXTH                          WCAXTH
     I              AFAYTH                          WCAYTH
     I              AFFJDT                          WCFJDT
     I              AFAZTH                          WCAZTH
     I              AFA0TH                          WCA0TH
     I              AFFKDT                          WCFKDT
     I              AFA1TH                          WCA1TH
     I              AFA2TH                          WCA2TH
     I              AFFLDT                          WCFLDT
     I              AFA3TH                          WCA3TH
     I              AFA4TH                          WCA4TH
     I              AFBTTH                          WCBTTH
     I              AFFMDT                          WCFMDT
     I              AFA5TH                          WCA5TH
     I              AFA6TH                          WCA6TH
     I              AFBXTH                          WCBXTH
     I              AFXKST                          WCXKST
     I              AFYDST                          WCYDST
     I              AFFYDT                          WCFYDT
     I              AFB0TH                          WCB0TH
     I              AFBZTH                          WCBZTH
     I              AFH2A1                          WCH2A1
     I              AFJ2A1                          WCJ2A1
     I              AFJ3A1                          WCJ3A1
     I              AFKMA1                          WCKMA1
     I              AFJ4A1                          WCJ4A1
     I              AFJ5A1                          WCJ5A1
     I              AFJ6A1                          WCJ6A1
     I              AFJ7A1                          WCJ7A1
     I              AFJ8A1                          WCJ8A1
     I              AFJ9A1                          WCJ9A1
     I              AFKAA1                          WCKAA1
     I              AFKBA1                          WCKBA1
     I              AFKCA1                          WCKCA1
     I              AFKDA1                          WCKDA1
     I              AFKEA1                          WCKEA1
     I              AFKFA1                          WCKFA1
     I              AFKNA1                          WCKNA1
     I              AFKGA1                          WCKGA1
     I              AFKHA1                          WCKHA1
     I              AFKOA1                          WCKOA1
     I              AFKIA1                          WCKIA1
     I              AFKJA1                          WCKJA1
     I              AFKKA1                          WCKKA1
     I              AFKLA1                          WCKLA1
     I              AFYNST                          WCYNST
     I              AFYOST                          WCYOST
     I              AFABCD                          WCABCD
     I              AFAECD                          WCAECD
     I              AFAACD                          WCAACD
     I              AFHMNB                          WCHMNB
     I              AFBNNB                          WCBNNB
     I              AFBONB                          WCBONB
     I              AFAAVN                          WCAAVN
     I              AFAADT                          WCAADT
     I              AFAMTM                          WCAMTM
     I              AFAJST                          WCAJST
     I              AFAHVN                          WCAHVN
     I              AFAGVN                          WCAGVN
     I              AFABVN                          WCABVN
     I              AFABDT                          WCABDT
     I              AFABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQPKFJ1    E DSPKFJCPL0
      * UPD : Tattoo Pending            Update index
      * Renamed input format fields
     I              FJHONB                          WAHONB
     I              FJEZDT                          WAEZDT
     I              FJHSA1                          WAHSA1
     I              FJHMNB                          WAHMNB
     I              FJBNNB                          WABNNB
     I              FJBONB                          WABONB
     I              FJHRA1                          WAHRA1
     I              FJBKTM                          WABKTM
     I              FJWPST                          WAWPST
     I              FJWQST                          WAWQST
     I              FJMIA1                          WAMIA1
     I              FJAAVN                          WAAAVN
     I              FJAADT                          WAAADT
     I              FJAMTM                          WAAMTM
     I              FJAJST                          WAAJST
     I              FJAHVN                          WAAHVN
     I              FJAGVN                          WAAGVN
     I              FJABVN                          WAABVN
     I              FJABDT                          WAABDT
     I              FJABTM                          WAABTM
      *
     IYARDCS      DS                             87
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : RST BOL Load Number
     I                                    P   7   90P1BONB
      * B : RST TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I : RST TH Kill Date
     I                                    P  13  160P1B0DT
      * I :  TH Group Reference
     I                                       17  26 P1BICD
      * N :  TH Dead On Arrival
     I                                    P  27  290P1CXNB
      * I : MAP TH Sex
     I                                       30  30 P1E2ST
      * I : MAP TH HPS Movement Ref #
     I                                    P  31  340P1OXNB
      * I : MAP TH Hog Class Type
     I                                       35  35 P1LLST
      * N :  TH HPS Farm Site
     I                                    P  36  380P1THHD
      * I : MAP PD Producer Code
     I                                       39  44 P1ABCD
      * I : MAP PL Location Code
     I                                       45  50 P1AECD
      * I : MAP GN Genetic Code
     I                                       51  55 P1AGCD
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
      * I :  Name USR
     I                                       41  80 P2BSTX
      * I :  BOL Pln Delv Date
     I                                    P  81  840P2AUDT
      * B : MAP Record Added Usr
     I                                       85  85 P2IHST
      * I :  PD Name
     I                                       86 125 P2AGTX
      * I :  PL Name
     I                                      126 165 P2A8TX
      * I :  User modified: 0-not modi
     I                                      166 166 P2UMOD
      * N :  State
     I                                      167 169 P2DRTX
      * I :  Company Value Code    USR
     I                                      170 179 P2FACD
      * I :  SBD Top Load Sts
     I                                      180 180 P2WEST
     IP3PARM      DS
      * FLD: Source
      * N :  SR Source Code
     I                                        1   3 P3AACD
      * N :  SR Description
     I                                        4  28 P3AFTX
      * N :  SR Type
     I                                       29  29 P3IXST
     IP4PARM      DS
      * N :  SR Type Desc
     I                                        1  15 P4ISTX
     IP5PARM      DS
      * FLD: Producer Location
      * N :  PL Name
     I                                        1  40 P5A8TX
      * N :  PL State Code
     I                                       41  43 P5N0TX
      * N :  PL Site ID Required
     I                                       44  44 P5QTST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0001
      * Message data for 'Shipped Weight is Requird'
      * TH Shipped Weight
     I                                    P   1   41ZA0002
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0003
      * DF Defect Code
     I                                        2   7 ZA0004
      * DF Classification Defs
     I                                        8   8 ZA0005
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0006
      * DF Defect Code
     I                                        2   7 ZA0007
      * DF Classification Defs
     I                                        8   8 ZA0008
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0009
      * DF Defect Code
     I                                        2   7 ZA0010
      * DF Classification Defs
     I                                        8   8 ZA0011
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0012
      * DF Defect Code
     I                                        2   7 ZA0013
      * DF Classification Defs
     I                                        8   8 ZA0014
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0015
      * DF Defect Code
     I                                        2   7 ZA0016
      * DF Classification Defs
     I                                        8   8 ZA0017
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0018
      * DF Defect Code
     I                                        2   7 ZA0019
      * DF Classification Defs
     I                                        8   8 ZA0020
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0021
      * DF Defect Code
     I                                        2   7 ZA0022
      * DF Classification Defs
     I                                        8   8 ZA0023
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0024
      * DF Defect Code
     I                                        2   7 ZA0025
      * DF Classification Defs
     I                                        8   8 ZA0026
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0027
      * DF Defect Code
     I                                        2   7 ZA0028
      * DF Classification Defs
     I                                        8   8 ZA0029
      * Message data for 'Defect NAllow on Hog Type'
      * HC Class Type
     I                                        1   1 ZA0030
      * DF Defect Code
     I                                        2   7 ZA0031
      * DF Classification Defs
     I                                        8   8 ZA0032
      * Message data for 'State Code Invalid'
      * State
     I                                        1   3 ZA0033
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM P1CVNB    WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1BICD    PARM           WP0006 10        TH Group Refere
     C           P1E2ST    PARM           WP0007  1        TH Sex
     C           P1OXNB    PARM           WP0008  70       TH HPS Movement
     C           P1LLST    PARM           WP0009  1        TH Hog Class Ty
     C           P1ABCD    PARM           WP0010  6        PD Producer Cod
     C           P1AECD    PARM           WP0011  6        PL Location Cod
     C           P1AGCD    PARM           WP0012  5        GN Genetic Code
     C           P2EVTX    PARM           WP0013 40        Oms System Valu
     C           P2BSTX    PARM           WP0014 40        Name USR
     C           P2AUDT    PARM           WP0015  70       BOL Pln Delv Da
     C           P2IHST    PARM P2IHST    WP0016  1        Record Added Us
     C           P2AGTX    PARM           WP0017 40        PD Name
     C           P2A8TX    PARM           WP0018 40        PL Name
     C           P2UMOD    PARM           WP0019  1        User modified:
     C           P2FACD    PARM           WP0020 10        Company Value C
     C           P2WEST    PARM           WP0021  1        SBD Top Load St
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #1BONB    OREQ *ZERO                      BOL Load Number
     C           #1B0DT    OREQ *ZERO                      TH Kill Date
     C           #1CVNB    OREQ *ZERO                      TH Tattoo Numbe
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFNE 'Y'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Enable PUTOVR
     C                     SETON                     86
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KRTV      CHAIN@A1CPC4              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     9931  *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, then signal error
     C           *IN90     IFEQ '1'
     C                     SETON                     9931  *
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * DTL.TH Live Purch UOM  Usr = Condition name of DTL.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DTL.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM #1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SARVGN
     C                     MOVEL'Y'       WUNEST           Ship Wgt Allow
      * Test of allow ship weight to be input/output
      * CASE: DTL.TH Payment Sts is Paid Anything
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test of held over quanity
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
      * USER: Load detail screen from DBF record
     C                     Z-ADDA1OXNB    #DTZA1           Prior Movement
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELP5QTST    #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
      * ** Retrieve Site ID & Producer Subsidiary from Tattoo Header EXT
      * NOT Resale get Tattoo hdr ext , Rsl hogs set to blks site id & pr
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       #DQTST           PL Site ID Requ
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     END                             *FI
      * The Bol Shipped Head is maintain in this program at the Tattoo Le
      * so regardless this field represents the shipped head for the load
      * Rtv Shipped Head      RT - Buy Order Load  * 
     C                     EXSR SCRVGN
      * 9/22/2008 slm
      * move set cursor to lower part of processing
      * do to adding fields to screen set cursor on new rules
     C                     MOVEL'Y'       YL0001           Record Change U
      * DTL.Description 30 USR = Condition name of DTL.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVELP2AGTX    #DAGTX           PD Name
     C                     MOVELP2A8TX    #DA8TX           PL Name
      * DTL.TH Live Purch UOM  Usr = Condition name of DB1.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM A1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DB1.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM A1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Class Desc    RT - Hog Classification  * 
     C                     EXSR SDRVGN
     C                     MOVELP2BSTX    #DBSTX           Name USR
     C                     MOVELP3AACD    #1LKST           TH Source Code
     C                     MOVELP3IXST    #1KAST           TH Source Type
      * DTL.SR Type Desc = Condition name of PAR.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM P3IXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * State code - Prod, or producer site, or external
      * CASE: PAR.SR Type is External
     C           P3IXST    IFEQ 'E'                        *IF
      * Placed TH STATE CODE on the screen, def either prd loc, or site i
      * Rtv vendor info & site information from the producer
      * CASE: DTL.TH State EQ WRK.Blank USR
     C           #1NZTX    IFEQ WUCRTX                     *IF
     C                     MOVELP5N0TX    #1NZTX           TH State
      * CASE: DTL.PL Site ID Required is Yes
     C           #DQTST    IFEQ 'Y'                        *IF
      * get th state
      * E3814 JJH 10/07/15 - Display PS Premises ID from Producer Site
      * test susan 2
      * Rtv Site State/PremiseRT - Producer Site  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     END                             *FI
      * State code - mtech live and internals only
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   |- c2    : PAR.SR Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'Y'                        *IF
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Get the State Code from the Farm Site
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0001  7        *Return code
     C                     PARM *BLANK    WQ0002 25        Farm site Name
     C                     PARM #1THHD    WQ0003  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0004  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0005  3        State
     C           WUQGTX    PARM *BLANK    WQ0006 25        HPS Farm County
     C           WUJXCD    PARM *BLANK    WQ0007  5        HPS Cell Manage
     C           WUQFTX    PARM *BLANK    WQ0008 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0009 20        MTech Farm Site
     C                     PARM *BLANK    WQ0010 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * State code - mtech NOT live and internals only
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is No MTech not Live
      *   |- c2    : PAR.SR Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0002    IFEQ 'N'                        *IF
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Placed TH STATE on the screen, FROM the farm site get the state
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0011  7        *Return code
     C                     PARM #1OXNB    WQ0012  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0013 25        Farm site Name
     C           #1THHD    PARM *ZERO     WQ0014  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0015  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0016  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL#1NZTX    YL0003           State
     C                     END                             *FI
     C                     MOVELWUCRTX    YL0004           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0004    PARM YL0004    WQ0017  7        Return Code USR
     C                     PARM #1NZTX    WQ0018  3        State
     C           #DLXTX    PARM *BLANK    WQ0019 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0004    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0001           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * The Bol Shipped Head is maintain in this program at the Tattoo Le
      * so regardless this field represents the shipped head for the load
      * Rtv Shipped Head      RT - Buy Order Load  * 
     C                     EXSR SFRVGN
      * DTL.HC Class Type Desc Usr = Condition name of DTL.TH Hog Class T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM #1LLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DE6TX    PARM           W0CNNM 25        HC Class Type D
      *
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     MOVEL*BLANK    WUKPST           @Status Interna
     C                     MOVEL'N'       WUL9ST           Display Output
     C                     MOVEL'N'       WUMAST           Display Output
      * MKT: Hide defect/head fields  and pen/hd recvd
      * CASE: DTL.TH Hog Class Type is Market
     C           #1LLST    IFEQ 'M'                        *IF
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Hog Class Type is Subject
      *   |- c2    : DTL.TH Source Type is External
      *   '-
     C           #1LLST    IFEQ 'S'                        *IF
     C           #1KAST    OREQ 'E'                        *OR
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * Set flag to display unweighed resale pen & received hd, get pen
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : DTL.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           #1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUKPST           @Status Interna
      * Protect the defect/head/pen fields if tattoo has been weighed.
      * CASE: DTL.TH Resale Spread Sts is Spread
     C           #1C2ST    IFEQ 'P'                        *IF
     C                     MOVEL'Y'       WUL9ST           Display Output
     C                     MOVEL'Y'       WUMAST           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * Get Defect/Hd
     C                     EXSR UASUBR                     Get Defect/Hd
      * Save input fields to check for changes later
     C                     MOVEL#1CPST    WUCPST           TH Live Purchas
     C                     Z-ADD#1ACPR    WUACPR           TH Live Purchas
     C                     MOVEL#1AGCD    WUAGCD           GN Genetic Code
     C                     Z-ADD#1HGNB    WUHGNB           TH Shipped Weig
      * Check producer for Insured, to diplay on screen
      * Rtv/Chk Prdcr for Ins XF - Deduction/Addition  * 
     C                     CALL 'PKGDXFR'              90  Rtv/Chk Prdcr f
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1ABCD    WQ0020  6        PD Producer Cod
     C           WUABST    PARM *BLANK    WQ0021  1        @Status (Yes/No
     C                     PARM P1HMNB    WQ0022  30       PSDP Company Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKGDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Insured
      * CASE: WRK.@Status (Yes/No) is Yes
     C           WUABST    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   #DK5TX           Text 9 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     END                             *FI
      * Rtv Delivery TrackInf XF - Delivery Tracking  * 
     C                     CALL 'PLS3XFR'              90  Rtv Delivery Tr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM *ZERO     WQ0023  50       DT Farm Site Co
     C           #DK0CD    PARM *BLANK    WQ0024  5        DT Building
     C           #DK1CD    PARM *BLANK    WQ0025  5        DT Room
     C           #DLFCD    PARM *BLANK    WQ0026  5        DT Sire Line Co
     C                     PARM A1HMNB    WQ0027  30       BOH Company Num
     C                     PARM A1BNNB    WQ0028  70       BOH Buy Order N
     C                     PARM A1BONB    WQ0029  50       BOL Load Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLS3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END
      *
     C   99                GOTO BEEXIT
      * No error: Display and process details
     C                     EXSR CADSDA
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Select existing record
     C                     EXSR VACKRL
      * TH Tattoo Number required
     C           #1CVNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
      * Process detail screen input
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process key screen input
     C                     CAS            CFPRSC
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Enable PUTOVR
     C                     SETON                     86
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'Y'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C                     MOVEL'Y'       W0TRN
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Process record:
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * DTL.TH Live Purch UOM  Usr = Condition name of DTL.TH Live Purcha
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CPST    W0INVL 25        TH Live Purchas
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEPTX    PARM           W0CNNM 25        TH Live Purch U
      *
      * DTL.Sex Desc Usr = Condition name of DTL.TH Sex
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1135183   Y2LSNO  70       List number
     C                     PARM #1E2ST    W0INVL 25        TH Sex
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DFRTX    PARM           W0CNNM 25        Sex Desc Usr
      *
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SSRVGN
     C                     MOVEL'Y'       WUNEST           Ship Wgt Allow
      * Test of allow ship weight to be input/output
      * CASE: DTL.TH Payment Sts is Paid Anything
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     ELSE
      * CASE: DTL.TH Held Over Record is Yes
     C           #1E1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUNEST           Ship Wgt Allow
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Test of held over quanity
      * CASE: DTL.TH Held Over is greater than 0
     C           #1H9NB    IFGT *ZERO                      *IF
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is CF03
      *   |- c2    : DTL.*CMD key is *Add
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN03     IFEQ '1'                        *IF
     C           *IN09     IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
     C                     EXSR STRVGN
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Shipped Weight Validation
      * CASE: DTL.TH Live Purchase UOM is Shipped Weight List
     C           #1CPST    IFEQ 'SW'                       *IF
     C           #1CPST    OREQ 'SX'
      * CASE: WRK.Held Over Records Y/N is Yes
     C           WUNFST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.TH Shipped Weight is Greater then Zero
     C           #1HGNB    IFGT *ZERO                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#1HGNB    ZA0002           TH Shipped Weig
      * Send message 'Shipped Weight is Requird'
     C                     MOVEL'PRK0653' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Status
      * CASE: DTL.TH Payment Sts is Paid Producer
     C           #1CWST    IFEQ 'PL'                       *IF
     C           #1CWST    OREQ 'PC'
     C           #1CWST    OREQ 'NC'
     C           #1CWST    OREQ 'NL'
     C                     ELSE
      * CASE: *OTHERWISE
      * If UOM or price changes, set Status to Recalulate net
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.TH Live Purchase UOM NE WRK.TH Live Purchase UOM
      *   |- c2    : DTL.TH Live Purchase Price NE WRK.TH Live Purchase P
      *   '-
     C           #1CPST    IFNE WUCPST                     *IF
     C           #1ACPR    ORNE WUACPR                     *OR
     C                     MOVEL'R'       #1JWST           TH Calc Net Sts
     C                     MOVELWUCRTX    #1J9ST           TH Payment Type
     C                     END                             *FI
     C                     END                             *FI
      * Changes in ship information to require reprint of scale ticket
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Shipped Weight NE WRK.TH Shipped Weight
      *   |- c2    : DTL.TH Live Purchase UOM is Shipped Weight List
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1HGNB    IFNE WUHGNB                     *IF
     C           #1CPST    IFEQ 'SW'                       *IF
     C           #1CPST    OREQ 'SX'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'S'       WUCZST           @Print Status
     C                     END                             *FI
      * validation of Defects
     C                     EXSR UBSUBR                     validation of D
      * Internal farm site and state MTech NOTLive & MtechLive
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is No MTech not Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           YL0002    IFEQ 'N'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * get farm site by movement
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WURTN     PARM WURTN     WQ0077  7        *Return code
     C                     PARM #1OXNB    WQ0078  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0079 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0080  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0081  5        HPS FS Comp Rel
     C           P2DRTX    PARM *BLANK    WQ0082  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    #1THHD           TH HPS Farm Sit
      * CASE: WRK.Farm Site USR NE WRK.Zero USR
     C           WUETNB    IFNE WUE9NB                     *IF
     C                     MOVELP2DRTX    #1NZTX           TH State
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.TH Source Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1KAST    IFEQ 'I'                        *IF
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * have farm site on screen now get state
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           WURTN     PARM WURTN     WQ0083  7        *Return code
     C                     PARM *BLANK    WQ0084 25        Farm site Name
     C                     PARM #1THHD    WQ0085  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0086  5        HPS FS Comp Rel
     C           #1NZTX    PARM *BLANK    WQ0087  3        State
     C           WUQGTX    PARM *BLANK    WQ0088 25        HPS Farm County
     C           WUJXCD    PARM *BLANK    WQ0089  5        HPS Cell Manage
     C           WUQFTX    PARM *BLANK    WQ0090 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0091 20        MTech Farm Site
     C                     PARM *BLANK    WQ0092 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: DTL.TH HPS Farm Site NE WRK.Zero USR
     C           #1THHD    IFNE WUE9NB                     *IF
     C                     MOVELP2DRTX    #1NZTX           TH State
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate the state code regardless
     C                     MOVELWUCRTX    YL0004           Return Code USR
      * Rtv State Description UP - STR VND Common Routines  * 
     C                     CALL 'STATERET'             90  Rtv State Descr
     C           YL0004    PARM YL0004    WQ0093  7        Return Code USR
     C                     PARM #1NZTX    WQ0094  3        State
     C           #DLXTX    PARM *BLANK    WQ0095 30        State Desc 30 U
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'STATERET'W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Invalid state code send message
      * CASE: LCL.Return Code USR is *Normal
     C           YL0004    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1NZTX    ZA0033           TH State
      * Send message 'State Code Invalid'
     C                     MOVEL'PRK0308' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * USER: Process command keys
      * Quit if error signalled
     C   99                GOTO EBEXIT
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1CVNB    IFEQ *ZERO                      TH Tattoo Numbe
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUKPST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUNFST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #DQTST           PL Site ID Requ
     C                     MOVELP2IHST    #PIHST           Record Added Us
     C                     MOVEL*BLANK    #DBSTX           Name USR
     C                     Z-ADD*ZERO     #DTZA1           Prior Movement
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     MOVEL*BLANK    #DA8TX           PL Name
     C                     MOVEL*BLANK    #DEPCD           Group Reference
     C                     MOVEL*BLANK    #DO3TX           OMS State
     C                     Z-ADD*ZERO     #DNVA1           LFT usr
     C                     Z-ADD*ZERO     #DNWA1           EUT/KOA Hogs us
     C                     MOVEL*BLANK    #1BDCD           DF Defect Code
     C                     MOVEL*BLANK    #DBCTX           DF Description
     C                     Z-ADD*ZERO     #1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #1H9NB           TH Held Over
     C                     Z-ADD*ZERO     #1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #1FENB           TH Head Killed
     C                     Z-ADD*ZERO     #1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #1HENB           TH Head Adds
     C                     Z-ADD*ZERO     #1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #1CWST           TH Payment Sts
     C                     MOVEL*BLANK    #1D7ST           TH Header Error
     C                     MOVEL*BLANK    #1D8ST           TH Detail Error
     C                     MOVEL*BLANK    #1DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #1GHNB           TH Commission A
     C                     Z-ADD*ZERO     #1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #1E0ST           TH User Error O
     C                     MOVEL*BLANK    #1E1ST           TH Held Over Re
     C                     Z-ADD*ZERO     #1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #1BTDT           TH Commission P
     C                     Z-ADD*ZERO     #1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1HINB           TH FFLI
     C                     Z-ADD*ZERO     #1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #1KAST           TH Source Type
     C                     MOVEL*BLANK    #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #1LJST           TH Shift Held O
     C                     MOVEL*BLANK    #1HJCD           TH Unused Code
     C                     MOVEL*BLANK    #1R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1R5ST           TH Commission S
     C                     MOVEL*BLANK    #1R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #1R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #1THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #1T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #1T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #1OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #1KOER           TH Head Identif
     C                     Z-ADD*ZERO     #1OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #1OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #1IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #1OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #1OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #1URST           TH PHA Average
     C                     MOVEL*BLANK    #1USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #1HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #1S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #1TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #1TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #1JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #1KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #1KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #1KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #1OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #1IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #1IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #1IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #1KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #1KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #1ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #1OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #1MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #1NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #1NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #1IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EEDT           TH Unused Date
     C                     MOVEL*BLANK    #1U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #1U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #1U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #1U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #1U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #1VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #1VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #1J9ST           TH Payment Type
     C                     MOVEL*BLANK    #1LKST           TH Source Code
     C                     MOVEL*BLANK    #1CSCD           THP Process Cod
     C                     MOVEL*BLANK    #1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     MOVEL*BLANK    #DISTX           SR Type Desc
     C                     MOVELP1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELP1AECD    #1AECD           PL Location Cod
     C                     Z-ADD*ZERO     #1AWDT           TH Purchase Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1AWDT
     C                     MOVELP1LLST    #1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #DE6TX           HC Class Type D
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #DBDTX           HC Description
     C                     Z-ADDP1OXNB    #1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #1BICD           TH Group Refere
     C                     MOVELP1E2ST    #1E2ST           TH Sex
     C                     MOVEL*BLANK    #DFRTX           Sex Desc Usr
     C                     Z-ADD*ZERO     #1THHD           TH HPS Farm Sit
     C                     MOVEL*BLANK    #1NZTX           TH State
     C                     MOVEL*BLANK    #DLXTX           State Desc 15 U
     C                     MOVEL*BLANK    #DK0CD           DT Building
     C                     MOVEL*BLANK    #DK1CD           DT Room
     C                     MOVELP1AGCD    #1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #DLFCD           DT Sire Line Co
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL*BLANK    #1LIST           TH Schedule Kil
     C                     Z-ADD*ZERO     #1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     Z-ADD*ZERO     #1ACPR           TH Live Purchas
     C                     MOVEL*BLANK    #DK5TX           Text 9 USR
     C                     Z-ADD*ZERO     #1ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #1EDDT           TH Head EUT/KOA
     C                     MOVEL*BLANK    #1CPST           TH Live Purchas
     C                     MOVEL*BLANK    #DEPTX           TH Live Purch U
     C                     Z-ADD*ZERO     #1HGNB           TH Shipped Weig
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     MOVEL*BLANK    #DCLSS           Class Df 1 Usr
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     MOVEL*BLANK    #DCMSS           Class Df 2 Usr
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     MOVEL*BLANK    #DCNSS           Class Df 3 Usr
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     MOVEL*BLANK    #DCOSS           Class Df 4 Usr
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     MOVEL*BLANK    #DCPSS           Class Df 5 Usr
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     MOVEL*BLANK    #DCQSS           Class Df 6 Usr
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     MOVEL*BLANK    #DCRSS           Class Df 7 Usr
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     MOVEL*BLANK    #DCSSS           Class Df 8 Usr
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     MOVEL*BLANK    #DCTSS           Class Df 9 Usr
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
     C                     MOVEL*BLANK    #DCUSS           Class Df 10 Usr
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A1CPC4 fields to screen
      *================================================================
     C                     Z-ADDA1HMNB    #1HMNB           BOH Company Num
     C                     MOVELA1BDCD    #1BDCD           DF Defect Code
     C                     Z-ADDA1B9PR    #1B9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    #1CAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDA1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDA1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #1FENB           TH Head Killed
     C                     Z-ADDA1LRNB    #1LRNB           TH Adj Live Wgt
     C                     Z-ADDA1HENB    #1HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    #1CWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    #1B8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDA1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDA1CBPR    #1CBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    #1CCPR           Th Payment Net
     C                     Z-ADDA1LPNB    #1LPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    #1CDPR           TH Freight Amou
     C                     Z-ADDA1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDA1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELA1JWST    #1JWST           TH Calc Net Sts
     C                     MOVELA1CWST    #1CWST           TH Payment Sts
     C                     MOVELA1D7ST    #1D7ST           TH Header Error
     C                     MOVELA1D8ST    #1D8ST           TH Detail Error
     C                     MOVELA1DWST    #1DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELA1E0ST    #1E0ST           TH User Error O
     C                     MOVELA1E1ST    #1E1ST           TH Held Over Re
     C                     Z-ADDA1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDA1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #1HINB           TH FFLI
     C                     Z-ADDA1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDA1J9NB    #1J9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    #1D6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    #1D7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    #1D8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    #1D9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    #1EAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    #1EBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    #1ECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    #1EDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    #1EEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    #1EFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    #1EGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    #1EHPR           TH CM Gross Car
     C                     MOVELA1KAST    #1KAST           TH Source Type
     C                     MOVELA1J7ST    #1J7ST           TH Scale Ticket
     C                     MOVELA1J8ST    #1J8ST           TH Posted to HP
     C                     MOVELA1LJST    #1LJST           TH Shift Held O
     C                     MOVELA1HJCD    #1HJCD           TH Unused Code
     C                     MOVELA1R4ST    #1R4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    #1R5ST           TH Commission S
     C                     MOVELA1R6ST    #1R6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    #1R7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    #1THWT           TH DOA Weight
     C                     Z-ADDA1T2WT    #1T2WT           TH Avg Lean % E
     C                     Z-ADDA1T2HD    #1T2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    #1OBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    #1KOER           TH Head Identif
     C                     Z-ADDA1OPIR    #1OPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    #1OPEM           TH Percent Acce
     C                     Z-ADDA1IORP    #1IORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    #1OWEO           TH PHA Head Add
     C                     MOVELA1OQET    #1OQET           TH PHA Add Type
     C                     MOVELA1URST    #1URST           TH PHA Average
     C                     MOVELA1USST    #1USST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    #1HHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    #1S9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    #1TAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    #1TBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    #1JFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    #1KRIF           TH Broken Back
     C                     Z-ADDA1KORF    #1KORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    #1KAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    #1KROT           TH Excluded Car
     C                     Z-ADDA1OTJG    #1OTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    #1IRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    #1IMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    #1IRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    #1KRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    #1OJRF           TH Break Even P
     C                     Z-ADDA1KFOR    #1KFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    #1ORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    #1OMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    #1MVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    #1MCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    #1NCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    #1NCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    #1IGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    #1KFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    #1EADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    #1EBDT           TH Cold Scl Upl
     C                     Z-ADDA1EEDT    #1EEDT           TH Unused Date
     C                     MOVELA1U4ST    #1U4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    #1U5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    #1U6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    #1U7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    #1U8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    #1U9ST           TH Unused Sts 6
     C                     MOVELA1VAST    #1VAST           TH Unused Sts 7
     C                     MOVELA1VBST    #1VBST           TH Unused Sts 8
     C                     MOVELA1J9ST    #1J9ST           TH Payment Type
     C                     MOVELA1LKST    #1LKST           TH Source Code
     C                     MOVELA1CSCD    #1CSCD           THP Process Cod
     C                     MOVELA1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELA1AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA1AADT    #1AADT           RS Date Changed
     C                     Z-ADDA1AMTM    #1AMTM           RS Time Changed
     C                     MOVELA1AJST    #1AJST           RS Record Statu
     C                     MOVELA1AHVN    #1AHVN           RS Job
     C                     MOVELA1AGVN    #1AGVN           RS Program
     C                     MOVELA1ABVN    #1ABVN           RS User Added
     C                     Z-ADDA1ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA1ABTM    #1ABTM           RS Time Added
     C                     MOVELA1ABCD    #1ABCD           PD Producer Cod
     C                     MOVELA1AECD    #1AECD           PL Location Cod
     C                     Z-ADDA1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    #1BONB           BOL Load Number
     C                     Z-ADDA1CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDA1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELA1LLST    #1LLST           TH Hog Class Ty
     C                     MOVELA1BECD    #1BECD           HC Class Code
     C                     Z-ADDA1OXNB    #1OXNB           TH HPS Movement
     C                     MOVELA1BICD    #1BICD           TH Group Refere
     C                     MOVELA1E2ST    #1E2ST           TH Sex
     C                     Z-ADDA1THHD    #1THHD           TH HPS Farm Sit
     C                     MOVELA1NZTX    #1NZTX           TH State
     C                     MOVELA1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELA1LIST    #1LIST           TH Schedule Kil
     C                     Z-ADDA1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDA1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDA1ACPR    #1ACPR           TH Live Purchas
     C                     Z-ADDA1ECDT    #1ECDT           TH Head LFT
     C                     Z-ADDA1EDDT    #1EDDT           TH Head EUT/KOA
     C                     MOVELA1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDA1HGNB    #1HGNB           TH Shipped Weig
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP2IHST    #PIHST           Record Added Us
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
     C                     Z-ADDP1B0DT    #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADDP1CVNB    #1CVNB           TH Tattoo Numbe
      * Check restriction within
     C                     EXSR VBCKRL
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  #1AWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1AWDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSA     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Site ID/Prod Subs RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    DNHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    DNBONB           BOL Load Number
     C                     Z-ADDP1CVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSB     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DNYCD           PS Site ID
     C                     MOVEL*BLANK    #DOVCD           Producer Subsid
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    #DNYCD           PS Site ID
     C                     MOVELDNOVCD    #DOVCD           Producer Subsid
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSC     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXLDSH    #DLDSH           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Desc    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELA1BECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSSD     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBDTX           HC Description
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8BDTX    #DBDTX           HC Description
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Site State/PremiseRT - Producer Site  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ATABCD           PD Producer Cod
     C                     KFLD           ATNYCD           PS Site ID
      * Setup key
     C                     MOVELP1ABCD    ATABCD           PD Producer Cod
     C                     MOVEL#DNYCD    ATNYCD           PS Site ID
      * Establish starting position
     C           KRSSE     CHAIN@ATRELM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1137' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           ATAJST    IFEQ 'A'                        *IF
      * PAR = DB1 By name
     C                     MOVELATT2TX    #1NZTX           PS State
     C                     MOVELATBGT1    #DBGT1           PS Premises ID
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = CON By name
     C                     MOVEL*BLANK    #1NZTX           PS State
     C                     MOVEL*BLANK    #DBGT1           PS Premises ID
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Shipped Head      RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSF     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DLDSH           BOL Shipped Hea
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXLDSH    #DLDSH           BOL Shipped Hea
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUODNB           Defect Count Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQSG01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQSG02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQSG03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQSG04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQSG05           TH Kill Date
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           BOH Company Num
     C                     KFLD           WQSG02           BOH Buy Order N
     C                     KFLD           WQSG03           BOL Load Number
     C                     KFLD           WQSG04           TH Tattoo Numbe
     C                     KFLD           WQSG05           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSG01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSG02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSG03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSG04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSG05           TH Kill Date
      * Establish starting position
     C           KRSSG     SETLL@DZREX3                    *
     C           KRSSG     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Defect Count Usr is One
     C           WUODNB    IFEQ 1                          *IF
     C                     MOVELDZBDCD    #DGUCD           Defect User  1
     C                     Z-ADDDZLJNB    #DF1NB           Defect HD user
     C                     MOVELDZB7SS    #DCLSS           Defect Cls User
     C                     Z-ADD2         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Two
     C           WUODNB    IFEQ 2                          *IF
     C                     MOVELDZBDCD    #DGVCD           Defect User  2
     C                     Z-ADDDZLJNB    #DFWNB           Defect HD user
     C                     MOVELDZB7SS    #DCMSS           Defect Cls User
     C                     Z-ADD3         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Three
     C           WUODNB    IFEQ 3                          *IF
     C                     MOVELDZBDCD    #DGWCD           Defect User  3
     C                     Z-ADDDZLJNB    #DFYNB           Defect HD user
     C                     MOVELDZB7SS    #DCNSS           Defect Cls User
     C                     Z-ADD4         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Four
     C           WUODNB    IFEQ 4                          *IF
     C                     MOVELDZBDCD    #DGXCD           Defect User  4
     C                     Z-ADDDZLJNB    #DFUNB           Defect HD user
     C                     MOVELDZB7SS    #DCOSS           Defect Cls User
     C                     Z-ADD5         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Five
     C           WUODNB    IFEQ 5                          *IF
     C                     MOVELDZBDCD    #DGYCD           Defect User  5
     C                     Z-ADDDZLJNB    #DO3NB           Defect HD user
     C                     MOVELDZB7SS    #DCPSS           Defect Cls User
     C                     Z-ADD6         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Six
     C           WUODNB    IFEQ 6                          *IF
     C                     MOVELDZBDCD    #DGZCD           Defect User  6
     C                     Z-ADDDZLJNB    #DO4NB           Defect HD user
     C                     MOVELDZB7SS    #DCQSS           Defect Cls User
     C                     Z-ADD7         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Seven
     C           WUODNB    IFEQ 7                          *IF
     C                     MOVELDZBDCD    #DG0CD           Defect User  7
     C                     Z-ADDDZLJNB    #DO5NB           Defect HD user
     C                     MOVELDZB7SS    #DCRSS           Defect Cls User
     C                     Z-ADD8         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Eight
     C           WUODNB    IFEQ 8                          *IF
     C                     MOVELDZBDCD    #DG1CD           Defect User  8
     C                     Z-ADDDZLJNB    #DFONB           Defect HD user
     C                     MOVELDZB7SS    #DCSSS           Defect Cls User
     C                     Z-ADD9         WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Nine
     C           WUODNB    IFEQ 9                          *IF
     C                     MOVELDZBDCD    #DG2CD           Defect User  9
     C                     Z-ADDDZLJNB    #DFXNB           Defect HD user
     C                     MOVELDZB7SS    #DCTSS           Defect Cls User
     C                     Z-ADD10        WUODNB           Defect Count Us
     C                     ELSE
      * CASE: WRK.Defect Count Usr is Ten
     C           WUODNB    IFEQ 10                         *IF
     C                     MOVELDZBDCD    #DG3CD           Defect User 10
     C                     Z-ADDDZLJNB    #DFTNB           Defect HD user
     C                     MOVELDZB7SS    #DCUSS           Defect Cls User
     C                     Z-ADD11        WUODNB           Defect Count Us
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSG     READE@DZREX3                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGUCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSH     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGVCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSI     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGWCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSJ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGXCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSK     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGYCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSL     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DGZCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSM     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG0CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSN     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG1CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSO     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG2CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSP     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Scale Wt Req      RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#DG3CD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSQ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUR2ST           DF Scale Weight
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7R2ST    WUR2ST           DF Scale Weight
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Detail     RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
      * Setup key
     C                     Z-ADD#1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD1         A2C2NB           TD Sequence Num
      * Establish starting position
     C           KRSSR     CHAIN@A2CPDG              90    *
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA2HVNB    WUHVNB           Pen Company Num
     C                     MOVELA2CMCD    #DCMCD           Pen Number
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSS     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    #DBCTX           DF Description
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    #DBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv and UnAssigned    RT - Tattoo Pending  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FJHONB    WQST01           CC Company Numb
     C           *LIKE     DEFN FJHSA1    WQST02           TP Tattoo Numbe
     C           *LIKE     DEFN FJHMNB    WQST03           BOH Company Num
     C           *LIKE     DEFN FJBNNB    WQST04           BOH Buy Order N
     C           *LIKE     DEFN FJBONB    WQST05           BOL Load Number
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           CC Company Numb
     C                     KFLD           WQST02           TP Tattoo Numbe
     C                     KFLD           WQST03           BOH Company Num
     C                     KFLD           WQST04           BOH Buy Order N
     C                     KFLD           WQST05           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQST01           CC Company Numb
     C                     Z-ADDP1CVNB    WQST02           TP Tattoo Numbe
     C                     Z-ADDP1HMNB    WQST03           BOH Company Num
     C                     Z-ADDP1BNNB    WQST04           BOH Buy Order N
     C                     Z-ADDP1BONB    WQST05           BOL Load Number
      * Establish starting position
     C           KRSST     SETLL@FJCPKH                    *
     C           KRSST     READE@FJCPKH                  90*
      * Data record not found
     C   90                MOVEL'PRK1012' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
     C                     EXSR SUCHRC
     C           KRSST     READE@FJCPKH                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Tattoo UnAssigned CH - Tattoo Pending  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Employee ID
     C                     Z-ADD*ZERO     WN0002  60       TP Tattoo Creat
     C                     MOVEL*BLANK    WN0003  1        TP Alley Number
     C                     Z-ADD*ZERO     WN0004  50       Employee Number
     C                     MOVEL*BLANK    WN0005 10        RS User Changed
     C                     Z-ADD*ZERO     WN0006  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0007  60       RS Time Changed
     C                     MOVEL*BLANK    WN0008  1        RS Record Statu
     C                     MOVEL*BLANK    WN0009 10        RS Job
     C                     MOVEL*BLANK    WN0010 10        RS Program
     C                     MOVEL*BLANK    WN0011 10        RS User Added
     C                     Z-ADD*ZERO     WN0012  70       RS Date Added
     C                     Z-ADD*ZERO     WN0013  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPHV
     C                     Z-ADDFJHONB    WAHONB           CC Company Numb
     C                     Z-ADDFJEZDT    WAEZDT           TP Tattoo Date
     C                     Z-ADDFJHSA1    WAHSA1           TP Tattoo Numbe
      *
     C           KLCHSU    KLIST
     C                     KFLD           WAHONB           CC Company Numb
     C                     KFLD           WAEZDT           TP Tattoo Date
     C                     KFLD           WAHSA1           TP Tattoo Numbe
     C           KLCHSU    CHAIN@FJCPHV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFJCPL0'MDACP
     C                     MOVEL'@FJCPHV' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFJ1    YARDCS
      * Move non-key fields to @FJCPHV
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     MOVEL'P'       WAWQST    P      TP Tattoo Statu
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WAAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WAAADT    PARM *ZERO     WQ0035  70       *DATE
     C           WAAMTM    PARM *ZERO     WQ0036  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WAAHVN           RS Job
     C                     MOVEL##PGM     WAAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPHV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv ProdSubsidiaryPrc RT - Producer Subsidiary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC R9771  3/24/17 check for active only
     C                     MOVEL'N'       WUDJSS           Producer Subsid
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBABCD    WQSV01           PD Producer Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    WQSV01           PD Producer Cod
      * Establish starting position
     C           KRSSV     SETLL@A8REPM                    *
     C           KRSSV     READE@A8REPM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUDJSS           Producer Subsid
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WBAJST    IFEQ 'A'                        *IF
     C                     MOVEL'Y'       WUDJSS           Producer Subsid
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@A8REPM                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSW     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGCNB           PD VND Address
     C                     MOVEL*BLANK    P3AACD           SR Source Code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WUGCNB           PD VND Address
     C                     MOVELACAACD    P3AACD           SR Source Code
      * CASE: DB1.PD VND Address Number is Zero
     C           ACGCNB    IFEQ 0                          *IF
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR SXRVGN
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ YL0007    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0007    YL0008           Amount USR
     C                     Z-ADDYL0008    WUGCNB           PD VND Address
     C                     END                             *FI
     C                     GOTO SWEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSSX     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = PAR By name
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELP3AACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSY     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    P3IXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVELP1ABCD    AFABCD           PD Producer Cod
     C                     MOVELP1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSZ     CHAIN@AFREAR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0015' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    P5A8TX           PL Name
     C                     Z-ADD*ZERO     WUGLNB           Pl VND Address
     C                     MOVEL*BLANK    P5N0TX           PL State Code
     C                     MOVEL*BLANK    P5QTST           PL Site ID Requ
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    P5A8TX           PL Name
     C                     Z-ADDAFGLNB    WUGLNB           Pl VND Address
     C                     MOVELAFN0TX    P5N0TX           PL State Code
     C                     MOVELAFQTST    P5QTST           PL Site ID Requ
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AEHMNB    WQTA01           BOH Company Num
     C           *LIKE     DEFN AEBNNB    WQTA02           BOH Buy Order N
     C           *LIKE     DEFN AEBONB    WQTA03           BOL Load Number
     C           *LIKE     DEFN AEE0DT    WQTA04           DSH Kill Date
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           BOH Company Num
     C                     KFLD           WQTA02           BOH Buy Order N
     C                     KFLD           WQTA03           BOL Load Number
     C                     KFLD           WQTA04           DSH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTA03           BOL Load Number
     C                     Z-ADDP1B0DT    WQTA04           DSH Kill Date
      * Establish starting position
     C           KRSTA     SETLL@AECPI5                    *
     C           KRSTA     READE@AECPI5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1028' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1THHD           DSD Farm Site C
     C                     Z-ADD*ZERO     WUOXNB           DSD Movement Nu
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAEH1A1    P1THHD           DSD Farm Site C
     C                     Z-ADDAEH3A1    WUOXNB           DSD Movement Nu
     C                     GOTO TAEXIT                     *QUIT
     C           KRSTA     READE@AECPI5                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Movement NumbMtechRT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQTB01           BOH Company Num
     C           *LIKE     DEFN WCBNNB    WQTB02           BOH Buy Order N
     C           *LIKE     DEFN WCBONB    WQTB03           BOL Load Number
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           BOH Company Num
     C                     KFLD           WQTB02           BOH Buy Order N
     C                     KFLD           WQTB03           BOL Load Number
      * Setup key
     C                     Z-ADDP1HMNB    WQTB01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTB02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTB03           BOL Load Number
      * Establish starting position
     C           KRSTB     SETLL@AFCPI4                    *
     C           KRSTB     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P1THHD           DT Farm Site Co
     C                     Z-ADD*ZERO     WUOXNB           DT Movement Num
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCICA1    P1THHD           DT Farm Site Co
     C                     Z-ADDWCIEA1    WUOXNB           DT Movement Num
     C           KRSTB     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EJHONB    WQTC01           CC Company Numb
     C           *LIKE     DEFN EJBNNB    WQTC02           BOH Buy Order N
     C           *LIKE     DEFN EJBONB    WQTC03           BOL Load Number
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           CC Company Numb
     C                     KFLD           WQTC02           BOH Buy Order N
     C                     KFLD           WQTC03           BOL Load Number
      * Setup key
     C                     Z-ADDP1OXNB    WQTC01           CC Company Numb
     C                     Z-ADDP1BNNB    WQTC02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTC03           BOL Load Number
      * Establish starting position
     C           KRSTC     SETLL@EJCPBK                    *
     C           KRSTC     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUOXNB           BOLW Movement N
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEJBOMV    WUOXNB           BOLW Movement N
     C                     GOTO TCEXIT                     *QUIT
     C           KRSTC     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get Defect/Hd
      *================================================================
     C                     MOVEL*BLANK    #DGUCD           Defect User  1
     C                     MOVEL*BLANK    #DGVCD           Defect User  2
     C                     MOVEL*BLANK    #DGWCD           Defect User  3
     C                     MOVEL*BLANK    #DGXCD           Defect User  4
     C                     MOVEL*BLANK    #DGYCD           Defect User  5
     C                     MOVEL*BLANK    #DGZCD           Defect User  6
     C                     MOVEL*BLANK    #DG0CD           Defect User  7
     C                     MOVEL*BLANK    #DG1CD           Defect User  8
     C                     MOVEL*BLANK    #DG2CD           Defect User  9
     C                     MOVEL*BLANK    #DG3CD           Defect User 10
     C                     Z-ADD*ZERO     #DF1NB           Defect HD user
     C                     Z-ADD*ZERO     #DFWNB           Defect HD user
     C                     Z-ADD*ZERO     #DFYNB           Defect HD user
     C                     Z-ADD*ZERO     #DFUNB           Defect HD user
     C                     Z-ADD*ZERO     #DO3NB           Defect HD user
     C                     Z-ADD*ZERO     #DO4NB           Defect HD user
     C                     Z-ADD*ZERO     #DO5NB           Defect HD user
     C                     Z-ADD*ZERO     #DFONB           Defect HD user
     C                     Z-ADD*ZERO     #DFXNB           Defect HD user
     C                     Z-ADD*ZERO     #DFTNB           Defect HD user
      * Rtv Tattoo Def-10&Cls RT - Tattoo Defect  * 
     C                     EXSR SGRVGN
      * CASE: DTL.TH Hog Class Type is Not Market
     C           #1LLST    IFEQ 'R'                        *IF
     C           #1LLST    OREQ 'S'
      * If Resale/internal
      * CASE: WRK.@Status Internal (Y/N) is Yes
     C           WUKPST    IFEQ 'Y'                        *IF
      * Chk Def Scale Wt Req  IF
      * If any defect has scale weight required, quit checking the defect
     C                     MOVEL'N'       WUR3ST           Scale Wt Requir
      * CASE: PAR.Defect User  1 NE WRK.Blank USR
     C           #DGUCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SHRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  2 NE WRK.Blank USR
     C           #DGVCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SIRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  3 NE WRK.Blank USR
     C           #DGWCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SJRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  4 NE WRK.Blank USR
     C           #DGXCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SKRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  5 NE WRK.Blank USR
     C           #DGYCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SLRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  6 NE WRK.Blank USR
     C           #DGZCD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SMRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  7 NE WRK.Blank USR
     C           #DG0CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SNRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  8 NE WRK.Blank USR
     C           #DG1CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SORVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User  9 NE WRK.Blank USR
     C           #DG2CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SPRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Defect User 10 NE WRK.Blank USR
     C           #DG3CD    IFNE WUCRTX                     *IF
      * Rtv Scale Wt Req      RT - Hog Defect  * 
     C                     EXSR SQRVGN
      * CASE: WRK.DF Scale Weight Required is Yes
     C           WUR2ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUR3ST           Scale Wt Requir
     C                     END                             *FI
     C                     END                             *FI
      * If Defect Scale Wgt Req dont calc TH Head Received
      * CASE: WRK.Scale Wt Required     USR is Yes
     C           WUR3ST    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     #DB5NB           Head Total USR
     C                     MOVEL*BLANK    #DCMCD           Pen Number
     C                     MOVEL*BLANK    WUCBCD           Pen Usr
     C                     ELSE
      * CASE: *OTHERWISE
      * Rsl/Int-- Sum Defect head
      * DTL.Head Total USR =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10)
      * x1    : DTL.Defect HD user 1
      * +     : PGM.*Synon (17,7) work field
      * x2    : DTL.Defect HD user 2
      * +     : PGM.*Synon (17,7) work field
      * x3    : DTL.Defect HD user 3
      * +     : PGM.*Synon (17,7) work field
      * x4    : DTL.Defect HD user 4
      * +     : PGM.*Synon (17,7) work field
      * x5    : DTL.Defect HD user 5
      * +     : PGM.*Synon (17,7) work field
      * x6    : DTL.Defect HD user 6
      * +     : PGM.*Synon (17,7) work field
      * x7    : DTL.Defect HD user 7
      * +     : PGM.*Synon (17,7) work field
      * x8    : DTL.Defect HD user 8
      * +     : PGM.*Synon (17,7) work field
      * x9    : DTL.Defect HD user 9
      * +     : PGM.*Synon (17,7) work field
      * x10   : DTL.Defect HD user 10
     C           #DF1NB    ADD  #DFWNB    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  #DFYNB    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  #DFUNB    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  #DO3NB    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  #DO4NB    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  #DO5NB    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  #DFONB    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  #DFXNB    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  #DFTNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    #DB5NB           Head Total USR
      * Rtv Pen
      * Rtv Tattoo Detail     RT - Tattoo Detail  * 
     C                     EXSR SRRVGN
     C                     MOVEL#DCMCD    WUCBCD           Pen Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * validation of Defects
      *================================================================
      * Validate Class Type
     C                     EXSR UCSUBR                     Validate Class
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Validate Class Type
      *================================================================
      * val 1
      * CASE: DTL.Defect User  1 is Entered
     C           #DGUCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGUCD    PARM #DGUCD    WQ0037  6        DF Defect Code
     C           #DCLSS    PARM #DCLSS    WQ0038  1        DF Classificati
     C                     PARM #1LLST    WQ0039  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0040  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0003           TH Hog Class Ty
     C                     MOVEL#DGUCD    ZA0004           Defect User  1
     C                     MOVEL#DCLSS    ZA0005           Class Df 1 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 2
      * CASE: DTL.Defect User  2 is Entered
     C           #DGVCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGVCD    PARM #DGVCD    WQ0041  6        DF Defect Code
     C           #DCMSS    PARM #DCMSS    WQ0042  1        DF Classificati
     C                     PARM #1LLST    WQ0043  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0044  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0006           TH Hog Class Ty
     C                     MOVEL#DGVCD    ZA0007           Defect User  2
     C                     MOVEL#DCMSS    ZA0008           Class Df 2 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 3
      * CASE: DTL.Defect User  3 is Entered
     C           #DGWCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGWCD    PARM #DGWCD    WQ0045  6        DF Defect Code
     C           #DCNSS    PARM #DCNSS    WQ0046  1        DF Classificati
     C                     PARM #1LLST    WQ0047  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0048  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0009           TH Hog Class Ty
     C                     MOVEL#DGWCD    ZA0010           Defect User  3
     C                     MOVEL#DCNSS    ZA0011           Class Df 3 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 4
      * CASE: DTL.Defect User  4 is Entered
     C           #DGXCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGXCD    PARM #DGXCD    WQ0049  6        DF Defect Code
     C           #DCOSS    PARM #DCOSS    WQ0050  1        DF Classificati
     C                     PARM #1LLST    WQ0051  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0052  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0012           TH Hog Class Ty
     C                     MOVEL#DGXCD    ZA0013           Defect User  4
     C                     MOVEL#DCOSS    ZA0014           Class Df 4 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 5
      * CASE: DTL.Defect User  5 is Entered
     C           #DGYCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGYCD    PARM #DGYCD    WQ0053  6        DF Defect Code
     C           #DCPSS    PARM #DCPSS    WQ0054  1        DF Classificati
     C                     PARM #1LLST    WQ0055  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0056  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0015           TH Hog Class Ty
     C                     MOVEL#DGYCD    ZA0016           Defect User  5
     C                     MOVEL#DCPSS    ZA0017           Class Df 5 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 6
      * CASE: DTL.Defect User  6 is Entered
     C           #DGZCD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DGZCD    PARM #DGZCD    WQ0057  6        DF Defect Code
     C           #DCQSS    PARM #DCQSS    WQ0058  1        DF Classificati
     C                     PARM #1LLST    WQ0059  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0060  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0018           TH Hog Class Ty
     C                     MOVEL#DGZCD    ZA0019           Defect User  6
     C                     MOVEL#DCQSS    ZA0020           Class Df 6 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 7
      * CASE: DTL.Defect User  7 is Entered
     C           #DG0CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG0CD    PARM #DG0CD    WQ0061  6        DF Defect Code
     C           #DCRSS    PARM #DCRSS    WQ0062  1        DF Classificati
     C                     PARM #1LLST    WQ0063  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0064  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0021           TH Hog Class Ty
     C                     MOVEL#DG0CD    ZA0022           Defect User  7
     C                     MOVEL#DCRSS    ZA0023           Class Df 7 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 8
      * CASE: DTL.Defect User  8 is Entered
     C           #DG1CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG1CD    PARM #DG1CD    WQ0065  6        DF Defect Code
     C           #DCSSS    PARM #DCSSS    WQ0066  1        DF Classificati
     C                     PARM #1LLST    WQ0067  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0068  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0024           TH Hog Class Ty
     C                     MOVEL#DG1CD    ZA0025           Defect User  8
     C                     MOVEL#DCSSS    ZA0026           Class Df 8 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 9
      * CASE: DTL.Defect User  9 is Entered
     C           #DG2CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG2CD    PARM #DG2CD    WQ0069  6        DF Defect Code
     C           #DCTSS    PARM #DCTSS    WQ0070  1        DF Classificati
     C                     PARM #1LLST    WQ0071  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0072  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0027           TH Hog Class Ty
     C                     MOVEL#DG2CD    ZA0028           Defect User  9
     C                     MOVEL#DCTSS    ZA0029           Class Df 9 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * val 10
      * CASE: DTL.Defect User 10 is Entered
     C           #DG3CD    IFNE *BLANK                     *IF
      * Val Market Defect     XF - Hog Defect  * 
     C                     CALL 'PLL6XFR'              90  Val Market Defe
     C                     PARM *BLANK    W0RTN   7
     C           #DG3CD    PARM #DG3CD    WQ0073  6        DF Defect Code
     C           #DCUSS    PARM #DCUSS    WQ0074  1        DF Classificati
     C                     PARM #1LLST    WQ0075  1        TH Hog Class Ty
     C           YL0005    PARM *BLANK    WQ0076  7        *Return code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PLL6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*Return code is Error Found
     C           YL0005    IFEQ 'ERROR'                    *IF
      * Setup message data for message
     C                     MOVELP1LLST    ZA0030           TH Hog Class Ty
     C                     MOVEL#DG3CD    ZA0031           Defect User 10
     C                     MOVEL#DCUSS    ZA0032           Class Df 10 Usr
      * Send message 'Defect NAllow on Hog Type'
     C                     MOVEL'PRK1197' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E11288 JJH 07/25/17 - Tattoo Header Modifications
      * - Since we are preventing modifications to Tattoo Header after it
      *   has been paid, this Display function is being created to provid
      *   user with the ability to view the Tattoo Header.
      * - Copied from Edt Tattoo Hdr/Defect  ER (PKKIE1R)
      * - Remove F4=Prompt, and all '+' Signs
      * - Remove logic to Set Cursor
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Modification History Created IS 061308 slm
      *================================================================
      * ***** Change log
      * PK0495 12/12/02  1) Remove ref/upd of the Group Reference Code US
      * 2) Update"Delivered Head"in the Delivery Tracking with "Load Head
      * 3) Group Ref is Optional on the screen now. May be used f/ EXT.
      * *****
      * 8/7/03 RMC Per Jancie - dont default BOL Shipped Head
      * *****
      * 12/27/05 LJB - 1. Add PS Site ID to screen - Non-display if
      *    LCL.Site ID Required from Producer Location file = "N"
      *    2. If Site ID is prompted, call Select Producer Site Mileage
      *    3. If Site ID is entered, Producer Site Mileage must exist
      *    else, error
      *    4. If LCL.Site ID Required = Y and DTL.TH Source Code = "CPR"
      *    then Site ID is a requried entry.
      *    5. If Site ID is entered, Tattoo Header EXT is updated
      * *****
      * 01/16/05 SLM -    Additional rules for site id
      *    6. If Resale do not require Site ID
      * *****
      * 03/07/2006 LJB  The State field on the screen was reverting to
      * ** the value retrieved from the file when it had been changed
      * ** on the screen. This was due to the initially retrieved value
      * ** being saved in a hidden field. The screen value was then
      * ** replaced with the hidden value. References to the hidden field
      * ** have been commented out and the entered value is retained.
      * ** The hidden value will only be used if the state is cleared out
      * *****
      * 04/26/06 SLM -    Additional rules for site id
      *   The State Cde will now reside in the Prod site mileage db
      *   get the 3 position field from there to populate the th state co
      *   the th state code
      *   3 pos. TH STATE CODE replace the oms state code usr (2 pos)
      *   use the same routines on the maintenance of the producer
      *   location  - the Vnd Routines.  with a 3 position field
      *   this is also the validation of state code and getting the
      *   description of the state code.
      *   If a Tattoo is in *chg do not replace the State Code if state
      *   is different then site.
      *   If a Tattoo is in *chg and the user select f4 on the site and
      *   selection occurs then replace the th state code
      * 5/16/08 SLM E00151 Producer Site validation regardless of Contrac
      * This is no effect to guymon due to they do not use the
      * the producer site file
      * 6/12/08 SLM E00144 LFT head and EUT/KOA head allow
      *             use of the defect with Market Hogs
      * 9/19/08 SLM E00150 Allow Producer Subsidiary defined at Tattoo
      * Header Ext
      * 9/19/08 SLM E00150 Allow Producer Subsidiary defined at Tattoo
      * Header Ext
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0101  30       BOH Company Num
     C                     PARM @CN,002   WQ0102 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0103 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0002           MTech Live Yes
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Producer work for remainder of program
      *================================================================
      * CASE: PAR.TH Hog Class Type is Market
     C           P1LLST    IFEQ 'M'                        *IF
      * Rtv ProdSubsidiaryPrc RT - Producer Subsidiary  * 
     C                     EXSR SVRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUDJSS           Producer Subsid
     C                     END                             *FI
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR SWRVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SYRVGN
      * PAR.SR Type Desc = Condition name of PAR.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM P3IXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           P4ISTX    PARM           W0CNNM 25        SR Type Desc
      *
      * Rtv PL Vnd Nbr, state RT - Producer Location  * 
     C                     EXSR SZRVGN
      * CASE: PAR.TH Hog Class Type is Resale
     C           P1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'A'       WUECSS           Allow User to E
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.PL Site ID Required is Yes
     C           P5QTST    IFEQ 'Y'                        *IF
      * used on the state code
     C                     MOVEL*BLANK    WUECSS           Allow User to E
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'A'       WUECSS           Allow User to E
      * CASE: PAR.SR Type is Internal
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL*BLANK    WUECSS           Allow User to E
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Get Hps movement and hps farm site - Add mode only
      *================================================================
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.SR Type is Internal
      *   |- c2    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3IXST    IFEQ 'I'                        *IF
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Mvmnt,Farm f/BOL  RT - Delivery Sched Detail  * 
     C                     EXSR TARVGN
      * If TH HPS Movement Ref # is zeros, retrieve value  DLV TRACK
      * CASE: WRK.TH HPS Movement Ref # EQ WRK.Zero USR
     C           WUOXNB    IFEQ WUE9NB                     *IF
      * movement and farm site
      * Rtv Movement NumbMtechRT - Delivery Tracking  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
      * If TH HPS Movement Ref # is zeros, retrieve value  BOLW
      * CASE: WRK.TH HPS Movement Ref # EQ WRK.Zero USR
     C           WUOXNB    IFEQ WUE9NB                     *IF
      * movement and farm site
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR TCRVGN
     C                     Z-ADD*ZERO     P1THHD           TH HPS Farm Sit
     C                     END                             *FI
      * If TH HPS Movement Ref # is still zeros - load default value
      * CASE: WRK.TH HPS Movement Ref # EQ WRK.Zero USR
     C           WUOXNB    IFEQ WUE9NB                     *IF
      * movement and farm site
     C                     Z-ADDP1OXNB    WUOXNB           TH HPS Movement
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1CVNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(DTL) #1BONB' defaulted for 'BOL Load Number'.
      * Field '(DTL) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(DTL) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PWLHSRR'              90  Sel Tattoo Head
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0030  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0031  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0032  50       BOL Load Number
     C           #1CVNB    PARM #1CVNB    WQ0033  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0034  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWLHSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P1ABCD' defaulted for 'PD Producer Code'.
      * Field '(PAR) P1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0096  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0097  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0098  50       BOL Load Number
     C                     PARM P1ABCD    WQ0099  6        PD Producer Cod
     C                     PARM P1AECD    WQ0100  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBAX    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KLVBAX    CHAIN@AXCPBX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0051' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1CVNB'  YPMTFD           TH Tattoo Numbe
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     P1THHD           TH HPS Farm Sit
     C                     MOVEL*BLANK    P2DRTX           State
     C                     MOVEL*BLANK    P3AACD           SR Source Code
     C                     MOVEL*BLANK    P3AFTX           SR Description
     C                     MOVEL*BLANK    P3IXST           SR Type
     C                     MOVEL*BLANK    P4ISTX           SR Type Desc
     C                     MOVEL*BLANK    P5A8TX           PL Name
     C                     MOVEL*BLANK    P5N0TX           PL State Code
     C                     MOVEL*BLANK    P5QTST           PL Site ID Requ
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Ship Wgt Allow Ent Usr
     C                     MOVEL*BLANK    WUNEST  1
      * Define work field Held Over Records Y/N
     C                     MOVEL*BLANK    WUNFST  1
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field HPS Farm County
     C                     MOVEL*BLANK    WUQGTX 25
      * Define work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    WUJXCD  5
      * Define work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    WUQFTX 25
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field @Status Internal (Y/N)
     C                     MOVEL*BLANK    WUKPST  1
      * Define work field Display Output Only Usr
     C                     MOVEL*BLANK    WUL9ST  1
      * Define work field Display Output Only 2 USR
     C                     MOVEL*BLANK    WUMAST  1
      * Define work field Defect Count Usr
     C                     Z-ADD*ZERO     WUODNB  30
      * Define work field Scale Wt Required     USR
     C                     MOVEL*BLANK    WUR3ST  1
      * Define work field DF Scale Weight Required
     C                     MOVEL*BLANK    WUR2ST  1
      * Define work field Pen Usr
     C                     MOVEL*BLANK    WUCBCD  3
      * Define work field Pen Company Number
     C                     Z-ADD*ZERO     WUHVNB  30
      * Define work field TH Live Purchase UOM
     C                     MOVEL*BLANK    WUCPST  2
      * Define work field TH Live Purchase Price
     C                     Z-ADD*ZERO     WUACPR  52
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WAEZDT           TP Tattoo Date
     C                     Z-ADD*ZERO     WAHSA1           TP Tattoo Numbe
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAHRA1           Employee ID
     C                     Z-ADD*ZERO     WABKTM           TP Tattoo Creat
     C                     Z-ADD*ZERO     WAMIA1           Employee Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field @Print Status
     C                     MOVEL*BLANK    WUCZST  1
      * Define work field *Return code
     C                     MOVEL*BLANK    WURTN   7
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Producer Subsidiary SUSR
     C                     MOVEL*BLANK    WUDJSS  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBSKA1           SB User Quantit
     C                     Z-ADD*ZERO     WBSLA1           SB User Quantit
     C                     Z-ADD*ZERO     WBSMA1           SB User Quantit
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field PD VND Address Number
     C                     Z-ADD*ZERO     WUGCNB  80
      * Define work field M3 Supplier ID
     C                     MOVEL*BLANK    WUQHCD 10
      * Define work field Pl VND Address Number
     C                     Z-ADD*ZERO     WUGLNB  80
      * Define work field Allow User to Enter Usr
     C                     MOVEL*BLANK    WUECSS  1
      * Define work field TH HPS Movement Ref #
     C                     Z-ADD*ZERO     WUOXNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHONB           CC Company Numb
     C                     Z-ADD*ZERO     WCE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WCE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     WCAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     WCH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WCFXDT           DT Actual Kill
     C                     Z-ADD*ZERO     WCJIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     WCIBA1           DT Scheduled Ho
     C                     Z-ADD*ZERO     WCICA1           DT Farm Site Co
     C                     Z-ADD*ZERO     WCIDA1           DT Delivered He
     C                     Z-ADD*ZERO     WCIPA1           DT Delivered We
     C                     Z-ADD*ZERO     WCIEA1           DT Movement Num
     C                     Z-ADD*ZERO     WCFADT           DT Transprtn Of
     C                     Z-ADD*ZERO     WCAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     WCBYTH           DT Arrive@Frm v
     C                     Z-ADD*ZERO     WCFBDT           DT Route Start
     C                     Z-ADD*ZERO     WCALTH           DT Route Start
     C                     Z-ADD*ZERO     WCBVTH           DT Route Start
     C                     Z-ADD*ZERO     WCAMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     WCFCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     WCANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     WCBHTH           DT Drive Time T
     C                     Z-ADD*ZERO     WCFDDT           DT Start Loadin
     C                     Z-ADD*ZERO     WCAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     WCBWTH           DT Start Loadin
     C                     Z-ADD*ZERO     WCAPTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     WCFEDT           DT Frm End Load
     C                     Z-ADD*ZERO     WCAQTH           DT Frm End Load
     C                     Z-ADD*ZERO     WCARTH           DT Load Time
     C                     Z-ADD*ZERO     WCFFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     WCASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     WCATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     WCFGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WCAUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WCFHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WCAVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WCAWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WCBKTH           DT Drive Time T
     C                     Z-ADD*ZERO     WCBLTH           DT Delv Time Va
     C                     Z-ADD*ZERO     WCFIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WCAXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WCAYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WCFJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     WCAZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     WCA0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WCFKDT           DT Start Unload
     C                     Z-ADD*ZERO     WCA1TH           DT Start Unload
     C                     Z-ADD*ZERO     WCA2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WCFLDT           DT End Unload D
     C                     Z-ADD*ZERO     WCA3TH           DT End Unload T
     C                     Z-ADD*ZERO     WCA4TH           DT Unload Time
     C                     Z-ADD*ZERO     WCBTTH           DT Unload Varia
     C                     Z-ADD*ZERO     WCFMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WCA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WCA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     WCBXTH           DT Formula Wait
     C                     Z-ADD*ZERO     WCFYDT           DT Unused Date
     C                     Z-ADD*ZERO     WCB0TH           DT Unused Time
     C                     Z-ADD*ZERO     WCBZTH           DT Unused Wait
     C                     Z-ADD*ZERO     WCH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WCJ2A1           DT Head Receive
     C                     Z-ADD*ZERO     WCJ3A1           DT Weight Recei
     C                     Z-ADD*ZERO     WCKMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WCJ4A1           DT Head DOA
     C                     Z-ADD*ZERO     WCJ5A1           DT Weight DOA
     C                     Z-ADD*ZERO     WCJ6A1           DT Head Yard De
     C                     Z-ADD*ZERO     WCJ7A1           DT Weight Yard
     C                     Z-ADD*ZERO     WCJ8A1           DT Head Condemn
     C                     Z-ADD*ZERO     WCJ9A1           DT Weight Conde
     C                     Z-ADD*ZERO     WCKAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     WCKBA1           DT Weight Held
     C                     Z-ADD*ZERO     WCKCA1           DT Head Killed
     C                     Z-ADD*ZERO     WCKDA1           DT Weight Kille
     C                     Z-ADD*ZERO     WCKEA1           DT Head Market
     C                     Z-ADD*ZERO     WCKFA1           DT Weight Marke
     C                     Z-ADD*ZERO     WCKNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     WCKGA1           DT Head Resale
     C                     Z-ADD*ZERO     WCKHA1           DT Weight Resal
     C                     Z-ADD*ZERO     WCKOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WCKIA1           DT Head Unused
     C                     Z-ADD*ZERO     WCKJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WCKKA1           DT Head Unused
     C                     Z-ADD*ZERO     WCKLA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Display Output Only 4 USR
     C                     MOVEL*BLANK    WUFSSS  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0001  6
      * Define local work field Record Change Usr
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0002  1
      * Define null work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    YN0002 25
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0003 20
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0004 20
      * Define local work field State
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Return Code USR
     C                     MOVEL*BLANK    YL0004  7
      * Define null work field DT Farm Site Code
     C                     Z-ADD*ZERO     YN0005  50
      * Define local work field *Return code
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field Record Added Usr
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Text 7 USR
     C                     MOVEL*BLANK    YL0007  7
      * Define local work field Amount USR
     C                     Z-ADD*ZERO     YL0008  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UDSUBR                     Modifications a
      * E00150 Prod/Subsidiary
      * 09/19/08 SLM E00150 Add the Producer Subsidiary to the
      * Tattoo Header Ext  -- Only on non Resale hogs
      * Allow the user to inter the Producer Subsidiary for this
      * tattoo if the Producer Subsidiary has records for any subsidiary
      * then the Producer Subsidiary code will be required for this tatto
      * Modification History Created IS 061308 slm
     C                     EXSR UESUBR                     Modification Hi
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     MOVEL'N'       YL0006           Record Added Us
     C                     MOVEL'N'       YL0001           Record Change U
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UFSUBR                     Get the MTech L
      * Producer work for remainder of program
     C                     EXSR UGSUBR                     Producer work f
      * E11288 JJH 07/25/17 - Remove *Program Mode is *ADD
      * Get Hps movement and hps farm site - Add mode only
     C                     EXSR UHSUBR                     Get Hps movemen
      * Rules: Screen with Mtech Live and Internal Producer
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUFSSS           Display Output
      * CASE: PAR.SR Type is Internal
     C           P3IXST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       WUFSSS           Display Output
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUFSSS           Display Output
     C                     END                             *FI
      * The following field will now be opened to allow entry on internal
      * hogs, movement, farm site, and farm site will go get the
      * the state code
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0002    IFEQ 'N'                        *IF
      * Internal farm site
     C                     MOVEL'N'       WUFSSS           Display Output
     C                     END                             *FI
     C                     END                             *FI
      * H16853 ISE 11/02/2020 CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 *INSURED*
00002 MTECHLIVE
