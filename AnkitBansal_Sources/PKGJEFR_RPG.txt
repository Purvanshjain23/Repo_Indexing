     H/TITLE Edt Drive Card        EF  Edit file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H* - Maintain database file using subfile display
     H* - Existing records may be updated
     H* - Key changes are not allowed
     H* - New records cannot be added
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Edit file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJMIST
     H* Date          : 08/07/25  Time  : 03:48:33
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKGJEFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Edt Drive Card        EF  Edit file
      *
     FPKA2CPL4IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Tattoo Detail             Co/Dr Crd/Tattoo Drv Cdo
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKA3REL5IF  E           K        DISK
      * RSQ : Pen                       Co/Pen/Open
      *
     FPKA2CPLGIF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pen/Kill Date/BOL/Ttt
      *
     FPKA3REL1IF  E           K        DISK
      * RTV : Pen                       Retrieval index
      *
     FPKBXREL1IF  E           K        DISK
      * RTV : Tattoo Detail Process     Retrieval index
      *
     FPKA2CPL8IF  E           K        DISK
      * RSQ : Tattoo Detail             Co/Pen
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKA2CPL0UF  E           K        DISK
      * UPD : Tattoo Detail             Update index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKA3REL0UF  E           K        DISK
      * UPD : Pen                       Update index
      *
      * Screen: Field position and name array
     E                    W0BEG   7 012  5 0A
     E                    W0END   7 012  5 0A
     E                    W0NAM   7 012 10
      * Long constants
     E                    @CN#    1  07  6   @CN    25
     I@A2CPY1
      * Tattoo Detail             Co/Pen/Kill Date/BOL/Ttt
      * Renamed input format fields
     I              A2HMNB                          WAHMNB
     I              A2BNNB                          WABNNB
     I              A2BONB                          WABONB
     I              A2CVNB                          WACVNB
     I              A2B0DT                          WAB0DT
     I              A2C2NB                          WAC2NB
     I              A2CZNB                          WACZNB
     I              A2C0NB                          WAC0NB
     I              A2D8NB                          WAD8NB
     I              A2H7NB                          WAH7NB
     I              A2GGST                          WAGGST
     I              A2AJTM                          WAAJTM
     I              A2JEA1                          WAJEA1
     I              A2B7CD                          WAB7CD
     I              A2D7NB                          WAD7NB
     I              A2D9ST                          WAD9ST
     I              A2E3ST                          WAE3ST
     I              A2E4ST                          WAE4ST
     I              A2E5ST                          WAE5ST
     I              A2BVDT                          WABVDT
     I              A2BWDT                          WABWDT
     I              A2BXDT                          WABXDT
     I              A2HVNB                          WAHVNB
     I              A2CMCD                          WACMCD
     I              A2B9CD                          WAB9CD
     I              A2H8NB                          WAH8NB
     I              A2CYCD                          WACYCD
     I              A2AAVN                          WAAAVN
     I              A2AADT                          WAAADT
     I              A2AMTM                          WAAMTM
     I              A2AJST                          WAAJST
     I              A2AHVN                          WAAHVN
     I              A2AGVN                          WAAGVN
     I              A2ABVN                          WAABVN
     I              A2ABDT                          WAABDT
     I              A2ABTM                          WAABTM
      *
     I@A3REDD
      * Pen                       Retrieval index
      * Renamed input format fields
     I              A3HVNB                          WBHVNB
     I              A3CMCD                          WBCMCD
     I              A3BBTX                          WBBBTX
     I              A3CTNB                          WBCTNB
     I              A3D6NB                          WBD6NB
     I              A3B6CD                          WBB6CD
     I              A3DGST                          WBDGST
     I              A3EBNB                          WBEBNB
     I              A3FWST                          WBFWST
     I              A3HBNB                          WBHBNB
     I              A3AGCD                          WBAGCD
     I              A3AAVN                          WBAAVN
     I              A3AADT                          WBAADT
     I              A3AMTM                          WBAMTM
     I              A3AJST                          WBAJST
     I              A3AHVN                          WBAHVN
     I              A3AGVN                          WBAGVN
     I              A3ABVN                          WBABVN
     I              A3ABDT                          WBABDT
     I              A3ABTM                          WBABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@A2CPKE
      * Tattoo Detail             Co/Pen
      * Renamed input format fields
     I              A2HMNB                          WDHMNB
     I              A2BNNB                          WDBNNB
     I              A2BONB                          WDBONB
     I              A2CVNB                          WDCVNB
     I              A2B0DT                          WDB0DT
     I              A2C2NB                          WDC2NB
     I              A2CZNB                          WDCZNB
     I              A2C0NB                          WDC0NB
     I              A2D8NB                          WDD8NB
     I              A2H7NB                          WDH7NB
     I              A2GGST                          WDGGST
     I              A2AJTM                          WDAJTM
     I              A2JEA1                          WDJEA1
     I              A2B7CD                          WDB7CD
     I              A2D7NB                          WDD7NB
     I              A2D9ST                          WDD9ST
     I              A2E3ST                          WDE3ST
     I              A2E4ST                          WDE4ST
     I              A2E5ST                          WDE5ST
     I              A2BVDT                          WDBVDT
     I              A2BWDT                          WDBWDT
     I              A2BXDT                          WDBXDT
     I              A2HVNB                          WDHVNB
     I              A2CMCD                          WDCMCD
     I              A2B9CD                          WDB9CD
     I              A2H8NB                          WDH8NB
     I              A2CYCD                          WDCYCD
     I              A2AAVN                          WDAAVN
     I              A2AADT                          WDAADT
     I              A2AMTM                          WDAMTM
     I              A2AJST                          WDAJST
     I              A2AHVN                          WDAHVN
     I              A2AGVN                          WDAGVN
     I              A2ABVN                          WDABVN
     I              A2ABDT                          WDABDT
     I              A2ABTM                          WDABTM
      *
     I@A3REDC
      * Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WEHVNB
     I              A3CMCD                          WECMCD
     I              A3BBTX                          WEBBTX
     I              A3CTNB                          WECTNB
     I              A3D6NB                          WED6NB
     I              A3B6CD                          WEB6CD
     I              A3DGST                          WEDGST
     I              A3EBNB                          WEEBNB
     I              A3FWST                          WEFWST
     I              A3HBNB                          WEHBNB
     I              A3AGCD                          WEAGCD
     I              A3AAVN                          WEAAVN
     I              A3AADT                          WEAADT
     I              A3AMTM                          WEAMTM
     I              A3AJST                          WEAJST
     I              A3AHVN                          WEAHVN
     I              A3AGVN                          WEAGVN
     I              A3ABVN                          WEABVN
     I              A3ABDT                          WEABDT
     I              A3ABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKA2CPL0
      * UPD : Tattoo Detail             Update index
      * Current/previous master file format fields for change control
      *
      * Outward parameters
     IPARC        DS                             16
      * KEY : Tattoo Header             Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20PAHMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60PABNNB
      * I : RST BOL Load Number
     I                                    P   7   90PABONB
      * I : RST TH Tattoo Number
     I                                    P  10  120PACVNB
      * I : RST TH Kill Date
     I                                    P  13  160PAB0DT
      *
     IYARDCS      DS                            133
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     IYBRDCS      DS                            583
     IQPKA31    E DSPKA3REL0
      * UPD : Pen                       Update index
      * Renamed input format fields
     I              A3HVNB                          WEHVNB
     I              A3CMCD                          WECMCD
     I              A3BBTX                          WEBBTX
     I              A3CTNB                          WECTNB
     I              A3D6NB                          WED6NB
     I              A3B6CD                          WEB6CD
     I              A3DGST                          WEDGST
     I              A3EBNB                          WEEBNB
     I              A3FWST                          WEFWST
     I              A3HBNB                          WEHBNB
     I              A3AGCD                          WEAGCD
     I              A3AAVN                          WEAAVN
     I              A3AADT                          WEAADT
     I              A3AMTM                          WEAMTM
     I              A3AJST                          WEAJST
     I              A3AHVN                          WEAHVN
     I              A3AGVN                          WEAGVN
     I              A3ABVN                          WEABVN
     I              A3ABDT                          WEABDT
     I              A3ABTM                          WEABTM
      *
     IYCRDCS      DS                            107
     IYDRDCS      DS                            107
     IYERDCS      DS                            107
     IYFRDCS      DS                            107
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             10
      * KEY: Tattoo Detail             Co/Dr Crd/Tattoo Drv Cdo
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST TD Drive Card Number
     I                                    P   3   40P1B7CD
      * I : RST Pen Number
     I                                        5   7 P1CMCD
     IP2PARM      DS
      * FLD: Tattoo Header
      * N : MAP TH Dead On Arrival
     I                                    P   1   30P2CXNB
      * N : MAP TH Head Received
     I                                    P   4   60P2CWNB
      * N : MAP TH Yard Deads
     I                                    P   7   90P2FCNB
     IP3PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P3EVTX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Pen &1 invalid f/held ovr'
      * Pen Held Over
     I                                        1   3 ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Tattoo Det
     C           P3EVTX    PARM           WP0001 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise and load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END
     C                     END
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise & load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      *................................................................
      * Position file
     C           KPOS      KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2B7CD           TD Drive Card N
     C                     KFLD           A2CMCD           Pen Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD#2HMNB    A2HMNB
     C                     Z-ADD#2B7CD    A2B7CD
     C                     MOVEL#2CMCD    A2CMCD
     C                     Z-ADD#2CVNB    A2CVNB
      * 82=EOF
     C           KPOS      SETLL@A2CPIF              82    *
      * 82=EOF
     C           KRST      KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2B7CD           TD Drive Card N
     C                     KFLD           A2CMCD           Pen Number
      * Setup key
     C                     Z-ADD#2HMNB    A2HMNB
     C                     Z-ADD#2B7CD    A2B7CD
     C                     MOVEL#2CMCD    A2CMCD
     C  N82      KRST      READE@A2CPIF                9182*
      * Load subfile page
     C                     EXSR BBLDSF
      *................................................................
      * If no records found, display error message
     C   82      ##RR      IFEQ *ZERO                      IF
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
     C                     SETOF                     84    No SFLNXTCHG
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@A2CPIF                  90*
     C  N82                READ @A2CPIF                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVE *ALL'0'   WKIND0  4
     C                     MOVE *ALL'1'   WKIND1  4
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
     C                     Z-ADD*ZERO     ##RROK  50
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next subfile page
     C  N82      ##RROK    DOWLT##SFLN                     DO
     C                     ADD  1         ##RR
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     87    *
      * Clear subfile fields
     C                     EXSR MAIZ#1
      * Load SFL fields
     C                     EXSR MBFL#1
      * Calculate function fields
     C                     EXSR DG#2FN
      * Record will be selected unless overridden
     C                     MOVEL'Y'       W0RSL   1
      * USER: Initialize subfile record (existing record)
      * Rtv Shift,HldOvrShft  RT - Tattoo Header  * 
     C                     EXSR SARVGN
      * If record dropped...
     C                     SUB  1         ##RR
     C           W0RSL     CABNE'Y'       BB020
     C                     ADD  1         ##RR
      * Validate subfile record and calculate derived fields
     C                     EXSR DFV2RC
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * 82=EOF
     C           KRST      READE@A2CPIF                  82*
     C  N82                END
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                     86
     C           *IN89     IFNE CAIN89
     C           *IN81     ORNE CAIN81
     C                     SETOF                     86
     C                     END
     C                     MOVE *IN89     CAIN89  1
     C                     MOVE *IN81     CAIN81  1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Quit if reload requested
     C           W0RSF     CABEQ'Y'       DAEXIT
      *
     C   81                DO
      * No data entered as yet
     C                     MOVEL'N'       WKIPIN  1
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Process subfile records
     C                     EXSR DBPRSF
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * If data entered
     C           WKIPIN    IFEQ 'Y'
      * Prompt for confirmation
     C                     EXSR DHPRCF
      * Exit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO DAEXIT
     C                     END
      * Update DBF from subfile
     C                     EXSR EAPRSF
      * If error during update, exit:
     C           *IN99     CABEQ'1'       DAEXIT
     C                     END                             WKIPIN
     C                     END
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     SETOF                     87    *
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
      * No errors
     C                     SETOF                     98
      * Data entered
     C                     MOVEL'Y'       WKIPIN
      * SFLNXTCHG
     C                     SETON                     84
      * Validate subfile record
     C                     EXSR DEV1RC
      * If SFLRCD invalid, note the fact
     C   98N99             Z-ADD##RR      ##SFRC     99    *
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         DEV1RC    BEGSR
      *================================================================
      * Validate subfile record
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate subfile record fields
      * * User Defined * Prompts
      * CASE: CTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> RCD.Held Over Pen Number
     C           W0CSRR    IFEQ ##RR                       *
     C           W0CFL     ANDEQ'#1CYCD'                   *IF
      * Sel Pen               SR - Pen  * 
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1HVNB    PARM #1HVNB    WQ0001  30       Pen Company Num
     C           #1CYCD    PARM #1CYCD    WQ0002  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9833  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * * Yard Dead * Validations
      * CASE: RCD.TD Yard Dead GT RCD.TD Pen Head
     C           #1D8NB    IFGT #1C0NB                     *IF
      * Send message 'Yard Deads must <= pen hd'
     C                     MOVEL'PRK0231' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
      * * Held Over * Validations
      * CASE:
      *  - c1 AND c2
      *   |- c1    : RCD.TD Held Over EQ WRK.Zero USR
      *   |- c2    : RCD.Held Over Pen Number EQ WRK.Blank USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1H7NB    IFEQ WUE9NB                     *IF
     C           #1CYCD    IFEQ WUCRTX                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     #1H8NB           Held Over Pen C
     C                     ELSE
      * CASE: *OTHERWISE
      * If hogs are moved to a new pen, it must have an open status
      * CASE: RCD.Held Over Pen Number NE CTL.Pen Number
     C           #1CYCD    IFNE #2CMCD                     *IF
      * Rtv Val Pen-no parms  RT - Pen  * 
     C                     EXSR SBRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1CYCD    ZA0001           Held Over Pen N
      * Send message 'Pen &1 invalid f/held ovr'
     C                     MOVEL'PRK0228' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9833  *
      *
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * Held Over head must be <= # net head in pen
     C           #1C0NB    SUB  #1D8NB    WUB5NB           Head Total USR
      * Rtv Ttt Condemmed Hd  RT - Tattoo Header  * 
     C                     EXSR SCRVGN
     C                     SUB  WUFDNB    WUB5NB           Head Total USR
      * CASE: RCD.TD Held Over GT WRK.Head Total USR
     C           #1H7NB    IFGT WUB5NB                     *IF
      * Send message 'Held over hd must <= pen'
     C                     MOVEL'PRK0227' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DEEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: RCD.TD Held Over EQ WRK.Zero USR
     C           #1H7NB    IFEQ WUE9NB                     *IF
      * Send message 'Held over hd cant be 0'
     C                     MOVEL'PRK0235' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD#1HVNB    #1H8NB           Held Over Pen C
     C                     END                             *FI
      * S029664 JM 04/30/25-Added warning for error Heldover scenario.
      * CASE: *OTHERWISE
      * Rtv HeldOver & Tattoos RT - Tattoo Detail  * 
     C                     EXSR SDRVGN
     C                     Z-ADD#1CVNB    WUMLNB           Tattoo Nbr 4
     C                     MOVEL*BLANK    YL0007           Tattoo 6
     C                     MOVELWUMLNB    YL0007           Tattoo 6
      * CASE: LCL.TD Held Over Status is Ready-Hld Over Processing
     C           YL0006    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * S034163 JM 08/05/25-Include next kill date in warning.
      * CASE: *OTHERWISE
      * Rtv Nxt Kill Dt 2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDUXXFR'              90  Rtv Nxt Kill Dt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1H8NB    WQ0003  30       CC Company Numb
     C                     PARM #1B0DT    WQ0004  70       Kill Date Usr
     C           YL0008    PARM *ZERO     WQ0005  70       Next Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Build Next kill date logic in format MM/DD/YY.
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0009           Next Kill Date
     C                     MOVELYL0008    YL0009           Next Kill Date
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0009:ZQ YL0010    P  90  Year Alpha USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0009:ZQ YL0011    P  90  MM Alpha USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0009:ZQ YL0012    P  90  Day Alpha USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0011    CAT  '/':ZQ    YL0013    P      Date MM/DD/YY U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0013    CAT  YL0012:ZQ YL0013    P      Date MM/DD/YY U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0013    CAT  '/':ZQ    YL0013    P      Date MM/DD/YY U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0013    CAT  YL0010:ZQ YL0013    P      Date MM/DD/YY U
      * S029664 JM 04/30/25-Populate warning messages for HeldOver.
      * CASE:
      *  - (c1 OR c2 OR c3 OR c4 OR c5)
      *   |- c1    : LCL.Tattoo 6              USR EQ LCL.Tattoo 1
      *   |- c2    : LCL.Tattoo 6              USR EQ LCL.Tattoo 2
      *   |- c3    : LCL.Tattoo 6              USR EQ LCL.Tattoo 3
      *   |- c4    : LCL.Tattoo 6              USR EQ LCL.Tattoo 4
      *   |- c5    : LCL.Tattoo 6              USR EQ LCL.tattoo 5
      *   '-
     C           YL0007    IFEQ YL0001                     *IF
     C           YL0007    OREQ YL0002                     *OR
     C           YL0007    OREQ YL0003                     *OR
     C           YL0007    OREQ YL0004                     *OR
     C           YL0007    OREQ YL0005                     *OR
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVEL#1CVNB    YL0014           Tattoo Number A
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  YL0014:ZQ YL0015    P      Text 63 USR
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  @CN,002:ZQYL0015    P      Text 63 USR
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  YL0013:ZQ YL0015    P      Text 63 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  '.':ZQ    YL0015    P      Text 63 USR
     C                     Z-ADD1         ZQ      50
     C           'Pen'     CAT  #1CYCD:ZQ YL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,003:ZQYL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  YL0014:ZQ YL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,004:ZQYL0016    P      Text 63 USR 2
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVEL#1CVNB    YL0014           Tattoo Number A
     C                     Z-ADD1         ZQ      50
     C           @CN,005   CAT  YL0014:ZQ YL0015    P      Text 63 USR
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  @CN,002:ZQYL0015    P      Text 63 USR
     C                     Z-ADD1         ZQ      50
     C           YL0015    CAT  YL0013:ZQ YL0015    P      Text 63 USR
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0015    CAT  '.':ZQ    YL0015    P      Text 63 USR
      * S034163 JM 08/05/25-Display any one tattoo available in Pen in Ms
      * CASE: LCL.Tattoo 1              USR is Entered
     C           YL0001    IFNE '0'                        *IF
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVELYL0001    YL0014           Tattoo Number A
     C                     ELSE
      * CASE: LCL.Tattoo 2              USR is Entered
     C           YL0002    IFNE '0'                        *IF
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVELYL0002    YL0014           Tattoo Number A
     C                     ELSE
      * CASE: LCL.Tattoo 3              USR is Entered
     C           YL0003    IFNE '0'                        *IF
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVELYL0003    YL0014           Tattoo Number A
     C                     ELSE
      * CASE: LCL.Tattoo 4              USR is Entered
     C           YL0004    IFNE '0'                        *IF
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVELYL0004    YL0014           Tattoo Number A
     C                     ELSE
      * CASE: LCL.tattoo 5              USR is Entered
     C           YL0005    IFNE '0'                        *IF
     C                     MOVEL*BLANK    YL0014           Tattoo Number A
     C                     MOVELYL0005    YL0014           Tattoo Number A
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADD1         ZQ      50
     C           'Pen'     CAT  #1CYCD:ZQ YL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,006:ZQYL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,007:ZQYL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  YL0014:ZQ YL0016    P      Text 63 USR 2
     C                     Z-ADD1         ZQ      50
     C           YL0016    CAT  @CN,004:ZQYL0016    P      Text 63 USR 2
     C                     END                             *FI
      * Pmt HeldOver Warning  PV - STR Prompt  * 
     C                     CALL 'PWO3PVR'              90  Pmt HeldOver Wa
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0015    WQ0006 63        Text 63 USR
     C                     PARM YL0016    WQ0007 63        Text 63 USR 2
     C           YL0017    PARM *BLANK    WQ0008  1        Confirm
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWO3PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * S029664 JM 04/30/25-Proceed if user confirmed Yes.
      * CASE: LCL.Confirm               USR is Yes
     C           YL0017    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0DCF            *Defer confirm
     C                     END                             *FI
      * Sum of yard dead, held over, shift held over cannot exceed pen hd
      * PGM.*Synon (17,7) work field =
      *    *COMPUTE (x1 + x2)
      * x1    : RCD.TD Yard Dead
      * +     : PGM.*Synon (17,7) work field
      * x2    : RCD.TD Held Over
     C           #1D8NB    ADD  #1H7NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WD             *Synon (17,7) w
      * CASE: PGM.*Synon (17,7) work field GT RCD.TD Pen Head
     C           W0WD      IFGT #1C0NB                     *IF
      * Send message 'Sum yrds,held > pen'
     C                     MOVEL'PRK0237' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     GOTO DEEXIT                     *QUIT
     C                     END                             *FI
      * * Call Shift Held Over Window  *
      * CASE: RCD.*SFLSEL is *Option 3 (Reusable)
     C           #1SEL     IFEQ '3'                        *IF
      * CASE: RCD.TH Schedule Kill Shift is Shift 2
     C           #RLIST    IFEQ '2'                        *IF
      * Send message 'Option not allowed shft 2'
     C                     MOVEL'PRK0742' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     98    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Edt Shift Held Ovr Hd E1 - Tattoo Header  * 
     C                     CLEARPARC
     C                     Z-ADD#1HMNB    PAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    PABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    PABONB           BOL Load Number
     C                     Z-ADD#1CVNB    PACVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    PAB0DT           TH Kill Date
      *
     C                     CALL 'PKKEE1R'              90  Edt Shift Held
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Tattoo Hea
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKKEE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate subfile record relations
     C                     EXSR DFV2RC
      *================================================================
     CSR         DEEXIT    ENDSR
      /EJECT
     CSR         DFV2RC    BEGSR
      *================================================================
      * Validate subfile record relations
      *================================================================
      * Check reference to Tattoo Header
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Pen
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Tattoo Detail Process
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     98    *
     C                     END
      * Check reference to Pen
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9833  *
     C                     END
      * Calculate function fields
     C                     EXSR DG#2FN
      *================================================================
     CSR         DFEXIT    ENDSR
      /EJECT
     CSR         DG#2FN    BEGSR
      *================================================================
      * Calculate subfile record function fields
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Subfile record function fields
      * RTV Tattoo Record     RT - Tattoo Header  * 
     C                     EXSR SFRVGN
     C                     ADD  WUCWNB    #PCWNB           TH Head Receive
     C                     ADD  WUCXNB    #PCXNB           TH Dead On Arri
     C                     ADD  WUFCNB    #PFCNB           TH Yard Deads
     C                     END
      *================================================================
     CSR         DGEXIT    ENDSR
      /EJECT
     CSR         DHPRCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
      * Update screen time
     C                     TIME           ##TME
      * Force PUTOVR
     C                     SETON                     86
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#SFLCTL
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         EAPRSF    BEGSR
      *================================================================
      * Update DBF from subfile
      *================================================================
      * Initialise subfile reload flag
     C                     MOVEL'N'       W0RSF
      * Process all modified subfile records
     C                     READC#SFLRCD                  92*
     C           *IN92     DOWEQ'0'
      * Process modified subfile record
     C                     EXSR EBPRSR
     C                     MOVEL*BLANK    #1SEL
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      * If any errors, cancel reload
     C           *IN99     IFEQ '1'
     C                     MOVEL'N'       W0RSF   1
     C                     END
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPRSR    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Set off error indicators
     C                     MOVEAWKIND0    *IN,31
     C                     SETOF                     98
      *
      * Process change request
     C                     EXSR EECHRQ
      * If error occurred on update, note the fact
     C           *IN98     IFEQ '1'
     C           *IN99     IFEQ '0'
     C                     Z-ADD##RR      ##SFRC     99    *
     C                     END
     C                     ELSE
      * USER: Extra processing after DBF update
     C                     MOVEL'Y'       W0RSF            *Reload subfile
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Yrd Dead,Hld Ovr  CH - Tattoo Detail  * 
     C                     EXSR SGCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Screen errors
     C                     MOVEAWKIND1    *IN,31
      * Format error
     C                     SETON                     98    *
      * Enable entry
     C                     SETOF                     87    *
      * SFLNXTCHG
     C                     SETON                     84    *
      * Reset subfile record if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1           IF
     C                     END
     C                     ELSE
      * DBF update successful
      * Enable entry
     C                     SETOF                     87    *
      * No SFLNXTCHG
     C                     SETOF                     84    *
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for Subfile record
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect keys if change mode or updated record
     C                     SETON                     88    *
     C   89N87             SETOF                     88    *
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise subfile record
      *================================================================
      * Previous values
     C                     MOVEL*BLANK    #1DBRC
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #1C2NB           TD Sequence Num
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     Z-ADD*ZERO     #1CZNB           TD Live Wgt
     C                     Z-ADD*ZERO     #1AJTM           TD Drive Time
     C                     Z-ADD*ZERO     #1JEA1           TD Drive Hour
     C                     Z-ADDP1B7CD    #1B7CD           TD Drive Card N
     C                     Z-ADD*ZERO     #1D7NB           TD Avg Live Wgt
     C                     MOVEL*BLANK    #1D9ST           TD Gen Bal To K
     C                     MOVEL*BLANK    #1E3ST           TD Recs Created
     C                     MOVEL*BLANK    #1E4ST           TD User Status
     C                     MOVEL*BLANK    #1E5ST           TD User Status
     C                     Z-ADD*ZERO     #1BVDT           TD User Date 1
     C                     Z-ADD*ZERO     #1BWDT           TD User Date 2
     C                     Z-ADD*ZERO     #1BXDT           TD Drive Date
     C                     Z-ADD*ZERO     #1HVNB           Pen Company Num
     C                     MOVELP1CMCD    #1CMCD           Pen Number
     C                     MOVEL*BLANK    #1GGST           TD Held Over St
     C                     MOVEL*BLANK    #1B9CD           TDP Process Cod
     C                     Z-ADD*ZERO     #1H8NB           Held Over Pen C
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #1CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     MOVEL*BLANK    #RLIST           TH Schedule Kil
     C                     Z-ADD*ZERO     #1C0NB           TD Pen Head
     C                     Z-ADD*ZERO     #1D8NB           TD Yard Dead
     C                     MOVEL*BLANK    #1CYCD           Held Over Pen N
     C                     Z-ADD*ZERO     #1H7NB           TD Held Over
     C                     MOVEL*BLANK    #RLJST           TH Shift Held O
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @A2CPIF fields to subfile
      *================================================================
     C                     Z-ADDA2HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDA2C2NB    #1C2NB           TD Sequence Num
     C                     Z-ADDA2BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    #1BONB           BOL Load Number
     C                     Z-ADDA2CZNB    #1CZNB           TD Live Wgt
     C                     Z-ADDA2AJTM    #1AJTM           TD Drive Time
     C                     Z-ADDA2JEA1    #1JEA1           TD Drive Hour
     C                     Z-ADDA2B7CD    #1B7CD           TD Drive Card N
     C                     Z-ADDA2D7NB    #1D7NB           TD Avg Live Wgt
     C                     MOVELA2D9ST    #1D9ST           TD Gen Bal To K
     C                     MOVELA2E3ST    #1E3ST           TD Recs Created
     C                     MOVELA2E4ST    #1E4ST           TD User Status
     C                     MOVELA2E5ST    #1E5ST           TD User Status
     C                     Z-ADDA2BVDT    #1BVDT           TD User Date 1
     C                     Z-ADDA2BWDT    #1BWDT           TD User Date 2
     C                     Z-ADDA2BXDT    #1BXDT           TD Drive Date
     C                     Z-ADDA2HVNB    #1HVNB           Pen Company Num
     C                     MOVELA2CMCD    #1CMCD           Pen Number
     C                     MOVELA2GGST    #1GGST           TD Held Over St
     C                     MOVELA2B9CD    #1B9CD           TDP Process Cod
     C                     Z-ADDA2H8NB    #1H8NB           Held Over Pen C
     C                     MOVELA2AAVN    #1AAVN           RS User Changed
     C                     Z-ADDA2AADT    #1AADT           RS Date Changed
     C                     Z-ADDA2AMTM    #1AMTM           RS Time Changed
     C                     MOVELA2AJST    #1AJST           RS Record Statu
     C                     MOVELA2AHVN    #1AHVN           RS Job
     C                     MOVELA2AGVN    #1AGVN           RS Program
     C                     MOVELA2ABVN    #1ABVN           RS User Added
     C                     Z-ADDA2ABDT    #1ABDT           RS Date Added
     C                     Z-ADDA2ABTM    #1ABTM           RS Time Added
     C                     Z-ADDA2CVNB    #1CVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    #1B0DT           TH Kill Date
     C                     Z-ADDA2C0NB    #1C0NB           TD Pen Head
     C                     Z-ADDA2D8NB    #1D8NB           TD Yard Dead
     C                     MOVELA2CYCD    #1CYCD           Held Over Pen N
     C                     Z-ADDA2H7NB    #1H7NB           TD Held Over
      * Hold current record image for change detection
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     Z-ADDP1HMNB    #2HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #2CVNB           TH Tattoo Numbe
     C                     Z-ADDP2CWNB    #PCWNB           TH Head Receive
     C                     Z-ADDP2CXNB    #PCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #CEDNB           Head Held Over
     C                     Z-ADDP2FCNB    #PFCNB           TH Yard Deads
     C                     Z-ADDP1B7CD    #2B7CD           TD Drive Card N
     C                     MOVELP1CMCD    #2CMCD           Pen Number
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Shift,HldOvrShft  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSA     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #RLIST           TH Schedule Kil
     C                     MOVEL*BLANK    #RLJST           TH Shift Held O
     C                     Z-ADD*ZERO     WUT2HD           TH Shift Held O
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA1LIST    #RLIST           TH Schedule Kil
     C                     MOVELA1LJST    #RLJST           TH Shift Held O
     C                     Z-ADDA1T2HD    WUT2HD           TH Shift Held O
     C                     GOTO SAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Val Pen-no parms  RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A3HVNB    WQSB01           Pen Company Num
     C           *LIKE     DEFN A3CMCD    WQSB02           Pen Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Pen Company Num
     C                     KFLD           WQSB02           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    WQSB01           Pen Company Num
     C                     MOVEL#1CYCD    WQSB02           Pen Number
      * Establish starting position
     C           KRSSB     SETLL@A3REKF                    *
     C           KRSSB     READE@A3REKF                  90*
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Ttt Condemmed Hd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSC     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WUFDNB           TH Head Condemn
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1FDNB    WUFDNB           TH Head Condemn
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv HeldOver & Tattoos RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUP0NB           Count USR
     C                     MOVELWUCRTX    YN0001           @Status +/-
     C                     MOVEL*BLANK    YL0001           Tattoo 1
     C                     MOVEL*BLANK    YL0002           Tattoo 2
     C                     MOVEL*BLANK    YL0003           Tattoo 3
     C                     MOVEL*BLANK    YL0004           Tattoo 4
     C                     MOVEL*BLANK    YL0005           tattoo 5
     C                     MOVEL*BLANK    YL0006           TD Held Over St
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WACMCD    WQSD02           Pen Number
     C           *LIKE     DEFN WAB0DT    WQSD03           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           Pen Number
     C                     KFLD           WQSD03           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSD01           BOH Company Num
     C                     MOVEL#1CYCD    WQSD02           Pen Number
     C                     Z-ADD#1B0DT    WQSD03           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@A2CPY1                    *
     C           KRSSD     READE@A2CPY1                  90*
      * Data record not found
     C   90                MOVEL'PRK0063' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUP0NB           Count USR
     C                     Z-ADDWACVNB    WUMLNB           Tattoo Nbr 4
      * CASE: WRK.Count USR is One
     C           WUP0NB    IFEQ 1                          *IF
     C                     MOVEL*BLANK    YL0001           Tattoo 1
     C                     MOVELWUMLNB    YL0001           Tattoo 1
      * Rtv Shift,HldOvrShft  RT - Tattoo Header  * 
     C                     EXSR SERVGN
      * Populate Held Over flag
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over Status is Ready-Hld Over Processing
      *   |- c2    : DB1.TD Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGGST    IFEQ 'Y'                        *IF
     C           WAH7NB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           TD Held Over St
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUP0NB    IFEQ 2                          *IF
     C                     MOVEL*BLANK    YL0002           Tattoo 2
     C                     MOVELWUMLNB    YL0002           Tattoo 2
      * Populate Held Over flag
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over Status is Ready-Hld Over Processing
      *   |- c2    : DB1.TD Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGGST    IFEQ 'Y'                        *IF
     C           WAH7NB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           TD Held Over St
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUP0NB    IFEQ 3                          *IF
     C                     MOVEL*BLANK    YL0003           Tattoo 3
     C                     MOVELWUMLNB    YL0003           Tattoo 3
      * Populate Held Over flag
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over Status is Ready-Hld Over Processing
      *   |- c2    : DB1.TD Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGGST    IFEQ 'Y'                        *IF
     C           WAH7NB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           TD Held Over St
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUP0NB    IFEQ 4                          *IF
     C                     MOVEL*BLANK    YL0004           Tattoo 4
     C                     MOVELWUMLNB    YL0004           Tattoo 4
      * Populate Held Over flag
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over Status is Ready-Hld Over Processing
      *   |- c2    : DB1.TD Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGGST    IFEQ 'Y'                        *IF
     C           WAH7NB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           TD Held Over St
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUP0NB    IFEQ 5                          *IF
     C                     MOVEL*BLANK    YL0005           tattoo 5
     C                     MOVELWUMLNB    YL0005           tattoo 5
      * Populate Held Over flag
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TD Held Over Status is Ready-Hld Over Processing
      *   |- c2    : DB1.TD Held Over is greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAGGST    IFEQ 'Y'                        *IF
     C           WAH7NB    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       YL0006           TD Held Over St
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUP0NB    IFEQ 6                          *IF
     C                     MOVEL'+'       YN0001           @Status +/-
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@A2CPY1                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Shift,HldOvrShft  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    A1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    A1BONB           BOL Load Number
     C                     Z-ADDWACVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSE     CHAIN@A1CPC4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WULJST           TH Shift Held O
     C                     Z-ADD*ZERO     WUT2HD           TH Shift Held O
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA1LJST    WULJST           TH Shift Held O
     C                     Z-ADDA1T2HD    WUT2HD           TH Shift Held O
     C                     GOTO SEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSF     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    WUAWDT           TH Purchase Dat
     C                     MOVELA1BICD    WUBICD           TH Group Refere
     C                     MOVELA1CPST    WUCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    WUACPR           TH Live Purchas
     C                     MOVELA1C4ST    WUC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    WUAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    WUA6DT           TH Pricing Date
     C                     MOVELA1C2ST    WUC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    WUCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    WUCWNB           TH Head Receive
     C                     Z-ADDA1FCNB    WUFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    WUH9NB           TH Held Over
     C                     Z-ADDA1FDNB    WUFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    WUFENB           TH Head Killed
     C                     Z-ADDA1HENB    WUHENB           TH Head Adds
     C                     Z-ADDA1HFNB    WUHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    WUCYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    WUE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    WUA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    WUFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    WUA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    WUHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    WUF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    WUF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    WUF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    WUF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    WUAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    WUAWPC           TH Actual Yield
     C                     Z-ADDA1A8PC    WUA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    WUA7PC           TH Recalc Live
     C                     Z-ADDA1AMPR    WUAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    WUANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    WUAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    WUAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    WUAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    WUAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    WUAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    WUASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    WUA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    WUATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    WUA5VA           TH Additions Am
     C                     Z-ADDA1A7VA    WUA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    WUA2PR           TH Fixed Cost A
     C                     MOVELA1CWST    WUCWST           TH Payment Sts
     C                     MOVELA1D7ST    WUD7ST           TH Header Error
     C                     MOVELA1D8ST    WUD8ST           TH Detail Error
     C                     MOVELA1DWST    WUDWST           TH Kill Balanci
     C                     MOVELA1D6ST    WUD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    WUGHNB           TH Commission A
     C                     Z-ADDA1BYDT    WUBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    WUE0ST           TH User Error O
     C                     MOVELA1E1ST    WUE1ST           TH Held Over Re
     C                     MOVELA1E2ST    WUE2ST           TH Sex
     C                     Z-ADDA1BSDT    WUBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    WUBTDT           TH Commission P
     C                     Z-ADDA1BUDT    WUBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    WUHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    WUHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    WUHINB           TH FFLI
     C                     Z-ADDA1A3PR    WUA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    WUA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    WUA6PR           TH Render Produ
     C                     Z-ADDA1T2HD    WUT2HD           TH Shift Held O
     C                     MOVELA1BDCD    WUBDCD           DF Defect Code
     C                     MOVELA1CSCD    WUCSCD           THP Process Cod
     C                     MOVELA1ACCD    WUACCD           HB Buyer Code
     C                     MOVELA1AGCD    WUAGCD           GN Genetic Code
     C                     MOVELA1BECD    WUBECD           HC Class Code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Yrd Dead,Hld Ovr  CH - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A2CPDF
     C                     Z-ADD#1HMNB    A2HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A2BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A2BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A2CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A2B0DT           TH Kill Date
     C                     Z-ADD#1C2NB    A2C2NB           TD Sequence Num
      *
     C           KLCHSG    KLIST
     C                     KFLD           A2HMNB           BOH Company Num
     C                     KFLD           A2BNNB           BOH Buy Order N
     C                     KFLD           A2BONB           BOL Load Number
     C                     KFLD           A2CVNB           TH Tattoo Numbe
     C                     KFLD           A2B0DT           TH Kill Date
     C                     KFLD           A2C2NB           TD Sequence Num
     C           KLCHSG    CHAIN@A2CPDF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA2CPL0'MDACP
     C                     MOVEL'@A2CPDF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     GOTO SGEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * USER: Processing after Data read
      * Calculate the net change in Yard Dead and Held Over
      * to be added to the Tattoo Header after data update.
     C           #1D8NB    SUB  A2D8NB    WUD8NB           TD Yard Dead
     C           #1H7NB    SUB  A2H7NB    WUH7NB           TD Held Over
      * Move non-key fields to @A2CPDF
     C                     Z-ADD#1CZNB    A2CZNB           TD Live Wgt
     C                     Z-ADD#1C0NB    A2C0NB           TD Pen Head
     C                     Z-ADD#1D8NB    A2D8NB           TD Yard Dead
     C                     Z-ADD#1H7NB    A2H7NB           TD Held Over
     C                     MOVEL#1GGST    A2GGST    P      TD Held Over St
     C                     Z-ADD#1AJTM    A2AJTM           TD Drive Time
     C                     Z-ADD#1JEA1    A2JEA1           TD Drive Hour
     C                     Z-ADD#1B7CD    A2B7CD           TD Drive Card N
     C                     Z-ADD#1D7NB    A2D7NB           TD Avg Live Wgt
     C                     MOVEL#1D9ST    A2D9ST    P      TD Gen Bal To K
     C                     MOVEL#1E3ST    A2E3ST    P      TD Recs Created
     C                     MOVEL#1E4ST    A2E4ST    P      TD User Status
     C                     MOVEL#1E5ST    A2E5ST    P      TD User Status
     C                     Z-ADD#1BVDT    A2BVDT           TD User Date 1
     C                     Z-ADD#1BWDT    A2BWDT           TD User Date 2
     C                     Z-ADD#1BXDT    A2BXDT           TD Drive Date
     C                     Z-ADD#1HVNB    A2HVNB           Pen Company Num
     C                     MOVEL#1CMCD    A2CMCD    P      Pen Number
     C                     MOVEL#1B9CD    A2B9CD    P      TDP Process Cod
     C                     Z-ADD#1H8NB    A2H8NB           Held Over Pen C
     C                     MOVEL#1CYCD    A2CYCD    P      Held Over Pen N
     C                     MOVEL#1AAVN    A2AAVN    P      RS User Changed
     C                     Z-ADD#1AADT    A2AADT           RS Date Changed
     C                     Z-ADD#1AMTM    A2AMTM           RS Time Changed
     C                     MOVEL#1AJST    A2AJST    P      RS Record Statu
     C                     MOVEL#1AHVN    A2AHVN    P      RS Job
     C                     MOVEL#1AGVN    A2AGVN    P      RS Program
     C                     MOVEL#1ABVN    A2ABVN    P      RS User Added
     C                     Z-ADD#1ABDT    A2ABDT           RS Date Added
     C                     Z-ADD#1ABTM    A2ABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * H16749 SLM
      * replace change date with system date
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     A2AAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           A2AADT    PARM *ZERO     WQ0016  70       *DATE
     C           A2AMTM    PARM *ZERO     WQ0017  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     98    *
     C                     END
     C                     MOVEL##JOB     A2AHVN           RS Job
     C                     MOVEL##PGM     A2AGVN           RS Program
      * If held over head was changed but not to 0,
      * Set Held Over Status to 'Y' for Kill and Night processing routine
      * CASE: WRK.TD Held Over EQ WRK.Zero USR
     C           WUH7NB    IFEQ WUE9NB                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.TD Held Over NE WRK.Zero USR
     C           #1H7NB    IFNE WUE9NB                     *IF
     C                     MOVEL'Y'       A2GGST           TD Held Over St
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    A2GGST           TD Held Over St
     C                     Z-ADD*ZERO     A2H8NB           Held Over Pen C
     C                     END                             *FI
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A2CPDF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA2CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * Move @A2CPDF fields back
     C                     Z-ADDA2CZNB    #1CZNB           TD Live Wgt
     C                     Z-ADDA2C0NB    #1C0NB           TD Pen Head
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Add the net change Yard dead and Held Over to the Tattoo Header
      * Rtv/Chg YrdDd,HldOvr  RT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * Recount Assigned Pen Head and Chg the Pen
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
     C                     EXSR SJRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv/Chg YrdDd,HldOvr  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * HPE034
      * Create a Trucker edit. - Dwight Shepard
      * Purpose:
      * Clone the Trucker report that post and remove
      * all update of vouchers.  Producer the report
      * for the user to sight review before continue on.
      * Modification History
      * Date        Person   Description
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADDA2HMNB    A1HMNB           BOH Company Num
     C                     Z-ADDA2BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADDA2BONB    A1BONB           BOL Load Number
     C                     Z-ADDA2CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADDA2B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           A1FCNB    ADD  WUD8NB    WUFCNB           TH Yard Deads
     C           A1H9NB    ADD  WUH7NB    WUH9NB           TH Held Over
      * ** OLD:  Chg Tattoo Header   CH * Tattoo Header ** (PKP)
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
     C                     EXSR SICHRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Yard/Held Amount  CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0004  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0005  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0006  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0007  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0008  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0009  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0010  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0011  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0012  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0013  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0014  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0015  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0016  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0017  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0018  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0019  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0020  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0021  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0022  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0023  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0024  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0025  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0026  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0027  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0028  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0029  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0030  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0031  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0032  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0033  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0034  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0035  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0036  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0037  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0038  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0039  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0040  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0041  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0042  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0043  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0044  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0045  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0046  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0047  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0048  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0049  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0050  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0051  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0052  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0053  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0054  1        TH Header Error
     C                     MOVEL*BLANK    WN0055  1        TH Detail Error
     C                     MOVEL*BLANK    WN0056  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0057  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0058  80       TH Commission A
     C                     Z-ADD*ZERO     WN0059  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0060  1        TH User Error O
     C                     MOVEL*BLANK    WN0061  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0062  1        TH Sex
     C                     Z-ADD*ZERO     WN0063  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0064  70       TH Commission P
     C                     Z-ADD*ZERO     WN0065  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0066  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0067  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0068  31       TH FFLI
     C                     Z-ADD*ZERO     WN0069  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0070  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0071  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0072  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0073  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0074  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0075  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0076  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0077  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0078  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0079  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0080  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0081  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0082  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0083  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0084  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0085  1        TH Source Type
     C                     MOVEL*BLANK    WN0086  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0087  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0088  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0089  3        TH Source Code
     C                     MOVEL*BLANK    WN0090  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0091  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0092  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0093  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0094  3        TH State
     C                     MOVEL*BLANK    WN0095  3        TH Unused Code
     C                     MOVEL*BLANK    WN0096  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0097  1        TH Commission S
     C                     MOVEL*BLANK    WN0098  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0099  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0100  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0101  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0102  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0103  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0104  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0105  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0106  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0107  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0108  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0109  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0110  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0111  3        TH PHA Average
     C                     MOVEL*BLANK    WN0112  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0113  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0114  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0115  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0116  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0117  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0118  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0119  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0120  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0121  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0122  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0123  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0124  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0125 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0126 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0127 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0128 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0129  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0130  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0131  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0132  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0133  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0134  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0135  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0136  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0137  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0138  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0139  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0140  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0141  70       TH Unused Date
     C                     MOVEL*BLANK    WN0142  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0143  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0144  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0145  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0146  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0147  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0148  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0149  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0150  6        DF Defect Code
     C                     MOVEL*BLANK    WN0151  6        THP Process Cod
     C                     MOVEL*BLANK    WN0152  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0153  6        PL Location Cod
     C                     MOVEL*BLANK    WN0154  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0155  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0156  3        HC Class Code
     C                     MOVEL*BLANK    WN0157 10        RS User Changed
     C                     Z-ADD*ZERO     WN0158  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0159  60       RS Time Changed
     C                     MOVEL*BLANK    WN0160  1        RS Record Statu
     C                     MOVEL*BLANK    WN0161 10        RS Job
     C                     MOVEL*BLANK    WN0162 10        RS Program
     C                     MOVEL*BLANK    WN0163 10        RS User Added
     C                     Z-ADD*ZERO     WN0164  70       RS Date Added
     C                     Z-ADD*ZERO     WN0165  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDA1HMNB    WCHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    WCBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDA1B0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSI    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADDWUFCNB    WCFCNB           TH Yard Deads
     C                     Z-ADDWUH9NB    WCH9NB           TH Held Over
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Dtl hd/Chg Pen    RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set Pen Totals to Zeros - Pen  * 
     C                     EXSR SKRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WDCMCD    WQSJ02           Pen Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           Pen Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSJ01           BOH Company Num
     C                     MOVEL#1CMCD    WQSJ02           Pen Number
      * Establish starting position
     C           KRSSJ     SETLL@A2CPKE                    *
     C           KRSSJ     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR SMCHRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv/Chg Pen Totals    RT - Pen  * 
     C                     EXSR SNRVGN
     C           KRSSJ     READE@A2CPKE                  90*
     C                     ENDDO
      * USER: Exit processing
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
     C                     EXSR SPRVGN
      * Chg Pen Genetics      CH - Pen  * 
     C                     EXSR SSCHRC
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Set Pen Totals to Zeros - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WBHVNB           Pen Company Num
     C                     KFLD           WBCMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HMNB    WBHVNB           Pen Company Num
     C                     MOVEL#1CMCD    WBCMCD           Pen Number
      * Establish starting position
     C           KRSSK     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Pen               CH - Pen  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWBHVNB    WEHVNB           Pen Company Num
     C                     MOVELWBCMCD    WECMCD    P      Pen Number
      *
     C           KLCHSL    KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
     C           KLCHSL    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YCRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUCRTX    WEBBTX    P      Pen Description
     C                     Z-ADDWBCTNB    WECTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WED6NB           Pen Current Hea
     C                     Z-ADDWBB6CD    WEB6CD           Pen Current Dri
     C                     MOVELWBDGST    WEDGST    P      Pen Sts
     C                     Z-ADDWBEBNB    WEEBNB           Pen Drive Seque
     C                     MOVELWBFWST    WEFWST    P      Pen Type
     C                     Z-ADDWBHBNB    WEHBNB           Pen Adjustment
     C                     MOVELWUCRTX    WEAGCD    P      GN Genetic Code
     C                     MOVELWBAAVN    WEAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WEAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WEAMTM           RS Time Changed
     C                     MOVELWBAJST    WEAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WEAHVN    P      RS Job
     C                     MOVELWBAGVN    WEAGVN    P      RS Program
     C                     MOVELWBABVN    WEABVN    P      RS User Added
     C                     Z-ADDWBABDT    WEABDT           RS Date Added
     C                     Z-ADDWBABTM    WEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0166  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0167  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0168  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0169  1        Pen Sts
     C                     Z-ADD*ZERO     WN0170  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0171  1        Pen Type
     C                     Z-ADD*ZERO     WN0172  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0173 10        RS User Changed
     C                     Z-ADD*ZERO     WN0174  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0175  60       RS Time Changed
     C                     MOVEL*BLANK    WN0176  1        RS Record Statu
     C                     MOVEL*BLANK    WN0177 10        RS Job
     C                     MOVEL*BLANK    WN0178 10        RS Program
     C                     MOVEL*BLANK    WN0179 10        RS User Added
     C                     Z-ADD*ZERO     WN0180  70       RS Date Added
     C                     Z-ADD*ZERO     WN0181  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADD#1HMNB    WEHVNB           Pen Company Num
     C                     MOVEL#1CMCD    WECMCD    P      Pen Number
      *
     C           KLCHSM    KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
     C           KLCHSM    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YDRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WEBBTX    P      Pen Description
     C                     MOVELWUAGCD    WEAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv/Chg Pen Totals    RT - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WBHVNB           Pen Company Num
     C                     KFLD           WBCMCD           Pen Number
      * Setup key
     C                     Z-ADDWDHMNB    WBHVNB           Pen Company Num
     C                     MOVELWDCMCD    WBCMCD           Pen Number
      * Establish starting position
     C           KRSSN     CHAIN@A3REDD              90    *
      * Data record not found
     C   90                MOVEL'PRK0065' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WDC0NB    ADD  WBD6NB    WUD6NB           Pen Current Hea
     C                     SUB  WDD8NB    WUD6NB           Pen Current Hea
      * Chg Pen               CH - Pen  * 
     C                     EXSR SOCHRC
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Chg Pen               CH - Pen  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADDWBHVNB    WEHVNB           Pen Company Num
     C                     MOVELWBCMCD    WECMCD    P      Pen Number
      *
     C           KLCHSO    KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
     C           KLCHSO    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YERDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWBBBTX    WEBBTX    P      Pen Description
     C                     Z-ADDWBCTNB    WECTNB           Pen Maximun Cap
     C                     Z-ADDWUD6NB    WED6NB           Pen Current Hea
     C                     Z-ADDWBB6CD    WEB6CD           Pen Current Dri
     C                     MOVELWBDGST    WEDGST    P      Pen Sts
     C                     Z-ADDWBEBNB    WEEBNB           Pen Drive Seque
     C                     MOVELWBFWST    WEFWST    P      Pen Type
     C                     Z-ADDWBHBNB    WEHBNB           Pen Adjustment
     C                     MOVELWBAGCD    WEAGCD    P      GN Genetic Code
     C                     MOVELWBAAVN    WEAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WEAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WEAMTM           RS Time Changed
     C                     MOVELWBAJST    WEAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WEAHVN    P      RS Job
     C                     MOVELWBAGVN    WEAGVN    P      RS Program
     C                     MOVELWBABVN    WEABVN    P      RS User Added
     C                     Z-ADDWBABDT    WEABDT           RS Date Added
     C                     Z-ADDWBABTM    WEABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Pen GENETICS      RT - Tattoo Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN WDCMCD    WQSP02           Pen Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           Pen Number
      * Setup key
     C                     Z-ADDWDHMNB    WQSP01           BOH Company Num
     C                     MOVELWDCMCD    WQSP02           Pen Number
      * Establish starting position
     C           KRSSP     SETLL@A2CPKE                    *
     C           KRSSP     READE@A2CPKE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0063' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL*BLANK    WUAGCD           GN Genetic Code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TDP Process Code is Drive Card Printed
      *   |- c2    : DB1.TDP Process Code is Open
      *   '-
     C           WDB9CD    IFEQ 'D'                        *IF
     C           WDB9CD    OREQ 'O'                        *OR
      * Rtv Tattoo GENETICS - Tattoo Header  * 
     C                     EXSR SQRVGN
      * CASE: PAR.GN Genetic Code is BLANKS
     C           WUAGCD    IFEQ *BLANK                     *IF
     C                     MOVELWUA1CD    WUAGCD           GN Genetic Code
     C                     MOVELWUJTTX    WUBBTX           Pen Description
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Genetic Code USR NE PAR.GN Genetic Code
     C           WUA1CD    IFNE WUAGCD                     *IF
     C                     MOVEL*BLANK    WUBBTX           Pen Description
     C                     MOVEL'MIXED'   WUBBTX           Pen Description
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@A2CPKE                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Tattoo GENETICS - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSQ01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSQ02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSQ03           BOL Load Number
     C           *LIKE     DEFN A1CVNB    WQSQ04           TH Tattoo Numbe
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           BOH Company Num
     C                     KFLD           WQSQ02           BOH Buy Order N
     C                     KFLD           WQSQ03           BOL Load Number
     C                     KFLD           WQSQ04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWDHMNB    WQSQ01           BOH Company Num
     C                     Z-ADDWDBNNB    WQSQ02           BOH Buy Order N
     C                     Z-ADDWDBONB    WQSQ03           BOL Load Number
     C                     Z-ADDWDCVNB    WQSQ04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSQ     SETLL@A1CPC4                    *
     C           KRSSQ     READE@A1CPC4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUA1CD           GN Genetic Code
     C                     MOVEL*BLANK    WUJTTX           Pen Description
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVELA1AGCD    WUA1CD           GN Genetic Code
      * Rtv Genetic Record    RT - Genetic  * 
     C                     EXSR SRRVGN
     C           KRSSQ     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Genetic Record    RT - Genetic  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           AIAGCD           GN Genetic Code
      * Setup key
     C                     MOVELA1AGCD    AIAGCD           GN Genetic Code
      * Establish starting position
     C           KRSSR     CHAIN@AIREA9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0021' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    WUJTTX           GN Description
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAWTX    WUJTTX           GN Description
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Pen Genetics      CH - Pen  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0182  50       Pen Maximun Cap
     C                     Z-ADD*ZERO     WN0183  50       Pen Current Hea
     C                     Z-ADD*ZERO     WN0184  30       Pen Current Dri
     C                     MOVEL*BLANK    WN0185  1        Pen Sts
     C                     Z-ADD*ZERO     WN0186  30       Pen Drive Seque
     C                     MOVEL*BLANK    WN0187  1        Pen Type
     C                     Z-ADD*ZERO     WN0188  50       Pen Adjustment
     C                     MOVEL*BLANK    WN0189 10        RS User Changed
     C                     Z-ADD*ZERO     WN0190  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0191  60       RS Time Changed
     C                     MOVEL*BLANK    WN0192  1        RS Record Statu
     C                     MOVEL*BLANK    WN0193 10        RS Job
     C                     MOVEL*BLANK    WN0194 10        RS Program
     C                     MOVEL*BLANK    WN0195 10        RS User Added
     C                     Z-ADD*ZERO     WN0196  70       RS Date Added
     C                     Z-ADD*ZERO     WN0197  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A3REDC
     C                     Z-ADD#1HMNB    WEHVNB           Pen Company Num
     C                     MOVEL#1CMCD    WECMCD    P      Pen Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           WEHVNB           Pen Company Num
     C                     KFLD           WECMCD           Pen Number
     C           KLCHSS    CHAIN@A3REDC              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA3REL0'MDACP
     C                     MOVEL'@A3REDC' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA31    YFRDCS
      * Move non-key fields to @A3REDC
     C                     MOVELWUBBTX    WEBBTX    P      Pen Description
     C                     MOVELWUAGCD    WEAGCD    P      GN Genetic Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WEAAVN           RS User Changed
     C                     Z-ADD##JDT     WEAADT           RS Date Changed
     C                     Z-ADD##JTM     WEAMTM           RS Time Changed
     C                     MOVEL##JOB     WEAHVN           RS Job
     C                     MOVEL##PGM     WEAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA31    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A3REDC                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA3REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * S034163 JM 08/05/25 - Include next business date in warning messa
      * S029664 JM 04/30/25 - Fix Held Over logic, It will display warnin
      *                     - message if New Pen has Heldover.
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1BNNB'
     C           ##RR      ANDEQYPMRRN
     C           YPMTFD    OREQ '#1BONB'
     C           ##RR      ANDEQYPMRRN
     C           YPMTFD    OREQ '#1CVNB'
     C           ##RR      ANDEQYPMRRN
     C           YPMTFD    OREQ '#1B0DT'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(RCD) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(RCD) #1B0DT' defaulted for 'TH Kill Date'.
     C                     CALL 'PKB7SRR'              90  Sel Kill/Tattoo
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0009  30       BOH Company Num
     C           #1CVNB    PARM #1CVNB    WQ0010  50       TH Tattoo Numbe
     C           #1B0DT    PARM #1B0DT    WQ0011  70       TH Kill Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKB7SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CVNB    IFNE *ZERO                      TH Tattoo Numbe
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1B0DT    IFNE *ZERO                      TH Kill Date
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C           #1BONB    ANDEQ*ZERO                      BOL Load Number
     C           #1CVNB    ANDEQ*ZERO                      TH Tattoo Numbe
     C           #1B0DT    ANDEQ*ZERO                      TH Kill Date
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAA1    KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB
     C                     Z-ADD#1BNNB    A1BNNB
     C                     Z-ADD#1BONB    A1BONB
     C                     Z-ADD#1CVNB    A1CVNB
     C                     Z-ADD#1B0DT    A1B0DT
     C           KLVAA1    CHAIN@A1CPC4              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Tattoo Header          NF'
     C                     MOVEL'PRK0061' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0061' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HVNB'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1HVNB' defaulted for 'Pen Company Number'.
      * Field '(RCD) #1CMCD' defaulted for 'Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1HVNB    PARM #1HVNB    WQ0012  30       Pen Company Num
     C           #1CMCD    PARM #1CMCD    WQ0013  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     98    *
     C                     END
      *
     C           #1HVNB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HVNB    IFEQ *ZERO                      Pen Company Num
     C           #1CMCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWB    KLIST
     C                     KFLD           WBHVNB           Pen Company Num
     C                     KFLD           WBCMCD           Pen Number
      * Setup key
     C                     Z-ADD#1HVNB    WBHVNB
     C                     MOVEL#1CMCD    WBCMCD
     C           KLVBWB    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Detail Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B9CD    IFEQ *BLANK                     TDP Process Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBX    KLIST
     C                     KFLD           BXB9CD           TDP Process Cod
      * Setup key
     C                     MOVEL#1B9CD    BXB9CD
     C           KLVCBX    CHAIN@BXREGA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Tattoo Detail Process  NF'
     C                     MOVEL'PRK0128' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0128' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Pen
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1CYCD    WK1X02  1
     C           YPMTFD    IFEQ '#1H8NB'
     C           ##RR      ANDEQYPMRRN
     C           WK1X02    OREQ '?'                        Pen Number
     C           YPMTFD    OREQ '#1CYCD'
     C           ##RR      ANDEQYPMRRN
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(RCD) #1H8NB' defaulted for 'Held Over Pen Company Num'.
      * Field '(RCD) #1CYCD' defaulted for 'Held Over Pen Number'.
     C                     CALL 'PKJ0SRR'              90  Sel Pen
     C                     PARM *BLANK    W0RTN   7
     C           #1H8NB    PARM #1H8NB    WQ0014  30       Pen Company Num
     C           #1CYCD    PARM #1CYCD    WQ0015  3        Pen Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9833  *
     C                     END
      *
     C           #1H8NB    IFNE *ZERO                      Pen Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1CYCD    IFNE *BLANK                     Pen Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1H8NB    IFEQ *ZERO                      Pen Company Num
     C           #1CYCD    ANDEQ*BLANK                     Pen Number
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWB    KLIST
     C                     KFLD           WBHVNB           Pen Company Num
     C                     KFLD           WBCMCD           Pen Number
      * Setup key
     C                     Z-ADD#1H8NB    WBHVNB
     C                     MOVEL#1CYCD    WBCMCD
     C           KLVDWB    CHAIN@A3REDD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Pen                    NF'
     C                     MOVEL'PRK0065' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0065' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C           ZINPOS    IFGE 03072
     C           ZINPOS    ANDLE05376
      * Cursor in the subfile record area
      * Reset cursor position to the basic (first) record for lookup
     C           W0CRW     SUB  12        W0CSRR  50
     C           03072     ADD  W0CCL     ZINPOS
      * Calculate rrn of the cursor position
     C                     ADD  ##SFRC    W0CSRR
     C                     ENDIF
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C           W0CFL     IFEQ *BLANK
     C                     Z-ADD0         W0CSRR
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD12        ZHSTRW  40
     C                     Z-ADD20        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
      *
     C           YPMRRN    IFGT *ZERO
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
      * Set screen conditioning indicators
     C                     EXSR GADSA1
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
     C                     END
     C                     END
      *
     C           ZHF4RW    IFEQ 012
     C           ZHCSCL    ANDGE050
     C           ZHCSCL    ANDLE052
     C                     MOVEL'#1CYCD'  YPMTFD           Held Over Pen N
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKGJEFRH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      *
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     P2CWNB           TH Head Receive
     C                     Z-ADD*ZERO     P2FCNB           TH Yard Deads
      *
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     WUT2HD  50
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Head Total USR
     C                     Z-ADD*ZERO     WUB5NB  70
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WACZNB           TD Live Wgt
     C                     Z-ADD*ZERO     WAC0NB           TD Pen Head
     C                     Z-ADD*ZERO     WAD8NB           TD Yard Dead
     C                     Z-ADD*ZERO     WAH7NB           TD Held Over
     C                     Z-ADD*ZERO     WAAJTM           TD Drive Time
     C                     Z-ADD*ZERO     WAJEA1           TD Drive Hour
     C                     Z-ADD*ZERO     WAB7CD           TD Drive Card N
     C                     Z-ADD*ZERO     WAD7NB           TD Avg Live Wgt
     C                     Z-ADD*ZERO     WABVDT           TD User Date 1
     C                     Z-ADD*ZERO     WABWDT           TD User Date 2
     C                     Z-ADD*ZERO     WABXDT           TD Drive Date
     C                     Z-ADD*ZERO     WAHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WAH8NB           Held Over Pen C
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUP0NB  30
      * Define work field Tattoo Nbr 4          USR
     C                     Z-ADD*ZERO     WUMLNB  40
      * Define work field TH Shift Held Over
     C                     MOVEL*BLANK    WULJST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WBCTNB           Pen Maximun Cap
     C                     Z-ADD*ZERO     WBD6NB           Pen Current Hea
     C                     Z-ADD*ZERO     WBB6CD           Pen Current Dri
     C                     Z-ADD*ZERO     WBEBNB           Pen Drive Seque
     C                     Z-ADD*ZERO     WBHBNB           Pen Adjustment
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field TH Purchase Date
     C                     Z-ADD*ZERO     WUAWDT  70
      * Define work field TH Group Reference
     C                     MOVEL*BLANK    WUBICD 10
      * Define work field TH Live Purchase UOM
     C                     MOVEL*BLANK    WUCPST  2
      * Define work field TH Live Purchase Price
     C                     Z-ADD*ZERO     WUACPR  52
      * Define work field TH Resale UOM
     C                     MOVEL*BLANK    WUC4ST  2
      * Define work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     WUAIPR  52
      * Define work field TH Pricing Date
     C                     Z-ADD*ZERO     WUA6DT  70
      * Define work field TH Resale Spread Sts
     C                     MOVEL*BLANK    WUC2ST  1
      * Define work field TH Dead On Arrival
     C                     Z-ADD*ZERO     WUCXNB  50
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Held Over
     C                     Z-ADD*ZERO     WUH9NB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Adds
     C                     Z-ADD*ZERO     WUHENB  50
      * Define work field TH Head Accepted
     C                     Z-ADD*ZERO     WUHFNB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     WUA5PC  61
      * Define work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     WUFBNB  61
      * Define work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     WUA4PC  61
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUHDNB  51
      * Define work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     WUF5NB  31
      * Define work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     WUF4NB  31
      * Define work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     WUF3NB  31
      * Define work field TH Avg Backfat
     C                     Z-ADD*ZERO     WUF2NB  31
      * Define work field TH Std Yield Percent
     C                     Z-ADD*ZERO     WUAVPC  52
      * Define work field TH Actual Yield %
     C                     Z-ADD*ZERO     WUAWPC  52
      * Define work field TH Yield Difference
     C                     Z-ADD*ZERO     WUA8PC  52
      * Define work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     WUA7PC  31
      * Define work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     WUAMPR  52
      * Define work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUANPR  72
      * Define work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     WUAYVA  72
      * Define work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUAWVA  72
      * Define work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     WUAOPR  72
      * Define work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     WUAXVA  72
      * Define work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     WUAPPR  72
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Define work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     WUA2PR  72
      * Define work field TH Payment Sts
     C                     MOVEL*BLANK    WUCWST  2
      * Define work field TH Header Error Sts
     C                     MOVEL*BLANK    WUD7ST  1
      * Define work field TH Detail Error Sts
     C                     MOVEL*BLANK    WUD8ST  1
      * Define work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    WUDWST  1
      * Define work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    WUD6ST  1
      * Define work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     WUGHNB  80
      * Define work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     WUBYDT  70
      * Define work field TH User Error Override
     C                     MOVEL*BLANK    WUE0ST  1
      * Define work field TH Held Over Record
     C                     MOVEL*BLANK    WUE1ST  1
      * Define work field TH Sex
     C                     MOVEL*BLANK    WUE2ST  1
      * Define work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     WUBSDT  70
      * Define work field TH Commission Paid Date
     C                     Z-ADD*ZERO     WUBTDT  70
      * Define work field TH Actual Check Date
     C                     Z-ADD*ZERO     WUBUDT  70
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     WUHHNB  71
      * Define work field TH FFLI
     C                     Z-ADD*ZERO     WUHINB  31
      * Define work field TH Kill Product Value
     C                     Z-ADD*ZERO     WUA3PR  72
      * Define work field TH Cut Product Value
     C                     Z-ADD*ZERO     WUA4PR  72
      * Define work field TH Render Product Value
     C                     Z-ADD*ZERO     WUA6PR  72
      * Define work field DF Defect Code
     C                     MOVEL*BLANK    WUBDCD  6
      * Define work field THP Process Code
     C                     MOVEL*BLANK    WUCSCD  6
      * Define work field HB Buyer Code
     C                     MOVEL*BLANK    WUACCD  3
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field HC Class Code
     C                     MOVEL*BLANK    WUBECD  3
      * Define work field TD Yard Dead
     C                     Z-ADD*ZERO     WUD8NB  50
      * Define work field TD Held Over
     C                     Z-ADD*ZERO     WUH7NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WCACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WCB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WCCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WCAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WCA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WCCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WCCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WCFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WCH9NB           TH Held Over
     C                     Z-ADD*ZERO     WCFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WCFENB           TH Head Killed
     C                     Z-ADD*ZERO     WCHENB           TH Head Adds
     C                     Z-ADD*ZERO     WCHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WCCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WCLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WCE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WCA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WCFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WCA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WCF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WCHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WCF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WCF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WCAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WCAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WCCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WCA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WCA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WCB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WCAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WCAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WCAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WCAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WCAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WCASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WCA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WCATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WCA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WCCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WCCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WCA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WCA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     Z-ADD*ZERO     WCBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WCHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WCHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCHINB           TH FFLI
     C                     Z-ADD*ZERO     WCA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WCA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WCA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WCJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WCD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WCD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WCD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WCD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WCEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WCEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WCECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WCEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WCEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WCEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WCOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WCTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WCT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WCTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WCT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WCOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WCKOER           TH Head Identif
     C                     Z-ADD*ZERO     WCOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WCOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WCIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WCOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WCHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WCS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WCTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WCTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WCJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WCKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WCKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WCKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WCKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WCOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WCIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WCIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WCIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WCKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WCKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WCORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WCOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WCMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WCNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WCNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WCIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WCEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCECDT           TH Head LFT
     C                     Z-ADD*ZERO     WCEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WCEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Pen Description
     C                     MOVEL*BLANK    WUBBTX 25
      * Define work field Pen Current Head
     C                     Z-ADD*ZERO     WUD6NB  50
      * Define work field Genetic Code USR
     C                     MOVEL*BLANK    WUA1CD  5
      * Define work field Pen Desc              USR
     C                     MOVEL*BLANK    WUJTTX 25
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD   177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL@CN,1     @CN,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local work field Tattoo 1              USR
     C                     MOVEL*BLANK    YL0001  4
      * Define local work field Tattoo 2              USR
     C                     MOVEL*BLANK    YL0002  4
      * Define local work field Tattoo 3              USR
     C                     MOVEL*BLANK    YL0003  4
      * Define local work field Tattoo 4              USR
     C                     MOVEL*BLANK    YL0004  4
      * Define local work field tattoo 5              USR
     C                     MOVEL*BLANK    YL0005  4
      * Define null work field @Status +/-
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field TH Schedule Kill Shift
     C                     MOVEL*BLANK    YN0002  1
      * Define local work field TD Held Over Status
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Tattoo 6              USR
     C                     MOVEL*BLANK    YL0007  4
      * Define local work field Next Kill Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Next Kill Date Alpha
     C                     MOVEL*BLANK    YL0009  7
      * Define local work field Year Alpha USR 2
     C                     MOVEL*BLANK    YL0010  2
      * Define local work field MM Alpha USR
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field Day Alpha USR
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Date MM/DD/YY USR
     C                     MOVEL*BLANK    YL0013  8
      * Define local work field Tattoo Number Alpha
     C                     MOVEL*BLANK    YL0014  5
      * Define local work field Text 63 USR
     C                     MOVEL*BLANK    YL0015 63
      * Define local work field Text 63 USR 2
     C                     MOVEL*BLANK    YL0016 63
      * Define local work field Confirm               USR
     C                     MOVEL*BLANK    YL0017  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      *
     C                     Z-ADD09        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
      * Set to *CHANGE mode
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE034
      * Create a Trucker edit. - Dwight Shepard
      * Purpose:
      * Clone the Trucker report that post and remove
      * all update of vouchers.  Producer the report
      * for the user to sight review before continue on.
      * Modification History
      * Date        Person   Description
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP3EVTX    ##CMP
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01041012970179403074030780308603098
0310603114031220312803136
** W0END
01043012990187103074030820309303098
0311003118031240313203136
** W0NAM
#2B7CD    #2CMCD    #2ST1     #1SEL     #1CVNB    V1B0DT    #RLIST
#1C0NB    #1D8NB    #1CYCD    #1H7NB    #RLJST
** @CN
00001 Kill Date for Tattoo
00002 will be next business day
00003 has Heldover,Tattoo
00004 is present in pen.
00005 Kill date for Tattoo
00006 already has Heldover,
00007 Tattoo
