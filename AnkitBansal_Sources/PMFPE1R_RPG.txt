     H/TITLE EDT Ord Cst Exp Instr  E1 Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 08:59:35
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPMFPE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Ord Cst Exp Instr  E1 Edit record(1 screen)
      *
     FPMAMREL2IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : Order Header Extension    Load ID/Order#/Co#
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMHSTPL1IF  E           K        DISK
      * RTV : Sales History             Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOMHSTPL0UF  E           K        DISK
      * UPD : Sales History             Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   3 003  5 0A
     E                    W0END   3 003  5 0A
     E                    W0NAM   3 003 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 030  5 0A
     E                    W1END   7 030  5 0A
     E                    W1NAM   7 030 10
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WAAIC3
     I              AMC4NB                          WAC4NB
     I              AMRMNB                          WARMNB
     I              AMRUNB                          WARUNB
     I              AMXACD                          WAXACD
     I              AMOANA                          WAOANA
     I              AMHBAA                          WAHBAA
     I              AMJ0T1                          WAJ0T1
     I              AMGENY                          WAGENY
     I              AMJ1T1                          WAJ1T1
     I              AMHCAA                          WAHCAA
     I              AMQWDT                          WAQWDT
     I              AMQXDT                          WAQXDT
     I              AMQYDT                          WAQYDT
     I              AMHDAA                          WAHDAA
     I              AMCCTX                          WACCTX
     I              AMJ2T1                          WAJ2T1
     I              AMRLNA                          WARLNA
     I              AMRMNA                          WARMNA
     I              AMGINY                          WAGINY
     I              AMGFNY                          WAGFNY
     I              AMGGNY                          WAGGNY
     I              AMGHNY                          WAGHNY
     I              AMHEVL                          WAHEVL
     I              AMHFVL                          WAHFVL
     I              AMHGVL                          WAHGVL
     I              AMQZDT                          WAQZDT
     I              AMQ0DT                          WAQ0DT
     I              AMQ1DT                          WAQ1DT
     I              AMQ2DT                          WAQ2DT
     I              AMC2TX                          WAC2TX
     I              AMC3TX                          WAC3TX
     I              AMC6TX                          WAC6TX
     I              AMCHTX                          WACHTX
     I              AMCITX                          WACITX
     I              AMCLTX                          WACLTX
     I              AMB4TX                          WAB4TX
     I              AMCUTX                          WACUTX
     I              AMCVTX                          WACVTX
     I              AMB9TX                          WAB9TX
     I              AMITNY                          WAITNY
     I              AMLMT1                          WALMT1
     I              AMLWAA                          WALWAA
     I              AMFVST                          WAFVST
     I              AMF0ST                          WAF0ST
     I              AMF2ST                          WAF2ST
     I              AMF3ST                          WAF3ST
     I              AMV3T1                          WAV3T1
     I              AMV4T1                          WAV4T1
     I              AMV5T1                          WAV5T1
     I              AMV6T1                          WAV6T1
     I              AMV7T1                          WAV7T1
     I              AMV8T1                          WAV8T1
     I              AMV9T1                          WAV9T1
     I              AMWAT1                          WAWAT1
     I              AMWBT1                          WAWBT1
     I              AMWCT1                          WAWCT1
     I              AMWDT1                          WAWDT1
     I              AMQJNY                          WAQJNY
     I              AMQKNY                          WAQKNY
     I              AMQLNY                          WAQLNY
     I              AMP8NY                          WAP8NY
     I              AMP9NY                          WAP9NY
     I              AMQANY                          WAQANY
     I              AMQCNY                          WAQCNY
     I              AMQDNY                          WAQDNY
     I              AMQENY                          WAQENY
     I              AMQFNY                          WAQFNY
     I              AMQGNY                          WAQGNY
     I              AMQHNY                          WAQHNY
     I              AMQINY                          WAQINY
     I              AMQMNY                          WAQMNY
     I              AMUVST                          WAUVST
     I              AMUWST                          WAUWST
     I              AMUXST                          WAUXST
     I              AMVSST                          WAVSST
     I              AMAATM                          WAAATM
     I              AMAYNA                          WAAYNA
     I              AMA0NA                          WAA0NA
     I              AMAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WCRMNB
     I              FLRUNB                          WCRUNB
     I              FLRVNB                          WCRVNB
     I              FLDQTX                          WCDQTX
     I              FLRWNB                          WCRWNB
     I              FLRXNB                          WCRXNB
     I              FLSQNB                          WCSQNB
     I              FLT0NB                          WCT0NB
     I              FLT1NB                          WCT1NB
     I              FLR1NB                          WCR1NB
     I              FLAIC3                          WCAIC3
     I              FLC4NB                          WCC4NB
     I              FLVCST                          WCVCST
     I              FLKEDT                          WCKEDT
     I              FLSXNB                          WCSXNB
     I              FLKFDT                          WCKFDT
     I              FLACTM                          WCACTM
     I              FLK5TX                          WCK5TX
     I              FLW5CD                          WCW5CD
     I              FLEJDT                          WCEJDT
     I              FLAGTM                          WCAGTM
     I              FLKJDT                          WCKJDT
     I              FLATTM                          WCATTM
     I              FLHDDT                          WCHDDT
     I              FLAUTM                          WCAUTM
     I              FLKKDT                          WCKKDT
     I              FLAVTM                          WCAVTM
     I              FLZ4NB                          WCZ4NB
     I              FLY7ST                          WCY7ST
     I              FLY2ST                          WCY2ST
     I              FLWHTX                          WCWHTX
     I              FLWITX                          WCWITX
     I              FLWJTX                          WCWJTX
     I              FLWKTX                          WCWKTX
     I              FLWLTX                          WCWLTX
     I              FLN7DT                          WCN7DT
     I              FLN8DT                          WCN8DT
     I              FLN9DT                          WCN9DT
     I              FLB3TM                          WCB3TM
     I              FLB4TM                          WCB4TM
     I              FLB5TM                          WCB5TM
     I              FLIASX                          WCIASX
     I              FLIBSX                          WCIBSX
     I              FLICSX                          WCICSX
     I              FLWVTX                          WCWVTX
     I              FLWWTX                          WCWWTX
     I              FLWXTX                          WCWXTX
     I              FLUVST                          WCUVST
     I              FLUWST                          WCUWST
     I              FLUXST                          WCUXST
     I              FLAATM                          WCAATM
     I              FLAYNA                          WCAYNA
     I              FLA0NA                          WCA0NA
     I              FLAXDT                          WCAXDT
      *
     I@FHSTD2
      * Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WDAIC3
     I              F4C4NB                          WDC4NB
     I              F4DPNB                          WDDPNB
     I              F4UENB                          WDUENB
     I              F4MONA                          WDMONA
     I              F4RJCD                          WDRJCD
     I              F4RKCD                          WDRKCD
     I              F4GPTX                          WDGPTX
     I              F4ABTX                          WDABTX
     I              F4KXCD                          WDKXCD
     I              F4BOCD                          WDBOCD
     I              F4BTC7                          WDBTC7
     I              F4ANC7                          WDANC7
     I              F4AQTX                          WDAQTX
     I              F4BKC7                          WDBKC7
     I              F4BRTX                          WDBRTX
     I              F4HNNA                          WDHNNA
     I              F4DBCD                          WDDBCD
     I              F4CKTX                          WDCKTX
     I              F4BCNA                          WDBCNA
     I              F4A0DT                          WDA0DT
     I              F4ACDT                          WDACDT
     I              F4R4CD                          WDR4CD
     I              F4R5CD                          WDR5CD
     I              F4BFCD                          WDBFCD
     I              F4Q4CD                          WDQ4CD
     I              F4AQCD                          WDAQCD
     I              F4TBNB                          WDTBNB
     I              F4BZNA                          WDBZNA
     I              F4RLCD                          WDRLCD
     I              F4JNCD                          WDJNCD
     I              F4Q2CD                          WDQ2CD
     I              F4U2ST                          WDU2ST
     I              F4ATIN                          WDATIN
     I              F4T3NB                          WDT3NB
     I              F4RSRN                          WDRSRN
     I              F4ORIT                          WDORIT
     I              F4AJCD                          WDAJCD
     I              F4AVQT                          WDAVQT
     I              F4D0WG                          WDD0WG
     I              F4CCQT                          WDCCQT
     I              F4AUWG                          WDAUWG
     I              F4AGCD                          WDAGCD
     I              F4AKPR                          WDAKPR
     I              F4AUPR                          WDAUPR
     I              F4CRCD                          WDCRCD
     I              F4A5DT                          WDA5DT
     I              F4AWDT                          WDAWDT
     I              F4HDDT                          WDHDDT
     I              F4AGCS                          WDAGCS
     I              F4AQCS                          WDAQCS
     I              F4AVWG                          WDAVWG
     I              F4AYVA                          WDAYVA
     I              F4AMST                          WDAMST
     I              F4ANST                          WDANST
     I              F4VAST                          WDVAST
     I              F4L6NB                          WDL6NB
     I              F4UMCD                          WDUMCD
     I              F4HCDT                          WDHCDT
     I              F4ESNB                          WDESNB
     I              F4ETNB                          WDETNB
     I              F4BZNB                          WDBZNB
     I              F4EXQT                          WDEXQT
     I              F4BYWG                          WDBYWG
     I              F4S5NB                          WDS5NB
     I              F4MAVA                          WDMAVA
     I              F4KDVA                          WDKDVA
     I              F4USVA                          WDUSVA
     I              F4UTVA                          WDUTVA
     I              F4A4WG                          WDA4WG
     I              F4CKNB                          WDCKNB
     I              F4BMST                          WDBMST
     I              F4R8NB                          WDR8NB
     I              F4RMCD                          WDRMCD
     I              F4BZPR                          WDBZPR
     I              F4RDCD                          WDRDCD
     I              F4Q7CD                          WDQ7CD
     I              F4EXDT                          WDEXDT
     I              F4LQCD                          WDLQCD
     I              F4HICD                          WDHICD
     I              F4RBCD                          WDRBCD
     I              F4RGNB                          WDRGNB
     I              F4RHNB                          WDRHNB
     I              F4RINB                          WDRINB
     I              F4R1NB                          WDR1NB
     I              F4CONB                          WDCONB
     I              F4CEST                          WDCEST
     I              F4GNDT                          WDGNDT
     I              F4RMNB                          WDRMNB
     I              F4AODT                          WDAODT
     I              F4LLCD                          WDLLCD
     I              F4LMCD                          WDLMCD
     I              F4SKNB                          WDSKNB
     I              F4SLNB                          WDSLNB
     I              F4SMNB                          WDSMNB
     I              F4G7NA                          WDG7NA
     I              F4ONVA                          WDONVA
     I              F4N0CD                          WDN0CD
     I              F4B4NB                          WDB4NB
     I              F4B5NB                          WDB5NB
     I              F4N1CD                          WDN1CD
     I              F4GIDT                          WDGIDT
     I              F4Z1ST                          WDZ1ST
     I              F4ULVA                          WDULVA
     I              F4UNVA                          WDUNVA
     I              F4UOVA                          WDUOVA
     I              F4UPVA                          WDUPVA
     I              F4UQVA                          WDUQVA
     I              F4SDCD                          WDSDCD
     I              F4QZCD                          WDQZCD
     I              F4XWST                          WDXWST
     I              F4T9CD                          WDT9CD
     I              F4UBCD                          WDUBCD
     I              F4CFC7                          WDCFC7
     I              F4X1CD                          WDX1CD
     I              F4GASX                          WDGASX
     I              F4DUPR                          WDDUPR
     I              F4B6VL                          WDB6VL
     I              F4IANX                          WDIANX
     I              F4IBNX                          WDIBNX
     I              F4RPCD                          WDRPCD
     I              F4NYDT                          WDNYDT
     I              F4BZTM                          WDBZTM
     I              F4Z4NB                          WDZ4NB
     I              F4XACD                          WDXACD
     I              F4OANA                          WDOANA
     I              F4OKTX                          WDOKTX
     I              F4K4TX                          WDK4TX
     I              F4NBBO                          WDNBBO
     I              F4OCFR                          WDOCFR
     I              F4C0C7                          WDC0C7
     I              F4A1AA                          WDA1AA
     I              F4VEST                          WDVEST
     I              F4A5PR                          WDA5PR
     I              F4CDPR                          WDCDPR
     I              F4D0PR                          WDD0PR
     I              F4D0VL                          WDD0VL
     I              F4IRSX                          WDIRSX
     I              F4CEVL                          WDCEVL
     I              F4ISSX                          WDISSX
     I              F4ITSX                          WDITSX
     I              F4IUSX                          WDIUSX
     I              F4OHDT                          WDOHDT
     I              F4D9PR                          WDD9PR
     I              F4CFVL                          WDCFVL
     I              F4UVST                          WDUVST
     I              F4UWST                          WDUWST
     I              F4UXST                          WDUXST
     I              F4AATM                          WDAATM
     I              F4AYNA                          WDAYNA
     I              F4A0NA                          WDA0NA
     I              F4AXDT                          WDAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            773
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
     IYARDCS      DS                            773
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            773
     IQOMHS1    E DSOMHSTPL0
      * UPD : Sales History             Update index
      * Renamed input format fields
     I              F4AIC3                          WDAIC3
     I              F4C4NB                          WDC4NB
     I              F4DPNB                          WDDPNB
     I              F4UENB                          WDUENB
     I              F4MONA                          WDMONA
     I              F4RJCD                          WDRJCD
     I              F4RKCD                          WDRKCD
     I              F4GPTX                          WDGPTX
     I              F4ABTX                          WDABTX
     I              F4KXCD                          WDKXCD
     I              F4BOCD                          WDBOCD
     I              F4BTC7                          WDBTC7
     I              F4ANC7                          WDANC7
     I              F4AQTX                          WDAQTX
     I              F4BKC7                          WDBKC7
     I              F4BRTX                          WDBRTX
     I              F4HNNA                          WDHNNA
     I              F4DBCD                          WDDBCD
     I              F4CKTX                          WDCKTX
     I              F4BCNA                          WDBCNA
     I              F4A0DT                          WDA0DT
     I              F4ACDT                          WDACDT
     I              F4R4CD                          WDR4CD
     I              F4R5CD                          WDR5CD
     I              F4BFCD                          WDBFCD
     I              F4Q4CD                          WDQ4CD
     I              F4AQCD                          WDAQCD
     I              F4TBNB                          WDTBNB
     I              F4BZNA                          WDBZNA
     I              F4RLCD                          WDRLCD
     I              F4JNCD                          WDJNCD
     I              F4Q2CD                          WDQ2CD
     I              F4U2ST                          WDU2ST
     I              F4ATIN                          WDATIN
     I              F4T3NB                          WDT3NB
     I              F4RSRN                          WDRSRN
     I              F4ORIT                          WDORIT
     I              F4AJCD                          WDAJCD
     I              F4AVQT                          WDAVQT
     I              F4D0WG                          WDD0WG
     I              F4CCQT                          WDCCQT
     I              F4AUWG                          WDAUWG
     I              F4AGCD                          WDAGCD
     I              F4AKPR                          WDAKPR
     I              F4AUPR                          WDAUPR
     I              F4CRCD                          WDCRCD
     I              F4A5DT                          WDA5DT
     I              F4AWDT                          WDAWDT
     I              F4HDDT                          WDHDDT
     I              F4AGCS                          WDAGCS
     I              F4AQCS                          WDAQCS
     I              F4AVWG                          WDAVWG
     I              F4AYVA                          WDAYVA
     I              F4AMST                          WDAMST
     I              F4ANST                          WDANST
     I              F4VAST                          WDVAST
     I              F4L6NB                          WDL6NB
     I              F4UMCD                          WDUMCD
     I              F4HCDT                          WDHCDT
     I              F4ESNB                          WDESNB
     I              F4ETNB                          WDETNB
     I              F4BZNB                          WDBZNB
     I              F4EXQT                          WDEXQT
     I              F4BYWG                          WDBYWG
     I              F4S5NB                          WDS5NB
     I              F4MAVA                          WDMAVA
     I              F4KDVA                          WDKDVA
     I              F4USVA                          WDUSVA
     I              F4UTVA                          WDUTVA
     I              F4A4WG                          WDA4WG
     I              F4CKNB                          WDCKNB
     I              F4BMST                          WDBMST
     I              F4R8NB                          WDR8NB
     I              F4RMCD                          WDRMCD
     I              F4BZPR                          WDBZPR
     I              F4RDCD                          WDRDCD
     I              F4Q7CD                          WDQ7CD
     I              F4EXDT                          WDEXDT
     I              F4LQCD                          WDLQCD
     I              F4HICD                          WDHICD
     I              F4RBCD                          WDRBCD
     I              F4RGNB                          WDRGNB
     I              F4RHNB                          WDRHNB
     I              F4RINB                          WDRINB
     I              F4R1NB                          WDR1NB
     I              F4CONB                          WDCONB
     I              F4CEST                          WDCEST
     I              F4GNDT                          WDGNDT
     I              F4RMNB                          WDRMNB
     I              F4AODT                          WDAODT
     I              F4LLCD                          WDLLCD
     I              F4LMCD                          WDLMCD
     I              F4SKNB                          WDSKNB
     I              F4SLNB                          WDSLNB
     I              F4SMNB                          WDSMNB
     I              F4G7NA                          WDG7NA
     I              F4ONVA                          WDONVA
     I              F4N0CD                          WDN0CD
     I              F4B4NB                          WDB4NB
     I              F4B5NB                          WDB5NB
     I              F4N1CD                          WDN1CD
     I              F4GIDT                          WDGIDT
     I              F4Z1ST                          WDZ1ST
     I              F4ULVA                          WDULVA
     I              F4UNVA                          WDUNVA
     I              F4UOVA                          WDUOVA
     I              F4UPVA                          WDUPVA
     I              F4UQVA                          WDUQVA
     I              F4SDCD                          WDSDCD
     I              F4QZCD                          WDQZCD
     I              F4XWST                          WDXWST
     I              F4T9CD                          WDT9CD
     I              F4UBCD                          WDUBCD
     I              F4CFC7                          WDCFC7
     I              F4X1CD                          WDX1CD
     I              F4GASX                          WDGASX
     I              F4DUPR                          WDDUPR
     I              F4B6VL                          WDB6VL
     I              F4IANX                          WDIANX
     I              F4IBNX                          WDIBNX
     I              F4RPCD                          WDRPCD
     I              F4NYDT                          WDNYDT
     I              F4BZTM                          WDBZTM
     I              F4Z4NB                          WDZ4NB
     I              F4XACD                          WDXACD
     I              F4OANA                          WDOANA
     I              F4OKTX                          WDOKTX
     I              F4K4TX                          WDK4TX
     I              F4NBBO                          WDNBBO
     I              F4OCFR                          WDOCFR
     I              F4C0C7                          WDC0C7
     I              F4A1AA                          WDA1AA
     I              F4VEST                          WDVEST
     I              F4A5PR                          WDA5PR
     I              F4CDPR                          WDCDPR
     I              F4D0PR                          WDD0PR
     I              F4D0VL                          WDD0VL
     I              F4IRSX                          WDIRSX
     I              F4CEVL                          WDCEVL
     I              F4ISSX                          WDISSX
     I              F4ITSX                          WDITSX
     I              F4IUSX                          WDIUSX
     I              F4OHDT                          WDOHDT
     I              F4D9PR                          WDD9PR
     I              F4CFVL                          WDCFVL
     I              F4UVST                          WDUVST
     I              F4UWST                          WDUWST
     I              F4UXST                          WDUXST
     I              F4AATM                          WDAATM
     I              F4AYNA                          WDAYNA
     I              F4A0NA                          WDA0NA
     I              F4AXDT                          WDAXDT
      *
     IYCRDCS      DS                            792
      * Outward parameters
     IPARC        DS                             11
      * KEY : Load Detail               Load/Stop/Order
      * I :  Load ID
     I                                    P   1   40PARMNB
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WERMNB
     I              FJAIC3                          WEAIC3
     I              FJAODT                          WEAODT
     I              FJPJST                          WEPJST
     I              FJPKST                          WEPKST
     I              FJRNNB                          WERNNB
     I              FJDMTX                          WEDMTX
     I              FJDNTX                          WEDNTX
     I              FJDOTX                          WEDOTX
     I              FJWTTX                          WEWTTX
     I              FJWUTX                          WEWUTX
     I              FJRPNB                          WERPNB
     I              FJFLAM                          WEFLAM
     I              FJXQST                          WEXQST
     I              FJRRNB                          WERRNB
     I              FJDXTX                          WEDXTX
     I              FJDYTX                          WEDYTX
     I              FJSBNB                          WESBNB
     I              FJBZNA                          WEBZNA
     I              FJRONB                          WERONB
     I              FJSQNB                          WESQNB
     I              FJR1NB                          WER1NB
     I              FJVCST                          WEVCST
     I              FJVDST                          WEVDST
     I              FJSDNB                          WESDNB
     I              FJPAOU                          WEPAOU
     I              FJDGWG                          WEDGWG
     I              FJSXNB                          WESXNB
     I              FJHADT                          WEHADT
     I              FJAART                          WEAART
     I              FJDHWG                          WEDHWG
     I              FJDIWG                          WEDIWG
     I              FJAQDT                          WEAQDT
     I              FJS6NB                          WES6NB
     I              FJT4NB                          WET4NB
     I              FJPRTM                          WEPRTM
     I              FJNPSV                          WENPSV
     I              FJJ8TX                          WEJ8TX
     I              FJTLMI                          WETLMI
     I              FJJ9TX                          WEJ9TX
     I              FJQ2CD                          WEQ2CD
     I              FJVPCD                          WEVPCD
     I              FJDBCD                          WEDBCD
     I              FJGRWE                          WEGRWE
     I              FJXCCD                          WEXCCD
     I              FJU2ST                          WEU2ST
     I              FJF9DT                          WEF9DT
     I              FJONTM                          WEONTM
     I              FJJ4DT                          WEJ4DT
     I              FJTRTM                          WETRTM
     I              FJJ5DT                          WEJ5DT
     I              FJSPTM                          WESPTM
     I              FJJ6DT                          WEJ6DT
     I              FJLFTM                          WELFTM
     I              FJJ7DT                          WEJ7DT
     I              FJBOTM                          WEBOTM
     I              FJJ8DT                          WEJ8DT
     I              FJBLTM                          WEBLTM
     I              FJKIDT                          WEKIDT
     I              FJASTM                          WEASTM
     I              FJKADT                          WEKADT
     I              FJAJCM                          WEAJCM
     I              FJXACD                          WEXACD
     I              FJOANA                          WEOANA
     I              FJK4TX                          WEK4TX
     I              FJVOAG                          WEVOAG
     I              FJKBDT                          WEKBDT
     I              FJNBBO                          WENBBO
     I              FJW4CD                          WEW4CD
     I              FJEFDT                          WEEFDT
     I              FJCNTN                          WECNTN
     I              FJKCDT                          WEKCDT
     I              FJTMIN                          WETMIN
     I              FJKDDT                          WEKDDT
     I              FJVMNB                          WEVMNB
     I              FJOCFR                          WEOCFR
     I              FJKJDT                          WEKJDT
     I              FJATTM                          WEATTM
     I              FJOTRS                          WEOTRS
     I              FJRNST                          WERNST
     I              FJBRBK                          WEBRBK
     I              FJEIDT                          WEEIDT
     I              FJRMST                          WERMST
     I              FJAJCD                          WEAJCD
     I              FJKKDT                          WEKKDT
     I              FJAVTM                          WEAVTM
     I              FJKZDT                          WEKZDT
     I              FJAXTM                          WEAXTM
     I              FJLHOS                          WELHOS
     I              FJLHOR                          WELHOR
     I              FJWNTX                          WEWNTX
     I              FJOITX                          WEOITX
     I              FJOJTX                          WEOJTX
     I              FJLLDT                          WELLDT
     I              FJLSHG                          WELSHG
     I              FJYPST                          WEYPST
     I              FJK0DT                          WEK0DT
     I              FJAYTM                          WEAYTM
     I              FJKNNX                          WEKNNX
     I              FJICWG                          WEICWG
     I              FJIDWG                          WEIDWG
     I              FJH9SX                          WEH9SX
     I              FJWOTX                          WEWOTX
     I              FJK1DT                          WEK1DT
     I              FJAZTM                          WEAZTM
     I              FJK2DT                          WEK2DT
     I              FJA0TM                          WEA0TM
     I              FJROST                          WEROST
     I              FJRPST                          WERPST
     I              FJRQST                          WERQST
     I              FJRRST                          WERRST
     I              FJZBVA                          WEZBVA
     I              FJWPTX                          WEWPTX
     I              FJWQTX                          WEWQTX
     I              FJWRTX                          WEWRTX
     I              FJWSTX                          WEWSTX
     I              FJRVSX                          WERVSX
     I              FJRUSX                          WERUSX
     I              FJRWSX                          WERWSX
     I              FJRXSX                          WERXSX
     I              FJRYSX                          WERYSX
     I              FJRZSX                          WERZSX
     I              FJR0SX                          WER0SX
     I              FJR1SX                          WER1SX
     I              FJR2SX                          WER2SX
     I              FJR3SX                          WER3SX
     I              FJR4SX                          WER4SX
     I              FJPYDT                          WEPYDT
     I              FJCKTM                          WECKTM
     I              FJPZDT                          WEPZDT
     I              FJCLTM                          WECLTM
     I              FJP0DT                          WEP0DT
     I              FJCMTM                          WECMTM
     I              FJP1DT                          WEP1DT
     I              FJCNTM                          WECNTM
     I              FJP2DT                          WEP2DT
     I              FJCOTM                          WECOTM
     I              FJP3DT                          WEP3DT
     I              FJCQTM                          WECQTM
     I              FJUVST                          WEUVST
     I              FJUWST                          WEUWST
     I              FJUXST                          WEUXST
     I              FJAATM                          WEAATM
     I              FJAYNA                          WEAYNA
     I              FJA0NA                          WEA0NA
     I              FJAXDT                          WEAXDT
      *
     IYDRDCS      DS                            793
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     IYERDCS      DS                            367
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYFRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header Extension
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Order Number
     I                                    P   3   60P1C4NB
      * I : RST Load ID
     I                                    P   7  100P1RMNB
     IP2PARM      DS
      * N :  USR Carrier Code
     I                                        1   3 P2R6CD
     IP3PARM      DS
      * N :  USR Company Number
     I                                    P   1   20P3FKNB
     IP4PARM      DS
      * B :  USR Exit Program
     I                                        1   1 P4STYN
     IP5PARM      DS
      * FLD: *Arrays
      * N :  Shipping Line
     I                                        1   3 P5XACD
      * N :  Port Delv Terminal
     I                                        4  23 P5OANA
      * N :  Vessel Name
     I                                       24  53 P5K4TX
      * N :  Voyage
     I                                    P  54  560P5VOAG
      * N :  Sail Date
     I                                    P  57  600P5KBDT
      * N :  Booking Number
     I                                       61  72 P5NBBO
      * N :  Discharge Port
     I                                       73  92 P5W4CD
      * N :  Container Number
     I                                       93 104 P5CNTN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0001
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0002
      * Message data for 'Shipping Line not found'
      * Carrier Code
     I                                        1   3 ZA0003
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0004
      * Application Code
     I                                       11  16 ZA0005
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0006
      * Application Code
     I                                       11  16 ZA0007
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1RMNB    PARM           WP0003  70       Load ID
     C           P4STYN    PARM P4STYN    WP0004  1        USR Exit Progra
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Display and process key screen
     C                     EXSR BADSKY
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C           #1C4NB    OREQ *ZERO                      Order Number
     C           #1AIC3    OREQ *ZERO                      Company Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           AMRMNB           Load ID
     C                     KFLD           AMC4NB           Order Number
     C                     KFLD           AMAIC3           Company Number
      * Setup key
     C                     Z-ADD#1RMNB    AMRMNB
     C                     Z-ADD#1C4NB    AMC4NB
     C                     Z-ADD#1AIC3    AMAIC3
     C           KRTV      CHAIN@AMREJM              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     99    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, flip to add mode
     C           *IN90     IFEQ '1'
     C                     MOVEL'ADD'     W0PMD
      * USER: Initialize detail screen (new record)
      * CASE: DTL.Load ID NE PAR.Load ID
     C           #1RMNB    IFNE P1RMNB                     *IF
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     END                             *FI
      * RTV Load Dispatch flds RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0001           Load ID
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YL0001           Scheduled Ship
     C                     MOVELWL0003    #DDXTX    P      Trailer Id
     C                     MOVELWL0004    YL0002    P      Carrier Code
     C                     Z-ADDWL0005    YL0003           Schedule Sequen
     C                     MOVELWL0006    YL0004    P      Shipping Method
     C                     MOVELWL0007    YL0005    P      On Time - (Y/N)
     C                     Z-ADDWL0008    YL0006           Truck Ready Dat
     C                     Z-ADDWL0009    YL0007           Truck Ready Tim
     C                     Z-ADDWL0010    YL0008           Spotted Date
     C                     Z-ADDWL0011    YL0009           Spotted Time
     C                     Z-ADDWL0012    YL0010           Load Finished D
     C                     Z-ADDWL0013    YL0011           Load Finished T
     C                     Z-ADDWL0014    YL0012           BOL Complete Da
     C                     Z-ADDWL0015    YL0013           BOL Complete Ti
     C                     Z-ADDWL0016    YL0014           BOL Received Da
     C                     Z-ADDWL0017    YL0015           BOL Received Ti
     C                     Z-ADDWL0018    YL0016           Truck Departure
     C                     Z-ADDWL0019    YL0017           Truck Departure
     C                     Z-ADDWL0020    YL0018           Adjusted Depart
     C                     Z-ADDWL0021    YL0019           Adjusted Depart
     C                     MOVELWL0022    YL0020    P      Shipping Line
     C                     MOVELWL0023    YL0021    P      Port Delv Termi
     C                     Z-ADDWL0024    YL0022           Scheduled Deliv
     C                     Z-ADDWL0025    YL0023           Scheduled Deliv
     C                     MOVELWL0026    YL0024    P      LH Unused Sts
     C                     Z-ADDWL0027    YL0025           On Yard Date
     C                     Z-ADDWL0028    YL0026           On Yard Time
     C                     MOVELWL0029    YL0027    P      Load Held Over
     C                     MOVELWL0030    YL0028    P      LH On-Time Reas
     C                     MOVELWL0031    YL0029    P      LH Held Over Re
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1C4NB    WL0033           Order Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    P3FKNB           Company Number
     C                     MOVELWL0034    YL0030    P      Order Type - Sa
     C                     Z-ADDWL0035    YL0031           A/R Customer Nu
     C                     Z-ADDWL0036    YL0032           Ship To Custome
     C                     MOVELWL0037    #DBRTX    P      Ship To Name
     C                     MOVELWL0038    YL0033    P      Ship To Address
     C                     MOVELWL0039    YL0034    P      Ship To Address
     C                     MOVELWL0040    YL0035    P      Ship To Address
     C                     MOVELWL0041    #DAJNA    P      Ship To City
     C                     MOVELWL0042    #DEINA    P      Ship To State C
     C                     MOVELWL0043    YL0036    P      Ship To Zip/Pos
     C                     Z-ADDWL0044    YL0037           Bill to Custome
     C                     MOVELWL0045    YL0038    P      Bill to Name
     C                     MOVELWL0046    YL0039    P      Bill to Address
     C                     MOVELWL0047    YL0040    P      Bill to Address
     C                     MOVELWL0048    YL0041    P      Bill to Address
     C                     MOVELWL0049    YL0042    P      Bill to City
     C                     MOVELWL0050    YL0043    P      Bill to State C
     C                     MOVELWL0051    YL0044    P      Bill to Zip/Pos
     C                     MOVELWL0052    YL0045    P      Customer Purcha
     C                     Z-ADDWL0053    YL0046           Order Date
     C                     Z-ADDWL0054    YL0047           Requested Ship
     C                     Z-ADDWL0055    #DF9DT           Actual Shipped
     C                     Z-ADDWL0056    YL0048           Cancel Date
     C                     MOVELWL0057    YL0049    P      Terms Code
     C                     MOVELWL0058    YL0050    P      Special Instruc
     C                     MOVELWL0059    YL0051    P      Special Instruc
     C                     MOVELWL0060    #DBZNA    P      Carrier Code
     C                     MOVELWL0061    YL0052    P      Comment Print A
     C                     MOVELWL0062    YL0053    P      Comment Print I
     C                     MOVELWL0063    YL0054    P      Comment Print P
     C                     MOVELWL0064    YL0055    P      Comment Print S
     C                     MOVELWL0065    YL0056    P      Reason Code
     C                     MOVELWL0066    YL0057    P      Order in Use
     C                     MOVELWL0067    YL0058    P      Header Status
     C                     MOVELWL0068    YL0059    P      Header Status L
     C                     MOVELWL0069    YL0060    P      Order Type Prin
     C                     Z-ADDWL0070    #DAODT           Scheduled Ship
     C                     MOVELWL0071    YL0061    P      User Original E
     C                     Z-ADDWL0072    YL0062           Date of Origina
     C                     Z-ADDWL0073    YL0063           Order Value Tot
     C                     Z-ADDWL0074    YL0064           Order Weight To
     C                     MOVELWL0075    YL0065    P      Credit Hold
     C                     MOVELWL0076    YL0066    P      Production Hold
     C                     MOVELWL0077    YL0067    P      New Customer Ho
     C                     Z-ADDWL0078    #DEIDT           Requested Deliv
     C                     Z-ADDWL0079    YL0068           Requested Deliv
     C                     MOVELWL0080    YL0069    P      Accounts Receiv
     C                     MOVELWL0081    YL0070    P      Accounts Receiv
     C                     Z-ADDWL0082    YL0071           Load ID
     C                     Z-ADDWL0083    YL0072           Absorbed Freigh
     C                     Z-ADDWL0084    YL0073           Rated Freight
     C                     MOVELWL0085    YL0074    P      LTL Flag
     C                     MOVELWL0086    YL0075    P      Price Audit
     C                     MOVELWL0087    YL0076    P      Price Status
     C                     MOVELWL0088    #DQ2CD    P      Shipping Method
     C                     MOVELWL0089    YL0077    P      Export Status
     C                     MOVELWL0090    YL0078    P      Palletize
     C                     MOVELWL0091    YL0079    P      Shrink Wrap
     C                     MOVELWL0092    YL0080    P      Slip Sheet
     C                     MOVELWL0093    YL0081    P      Age Code
     C                     Z-ADDWL0094    YL0082           Reefer Temperat
     C                     MOVELWL0095    YL0083    P      Load Type
     C                     Z-ADDWL0096    YL0084           Attach to Invoi
     C                     MOVELWL0097    YL0085    P      Load Plan Order
     C                     MOVELWL0098    YL0086    P      Print Pick Slip
     C                     Z-ADDWL0099    YL0087           Resell Referenc
     C                     MOVELWL0100    YL0088    P      Special Comment
     C                     MOVELWL0101    YL0089    P      Special Comment
     C                     MOVELWL0102    YL0090    P      Affect Auto Acc
     C                     MOVELWL0103    YL0091    P      Sales Route Cod
     C                     MOVELWL0104    YL0092    P      Manager Level C
     C                     MOVELWL0105    YL0093    P      VP Level Code
     C                     Z-ADDWL0106    YL0094           Attach to Order
     C                     MOVELWL0107    YL0095    P      Reason for Pric
     C                     Z-ADDWL0108    YL0096           Invoice Number
     C                     MOVELWL0109    YL0097    P      Invoice Suffix
     C                     Z-ADDWL0110    YL0098           Invoice Date
     C                     MOVELWL0111    YL0099    P      Event Code
     C                     MOVELWL0112    YL0100    P      Trans Contol AS
     C                     MOVELWL0113    YL0101    P      Modified Flag
     C                     Z-ADDWL0114    YL0102           A/R order Value
     C                     MOVELWL0115    YL0103    P      Billing Activit
     C                     MOVELWL0116    YL0104    P      Block Order Fla
     C                     MOVELWL0117    YL0105    P      Order Certifica
     C                     MOVELWL0118    YL0106    P      EDI Status 1
     C                     MOVELWL0119    YL0107    P      EDI Status 2
     C                     MOVELWL0120    YL0108    P      EDI Status 3
      * ** Use the Company Number from the Load Header to see
      * ** if Sail Port information exists for this Order Number
      * ** for instance, from a cancelled load. If it does, put info on
      * ** the screen.                              FT683 LJB 12/12/2007
      * RTV OHE Ship fields    RT - Order Header Extension  * 
     C                     EXSR SCRVGN
     C                     Z-ADDP3FKNB    #1AIC3           Company Number
      * RTV Company Name Only  RT - Company Name and Address  * 
     C                     EXSR SDRVGN
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DW1TX    P      Name
     C                     MOVELWL0123    YL0109    P      Record Status
     C                     MOVEL#DBZNA    P2R6CD           USR Carrier Cod
      * RTV Order Info by Load RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0124           Load ID
     C                     Z-ADD#1C4NB    WL0135           Order Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0125    #1RUNB           Stop/Drop Seque
     C                     Z-ADDWL0126    YL0003           Stop/Drop
     C                     MOVELWL0127    YL0110    P      Comments for Pi
     C                     Z-ADDWL0128    YL0111           Miles to next s
     C                     Z-ADDWL0129    YL0112           Freight Charge
     C                     Z-ADDWL0130    YL0113           Ld Hdr/Ld Dtl U
     C                     Z-ADDWL0131    YL0114           Freight Misc. C
     C                     Z-ADDWL0132    YL0115           Freight Stop Ch
     C                     Z-ADDWL0133    YL0073           Rated Freight
     C                     Z-ADDWL0134    YL0116           Company Number
     C                     MOVELWL0136    #1CCTX    P      Ship Status
     C                     Z-ADDWL0137    YL0117           Estimated Arriv
     C                     Z-ADDWL0138    YL0118           Estimated Arriv
     C                     Z-ADDWL0139    YL0119           Appointment Con
     C                     Z-ADDWL0140    YL0120           Appointment Con
     C                     MOVELWL0141    YL0121    P      Confirmation Ma
     C                     MOVELWL0142    YL0122    P      Confirmation Nu
     C                     Z-ADDWL0143    YL0123           Actual Delivery
     C                     Z-ADDWL0144    YL0124           Actual Delivery
     C                     Z-ADDWL0145    YL0022           Scheduled Deliv
     C                     Z-ADDWL0146    YL0023           Scheduled Deliv
     C                     Z-ADDWL0147    YL0125           Deadline Depart
     C                     Z-ADDWL0148    YL0126           Deadline Depart
     C                     Z-ADDWL0149    YL0025           On Yard Date
     C                     Z-ADDWL0150    YL0026           On Yard Time
     C                     Z-ADDWL0151    YL0127           MPC Number
     C                     MOVELWL0152    YL0128    P      Load Dtl On Tim
     C                     MOVELWL0153    YL0129    P      On Time Add'l R
     C                     MOVELWL0154    YL0130    P      Seal Nbr 1
     C                     MOVELWL0155    YL0131    P      Seal Nbr 2
     C                     MOVELWL0156    YL0132    P      Seal Nbr 3
     C                     MOVELWL0157    YL0133    P      Seal Nbr 4
     C                     MOVELWL0158    YL0134    P      Seal Nbr 5
     C                     Z-ADDWL0159    YL0135           LD Carrier Appt
     C                     Z-ADDWL0160    YL0136           LD Unused Date
     C                     Z-ADDWL0161    YL0137           LD Unused Date
     C                     Z-ADDWL0162    YL0138           LD Carrier Appt
     C                     Z-ADDWL0163    YL0139           LD Unused Time
     C                     Z-ADDWL0164    YL0140           LD Unused Time
     C                     MOVELWL0165    YL0141    P      Miles Error Sts
     C                     MOVELWL0166    YL0142    P      LD Unused Sts 2
     C                     MOVELWL0167    YL0143    P      HPB Transload S
     C                     MOVELWL0168    YL0144    P      LD Unused Txt 1
     C                     MOVELWL0169    YL0145    P      LD Unused Txt 2
     C                     MOVELWL0170    YL0146    P      LD Unused Txt 3
     C                     MOVELWL0171    YL0106    P      EDI Status 1
     C                     MOVELWL0172    YL0107    P      EDI Status 2
     C                     MOVELWL0173    YL0108    P      EDI Status 3
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     ELSE
      * If record does exist, flip to change mode
     C                     MOVEL'CHG'     W0PMD
      * Load screen fields from DBF
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DW1TX    P      Name
     C                     MOVELWL0123    YN0001    P      Record Status
      * CLC Depart Date/Accept XF - Load Header  * 
     C                     CALL 'PMFTXFR'              90  CLC Depart Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1RMNB    WQ0002  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * USER: Initialize detail screen (existing record)
     C                     MOVEL'CHG'     W0PMD            *Program mode
      * RTV Load Dispatch flds RT - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0001           Load ID
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0002    YN0002           Scheduled Ship
     C                     MOVELWL0003    #DDXTX    P      Trailer Id
     C                     MOVELWL0004    YN0003    P      Carrier Code
     C                     Z-ADDWL0005    YN0004           Schedule Sequen
     C                     MOVELWL0006    YN0005    P      Shipping Method
     C                     MOVELWL0007    YN0006    P      On Time - (Y/N)
     C                     Z-ADDWL0008    YN0007           Truck Ready Dat
     C                     Z-ADDWL0009    YN0008           Truck Ready Tim
     C                     Z-ADDWL0010    YN0009           Spotted Date
     C                     Z-ADDWL0011    YN0010           Spotted Time
     C                     Z-ADDWL0012    YN0011           Load Finished D
     C                     Z-ADDWL0013    YN0012           Load Finished T
     C                     Z-ADDWL0014    YN0013           BOL Complete Da
     C                     Z-ADDWL0015    YN0014           BOL Complete Ti
     C                     Z-ADDWL0016    YN0015           BOL Received Da
     C                     Z-ADDWL0017    YN0016           BOL Received Ti
     C                     Z-ADDWL0018    YN0017           Truck Departure
     C                     Z-ADDWL0019    YN0018           Truck Departure
     C                     Z-ADDWL0020    YN0019           Adjusted Depart
     C                     Z-ADDWL0021    YN0020           Adjusted Depart
     C                     MOVELWL0022    YN0021    P      Shipping Line
     C                     MOVELWL0023    YN0022    P      Port Delv Termi
     C                     Z-ADDWL0024    YN0023           Scheduled Deliv
     C                     Z-ADDWL0025    YN0024           Scheduled Deliv
     C                     MOVELWL0026    YN0025    P      LH Unused Sts
     C                     Z-ADDWL0027    YN0026           On Yard Date
     C                     Z-ADDWL0028    YN0027           On Yard Time
     C                     MOVELWL0029    YN0028    P      Load Held Over
     C                     MOVELWL0030    YN0029    P      LH On-Time Reas
     C                     MOVELWL0031    YN0030    P      LH Held Over Re
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1C4NB    WL0033           Order Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0032    P3FKNB           Company Number
     C                     MOVELWL0034    YN0031    P      Order Type - Sa
     C                     Z-ADDWL0035    YN0032           A/R Customer Nu
     C                     Z-ADDWL0036    YL0032           Ship To Custome
     C                     MOVELWL0037    #DBRTX    P      Ship To Name
     C                     MOVELWL0038    YL0033    P      Ship To Address
     C                     MOVELWL0039    YL0034    P      Ship To Address
     C                     MOVELWL0040    YL0035    P      Ship To Address
     C                     MOVELWL0041    #DAJNA    P      Ship To City
     C                     MOVELWL0042    #DEINA    P      Ship To State C
     C                     MOVELWL0043    YL0036    P      Ship To Zip/Pos
     C                     Z-ADDWL0044    YN0033           Bill to Custome
     C                     MOVELWL0045    YN0034    P      Bill to Name
     C                     MOVELWL0046    YN0035    P      Bill to Address
     C                     MOVELWL0047    YN0036    P      Bill to Address
     C                     MOVELWL0048    YN0037    P      Bill to Address
     C                     MOVELWL0049    YN0038    P      Bill to City
     C                     MOVELWL0050    YN0039    P      Bill to State C
     C                     MOVELWL0051    YN0040    P      Bill to Zip/Pos
     C                     MOVELWL0052    YN0041    P      Customer Purcha
     C                     Z-ADDWL0053    YN0042           Order Date
     C                     Z-ADDWL0054    YN0043           Requested Ship
     C                     Z-ADDWL0055    #DF9DT           Actual Shipped
     C                     Z-ADDWL0056    YN0044           Cancel Date
     C                     MOVELWL0057    YN0045    P      Terms Code
     C                     MOVELWL0058    YL0050    P      Special Instruc
     C                     MOVELWL0059    YL0051    P      Special Instruc
     C                     MOVELWL0060    #DBZNA    P      Carrier Code
     C                     MOVELWL0061    YN0046    P      Comment Print A
     C                     MOVELWL0062    YN0047    P      Comment Print I
     C                     MOVELWL0063    YN0048    P      Comment Print P
     C                     MOVELWL0064    YN0049    P      Comment Print S
     C                     MOVELWL0065    YN0050    P      Reason Code
     C                     MOVELWL0066    YN0051    P      Order in Use
     C                     MOVELWL0067    YN0052    P      Header Status
     C                     MOVELWL0068    YN0053    P      Header Status L
     C                     MOVELWL0069    YN0054    P      Order Type Prin
     C                     Z-ADDWL0070    #DAODT           Scheduled Ship
     C                     MOVELWL0071    YN0055    P      User Original E
     C                     Z-ADDWL0072    YN0056           Date of Origina
     C                     Z-ADDWL0073    YN0057           Order Value Tot
     C                     Z-ADDWL0074    YN0058           Order Weight To
     C                     MOVELWL0075    YN0059    P      Credit Hold
     C                     MOVELWL0076    YN0060    P      Production Hold
     C                     MOVELWL0077    YN0061    P      New Customer Ho
     C                     Z-ADDWL0078    #DEIDT           Requested Deliv
     C                     Z-ADDWL0079    YN0062           Requested Deliv
     C                     MOVELWL0080    YN0063    P      Accounts Receiv
     C                     MOVELWL0081    YN0064    P      Accounts Receiv
     C                     Z-ADDWL0082    YN0065           Load ID
     C                     Z-ADDWL0083    YN0066           Absorbed Freigh
     C                     Z-ADDWL0084    YN0067           Rated Freight
     C                     MOVELWL0085    YN0068    P      LTL Flag
     C                     MOVELWL0086    YN0069    P      Price Audit
     C                     MOVELWL0087    YN0070    P      Price Status
     C                     MOVELWL0088    #DQ2CD    P      Shipping Method
     C                     MOVELWL0089    YL0077    P      Export Status
     C                     MOVELWL0090    YN0071    P      Palletize
     C                     MOVELWL0091    YN0072    P      Shrink Wrap
     C                     MOVELWL0092    YN0073    P      Slip Sheet
     C                     MOVELWL0093    YN0074    P      Age Code
     C                     Z-ADDWL0094    YN0075           Reefer Temperat
     C                     MOVELWL0095    YN0076    P      Load Type
     C                     Z-ADDWL0096    YN0077           Attach to Invoi
     C                     MOVELWL0097    YN0078    P      Load Plan Order
     C                     MOVELWL0098    YN0079    P      Print Pick Slip
     C                     Z-ADDWL0099    YN0080           Resell Referenc
     C                     MOVELWL0100    YL0088    P      Special Comment
     C                     MOVELWL0101    YL0089    P      Special Comment
     C                     MOVELWL0102    YN0081    P      Affect Auto Acc
     C                     MOVELWL0103    YN0082    P      Sales Route Cod
     C                     MOVELWL0104    YN0083    P      Manager Level C
     C                     MOVELWL0105    YN0084    P      VP Level Code
     C                     Z-ADDWL0106    YN0085           Attach to Order
     C                     MOVELWL0107    YN0086    P      Reason for Pric
     C                     Z-ADDWL0108    YN0087           Invoice Number
     C                     MOVELWL0109    YN0088    P      Invoice Suffix
     C                     Z-ADDWL0110    YN0089           Invoice Date
     C                     MOVELWL0111    YN0090    P      Event Code
     C                     MOVELWL0112    YN0091    P      Trans Contol AS
     C                     MOVELWL0113    YN0092    P      Modified Flag
     C                     Z-ADDWL0114    YN0093           A/R order Value
     C                     MOVELWL0115    YN0094    P      Billing Activit
     C                     MOVELWL0116    YN0095    P      Block Order Fla
     C                     MOVELWL0117    YN0096    P      Order Certifica
     C                     MOVELWL0118    YN0097    P      EDI Status 1
     C                     MOVELWL0119    YN0098    P      EDI Status 2
     C                     MOVELWL0120    YN0099    P      EDI Status 3
      * ** Save Co# and Carrier for Fax prompt
     C                     MOVEL#DBZNA    P2R6CD           USR Carrier Cod
     C                     Z-ADD#1AIC3    P3FKNB           USR Company Num
      * ** Retrieve the Carrier Name
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DW1TX    P      Name
     C                     MOVELWL0123    YN0100    P      Record Status
      * RTV Order Info by Load RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1RMNB    WL0124           Load ID
     C                     Z-ADDP1C4NB    WL0135           Order Number
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0125    #1RUNB           Stop/Drop Seque
     C                     Z-ADDWL0126    YN0101           Stop/Drop
     C                     MOVELWL0127    YN0102    P      Comments for Pi
     C                     Z-ADDWL0128    YN0103           Miles to next s
     C                     Z-ADDWL0129    YN0104           Freight Charge
     C                     Z-ADDWL0130    YN0105           Ld Hdr/Ld Dtl U
     C                     Z-ADDWL0131    YN0106           Freight Misc. C
     C                     Z-ADDWL0132    YN0107           Freight Stop Ch
     C                     Z-ADDWL0133    YN0067           Rated Freight
     C                     Z-ADDWL0134    YN0108           Company Number
     C                     MOVELWL0136    #1CCTX    P      Ship Status
     C                     Z-ADDWL0137    YN0109           Estimated Arriv
     C                     Z-ADDWL0138    YN0110           Estimated Arriv
     C                     Z-ADDWL0139    YN0111           Appointment Con
     C                     Z-ADDWL0140    YN0112           Appointment Con
     C                     MOVELWL0141    YN0113    P      Confirmation Ma
     C                     MOVELWL0142    YN0114    P      Confirmation Nu
     C                     Z-ADDWL0143    YN0115           Actual Delivery
     C                     Z-ADDWL0144    YN0116           Actual Delivery
     C                     Z-ADDWL0145    YN0023           Scheduled Deliv
     C                     Z-ADDWL0146    YN0024           Scheduled Deliv
     C                     Z-ADDWL0147    YN0117           Deadline Depart
     C                     Z-ADDWL0148    YN0118           Deadline Depart
     C                     Z-ADDWL0149    YN0026           On Yard Date
     C                     Z-ADDWL0150    YN0027           On Yard Time
     C                     Z-ADDWL0151    YN0119           MPC Number
     C                     MOVELWL0152    YN0120    P      Load Dtl On Tim
     C                     MOVELWL0153    YN0121    P      On Time Add'l R
     C                     MOVELWL0154    YN0122    P      Seal Nbr 1
     C                     MOVELWL0155    YN0123    P      Seal Nbr 2
     C                     MOVELWL0156    YN0124    P      Seal Nbr 3
     C                     MOVELWL0157    YN0125    P      Seal Nbr 4
     C                     MOVELWL0158    YN0126    P      Seal Nbr 5
     C                     Z-ADDWL0159    YN0127           LD Carrier Appt
     C                     Z-ADDWL0160    YN0128           LD Unused Date
     C                     Z-ADDWL0161    YN0129           LD Unused Date
     C                     Z-ADDWL0162    YN0130           LD Carrier Appt
     C                     Z-ADDWL0163    YN0131           LD Unused Time
     C                     Z-ADDWL0164    YN0132           LD Unused Time
     C                     MOVELWL0165    YN0133    P      Miles Error Sts
     C                     MOVELWL0166    YN0134    P      LD Unused Sts 2
     C                     MOVELWL0167    YN0135    P      HPB Transload S
     C                     MOVELWL0168    YN0136    P      LD Unused Txt 1
     C                     MOVELWL0169    YN0137    P      LD Unused Txt 2
     C                     MOVELWL0170    YN0138    P      LD Unused Txt 3
     C                     MOVELWL0171    YN0097    P      EDI Status 1
     C                     MOVELWL0172    YN0098    P      EDI Status 2
     C                     MOVELWL0173    YN0099    P      EDI Status 3
      * ** Retrieve the Shipping Line name from the Carrier file
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DGVTX    P      Name
     C                     MOVELWL0123    YL0109    P      Record Status
      * ** Send error message if invalid shipping line entered  FT683 LJB
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0001           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve the Port City and address
      * CASE: DB1.Port Delv Terminal is Entered
     C           AMOANA    IFNE *BLANK                     *IF
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0174    P      Shipping Line
     C                     MOVEL#1OANA    WL0175    P      Port Delv Termi
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0176    #1HBAA    P      Port City
     C                     MOVELWL0177    YL0147    P      Port Address Li
     C                     MOVELWL0178    YL0148    P      Port Address Li
     C                     MOVELWL0179    YL0149    P      Sail Port State
     C                     MOVELWL0180    YL0150    P      Port Zip/Postal
     C                     Z-ADDWL0181    YL0151           Port Phone Numb
     C                     MOVELWL0182    YL0152    P      Port Fax Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Check restriction within
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check restriction within
     C                     EXSR VBCKRL
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * If delete is not pending....
      * Validate details
     C  N11                CAS            DCVLDL
     C                     END
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate OHE Sail/Flight Date
      * External date
     C                     Z-ADDV1QWDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #1QWDT
      * Validate OHE Actual Depart Date
      * External date
     C                     Z-ADDV1QXDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9939  *
     C                     END
     C                     Z-ADDXDINDT    #1QXDT
      * Validate OHE Arrival Date
      * External date
     C                     Z-ADDV1QYDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     Z-ADDXDINDT    #1QYDT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * ** F10 = Copy from another order  DLY27SP LJB 08/24/2007
      * CASE: DTL.*CMD key is CF10
     C           *IN10     IFEQ '1'                        *IF
      * SEL Copy OHE Record    SR - Order Header Extension  * 
     C                     CALL 'PMMLSRR'              90  SEL Copy OHE Re
     C                     PARM *BLANK    W0RTN   7
     C           P5XACD    PARM *BLANK    WQ0009  3        Shipping Line
     C           P5OANA    PARM *BLANK    WQ0010 20        Port Delv Termi
     C           P5K4TX    PARM *BLANK    WQ0011 30        Vessel Name
     C           P5VOAG    PARM *ZERO     WQ0012  50       Voyage
     C           P5KBDT    PARM *ZERO     WQ0013  70       Sail Date
     C           P5NBBO    PARM *BLANK    WQ0014 12        Booking Number
     C           P5W4CD    PARM *BLANK    WQ0015 20        Discharge Port
     C           P5CNTN    PARM *BLANK    WQ0016 12        Container Numbe
     C           WUZZST    PARM *BLANK    WQ0017  1        Record Selected
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMMLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Only update fields if a record was selected.
      * CASE: WRK.Record Selected       USR is yes
     C           WUZZST    IFEQ 'Y'                        *IF
     C                     MOVELP5XACD    #1XACD           Shipping Line
     C                     MOVELP5OANA    #1OANA           Port Delv Termi
     C                     MOVELP5K4TX    #1J0T1           OHE Vessel/Airl
     C                     Z-ADDP5VOAG    #1GENY           OHE Voyage/Flig
     C                     Z-ADDP5KBDT    #1QWDT           OHE Sail/Flight
     C                     MOVELP5NBBO    #1J1T1           OHE Booking Num
     C                     MOVELP5W4CD    #1HCAA           OHE Discharge P
     C                     MOVELP5CNTN    #1J2T1           OHE Container N
      * ** Error if shipping line or port are wrong.  FT683 LJB
      * ** Retrieve the Shipping Line name from the Carrier file
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DGVTX    P      Name
     C                     MOVELWL0123    YL0109    P      Record Status
      * ** Send error message if invalid shipping line entered  FT683 LJB
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0002           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve the Port City and address
      * CASE: DB1.Port Delv Terminal is Entered
     C           AMOANA    IFNE *BLANK                     *IF
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0174    P      Shipping Line
     C                     MOVEL#1OANA    WL0175    P      Port Delv Termi
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0176    #1HBAA    P      Port City
     C                     MOVELWL0177    YL0147    P      Port Address Li
     C                     MOVELWL0178    YL0148    P      Port Address Li
     C                     MOVELWL0179    YL0149    P      Sail Port State
     C                     MOVELWL0180    YL0150    P      Port Zip/Postal
     C                     Z-ADDWL0181    YL0151           Port Phone Numb
     C                     MOVELWL0182    YL0152    P      Port Fax Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Shipping Line
     C           W0CFL     IFEQ '#1XACD'                   *IF
      * SEL Shipping Line/PortsSR - Shipping Line/Port  * 
     C                     CALL 'PDUMSRR'              90  SEL Shipping Li
     C                     PARM *BLANK    W0RTN   7
     C           #1XACD    PARM #1XACD    WQ0018  3        Shipping Line
     C           #1OANA    PARM #1OANA    WQ0019 20        Port Delv Termi
     C           #1HBAA    PARM *BLANK    WQ0020 25        Port City
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Port Delv Terminal
     C           W0CFL     IFEQ '#1OANA'                   *IF
      * SEL Shipping Line/PortsSR - Shipping Line/Port  * 
     C                     CALL 'PDUMSRR'              90  SEL Shipping Li
     C                     PARM *BLANK    W0RTN   7
     C           #1XACD    PARM #1XACD    WQ0021  3        Shipping Line
     C           #1OANA    PARM #1OANA    WQ0022 20        Port Delv Termi
     C           #1HBAA    PARM *BLANK    WQ0023 25        Port City
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993132*
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DTL.*CMD key is CF20
     C           *IN20     IFEQ '1'                        *IF
      * ** Traffic Comments
      * EDT PD Traffic Comment EF - Traffic Comments  * 
     C                     CALL 'PDCZEFR'              90  EDT PD Traffic
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0024  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCZEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     ELSE
      * CASE: DTL.*CMD key is CF13
     C           *IN13     IFEQ '1'                        *IF
      * ** Display/Edit MPC
      * Edt MPC/Dsp Orders     EF - Load Detail  * 
     C                     CALL 'PDSQEFR'              90  Edt MPC/Dsp Ord
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0025  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDSQEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Load Detail
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      * Carrier Name DRV
      * RTV Carrier Name       RT - Carrier              TRG  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DBZNA    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DW1TX    P      Name
     C                     MOVELWL0123    YN0001    P      Record Status
      * CLC Depart Date/Accept XF - Load Header  * 
     C                     CALL 'PMFTXFR'              90  CLC Depart Date
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0030  30       Company Number
     C                     PARM P1RMNB    WQ0031  70       Load ID
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * ** Retrieve the Shipping Line name from the Carrier file
      * CASE: DTL.Shipping Line is entered
     C           #1XACD    IFNE *BLANK                     *IF
      * RTV Carrier Name       RT - Carrier  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0121    P      Carrier Code
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0122    #DGVTX    P      Name
     C                     MOVELWL0123    YL0109    P      Record Status
      * ** Send error message if invalid shipping line entered  FT683 LJB
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
     C                     MOVEL#1XACD    ZA0003           Shipping Line
      * Send message 'Shipping Line not found'
     C                     MOVEL'USR2431' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * ** Retrieve the Port City and address
      * CASE: DTL.Port Delv Terminal is Entered
     C           #1OANA    IFNE *BLANK                     *IF
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#1XACD    WL0174    P      Shipping Line
     C                     MOVEL#1OANA    WL0175    P      Port Delv Termi
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0176    #1HBAA    P      Port City
     C                     MOVELWL0177    YL0147    P      Port Address Li
     C                     MOVELWL0178    YL0148    P      Port Address Li
     C                     MOVELWL0179    YL0149    P      Sail Port State
     C                     MOVELWL0180    YL0150    P      Port Zip/Postal
     C                     Z-ADDWL0181    YL0151           Port Phone Numb
     C                     MOVELWL0182    YL0152    P      Port Fax Number
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Send message 'Shipping Line/Port     NF'
     C                     MOVEL'USR2419' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'Y'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process delete request
     C   11                CAS            EDDLRQ
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LWAA' defaulted for 'OHE Intended for ExportCC'.
      * Field '(DTL) #1FVST' defaulted for 'OHE Unused Status 6 1'.
      * Field '(DTL) #1F0ST' defaulted for 'OHE Unused Status 6 2'.
      * Field '(DTL) #1F2ST' defaulted for 'OHE Unused Status 6 3'.
      * Field '(DTL) #1F3ST' defaulted for 'OHE Unused Status 6 4'.
      * Field '(DTL) #1V3T1' defaulted for 'OHE Unused Text 10 1'.
      * Field '(DTL) #1V4T1' defaulted for 'OHE Unused Text 10 2'.
      * Field '(DTL) #1V5T1' defaulted for 'OHE Unused Text 10 3'.
      * Field '(DTL) #1V6T1' defaulted for 'OHE Unused Text 15 1'.
      * Field '(DTL) #1V7T1' defaulted for 'OHE Unused Text 15 2'.
      * Field '(DTL) #1V8T1' defaulted for 'OHE Unused Text 15 3'.
      * Field '(DTL) #1V9T1' defaulted for 'OHE Unused Text 30 1'.
      * Field '(DTL) #1WAT1' defaulted for 'OHE Unused Text 30 2'.
      * Field '(DTL) #1WBT1' defaulted for 'OHE Unused Text 30 3'.
      * Field '(DTL) #1WCT1' defaulted for 'OHE Unused Text 50 1'.
      * Field '(DTL) #1WDT1' defaulted for 'OHE Unused Text 50 2'.
      * Field '(DTL) #1QJNY' defaulted for 'OHE Unused Numeric 3,0 1'.
      * Field '(DTL) #1QKNY' defaulted for 'OHE Unused Numeric 3,0 2'.
      * Field '(DTL) #1QLNY' defaulted for 'OHE Unused Numeric 3,0 3'.
      * Field '(DTL) #1P8NY' defaulted for 'OHE Unused Numeric 5,0 1'.
      * Field '(DTL) #1P9NY' defaulted for 'OHE Unused Numeric 5,0 2'.
      * Field '(DTL) #1QANY' defaulted for 'OHE Unused Numeric 5,0 3'.
      * Field '(DTL) #1QCNY' defaulted for 'OHE Unused Numeric 6,0 1'.
      * Field '(DTL) #1QDNY' defaulted for 'OHE Unused Numeric 6,0 2'.
      * Field '(DTL) #1QENY' defaulted for 'OHE Unused Numeric 6,0 3'.
      * Field '(DTL) #1QFNY' defaulted for 'OHE Unused Numeric 6,0 4'.
      * Field '(DTL) #1QGNY' defaulted for 'OHE Unused Numeric 9,0 1'.
      * Field '(DTL) #1QHNY' defaulted for 'OHE Unused Numeric 9,0 2'.
      * Field '(DTL) #1QINY' defaulted for 'OHE Unused Numeric 9,0 3'.
      * Field '(DTL) #1QMNY' defaulted for 'OHE Unused Numeric 9,6 1'.
      * CRT Order Header Exten CR - Order Header Extension  * 
     C                     EXSR SHCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EDDLRQ    BEGSR
      *================================================================
      * Process delete request
      *================================================================
      * USER: Delete DBF record
      * Delete Order Header Exten - Order Header Extension  * 
     C                     EXSR SJDLRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record deleted'
     C                     MOVEL'Y2U0013' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         EDEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LWAA' defaulted for 'OHE Intended for ExportCC'.
      * Field '(DTL) #1FVST' defaulted for 'OHE Unused Status 6 1'.
      * Field '(DTL) #1F0ST' defaulted for 'OHE Unused Status 6 2'.
      * Field '(DTL) #1F2ST' defaulted for 'OHE Unused Status 6 3'.
      * Field '(DTL) #1F3ST' defaulted for 'OHE Unused Status 6 4'.
      * Field '(DTL) #1V3T1' defaulted for 'OHE Unused Text 10 1'.
      * Field '(DTL) #1V4T1' defaulted for 'OHE Unused Text 10 2'.
      * Field '(DTL) #1V5T1' defaulted for 'OHE Unused Text 10 3'.
      * Field '(DTL) #1V6T1' defaulted for 'OHE Unused Text 15 1'.
      * Field '(DTL) #1V7T1' defaulted for 'OHE Unused Text 15 2'.
      * Field '(DTL) #1V8T1' defaulted for 'OHE Unused Text 15 3'.
      * Field '(DTL) #1V9T1' defaulted for 'OHE Unused Text 30 1'.
      * Field '(DTL) #1WAT1' defaulted for 'OHE Unused Text 30 2'.
      * Field '(DTL) #1WBT1' defaulted for 'OHE Unused Text 30 3'.
      * Field '(DTL) #1WCT1' defaulted for 'OHE Unused Text 50 1'.
      * Field '(DTL) #1WDT1' defaulted for 'OHE Unused Text 50 2'.
      * Field '(DTL) #1QJNY' defaulted for 'OHE Unused Numeric 3,0 1'.
      * Field '(DTL) #1QKNY' defaulted for 'OHE Unused Numeric 3,0 2'.
      * Field '(DTL) #1QLNY' defaulted for 'OHE Unused Numeric 3,0 3'.
      * Field '(DTL) #1P8NY' defaulted for 'OHE Unused Numeric 5,0 1'.
      * Field '(DTL) #1P9NY' defaulted for 'OHE Unused Numeric 5,0 2'.
      * Field '(DTL) #1QANY' defaulted for 'OHE Unused Numeric 5,0 3'.
      * Field '(DTL) #1QCNY' defaulted for 'OHE Unused Numeric 6,0 1'.
      * Field '(DTL) #1QDNY' defaulted for 'OHE Unused Numeric 6,0 2'.
      * Field '(DTL) #1QENY' defaulted for 'OHE Unused Numeric 6,0 3'.
      * Field '(DTL) #1QFNY' defaulted for 'OHE Unused Numeric 6,0 4'.
      * Field '(DTL) #1QGNY' defaulted for 'OHE Unused Numeric 9,0 1'.
      * Field '(DTL) #1QHNY' defaulted for 'OHE Unused Numeric 9,0 2'.
      * Field '(DTL) #1QINY' defaulted for 'OHE Unused Numeric 9,0 3'.
      * Field '(DTL) #1QMNY' defaulted for 'OHE Unused Numeric 9,6 1'.
      * CHG OrdHdr Ext/SlsHst CH - Order Header Extension  * 
     C                     EXSR SKCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YBRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
      * Disable key screen
     C                     SETOF                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1HDAA           OHE Unused Code
     C                     Z-ADD*ZERO     #1GINY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1GFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1GGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1GHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     #1HEVL           OHE Unused Valu
     C                     Z-ADD*ZERO     #1HFVL           OHE Unused Valu
     C                     Z-ADD*ZERO     #1HGVL           OHE Unused Valu
     C                     Z-ADD*ZERO     #1QZDT           OHE Unused Date
     C                     Z-ADD*ZERO     #1Q0DT           OHE Unused Date
     C                     Z-ADD*ZERO     #1Q1DT           OHE Unused Date
     C                     Z-ADD*ZERO     #1Q2DT           OHE Unused Date
     C                     MOVEL*BLANK    #1C2TX           OHE unused stat
     C                     MOVEL*BLANK    #1C3TX           OHE unused stat
     C                     MOVEL*BLANK    #1C6TX           OHE unused stat
     C                     MOVEL*BLANK    #1CHTX           OHE EDI ASN Sen
     C                     MOVEL*BLANK    #1CITX           OHE Unused Stat
     C                     MOVEL*BLANK    #1CLTX           OHE Unused Stat
     C                     MOVEL*BLANK    #1B4TX           OHE Unused Stat
     C                     MOVEL*BLANK    #1CUTX           OHE Unused Stat
     C                     MOVEL*BLANK    #1CVTX           OHE Unused Stat
     C                     MOVEL*BLANK    #1B9TX           OHE Unused Stat
     C                     Z-ADD*ZERO     #1ITNY           HPB COA Batch N
     C                     MOVEL*BLANK    #1LMT1           Delivery P.O. N
     C                     MOVEL*BLANK    #1LWAA           OHE Intended fo
     C                     MOVEL*BLANK    #1FVST           OHE Unused Stat
     C                     MOVEL*BLANK    #1F0ST           OHE Unused Stat
     C                     MOVEL*BLANK    #1F2ST           OHE Unused Stat
     C                     MOVEL*BLANK    #1F3ST           OHE Unused Stat
     C                     MOVEL*BLANK    #1V3T1           OHE Unused Text
     C                     MOVEL*BLANK    #1V4T1           OHE Unused Text
     C                     MOVEL*BLANK    #1V5T1           OHE Unused Text
     C                     MOVEL*BLANK    #1V6T1           OHE Unused Text
     C                     MOVEL*BLANK    #1V7T1           OHE Unused Text
     C                     MOVEL*BLANK    #1V8T1           OHE Unused Text
     C                     MOVEL*BLANK    #1V9T1           OHE Unused Text
     C                     MOVEL*BLANK    #1WAT1           OHE Unused Text
     C                     MOVEL*BLANK    #1WBT1           OHE Unused Text
     C                     MOVEL*BLANK    #1WCT1           OHE Unused Text
     C                     MOVEL*BLANK    #1WDT1           OHE Unused Text
     C                     Z-ADD*ZERO     #1QJNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QKNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QLNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1P8NY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1P9NY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QANY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QCNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QDNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QENY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QFNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QGNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QHNY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QINY           OHE Unused Nume
     C                     Z-ADD*ZERO     #1QMNY           OHE Unused Nume
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     Z-ADD*ZERO     #DEIDT           Requested Deliv
      * Clear external version also
     C                     Z-ADD*ZERO     VDEIDT
     C                     Z-ADD*ZERO     #1RUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    #DDXTX           Trailer Id
     C                     MOVEL*BLANK    #DQ2CD           Shipping Method
     C                     Z-ADD*ZERO     #DAODT           Scheduled Ship
      * Clear external version also
     C                     Z-ADD*ZERO     VDAODT
     C                     MOVEL*BLANK    #DBZNA           Carrier Code
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
     C                     MOVEL*BLANK    #1CCTX           OHE Ship Status
     C                     Z-ADD*ZERO     #DF9DT           Actual Ship Dat
      * Clear external version also
     C                     Z-ADD*ZERO     VDF9DT
     C                     MOVEL*BLANK    #DBRTX           Ship To Name
     C                     MOVEL*BLANK    #DAJNA           City
     C                     MOVEL*BLANK    #DEINA           State
     C                     MOVEL*BLANK    #DAPTX           Company Name
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #DGVTX           USR Carrier Nam
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1HBAA           OHE City
     C                     MOVEL*BLANK    #1J0T1           OHE Vessel/Airl
     C                     Z-ADD*ZERO     #1GENY           OHE Voyage/Flig
     C                     Z-ADD*ZERO     #1QWDT           OHE Sail/Flight
      * Clear external version also
     C                     Z-ADD*ZERO     V1QWDT
     C                     MOVEL*BLANK    #1J1T1           OHE Booking Num
     C                     MOVEL*BLANK    #1J2T1           OHE Container N
     C                     MOVEL*BLANK    #1HCAA           OHE Discharge P
     C                     Z-ADD*ZERO     #1QXDT           OHE Actual Depa
      * Clear external version also
     C                     Z-ADD*ZERO     V1QXDT
     C                     Z-ADD*ZERO     #1QYDT           OHE Arrival Dat
      * Clear external version also
     C                     Z-ADD*ZERO     V1QYDT
     C                     MOVEL*BLANK    #1RLNA           OHE Comment 1
     C                     MOVEL*BLANK    #1RMNA           OHE Comment 2
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @AMREJM fields to screen
      *================================================================
     C                     MOVELAMHDAA    #1HDAA           OHE Unused Code
     C                     Z-ADDAMGINY    #1GINY           OHE Unused Numb
     C                     Z-ADDAMGFNY    #1GFNY           OHE Unused Numb
     C                     Z-ADDAMGGNY    #1GGNY           OHE Unused Numb
     C                     Z-ADDAMGHNY    #1GHNY           OHE Unused Numb
     C                     Z-ADDAMHEVL    #1HEVL           OHE Unused Valu
     C                     Z-ADDAMHFVL    #1HFVL           OHE Unused Valu
     C                     Z-ADDAMHGVL    #1HGVL           OHE Unused Valu
     C                     Z-ADDAMQZDT    #1QZDT           OHE Unused Date
     C                     Z-ADDAMQ0DT    #1Q0DT           OHE Unused Date
     C                     Z-ADDAMQ1DT    #1Q1DT           OHE Unused Date
     C                     Z-ADDAMQ2DT    #1Q2DT           OHE Unused Date
     C                     MOVELAMC2TX    #1C2TX           OHE unused stat
     C                     MOVELAMC3TX    #1C3TX           OHE unused stat
     C                     MOVELAMC6TX    #1C6TX           OHE unused stat
     C                     MOVELAMCHTX    #1CHTX           OHE EDI ASN Sen
     C                     MOVELAMCITX    #1CITX           OHE Unused Stat
     C                     MOVELAMCLTX    #1CLTX           OHE Unused Stat
     C                     MOVELAMB4TX    #1B4TX           OHE Unused Stat
     C                     MOVELAMCUTX    #1CUTX           OHE Unused Stat
     C                     MOVELAMCVTX    #1CVTX           OHE Unused Stat
     C                     MOVELAMB9TX    #1B9TX           OHE Unused Stat
     C                     Z-ADDAMITNY    #1ITNY           HPB COA Batch N
     C                     MOVELAMLMT1    #1LMT1           Delivery P.O. N
     C                     MOVELAMLWAA    #1LWAA           OHE Intended fo
     C                     MOVELAMFVST    #1FVST           OHE Unused Stat
     C                     MOVELAMF0ST    #1F0ST           OHE Unused Stat
     C                     MOVELAMF2ST    #1F2ST           OHE Unused Stat
     C                     MOVELAMF3ST    #1F3ST           OHE Unused Stat
     C                     MOVELAMV3T1    #1V3T1           OHE Unused Text
     C                     MOVELAMV4T1    #1V4T1           OHE Unused Text
     C                     MOVELAMV5T1    #1V5T1           OHE Unused Text
     C                     MOVELAMV6T1    #1V6T1           OHE Unused Text
     C                     MOVELAMV7T1    #1V7T1           OHE Unused Text
     C                     MOVELAMV8T1    #1V8T1           OHE Unused Text
     C                     MOVELAMV9T1    #1V9T1           OHE Unused Text
     C                     MOVELAMWAT1    #1WAT1           OHE Unused Text
     C                     MOVELAMWBT1    #1WBT1           OHE Unused Text
     C                     MOVELAMWCT1    #1WCT1           OHE Unused Text
     C                     MOVELAMWDT1    #1WDT1           OHE Unused Text
     C                     Z-ADDAMQJNY    #1QJNY           OHE Unused Nume
     C                     Z-ADDAMQKNY    #1QKNY           OHE Unused Nume
     C                     Z-ADDAMQLNY    #1QLNY           OHE Unused Nume
     C                     Z-ADDAMP8NY    #1P8NY           OHE Unused Nume
     C                     Z-ADDAMP9NY    #1P9NY           OHE Unused Nume
     C                     Z-ADDAMQANY    #1QANY           OHE Unused Nume
     C                     Z-ADDAMQCNY    #1QCNY           OHE Unused Nume
     C                     Z-ADDAMQDNY    #1QDNY           OHE Unused Nume
     C                     Z-ADDAMQENY    #1QENY           OHE Unused Nume
     C                     Z-ADDAMQFNY    #1QFNY           OHE Unused Nume
     C                     Z-ADDAMQGNY    #1QGNY           OHE Unused Nume
     C                     Z-ADDAMQHNY    #1QHNY           OHE Unused Nume
     C                     Z-ADDAMQINY    #1QINY           OHE Unused Nume
     C                     Z-ADDAMQMNY    #1QMNY           OHE Unused Nume
     C                     MOVELAMUVST    #1UVST           EDI Status 1
     C                     MOVELAMUWST    #1UWST           EDI Status 2
     C                     MOVELAMUXST    #1UXST           EDI Status 3
     C                     MOVELAMVSST    #1VSST           Record Status
     C                     Z-ADDAMAATM    #1AATM           Job Time
     C                     MOVELAMAYNA    #1AYNA           User Id
     C                     MOVELAMA0NA    #1A0NA           Job Name
     C                     Z-ADDAMAXDT    #1AXDT           Job Date
     C                     Z-ADDAMC4NB    #1C4NB           Order Number
     C                     Z-ADDAMRMNB    #1RMNB           Load ID
     C                     Z-ADDAMRUNB    #1RUNB           Stop/Drop Seque
     C                     MOVELAMCCTX    #1CCTX           OHE Ship Status
     C                     Z-ADDAMAIC3    #1AIC3           Company Number
     C                     MOVELAMXACD    #1XACD           Shipping Line
     C                     MOVELAMOANA    #1OANA           Port Delv Termi
     C                     MOVELAMHBAA    #1HBAA           OHE City
     C                     MOVELAMJ0T1    #1J0T1           OHE Vessel/Airl
     C                     Z-ADDAMGENY    #1GENY           OHE Voyage/Flig
     C                     Z-ADDAMQWDT    #1QWDT           OHE Sail/Flight
     C                     MOVELAMJ1T1    #1J1T1           OHE Booking Num
     C                     MOVELAMJ2T1    #1J2T1           OHE Container N
     C                     MOVELAMHCAA    #1HCAA           OHE Discharge P
     C                     Z-ADDAMQXDT    #1QXDT           OHE Actual Depa
     C                     Z-ADDAMQYDT    #1QYDT           OHE Arrival Dat
     C                     MOVELAMRLNA    #1RLNA           OHE Comment 1
     C                     MOVELAMRMNA    #1RMNA           OHE Comment 2
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
      * Check restriction within
     C                     EXSR VDCKRL
      * USER: Initialize key screen
      * ** Test & switch program mode
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PGM.*Return code is *Record already exists
     C           W0RTN     IFEQ 'Y2U0003'                  *IF
     C                     MOVEL'CHG'     W0PMD            *Program mode
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DW1TX           Carrier Name DR
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Requested Delivery Date to display format
      * Convert date
     C           1000000   ADD  #DEIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDEIDT
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  #DAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAODT
      * Convert Actual Ship Date to display format
      * Convert date
     C           1000000   ADD  #DF9DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDF9DT
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert OHE Sail/Flight Date to display format
      * Convert date
     C           1000000   ADD  #1QWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QWDT
      * Convert OHE Actual Depart Date to display format
      * Convert date
     C           1000000   ADD  #1QXDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QXDT
      * Convert OHE Arrival Date to display format
      * Convert date
     C           1000000   ADD  #1QYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1QYDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Load Dispatch flds RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADDWL0001    FJRMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJAODT    WL0002           Scheduled Ship
     C                     MOVELFJDXTX    WL0003           Trailer Id
     C                     MOVELFJBZNA    WL0004           Carrier Code
     C                     Z-ADDFJT4NB    WL0005           Schedule Sequen
     C                     MOVELFJQ2CD    WL0006           Shipping Method
     C                     MOVELFJONTM    WL0007           On Time - (Y/N)
     C                     Z-ADDFJJ4DT    WL0008           Truck Ready Dat
     C                     Z-ADDFJTRTM    WL0009           Truck Ready Tim
     C                     Z-ADDFJJ5DT    WL0010           Spotted Date
     C                     Z-ADDFJSPTM    WL0011           Spotted Time
     C                     Z-ADDFJJ6DT    WL0012           Load Finished D
     C                     Z-ADDFJLFTM    WL0013           Load Finished T
     C                     Z-ADDFJJ7DT    WL0014           BOL Complete Da
     C                     Z-ADDFJBOTM    WL0015           BOL Complete Ti
     C                     Z-ADDFJJ8DT    WL0016           BOL Received Da
     C                     Z-ADDFJBLTM    WL0017           BOL Received Ti
     C                     Z-ADDFJKIDT    WL0018           Truck Departure
     C                     Z-ADDFJASTM    WL0019           Truck Departure
     C                     Z-ADDFJKADT    WL0020           Adjusted Depart
     C                     Z-ADDFJAJCM    WL0021           Adjusted Depart
     C                     MOVELFJXACD    WL0022           Shipping Line
     C                     MOVELFJOANA    WL0023           Port Delv Termi
     C                     Z-ADDFJKJDT    WL0024           Scheduled Deliv
     C                     Z-ADDFJATTM    WL0025           Scheduled Deliv
     C                     MOVELFJOTRS    WL0026           LH Unused Sts
     C                     Z-ADDFJKKDT    WL0027           On Yard Date
     C                     Z-ADDFJAVTM    WL0028           On Yard Time
     C                     MOVELFJLHOS    WL0029           Load Held Over
     C                     MOVELFJR3SX    WL0030           LH On-Time Reas
     C                     MOVELFJR4SX    WL0031           LH Held Over Re
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV All Hdr flds b/ord RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BEC4NB    WQSB01           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Order Number
      * Setup key
     C                     Z-ADDWL0033    WQSB01           Order Number
      * Establish starting position
     C           KRSSB     SETLL@BFCPY2                    *
     C           KRSSB     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEAIC3    WL0032           Company Number
     C                     MOVELBEJNCD    WL0034           Order Type - Sa
     C                     Z-ADDBEANC7    WL0035           A/R Customer Nu
     C                     Z-ADDBEBKC7    WL0036           Ship To Custome
     C                     MOVELBEBRTX    WL0037           Ship To Name
     C                     MOVELBEHMNA    WL0038           Ship To Address
     C                     MOVELBEHONA    WL0039           Ship To Address
     C                     MOVELBEHPNA    WL0040           Ship To Address
     C                     MOVELBEHNNA    WL0041           Ship To City
     C                     MOVELBEDBCD    WL0042           Ship To State C
     C                     MOVELBECKTX    WL0043           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    WL0044           Bill to Custome
     C                     MOVELBEAETX    WL0045           Bill to Name
     C                     MOVELBEB1NA    WL0046           Bill to Address
     C                     MOVELBEB3NA    WL0047           Bill to Address
     C                     MOVELBEB4NA    WL0048           Bill to Address
     C                     MOVELBEB2NA    WL0049           Bill to City
     C                     MOVELBEBHCD    WL0050           Bill to State C
     C                     MOVELBEC8TX    WL0051           Bill to Zip/Pos
     C                     MOVELBEBCNA    WL0052           Customer Purcha
     C                     Z-ADDBEA0DT    WL0053           Order Date
     C                     Z-ADDBEA5DT    WL0054           Requested Ship
     C                     Z-ADDBEGNDT    WL0055           Actual Shipped
     C                     Z-ADDBEACDT    WL0056           Cancel Date
     C                     MOVELBEAQCD    WL0057           Terms Code
     C                     MOVELBEB6NA    WL0058           Special Instruc
     C                     MOVELBEBYNA    WL0059           Special Instruc
     C                     MOVELBEBZNA    WL0060           Carrier Code
     C                     MOVELBEGTST    WL0061           Comment Print A
     C                     MOVELBEGVST    WL0062           Comment Print I
     C                     MOVELBEGUST    WL0063           Comment Print P
     C                     MOVELBEQFST    WL0064           Comment Print S
     C                     MOVELBECQCD    WL0065           Reason Code
     C                     MOVELBEGJST    WL0066           Order in Use
     C                     MOVELBEGWST    WL0067           Header Status
     C                     MOVELBEGXST    WL0068           Header Status L
     C                     MOVELBEGYST    WL0069           Order Type Prin
     C                     Z-ADDBEAODT    WL0070           Scheduled Ship
     C                     MOVELBEAIVN    WL0071           User Original E
     C                     Z-ADDBECXDT    WL0072           Date of Origina
     C                     Z-ADDBEJZVA    WL0073           Order Value Tot
     C                     Z-ADDBEA1WG    WL0074           Order Weight To
     C                     MOVELBEXIST    WL0075           Credit Hold
     C                     MOVELBEXJST    WL0076           Production Hold
     C                     MOVELBEXKST    WL0077           New Customer Ho
     C                     Z-ADDBEEIDT    WL0078           Requested Deliv
     C                     Z-ADDBEAFTM    WL0079           Requested Deliv
     C                     MOVELBEE8CD    WL0080           Accounts Receiv
     C                     MOVELBEE9CD    WL0081           Accounts Receiv
     C                     Z-ADDBERMNB    WL0082           Load ID
     C                     Z-ADDBETBNB    WL0083           Absorbed Freigh
     C                     Z-ADDBER1NB    WL0084           Rated Freight
     C                     MOVELBEPJST    WL0085           LTL Flag
     C                     MOVELBEU0ST    WL0086           Price Audit
     C                     MOVELBEU1ST    WL0087           Price Status
     C                     MOVELBEQ2CD    WL0088           Shipping Method
     C                     MOVELBEU2ST    WL0089           Export Status
     C                     MOVELBEVEST    WL0090           Palletize
     C                     MOVELBEVFST    WL0091           Shrink Wrap
     C                     MOVELBEVGST    WL0092           Slip Sheet
     C                     MOVELBERPCD    WL0093           Age Code
     C                     Z-ADDBERNNB    WL0094           Reefer Temperat
     C                     MOVELBEVDST    WL0095           Load Type
     C                     Z-ADDBEATIN    WL0096           Attach to Invoi
     C                     MOVELBEU4ST    WL0097           Load Plan Order
     C                     MOVELBEU5ST    WL0098           Print Pick Slip
     C                     Z-ADDBERSRN    WL0099           Resell Referenc
     C                     MOVELBEMHNA    WL0100           Special Comment
     C                     MOVELBEMINA    WL0101           Special Comment
     C                     MOVELBEWBST    WL0102           Affect Auto Acc
     C                     MOVELBER4CD    WL0103           Sales Route Cod
     C                     MOVELBEBFCD    WL0104           Manager Level C
     C                     MOVELBEQ4CD    WL0105           VP Level Code
     C                     Z-ADDBET3NB    WL0106           Attach to Order
     C                     MOVELBESICD    WL0107           Reason for Pric
     C                     Z-ADDBECONB    WL0108           Invoice Number
     C                     MOVELBECEST    WL0109           Invoice Suffix
     C                     Z-ADDBEAWDT    WL0110           Invoice Date
     C                     MOVELBEJPCD    WL0111           Event Code
     C                     MOVELBEXUST    WL0112           Trans Contol AS
     C                     MOVELBEZ1ST    WL0113           Modified Flag
     C                     Z-ADDBEVRVA    WL0114           A/R order Value
     C                     MOVELBEOBST    WL0115           Billing Activit
     C                     MOVELBEBCST    WL0116           Block Order Fla
     C                     MOVELBEBDST    WL0117           Order Certifica
     C                     MOVELBEUVST    WL0118           EDI Status 1
     C                     MOVELBEUWST    WL0119           EDI Status 2
     C                     MOVELBEUXST    WL0120           EDI Status 3
     C           KRSSB     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV OHE Ship fields    RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAC4NB           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     Z-ADDP1C4NB    WAC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #1XACD           Shipping Line
     C                     MOVEL*BLANK    #1OANA           Port Delv Termi
     C                     MOVEL*BLANK    #1HBAA           OHE City
     C                     MOVEL*BLANK    #1J0T1           OHE Vessel/Airl
     C                     Z-ADD*ZERO     #1GENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    #1J1T1           OHE Booking Num
     C                     MOVEL*BLANK    #1HCAA           OHE Discharge P
     C                     Z-ADD*ZERO     #1QWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     #1QXDT           OHE Actual Depa
     C                     Z-ADD*ZERO     #1QYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    #1HDAA           OHE Unused Code
     C                     MOVEL*BLANK    #1CCTX           OHE Ship Status
     C                     MOVEL*BLANK    #1J2T1           OHE Container N
     C                     MOVEL*BLANK    #1RLNA           OHE Comment 1
     C                     MOVEL*BLANK    #1RMNA           OHE Comment 2
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAXACD    #1XACD           Shipping Line
     C                     MOVELWAOANA    #1OANA           Port Delv Termi
     C                     MOVELWAHBAA    #1HBAA           OHE City
     C                     MOVELWAJ0T1    #1J0T1           OHE Vessel/Airl
     C                     Z-ADDWAGENY    #1GENY           OHE Voyage/Flig
     C                     MOVELWAJ1T1    #1J1T1           OHE Booking Num
     C                     MOVELWAHCAA    #1HCAA           OHE Discharge P
     C                     Z-ADDWAQWDT    #1QWDT           OHE Sail/Flight
     C                     Z-ADDWAQXDT    #1QXDT           OHE Actual Depa
     C                     Z-ADDWAQYDT    #1QYDT           OHE Arrival Dat
     C                     MOVELWAHDAA    #1HDAA           OHE Unused Code
     C                     MOVELWACCTX    #1CCTX           OHE Ship Status
     C                     MOVELWAJ2T1    #1J2T1           OHE Container N
     C                     MOVELWARLNA    #1RLNA           OHE Comment 1
     C                     MOVELWARMNA    #1RMNA           OHE Comment 2
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name Only  RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #DAPTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Carrier Name       RT - Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FFBZNA           Carrier Code
      * Setup key
     C                     MOVELWL0121    FFBZNA           Carrier Code
      * Establish starting position
     C           KRSSE     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0122           Name
     C                     MOVEL*BLANK    WL0123           Record Status
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFFADTX    WL0122           Name
     C                     MOVELFFVSST    WL0123           Record Status
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Order Info by Load RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSF02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSF03           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
     C                     KFLD           WQSF03           Order Number
      * Setup key
     C                     Z-ADDWL0124    WQSF02           Load ID
     C                     Z-ADDWL0135    WQSF03           Order Number
      * Establish starting position
     C           KRSSF     SETLL@FLCPKF                    *
     C           KRSSF     READE@FLCPKF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0125           Stop/Drop Seque
     C                     Z-ADD*ZERO     WL0126           Stop/Drop
     C                     MOVEL*BLANK    WL0127           Comments for Pi
     C                     Z-ADD*ZERO     WL0128           Miles to next s
     C                     Z-ADD*ZERO     WL0129           Freight Charge
     C                     Z-ADD*ZERO     WL0130           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WL0131           Freight Misc. C
     C                     Z-ADD*ZERO     WL0132           Freight Stop Ch
     C                     Z-ADD*ZERO     WL0133           Rated Freight
     C                     Z-ADD*ZERO     WL0134           Company Number
     C                     MOVEL*BLANK    WL0136           Ship Status
     C                     Z-ADD*ZERO     WL0137           Estimated Arriv
     C                     Z-ADD*ZERO     WL0138           Estimated Arriv
     C                     Z-ADD*ZERO     WL0139           Appointment Con
     C                     Z-ADD*ZERO     WL0140           Appointment Con
     C                     MOVEL*BLANK    WL0141           Confirmation Ma
     C                     MOVEL*BLANK    WL0142           Confirmation Nu
     C                     Z-ADD*ZERO     WL0143           Actual Delivery
     C                     Z-ADD*ZERO     WL0144           Actual Delivery
     C                     Z-ADD*ZERO     WL0145           Scheduled Deliv
     C                     Z-ADD*ZERO     WL0146           Scheduled Deliv
     C                     Z-ADD*ZERO     WL0147           Deadline Depart
     C                     Z-ADD*ZERO     WL0148           Deadline Depart
     C                     Z-ADD*ZERO     WL0149           On Yard Date
     C                     Z-ADD*ZERO     WL0150           On Yard Time
     C                     Z-ADD*ZERO     WL0151           MPC Number
     C                     MOVEL*BLANK    WL0152           Load Dtl On Tim
     C                     MOVEL*BLANK    WL0153           On Time Add'l R
     C                     MOVEL*BLANK    WL0154           Seal Nbr 1
     C                     MOVEL*BLANK    WL0155           Seal Nbr 2
     C                     MOVEL*BLANK    WL0156           Seal Nbr 3
     C                     MOVEL*BLANK    WL0157           Seal Nbr 4
     C                     MOVEL*BLANK    WL0158           Seal Nbr 5
     C                     Z-ADD*ZERO     WL0159           LD Carrier Appt
     C                     Z-ADD*ZERO     WL0160           LD Unused Date
     C                     Z-ADD*ZERO     WL0161           LD Unused Date
     C                     Z-ADD*ZERO     WL0162           LD Carrier Appt
     C                     Z-ADD*ZERO     WL0163           LD Unused Time
     C                     Z-ADD*ZERO     WL0164           LD Unused Time
     C                     MOVEL*BLANK    WL0165           Miles Error Sts
     C                     MOVEL*BLANK    WL0166           LD Unused Sts 2
     C                     MOVEL*BLANK    WL0167           HPB Transload S
     C                     MOVEL*BLANK    WL0168           LD Unused Txt 1
     C                     MOVEL*BLANK    WL0169           LD Unused Txt 2
     C                     MOVEL*BLANK    WL0170           LD Unused Txt 3
     C                     MOVEL*BLANK    WL0171           EDI Status 1
     C                     MOVEL*BLANK    WL0172           EDI Status 2
     C                     MOVEL*BLANK    WL0173           EDI Status 3
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRUNB    WL0125           Stop/Drop Seque
     C                     Z-ADDFLRVNB    WL0126           Stop/Drop
     C                     MOVELFLDQTX    WL0127           Comments for Pi
     C                     Z-ADDFLRWNB    WL0128           Miles to next s
     C                     Z-ADDFLRXNB    WL0129           Freight Charge
     C                     Z-ADDFLSQNB    WL0130           Ld Hdr/Ld Dtl U
     C                     Z-ADDFLT0NB    WL0131           Freight Misc. C
     C                     Z-ADDFLT1NB    WL0132           Freight Stop Ch
     C                     Z-ADDFLR1NB    WL0133           Rated Freight
     C                     Z-ADDFLAIC3    WL0134           Company Number
     C                     MOVELFLVCST    WL0136           Ship Status
     C                     Z-ADDFLKEDT    WL0137           Estimated Arriv
     C                     Z-ADDFLSXNB    WL0138           Estimated Arriv
     C                     Z-ADDFLKFDT    WL0139           Appointment Con
     C                     Z-ADDFLACTM    WL0140           Appointment Con
     C                     MOVELFLK5TX    WL0141           Confirmation Ma
     C                     MOVELFLW5CD    WL0142           Confirmation Nu
     C                     Z-ADDFLEJDT    WL0143           Actual Delivery
     C                     Z-ADDFLAGTM    WL0144           Actual Delivery
     C                     Z-ADDFLKJDT    WL0145           Scheduled Deliv
     C                     Z-ADDFLATTM    WL0146           Scheduled Deliv
     C                     Z-ADDFLHDDT    WL0147           Deadline Depart
     C                     Z-ADDFLAUTM    WL0148           Deadline Depart
     C                     Z-ADDFLKKDT    WL0149           On Yard Date
     C                     Z-ADDFLAVTM    WL0150           On Yard Time
     C                     Z-ADDFLZ4NB    WL0151           MPC Number
     C                     MOVELFLY7ST    WL0152           Load Dtl On Tim
     C                     MOVELFLY2ST    WL0153           On Time Add'l R
     C                     MOVELFLWHTX    WL0154           Seal Nbr 1
     C                     MOVELFLWITX    WL0155           Seal Nbr 2
     C                     MOVELFLWJTX    WL0156           Seal Nbr 3
     C                     MOVELFLWKTX    WL0157           Seal Nbr 4
     C                     MOVELFLWLTX    WL0158           Seal Nbr 5
     C                     Z-ADDFLN7DT    WL0159           LD Carrier Appt
     C                     Z-ADDFLN8DT    WL0160           LD Unused Date
     C                     Z-ADDFLN9DT    WL0161           LD Unused Date
     C                     Z-ADDFLB3TM    WL0162           LD Carrier Appt
     C                     Z-ADDFLB4TM    WL0163           LD Unused Time
     C                     Z-ADDFLB5TM    WL0164           LD Unused Time
     C                     MOVELFLIASX    WL0165           Miles Error Sts
     C                     MOVELFLIBSX    WL0166           LD Unused Sts 2
     C                     MOVELFLICSX    WL0167           HPB Transload S
     C                     MOVELFLWVTX    WL0168           LD Unused Txt 1
     C                     MOVELFLWWTX    WL0169           LD Unused Txt 2
     C                     MOVELFLWXTX    WL0170           LD Unused Txt 3
     C                     MOVELFLUVST    WL0171           EDI Status 1
     C                     MOVELFLUWST    WL0172           EDI Status 2
     C                     MOVELFLUXST    WL0173           EDI Status 3
     C           KRSSF     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Shp Line/Port All  RT - Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           LCXACD           Shipping Line
     C                     KFLD           LCOANA           Port Delv Termi
      * Setup key
     C                     MOVELWL0174    LCXACD           Shipping Line
     C                     MOVELWL0175    LCOANA           Port Delv Termi
      * Establish starting position
     C           KRSSG     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0176           Port City
     C                     MOVEL*BLANK    WL0177           Port Address Li
     C                     MOVEL*BLANK    WL0178           Port Address Li
     C                     MOVEL*BLANK    WL0179           Sail Port State
     C                     MOVEL*BLANK    WL0180           Port Zip/Postal
     C                     Z-ADD*ZERO     WL0181           Port Phone Numb
     C                     MOVEL*BLANK    WL0182           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLCOKTX    WL0176           Port City
     C                     MOVELLCLBTX    WL0177           Port Address Li
     C                     MOVELLCLATX    WL0178           Port Address Li
     C                     MOVELLCXBCD    WL0179           Sail Port State
     C                     MOVELLCLCTX    WL0180           Port Zip/Postal
     C                     Z-ADDLCSPPN    WL0181           Port Phone Numb
     C                     MOVELLCLDTX    WL0182           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Order Header Exten CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDP3FKNB    AMAIC3           Company Number
     C                     Z-ADDP1C4NB    AMC4NB           Order Number
     C                     Z-ADDP1RMNB    AMRMNB           Load ID
     C                     Z-ADD#1RUNB    AMRUNB           Stop/Drop Seque
     C                     MOVEL#1XACD    AMXACD           Shipping Line
     C                     MOVEL#1OANA    AMOANA           Port Delv Termi
     C                     MOVEL#1HBAA    AMHBAA           OHE City
     C                     MOVEL#1J0T1    AMJ0T1           OHE Vessel/Airl
     C                     Z-ADD#1GENY    AMGENY           OHE Voyage/Flig
     C                     MOVEL#1J1T1    AMJ1T1           OHE Booking Num
     C                     MOVEL#1HCAA    AMHCAA           OHE Discharge P
     C                     Z-ADD#1QWDT    AMQWDT           OHE Sail/Flight
     C                     Z-ADD#1QXDT    AMQXDT           OHE Actual Depa
     C                     Z-ADD#1QYDT    AMQYDT           OHE Arrival Dat
     C                     MOVEL#1HDAA    AMHDAA           OHE Unused Code
     C                     MOVEL#1CCTX    AMCCTX           OHE Ship Status
     C                     MOVEL#1J2T1    AMJ2T1           OHE Container N
     C                     MOVEL#1RLNA    AMRLNA           OHE Comment 1
     C                     MOVEL#1RMNA    AMRMNA           OHE Comment 2
     C                     Z-ADD#1GINY    AMGINY           OHE Unused Numb
     C                     Z-ADD#1GFNY    AMGFNY           OHE Unused Numb
     C                     Z-ADD#1GGNY    AMGGNY           OHE Unused Numb
     C                     Z-ADD#1GHNY    AMGHNY           OHE Unused Numb
     C                     Z-ADD#1HEVL    AMHEVL           OHE Unused Valu
     C                     Z-ADD#1HFVL    AMHFVL           OHE Unused Valu
     C                     Z-ADD#1HGVL    AMHGVL           OHE Unused Valu
     C                     Z-ADD#1QZDT    AMQZDT           OHE Unused Date
     C                     Z-ADD#1Q0DT    AMQ0DT           OHE Unused Date
     C                     Z-ADD#1Q1DT    AMQ1DT           OHE Unused Date
     C                     Z-ADD#1Q2DT    AMQ2DT           OHE Unused Date
     C                     MOVEL#1C2TX    AMC2TX           OHE unused stat
     C                     MOVEL#1C3TX    AMC3TX           OHE unused stat
     C                     MOVEL#1C6TX    AMC6TX           OHE unused stat
     C                     MOVEL#1CHTX    AMCHTX           OHE EDI ASN Sen
     C                     MOVEL#1CITX    AMCITX           OHE Unused Stat
     C                     MOVEL#1CLTX    AMCLTX           OHE Unused Stat
     C                     MOVEL#1B4TX    AMB4TX           OHE Unused Stat
     C                     MOVEL#1CUTX    AMCUTX           OHE Unused Stat
     C                     MOVEL#1CVTX    AMCVTX           OHE Unused Stat
     C                     MOVEL#1B9TX    AMB9TX           OHE Unused Stat
     C                     Z-ADD#1ITNY    AMITNY           HPB COA Batch N
     C                     MOVEL#1LMT1    AMLMT1           Delivery P.O. N
     C                     MOVEL#1LWAA    AMLWAA           OHE Intended fo
     C                     MOVEL#1FVST    AMFVST           OHE Unused Stat
     C                     MOVEL#1F0ST    AMF0ST           OHE Unused Stat
     C                     MOVEL#1F2ST    AMF2ST           OHE Unused Stat
     C                     MOVEL#1F3ST    AMF3ST           OHE Unused Stat
     C                     MOVEL#1V3T1    AMV3T1           OHE Unused Text
     C                     MOVEL#1V4T1    AMV4T1           OHE Unused Text
     C                     MOVEL#1V5T1    AMV5T1           OHE Unused Text
     C                     MOVEL#1V6T1    AMV6T1           OHE Unused Text
     C                     MOVEL#1V7T1    AMV7T1           OHE Unused Text
     C                     MOVEL#1V8T1    AMV8T1           OHE Unused Text
     C                     MOVEL#1V9T1    AMV9T1           OHE Unused Text
     C                     MOVEL#1WAT1    AMWAT1           OHE Unused Text
     C                     MOVEL#1WBT1    AMWBT1           OHE Unused Text
     C                     MOVEL#1WCT1    AMWCT1           OHE Unused Text
     C                     MOVEL#1WDT1    AMWDT1           OHE Unused Text
     C                     Z-ADD#1QJNY    AMQJNY           OHE Unused Nume
     C                     Z-ADD#1QKNY    AMQKNY           OHE Unused Nume
     C                     Z-ADD#1QLNY    AMQLNY           OHE Unused Nume
     C                     Z-ADD#1P8NY    AMP8NY           OHE Unused Nume
     C                     Z-ADD#1P9NY    AMP9NY           OHE Unused Nume
     C                     Z-ADD#1QANY    AMQANY           OHE Unused Nume
     C                     Z-ADD#1QCNY    AMQCNY           OHE Unused Nume
     C                     Z-ADD#1QDNY    AMQDNY           OHE Unused Nume
     C                     Z-ADD#1QENY    AMQENY           OHE Unused Nume
     C                     Z-ADD#1QFNY    AMQFNY           OHE Unused Nume
     C                     Z-ADD#1QGNY    AMQGNY           OHE Unused Nume
     C                     Z-ADD#1QHNY    AMQHNY           OHE Unused Nume
     C                     Z-ADD#1QINY    AMQINY           OHE Unused Nume
     C                     Z-ADD#1QMNY    AMQMNY           OHE Unused Nume
     C                     MOVEL#1UVST    AMUVST           EDI Status 1
     C                     MOVEL#1UWST    AMUWST           EDI Status 2
     C                     MOVEL#1UXST    AMUXST           EDI Status 3
     C                     MOVEL'A'       AMVSST           Record Status
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     MOVEL##USR     AMAYNA           User Id
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     Z-ADD##JDT     AMAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
     C           KLCRSH    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * USER: Processing if Data record already exists
      * CHG Existing OHE       CH - Order Header Extension  * 
     C                     EXSR SICHRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Existing OHE       CH - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDP3FKNB    AMAIC3           Company Number
     C                     Z-ADDP1C4NB    AMC4NB           Order Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
     C           KLCHSI    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE @1DBRC    YARDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDP1RMNB    AMRMNB           Load ID
     C                     Z-ADD#1RUNB    AMRUNB           Stop/Drop Seque
     C                     MOVEL#1XACD    AMXACD    P      Shipping Line
     C                     MOVEL#1OANA    AMOANA    P      Port Delv Termi
     C                     MOVEL#1HBAA    AMHBAA    P      OHE City
     C                     MOVEL#1J0T1    AMJ0T1    P      OHE Vessel/Airl
     C                     Z-ADD#1GENY    AMGENY           OHE Voyage/Flig
     C                     MOVEL#1J1T1    AMJ1T1    P      OHE Booking Num
     C                     MOVEL#1HCAA    AMHCAA    P      OHE Discharge P
     C                     Z-ADD#1QWDT    AMQWDT           OHE Sail/Flight
     C                     Z-ADD#1QXDT    AMQXDT           OHE Actual Depa
     C                     Z-ADD#1QYDT    AMQYDT           OHE Arrival Dat
     C                     MOVEL#1HDAA    AMHDAA    P      OHE Unused Code
     C                     MOVEL#1CCTX    AMCCTX    P      OHE Ship Status
     C                     MOVEL#1J2T1    AMJ2T1    P      OHE Container N
     C                     MOVEL#1RLNA    AMRLNA    P      OHE Comment 1
     C                     MOVEL#1RMNA    AMRMNA    P      OHE Comment 2
     C                     Z-ADD#1GINY    AMGINY           OHE Unused Numb
     C                     Z-ADD#1GFNY    AMGFNY           OHE Unused Numb
     C                     Z-ADD#1GGNY    AMGGNY           OHE Unused Numb
     C                     Z-ADD#1GHNY    AMGHNY           OHE Unused Numb
     C                     Z-ADD#1HEVL    AMHEVL           OHE Unused Valu
     C                     Z-ADD#1HFVL    AMHFVL           OHE Unused Valu
     C                     Z-ADD#1HGVL    AMHGVL           OHE Unused Valu
     C                     Z-ADD#1QZDT    AMQZDT           OHE Unused Date
     C                     Z-ADD#1Q0DT    AMQ0DT           OHE Unused Date
     C                     Z-ADD#1Q1DT    AMQ1DT           OHE Unused Date
     C                     Z-ADD#1Q2DT    AMQ2DT           OHE Unused Date
     C                     MOVEL#1C2TX    AMC2TX    P      OHE unused stat
     C                     MOVEL#1C3TX    AMC3TX    P      OHE unused stat
     C                     MOVEL#1C6TX    AMC6TX    P      OHE unused stat
     C                     MOVEL#1CHTX    AMCHTX    P      OHE EDI ASN Sen
     C                     MOVEL#1CITX    AMCITX    P      OHE Unused Stat
     C                     MOVEL#1CLTX    AMCLTX    P      OHE Unused Stat
     C                     MOVEL#1B4TX    AMB4TX    P      OHE Unused Stat
     C                     MOVEL#1CUTX    AMCUTX    P      OHE Unused Stat
     C                     MOVEL#1CVTX    AMCVTX    P      OHE Unused Stat
     C                     MOVEL#1B9TX    AMB9TX    P      OHE Unused Stat
     C                     Z-ADD#1ITNY    AMITNY           HPB COA Batch N
     C                     MOVEL#1LMT1    AMLMT1    P      Delivery P.O. N
     C                     MOVEL#1LWAA    AMLWAA    P      OHE Intended fo
     C                     MOVEL#1FVST    AMFVST    P      OHE Unused Stat
     C                     MOVEL#1F0ST    AMF0ST    P      OHE Unused Stat
     C                     MOVEL#1F2ST    AMF2ST    P      OHE Unused Stat
     C                     MOVEL#1F3ST    AMF3ST    P      OHE Unused Stat
     C                     MOVEL#1V3T1    AMV3T1    P      OHE Unused Text
     C                     MOVEL#1V4T1    AMV4T1    P      OHE Unused Text
     C                     MOVEL#1V5T1    AMV5T1    P      OHE Unused Text
     C                     MOVEL#1V6T1    AMV6T1    P      OHE Unused Text
     C                     MOVEL#1V7T1    AMV7T1    P      OHE Unused Text
     C                     MOVEL#1V8T1    AMV8T1    P      OHE Unused Text
     C                     MOVEL#1V9T1    AMV9T1    P      OHE Unused Text
     C                     MOVEL#1WAT1    AMWAT1    P      OHE Unused Text
     C                     MOVEL#1WBT1    AMWBT1    P      OHE Unused Text
     C                     MOVEL#1WCT1    AMWCT1    P      OHE Unused Text
     C                     MOVEL#1WDT1    AMWDT1    P      OHE Unused Text
     C                     Z-ADD#1QJNY    AMQJNY           OHE Unused Nume
     C                     Z-ADD#1QKNY    AMQKNY           OHE Unused Nume
     C                     Z-ADD#1QLNY    AMQLNY           OHE Unused Nume
     C                     Z-ADD#1P8NY    AMP8NY           OHE Unused Nume
     C                     Z-ADD#1P9NY    AMP9NY           OHE Unused Nume
     C                     Z-ADD#1QANY    AMQANY           OHE Unused Nume
     C                     Z-ADD#1QCNY    AMQCNY           OHE Unused Nume
     C                     Z-ADD#1QDNY    AMQDNY           OHE Unused Nume
     C                     Z-ADD#1QENY    AMQENY           OHE Unused Nume
     C                     Z-ADD#1QFNY    AMQFNY           OHE Unused Nume
     C                     Z-ADD#1QGNY    AMQGNY           OHE Unused Nume
     C                     Z-ADD#1QHNY    AMQHNY           OHE Unused Nume
     C                     Z-ADD#1QINY    AMQINY           OHE Unused Nume
     C                     Z-ADD#1QMNY    AMQMNY           OHE Unused Nume
     C                     MOVEL#1UVST    AMUVST    P      EDI Status 1
     C                     MOVEL#1UWST    AMUWST    P      EDI Status 2
     C                     MOVEL#1UXST    AMUXST    P      EDI Status 3
     C                     MOVEL'A'       AMVSST    P      Record Status
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     MOVEL##USR     AMAYNA    P      User Id
     C                     MOVEL##PGM     AMA0NA    P      Job Name
     C                     Z-ADD##JDT     AMAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Delete Order Header Exten - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @AMREJE
     C                     Z-ADD#1AIC3    AMAIC3           Company Number
     C                     Z-ADD#1C4NB    AMC4NB           Order Number
      *
     C           KLDLSJ    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
     C           KLDLSJ    CHAIN@AMREJE              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C           KLDLSJ    SETLL@AMREJE              9091  *
     C                     GOTO SJEXIT
     C                     ENDIF                           FI #1DBRC
      *................................................................
     C                     DELET@AMREJE                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * CHG OrdHdr Ext/SlsHst CH - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDP3FKNB    AMAIC3           Company Number
     C                     Z-ADDP1C4NB    AMC4NB           Order Number
      *
     C           KLCHSK    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
     C           KLCHSK    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) #1LWAA' defaulted for 'OHE Intended for ExportCC'.
      * Field '(PAR) #1FVST' defaulted for 'OHE Unused Status 6 1'.
      * Field '(PAR) #1F0ST' defaulted for 'OHE Unused Status 6 2'.
      * Field '(PAR) #1F2ST' defaulted for 'OHE Unused Status 6 3'.
      * Field '(PAR) #1F3ST' defaulted for 'OHE Unused Status 6 4'.
      * Field '(PAR) #1V3T1' defaulted for 'OHE Unused Text 10 1'.
      * Field '(PAR) #1V4T1' defaulted for 'OHE Unused Text 10 2'.
      * Field '(PAR) #1V5T1' defaulted for 'OHE Unused Text 10 3'.
      * Field '(PAR) #1V6T1' defaulted for 'OHE Unused Text 15 1'.
      * Field '(PAR) #1V7T1' defaulted for 'OHE Unused Text 15 2'.
      * Field '(PAR) #1V8T1' defaulted for 'OHE Unused Text 15 3'.
      * Field '(PAR) #1V9T1' defaulted for 'OHE Unused Text 30 1'.
      * Field '(PAR) #1WAT1' defaulted for 'OHE Unused Text 30 2'.
      * Field '(PAR) #1WBT1' defaulted for 'OHE Unused Text 30 3'.
      * Field '(PAR) #1WCT1' defaulted for 'OHE Unused Text 50 1'.
      * Field '(PAR) #1WDT1' defaulted for 'OHE Unused Text 50 2'.
      * Field '(PAR) #1QJNY' defaulted for 'OHE Unused Numeric 3,0 1'.
      * Field '(PAR) #1QKNY' defaulted for 'OHE Unused Numeric 3,0 2'.
      * Field '(PAR) #1QLNY' defaulted for 'OHE Unused Numeric 3,0 3'.
      * Field '(PAR) #1P8NY' defaulted for 'OHE Unused Numeric 5,0 1'.
      * Field '(PAR) #1P9NY' defaulted for 'OHE Unused Numeric 5,0 2'.
      * Field '(PAR) #1QANY' defaulted for 'OHE Unused Numeric 5,0 3'.
      * Field '(PAR) #1QCNY' defaulted for 'OHE Unused Numeric 6,0 1'.
      * Field '(PAR) #1QDNY' defaulted for 'OHE Unused Numeric 6,0 2'.
      * Field '(PAR) #1QENY' defaulted for 'OHE Unused Numeric 6,0 3'.
      * Field '(PAR) #1QFNY' defaulted for 'OHE Unused Numeric 6,0 4'.
      * Field '(PAR) #1QGNY' defaulted for 'OHE Unused Numeric 9,0 1'.
      * Field '(PAR) #1QHNY' defaulted for 'OHE Unused Numeric 9,0 2'.
      * Field '(PAR) #1QINY' defaulted for 'OHE Unused Numeric 9,0 3'.
      * Field '(PAR) #1QMNY' defaulted for 'OHE Unused Numeric 9,6 1'.
      * CRT Existing OHE       CR - Order Header Extension  * 
     C                     EXSR SLCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     GOTO SKEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDP1RMNB    AMRMNB           Load ID
     C                     Z-ADD#1RUNB    AMRUNB           Stop/Drop Seque
     C                     MOVEL#1XACD    AMXACD    P      Shipping Line
     C                     MOVEL#1OANA    AMOANA    P      Port Delv Termi
     C                     MOVEL#1HBAA    AMHBAA    P      OHE City
     C                     MOVEL#1J0T1    AMJ0T1    P      OHE Vessel/Airl
     C                     Z-ADD#1GENY    AMGENY           OHE Voyage/Flig
     C                     MOVEL#1J1T1    AMJ1T1    P      OHE Booking Num
     C                     MOVEL#1HCAA    AMHCAA    P      OHE Discharge P
     C                     Z-ADD#1QWDT    AMQWDT           OHE Sail/Flight
     C                     Z-ADD#1QXDT    AMQXDT           OHE Actual Depa
     C                     Z-ADD#1QYDT    AMQYDT           OHE Arrival Dat
     C                     MOVEL#1HDAA    AMHDAA    P      OHE Unused Code
     C                     MOVEL#1CCTX    AMCCTX    P      OHE Ship Status
     C                     MOVEL#1J2T1    AMJ2T1    P      OHE Container N
     C                     MOVEL#1RLNA    AMRLNA    P      OHE Comment 1
     C                     MOVEL#1RMNA    AMRMNA    P      OHE Comment 2
     C                     Z-ADD#1GINY    AMGINY           OHE Unused Numb
     C                     Z-ADD#1GFNY    AMGFNY           OHE Unused Numb
     C                     Z-ADD#1GGNY    AMGGNY           OHE Unused Numb
     C                     Z-ADD#1GHNY    AMGHNY           OHE Unused Numb
     C                     Z-ADD#1HEVL    AMHEVL           OHE Unused Valu
     C                     Z-ADD#1HFVL    AMHFVL           OHE Unused Valu
     C                     Z-ADD#1HGVL    AMHGVL           OHE Unused Valu
     C                     Z-ADD#1QZDT    AMQZDT           OHE Unused Date
     C                     Z-ADD#1Q0DT    AMQ0DT           OHE Unused Date
     C                     Z-ADD#1Q1DT    AMQ1DT           OHE Unused Date
     C                     Z-ADD#1Q2DT    AMQ2DT           OHE Unused Date
     C                     MOVEL#1C2TX    AMC2TX    P      OHE unused stat
     C                     MOVEL#1C3TX    AMC3TX    P      OHE unused stat
     C                     MOVEL#1C6TX    AMC6TX    P      OHE unused stat
     C                     MOVEL#1CHTX    AMCHTX    P      OHE EDI ASN Sen
     C                     MOVEL#1CITX    AMCITX    P      OHE Unused Stat
     C                     MOVEL#1CLTX    AMCLTX    P      OHE Unused Stat
     C                     MOVEL#1B4TX    AMB4TX    P      OHE Unused Stat
     C                     MOVEL#1CUTX    AMCUTX    P      OHE Unused Stat
     C                     MOVEL#1CVTX    AMCVTX    P      OHE Unused Stat
     C                     MOVEL#1B9TX    AMB9TX    P      OHE Unused Stat
     C                     Z-ADD#1ITNY    AMITNY           HPB COA Batch N
     C                     MOVEL#1LMT1    AMLMT1    P      Delivery P.O. N
     C                     MOVEL#1LWAA    AMLWAA    P      OHE Intended fo
     C                     MOVEL#1FVST    AMFVST    P      OHE Unused Stat
     C                     MOVEL#1F0ST    AMF0ST    P      OHE Unused Stat
     C                     MOVEL#1F2ST    AMF2ST    P      OHE Unused Stat
     C                     MOVEL#1F3ST    AMF3ST    P      OHE Unused Stat
     C                     MOVEL#1V3T1    AMV3T1    P      OHE Unused Text
     C                     MOVEL#1V4T1    AMV4T1    P      OHE Unused Text
     C                     MOVEL#1V5T1    AMV5T1    P      OHE Unused Text
     C                     MOVEL#1V6T1    AMV6T1    P      OHE Unused Text
     C                     MOVEL#1V7T1    AMV7T1    P      OHE Unused Text
     C                     MOVEL#1V8T1    AMV8T1    P      OHE Unused Text
     C                     MOVEL#1V9T1    AMV9T1    P      OHE Unused Text
     C                     MOVEL#1WAT1    AMWAT1    P      OHE Unused Text
     C                     MOVEL#1WBT1    AMWBT1    P      OHE Unused Text
     C                     MOVEL#1WCT1    AMWCT1    P      OHE Unused Text
     C                     MOVEL#1WDT1    AMWDT1    P      OHE Unused Text
     C                     Z-ADD#1QJNY    AMQJNY           OHE Unused Nume
     C                     Z-ADD#1QKNY    AMQKNY           OHE Unused Nume
     C                     Z-ADD#1QLNY    AMQLNY           OHE Unused Nume
     C                     Z-ADD#1P8NY    AMP8NY           OHE Unused Nume
     C                     Z-ADD#1P9NY    AMP9NY           OHE Unused Nume
     C                     Z-ADD#1QANY    AMQANY           OHE Unused Nume
     C                     Z-ADD#1QCNY    AMQCNY           OHE Unused Nume
     C                     Z-ADD#1QDNY    AMQDNY           OHE Unused Nume
     C                     Z-ADD#1QENY    AMQENY           OHE Unused Nume
     C                     Z-ADD#1QFNY    AMQFNY           OHE Unused Nume
     C                     Z-ADD#1QGNY    AMQGNY           OHE Unused Nume
     C                     Z-ADD#1QHNY    AMQHNY           OHE Unused Nume
     C                     Z-ADD#1QINY    AMQINY           OHE Unused Nume
     C                     Z-ADD#1QMNY    AMQMNY           OHE Unused Nume
     C                     MOVEL#1UVST    AMUVST    P      EDI Status 1
     C                     MOVEL#1UWST    AMUWST    P      EDI Status 2
     C                     MOVEL#1UXST    AMUXST    P      EDI Status 3
     C                     MOVEL#1VSST    AMVSST    P      Record Status
     C                     Z-ADD#1AATM    AMAATM           Job Time
     C                     MOVEL#1AYNA    AMAYNA    P      User Id
     C                     MOVEL#1A0NA    AMA0NA    P      Job Name
     C                     Z-ADD#1AXDT    AMAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * CASE: PAR.OHE Arrival Date is Entered
     C           #1QYDT    IFNE *ZERO                      *IF
      * Upd Arrival Date      RT - Sales History  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT Existing OHE       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDP3FKNB    AMAIC3           Company Number
     C                     Z-ADDP1C4NB    AMC4NB           Order Number
     C                     Z-ADDP1RMNB    AMRMNB           Load ID
     C                     Z-ADD#1RUNB    AMRUNB           Stop/Drop Seque
     C                     MOVEL#1XACD    AMXACD           Shipping Line
     C                     MOVEL#1OANA    AMOANA           Port Delv Termi
     C                     MOVEL#1HBAA    AMHBAA           OHE City
     C                     MOVEL#1J0T1    AMJ0T1           OHE Vessel/Airl
     C                     Z-ADD#1GENY    AMGENY           OHE Voyage/Flig
     C                     MOVEL#1J1T1    AMJ1T1           OHE Booking Num
     C                     MOVEL#1HCAA    AMHCAA           OHE Discharge P
     C                     Z-ADD#1QWDT    AMQWDT           OHE Sail/Flight
     C                     Z-ADD#1QXDT    AMQXDT           OHE Actual Depa
     C                     Z-ADD#1QYDT    AMQYDT           OHE Arrival Dat
     C                     MOVEL#1HDAA    AMHDAA           OHE Unused Code
     C                     MOVEL#1CCTX    AMCCTX           OHE Ship Status
     C                     MOVEL#1J2T1    AMJ2T1           OHE Container N
     C                     MOVEL#1RLNA    AMRLNA           OHE Comment 1
     C                     MOVEL#1RMNA    AMRMNA           OHE Comment 2
     C                     Z-ADD#1GINY    AMGINY           OHE Unused Numb
     C                     Z-ADD#1GFNY    AMGFNY           OHE Unused Numb
     C                     Z-ADD#1GGNY    AMGGNY           OHE Unused Numb
     C                     Z-ADD#1GHNY    AMGHNY           OHE Unused Numb
     C                     Z-ADD#1HEVL    AMHEVL           OHE Unused Valu
     C                     Z-ADD#1HFVL    AMHFVL           OHE Unused Valu
     C                     Z-ADD#1HGVL    AMHGVL           OHE Unused Valu
     C                     Z-ADD#1QZDT    AMQZDT           OHE Unused Date
     C                     Z-ADD#1Q0DT    AMQ0DT           OHE Unused Date
     C                     Z-ADD#1Q1DT    AMQ1DT           OHE Unused Date
     C                     Z-ADD#1Q2DT    AMQ2DT           OHE Unused Date
     C                     MOVEL#1C2TX    AMC2TX           OHE unused stat
     C                     MOVEL#1C3TX    AMC3TX           OHE unused stat
     C                     MOVEL#1C6TX    AMC6TX           OHE unused stat
     C                     MOVEL#1CHTX    AMCHTX           OHE EDI ASN Sen
     C                     MOVEL#1CITX    AMCITX           OHE Unused Stat
     C                     MOVEL#1CLTX    AMCLTX           OHE Unused Stat
     C                     MOVEL#1B4TX    AMB4TX           OHE Unused Stat
     C                     MOVEL#1CUTX    AMCUTX           OHE Unused Stat
     C                     MOVEL#1CVTX    AMCVTX           OHE Unused Stat
     C                     MOVEL#1B9TX    AMB9TX           OHE Unused Stat
     C                     Z-ADD#1ITNY    AMITNY           HPB COA Batch N
     C                     MOVEL#1LMT1    AMLMT1           Delivery P.O. N
     C                     MOVEL#1LWAA    AMLWAA           OHE Intended fo
     C                     MOVEL#1FVST    AMFVST           OHE Unused Stat
     C                     MOVEL#1F0ST    AMF0ST           OHE Unused Stat
     C                     MOVEL#1F2ST    AMF2ST           OHE Unused Stat
     C                     MOVEL#1F3ST    AMF3ST           OHE Unused Stat
     C                     MOVEL#1V3T1    AMV3T1           OHE Unused Text
     C                     MOVEL#1V4T1    AMV4T1           OHE Unused Text
     C                     MOVEL#1V5T1    AMV5T1           OHE Unused Text
     C                     MOVEL#1V6T1    AMV6T1           OHE Unused Text
     C                     MOVEL#1V7T1    AMV7T1           OHE Unused Text
     C                     MOVEL#1V8T1    AMV8T1           OHE Unused Text
     C                     MOVEL#1V9T1    AMV9T1           OHE Unused Text
     C                     MOVEL#1WAT1    AMWAT1           OHE Unused Text
     C                     MOVEL#1WBT1    AMWBT1           OHE Unused Text
     C                     MOVEL#1WCT1    AMWCT1           OHE Unused Text
     C                     MOVEL#1WDT1    AMWDT1           OHE Unused Text
     C                     Z-ADD#1QJNY    AMQJNY           OHE Unused Nume
     C                     Z-ADD#1QKNY    AMQKNY           OHE Unused Nume
     C                     Z-ADD#1QLNY    AMQLNY           OHE Unused Nume
     C                     Z-ADD#1P8NY    AMP8NY           OHE Unused Nume
     C                     Z-ADD#1P9NY    AMP9NY           OHE Unused Nume
     C                     Z-ADD#1QANY    AMQANY           OHE Unused Nume
     C                     Z-ADD#1QCNY    AMQCNY           OHE Unused Nume
     C                     Z-ADD#1QDNY    AMQDNY           OHE Unused Nume
     C                     Z-ADD#1QENY    AMQENY           OHE Unused Nume
     C                     Z-ADD#1QFNY    AMQFNY           OHE Unused Nume
     C                     Z-ADD#1QGNY    AMQGNY           OHE Unused Nume
     C                     Z-ADD#1QHNY    AMQHNY           OHE Unused Nume
     C                     Z-ADD#1QINY    AMQINY           OHE Unused Nume
     C                     Z-ADD#1QMNY    AMQMNY           OHE Unused Nume
     C                     MOVEL#1UVST    AMUVST           EDI Status 1
     C                     MOVEL#1UWST    AMUWST           EDI Status 2
     C                     MOVEL#1UXST    AMUXST           EDI Status 3
     C                     MOVEL#1VSST    AMVSST           Record Status
     C                     Z-ADD#1AATM    AMAATM           Job Time
     C                     MOVEL#1AYNA    AMAYNA           User Id
     C                     MOVEL#1A0NA    AMA0NA           Job Name
     C                     Z-ADD#1AXDT    AMAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     AMAATM           Job Time
     C                     Z-ADD##JDT     AMAXDT           Job Date
     C                     MOVEL##PGM     AMA0NA           Job Name
     C                     MOVEL##USR     AMAYNA           User Id
     C           KLCRSL    KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSL    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Upd Arrival Date      RT - Sales History  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN F4AIC3    WQSM01           Company Number
     C           *LIKE     DEFN F4C4NB    WQSM02           Order Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDP3FKNB    WQSM01           Company Number
     C                     Z-ADDP1C4NB    WQSM02           Order Number
      * Establish starting position
     C           KRSSM     SETLL@FHSTD3                    *
     C           KRSSM     READE@FHSTD3                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.LD Arrival Date NE PAR.LD Arrival Date
     C           F4HCDT    IFNE #1QYDT                     *IF
      * Chg Arrival Date      CH - Sales History  * 
     C                     EXSR SNCHRC
     C                     END                             *FI
     C           KRSSM     READE@FHSTD3                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCHRC    BEGSR
      *================================================================
      * Chg Arrival Date      CH - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 20        A/R City
     C                     MOVEL*BLANK    WN0002  2        A/R State
     C                     MOVEL*BLANK    WN0003  6        A/R County Code
     C                     MOVEL*BLANK    WN0004 11        A/R Zip/Postal
     C                     MOVEL*BLANK    WN0005 25        Alpha Search
     C                     MOVEL*BLANK    WN0006  6        Country Code
     C                     MOVEL*BLANK    WN0007  2        Type Code
     C                     Z-ADD*ZERO     WN0008  70       Parent Customer
     C                     Z-ADD*ZERO     WN0009  70       A/R Customer Nu
     C                     MOVEL*BLANK    WN0010 30        A/R Customer Na
     C                     Z-ADD*ZERO     WN0011  70       Ship To Custome
     C                     MOVEL*BLANK    WN0012 30        Ship To Name
     C                     MOVEL*BLANK    WN0013 20        Ship To City
     C                     MOVEL*BLANK    WN0014  2        Ship To State C
     C                     MOVEL*BLANK    WN0015 11        Ship To Zip/Pos
     C                     MOVEL*BLANK    WN0016 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0017  70       Order Date
     C                     Z-ADD*ZERO     WN0018  70       Cancel Date
     C                     MOVEL*BLANK    WN0019  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0020  3        Original Salesp
     C                     MOVEL*BLANK    WN0021  2        Manager Level C
     C                     MOVEL*BLANK    WN0022  3        VP Level Code
     C                     MOVEL*BLANK    WN0023  2        Terms Code
     C                     Z-ADD*ZERO     WN0024  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0025  3        Carrier Code
     C                     MOVEL*BLANK    WN0026  3        Order Header Re
     C                     MOVEL*BLANK    WN0027  2        Order Type - Sa
     C                     MOVEL*BLANK    WN0028  2        Shipping Method
     C                     MOVEL*BLANK    WN0029  1        Export Status
     C                     Z-ADD*ZERO     WN0030  70       Attach to Invoi
     C                     Z-ADD*ZERO     WN0031  70       Attach to Order
     C                     Z-ADD*ZERO     WN0032  70       Resell Referenc
     C                     Z-ADD*ZERO     WN0033  70       Original Item
     C                     MOVEL*BLANK    WN0034  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0035 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0036 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0037 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0038 112       Weight Schedule
     C                     MOVEL*BLANK    WN0039  2        U/M - Ordered
     C                     Z-ADD*ZERO     WN0040 114       Unit Price
     C                     Z-ADD*ZERO     WN0041 114       Unit Price Orde
     C                     MOVEL*BLANK    WN0042  2        U/M - Base Pric
     C                     Z-ADD*ZERO     WN0043  70       Requested Ship
     C                     Z-ADD*ZERO     WN0044  70       Invoice Date
     C                     Z-ADD*ZERO     WN0045  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0046 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0047 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0048 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0049 112       Extended Amount
     C                     MOVEL*BLANK    WN0050  1        Affect Inventor
     C                     MOVEL*BLANK    WN0051  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0052  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0053  70       Contract Number
     C                     MOVEL*BLANK    WN0054  6        Export Country
     C                     Z-ADD*ZERO     WN0055  40       Accounting Year
     C                     Z-ADD*ZERO     WN0056  20       Accounting Peri
     C                     Z-ADD*ZERO     WN0057  30       OM Week
     C                     Z-ADD*ZERO     WN0058 112       Quantity Billed
     C                     Z-ADD*ZERO     WN0059 112       Weight Billed
     C                     Z-ADD*ZERO     WN0060  70       Shipped Item Co
     C                     Z-ADD*ZERO     WN0061 112       Billing Detail
     C                     Z-ADD*ZERO     WN0062 112       Billing Detail
     C                     Z-ADD*ZERO     WN0063 112       FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0064 112       Standard Overag
     C                     Z-ADD*ZERO     WN0065 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0066  80       G/L Document Nu
     C                     MOVEL*BLANK    WN0067  1        G/L Update Stat
     C                     Z-ADD*ZERO     WN0068  30       Shipping Compan
     C                     MOVEL*BLANK    WN0069  3        Order Detail Re
     C                     Z-ADD*ZERO     WN0070 114       Price Overage O
     C                     MOVEL*BLANK    WN0071  3        Date Method Cod
     C                     MOVEL*BLANK    WN0072  3        Price Method Co
     C                     Z-ADD*ZERO     WN0073  70       Market Pricing
     C                     MOVEL*BLANK    WN0074  3        Commodity Marke
     C                     MOVEL*BLANK    WN0075  2        Quality Level
     C                     MOVEL*BLANK    WN0076  2        Item Level
     C                     Z-ADD*ZERO     WN0077  30       Item Structure
     C                     Z-ADD*ZERO     WN0078  30       Item Structure
     C                     Z-ADD*ZERO     WN0079  30       Item Structure
     C                     Z-ADD*ZERO     WN0080 112       Rated Freight
     C                     Z-ADD*ZERO     WN0081  70       Invoice Number
     C                     MOVEL*BLANK    WN0082  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0083  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0084  70       Load ID
     C                     Z-ADD*ZERO     WN0085  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0086  3        Packaging Code
     C                     MOVEL*BLANK    WN0087  3        Item Market Cod
     C                     Z-ADD*ZERO     WN0088  20       Agrimetrics gro
     C                     Z-ADD*ZERO     WN0089  10       Agrimetrics pac
     C                     Z-ADD*ZERO     WN0090  20       Agrimetrics gra
     C                     MOVEL*BLANK    WN0091 30        Order Desc. Lin
     C                     Z-ADD*ZERO     WN0092 112       Actual Freight
     C                     MOVEL*BLANK    WN0093  3        Item Type Code
     C                     Z-ADD*ZERO     WN0094  30       PM R/M Type Cod
     C                     Z-ADD*ZERO     WN0095  50       PM Line Number
     C                     MOVEL*BLANK    WN0096  3        SH Unused (was
     C                     Z-ADD*ZERO     WN0097  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0098  1        Modified Flag
     C                     Z-ADD*ZERO     WN0099 112       Absorbed Freigh
     C                     Z-ADD*ZERO     WN0100 112       Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WN0101 112       Commission Amou
     C                     Z-ADD*ZERO     WN0102 112       Financials Amou
     C                     Z-ADD*ZERO     WN0103 112       Financials Amou
     C                     MOVEL*BLANK    WN0104  1        Group for Packa
     C                     MOVEL*BLANK    WN0105  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0106  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0107  3        Customer Group
     C                     MOVEL*BLANK    WN0108  3        Customer Group
     C                     Z-ADD*ZERO     WN0109  70       Order Group Cod
     C                     MOVEL*BLANK    WN0110  4        Shipping Zone C
     C                     MOVEL*BLANK    WN0111  1        Invoice Price T
     C                     Z-ADD*ZERO     WN0112 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0113 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0114  30       Req Shipping Te
     C                     Z-ADD*ZERO     WN0115  30       Actual Shipping
     C                     MOVEL*BLANK    WN0116  1        Age Code
     C                     Z-ADD*ZERO     WN0117  70       Req Delivery Da
     C                     Z-ADD*ZERO     WN0118  60       Req Delivery Ti
     C                     Z-ADD*ZERO     WN0119  70       MPC Number
     C                     MOVEL*BLANK    WN0120  3        Shipping Line
     C                     MOVEL*BLANK    WN0121 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0122 25        Port City
     C                     MOVEL*BLANK    WN0123 30        Vessel Name
     C                     MOVEL*BLANK    WN0124 12        Booking Number
     C                     Z-ADD*ZERO     WN0125 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0126  70       Claim Number
     C                     Z-ADD*ZERO     WN0127  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0128  1        Palletize
     C                     Z-ADD*ZERO     WN0129 114       Commodity Marke
     C                     Z-ADD*ZERO     WN0130 114       Market Value
     C                     Z-ADD*ZERO     WN0131 114       Default Cmdty M
     C                     Z-ADD*ZERO     WN0132 114       Raw Material Co
     C                     MOVEL*BLANK    WN0133  1        Sales Expense P
     C                     Z-ADD*ZERO     WN0134 112       Sales Expense T
     C                     MOVEL*BLANK    WN0135  1        Data Mart Proce
     C                     MOVEL*BLANK    WN0136  1        LH Load Type
     C                     MOVEL*BLANK    WN0137  2        Order TF Exempt
     C                     Z-ADD*ZERO     WN0138  70       LD Sail Date
     C                     Z-ADD*ZERO     WN0139 114       NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WN0140 112       HST Item Target
     C                     MOVEL*BLANK    WN0141  1        EDI Status 1
     C                     MOVEL*BLANK    WN0142  1        EDI Status 2
     C                     MOVEL*BLANK    WN0143  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0144  60       Job Time
     C                     MOVEL*BLANK    WN0145 10        User Id
     C                     MOVEL*BLANK    WN0146 10        Job Name
     C                     Z-ADD*ZERO     WN0147  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FHSTD2
     C                     Z-ADDF4AIC3    WDAIC3           Company Number
     C                     Z-ADDF4C4NB    WDC4NB           Order Number
     C                     Z-ADDF4DPNB    WDDPNB           Order Sequence
     C                     Z-ADDF4UENB    WDUENB           Order Secondary
      *
     C           KLCHSN    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C           KLCHSN    CHAIN@FHSTD2              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHSTPL0'MDACP
     C                     MOVEL'@FHSTD2' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHS1    YCRDCS
      * Move non-key fields to @FHSTD2
     C                     Z-ADD#1QYDT    WDHCDT           LD Arrival Date
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMHS1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FHSTD2                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHSTPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Deadline Dep D/T   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0148  30       Company Number
     C                     Z-ADD*ZERO     WN0149  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0150  1        LTL Flag
     C                     MOVEL*BLANK    WN0151  1        Load Status
     C                     Z-ADD*ZERO     WN0152  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0153 15        Seal 1
     C                     MOVEL*BLANK    WN0154 15        Seal 2
     C                     MOVEL*BLANK    WN0155 15        Seal 3
     C                     MOVEL*BLANK    WN0156 15        Seal 1 Unused
     C                     MOVEL*BLANK    WN0157 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0158  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0159 112       Flat Amount
     C                     MOVEL*BLANK    WN0160  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0161  50       Total Stops
     C                     MOVEL*BLANK    WN0162 20        Trailer Id
     C                     MOVEL*BLANK    WN0163  3        Initials of Con
     C                     Z-ADD*ZERO     WN0164  40       BOL Time
     C                     MOVEL*BLANK    WN0165  3        Carrier Code
     C                     MOVEL*BLANK    WN0166  7        Truck Size
     C                     Z-ADD*ZERO     WN0167  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0168 112       Rated Freight
     C                     MOVEL*BLANK    WN0169  1        Ship Status
     C                     MOVEL*BLANK    WN0170  1        Load Type
     C                     Z-ADD*ZERO     WN0171  50       Number Pallets
     C                     Z-ADD*ZERO     WN0172  50       Number Pallets
     C                     Z-ADD*ZERO     WN0173 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0174  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0175  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0176  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0177 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0178 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0179  70       Actual Departur
     C                     Z-ADD*ZERO     WN0180  40       Departure Time
     C                     Z-ADD*ZERO     WN0181  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0182  52       Product Tempera
     C                     Z-ADD*ZERO     WN0183  50       Number Pallets
     C                     MOVEL*BLANK    WN0184 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0185  70       Total Load Mile
     C                     MOVEL*BLANK    WN0186 12        Recorder ID
     C                     MOVEL*BLANK    WN0187  2        Shipping Method
     C                     MOVEL*BLANK    WN0188  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0189  2        Ship To State C
     C                     Z-ADD*ZERO     WN0190  70       Gross Weight
     C                     MOVEL*BLANK    WN0191  3        Carrier Broker
     C                     MOVEL*BLANK    WN0192  1        Export Status
     C                     Z-ADD*ZERO     WN0193  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0194  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0195  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0196  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0197  70       Spotted Date
     C                     Z-ADD*ZERO     WN0198  60       Spotted Time
     C                     Z-ADD*ZERO     WN0199  70       Load Finished D
     C                     Z-ADD*ZERO     WN0200  60       Load Finished T
     C                     Z-ADD*ZERO     WN0201  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0202  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0203  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0204  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0205  70       Truck Departure
     C                     Z-ADD*ZERO     WN0206  60       Truck Departure
     C                     Z-ADD*ZERO     WN0207  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0208  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0209  3        Shipping Line
     C                     MOVEL*BLANK    WN0210 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0211 30        Vessel Name
     C                     Z-ADD*ZERO     WN0212  50       Voyage
     C                     Z-ADD*ZERO     WN0213  70       Sail Date
     C                     MOVEL*BLANK    WN0214 12        Booking Number
     C                     MOVEL*BLANK    WN0215 20        Discharge Port
     C                     Z-ADD*ZERO     WN0216  70       Arrival Date
     C                     MOVEL*BLANK    WN0217 12        Container Numbe
     C                     Z-ADD*ZERO     WN0218  70       Date In
     C                     Z-ADD*ZERO     WN0219  60       Time In
     C                     Z-ADD*ZERO     WN0220  70       Date Out
     C                     Z-ADD*ZERO     WN0221  60       Time Out
     C                     Z-ADD*ZERO     WN0222 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0223  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0224  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0225  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0226  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0227  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0228  70       Requested Deliv
     C                     MOVEL*BLANK    WN0229  1        Load Acceptance
     C                     MOVEL*BLANK    WN0230  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0231  70       On Yard Date
     C                     Z-ADD*ZERO     WN0232  60       On Yard Time
     C                     MOVEL*BLANK    WN0233  1        Load Held Over
     C                     MOVEL*BLANK    WN0234  1        Load Held Over
     C                     MOVEL*BLANK    WN0235 15        Load Held Over
     C                     MOVEL*BLANK    WN0236 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0237 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0238  70       Express Mail Da
     C                     MOVEL*BLANK    WN0239  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0240  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0241  70       Product Complet
     C                     Z-ADD*ZERO     WN0242  60       Product Complet
     C                     Z-ADD*ZERO     WN0243  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0244  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0245  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0246  1        Load Confirmed
     C                     MOVEL*BLANK    WN0247 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0248  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0249  60       Load Door 1
     C                     Z-ADD*ZERO     WN0250  70       Override Total
     C                     Z-ADD*ZERO     WN0251  60       Load Door 2
     C                     MOVEL*BLANK    WN0252  1        Partial Load
     C                     MOVEL*BLANK    WN0253  1        Load Confirmati
     C                     MOVEL*BLANK    WN0254  1        Export Load USD
     C                     MOVEL*BLANK    WN0255  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0256 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0257 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0258 15        Late Billing Em
     C                     MOVEL*BLANK    WN0259 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0260 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0261  1        Multi Company L
     C                     MOVEL*BLANK    WN0262  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0263  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0264  1        LH Unused Sts 3
     C                     MOVEL*BLANK    WN0265  1        LH Unused Sts 4
     C                     MOVEL*BLANK    WN0266  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0267  2        Load U/M
     C                     MOVEL*BLANK    WN0268  2        LH Unused Sts 7
     C                     MOVEL*BLANK    WN0269  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0270  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0271  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0272  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0273  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0274  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0275  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0276  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0277  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0278  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0279  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0280  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0281  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0282  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0283  60       LH Unused Time
     C                     MOVEL*BLANK    WN0284  1        EDI Status 1
     C                     MOVEL*BLANK    WN0285  1        EDI Status 2
     C                     MOVEL*BLANK    WN0286  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0287  60       Job Time
     C                     MOVEL*BLANK    WN0288 10        User Id
     C                     MOVEL*BLANK    WN0289 10        Job Name
     C                     Z-ADD*ZERO     WN0290  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDP1RMNB    WERMNB           Load ID
      *
     C           KLCHSO    KLIST
     C                     KFLD           WERMNB           Load ID
     C           KLCHSO    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YDRDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDYL0153    WEKZDT           Deadline Depart
     C                     Z-ADDYL0154    WEAXTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * CHG Deadline Date/Time RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCRMNB    WQSP01           Load ID
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Load ID
     C                     KFLD           WCRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSP01           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSP     SETLL@FLCPBW                    *
     C           KRSSP     READE@FLCPBW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT                     *QUIT
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CHG Deadline Date/Time CH - Load Detail  * 
     C                     EXSR SQCHRC
     C           KRSSP     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * CHG Deadline Date/Time CH - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0291  50       Stop/Drop
     C                     MOVEL*BLANK    WN0292 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0293  50       Miles to next s
     C                     Z-ADD*ZERO     WN0294  72       Freight Charge
     C                     Z-ADD*ZERO     WN0295  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0296 112       Freight Misc. C
     C                     Z-ADD*ZERO     WN0297  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0298 112       Rated Freight
     C                     Z-ADD*ZERO     WN0299  30       Company Number
     C                     Z-ADD*ZERO     WN0300  70       Order Number
     C                     MOVEL*BLANK    WN0301  1        Ship Status
     C                     Z-ADD*ZERO     WN0302  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0303  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0304  70       Appointment Con
     C                     Z-ADD*ZERO     WN0305  60       Appointment Con
     C                     MOVEL*BLANK    WN0306 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0307 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0308  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0309  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0310  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0311  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0312  70       On Yard Date
     C                     Z-ADD*ZERO     WN0313  60       On Yard Time
     C                     Z-ADD*ZERO     WN0314  70       MPC Number
     C                     MOVEL*BLANK    WN0315  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0316  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0317 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0318 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0319 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0320 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0321 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0322  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0323  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0324  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0325  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0326  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0327  60       LD Unused Time
     C                     MOVEL*BLANK    WN0328  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0329  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0330  2        HPB Transload S
     C                     MOVEL*BLANK    WN0331 15        LD Unused Txt 1
     C                     MOVEL*BLANK    WN0332 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0333 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0334  1        EDI Status 1
     C                     MOVEL*BLANK    WN0335  1        EDI Status 2
     C                     MOVEL*BLANK    WN0336  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0337  60       Job Time
     C                     MOVEL*BLANK    WN0338 10        User Id
     C                     MOVEL*BLANK    WN0339 10        Job Name
     C                     Z-ADD*ZERO     WN0340  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDP1RMNB    WFRMNB           Load ID
     C                     Z-ADDWCRUNB    WFRUNB           Stop/Drop Seque
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WFRMNB           Load ID
     C                     KFLD           WFRUNB           Stop/Drop Seque
     C           KLCHSQ    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YERDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDYL0153    WFHDDT           Deadline Depart
     C                     Z-ADDYL0154    WFAUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
     C                     EXSR SRRVGN
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Upd Deadline Dte/Tme  RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSR01           Company Number
     C           *LIKE     DEFN OMC4NB    WQSR02           Order Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Order Number
      * Setup key
     C                     Z-ADDWFAIC3    WQSR01           Company Number
     C                     Z-ADDWFC4NB    WQSR02           Order Number
      * Establish starting position
     C           KRSSR     SETLL@BGWKL1                    *
     C           KRSSR     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
     C                     EXSR SSCHRC
     C           KRSSR     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Deadline Dte/Tme  CH - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0341  70       Item Code
     C                     MOVEL*BLANK    WN0342  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0343  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0344  70       Order Group Cod
     C                     MOVEL*BLANK    WN0345  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0346  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0347 112       Billing Detail
     C                     Z-ADD*ZERO     WN0348 112       Billing Detail
     C                     Z-ADD*ZERO     WN0349 112       Billing Detail
     C                     Z-ADD*ZERO     WN0350 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0351  1        Comment Print A
     C                     MOVEL*BLANK    WN0352  1        Comment Print I
     C                     MOVEL*BLANK    WN0353  1        Comment Print P
     C                     MOVEL*BLANK    WN0354  1        Comment Print S
     C                     Z-ADD*ZERO     WN0355 112       Extended Amount
     C                     Z-ADD*ZERO     WN0356  70       Market Pricing
     C                     MOVEL*BLANK    WN0357  3        Commodity Marke
     C                     MOVEL*BLANK    WN0358  3        Date Method Cod
     C                     MOVEL*BLANK    WN0359  3        Price Method Co
     C                     Z-ADD*ZERO     WN0360 114       Price Overage O
     C                     Z-ADD*ZERO     WN0361  70       Contract Number
     C                     MOVEL*BLANK    WN0362  1        Price Status
     C                     Z-ADD*ZERO     WN0363  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0364  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0365  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0366  1        Work Confirm St
     C                     MOVEL*BLANK    WN0367  1        Work Over/Short
     C                     MOVEL*BLANK    WN0368  1        OD Production P
     C                     MOVEL*BLANK    WN0369 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0370 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0371  1        Age Code
     C                     MOVEL*BLANK    WN0372  1        Palletize
     C                     MOVEL*BLANK    WN0373  1        Slip Sheet
     C                     MOVEL*BLANK    WN0374  1        Catch Weight St
     C                     MOVEL*BLANK    WN0375  1        Price Audit
     C                     MOVEL*BLANK    WN0376  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0377  1        Production Date
     C                     Z-ADD*ZERO     WN0378 112       Rated Freight
     C                     Z-ADD*ZERO     WN0379 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0380 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0381 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0382 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0383 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0384 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0385 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0386 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0387 114       Unit Price
     C                     Z-ADD*ZERO     WN0388 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0389 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0390 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0391 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0392  70       Requested Ship
     C                     Z-ADD*ZERO     WN0393  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0394  70       Actual Shipped
     C                     MOVEL*BLANK    WN0395  1        Affect Inventor
     C                     MOVEL*BLANK    WN0396  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0397  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0398  30       Item Structure
     C                     Z-ADD*ZERO     WN0399  30       Item Structure
     C                     Z-ADD*ZERO     WN0400  30       Item Structure
     C                     MOVEL*BLANK    WN0401  2        Item Level
     C                     MOVEL*BLANK    WN0402  2        Quality Level
     C                     MOVEL*BLANK    WN0403  2        Pricing Product
     C                     MOVEL*BLANK    WN0404  2        Season Product
     C                     Z-ADD*ZERO     WN0405  70       Date of Origina
     C                     MOVEL*BLANK    WN0406 10        User Profile Na
     C                     MOVEL*BLANK    WN0407  6        Country Code
     C                     MOVEL*BLANK    WN0408  2        Event Code
     C                     MOVEL*BLANK    WN0409  3        Reason Code
     C                     MOVEL*BLANK    WN0410  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0411  1        Modified Flag
     C                     MOVEL*BLANK    WN0412  1        Substituted Fla
     C                     MOVEL*BLANK    WN0413  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0414 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0415 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0416  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0417  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0418  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0419  1        Affect Commissi
     C                     MOVEL*BLANK    WN0420  1        Affect Pricing
     C                     MOVEL*BLANK    WN0421  1        Released by Use
     C                     MOVEL*BLANK    WN0422  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0423  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0424  3        Production Ware
     C                     MOVEL*BLANK    WN0425  3        OD Price Type
     C                     Z-ADD*ZERO     WN0426  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0427  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0428  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0429  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0430  60       Price Code
     C                     Z-ADD*ZERO     WN0431  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0432  60       Substitution Li
     C                     Z-ADD*ZERO     WN0433  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0434 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0435 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0436 112       OD Item Target
     C                     Z-ADD*ZERO     WN0437 112       OD Minimum Unit
     C                     Z-ADD*ZERO     WN0438 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0439 114       Order Gate Pric
     C                     Z-ADD*ZERO     WN0440 114       OD Base MKT Ovr
     C                     Z-ADD*ZERO     WN0441 114       OD Unused Prc 3
     C                     Z-ADD*ZERO     WN0442 114       OD Unused Prc 4
     C                     Z-ADD*ZERO     WN0443 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0444 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0445 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0446 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0447  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0448  1        OD UnUsed Price
     C                     MOVEL*BLANK    WN0449  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0450 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0451  40       Delv Ageing Day
     C                     Z-ADD*ZERO     WN0452  70       Production Ovr
     C                     Z-ADD*ZERO     WN0453  70       Production Ovr
     C                     MOVEL*BLANK    WN0454  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0455  2        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0456  3        OD UnUsed Statu
     C                     Z-ADD*ZERO     WN0457  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0458  70       OD UnUsed Date
     C                     Z-ADD*ZERO     WN0459  70       OD UnUsed Date
     C                     MOVEL*BLANK    WN0460  1        EDI Status 1
     C                     MOVEL*BLANK    WN0461  1        EDI Status 2
     C                     MOVEL*BLANK    WN0462  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0463  60       Job Time
     C                     MOVEL*BLANK    WN0464 10        User Id
     C                     MOVEL*BLANK    WN0465 10        Job Name
     C                     Z-ADD*ZERO     WN0466  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDOMAIC3    WGAIC3           Company Number
     C                     Z-ADDOMC4NB    WGC4NB           Order Number
     C                     Z-ADDOMDPNB    WGDPNB           Order Sequence
     C                     Z-ADDOMUENB    WGUENB           Order Secondary
      *
     C           KLCHSS    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHSS    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YFRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWFHDDT    WGNVDT           Deadline Depart
     C                     Z-ADDWFAUTM    WGBUTM           Deadline Depart
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           DRAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0467    DRAJVN           User Profile Na
      * Establish starting position
     C           KRSST     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDRI6ST    YL0158           Allow Multi-Com
     C                     MOVELDRMPNA    YL0159           Default Printer
     C                     MOVELDRBCCD    YL0157           Salesperson Cod
     C                     Z-ADDDRAIC3    YL0160           Company Number
     C                     MOVELDRBUVN    WN0468           User Code Model
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           DTAJVN           User Profile Na
     C                     KFLD           DTDNCD           Application Cod
      * Setup key
     C                     MOVELWL0183    DTAJVN           User Profile Na
     C                     MOVELWL0184    DTDNCD           Application Cod
      * Establish starting position
     C           KRSSU     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDDTAIC3    WL0185           Company Number
     C                     MOVELDTAJCD    WL0186           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSV01           Application Cod
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Application Cod
      * Setup key
     C                     MOVEL'PDTNE1'  WQSV01           Application Cod
      * Establish starting position
     C           KRSSV     SETLL@DNRESF                    *
     C           KRSSV     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SWRVGN
     C                     END                             *FI
     C           KRSSV     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSW01           Application Cod
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSW01           Application Cod
      * Establish starting position
     C           KRSSW     SETLL@DNRESF                    *
     C           KRSSW     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSW     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Change Log and Comments
      *================================================================
      * ** FP1303 LJB 01/14/2009
      * ** Recompile for changes to the OHE file
      * *****
      * ** E00207 TRANS LJB 08/12/2008
      * ** Include Override Total Load Miles. If entered, they will
      * ** take precedence. Return both Miles fields from the calc routin
      * *****
      * ** S00072 TRANS LJB 01/17/2008
      * ** Change the RTV from the Load Detail to retrieve the Load
      * ** Sequence number into the stop field on the screen. This is
      * ** because there is an internal validation routine that uses this
      * ** field and errs out if it doesn't match
      * *****
      * ** FP1251 LJB 12/12/2007
      * ** If Deadline Depart Date cannot be calculated, set the
      * ** Scheduled Delivery Date to zeros.
      * *****
      * ** FT683 12/12/2007 LJB
      * ** 1. Update/Create the OHE record with PAR.Load ID so that the
      * ** load id will be properly updated. This is because the load
      * ** may have been tied to a different load at one time and will
      * ** need to be replaced with the new one.
      * ** 2. Remove update of ship from warehouse code.
      * ** 3. Rename OHE Warehouse Code to an unused field
      * ** 4. Send error message if invalid shipping line entered
      * ** 4. Error if shipping port is wrong.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1C4NB    WK1X02  1
     C                     MOVELV1AIC3    WK1X03  1
     C           YPMTFD    IFEQ '#1RMNB'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     C           WK1X03    OREQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
      * Field '(KEY) #1RMNB' defaulted for 'Load ID'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0109' defaulted for 'Record Status'.
     C                     CALL 'PMFGSRR'              90  SEL Order Heade
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM *ZERO     WQ0003  30       Company Number
     C           #1C4NB    PARM *ZERO     WQ0004  70       Order Number
     C                     PARM #1RMNB    WQ0005  70       Load ID
     C           YL0109    PARM *BLANK    WQ0006  1        Record Status
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFGSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RMNB    IFNE *ZERO                      Load ID
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X03    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0007  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0008  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VB999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVBWB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3
     C                     Z-ADD#1C4NB    WBC4NB
     C           KLVBWB    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
     C           VB999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Load Detail
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RUNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RMNB' defaulted for 'Load ID'.
      * Field '(DTL) #1RUNB' defaulted for 'Stop/Drop Sequence Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PMFYSRR'              90  SEL for Ord Exp
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1RMNB    WQ0026  70       Load ID
     C           #1RUNB    PARM #1RUNB    WQ0027  50       Stop/Drop Seque
     C           #1AIC3    PARM *ZERO     WQ0028  30       Company Number
     C           #1C4NB    PARM *ZERO     WQ0029  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFYSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RUNB    IFNE *ZERO                      Stop/Drop Seque
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RMNB    IFEQ *ZERO                      Load ID
     C           #1RUNB    ANDEQ*ZERO                      Stop/Drop Seque
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWC    KLIST
     C                     KFLD           WCRMNB           Load ID
     C                     KFLD           WCRUNB           Stop/Drop Seque
      * Setup key
     C                     Z-ADD#1RMNB    WCRMNB
     C                     Z-ADD#1RUNB    WCRUNB
     C           KLVCWC    CHAIN@FLCPBW              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Load Detail            NF'
     C                     MOVEL'USR1192' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1192' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check restriction within
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0032  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0033  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VD999
     C                     END
     C                     END
      *................................................................
      *
     C           KLVDWB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3
     C                     Z-ADD#1C4NB    WBC4NB
     C           KLVDWB    CHAIN@BECPFK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
     C           VD999     TAG
      * Restrictor relation not satisfied
      * Send message 'Order Header TRG       NF'
     C                     MOVEL'USR0176' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     EXSR ZASNMS
     C                     MOVEL'USR0176' P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     ENDIF
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
      * USER: Exit program processing
      * ** Re-Calculate the total load miles using the updated sail port
      * ** city. Update the load header.
      * ** Total Load Miles will be zeros if any leg of the journey
      * ** is missing a Miles Between Cities record.
      * ** Include Override Total Load Miles. If entered, they will
      * ** take precedence                    E00207 08/12/2008
      * CLC Total Load Miles   XF - Load Detail  * 
     C                     CLEARPARC
     C                     Z-ADDP1RMNB    PARMNB           Load ID
      *
     C                     CALL 'PDW3XFR'              90  CLC Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Load Detai
     C           WUTLMI    PARM WUTLMI    WQ0034  70       Total Load Mile
     C           WUK2DT    PARM WUK2DT    WQ0035  70       Override Total
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW3XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Total Load Miles   XF - Load Header  * 
     C                     CALL 'PMFSXFR'              90  CHG Total Load
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0036  70       Load ID
     C                     PARM WUTLMI    WQ0037  70       Total Load Mile
     C                     PARM WUK2DT    WQ0038  70       Override Total
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFSXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * 10/15/09 PKD/RMC E00495
      * CLC Deadline Date/Time XF - Load Detail  * 
     C                     CALL 'PMP9XFR'              90  CLC Deadline Da
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0039  70       Load ID
     C           YL0153    PARM YL0153    WQ0040  70       Deadline Depart
     C           YL0154    PARM *ZERO     WQ0041  60       Deadline Depart
     C           YL0155    PARM *ZERO     WQ0042  70       Requested Deliv
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMP9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CHG Deadline Dep D/T   CH - Load Header  * 
     C                     EXSR SOCHRC
      * CHG Deadline Date/Time RT - Load Detail  * 
     C                     EXSR SPRVGN
      * CASE: PGM.*Return code is *User QUIT requested
     C           W0RTN     IFEQ 'Y2U9999'                  *IF
     C                     MOVEL'Y'       P4STYN           USR Exit Progra
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.USR Carrier Code is entered
     C           P2R6CD    IFNE *BLANK                     *IF
     C                     MOVEL##JOB     WUB2VN           Job Name CDE
      * PMT Fax Load Confirmtn PV - Load Header  * 
     C                     CALL 'POICPVR'              90  PMT Fax Load Co
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1RMNB    WQ0043  70       Load ID
     C                     PARM P3FKNB    WQ0044  30       Company Number
     C                     PARM P2R6CD    WQ0045  3        Carrier Code
     C           WUB2VN    PARM WUB2VN    WQ0046 10        Job Name CDE
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POICPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2R6CD           USR Carrier Cod
     C                     Z-ADD*ZERO     P3FKNB           USR Company Num
     C                     MOVEL*BLANK    P5XACD           Shipping Line
     C                     MOVEL*BLANK    P5OANA           Port Delv Termi
     C                     MOVEL*BLANK    P5K4TX           Vessel Name
     C                     Z-ADD*ZERO     P5VOAG           Voyage
     C                     Z-ADD*ZERO     P5KBDT           Sail Date
     C                     MOVEL*BLANK    P5NBBO           Booking Number
     C                     MOVEL*BLANK    P5W4CD           Discharge Port
     C                     MOVEL*BLANK    P5CNTN           Container Numbe
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WAGENY           OHE Voyage/Flig
     C                     Z-ADD*ZERO     WAQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WAQXDT           OHE Actual Depa
     C                     Z-ADD*ZERO     WAQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WAGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WAHEVL           OHE Unused Valu
     C                     Z-ADD*ZERO     WAHFVL           OHE Unused Valu
     C                     Z-ADD*ZERO     WAHGVL           OHE Unused Valu
     C                     Z-ADD*ZERO     WAQZDT           OHE Unused Date
     C                     Z-ADD*ZERO     WAQ0DT           OHE Unused Date
     C                     Z-ADD*ZERO     WAQ1DT           OHE Unused Date
     C                     Z-ADD*ZERO     WAQ2DT           OHE Unused Date
     C                     Z-ADD*ZERO     WAITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WAQJNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQKNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQLNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAP8NY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAP9NY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQANY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQCNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQDNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQENY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQFNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQGNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQHNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAQMNY           OHE Unused Nume
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Record Selected       USR
     C                     MOVEL*BLANK    WUZZST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WCRWNB           Miles to next s
     C                     Z-ADD*ZERO     WCRXNB           Freight Charge
     C                     Z-ADD*ZERO     WCSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WCT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WCT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WCSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WCKFDT           Appointment Con
     C                     Z-ADD*ZERO     WCACTM           Appointment Con
     C                     Z-ADD*ZERO     WCEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WCAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WCKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WCATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WCHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WCAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WCKKDT           On Yard Date
     C                     Z-ADD*ZERO     WCAVTM           On Yard Time
     C                     Z-ADD*ZERO     WCZ4NB           MPC Number
     C                     Z-ADD*ZERO     WCN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WCN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WCN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WCB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WCB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WCB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDBTC7           Parent Customer
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDORIT           Original Item
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WDBYWG           Weight Billed
     C                     Z-ADD*ZERO     WDS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WDUTVA           Standard Overag
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDR8NB           Shipping Compan
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDONVA           Actual Freight
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WDUNVA           Ledgrd Trd Fund
     C                     Z-ADD*ZERO     WDUOVA           Commission Amou
     C                     Z-ADD*ZERO     WDUPVA           Financials Amou
     C                     Z-ADD*ZERO     WDUQVA           Financials Amou
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WDIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WDNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WDBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WDZ4NB           MPC Number
     C                     Z-ADD*ZERO     WDOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WDCDPR           Market Value
     C                     Z-ADD*ZERO     WDD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WDD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WDCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WDOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WDD9PR           NonLedgrd TrdFn
     C                     Z-ADD*ZERO     WDCFVL           HST Item Target
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Total Load Miles
     C                     Z-ADD*ZERO     WUTLMI  70
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WERPNB           Total Load Orde
     C                     Z-ADD*ZERO     WEFLAM           Flat Amount
     C                     Z-ADD*ZERO     WERRNB           Total Stops
     C                     Z-ADD*ZERO     WESBNB           BOL Time
     C                     Z-ADD*ZERO     WESQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WESDNB           Number Pallets
     C                     Z-ADD*ZERO     WEPAOU           Number Pallets
     C                     Z-ADD*ZERO     WEDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WESXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WEHADT           Actual Arrival
     C                     Z-ADD*ZERO     WEAART           Actual Arrival
     C                     Z-ADD*ZERO     WEDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WEDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WEAQDT           Actual Departur
     C                     Z-ADD*ZERO     WES6NB           Departure Time
     C                     Z-ADD*ZERO     WET4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WEPRTM           Product Tempera
     C                     Z-ADD*ZERO     WENPSV           Number Pallets
     C                     Z-ADD*ZERO     WETLMI           Total Load Mile
     C                     Z-ADD*ZERO     WEGRWE           Gross Weight
     C                     Z-ADD*ZERO     WEF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WEJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WETRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WEJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WESPTM           Spotted Time
     C                     Z-ADD*ZERO     WEJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WELFTM           Load Finished T
     C                     Z-ADD*ZERO     WEJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WEBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WEJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WEBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WEKIDT           Truck Departure
     C                     Z-ADD*ZERO     WEASTM           Truck Departure
     C                     Z-ADD*ZERO     WEKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WEAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WEVOAG           Voyage
     C                     Z-ADD*ZERO     WEKBDT           Sail Date
     C                     Z-ADD*ZERO     WEEFDT           Arrival Date
     C                     Z-ADD*ZERO     WEKCDT           Date In
     C                     Z-ADD*ZERO     WETMIN           Time In
     C                     Z-ADD*ZERO     WEKDDT           Date Out
     C                     Z-ADD*ZERO     WEVMNB           Time Out
     C                     Z-ADD*ZERO     WEOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WEKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WEATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WEBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEKKDT           On Yard Date
     C                     Z-ADD*ZERO     WEAVTM           On Yard Time
     C                     Z-ADD*ZERO     WEKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WEAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WELLDT           Express Mail Da
     C                     Z-ADD*ZERO     WEK0DT           Product Complet
     C                     Z-ADD*ZERO     WEAYTM           Product Complet
     C                     Z-ADD*ZERO     WEKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WEICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WEIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WEK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WEAZTM           Load Door 1
     C                     Z-ADD*ZERO     WEK2DT           Override Total
     C                     Z-ADD*ZERO     WEA0TM           Load Door 2
     C                     Z-ADD*ZERO     WEZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WEPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WECKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WEPZDT           LH Unused Date
     C                     Z-ADD*ZERO     WECLTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP0DT           LH Unused Date
     C                     Z-ADD*ZERO     WECMTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP1DT           LH Unused Date
     C                     Z-ADD*ZERO     WECNTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WECOTM           LH Unused Time
     C                     Z-ADD*ZERO     WEP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WECQTM           LH Unused Time
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WGDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WGDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WGDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WGDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WGGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Job Name CDE
     C                     MOVEL*BLANK    WUB2VN 10
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field First Time Flag
     C                     MOVEL*BLANK    WUTAST  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003 20
     C                     MOVEL*BLANK    WL0004  3
     C                     Z-ADD*ZERO     WL0005  50
     C                     MOVEL*BLANK    WL0006  2
     C                     MOVEL*BLANK    WL0007  1
     C                     Z-ADD*ZERO     WL0008  70
     C                     Z-ADD*ZERO     WL0009  60
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  60
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  60
     C                     Z-ADD*ZERO     WL0016  70
     C                     Z-ADD*ZERO     WL0017  60
     C                     Z-ADD*ZERO     WL0018  70
     C                     Z-ADD*ZERO     WL0019  60
     C                     Z-ADD*ZERO     WL0020  70
     C                     Z-ADD*ZERO     WL0021  60
     C                     MOVEL*BLANK    WL0022  3
     C                     MOVEL*BLANK    WL0023 20
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  60
     C                     MOVEL*BLANK    WL0026  1
     C                     Z-ADD*ZERO     WL0027  70
     C                     Z-ADD*ZERO     WL0028  60
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  3
     C                     MOVEL*BLANK    WL0031  3
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  2
     C                     Z-ADD*ZERO     WL0035  70
     C                     Z-ADD*ZERO     WL0036  70
     C                     MOVEL*BLANK    WL0037 30
     C                     MOVEL*BLANK    WL0038 30
     C                     MOVEL*BLANK    WL0039 30
     C                     MOVEL*BLANK    WL0040 30
     C                     MOVEL*BLANK    WL0041 20
     C                     MOVEL*BLANK    WL0042  2
     C                     MOVEL*BLANK    WL0043 11
     C                     Z-ADD*ZERO     WL0044  70
     C                     MOVEL*BLANK    WL0045 30
     C                     MOVEL*BLANK    WL0046 30
     C                     MOVEL*BLANK    WL0047 30
     C                     MOVEL*BLANK    WL0048 30
     C                     MOVEL*BLANK    WL0049 20
     C                     MOVEL*BLANK    WL0050  2
     C                     MOVEL*BLANK    WL0051 11
     C                     MOVEL*BLANK    WL0052 15
     C                     Z-ADD*ZERO     WL0053  70
     C                     Z-ADD*ZERO     WL0054  70
     C                     Z-ADD*ZERO     WL0055  70
     C                     Z-ADD*ZERO     WL0056  70
     C                     MOVEL*BLANK    WL0057  2
     C                     MOVEL*BLANK    WL0058 40
     C                     MOVEL*BLANK    WL0059 40
     C                     MOVEL*BLANK    WL0060  3
     C                     MOVEL*BLANK    WL0061  1
     C                     MOVEL*BLANK    WL0062  1
     C                     MOVEL*BLANK    WL0063  1
     C                     MOVEL*BLANK    WL0064  1
     C                     MOVEL*BLANK    WL0065  3
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067  1
     C                     MOVEL*BLANK    WL0068  1
     C                     MOVEL*BLANK    WL0069  1
     C                     Z-ADD*ZERO     WL0070  70
     C                     MOVEL*BLANK    WL0071 10
     C                     Z-ADD*ZERO     WL0072  70
     C                     Z-ADD*ZERO     WL0073 112
     C                     Z-ADD*ZERO     WL0074 112
     C                     MOVEL*BLANK    WL0075  1
     C                     MOVEL*BLANK    WL0076  1
     C                     MOVEL*BLANK    WL0077  1
     C                     Z-ADD*ZERO     WL0078  70
     C                     Z-ADD*ZERO     WL0079  40
     C                     MOVEL*BLANK    WL0080  4
     C                     MOVEL*BLANK    WL0081 12
     C                     Z-ADD*ZERO     WL0082  70
     C                     Z-ADD*ZERO     WL0083  52
     C                     Z-ADD*ZERO     WL0084 112
     C                     MOVEL*BLANK    WL0085  1
     C                     MOVEL*BLANK    WL0086  1
     C                     MOVEL*BLANK    WL0087  1
     C                     MOVEL*BLANK    WL0088  2
     C                     MOVEL*BLANK    WL0089  1
     C                     MOVEL*BLANK    WL0090  1
     C                     MOVEL*BLANK    WL0091  1
     C                     MOVEL*BLANK    WL0092  1
     C                     MOVEL*BLANK    WL0093  1
     C                     Z-ADD*ZERO     WL0094  52
     C                     MOVEL*BLANK    WL0095  1
     C                     Z-ADD*ZERO     WL0096  70
     C                     MOVEL*BLANK    WL0097  1
     C                     MOVEL*BLANK    WL0098  1
     C                     Z-ADD*ZERO     WL0099  70
     C                     MOVEL*BLANK    WL0100 30
     C                     MOVEL*BLANK    WL0101 30
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  3
     C                     MOVEL*BLANK    WL0104  2
     C                     MOVEL*BLANK    WL0105  3
     C                     Z-ADD*ZERO     WL0106  70
     C                     MOVEL*BLANK    WL0107  3
     C                     Z-ADD*ZERO     WL0108  70
     C                     MOVEL*BLANK    WL0109  2
     C                     Z-ADD*ZERO     WL0110  70
     C                     MOVEL*BLANK    WL0111  2
     C                     MOVEL*BLANK    WL0112  1
     C                     MOVEL*BLANK    WL0113  1
     C                     Z-ADD*ZERO     WL0114 112
     C                     MOVEL*BLANK    WL0115  1
     C                     MOVEL*BLANK    WL0116  1
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
     C                     MOVEL*BLANK    WL0119  1
     C                     MOVEL*BLANK    WL0120  1
      * Define local variables for subroutine SERVGN.
     C                     MOVEL*BLANK    WL0121  3
     C                     MOVEL*BLANK    WL0122 30
     C                     MOVEL*BLANK    WL0123  1
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  50
     C                     Z-ADD*ZERO     WL0126  50
     C                     MOVEL*BLANK    WL0127 30
     C                     Z-ADD*ZERO     WL0128  50
     C                     Z-ADD*ZERO     WL0129  72
     C                     Z-ADD*ZERO     WL0130  70
     C                     Z-ADD*ZERO     WL0131 112
     C                     Z-ADD*ZERO     WL0132  72
     C                     Z-ADD*ZERO     WL0133 112
     C                     Z-ADD*ZERO     WL0134  30
     C                     Z-ADD*ZERO     WL0135  70
     C                     MOVEL*BLANK    WL0136  1
     C                     Z-ADD*ZERO     WL0137  70
     C                     Z-ADD*ZERO     WL0138  60
     C                     Z-ADD*ZERO     WL0139  70
     C                     Z-ADD*ZERO     WL0140  60
     C                     MOVEL*BLANK    WL0141 30
     C                     MOVEL*BLANK    WL0142 10
     C                     Z-ADD*ZERO     WL0143  70
     C                     Z-ADD*ZERO     WL0144  60
     C                     Z-ADD*ZERO     WL0145  70
     C                     Z-ADD*ZERO     WL0146  60
     C                     Z-ADD*ZERO     WL0147  70
     C                     Z-ADD*ZERO     WL0148  60
     C                     Z-ADD*ZERO     WL0149  70
     C                     Z-ADD*ZERO     WL0150  60
     C                     Z-ADD*ZERO     WL0151  70
     C                     MOVEL*BLANK    WL0152  1
     C                     MOVEL*BLANK    WL0153  1
     C                     MOVEL*BLANK    WL0154 15
     C                     MOVEL*BLANK    WL0155 15
     C                     MOVEL*BLANK    WL0156 15
     C                     MOVEL*BLANK    WL0157 15
     C                     MOVEL*BLANK    WL0158 15
     C                     Z-ADD*ZERO     WL0159  70
     C                     Z-ADD*ZERO     WL0160  70
     C                     Z-ADD*ZERO     WL0161  70
     C                     Z-ADD*ZERO     WL0162  60
     C                     Z-ADD*ZERO     WL0163  60
     C                     Z-ADD*ZERO     WL0164  60
     C                     MOVEL*BLANK    WL0165  1
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  2
     C                     MOVEL*BLANK    WL0168 15
     C                     MOVEL*BLANK    WL0169 25
     C                     MOVEL*BLANK    WL0170 25
     C                     MOVEL*BLANK    WL0171  1
     C                     MOVEL*BLANK    WL0172  1
     C                     MOVEL*BLANK    WL0173  1
      * Define local variables for subroutine SGRVGN.
     C                     MOVEL*BLANK    WL0174  3
     C                     MOVEL*BLANK    WL0175 20
     C                     MOVEL*BLANK    WL0176 25
     C                     MOVEL*BLANK    WL0177 25
     C                     MOVEL*BLANK    WL0178 25
     C                     MOVEL*BLANK    WL0179  2
     C                     MOVEL*BLANK    WL0180 11
     C                     Z-ADD*ZERO     WL0181 110
     C                     MOVEL*BLANK    WL0182 25
      * Define local variables for subroutine SURVGN.
     C                     MOVEL*BLANK    WL0183 10
     C                     MOVEL*BLANK    WL0184  6
     C                     Z-ADD*ZERO     WL0185  30
     C                     MOVEL*BLANK    WL0186  3
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Sequence Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Shipping Method
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field On Time - (Y/N)
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Truck Ready Date
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Truck Ready Time
     C                     Z-ADD*ZERO     YL0007  60
      * Define local work field Spotted Date
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Spotted Time
     C                     Z-ADD*ZERO     YL0009  60
      * Define local work field Load Finished Date
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Load Finished Time
     C                     Z-ADD*ZERO     YL0011  60
      * Define local work field BOL Complete Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field BOL Complete Time
     C                     Z-ADD*ZERO     YL0013  60
      * Define local work field BOL Received Date
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field BOL Received Time
     C                     Z-ADD*ZERO     YL0015  60
      * Define local work field Truck Departure Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Truck Departure Time
     C                     Z-ADD*ZERO     YL0017  60
      * Define local work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YL0019  60
      * Define local work field Shipping Line
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Port Delv Terminal
     C                     MOVEL*BLANK    YL0021 20
      * Define local work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YL0022  70
      * Define local work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YL0023  60
      * Define local work field LH Unused Sts
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field On Yard Date
     C                     Z-ADD*ZERO     YL0025  70
      * Define local work field On Yard Time
     C                     Z-ADD*ZERO     YL0026  60
      * Define local work field Load Held Over
     C                     MOVEL*BLANK    YL0027  1
      * Define local work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YL0028  3
      * Define local work field LH Held Over Reason
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field Order Type - Sales
     C                     MOVEL*BLANK    YL0030  2
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0032  70
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0033 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0034 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0035 30
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0036 11
      * Define local work field Bill to Customer
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0038 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0039 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0040 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0041 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0042 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0043  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0044 11
      * Define local work field Customer Purchase Order #
     C                     MOVEL*BLANK    YL0045 15
      * Define local work field Order Date
     C                     Z-ADD*ZERO     YL0046  70
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field Cancel Date
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Terms Code
     C                     MOVEL*BLANK    YL0049  2
      * Define local work field Special Instructions
     C                     MOVEL*BLANK    YL0050 40
      * Define local work field Special Instructions 2
     C                     MOVEL*BLANK    YL0051 40
      * Define local work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YL0054  1
      * Define local work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YL0055  1
      * Define local work field Reason Code
     C                     MOVEL*BLANK    YL0056  3
      * Define local work field Order in Use
     C                     MOVEL*BLANK    YL0057  1
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0058  1
      * Define local work field Header Status Last
     C                     MOVEL*BLANK    YL0059  1
      * Define local work field Order Type Print Status
     C                     MOVEL*BLANK    YL0060  1
      * Define local work field User Original Entry
     C                     MOVEL*BLANK    YL0061 10
      * Define local work field Date of Original Entry
     C                     Z-ADD*ZERO     YL0062  70
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0063 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0064 112
      * Define local work field Credit Hold
     C                     MOVEL*BLANK    YL0065  1
      * Define local work field Production Hold
     C                     MOVEL*BLANK    YL0066  1
      * Define local work field New Customer Hold
     C                     MOVEL*BLANK    YL0067  1
      * Define local work field Requested Delivery Time
     C                     Z-ADD*ZERO     YL0068  40
      * Define local work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YL0069  4
      * Define local work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YL0070 12
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0071  70
      * Define local work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YL0072  52
      * Define local work field Rated Freight
     C                     Z-ADD*ZERO     YL0073 112
      * Define local work field LTL Flag
     C                     MOVEL*BLANK    YL0074  1
      * Define local work field Price Audit
     C                     MOVEL*BLANK    YL0075  1
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0076  1
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0077  1
      * Define local work field Palletize
     C                     MOVEL*BLANK    YL0078  1
      * Define local work field Shrink Wrap
     C                     MOVEL*BLANK    YL0079  1
      * Define local work field Slip Sheet
     C                     MOVEL*BLANK    YL0080  1
      * Define local work field Age Code
     C                     MOVEL*BLANK    YL0081  1
      * Define local work field Reefer Temperature
     C                     Z-ADD*ZERO     YL0082  52
      * Define local work field Load Type
     C                     MOVEL*BLANK    YL0083  1
      * Define local work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YL0084  70
      * Define local work field Load Plan Order
     C                     MOVEL*BLANK    YL0085  1
      * Define local work field Print Pick Slip
     C                     MOVEL*BLANK    YL0086  1
      * Define local work field Resell Reference Number
     C                     Z-ADD*ZERO     YL0087  70
      * Define local work field Special Comment 1
     C                     MOVEL*BLANK    YL0088 30
      * Define local work field Special Comment 2
     C                     MOVEL*BLANK    YL0089 30
      * Define local work field Affect Auto Accruals
     C                     MOVEL*BLANK    YL0090  1
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0091  3
      * Define local work field Manager Level Code
     C                     MOVEL*BLANK    YL0092  2
      * Define local work field VP Level Code
     C                     MOVEL*BLANK    YL0093  3
      * Define local work field Attach to Order Number
     C                     Z-ADD*ZERO     YL0094  70
      * Define local work field Reason for Price Audit
     C                     MOVEL*BLANK    YL0095  3
      * Define local work field Invoice Number
     C                     Z-ADD*ZERO     YL0096  70
      * Define local work field Invoice Suffix
     C                     MOVEL*BLANK    YL0097  2
      * Define local work field Invoice Date
     C                     Z-ADD*ZERO     YL0098  70
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0099  2
      * Define local work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YL0100  1
      * Define local work field Modified Flag
     C                     MOVEL*BLANK    YL0101  1
      * Define local work field A/R order Value Total
     C                     Z-ADD*ZERO     YL0102 112
      * Define local work field Billing Activity Type
     C                     MOVEL*BLANK    YL0103  1
      * Define local work field Block Order Flag
     C                     MOVEL*BLANK    YL0104  1
      * Define local work field Order Certification Flag
     C                     MOVEL*BLANK    YL0105  1
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0106  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0107  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0108  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0109  1
      * Define local work field Comments for Pickup
     C                     MOVEL*BLANK    YL0110 30
      * Define local work field Miles to next stop
     C                     Z-ADD*ZERO     YL0111  50
      * Define local work field Freight Charge
     C                     Z-ADD*ZERO     YL0112  72
      * Define local work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YL0113  70
      * Define local work field Freight Misc. Charge
     C                     Z-ADD*ZERO     YL0114 112
      * Define local work field Freight Stop Charge
     C                     Z-ADD*ZERO     YL0115  72
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0116  30
      * Define local work field Estimated Arrival Date
     C                     Z-ADD*ZERO     YL0117  70
      * Define local work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YL0118  60
      * Define local work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YL0119  70
      * Define local work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YL0120  60
      * Define local work field Confirmation Made With
     C                     MOVEL*BLANK    YL0121 30
      * Define local work field Confirmation Number
     C                     MOVEL*BLANK    YL0122 10
      * Define local work field Actual Delivery Date
     C                     Z-ADD*ZERO     YL0123  70
      * Define local work field Actual Delivery time
     C                     Z-ADD*ZERO     YL0124  60
      * Define local work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YL0125  70
      * Define local work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YL0126  60
      * Define local work field MPC Number
     C                     Z-ADD*ZERO     YL0127  70
      * Define local work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YL0128  1
      * Define local work field On Time Add'l Rsn Unused
     C                     MOVEL*BLANK    YL0129  1
      * Define local work field Seal Nbr 1
     C                     MOVEL*BLANK    YL0130 15
      * Define local work field Seal Nbr 2
     C                     MOVEL*BLANK    YL0131 15
      * Define local work field Seal Nbr 3
     C                     MOVEL*BLANK    YL0132 15
      * Define local work field Seal Nbr 4
     C                     MOVEL*BLANK    YL0133 15
      * Define local work field Seal Nbr 5
     C                     MOVEL*BLANK    YL0134 15
      * Define local work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YL0135  70
      * Define local work field LD Unused Date 2
     C                     Z-ADD*ZERO     YL0136  70
      * Define local work field LD Unused Date 3
     C                     Z-ADD*ZERO     YL0137  70
      * Define local work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YL0138  60
      * Define local work field LD Unused Time 2
     C                     Z-ADD*ZERO     YL0139  60
      * Define local work field LD Unused Time 3
     C                     Z-ADD*ZERO     YL0140  60
      * Define local work field Miles Error Sts
     C                     MOVEL*BLANK    YL0141  1
      * Define local work field LD Unused Sts 2
     C                     MOVEL*BLANK    YL0142  1
      * Define local work field HPB Transload Station
     C                     MOVEL*BLANK    YL0143  2
      * Define local work field LD Unused Txt 1
     C                     MOVEL*BLANK    YL0144 15
      * Define local work field LD Unused Txt 2
     C                     MOVEL*BLANK    YL0145 25
      * Define local work field LD Unused Txt 3
     C                     MOVEL*BLANK    YL0146 25
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YN0002  70
      * Define null work field Carrier Code
     C                     MOVEL*BLANK    YN0003  3
      * Define null work field Schedule Sequence Number
     C                     Z-ADD*ZERO     YN0004  50
      * Define null work field Shipping Method
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field On Time - (Y/N)
     C                     MOVEL*BLANK    YN0006  1
      * Define null work field Truck Ready Date
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field Truck Ready Time
     C                     Z-ADD*ZERO     YN0008  60
      * Define null work field Spotted Date
     C                     Z-ADD*ZERO     YN0009  70
      * Define null work field Spotted Time
     C                     Z-ADD*ZERO     YN0010  60
      * Define null work field Load Finished Date
     C                     Z-ADD*ZERO     YN0011  70
      * Define null work field Load Finished Time
     C                     Z-ADD*ZERO     YN0012  60
      * Define null work field BOL Complete Date
     C                     Z-ADD*ZERO     YN0013  70
      * Define null work field BOL Complete Time
     C                     Z-ADD*ZERO     YN0014  60
      * Define null work field BOL Received Date
     C                     Z-ADD*ZERO     YN0015  70
      * Define null work field BOL Received Time
     C                     Z-ADD*ZERO     YN0016  60
      * Define null work field Truck Departure Date
     C                     Z-ADD*ZERO     YN0017  70
      * Define null work field Truck Departure Time
     C                     Z-ADD*ZERO     YN0018  60
      * Define null work field Adjusted Departure Date
     C                     Z-ADD*ZERO     YN0019  70
      * Define null work field Adjusted Departure Time
     C                     Z-ADD*ZERO     YN0020  60
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0021  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0022 20
      * Define null work field Scheduled Delivery Date
     C                     Z-ADD*ZERO     YN0023  70
      * Define null work field Scheduled Delivery Time
     C                     Z-ADD*ZERO     YN0024  60
      * Define null work field LH Unused Sts
     C                     MOVEL*BLANK    YN0025  1
      * Define null work field On Yard Date
     C                     Z-ADD*ZERO     YN0026  70
      * Define null work field On Yard Time
     C                     Z-ADD*ZERO     YN0027  60
      * Define null work field Load Held Over
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field LH On-Time Reason Code
     C                     MOVEL*BLANK    YN0029  3
      * Define null work field LH Held Over Reason
     C                     MOVEL*BLANK    YN0030  3
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0031  2
      * Define null work field A/R Customer Number
     C                     Z-ADD*ZERO     YN0032  70
      * Define null work field Bill to Customer
     C                     Z-ADD*ZERO     YN0033  70
      * Define null work field Bill to Name
     C                     MOVEL*BLANK    YN0034 30
      * Define null work field Bill to Address Line 1
     C                     MOVEL*BLANK    YN0035 30
      * Define null work field Bill to Address Line 2
     C                     MOVEL*BLANK    YN0036 30
      * Define null work field Bill to Address Line 3
     C                     MOVEL*BLANK    YN0037 30
      * Define null work field Bill to City
     C                     MOVEL*BLANK    YN0038 20
      * Define null work field Bill to State Code
     C                     MOVEL*BLANK    YN0039  2
      * Define null work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YN0040 11
      * Define null work field Customer Purchase Order #
     C                     MOVEL*BLANK    YN0041 15
      * Define null work field Order Date
     C                     Z-ADD*ZERO     YN0042  70
      * Define null work field Requested Ship Date
     C                     Z-ADD*ZERO     YN0043  70
      * Define null work field Cancel Date
     C                     Z-ADD*ZERO     YN0044  70
      * Define null work field Terms Code
     C                     MOVEL*BLANK    YN0045  2
      * Define null work field Comment Print Acknowledge
     C                     MOVEL*BLANK    YN0046  1
      * Define null work field Comment Print Inv/Cr.Memo
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Comment Print Pick Slip
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Comment Print Ship Doc
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0050  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0052  1
      * Define null work field Header Status Last
     C                     MOVEL*BLANK    YN0053  1
      * Define null work field Order Type Print Status
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field User Original Entry
     C                     MOVEL*BLANK    YN0055 10
      * Define null work field Date of Original Entry
     C                     Z-ADD*ZERO     YN0056  70
      * Define null work field Order Value Total
     C                     Z-ADD*ZERO     YN0057 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0058 112
      * Define null work field Credit Hold
     C                     MOVEL*BLANK    YN0059  1
      * Define null work field Production Hold
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field New Customer Hold
     C                     MOVEL*BLANK    YN0061  1
      * Define null work field Requested Delivery Time
     C                     Z-ADD*ZERO     YN0062  40
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0063  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0064 12
      * Define null work field Load ID
     C                     Z-ADD*ZERO     YN0065  70
      * Define null work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     YN0066  52
      * Define null work field Rated Freight
     C                     Z-ADD*ZERO     YN0067 112
      * Define null work field LTL Flag
     C                     MOVEL*BLANK    YN0068  1
      * Define null work field Price Audit
     C                     MOVEL*BLANK    YN0069  1
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0070  1
      * Define null work field Palletize
     C                     MOVEL*BLANK    YN0071  1
      * Define null work field Shrink Wrap
     C                     MOVEL*BLANK    YN0072  1
      * Define null work field Slip Sheet
     C                     MOVEL*BLANK    YN0073  1
      * Define null work field Age Code
     C                     MOVEL*BLANK    YN0074  1
      * Define null work field Reefer Temperature
     C                     Z-ADD*ZERO     YN0075  52
      * Define null work field Load Type
     C                     MOVEL*BLANK    YN0076  1
      * Define null work field Attach to Invoice Number
     C                     Z-ADD*ZERO     YN0077  70
      * Define null work field Load Plan Order
     C                     MOVEL*BLANK    YN0078  1
      * Define null work field Print Pick Slip
     C                     MOVEL*BLANK    YN0079  1
      * Define null work field Resell Reference Number
     C                     Z-ADD*ZERO     YN0080  70
      * Define null work field Affect Auto Accruals
     C                     MOVEL*BLANK    YN0081  1
      * Define null work field Sales Route Code
     C                     MOVEL*BLANK    YN0082  3
      * Define null work field Manager Level Code
     C                     MOVEL*BLANK    YN0083  2
      * Define null work field VP Level Code
     C                     MOVEL*BLANK    YN0084  3
      * Define null work field Attach to Order Number
     C                     Z-ADD*ZERO     YN0085  70
      * Define null work field Reason for Price Audit
     C                     MOVEL*BLANK    YN0086  3
      * Define null work field Invoice Number
     C                     Z-ADD*ZERO     YN0087  70
      * Define null work field Invoice Suffix
     C                     MOVEL*BLANK    YN0088  2
      * Define null work field Invoice Date
     C                     Z-ADD*ZERO     YN0089  70
      * Define null work field Event Code
     C                     MOVEL*BLANK    YN0090  2
      * Define null work field Trans Contol AS400/Plant
     C                     MOVEL*BLANK    YN0091  1
      * Define null work field Modified Flag
     C                     MOVEL*BLANK    YN0092  1
      * Define null work field A/R order Value Total
     C                     Z-ADD*ZERO     YN0093 112
      * Define null work field Billing Activity Type
     C                     MOVEL*BLANK    YN0094  1
      * Define null work field Block Order Flag
     C                     MOVEL*BLANK    YN0095  1
      * Define null work field Order Certification Flag
     C                     MOVEL*BLANK    YN0096  1
      * Define null work field EDI Status 1
     C                     MOVEL*BLANK    YN0097  1
      * Define null work field EDI Status 2
     C                     MOVEL*BLANK    YN0098  1
      * Define null work field EDI Status 3
     C                     MOVEL*BLANK    YN0099  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0100  1
      * Define null work field Stop/Drop
     C                     Z-ADD*ZERO     YN0101  50
      * Define null work field Comments for Pickup
     C                     MOVEL*BLANK    YN0102 30
      * Define null work field Miles to next stop
     C                     Z-ADD*ZERO     YN0103  50
      * Define null work field Freight Charge
     C                     Z-ADD*ZERO     YN0104  72
      * Define null work field Ld Hdr/Ld Dtl Unused
     C                     Z-ADD*ZERO     YN0105  70
      * Define null work field Freight Misc. Charge
     C                     Z-ADD*ZERO     YN0106 112
      * Define null work field Freight Stop Charge
     C                     Z-ADD*ZERO     YN0107  72
      * Define null work field Company Number
     C                     Z-ADD*ZERO     YN0108  30
      * Define null work field Estimated Arrival Date
     C                     Z-ADD*ZERO     YN0109  70
      * Define null work field Estimated Arrival Time
     C                     Z-ADD*ZERO     YN0110  60
      * Define null work field Appointment Confirm Date
     C                     Z-ADD*ZERO     YN0111  70
      * Define null work field Appointment Confirm Time
     C                     Z-ADD*ZERO     YN0112  60
      * Define null work field Confirmation Made With
     C                     MOVEL*BLANK    YN0113 30
      * Define null work field Confirmation Number
     C                     MOVEL*BLANK    YN0114 10
      * Define null work field Actual Delivery Date
     C                     Z-ADD*ZERO     YN0115  70
      * Define null work field Actual Delivery time
     C                     Z-ADD*ZERO     YN0116  60
      * Define null work field Deadline Depart DT    HDR
     C                     Z-ADD*ZERO     YN0117  70
      * Define null work field Deadline Depart Time  HDR
     C                     Z-ADD*ZERO     YN0118  60
      * Define null work field MPC Number
     C                     Z-ADD*ZERO     YN0119  70
      * Define null work field Load Dtl On Time Flag
     C                     MOVEL*BLANK    YN0120  1
      * Define null work field On Time Add'l Rsn Unused
     C                     MOVEL*BLANK    YN0121  1
      * Define null work field Seal Nbr 1
     C                     MOVEL*BLANK    YN0122 15
      * Define null work field Seal Nbr 2
     C                     MOVEL*BLANK    YN0123 15
      * Define null work field Seal Nbr 3
     C                     MOVEL*BLANK    YN0124 15
      * Define null work field Seal Nbr 4
     C                     MOVEL*BLANK    YN0125 15
      * Define null work field Seal Nbr 5
     C                     MOVEL*BLANK    YN0126 15
      * Define null work field LD Carrier Appt Date
     C                     Z-ADD*ZERO     YN0127  70
      * Define null work field LD Unused Date 2
     C                     Z-ADD*ZERO     YN0128  70
      * Define null work field LD Unused Date 3
     C                     Z-ADD*ZERO     YN0129  70
      * Define null work field LD Carrier Appt Time
     C                     Z-ADD*ZERO     YN0130  60
      * Define null work field LD Unused Time 2
     C                     Z-ADD*ZERO     YN0131  60
      * Define null work field LD Unused Time 3
     C                     Z-ADD*ZERO     YN0132  60
      * Define null work field Miles Error Sts
     C                     MOVEL*BLANK    YN0133  1
      * Define null work field LD Unused Sts 2
     C                     MOVEL*BLANK    YN0134  1
      * Define null work field HPB Transload Station
     C                     MOVEL*BLANK    YN0135  2
      * Define null work field LD Unused Txt 1
     C                     MOVEL*BLANK    YN0136 15
      * Define null work field LD Unused Txt 2
     C                     MOVEL*BLANK    YN0137 25
      * Define null work field LD Unused Txt 3
     C                     MOVEL*BLANK    YN0138 25
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0147 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0148 25
      * Define local work field Sail Port State
     C                     MOVEL*BLANK    YL0149  2
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0150 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0151 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0152 25
      * Define local work field Deadline Departure Date
     C                     Z-ADD*ZERO     YL0153  70
      * Define local work field Deadline Departure Time
     C                     Z-ADD*ZERO     YL0154  60
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0155  70
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0156  3
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0157  3
      * Define local work field Allow Multi-Company
     C                     MOVEL*BLANK    YL0158  1
      * Define local work field Default Printer
     C                     MOVEL*BLANK    YL0159 10
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0160  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0161  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Select initial mode
     C           @1NROP    IFEQ *ZERO
      * Add mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     ELSE
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0467 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0467           User Profile Na
      *
     C                     MOVEL*BLANK    WN0468 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR STRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0467    ZA0004           User Profile Na
     C                     MOVEL'PDTNE1'  ZA0005           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0468    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0467    WL0183    P      User Profile Na
     C                     MOVEL'PDTNE1'  WL0184    P      Application Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0185    YL0116           Company Number
     C                     MOVELWL0186    YL0161    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0468    WL0183    P      User Profile Na
     C                     MOVEL'PDTNE1'  WL0184    P      Application Cod
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0185    YL0116           Company Number
     C                     MOVELWL0186    YL0161    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0161    YL0156           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0467    ZA0006           User Profile Na
     C                     MOVEL'PDTNE1'  ZA0007           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0160    IFNE *ZERO                      *IF
     C                     Z-ADDYL0160    YL0116           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0161    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           YL0156    PARM *BLANK    WQ0047  3        Warehouse Code
     C                     PARM YL0160    WQ0048  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SVRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * KEY = PAR By name
     C                     Z-ADDP1RMNB    #1RMNB           Load ID
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1AIC3    P3FKNB           USR Company Num
     C                     MOVEL'Y'       WUTAST           First Time Flag
     C                     MOVEL'N'       P4STYN           USR Exit Progra
      * ***** Change Log and Comments
     C                     EXSR UASUBR                     ***** Change Lo
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** KEY Screen: Field position and name array
010470130301559
** W0END
010530130901561
** W0NAM
#1RMNB    V1C4NB    V1AIC3
** W1BEG
01035010520109601291013080133601352
01547015520159201608018080184801870
02059020640259202599028480310403360
03616038720412804164043840464004896
0515205381
** W1END
01041010580110301295013190133701359
01549015800159201615018370186701871
02061020930259402628028670312803389
03620038790413904175044030464704903
0518605455
** W1NAM
V1C4NB    #1RMNB    VDEIDT    #1RUNB    #DDXTX    #DQ2CD    VDAODT
#DBZNA    #DW1TX    #1CCTX    VDF9DT    #DBRTX    #DAJNA    #DEINA
V1AIC3    #DAPTX    #1XACD    #DGVTX    #1OANA    #1HBAA    #1J0T1
#1GENY    V1QWDT    #1J1T1    #1J2T1    #1HCAA    V1QXDT    V1QYDT
#1RLNA    #1RMNA
