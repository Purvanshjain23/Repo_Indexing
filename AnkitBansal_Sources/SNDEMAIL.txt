/*********************************************************************/
/*     Program: SNDEMAIL WITH COMMAND IN QCMDSRC                     */
/*       Title: SEND EMAIL VIA MESSENGERPLUS                         */
/*        Date: 02/02/01                                             */
/* Description: THIS PROGRAM CAN BE USED TO SEND AN EMAIL TO ANY     */
/*              EMAIL ADDRESS THROUGH THE MESSENGER PLUS SOFTWARE.   */
/*              USING A GENERIC PAGER.                               */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/* 2/23/06  LARA BUSER MONITOR THE ADDLIBLE COMMAND                  */
/*********************************************************************/
             PGM        PARM(&EMAIL &MSG)

/*-------------------------------------------------------------------*/
/* Declare Variables                                                 */
/*-------------------------------------------------------------------*/
             DCL  VAR(&EMAIL) TYPE(*CHAR) LEN(40)
             DCL  VAR(&MSG) TYPE(*CHAR) LEN(998)
             DCL  VAR(&EMAIL2) TYPE(*CHAR) LEN(42)

/*-------------------------------------------------------------------*/
/* MAIN PROCESSING                                                   */
/*-------------------------------------------------------------------*/
/*           CHGVAR     VAR(&EMAIL2) VALUE('"' *CAT &EMAIL *CAT '"') */
/*           UPDATE     SET((AGAPTX &EMAIL2)) SQL('from mplus/mpppg +
                          where AGA5CD="PRKEMAIL"') */

/*           SNDPGRMSG  TOPGR(PRKEMAIL) MSG(&MSG) CONFMSG(*YES) */

/*           RCVMSG     MSGQ(*PGMQ) MSGTYPE(*LAST) RMV(*NO) +
                          MSGID(&MSGID) */

/*LOOP:       IF COND(&MSGID *EQ 'BYT0055') THEN(DO) */

             ADDLIBLE   LIB(ESEND) POSITION(*LAST)
             MONMSG     MSGID(CPF0000)
             ESNDFILE   RECIPIENT(&EMAIL) SUBJECT('Order Shipped') +
                          MSG(&MSG)
/*-------------------------------------------------------------------*/
/* END PROGRAM                                                       */
/*-------------------------------------------------------------------*/
 END:        ENDPGM
