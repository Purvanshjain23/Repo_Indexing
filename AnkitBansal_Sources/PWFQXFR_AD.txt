// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWFQXFR
// ?Date: 14.08.2025 Time: 02:56:20
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Modifications and Comments
DO;

//?E10812 JJH 01/08/17 - OTC
//?- This program is intended to be used to populate the Test
//?  environments with the records in the Producer Distribution Ent
//?  PVCRREP file for each Producer.
//?- 1 set of records will be manually entered into the Producer
//?- This program may used after Refreshing Test Data, or to add
//?  additional entries during testing.
//?  Distribution Ent file for Producer SETUP.  This program will add
//?  any records for Producer SETUP for each Producer, if the record
//?  does not exist.
ENDDO;

EXECUTE FUNCTION(Cnv Prod Dist Ent     RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1342873;
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Cnv Prod Dist Ent     RT) TYPE(RTVOBJ) FILE(PVCRREP)           AB1342877;
 PARAMETER('SETUP');
 PARAMETER(DB1.PD_Producer_Code);
 {
  //?USER: Process Data record

  EXECUTE FUNCTION(Cnv Prod Dist Ent Add RT) TYPE(RTVOBJ) FILE(PVCRREP)           AB1342881;
  PARAMETER(PAR.Producer_Code_USR);
  PARAMETER(DB1.PD_Distribution_Code);
  PARAMETER(DB1.PDE_Destination);
  PARAMETER(DB1.PDE_Name);
  PARAMETER(DB1.PDE_Destination_Type);
  {
   //?USER: Processing if Data record not found

   EXECUTE FUNCTION(Crt Prdcr Distrib Ent IF) TYPE(EXCINTFUN)                      AB1329425;
   PARAMETER(PAR.PD_Producer_Code);
   PARAMETER(PAR.PD_Distribution_Code);
   PARAMETER(LCL.PDE_Sequence_Number);
   PARAMETER(PAR.PDE_Name);
   PARAMETER(PAR.PDE_Destination_Type);
   PARAMETER(PAR.PDE_Destination);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER('A');
   PARAMETER(JOB.*JOB);
   PARAMETER(JOB.*PROGRAM);
   PARAMETER(JOB.*USER);
   PARAMETER(JOB.*Job_date);
   PARAMETER(JOB.*Job_time);
   {
    //?Execute internal function

    //?Get Next PDE Sequence Number
    EXECUTE FUNCTION(Rtv Prdcr Distrib Seq RT) TYPE(RTVOBJ) FILE(PVCRREP)           AB1329426;
    PARAMETER(PAR.PD_Producer_Code);
    PARAMETER(PAR.PD_Distribution_Code);
    PARAMETER(LCL.PDE_Sequence_Number);
    {
     //?USER: Processing if Data record not found

     // PAR.PDE Sequence Number = CON.1
     PAR.PDE_Sequence_Number = 1;

     //?USER: Process Data record

     // PAR.PDE Sequence Number = DB1.PDE Sequence Number + CON.1
     PAR.PDE_Sequence_Number = DB1.PDE_Sequence_Number + 1;

     QUIT;

    }

    //?Create Producer Distribution Ent
    EXECUTE FUNCTION(Crt Prdcr Distrib Ent CR) TYPE(CRTOBJ) FILE(PVCRREP)           AB1329347;
    PARAMETER(PAR.PD_Producer_Code);
    PARAMETER(PAR.PD_Distribution_Code);
    PARAMETER(LCL.PDE_Sequence_Number);
    PARAMETER(PAR.PDE_Name);
    PARAMETER(PAR.PDE_Destination_Type);
    PARAMETER(PAR.PDE_Destination);
    PARAMETER(PAR.RS_User_Changed);
    PARAMETER(PAR.RS_Date_Changed);
    PARAMETER(PAR.RS_Time_Changed);
    PARAMETER(PAR.RS_Record_Status);
    PARAMETER(PAR.RS_Job);
    PARAMETER(PAR.RS_Program);
    PARAMETER(PAR.RS_User_Added);
    PARAMETER(PAR.RS_Date_Added);
    PARAMETER(PAR.RS_Time_Added);
    {
     //?USER: Processing before Data update

     EXECUTE FUNCTION(Rtv Add Stamp-Sys Dt  IF) TYPE(EXCINTFUN)                      AB1237005;
     PARAMETER(DB1.RS_Record_Status);
     PARAMETER(DB1.RS_Job);
     PARAMETER(DB1.RS_Program);
     PARAMETER(DB1.RS_User_Added);
     PARAMETER(DB1.RS_Date_Added);
     PARAMETER(DB1.RS_Time_Added);
     {
      //?Execute internal function

      // PAR.RS Record Status = CND.Active
      PAR.RS_Record_Status = 'A';

      // PAR.RS User Added = JOB.*USER
      PAR.RS_User_Added = JOB.*USER;

      // Call program Rtv System Date & Tim UP.
      CALL PROGRAM(Rtv System Date & Tim UP) ('PKWDUPC');
      PARAMETER(PAR.RS_Date_Added);
      PARAMETER(PAR.RS_Time_Added);

      // PAR.RS Program = JOB.*PROGRAM
      PAR.RS_Program = JOB.*PROGRAM;

      // PAR.RS Job = JOB.*JOB
      PAR.RS_Job = JOB.*JOB;

     }

    }

   }

  }

 }

}


