/*********************************************************************/
/*                                                                   */
/*  SYNOPSIS -  USE SEQUEL TO BUILD AND SEND THE SSI P/S ORDER       */
/*              COMMENTS RECORD TO THE SSI WORK FILE.                */
/*                                                                   */
/*  SYSTEM    - OMS                                                  */
/*  PROGRAM   - PMAJUPC - SEND SSI P/S ORDER COMMENTS TO             */
/*              THE SSI WORK FILE.                                   */
/*  DATE      - 10/22/2008                                           */
/*********************************************************************/
/*  USE SEQUEL'S EXECUTE COMMAND TO CONCATONATE LONG FIELDS WITH     */
/*  A '~' BETWEEN THEM AND AT THE END OF THE LAST FIELD.             */
/*  THE VIEW REQUIRES A LENGTH BE EXPLICITLY DEFINED FOR THE         */
/*  EXECUTE TO WORK PROPERLY.                                        */
/*********************************************************************/
/*  MODIFICATIONS:                                                   */
/*  08/14/2009 LJB E00461    REMOVE SUB TYPE SEQUENCE FROM THE VIEW. */
/*                                                                   */
/*********************************************************************/
 PMAJUPC:    PGM        PARM(&SEQIDA &BOLA &HDRTYPE &LINKSEQA +
                          &SUBTYPE &RETURN)

             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&SEQIDA) TYPE(*CHAR) LEN(9)
             DCL        VAR(&BOLA)   TYPE(*CHAR) LEN(7)
             DCL        VAR(&HDRTYPE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&LINKSEQA) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SUBTYPE) TYPE(*CHAR) LEN(2)
             DCL        VAR(&SUBTYPESEQ) TYPE(*CHAR) LEN(2)

             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(ERROR))

/* MATCH THE LINK SEQ IN COMMENTS TO THE SUBTYPE IN THE ORDER        */
/* SEND THE SSI PICK/STOP ORDER COMMENTS                             */
             EXECUTE    VIEW(*LIBL/PMELCPPV) OUTFILE(*LIBL/PNESCPP) +
                          MBROPT(*ADD) REPLACE(*NO) SETVAR((&SEQID +
                          &SEQIDA) (&BOL &BOLA) (&HDRTYPE &HDRTYPE) +
                          (&LINKSEQ &LINKSEQA)) UNIQUEKEY(*NONE)

/******      EXECUTE    VIEW(*LIBL/PMELCPPV) OUTFILE(*LIBL/PNESCPP) +
                          MBROPT(*ADD) REPLACE(*NO) SETVAR((&SEQID +
                          &SEQIDA) (&BOL &BOLA) (&HDRTYPE &HDRTYPE) +
                          (&LINKSEQ &LINKSEQA) (&SUBTYPE &SUBTYPE) +
                        (&SUBTYPESEQ &SUBTYPESEQ)) UNIQUEKEY(*NONE)**/

             GOTO       CMDLBL(END)

 ERROR:      CHGVAR     VAR(&RETURN) VALUE('Y2U0032')

 END:        ENDPGM
/*********************************************************************/
