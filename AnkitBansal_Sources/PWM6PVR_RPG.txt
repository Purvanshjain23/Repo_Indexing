     H/TITLE Dlt Tattoo Repay Dtl  PV  Prompt & validate record
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Prompt & validate record
     H* Object type   : *PGM
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 06/28/21  Time  : 10:15:59
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0  IF   E           K DISK
      * Values list details file
      *
     FPWM6PVR#  CF   E             WORKSTN
     F                                     INFDS(INFDS#)
      * DSP: Dlt Tattoo Repay Dtl  PV  Prompt & validate record
      *
     FPWAYCPL3  IF   E           K DISK
      * RSQ : Tattoo Repayment Comment  Co#/Repay ID/Seq# (d)
      *
     FPWAWCPL0  IF   E           K DISK
      * RTV : Tattoo Repayment Header   Retrieval index
      *
     FPKA1CPL0  IF   E           K DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPLATREL1  IF   E           K DISK
      * RTV : Producer Site             Retrieval index
      *
     FPKAAREL0  IF   E           K DISK
      * RTV : Source                    Retrieval index
      *
     FPKAFREL0  IF   E           K DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKAQCPL0  IF   E           K DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPWAXCPL0  UF   E           K DISK
      * UPD : Tattoo Repayment Detail   Update index
      *
     FPWAYCPL0  IF A E           K DISK
      * UPD : Tattoo Repayment Comment  Update index
      *
      * Long constants
     D @CN#            S              6    DIM(08)CTDATA PERRCD(1)
     D @CN             S             25    DIM(08) ALT(@CN#)
      * Set wdw location allowed?
     D YSL             S              1     DIM(1)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
     D QPWAX1        E DS                  EXTNAME(PWAXCPL0)
      * UPD : Tattoo Repayment Detail   Update index
      * Renamed input format fields
     D  WAHONB       E                     EXTFLD(AXHONB)
     D  WACDNZ       E                     EXTFLD(AXCDNZ)
     D  WAHMNB       E                     EXTFLD(AXHMNB)
     D  WABNNB       E                     EXTFLD(AXBNNB)
     D  WABONB       E                     EXTFLD(AXBONB)
     D  WACVNB       E                     EXTFLD(AXCVNB)
     D  WAB0DT       E                     EXTFLD(AXB0DT)
     D  WACGNZ       E                     EXTFLD(AXCGNZ)
     D  WACENZ       E                     EXTFLD(AXCENZ)
     D  WACFNZ       E                     EXTFLD(AXCFNZ)
     D  WAIIDT       E                     EXTFLD(AXIIDT)
     D  WATOCD       E                     EXTFLD(AXTOCD)
     D  WATPCD       E                     EXTFLD(AXTPCD)
     D  WAINT1       E                     EXTFLD(AXINT1)
     D  WAMCSS       E                     EXTFLD(AXMCSS)
     D  WAC1NZ       E                     EXTFLD(AXC1NZ)
     D  WAMZSS       E                     EXTFLD(AXMZSS)
     D  WATNCD       E                     EXTFLD(AXTNCD)
     D  WAABCD       E                     EXTFLD(AXABCD)
     D  WANYCD       E                     EXTFLD(AXNYCD)
     D  WANASS       E                     EXTFLD(AXNASS)
     D  WAAACD       E                     EXTFLD(AXAACD)
     D  WAAECD       E                     EXTFLD(AXAECD)
     D  WAAKCD       E                     EXTFLD(AXAKCD)
     D  WAALCD       E                     EXTFLD(AXALCD)
     D  WAAAVN       E                     EXTFLD(AXAAVN)
     D  WAAADT       E                     EXTFLD(AXAADT)
     D  WAAMTM       E                     EXTFLD(AXAMTM)
     D  WAAJST       E                     EXTFLD(AXAJST)
     D  WAAHVN       E                     EXTFLD(AXAHVN)
     D  WAAGVN       E                     EXTFLD(AXAGVN)
     D  WAABVN       E                     EXTFLD(AXABVN)
     D  WAABDT       E                     EXTFLD(AXABDT)
     D  WAABTM       E                     EXTFLD(AXABTM)
      *
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QPWAY1        E DS                  EXTNAME(PWAYCPL0)
      * UPD : Tattoo Repayment Comment  Update index
      * Renamed input format fields
     D  WBHONB       E                     EXTFLD(AYHONB)
     D  WBCDNZ       E                     EXTFLD(AYCDNZ)
     D  WBCINZ       E                     EXTFLD(AYCINZ)
     D  WBHMNB       E                     EXTFLD(AYHMNB)
     D  WBBNNB       E                     EXTFLD(AYBNNB)
     D  WBBONB       E                     EXTFLD(AYBONB)
     D  WBCVNB       E                     EXTFLD(AYCVNB)
     D  WBB0DT       E                     EXTFLD(AYB0DT)
     D  WBG7T1       E                     EXTFLD(AYG7T1)
     D  WBMKSS       E                     EXTFLD(AYMKSS)
     D  WBAAVN       E                     EXTFLD(AYAAVN)
     D  WBAADT       E                     EXTFLD(AYAADT)
     D  WBAMTM       E                     EXTFLD(AYAMTM)
     D  WBAJST       E                     EXTFLD(AYAJST)
     D  WBAHVN       E                     EXTFLD(AYAHVN)
     D  WBAGVN       E                     EXTFLD(AYAGVN)
     D  WBABVN       E                     EXTFLD(AYABVN)
     D  WBABDT       E                     EXTFLD(AYABDT)
     D  WBABTM       E                     EXTFLD(AYABTM)
      *
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XDEX            DS
      * External date
     D  XDEXDT                 1      8  0
     D  XDEY01                 1      4  0
     D  XDEX01                 1      2  0
     D  XDEX02                 3      4  0
     D  XDEY02                 5      8  0
     D  XDEX03                 5      6  0
     D  XDEX04                 7      8  0
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              3  0
     D  WP0002         S              5  0
     D  WP0003         S              3  0
     D  WP0004         S              7  0
     D  WP0005         S              5  0
     D  WP0006         S              5  0
     D  WP0007         S              7  0
     D  WP0008         S              1
     D  WP0009         S              5  0
     D  WP0010         S              6
     D  WP0011         S             10
     D  WP0012         S              3
     D  WP0013         S              6
     D  WP0014         S              5
     D  WP0015         S              5
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YWLCTP         S              1
     D  YWRTFN         S             10
     D  YWWDWD         S              3  0
     D  YWWDDP         S              3  0
     D  YWWDCR         S              5
     D  YWWDRW         S              3  0
     D  YWWDCL         S              3  0
     D  W0TRN          S              1
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  YWPNNO         S              1  0
     D  W0WASM         S              1  0
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  YWPORW         S              3  0
     D  YWPOC1         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0DCF          S              1
     D  YL0001         S              7
     D  YL0002         S              5
     D  YL0003         S              5
     D  YL0004         S             60
     D  ZQ             S              5  0
     D  WN0001         S              5  0
     D  WN0002         S             10
     D  WN0003         S              7  0
     D  WN0004         S              6  0
     D  WN0005         S              1
     D  WN0006         S             10
     D  WN0007         S             10
     D  WN0008         S             10
     D  WN0009         S              7  0
     D  WN0010         S              6  0
     D  WQSC01         S                   LIKE(WCHONB)
     D  WQSC02         S                   LIKE(WCCDNZ)
     D  ZADFMF         S             10
     D  WQ0001         S              3  0
     D  WQ0002         S              5  0
     D  WQ0003         S              7  0
     D  W0CLPG         S             10
     D  WK1X01         S              1
     D  WK1X02         S              1
     D  WQ0004         S              6
     D  WQ0005         S             10
     D  WQ0006         S             40
     D  WQ0007         S              3
     D  WQ0008         S              6
     D  WQ0009         S              6
     D  WQ0010         S              5
     D  WQ0011         S              5
     D  WQ0012         S              6
     D  WQ0013         S              6
     D  WN30           S             30
     D  W0NSRQ         S              1
     D  Y2LSNO         S              7  0
     D  W0EXVL         S             25
     D  XDDTFM         S              3
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  W0GRP          S              1
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  ZWORK          S              5  0
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  @1FFL          S             10
     D  @1FLB          S             10
     D  @1FMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * FLD: Tattoo Repayment Detail
      * I :  CC Company Number
     D  P1HONB                 1      2P 0
      * I :  TRH Repayment ID
     D  P1CDNZ                 3      5P 0
      * I :  BOH Company Number
     D  P1HMNB                 6      7P 0
      * I :  BOH Buy Order Number
     D  P1BNNB                 8     11P 0
      * I :  BOL Load Number
     D  P1BONB                12     14P 0
      * I :  TH Tattoo Number
     D  P1CVNB                15     17P 0
      * I :  TH Kill Date
     D  P1B0DT                18     21P 0
      * I :  TRD Repayment Status
     D  P1MCSS                22     22
      * I :  TRD Pen Head
     D  P1C1NZ                23     25P 0
      * I :  PD Producer Code
     D  P1ABCD                26     31
      * I :  PS Site ID
     D  P1NYCD                32     41
      * I :  SR Source Code
     D  P1AACD                42     44
      * I :  PL Location Code
     D  P1AECD                45     50
      * I :  PC Contract Code
     D  P1AKCD                51     55
      * I :  PSC Sub-Contract Code
     D  P1ALCD                56     60
     D                 DS
     D  ZAMSDA                 1    132
     I@AXCPAW
      * Tattoo Repayment Detail   Update index
      * Renamed input format fields
     I              AXHONB                      WAHONB
     I              AXCDNZ                      WACDNZ
     I              AXHMNB                      WAHMNB
     I              AXBNNB                      WABNNB
     I              AXBONB                      WABONB
     I              AXCVNB                      WACVNB
     I              AXB0DT                      WAB0DT
     I              AXCGNZ                      WACGNZ
     I              AXCENZ                      WACENZ
     I              AXCFNZ                      WACFNZ
     I              AXIIDT                      WAIIDT
     I              AXTOCD                      WATOCD
     I              AXTPCD                      WATPCD
     I              AXINT1                      WAINT1
     I              AXMCSS                      WAMCSS
     I              AXC1NZ                      WAC1NZ
     I              AXMZSS                      WAMZSS
     I              AXTNCD                      WATNCD
     I              AXABCD                      WAABCD
     I              AXNYCD                      WANYCD
     I              AXNASS                      WANASS
     I              AXAACD                      WAAACD
     I              AXAECD                      WAAECD
     I              AXAKCD                      WAAKCD
     I              AXALCD                      WAALCD
     I              AXAAVN                      WAAAVN
     I              AXAADT                      WAAADT
     I              AXAMTM                      WAAMTM
     I              AXAJST                      WAAJST
     I              AXAHVN                      WAAHVN
     I              AXAGVN                      WAAGVN
     I              AXABVN                      WAABVN
     I              AXABDT                      WAABDT
     I              AXABTM                      WAABTM
      *
     I@AYCPAP
      * Tattoo Repayment Comment  Update index
      * Renamed input format fields
     I              AYHONB                      WBHONB
     I              AYCDNZ                      WBCDNZ
     I              AYCINZ                      WBCINZ
     I              AYHMNB                      WBHMNB
     I              AYBNNB                      WBBNNB
     I              AYBONB                      WBBONB
     I              AYCVNB                      WBCVNB
     I              AYB0DT                      WBB0DT
     I              AYG7T1                      WBG7T1
     I              AYMKSS                      WBMKSS
     I              AYAAVN                      WBAAVN
     I              AYAADT                      WBAADT
     I              AYAMTM                      WBAMTM
     I              AYAJST                      WBAJST
     I              AYAHVN                      WBAHVN
     I              AYAGVN                      WBAGVN
     I              AYABVN                      WBABVN
     I              AYABDT                      WBABDT
     I              AYABTM                      WBABTM
      *
     I@AYCPA6
      * Tattoo Repayment Comment  Co#/Repay ID/Seq# (d)
      * Renamed input format fields
     I              AYHONB                      WCHONB
     I              AYCDNZ                      WCCDNZ
     I              AYCINZ                      WCCINZ
     I              AYHMNB                      WCHMNB
     I              AYBNNB                      WCBNNB
     I              AYBONB                      WCBONB
     I              AYCVNB                      WCCVNB
     I              AYB0DT                      WCB0DT
     I              AYG7T1                      WCG7T1
     I              AYMKSS                      WCMKSS
     I              AYAAVN                      WCAAVN
     I              AYAADT                      WCAADT
     I              AYAMTM                      WCAMTM
     I              AYAJST                      WCAJST
     I              AYAHVN                      WCAHVN
     I              AYAGVN                      WCAGVN
     I              AYABVN                      WCABVN
     I              AYABDT                      WCABDT
     I              AYABTM                      WCABTM
      *
     I@AWCPAQ
      * Tattoo Repayment Header   Retrieval index
      * Renamed input format fields
     I              AWHONB                      WDHONB
     I              AWCDNZ                      WDCDNZ
     I              AWMASS                      WDMASS
     I              AWIDDT                      WDIDDT
     I              AWCATM                      WDCATM
     I              AWIEDT                      WDIEDT
     I              AWCBTM                      WDCBTM
     I              AWIFDT                      WDIFDT
     I              AWCTNZ                      WDCTNZ
     I              AWHOT1                      WDHOT1
     I              AWAAVN                      WDAAVN
     I              AWAADT                      WDAADT
     I              AWAMTM                      WDAMTM
     I              AWAJST                      WDAJST
     I              AWAHVN                      WDAHVN
     I              AWAGVN                      WDAGVN
     I              AWABVN                      WDABVN
     I              AWABDT                      WDABDT
     I              AWABTM                      WDABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                      WEHMNB
     I              A1BNNB                      WEBNNB
     I              A1BONB                      WEBONB
     I              A1CVNB                      WECVNB
     I              A1B0DT                      WEB0DT
     I              A1AWDT                      WEAWDT
     I              A1BICD                      WEBICD
     I              A1CPST                      WECPST
     I              A1ACPR                      WEACPR
     I              A1B9PR                      WEB9PR
     I              A1CAPR                      WECAPR
     I              A1C4ST                      WEC4ST
     I              A1AIPR                      WEAIPR
     I              A1A6DT                      WEA6DT
     I              A1C2ST                      WEC2ST
     I              A1CXNB                      WECXNB
     I              A1CWNB                      WECWNB
     I              A1FCNB                      WEFCNB
     I              A1H9NB                      WEH9NB
     I              A1FDNB                      WEFDNB
     I              A1FENB                      WEFENB
     I              A1HENB                      WEHENB
     I              A1HFNB                      WEHFNB
     I              A1CYNB                      WECYNB
     I              A1LRNB                      WELRNB
     I              A1E0NB                      WEE0NB
     I              A1A5PC                      WEA5PC
     I              A1FBNB                      WEFBNB
     I              A1A4PC                      WEA4PC
     I              A1F7NB                      WEF7NB
     I              A1HDNB                      WEHDNB
     I              A1F5NB                      WEF5NB
     I              A1F4NB                      WEF4NB
     I              A1F3NB                      WEF3NB
     I              A1F2NB                      WEF2NB
     I              A1AVPC                      WEAVPC
     I              A1AWPC                      WEAWPC
     I              A1CWPC                      WECWPC
     I              A1A8PC                      WEA8PC
     I              A1A7PC                      WEA7PC
     I              A1B8PR                      WEB8PR
     I              A1AMPR                      WEAMPR
     I              A1ANPR                      WEANPR
     I              A1AYVA                      WEAYVA
     I              A1AWVA                      WEAWVA
     I              A1AOPR                      WEAOPR
     I              A1AXVA                      WEAXVA
     I              A1APPR                      WEAPPR
     I              A1ASPR                      WEASPR
     I              A1A4VA                      WEA4VA
     I              A1ATPR                      WEATPR
     I              A1A5VA                      WEA5VA
     I              A1CBPR                      WECBPR
     I              A1CCPR                      WECCPR
     I              A1LPNB                      WELPNB
     I              A1CDPR                      WECDPR
     I              A1A7VA                      WEA7VA
     I              A1A2PR                      WEA2PR
     I              A1JWST                      WEJWST
     I              A1CWST                      WECWST
     I              A1D7ST                      WED7ST
     I              A1D8ST                      WED8ST
     I              A1DWST                      WEDWST
     I              A1D6ST                      WED6ST
     I              A1GHNB                      WEGHNB
     I              A1BYDT                      WEBYDT
     I              A1E0ST                      WEE0ST
     I              A1E1ST                      WEE1ST
     I              A1E2ST                      WEE2ST
     I              A1BSDT                      WEBSDT
     I              A1BTDT                      WEBTDT
     I              A1BUDT                      WEBUDT
     I              A1HGNB                      WEHGNB
     I              A1HHNB                      WEHHNB
     I              A1HINB                      WEHINB
     I              A1A3PR                      WEA3PR
     I              A1A4PR                      WEA4PR
     I              A1A6PR                      WEA6PR
     I              A1J9NB                      WEJ9NB
     I              A1D6PR                      WED6PR
     I              A1D7PR                      WED7PR
     I              A1D8PR                      WED8PR
     I              A1D9PR                      WED9PR
     I              A1EAPR                      WEEAPR
     I              A1EBPR                      WEEBPR
     I              A1ECPR                      WEECPR
     I              A1EDPR                      WEEDPR
     I              A1EEPR                      WEEEPR
     I              A1EFPR                      WEEFPR
     I              A1EGPR                      WEEGPR
     I              A1EHPR                      WEEHPR
     I              A1KAST                      WEKAST
     I              A1J7ST                      WEJ7ST
     I              A1J9ST                      WEJ9ST
     I              A1OXNB                      WEOXNB
     I              A1LKST                      WELKST
     I              A1LLST                      WELLST
     I              A1J8ST                      WEJ8ST
     I              A1LIST                      WELIST
     I              A1LJST                      WELJST
     I              A1NZTX                      WENZTX
     I              A1HJCD                      WEHJCD
     I              A1R4ST                      WER4ST
     I              A1R5ST                      WER5ST
     I              A1R6ST                      WER6ST
     I              A1R7ST                      WER7ST
     I              A1THWT                      WETHWT
     I              A1T2WT                      WET2WT
     I              A1THHD                      WETHHD
     I              A1T2HD                      WET2HD
     I              A1OBPR                      WEOBPR
     I              A1KOER                      WEKOER
     I              A1OPIR                      WEOPIR
     I              A1OPEM                      WEOPEM
     I              A1IORP                      WEIORP
     I              A1OWEO                      WEOWEO
     I              A1OQET                      WEOQET
     I              A1URST                      WEURST
     I              A1USST                      WEUSST
     I              A1HHPC                      WEHHPC
     I              A1S9PR                      WES9PR
     I              A1TAPR                      WETAPR
     I              A1TBPR                      WETBPR
     I              A1JFUR                      WEJFUR
     I              A1KRIF                      WEKRIF
     I              A1KORF                      WEKORF
     I              A1KAPR                      WEKAPR
     I              A1KROT                      WEKROT
     I              A1OTJG                      WEOTJG
     I              A1IRJG                      WEIRJG
     I              A1IMJF                      WEIMJF
     I              A1IRGF                      WEIRGF
     I              A1KRJF                      WEKRJF
     I              A1OJRF                      WEOJRF
     I              A1KFOR                      WEKFOR
     I              A1ORJK                      WEORJK
     I              A1OMVJ                      WEOMVJ
     I              A1MVNF                      WEMVNF
     I              A1MCNF                      WEMCNF
     I              A1NCNF                      WENCNF
     I              A1NCHF                      WENCHF
     I              A1IGIR                      WEIGIR
     I              A1KFJR                      WEKFJR
     I              A1EADT                      WEEADT
     I              A1EBDT                      WEEBDT
     I              A1ECDT                      WEECDT
     I              A1EDDT                      WEEDDT
     I              A1EEDT                      WEEEDT
     I              A1U4ST                      WEU4ST
     I              A1U5ST                      WEU5ST
     I              A1U6ST                      WEU6ST
     I              A1U7ST                      WEU7ST
     I              A1U8ST                      WEU8ST
     I              A1U9ST                      WEU9ST
     I              A1VAST                      WEVAST
     I              A1VBST                      WEVBST
     I              A1BDCD                      WEBDCD
     I              A1CSCD                      WECSCD
     I              A1ABCD                      WEABCD
     I              A1AECD                      WEAECD
     I              A1ACCD                      WEACCD
     I              A1AGCD                      WEAGCD
     I              A1BECD                      WEBECD
     I              A1AAVN                      WEAAVN
     I              A1AADT                      WEAADT
     I              A1AMTM                      WEAMTM
     I              A1AJST                      WEAJST
     I              A1AHVN                      WEAHVN
     I              A1AGVN                      WEAGVN
     I              A1ABVN                      WEABVN
     I              A1ABDT                      WEABDT
     I              A1ABTM                      WEABTM
      *
     I@ATRELM
      * Producer Site             Retrieval index
      * Renamed input format fields
     I              ATABCD                      WFABCD
     I              ATNYCD                      WFNYCD
     I              ATTETX                      WFTETX
     I              ATTZTX                      WFTZTX
     I              ATT0TX                      WFT0TX
     I              ATT1TX                      WFT1TX
     I              ATT2TX                      WFT2TX
     I              ATT3TX                      WFT3TX
     I              ATTWTX                      WFTWTX
     I              ATTXTX                      WFTXTX
     I              ATMDA1                      WFMDA1
     I              ATMEA1                      WFMEA1
     I              ATTYTX                      WFTYTX
     I              ATAXSS                      WFAXSS
     I              ATAYSS                      WFAYSS
     I              ATAZSS                      WFAZSS
     I              ATMFA1                      WFMFA1
     I              ATT4TX                      WFT4TX
     I              ATT5TX                      WFT5TX
     I              ATBGT1                      WFBGT1
     I              ATAAVN                      WFAAVN
     I              ATAADT                      WFAADT
     I              ATAMTM                      WFAMTM
     I              ATAJST                      WFAJST
     I              ATAHVN                      WFAHVN
     I              ATAGVN                      WFAGVN
     I              ATABVN                      WFABVN
     I              ATABDT                      WFABDT
     I              ATABTM                      WFABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                      WGAACD
     I              AAAFTX                      WGAFTX
     I              AAIXST                      WGIXST
     I              AACYSS                      WGCYSS
     I              AACZSS                      WGCZSS
     I              AAC0SS                      WGC0SS
     I              AAC1SS                      WGC1SS
     I              AAAAVN                      WGAAVN
     I              AAAADT                      WGAADT
     I              AAAMTM                      WGAMTM
     I              AAAJST                      WGAJST
     I              AAAHVN                      WGAHVN
     I              AAAGVN                      WGAGVN
     I              AAABVN                      WGABVN
     I              AAABDT                      WGABDT
     I              AAABTM                      WGABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                      WHABCD
     I              AFAECD                      WHAECD
     I              AFA8TX                      WHA8TX
     I              AFGLNB                      WHGLNB
     I              AFATST                      WHATST
     I              AFASNB                      WHASNB
     I              AFAUST                      WHAUST
     I              AFQNST                      WHQNST
     I              AFQOST                      WHQOST
     I              AFQPST                      WHQPST
     I              AFQQST                      WHQQST
     I              AFQRST                      WHQRST
     I              AFN0TX                      WHN0TX
     I              AFQSST                      WHQSST
     I              AFQTST                      WHQTST
     I              AFQUST                      WHQUST
     I              AFQVST                      WHQVST
     I              AFR8ST                      WHR8ST
     I              AFR9ST                      WHR9ST
     I              AFSAST                      WHSAST
     I              AFSBST                      WHSBST
     I              AFSDST                      WHSDST
     I              AFSEST                      WHSEST
     I              AFSFST                      WHSFST
     I              AFHWNB                      WHHWNB
     I              AFFUCD                      WHFUCD
     I              AFAAVN                      WHAAVN
     I              AFAADT                      WHAADT
     I              AFAMTM                      WHAMTM
     I              AFAJST                      WHAJST
     I              AFAHVN                      WHAHVN
     I              AFAGVN                      WHAGVN
     I              AFABVN                      WHABVN
     I              AFABDT                      WHABDT
     I              AFABTM                      WHABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                      WIAKCD
     I              AQALCD                      WIALCD
     I              AQAHDT                      WIAHDT
     I              AQA2ST                      WIA2ST
     I              AQAZPR                      WIAZPR
     I              AQA0PR                      WIA0PR
     I              AQA9PC                      WIA9PC
     I              AQA7PR                      WIA7PR
     I              AQA8PR                      WIA8PR
     I              AQF3ST                      WIF3ST
     I              AQA9PR                      WIA9PR
     I              AQERCD                      WIERCD
     I              AQESCD                      WIESCD
     I              AQF6PR                      WIF6PR
     I              AQJ3TX                      WIJ3TX
     I              AQABCD                      WIABCD
     I              AQAECD                      WIAECD
     I              AQAGCD                      WIAGCD
     I              AQAICD                      WIAICD
     I              AQAMCD                      WIAMCD
     I              AQAAVN                      WIAAVN
     I              AQAADT                      WIAADT
     I              AQAMTM                      WIAMTM
     I              AQAJST                      WIAJST
     I              AQAHVN                      WIAHVN
     I              AQAGVN                      WIAGVN
     I              AQABVN                      WIABVN
     I              AQABDT                      WIABDT
     I              AQABTM                      WIABTM
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1HONB        PARM                    WP0001                         CC Company Numb
     C     P1CDNZ        PARM                    WP0002                         TRH Repayment I
     C     P1HMNB        PARM                    WP0003                         BOH Company Num
     C     P1BNNB        PARM                    WP0004                         BOH Buy Order N
     C     P1BONB        PARM                    WP0005                         BOL Load Number
     C     P1CVNB        PARM                    WP0006                         TH Tattoo Numbe
     C     P1B0DT        PARM                    WP0007                         TH Kill Date
     C     P1MCSS        PARM                    WP0008                         TRD Repayment S
     C     P1C1NZ        PARM                    WP0009                         TRD Pen Head
     C     P1ABCD        PARM                    WP0010                         PD Producer Cod
     C     P1NYCD        PARM                    WP0011                         PS Site ID
     C     P1AACD        PARM                    WP0012                         SR Source Code
     C     P1AECD        PARM                    WP0013                         PL Location Cod
     C     P1AKCD        PARM                    WP0014                         PC Contract Cod
     C     P1ALCD        PARM                    WP0015                         PSC Sub-Contrac
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Conduct screen conversation
     C                   DO        *HIVAL
      * Start new transaction
     C                   MOVEL     'Y'           W0TRN
      * Process current transaction
      * Convert fields to external form
     C                   DOW       W0TRN = 'Y'
     C                   EXSR      MNCV#1
      * Display screen
     C                   EXSR      CAEXFM
      * Process response
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * HOME: Reset screen fields
     C   30              CAS                     MALDSC
      * Reposition window
     C   26              CAS                     ZRRPWD
      * Process screen input
     C                   CAS                     DAPRSC
     C                   END
      *
     C                   END
      *
     C                   END
      *****************************************************************
      /EJECT
     CSR   CAEXFM        BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                   TIME                    ##TME
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * Enable PUTOVR
     C                   SETON                                        86
     C                   Z-ADD     1             YWPNNO                         Panel number
     C                   MOVEL     'R'           YWLCTP                         Locate action t
     C                   EXSR      ZSSTLC                                       Set window loca
     C                   Z-ADD     1             W0WASM
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #RCDDTL1
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DAPRSC        BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
      * Validate screen input
     C                   EXSR      DBVLSC
      * If error, exit
     C     *IN99         CABEQ     '1'           DAEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           DAEXIT
      * Prompt for confirmation
     C                   EXSR      DHPMCF
      * Quit if not confirmed
     C     *IN99         CABEQ     '1'           DAEXIT
      * USER: User defined action
      * Dlt Tattoo Repay Dtl  DO - Tattoo Repayment Detail  * 
     C                   EXSR      SADLRC
      * Create a system comment
      * CASE: *OTHERWISE
     C                   EVAL      YL0001 = ' '                                 Buy Order Numbe
     C                   MOVEL     #1BNNB        YL0001                         Buy Order Numbe
     C                   EVAL      YL0002 = ' '                                 Load Number Alp
     C                   MOVEL     #1BONB        YL0002                         Load Number Alp
     C                   EVAL      YL0003 = ' '                                 Tattoo Number A
     C                   MOVEL     #1CVNB        YL0003                         Tattoo Number A
     C                   Z-ADD     1             ZQ
     C     @CN(001)      CAT(P)    YL0001:ZQ     YL0004                         TRC Comment
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    @CN(002):ZQ   YL0004                         TRC Comment
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0002:ZQ     YL0004                         TRC Comment
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    @CN(003):ZQ   YL0004                         TRC Comment
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    YL0003:ZQ     YL0004                         TRC Comment
     C                   Z-ADD     1             ZQ
     C     YL0004        CAT(P)    @CN(004):ZQ   YL0004                         TRC Comment
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
     C                   EXSR      SBCRRC
      * Exit program
     C                   EXSR      ZXEXPG
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   DBVLSC        BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Bypass ref file checks if error already detected
     C   99              GOTO      DBEXIT
      * Check reference to Tattoo Repayment Header
     C                   EXSR      VACKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Tattoo Header
     C                   EXSR      VBCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Producer Site
     C                   EXSR      VCCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Source
     C                   EXSR      VDCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Producer Location
     C                   EXSR      VECKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      * Check reference to Producer Sub-Contract
     C                   EXSR      VFCKRL
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   SETON                                        99        *
     C                   END
      *================================================================
     CSR   DBEXIT        ENDSR
      /EJECT
     CSR   DHPMCF        BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                   EXSR      MNCV#1
      * Update screen time
     C                   TIME                    ##TME
      * Enable PUTOVR
     C                   SETON                                            86    *
      * Refresh screen
     C                   EVAL      ##CFCD = ' '
     C                   MOVEL     'N'           ##CFCD
      * Save CMD keys
     C                   MOVEA     *IN           WN30
     C                   SETOFF                                       29        *
      * Generate internal/external key list
     C     KINEX         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2INVL
      * Convert *CONFIRM to external value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2INVL = ' '
     C                   MOVEL     ##CFCD        Y2INVL                         *CONFIRM
     C     KINEX         CHAIN     @Y2INEX                            90        *
     C  N90              MOVEL     Y2EXVL        V#CFCD                         *CONFIRM
      *
     C                   DOU       W0HLP = 'N' AND
     C                             NOT *IN29
     C                   EXSR      ZVCFPM
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   WRITE     #RCDDTL1
     C                   EXFMT     #CONFIRM
     C                   IF        *IN29
     C                   SETON                                        99
     C                   GOTO      DHEXIT
     C                   END
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
      * Validate *CONFIRM
     C                   EVAL      W0RTN = ' '
     C                   MOVEL     V#CFCD        W0NSRQ                         *CONFIRM
      * Name search required?
     C                   IF        W0NSRQ = '?' OR
     C                             'V#CFCD' = YPMTFD
     C                   CALL      'PKVLLWR'                            90      *
     C                   PARM                    W0RTN
     C                   PARM      1001713       Y2LSNO
     C     V#CFCD        PARM      V#CFCD        W0EXVL                         *CONFIRM
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   IF        W0NSRQ <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
     C                   END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C     KEXIN         KLIST
     C                   KFLD                    Y2LSNO
     C                   KFLD                    Y2EXVL
      * Convert *CONFIRM to internal value
     C                   Z-ADD     1001713       Y2LSNO
     C                   EVAL      Y2EXVL = ' '
     C                   MOVEL     V#CFCD        Y2EXVL                         *CONFIRM
     C     KEXIN         CHAIN     @Y2EXIN                            90        *
     C                   IF        *IN90
     C                   EVAL      ##CFCD = ' '
     C                   IF        YPMTFD = ' '
     C                   SETON                                        96        *
     C                   WRITE     #CONFIRM
     C                   SETOFF                                       96        *
     C                   END
     C                   ELSE
     C                   MOVEL     Y2INVL        ##CFCD                         *CONFIRM
     C                   END
      *
     C   90              SETON                                        29        *
     C  N90              SETOFF                                       29        *
     C                   END
      * Restore CMD keys
     C                   MOVEA     WN30          *IN
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   IF        ##CFCD = 'Y'
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   END
     C     ##CFCD        COMP      'Y'                                9999      *
      * Not confirmed
      *================================================================
     CSR   DHEXIT        ENDSR
      /EJECT
     CSR   MALDSC        BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                   Z-ADD     *ZERO         #1HMNB                         BOH Company Num
     C                   Z-ADD     *ZERO         #1CGNZ                         Transfer Buy Or
     C                   Z-ADD     *ZERO         #1CENZ                         Transfer Buy Or
     C                   Z-ADD     *ZERO         #1CFNZ                         Transfer Tattoo
     C                   Z-ADD     *ZERO         #1IIDT                         Transfer Kill D
     C                   EVAL      #1TOCD = ' '                                 Transfer Site I
     C                   EVAL      #1TPCD = ' '                                 Transfer Subsid
     C                   EVAL      #1INT1 = ' '                                 Transfer State
     C                   EVAL      #1MZSS = ' '                                 TRD Payment Sts
     C                   EVAL      #1TNCD = ' '                                 TRD Process Cod
     C                   EVAL      #1NASS = ' '                                 TRD Trucker Pay
     C                   EVAL      #1AAVN = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         #1AADT                         RS Date Changed
     C                   Z-ADD     *ZERO         #1AMTM                         RS Time Changed
     C                   EVAL      #1AJST = ' '                                 RS Record Statu
     C                   EVAL      #1AHVN = ' '                                 RS Job
     C                   EVAL      #1AGVN = ' '                                 RS Program
     C                   EVAL      #1ABVN = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         #1ABDT                         RS Date Added
     C                   Z-ADD     *ZERO         #1ABTM                         RS Time Added
     C                   Z-ADD     *ZERO         #1HONB                         CC Company Numb
     C                   Z-ADD     *ZERO         #1BNNB                         BOH Buy Order N
     C                   Z-ADD     *ZERO         #1CDNZ                         TRH Repayment I
     C                   Z-ADD     *ZERO         #1BONB                         BOL Load Number
     C                   EVAL      #1MCSS = ' '                                 TRD Repayment S
     C                   EVAL      #DSTTX = ' '                                 Text 7 USR
     C                   Z-ADD     *ZERO         #1CVNB                         TH Tattoo Numbe
     C                   Z-ADD     *ZERO         #1B0DT                         TH Kill Date
      * Clear external version also
     C                   Z-ADD     *ZERO         V1B0DT
     C                   EVAL      #1ABCD = ' '                                 PD Producer Cod
     C                   EVAL      #1AECD = ' '                                 PL Location Cod
     C                   EVAL      #1AKCD = ' '                                 PC Contract Cod
     C                   EVAL      #1ALCD = ' '                                 PSC Sub-Contrac
     C                   EVAL      #1NYCD = ' '                                 PS Site ID
     C                   EVAL      #1AACD = ' '                                 SR Source Code
     C                   Z-ADD     *ZERO         #1C1NZ                         TRD Pen Head
      * USER: Load screen
      * DTL = PAR By name
     C                   Z-ADD     P1HONB        #1HONB                         CC Company Numb
     C                   Z-ADD     P1BNNB        #1BNNB                         BOH Buy Order N
     C                   Z-ADD     P1CDNZ        #1CDNZ                         TRH Repayment I
     C                   Z-ADD     P1HMNB        #1HMNB                         BOH Company Num
     C                   Z-ADD     P1BONB        #1BONB                         BOL Load Number
     C                   MOVEL     P1MCSS        #1MCSS                         TRD Repayment S
     C                   Z-ADD     P1CVNB        #1CVNB                         TH Tattoo Numbe
     C                   Z-ADD     P1B0DT        #1B0DT                         TH Kill Date
     C                   MOVEL     P1ABCD        #1ABCD                         PD Producer Cod
     C                   MOVEL     P1AECD        #1AECD                         PL Location Cod
     C                   MOVEL     P1AKCD        #1AKCD                         PC Contract Cod
     C                   MOVEL     P1ALCD        #1ALCD                         PSC Sub-Contrac
     C                   MOVEL     P1NYCD        #1NYCD                         PS Site ID
     C                   MOVEL     P1AACD        #1AACD                         SR Source Code
     C                   Z-ADD     P1C1NZ        #1C1NZ                         TRD Pen Head
      * Display Status text
      * CASE: PAR.TRD Repayment Status is Created
     C                   IF        P1MCSS = 'C'
     C                   MOVEL     @CN(005)      #DSTTX                         Text 7 USR
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is Unpaid
     C                   IF        P1MCSS = 'U'
     C                   MOVEL     @CN(006)      #DSTTX                         Text 7 USR
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is Edited
     C                   IF        P1MCSS = 'E'
     C                   MOVEL     @CN(007)      #DSTTX                         Text 7 USR
     C                   ELSE
      * CASE: PAR.TRD Repayment Status is Repaid
     C                   IF        P1MCSS = 'R'
     C                   MOVEL     @CN(008)      #DSTTX                         Text 7 USR
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   END                                                    *FI
      *================================================================
     CSR   MAEXIT        ENDSR
      /EJECT
     CSR   MNCV#1        BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C     1000000       ADD       #1B0DT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        V1B0DT
      *================================================================
     CSR   MNEXIT        ENDSR
      /EJECT
     CSR   SADLRC        BEGSR
      *================================================================
      * Dlt Tattoo Repay Dtl  DO - Tattoo Repayment Detail  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Move key fields to @AXCPAW
     C                   Z-ADD     #1HONB        WAHONB                         CC Company Numb
     C                   Z-ADD     #1CDNZ        WACDNZ                         TRH Repayment I
     C                   Z-ADD     #1HMNB        WAHMNB                         BOH Company Num
     C                   Z-ADD     #1BNNB        WABNNB                         BOH Buy Order N
     C                   Z-ADD     #1BONB        WABONB                         BOL Load Number
     C                   Z-ADD     #1CVNB        WACVNB                         TH Tattoo Numbe
     C                   Z-ADD     #1B0DT        WAB0DT                         TH Kill Date
      *
     C     KLDLSA        KLIST
     C                   KFLD                    WAHONB                         CC Company Numb
     C                   KFLD                    WACDNZ                         TRH Repayment I
     C                   KFLD                    WAHMNB                         BOH Company Num
     C                   KFLD                    WABNNB                         BOH Buy Order N
     C                   KFLD                    WABONB                         BOL Load Number
     C                   KFLD                    WACVNB                         TH Tattoo Numbe
     C                   KFLD                    WAB0DT                         TH Kill Date
     C     KLDLSA        CHAIN     @AXCPAW                            9091      *
      * Record already deleted
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PWAXCPL0'    MDACP
     C                   MOVEL     '@AXCPAW'     MDFMT
     C                   MOVEL     '*DLT'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      *................................................................
     C                   DELETE    @AXCPAW                              91      *
      * Delete error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBCRRC        BEGSR
      *================================================================
      * Crt Tattoo Repay Cmnt CR - Tattoo Repayment Comment  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0001                         TRC Sequence
     C                   EVAL      WN0002 = ' '                                 RS User Changed
     C                   Z-ADD     *ZERO         WN0003                         RS Date Changed
     C                   Z-ADD     *ZERO         WN0004                         RS Time Changed
     C                   EVAL      WN0005 = ' '                                 RS Record Statu
     C                   EVAL      WN0006 = ' '                                 RS Job
     C                   EVAL      WN0007 = ' '                                 RS Program
     C                   EVAL      WN0008 = ' '                                 RS User Added
     C                   Z-ADD     *ZERO         WN0009                         RS Date Added
     C                   Z-ADD     *ZERO         WN0010                         RS Time Added
      *
     C                   EVAL      W0RTN = ' '
      * Move all fields to @AYCPAP
     C                   Z-ADD     #1HONB        WBHONB                         CC Company Numb
     C                   Z-ADD     #1CDNZ        WBCDNZ                         TRH Repayment I
     C                   Z-ADD     #1HMNB        WBHMNB                         BOH Company Num
     C                   Z-ADD     #1BNNB        WBBNNB                         BOH Buy Order N
     C                   Z-ADD     #1BONB        WBBONB                         BOL Load Number
     C                   Z-ADD     #1CVNB        WBCVNB                         TH Tattoo Numbe
     C                   Z-ADD     #1B0DT        WBB0DT                         TH Kill Date
     C                   MOVEL     YL0004        WBG7T1                         TRC Comment
     C                   MOVEL     'S'           WBMKSS                         TRC Comment Typ
      *
      * USER: Processing before Data update
      * Make sure BOH Company Number is populated
      * CASE: PAR.BOH Company Number is *ZERO
     C                   IF        #1HMNB = 0
     C                   Z-ADD     #1HONB        WBHMNB                         BOH Company Num
     C                   END                                                    *FI
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
     C                   EXSR      SCRVGN
      * Rtv Add Stamp         IF
     C                   MOVEL     'A'           WBAJST                         RS Record Statu
     C                   MOVEL     ##USR         WBABVN                         RS User Added
     C                   Z-ADD     ##JDT         WBABDT                         RS Date Added
     C                   Z-ADD     ##JTM         WBABTM                         RS Time Added
     C                   MOVEL     ##PGM         WBAGVN                         RS Program
     C                   MOVEL     ##JOB         WBAHVN                         RS Job
     C     KLCRSB        KLIST
     C                   KFLD                    WBHONB                         CC Company Numb
     C                   KFLD                    WBCDNZ                         TRH Repayment I
     C                   KFLD                    WBCINZ                         TRC Sequence
      * Check for duplicate primary key
     C     KLCRSB        SETLL     @AYCPAP                                90    *
     C                   IF        *IN90
     C                   MOVEL     'PRK1569'     W0RTN
      * Send message 'Tattoo Repayment Comme EX'
     C                   MOVEL     'PRK1569'     ZAMSID
     C                   EXSR      ZASNMS
     C                   GOTO      SBEXIT
     C                   ENDIF
      *
     C                   WRITE     @AYCPAP                              91      *
      *
      * Write error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
     C                   ENDIF
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCRVGN        BEGSR
      *================================================================
      * Rtv Next Comment Seq# RT - Tattoo Repayment Comment  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSC         KLIST
     C                   KFLD                    WQSC01                         CC Company Numb
     C                   KFLD                    WQSC02                         TRH Repayment I
      * Setup key
     C                   Z-ADD     #1HONB        WQSC01                         CC Company Numb
     C                   Z-ADD     #1CDNZ        WQSC02                         TRH Repayment I
      * Establish starting position
     C     KRSSC         SETLL     @AYCPA6                                      *
     C     KRSSC         READE     @AYCPA6                                90    *
      * Data record not found
     C                   IF        *IN90
     C                   MOVEL     'PRK1568'     W0RTN
      * USER: Processing if Data record not found
     C                   Z-ADD     1             WBCINZ                         TRC Sequence
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * USER: Process Data record
     C                   DOW       NOT *IN90
     C     WCCINZ        ADD       1             WBCINZ                         TRC Sequence
     C                   GOTO      SCEXIT                                       *QUIT
     C     KRSSC         READE     @AYCPA6                                90    *
     C                   ENDDO
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   UASUBR        BEGSR
      *================================================================
      * Modification history
      *================================================================
      *  5/20/2021 JBB P17058 - Tattoo Repayment by Business
      *                SDD619   Delete a Tattoo Repayment Detail record.
      *================================================================
     CSR   UAEXIT        ENDSR
      /EJECT
     CSR   VACKRL        BEGSR
      *================================================================
      * Check reference to Tattoo Repayment Header
      *================================================================
     C                   EVAL      W0RTN = ' '
      * If all low order keys not entered, exit
     C                   IF        #1HONB = *ZERO AND
     C                             #1CDNZ = *ZERO
     C                   GOTO      VAEXIT
     C                   END
      *
     C     KLVAWD        KLIST
     C                   KFLD                    WDHONB                         CC Company Numb
     C                   KFLD                    WDCDNZ                         TRH Repayment I
      * Setup key
     C                   Z-ADD     #1HONB        WDHONB
     C                   Z-ADD     #1CDNZ        WDCDNZ
     C     KLVAWD        CHAIN     @AWCPAQ                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VAEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VAEXIT
     C                   END
      * Send message 'Tattoo Repayment Heade NF'
     C                   MOVEL     'PRK1564'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK1564'     W0RTN
      *================================================================
     CSR   VAEXIT        ENDSR
      /EJECT
     CSR   VBCKRL        BEGSR
      *================================================================
      * Check reference to Tattoo Header
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(DTL) #1CVNB' defaulted for 'TH Tattoo Number'.
      * Field '(DTL) #1B0DT' defaulted for 'TH Kill Date'.
     C                   IF        YPMTFD = '#1HMNB' OR
     C                             YPMTFD = '#1BNNB' OR
     C                             YPMTFD = '#1BONB' OR
     C                             YPMTFD = '#1CVNB' OR
     C                             YPMTFD = '#1B0DT'
     C                   CALL      'PKB7SRR'                            90      Sel Kill/Tattoo
     C                   PARM      *BLANK        W0RTN
     C     #1HMNB        PARM      #1HMNB        WQ0001                         BOH Company Num
     C     #1CVNB        PARM      #1CVNB        WQ0002                         TH Tattoo Numbe
     C     #1B0DT        PARM      #1B0DT        WQ0003                         TH Kill Date
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKB7SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1HMNB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1BNNB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1BONB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1CVNB <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1B0DT <> *ZERO AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' '
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VBEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1HMNB = *ZERO AND
     C                             #1BNNB = *ZERO AND
     C                             #1BONB = *ZERO AND
     C                             #1CVNB = *ZERO AND
     C                             #1B0DT = *ZERO
     C                   GOTO      VBEXIT
     C                   END
      *
     C     KLVBWE        KLIST
     C                   KFLD                    WEHMNB                         BOH Company Num
     C                   KFLD                    WEBNNB                         BOH Buy Order N
     C                   KFLD                    WEBONB                         BOL Load Number
     C                   KFLD                    WECVNB                         TH Tattoo Numbe
     C                   KFLD                    WEB0DT                         TH Kill Date
      * Setup key
     C                   Z-ADD     #1HMNB        WEHMNB
     C                   Z-ADD     #1BNNB        WEBNNB
     C                   Z-ADD     #1BONB        WEBONB
     C                   Z-ADD     #1CVNB        WECVNB
     C                   Z-ADD     #1B0DT        WEB0DT
     C     KLVBWE        CHAIN     @A1CPC4                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VBEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VBEXIT
     C                   END
      * Send message 'Tattoo Header          NF'
     C                   MOVEL     'PRK0061'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0061'     W0RTN
      *================================================================
     CSR   VBEXIT        ENDSR
      /EJECT
     CSR   VCCKRL        BEGSR
      *================================================================
      * Check reference to Producer Site
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1ABCD        WK1X01
     C                   MOVEL     #1NYCD        WK1X02
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1NYCD' defaulted for 'PS Site ID'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *BLANK' defaulted for 'Oms System Value Alpha'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1ABCD' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1NYCD'
     C                   CALL      'PLGKSRR'                            90      Sel Producer Si
     C                   PARM      *BLANK        W0RTN
     C     #1ABCD        PARM      #1ABCD        WQ0004                         PD Producer Cod
     C     #1NYCD        PARM      #1NYCD        WQ0005                         PS Site ID
     C                   PARM      *BLANK        WQ0006                         Oms System Valu
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PLGKSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1ABCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1NYCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VCEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1NYCD = ' '
     C                   GOTO      VCEXIT
     C                   END
      *
     C     KLVCWF        KLIST
     C                   KFLD                    WFABCD                         PD Producer Cod
     C                   KFLD                    WFNYCD                         PS Site ID
      * Setup key
     C                   MOVEL     #1ABCD        WFABCD
     C                   MOVEL     #1NYCD        WFNYCD
     C     KLVCWF        CHAIN     @ATRELM                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VCEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VCEXIT
     C                   END
      * Send message 'Producer Site          NF'
     C                   MOVEL     'PRK1137'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK1137'     W0RTN
      *================================================================
     CSR   VCEXIT        ENDSR
      /EJECT
     CSR   VDCKRL        BEGSR
      *================================================================
      * Check reference to Source
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1AACD        WK1X01
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AACD' defaulted for 'SR Source Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1AACD'
     C                   CALL      'PKDRSRR'                            90      Sel Source
     C                   PARM      *BLANK        W0RTN
     C     #1AACD        PARM      #1AACD        WQ0007                         SR Source Code
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKDRSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AACD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VDEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AACD = ' '
     C                   GOTO      VDEXIT
     C                   END
      *
     C     KLVDWG        KLIST
     C                   KFLD                    WGAACD                         SR Source Code
      * Setup key
     C                   MOVEL     #1AACD        WGAACD
     C     KLVDWG        CHAIN     @AAREAC                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VDEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VDEXIT
     C                   END
      * Send message 'Source                 NF'
     C                   MOVEL     'PRK0005'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0005'     W0RTN
      *================================================================
     CSR   VDEXIT        ENDSR
      /EJECT
     CSR   VECKRL        BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1ABCD        WK1X01
     C                   MOVEL     #1AECD        WK1X02
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1ABCD' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1AECD'
     C                   CALL      'PWF5SRR'                            90      Sel Prod Loc by
     C                   PARM      *BLANK        W0RTN
     C     #1ABCD        PARM      #1ABCD        WQ0008                         PD Producer Cod
     C     #1AECD        PARM      #1AECD        WQ0009                         PL Location Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PWF5SRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1ABCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1AECD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VEEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AECD = ' '
     C                   GOTO      VEEXIT
     C                   END
      *
     C     KLVEWH        KLIST
     C                   KFLD                    WHABCD                         PD Producer Cod
     C                   KFLD                    WHAECD                         PL Location Cod
      * Setup key
     C                   MOVEL     #1ABCD        WHABCD
     C                   MOVEL     #1AECD        WHAECD
     C     KLVEWH        CHAIN     @AFREAR                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VEEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VEEXIT
     C                   END
      * Send message 'Producer Location      NF'
     C                   MOVEL     'PRK0015'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0015'     W0RTN
      *================================================================
     CSR   VEEXIT        ENDSR
      /EJECT
     CSR   VFCKRL        BEGSR
      *================================================================
      * Check reference to Producer Sub-Contract
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Name search required?
     C                   MOVEL     #1AKCD        WK1X01
     C                   MOVEL     #1ALCD        WK1X02
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AKCD' defaulted for 'PC Contract Code'.
      * Field '(DTL) #1ALCD' defaulted for 'PSC Sub-Contract Code'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                   IF        WK1X01 = '?' OR
     C                             YPMTFD = '#1AKCD' OR
     C                             WK1X02 = '?' OR
     C                             YPMTFD = '#1ALCD'
     C                   CALL      'PKFFSRR'                            90      Sel Sub-Contrac
     C                   PARM      *BLANK        W0RTN
     C     #1AKCD        PARM      #1AKCD        WQ0010                         PC Contract Cod
     C     #1ALCD        PARM      #1ALCD        WQ0011                         PSC Sub-Contrac
     C                   PARM      #1ABCD        WQ0012                         PD Producer Cod
     C                   PARM      #1AECD        WQ0013                         PL Location Cod
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PKFFSRR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' ' AND
     C                             W0RTN <> 'Y2U0016'
     C                   SETON                                        99        *
     C                   END
      *
     C                   IF        #1AKCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X01 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
     C                   IF        #1ALCD <> ' ' AND
     C                             YPMTFD <> ' ' AND
     C                             W0RTN = ' ' AND
     C                             WK1X02 <> '?'
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
      * No value selected, exit
     C                   IF        W0RTN <> ' ' AND
     C                             YPMTFD = ' '
     C                   GOTO      VFEXIT
     C                   END
     C                   END
      *................................................................
      * If all low order keys not entered, exit
     C                   IF        #1AKCD = ' ' AND
     C                             #1ALCD = ' '
     C                   GOTO      VFEXIT
     C                   END
      *
     C     KLVFWI        KLIST
     C                   KFLD                    WIAKCD                         PC Contract Cod
     C                   KFLD                    WIALCD                         PSC Sub-Contrac
      * Setup key
     C                   MOVEL     #1AKCD        WIAKCD
     C                   MOVEL     #1ALCD        WIALCD
     C     KLVFWI        CHAIN     @AQCPA0                            9091      *
      * Record found - move back any virtuals
     C                   IF        NOT *IN90
     C                   GOTO      VFEXIT
     C                   END
     C                   IF        YPMTFD <> ' '
     C                   SETOFF                                       9091
     C                   GOTO      VFEXIT
     C                   END
      * Send message 'Producer Sub-Contract  NF'
     C                   MOVEL     'PRK0037'     ZAMSID
     C                   EXSR      ZASNMS
     C                   MOVEL     'PRK0037'     W0RTN
      *================================================================
     CSR   VFEXIT        ENDSR
      /EJECT
     CSR   XDVC2T        BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                   Z-ADD     0             XDEX01                         CC
     C                   IF        XDDTFM = 'DMY'
     C                   Z-ADD     XDINDD        XDEX02                         DD
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
     C                   IF        XDDTFM = 'MDY'
     C                   Z-ADD     XDINMM        XDEX02                         MM
     C                   Z-ADD     XDINDD        XDEX03                         DD
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
      * YMD format
     C                   Z-ADD     XDINYY        XDEX02                         YY
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINDD        XDEX04                         DD
     C                   END
     C                   END
      *================================================================
     CSR   XDVC2E        ENDSR
      /EJECT
     CSR   YKDDW1        BEGSR
      *================================================================
      * Calculate window location for drop down lists on screen 1
      *================================================================
      *================================================================
     CSR   YKEXT1        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ##WSR         MULT      256           ZWORK
     C                   ADD       ##WSC         ZWORK
     C                   SUB       ZWORK         ZINPOS
     C                   SUB       1             ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C     @#WWRC        DIV       256           ZZCSRW                         Row
     C                   MVR                     ZZCSCL                         Column
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C     @#WWRC        DIV       256           ZZCSRW                         Row
     C                   MVR                     ZZCSCL                         Column
      *
     C     ZHCSRW        SUB       ##WSR         YWPORW
     C     ZHCSCL        SUB       ##WSC         YWPOC1
     C                   SUB       1             YWPOC1
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*CSRLOC'     YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      YWPORW        YYRW                           Row
     C                   PARM      YWPOC1        YYCL                           Column
     C                   PARM      *ZERO         YYLGCT                         # of grps
     C                   PARM      *BLANK        YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZRRPWD        BEGSR
      *================================================================
      * *Reposition window
      *================================================================
     C                   MOVEL     'Y'           YSL(1)                         Set wdw locatio
     C                   MOVEL     'R'           YWLCTP                         Locate action t
     C                   EXSR      ZSSTLC                                       Set window loca
      *
      * Redisplay previous panel
     C                   WRITE     ASSUME
      *================================================================
     CSR   ZREXIT        ENDSR
      /EJECT
     CSR   ZSSTLC        BEGSR
      *================================================================
      * Set window location
      *================================================================
     C                   IF        YSL(1) = 'Y'
     C                   MOVEL     '*CALC'       YWWDCR                         Window referenc
     C                   Z-ADD     -3            YWWDRW                         Window start ro
     C                   Z-ADD     -3            YWWDCL                         Window start co
     C                   Z-ADD     063           YWWDWD                         Window width
     C                   Z-ADD     017           YWWDDP                         Window depth
     C                   MOVEL     'N'           YSL(1)                         Set wdw locatio
      *
     C                   EXSR      ZURTLC                                       Retrieve window
     C                   EXSR      ZTWDFD                                       Move window fie
     C                   END
      *================================================================
     CSR   ZSEXIT        ENDSR
      /EJECT
     CSR   ZTWDFD        BEGSR
      *================================================================
      * Move window fields by panel
      *================================================================
     C                   Z-ADD     YWWDRW        ##WSR                          Window start ro
     C                   Z-ADD     YWWDCL        ##WSC                          Window start co
     C                   EXSR      YKDDW1
      *================================================================
     CSR   ZTEXIT        ENDSR
      /EJECT
     CSR   ZURTLC        BEGSR
      *================================================================
      * Retrieve window location
      *================================================================
      *
      * Set up parameters to API
      *
      * Return code
     C                   EVAL      W0RTN = ' '
      * Retrieval Function
     C                   EVAL      YWRTFN = ' '
     C                   MOVEL     '*WDWLOC'     YWRTFN
      *
     C                   SETOFF                                         90      *
      *
     C                   CALL      'YWRTLCI'                            90      *
     C                   PARM                    YWRTFN                         Retrieval Funct
     C                   PARM                    YWWDWD                         Window width
     C                   PARM                    YWWDDP                         Window depth
     C                   PARM                    YWWDCR                         Window referenc
     C                   PARM                    YWWDRW                         *Window start r
     C                   PARM                    YWWDCL                         *Window start c
     C                   PARM                    W0RTN                          Return code
      * If error on call to API - default window location to top left cor
     C                   IF        *IN90 OR
     C                             W0RTN <> ' '
     C                   Z-ADD     2             YWWDRW                         *Window start r
     C                   Z-ADD     2             YWWDCL                         *Window start c
     C                   END
      *
      *================================================================
     CSR   ZUEXIT        ENDSR
      /EJECT
     CSR   ZVCFPM        BEGSR
      *================================================================
      * Set Confirm Prompt window location
      *================================================================
      *
     C     ##WSR         ADD       017           YWWDRW
     C     ##WSC         ADD       063           YWWDCL
      *
     C                   ADD       1             YWWDCL
     C                   SUB       1             YWWDRW                         Window start ro
     C                   SUB       21            YWWDCL                         Window start co
     C                   Z-ADD     18            YWWDWD                         Window width
     C                   Z-ADD     2             YWWDDP                         Window depth
     C                   MOVEL     '*TL  '       YWWDCR                         Window referenc
     C                   EVAL      YWRTFN = ' '
     C                   MOVEL     '*WDWLOC'     YWRTFN                         Retrieval Funct
     C                   EXSR      ZURTLC                                       Retrieve window
     C                   Z-ADD     YWWDRW        ##WSRC                         *Window start r
     C                   Z-ADD     YWWDCL        ##WSCC                         *Window start c
      *
      *================================================================
     CSR   ZVEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                   CALL      'Y2CPMSC'
     C                   PARM                    ##PGM
     C                   PARM      'Y'           YILE
      *
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialise Allow Set Window Location flags
     C                   MOVEA     *ALL'Y'       YSL
      * Set display size
     C                   SETOFF                                           93    *
     C     @#SCRW        COMP      27                                     93    *
      * Initialise window location variables.
     C                   Z-ADD     *ZEROS        ##WSR
     C                   Z-ADD     *ZEROS        ##WSC
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAHONB                         CC Company Numb
     C                   Z-ADD     *ZERO         WACDNZ                         TRH Repayment I
     C                   Z-ADD     *ZERO         WAHMNB                         BOH Company Num
     C                   Z-ADD     *ZERO         WABNNB                         BOH Buy Order N
     C                   Z-ADD     *ZERO         WABONB                         BOL Load Number
     C                   Z-ADD     *ZERO         WACVNB                         TH Tattoo Numbe
     C                   Z-ADD     *ZERO         WAB0DT                         TH Kill Date
     C                   Z-ADD     *ZERO         WACGNZ                         Transfer Buy Or
     C                   Z-ADD     *ZERO         WACENZ                         Transfer Buy Or
     C                   Z-ADD     *ZERO         WACFNZ                         Transfer Tattoo
     C                   Z-ADD     *ZERO         WAIIDT                         Transfer Kill D
     C                   Z-ADD     *ZERO         WAC1NZ                         TRD Pen Head
     C                   Z-ADD     *ZERO         WAAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WAAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WAABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WAABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBHONB                         CC Company Numb
     C                   Z-ADD     *ZERO         WBCDNZ                         TRH Repayment I
     C                   Z-ADD     *ZERO         WBCINZ                         TRC Sequence
     C                   Z-ADD     *ZERO         WBHMNB                         BOH Company Num
     C                   Z-ADD     *ZERO         WBBNNB                         BOH Buy Order N
     C                   Z-ADD     *ZERO         WBBONB                         BOL Load Number
     C                   Z-ADD     *ZERO         WBCVNB                         TH Tattoo Numbe
     C                   Z-ADD     *ZERO         WBB0DT                         TH Kill Date
     C                   Z-ADD     *ZERO         WBAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WBAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WBABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WBABTM                         RS Time Added
      * Obtain default message file
     C     *DTAARA       DEFINE    PKMGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WDHONB                         CC Company Numb
     C                   Z-ADD     *ZERO         WDCDNZ                         TRH Repayment I
     C                   Z-ADD     *ZERO         WDIDDT                         TRH Date Start
     C                   Z-ADD     *ZERO         WDCATM                         TRH Time Start
     C                   Z-ADD     *ZERO         WDIEDT                         TRH Date Comple
     C                   Z-ADD     *ZERO         WDCBTM                         TRH Time Comple
     C                   Z-ADD     *ZERO         WDIFDT                         TRH Payment Dat
     C                   Z-ADD     *ZERO         WDCTNZ                         TRH Payment Ste
     C                   Z-ADD     *ZERO         WDAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WDAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WDABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WDABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WEHMNB                         BOH Company Num
     C                   Z-ADD     *ZERO         WEBNNB                         BOH Buy Order N
     C                   Z-ADD     *ZERO         WEBONB                         BOL Load Number
     C                   Z-ADD     *ZERO         WECVNB                         TH Tattoo Numbe
     C                   Z-ADD     *ZERO         WEB0DT                         TH Kill Date
     C                   Z-ADD     *ZERO         WEAWDT                         TH Purchase Dat
     C                   Z-ADD     *ZERO         WEACPR                         TH Live Purchas
     C                   Z-ADD     *ZERO         WEB9PR                         TH Live Gross A
     C                   Z-ADD     *ZERO         WECAPR                         TH LIve Net Amt
     C                   Z-ADD     *ZERO         WEAIPR                         TH Recalc Live
     C                   Z-ADD     *ZERO         WEA6DT                         TH Pricing Date
     C                   Z-ADD     *ZERO         WECXNB                         TH Dead On Arri
     C                   Z-ADD     *ZERO         WECWNB                         TH Head Receive
     C                   Z-ADD     *ZERO         WEFCNB                         TH Yard Deads
     C                   Z-ADD     *ZERO         WEH9NB                         TH Held Over
     C                   Z-ADD     *ZERO         WEFDNB                         TH Head Condemn
     C                   Z-ADD     *ZERO         WEFENB                         TH Head Killed
     C                   Z-ADD     *ZERO         WEHENB                         TH Head Adds
     C                   Z-ADD     *ZERO         WEHFNB                         TH Head Accepte
     C                   Z-ADD     *ZERO         WECYNB                         TH Live Wgt
     C                   Z-ADD     *ZERO         WELRNB                         TH Adj Live Wgt
     C                   Z-ADD     *ZERO         WEE0NB                         TH Hot Wgt
     C                   Z-ADD     *ZERO         WEA5PC                         TH Tot Loin Eye
     C                   Z-ADD     *ZERO         WEFBNB                         TH Tot Backfat
     C                   Z-ADD     *ZERO         WEA4PC                         TH Tot Light Re
     C                   Z-ADD     *ZERO         WEF7NB                         TH Avg Live Wgt
     C                   Z-ADD     *ZERO         WEHDNB                         TH Avg Hot Wgt
     C                   Z-ADD     *ZERO         WEF5NB                         TH Avg Light Re
     C                   Z-ADD     *ZERO         WEF4NB                         TH Avg Lean Per
     C                   Z-ADD     *ZERO         WEF3NB                         TH Avg Loin Eye
     C                   Z-ADD     *ZERO         WEF2NB                         TH Avg Backfat
     C                   Z-ADD     *ZERO         WEAVPC                         TH Std Yield Pe
     C                   Z-ADD     *ZERO         WEAWPC                         TH Actual Yield
     C                   Z-ADD     *ZERO         WECWPC                         TH Adj Actual Y
     C                   Z-ADD     *ZERO         WEA8PC                         TH Yield Differ
     C                   Z-ADD     *ZERO         WEA7PC                         TH Recalc Live
     C                   Z-ADD     *ZERO         WEB8PR                         TH CM Market Pr
     C                   Z-ADD     *ZERO         WEAMPR                         TH CM Base Mkt
     C                   Z-ADD     *ZERO         WEANPR                         TH CM Base Mkt
     C                   Z-ADD     *ZERO         WEAYVA                         TH CM Sort Disc
     C                   Z-ADD     *ZERO         WEAWVA                         TH CM Yield Gai
     C                   Z-ADD     *ZERO         WEAOPR                         TH CM Base Carc
     C                   Z-ADD     *ZERO         WEAXVA                         TH CM LN AddOn/
     C                   Z-ADD     *ZERO         WEAPPR                         TH CM Carcass G
     C                   Z-ADD     *ZERO         WEASPR                         TH Deduction Am
     C                   Z-ADD     *ZERO         WEA4VA                         TH Total Net WO
     C                   Z-ADD     *ZERO         WEATPR                         TH Carcass Net
     C                   Z-ADD     *ZERO         WEA5VA                         TH Additions Am
     C                   Z-ADD     *ZERO         WECBPR                         TH Payment Gros
     C                   Z-ADD     *ZERO         WECCPR                         Th Payment Net
     C                   Z-ADD     *ZERO         WELPNB                         TH AP Voucher/D
     C                   Z-ADD     *ZERO         WECDPR                         TH Freight Amou
     C                   Z-ADD     *ZERO         WEA7VA                         TH Accrual Amou
     C                   Z-ADD     *ZERO         WEA2PR                         TH Fixed Cost A
     C                   Z-ADD     *ZERO         WEGHNB                         TH Commission A
     C                   Z-ADD     *ZERO         WEBYDT                         TH Voucher Paym
     C                   Z-ADD     *ZERO         WEBSDT                         TH Held/Ovr Com
     C                   Z-ADD     *ZERO         WEBTDT                         TH Commission P
     C                   Z-ADD     *ZERO         WEBUDT                         TH Actual Check
     C                   Z-ADD     *ZERO         WEHGNB                         TH Shipped Weig
     C                   Z-ADD     *ZERO         WEHHNB                         TH Avg Hot Wgt
     C                   Z-ADD     *ZERO         WEHINB                         TH FFLI
     C                   Z-ADD     *ZERO         WEA3PR                         TH Kill Product
     C                   Z-ADD     *ZERO         WEA4PR                         TH Cut Product
     C                   Z-ADD     *ZERO         WEA6PR                         TH Render Produ
     C                   Z-ADD     *ZERO         WEJ9NB                         TH Head Exclude
     C                   Z-ADD     *ZERO         WED6PR                         TH CM Bse Mkt L
     C                   Z-ADD     *ZERO         WED7PR                         TH CM Bse Mkt C
     C                   Z-ADD     *ZERO         WED8PR                         TH CM Srt Dsc L
     C                   Z-ADD     *ZERO         WED9PR                         TH CM Srt Dsc C
     C                   Z-ADD     *ZERO         WEEAPR                         TH CM Yld G/L L
     C                   Z-ADD     *ZERO         WEEBPR                         TH CM Yld G/L C
     C                   Z-ADD     *ZERO         WEECPR                         TH CM Crc Val L
     C                   Z-ADD     *ZERO         WEEDPR                         TH CM Crc Val C
     C                   Z-ADD     *ZERO         WEEEPR                         TH CM Lean Prem
     C                   Z-ADD     *ZERO         WEEFPR                         TH CM Lean Prem
     C                   Z-ADD     *ZERO         WEEGPR                         TH CM Gross Liv
     C                   Z-ADD     *ZERO         WEEHPR                         TH CM Gross Car
     C                   Z-ADD     *ZERO         WEOXNB                         TH HPS Movement
     C                   Z-ADD     *ZERO         WETHWT                         TH DOA Weight
     C                   Z-ADD     *ZERO         WET2WT                         TH Avg Lean % E
     C                   Z-ADD     *ZERO         WETHHD                         TH HPS Farm Sit
     C                   Z-ADD     *ZERO         WET2HD                         TH Shift Held O
     C                   Z-ADD     *ZERO         WEOBPR                         TH Sorting Amou
     C                   Z-ADD     *ZERO         WEKOER                         TH Head Identif
     C                   Z-ADD     *ZERO         WEOPIR                         TH Percent Iden
     C                   Z-ADD     *ZERO         WEOPEM                         TH Percent Acce
     C                   Z-ADD     *ZERO         WEIORP                         TH Head Adjuste
     C                   Z-ADD     *ZERO         WEOWEO                         TH PHA Head Add
     C                   Z-ADD     *ZERO         WEHHPC                         TH PHA Yield Pe
     C                   Z-ADD     *ZERO         WES9PR                         TH PHA Lean Prm
     C                   Z-ADD     *ZERO         WETAPR                         TH VC Gross Val
     C                   Z-ADD     *ZERO         WETBPR                         TH Excluded Gro
     C                   Z-ADD     *ZERO         WEJFUR                         TH Avg Lean %
     C                   Z-ADD     *ZERO         WEKRIF                         TH Broken Back
     C                   Z-ADD     *ZERO         WEKORF                         TH Hot Scl Uplo
     C                   Z-ADD     *ZERO         WEKAPR                         TH Unused Nbr 4
     C                   Z-ADD     *ZERO         WEKROT                         TH Excluded Car
     C                   Z-ADD     *ZERO         WEOTJG                         TH Excluded Pre
     C                   Z-ADD     *ZERO         WEIRJG                         TH Unused Nbr 7
     C                   Z-ADD     *ZERO         WEIMJF                         TH Unused Nbr 8
     C                   Z-ADD     *ZERO         WEIRGF                         TH Unused Nbr 9
     C                   Z-ADD     *ZERO         WEKRJF                         TH Unused Nbr 1
     C                   Z-ADD     *ZERO         WEOJRF                         TH Break Even P
     C                   Z-ADD     *ZERO         WEKFOR                         TH Meat Value F
     C                   Z-ADD     *ZERO         WEORJK                         TH Yld Parm Adj
     C                   Z-ADD     *ZERO         WEOMVJ                         TH PHA Sort Dis
     C                   Z-ADD     *ZERO         WEMVNF                         TH Avg Loin Eye
     C                   Z-ADD     *ZERO         WEMCNF                         TH Avg Backfat
     C                   Z-ADD     *ZERO         WENCNF                         TH HITCH Old Pa
     C                   Z-ADD     *ZERO         WENCHF                         TH MPR Sort Los
     C                   Z-ADD     *ZERO         WEIGIR                         TH Unused Nbr 1
     C                   Z-ADD     *ZERO         WEKFJR                         TH Unused Nbr 2
     C                   Z-ADD     *ZERO         WEEADT                         TH Cold Scl Upl
     C                   Z-ADD     *ZERO         WEEBDT                         TH Cold Scl Upl
     C                   Z-ADD     *ZERO         WEECDT                         TH Head LFT
     C                   Z-ADD     *ZERO         WEEDDT                         TH Head EUT/KOA
     C                   Z-ADD     *ZERO         WEEEDT                         TH Unused Date
     C                   Z-ADD     *ZERO         WEAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WEAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WEABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WEABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WFMDA1                         PS User Mileage
     C                   Z-ADD     *ZERO         WFMEA1                         PS User Mileage
     C                   Z-ADD     *ZERO         WFMFA1                         PS Trace Sequen
     C                   Z-ADD     *ZERO         WFAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WFAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WFABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WFABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WGAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WGAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WGABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WGABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WHGLNB                         Pl VND Address
     C                   Z-ADD     *ZERO         WHASNB                         PL Miles/Unused
     C                   Z-ADD     *ZERO         WHHWNB                         PL Primary Comp
     C                   Z-ADD     *ZERO         WHAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WHAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WHABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WHABTM                         RS Time Added
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WIAHDT                         PSC Date
     C                   Z-ADD     *ZERO         WIAZPR                         PSC Floor Price
     C                   Z-ADD     *ZERO         WIA0PR                         PSC Ceiling Pri
     C                   Z-ADD     *ZERO         WIA9PC                         PSC Market Perc
     C                   Z-ADD     *ZERO         WIA7PR                         PSC Break Even
     C                   Z-ADD     *ZERO         WIA8PR                         PSC FLoor Price
     C                   Z-ADD     *ZERO         WIA9PR                         PSC Mkt Percent
     C                   Z-ADD     *ZERO         WIF6PR                         PSC Mkt + or -
     C                   Z-ADD     *ZERO         WIAADT                         RS Date Changed
     C                   Z-ADD     *ZERO         WIAMTM                         RS Time Changed
     C                   Z-ADD     *ZERO         WIABDT                         RS Date Added
     C                   Z-ADD     *ZERO         WIABTM                         RS Time Added
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   MOVE      ZZFFL         @1FFL
     C                   MOVE      ZZFLB         @1FLB
     C                   MOVE      ZZFMB         @1FMB
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Buy Order Number Alpha
     C                   EVAL      YL0001 = ' '
      * Define local work field Load Number Alpha
     C                   EVAL      YL0002 = ' '
      * Define local work field Tattoo Number Alpha
     C                   EVAL      YL0003 = ' '
      * Define local work field TRC Comment
     C                   EVAL      YL0004 = ' '
      * Obtain system date format
     C     *DTAARA       DEFINE    Y2DTFMA       XDDTFM
     C                   IN        XDDTFM
     C                   EVAL      W0GRP = ' '
      * USER: Initialize program
      * Modification history
     C                   EXSR      UASUBR                                       Modification hi
      * Load screen
     C                   EXSR      MALDSC
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 Buy Order
00002 , Load
00003 , Tattoo
00004 removed.
00005 Created
00006 Unpaid
00007 Edited
00008 Repaid
