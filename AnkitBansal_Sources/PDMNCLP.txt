/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM WITH SELECTIONS FOR SHAG AND WASH      */
/*             REPORT                                               */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT SHAG AND WASH REPORT                          */
/*  DATE      - 06/04/97                                            */
/*                                                                  */
/*  PARAMETERS RECEIVED:                                            */
/*                                                                  */
/*      &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL                */
/*      &FRMDATN    - FROM SHIP DATE                                */
/*      &THRDATN    - THROUGH SHIP DATE                             */
/*      &CARRIER    - CARRIER CODE                                  */
/*      &OUTQ       - OUTPUT QUEUE                                  */
/*      &HOLD       - HOLD PRINT                                    */
/*      &SAVE       - SAVE PRINT                                    */
/*      &COPYN      - NUMBER OF COPIES                              */
/*      &NIGHTQ     - NIGHT OUTPUT QUEUE                            */
/********************************************************************/
/* RMC 05/14/04 PKTR01 - MAKE CO OPTIONAL ON QRYSLT                 */
/* LJB 11/17/06 L61116A - ADD 2 NEW PARMS FOR COLLECT SHIPMENTS Y/N */
/*     AND INCLUDE STI Y/N                                          */
/* SLM 05/08/09 E00371  - CHANGE PARMS FOR SELECTION                */
/*                        CHANGE DATES TO ACTUAL SHIP DATE RANGE    */
/* PIO 05/17/23 -  REPLACE OPNQRYF WITH OPNSQLF FOR OMFJCPP FILE    */
/*                 ADDED NEEDED OVRDBF AROUND THE COMMAND.          */
/*                 CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO  */
/*                 <=, *GT TO > IN &Q                               */
/*                                                                  */
/********************************************************************/
/*********** PGM        PARM(&COMPNYN &FRMDATN &THRDATN &CARRIER +
                          &OUTQ &HOLD &SAVE &COPYN &NIGHTQ) *********/
/*********** PGM        PARM(&COMPNYN &FRMDATN &THRDATN &CARRIER +
                          &OUTQ &HOLD &SAVE &COPYN &NIGHTQ &COLLECT +
                          &STI)                             *********/

 PDMNCLP:    PGM        PARM(&COMPNYN &FRMDATN &THRDATN &CARRIER +
                          &OUTQ &HOLD &SAVE &COPYN &NIGHTQ &COLLECT +
                          &STI &NSHNWSH &WHSE &SUMMARY)
/* PARMS                                                                      */
        DCL    &COMPNYN    *DEC                  /* Company Number (Passed)   */
        DCL    &FRMDATN    *DEC                  /* FROM SHIP DATE (Passed)   */
        DCL    &THRDATN    *DEC                  /* THRU SHIP DATE (PASSED)   */
        DCL    &CARRIER    *CHAR   (3)           /* CARRIER CODE              */
        DCL    &DESC       *CHAR   (25)          /* DESCRIPTION               */
        DCL    &COPYN      *DEC                  /* No. of Copies             */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &COMMAND    *CHAR   (512)
        DCL    &COLLECT    *CHAR   (1)           /* INCL COLLECT TRUCK        */
        DCL    &STI        *CHAR   (1)           /* INCLUDE STI               */
        DCL    &NSHNWSH    *CHAR   (1)           /* NO SHAG & NO WASH         */
        DCL    &WHSE       *CHAR   (3)           /* WAREHOUSE SELECTION       */
        DCL    &SUMMARY    *CHAR   (1)           /* SUMMARY ONLY              */

/* INTERNAL FIELDS                                                            */
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
        DCL    &FRMDAT     *DEC    (7 0)         /* FROM SHIP DATE            */
        DCL    &THRDAT     *DEC    (7 0)         /* THRU SHIP DATE            */

/* OPENQRYF FIELDS                                                            */
        DCL    &COMPA      *CHAR    3            /* COMPANY                   */
        DCL    &FRMDATA    *CHAR    7            /* FROM SHIP DATE (Passed)   */
        DCL    &THRDATA    *CHAR    7            /* THRU SHIP DATE (Passed)   */

        DCL     &A        *CHAR   30              /* QRY COMPANY    */
        DCL     &B        *CHAR   50              /* QRY FROM DATE  */
        DCL     &C        *CHAR   50              /* QRY THRU DATE  */
        DCL     &D        *CHAR   50              /* QRY CARRIER    */
        DCL     &Q        *CHAR  315              /* QRY ALL        */

/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/
             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMPA) VALUE(&COMPANY)
             CHGVAR     VAR(&FRMDAT) VALUE(&FRMDATN)
             CHGVAR     VAR(&FRMDATA) VALUE(&FRMDAT)
             CHGVAR     VAR(&THRDAT) VALUE(&THRDATN)
             CHGVAR     VAR(&THRDATA) VALUE(&THRDAT)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR INVOICING REPORTS         */
/*********************************************************************/
/* SELECT COMPANY                                                    */
             IF         COND(&COMPA *GT '000') THEN(DO)
  /*PIO      CHGVAR     VAR(&A) VALUE('FJAIC3 *EQ ' *CAT &COMPA *BCAT '*AND')*/
  /*PIO*/    CHGVAR     VAR(&A) VALUE('FJAIC3  =  ' *CAT &COMPA *BCAT ' AND')
             ENDDO

/* SELECT FROM DATE                                                  */
  /*PIO      CHGVAR     VAR(&B) VALUE(' (FJF9DT *GE ' *CAT +   +
                         &FRMDATA *CAT ' *AND FJF9DT *LE '    ++
                         *CAT &THRDATA *CAT ')')              */
  /*PIO*/    CHGVAR     VAR(&B) VALUE(' (FJF9DT >=  ' *CAT +
                         &FRMDATA *CAT '  AND FJF9DT <=  '    +
                         *CAT &THRDATA *CAT ')')

/* SELECT CARRIER                                                    */
             IF COND(&CARRIER *NE ' ') THEN(DO)
  /*PIO      CHGVAR     VAR(&D) VALUE('*AND FJBZNA *EQ "' *CAT + +
                         &CARRIER *CAT '"')                   */
  /*PIO*/    CHGVAR     VAR(&D) VALUE(' AND FJBZNA  =  "' *CAT +
                         &CARRIER *CAT '"')
             ENDDO


             CHGVAR     VAR(&Q) VALUE(&A *BCAT &B *BCAT &D)

/*  RUN QUERY TO READ LOAD HEADER BY DATE RANGE  */

   /*PIO     OVRDBF     FILE(OMFJCPLR) SHARE(*YES)   +
             OPNQRYF    FILE(OMFJCPLR) +             +
                        QRYSLT(&Q) +                 +
                        KEYFLD(*FILE)               */

  /*PIO*/    OVRDBF     FILE(OMFJCPP) TOFILE(OMFJCPP) LVLCHK(*NO)
             OPNSQLF    SQL('Select * from OMFJCPP Where ' *BCAT &Q +
                          *BCAT ' ORDER BY FJBZNA ASC, FJF9DT ASC') +
                          OPNID(OMFJCPLR) OPTION(*ALL) SEQONLY(*NO) +
                          RCDFMT(@FJCPV2) ALWCPY(*IFRQD) /*PIO*/
  /*PIO*/    OVRDBF     FILE(OMFJCPLR) TOFILE(OMFJCPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

/********************************************************************/
/* OVERRIDE PRINTER FILE WITH USER SPECIFIED SELECTION VALUES       */
/********************************************************************/
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PDMNPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

/*********************************************************************/
/*   CALL PRINT PROGRAM -
/*********************************************************************/
             CALL       PGM(PDMNPFR) PARM(' ' &COMPANY &FRMDAT +
                          &THRDAT &CARRIER &COLLECT &STI +
                          &NSHNWSH &WHSE &SUMMARY)

/*********** CALL       PGM(PDMNPFR) PARM(' ' &COMPANY &FRMDAT +
                          &THRDAT &CARRIER &COLLECT &STI) ************/

/********    CALL       PGM(PDMNPFR) PARM(' ' &COMPANY &FRMDAT +
                          &THRDAT &CARRIER)        *******************/

/**********  CALL       PGM(PDMNPFR) PARM(' ' &COMPANY &FRMDAT +
                          &THRDAT &CARRIER)                ***********/

             CLOF       OPNID(OMFJCPLR)
    /*PIO    DLTOVR     FILE(OMFJCPLR)   */
             DLTOVR     FILE(OMFJCPLR) LVL(*JOB) /*PIO*/

 END:        ENDPGM
