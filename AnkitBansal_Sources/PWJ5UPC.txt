/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PWJ5UPC                                       */
/*  PROGRAM NAME:    PAYMENT PRODUCER EDIT                         */
/*  PROGRAMMER:      Brad Baden                                    */
/*  CREATE DATE:     12/16/2019  E15935                            */
/*                                                                 */
/*  FUNCTION:        This CL program is called from prompt screen  */
/*                   program PWJ4PVR.  This program will call      */
/*                   sequel view EDISUMSALL or EDISUMSSRC based    */
/*                   upon the Source Code value passed in.         */
/*                   If the Source Code is blank, all Source Codes */
/*                   valid for the company are listed in the       */
/*                   spreadsheet.  If the Source Code is not       */
/*                   blank, then only the one Source Code is       */
/*                   listed on the spreadsheet.                    */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*‚02/07/25 Jagdish INC :1036479    CM PROJECT: S036479             */
/*‚                 Add premise id to EDISUMSALL                    */
/*  xxx  TFS#xxxxx   mm/dd/yyy  TFS title......................... */
/*       xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx */
/*       xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&FDATEN &TDATEN &SOURCE &EMAIL +
                          &FDATETXT &TDATETXT)

             DCL        VAR(&FDATE)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&TDATE)     TYPE(*CHAR) LEN(7)
             DCL        VAR(&SOURCE)    TYPE(*CHAR) LEN(3)

             DCL        VAR(&FDATEN)    TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&TDATEN)    TYPE(*DEC)  LEN(7 0)
             DCL        VAR(&EMAIL)     TYPE(*CHAR) LEN(50)
             DCL        VAR(&TEXT)      TYPE(*CHAR) LEN(80)
             DCL        VAR(&FDATETXT)  TYPE(*CHAR) LEN(10)
             DCL        VAR(&TDATETXT)  TYPE(*CHAR) LEN(10)

             MONMSG     MSGID(CPF0000)

             /* Convert dates to alpha for EXECUTE command */
             CHGVAR     VAR(&FDATE) VALUE(&FDATEN)
             CHGVAR     VAR(&TDATE) VALUE(&TDATEN)

             SELECT

             /* Execute sequel view for all Company Source Codes     */
             WHEN       COND(&SOURCE *EQ '   ') THEN(DO)

               CHGVAR     VAR(&TEXT) VALUE('EDI Carcass Summary from ' +
                            *CAT &FDATETXT *CAT ' thru ' *CAT &TDATETXT +
                            *CAT ' for Source Code: *ALL')

/*‚02/07/25 Jagdish S036479                                         */
/*‚Added premise id to EDISUMS2                                     */
             EXECUTE    VIEW(EDISUMSALL) OUTFILE(QTEMP/EDISUMS1) +
                          SETVAR((&FDATE &FDATE) (&TDATE &TDATE))
             EXECUTE    VIEW(EDISUMS2) PCFMT(*XLS) RECIPIENT(&EMAIL) +
                          EMLMSG(&TEXT)

/*           EXECUTE    VIEW(EDISUMSALL) PCFMT(*XLS) +              */
/*                        RECIPIENT(&EMAIL) EMLMSG(&TEXT) +         */
/*                        SETVAR((&FDATE &FDATE) (&TDATE &TDATE))   */
/*‚02/07/25 Jagdish S036479                                         */

             ENDDO

             /* Execute sequel view for a single Company Source Code */
             WHEN       COND(&SOURCE *NE '   ') THEN(DO)

               CHGVAR     VAR(&TEXT) VALUE('EDI Carcass Summary from ' +
                            *CAT &FDATETXT *CAT ' thru ' *CAT &TDATETXT +
                            *CAT ' for Source Code: ' *CAT &SOURCE)

               EXECUTE    VIEW(EDISUMSSRC) PCFMT(*XLS) +
                            RECIPIENT(&EMAIL) EMLMSG(&TEXT) +
                            SETVAR((&FDATE &FDATE) (&TDATE &TDATE) +
                            (&SOURCE &SOURCE))
             ENDDO
             ENDSELECT

ENDIT:       ENDPGM
