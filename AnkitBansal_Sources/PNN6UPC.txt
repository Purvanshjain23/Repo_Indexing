/*********************************************************************/
/*     Program: PDQVUPC                                              */
/*       Title: Execute the command OVRPRTF W/OVERLAY PARM          */
/*        Date: 12/23/09                                             */
/* Description: - Construct the command string.                      */
/*              - Execute the command.                               */
/*                                                                   */
/*  Parameters:                                                      */
/*  Usage   Field       Field Description                            */
/*  -----   ---------   ------------------------------------------   */
/*    I     &PRTFILE    Printer File Name                            */
/*    I     &OUTQ       Output Queue                                 */
/*    I     &HOLD       Hold Flag                                    */
/*    I     &SAVE       Save Flag                                    */
/*    I     &COPY       Number of Copies                             */
/*    I     &OVERL      FRONT OVERLAY                                */
/*                                                                   */
/*********************************************************************/
/* Modifications:                                                    */
/*                                                                   */
/*   Date     Pgmr     Description                                   */
/* -------- ---------- --------------------------------------------  */
/* 7/18/19    T14912 - CHG FOR SEABOARD ENERGY BOLS - TEXT CHG - OFFSET OVL */
/*            IF PGM IS PMO7PFR   SCAN:PRTHPB                        */
/* 9/13/19    T15460 - ADD PARM FOR BACK OVERLAY FOR PMO7PFR$, ADD TO     */
/*                     OVRPRTF                                       */
/*********************************************************************/
             PGM  PARM(&PRTFILE &OUTQ &HOLD &SAVE &COPY &OVERL &OVERBK)

   /*-------------------*/
   /* Declare Variables */
   /*-------------------*/

             /* Parameter Fields */
             DCL  VAR(&PRTFILE) TYPE(*CHAR) LEN(10)
             DCL  VAR(&OVERL)   TYPE(*CHAR) LEN(8)
             DCL  VAR(&OVERBK)   TYPE(*CHAR) LEN(8)   /* BACKSIDE OVERLAY  */
             DCL  VAR(&OUTQ)    TYPE(*CHAR) LEN(10)
             DCL  VAR(&HOLD)    TYPE(*CHAR) LEN(4)
             DCL  VAR(&SAVE)    TYPE(*CHAR) LEN(4)
             DCL  VAR(&COPY)    TYPE(*CHAR) LEN(2)

             /* Internal Work Fields */
             DCL  VAR(&COPYN)   TYPE(*DEC)  LEN(2 0)

   /*-----------------------------*/
   /* Initialize & Load Variables */
   /*-----------------------------*/
             CHGVAR VAR(&COPYN)   VALUE(&COPY)

   /*-----------------------*/
   /* Override Printer File */
   /*-----------------------*/
  IF COND(&PRTFILE *EQ 'PMO7PFR$') THEN(DO)
             OVRPRTF    FILE(&PRTFILE) DUPLEX(*YES) FRONTOVL(&OVERL +
                          .3 .3) BACKOVL(&OVERBK 0 0 *CONSTANT) +
                          OUTQ(&OUTQ) COPIES(&COPYN) HOLD(&HOLD) +
                          SAVE(&SAVE) OVRSCOPE(*JOB)
                          GOTO ENDPGM
                          ENDDO
             OVRPRTF    FILE(&PRTFILE) FRONTOVL(&OVERL) OUTQ(&OUTQ) +
                          COPIES(&COPYN) HOLD(&HOLD) SAVE(&SAVE) +
                          OVRSCOPE(*JOB)

   /*----------------*/
   /* End of Program */
   /*----------------*/
ENDPGM:
             ENDPGM
