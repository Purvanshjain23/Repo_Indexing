// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBPZXFR
// ?Date: 14.08.2025 Time: 03:48:53
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(Rtv Format PrdLoc Ordr RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC2100483;
PARAMETER(JOB.*Job_date);
{
 //?USER: Process Data record

 //?Format DP location for ship to and upd comp cust ext
 CASE;

 // IF DB1.Header Status is Not cancelled
 IF DB1.Header_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

 EXECUTE FUNCTION(RTV Parent Customer    RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1225254;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.Parent_Customer);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv CCE Class ABC-DP  RT) TYPE(RTVOBJ) FILE(PDNIREP)           AC2097330;
 PARAMETER(LCL.Parent_Customer);
 PARAMETER(LCL.CCE_Classification_ABC);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv DP Location 15    RT) TYPE(RTVOBJ) FILE(PDNIREP)           AC2100485;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.DP_Location_15);
 PARAMETER(NLL.CCE_Classification_ABC);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.DP Location 15 is Not Entered
 IF LCL.DP_Location_15 = *BLANK;

 EXECUTE FUNCTION(RTV Country Code only  RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1531787;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(LCL.Export_Country_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  CASE;

  // IF DB1.Detail Line Status is Not cancelled
  IF DB1.Detail_Line_Status = 'L'/'A'/'C'/'R'/'E'/'H'/'I';

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

  ENDIF;

 }

 EXECUTE FUNCTION(RTV Type              RT) TYPE(RTVOBJ) FILE(PMAMREP)           AC2100377;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(LCL.SH_Order_Sales_Channel);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // Call program Exc Format PrdLoc f/Or XF.
 CALL PROGRAM(Exc Format PrdLoc f/Or XF) ('PBPPXFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(LCL.Parent_Customer);
 PARAMETER(DB1.Ship_To_State_Code);
 PARAMETER(DB1.Export_Status);
 PARAMETER(LCL.Export_Country_Code);
 PARAMETER(LCL.SH_Order_Sales_Channel);
 PARAMETER(LCL.DP_Location);
 PARAMETER(LCL.DP_Type_Code_USR);
 PARAMETER(LCL.DP_Region_Txt_USR);

 // LCL.DP Location 15 = LCL.DP Location
 LCL.DP_Location_15 = LCL.DP_Location;

 CASE;

 // IF LCL.DP Location is Entered
 IF LCL.DP_Location <> *BLANK;

 EXECUTE FUNCTION(Rtv/Upd DP Location   RT) TYPE(RTVOBJ) FILE(PDNIREP)           AC2100458;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(LCL.DP_Location_15);
 PARAMETER(LCL.CCE_Classification_ABC);
 {
  //?USER: Process Data record

  CASE;

  // IF PAR.DP Location 15 NE DB1.DP Location 15
  IF PAR.DP_Location_15 <> DB1.DP_Location_15;

  // OR PAR.CCE Classification ABC NE DB1.CCE Classification ABC
  OR PAR.CCE_Classification_ABC <> DB1.CCE_Classification_ABC;

  EXECUTE FUNCTION(Chg DP Location      CH) TYPE(CHGOBJ) FILE(PDNIREP)            AC2100457;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(PAR.DP_Location_15);
  PARAMETER(PAR.CCE_Classification_ABC);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

 }

 ENDIF;

 ENDIF;

 ENDIF;

}


