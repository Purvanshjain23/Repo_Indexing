     H/TITLE CLC Avg Days to Pay    XF Execute external functio
     H            Y
     Z* CRTRPGPGM
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : SYNON/2  Version:  1204
     H* Function type : Execute external function
      *
     H* Company       : DWS Model V2.2 S3.1 Ship -Development-
     H* System        : DWS Version 2.2 Synon 3.1 Ship
     H* User name     : ISSWICH
     H* Date          : 07/18/96  Time  : 16:40:14
     H* Copyright     : DWS Model V2.2 S3.1 Ship -Development-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: A/R Summary
      * I :  MTD Invoices Paid
     I                                    P   1   30P1ADPM
      * I :  YTD Invoices Paid
     I                                    P   4   60P1VOVA
      * I :  MTD Days Paid
     I                                    P   7   90P1BTDY
      * I :  YTD Days Paid
     I                                    P  10  120P1BUDY
     IP2PARM      DS
      * N :  MTD Avg Days to Pay Calc
     I                                    P   1   56P2ELPC
     IP3PARM      DS
      * N :  YTD Avg Days to Pay Calc
     I                                    P   1   56P3EMPC
     IP4PARM      DS
      * O :  MTD Avg Days to Pay
     I                                    P   1   32P4EJPC
     IP5PARM      DS
      * O :  YTD Avg Days to Pay
     I                                    P   1   32P5EKPC
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1ADPM    PARM           WP0001  50       MTD Invoices Pa
     C           P1VOVA    PARM           WP0002  50       YTD Invoices Pa
     C           P1BTDY    PARM           WP0003  50       MTD Days Paid
     C           P1BUDY    PARM           WP0004  50       YTD Days Paid
     C           P4EJPC    PARM P4EJPC    WP0005  52       MTD Avg Days to
     C           P5EKPC    PARM P5EKPC    WP0006  52       YTD Avg Days to
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CLC Avg Days to Pay    XF
      * Calculating Avg Days to Pay
      * Calculating MTD Avg Days to Pay
      * CASE: PAR.MTD Invoices Paid is Not zero
     C           P1ADPM    IFNE *ZERO                      *IF
     C           P1BTDY    DIV  P1ADPM    P2ELPC    H      MTD Avg Days to
     C           P2ELPC    MULT 1         P4EJPC    H      MTD Avg Days to
     C                     END                             *FI
      * Calculating YTD Avg Days to Pay
      * CASE: PAR.YTD Invoices Paid is Not Equal to Zero
     C           P1VOVA    IFNE *ZERO                      *IF
     C           P1BUDY    DIV  P1VOVA    P3EMPC    H      YTD Avg Days to
     C           P3EMPC    MULT 1         P5EKPC    H      YTD Avg Days to
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2ELPC           MTD Avg Days to
     C                     Z-ADD*ZERO     P3EMPC           YTD Avg Days to
      *
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
