      *****************  RPG PROGRAM HEADING  ************************
      *
      * SYSTEM:      Hog Production
      * PROGRAM:     HP962
      * TITLE:       Calc Purge Date/Year/Period
      * PROGRAMMER:  LeAnne Ramsey
      * CREATED:     04/15/08
      *
      *
      * FUNCTION:    Calculate purge date/year/period.
      *              This program is conditionally called when:
      *               1) the purge was submitted on-demand with no Purge Date
      *
      /EJECT
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * DATE      PROGRAMMER
      *
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
      *
      /EJECT
      ****************************************************************
      * Definition specifications
      ****************************************************************
      *
      *---------------------------------------------------------------
      * STANDALONE FIELDS
      *---------------------------------------------------------------
      *
      * Workfields
      *
     D wkyr            s              4  0
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      *---------------------------------------------------------------
      * Local data area.
      *---------------------------------------------------------------
      *
     Dlda             uds                  dtaara(*lda)
     D  lddt                   1      8  0
     D  ldyr                   9     12  0
     D  ldpe                  13     14  0
      *
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ******************************************************************************
      * Mainline
      ******************************************************************************
      *
      * We want to keep 3 calendar years of HPS data on the System.
      * So, we will always purge through a December 31.
      * All we have to do here is find the "year" to purge thru.
      *
     C                   move      *year         wkyr
     C                   sub       4             wkyr
     C     10000         mult      wkyr          lddt
     C                   add       1231          lddt
      *
     C                   z-add     wkyr          ldyr
     C                   z-add     12            ldpe
      *
      *
     C                   seton                                        lr
      /EJECT
      *---------------------------------------------------------------
      * Initialization
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Parm lists
      *  None
      *
      * Initialize LDA.
     C                   z-add     0             lddt
     C                   z-add     0             ldyr
     C                   z-add     0             ldpe
      *
     C                   endsr
      /EJECT
