     H/TITLE Prt Eval/Loss Excepts PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 02/02/21  Time  : 13:01:32
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPL5IF  E           K        DISK
      * RSQ : Tattoo Header             Shft/Kill/Err/Tatto
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKB6CPL4IF  E           K        DISK
      * RSQ : Eval/Loss Error           Tattoo Header Erros Only
      *
     FPKBVCPL7IF  E           K        DISK
      * RSQ : Evl By Ttto/E/B Dec Hot W
      *
     FPKB6CPL3IF  E           K        DISK
      * RSQ : Eval/Loss Error           Eval Errors only
      *
     FPKBSCPL2IF  E           K        DISK
      * RSQ : Loss Trans                By Tattoo Errors Only
      *
     FPKBPREL0IF  E           K        DISK
      * RTV : Loss Type                 Retrieval index
      *
     FPKBRREL1IF  E           K        DISK
      * RTV : Loss Reason               Retrieval index
      *
     FPKB6CPL5IF  E           K        DISK
      * RSQ : Eval/Loss Error           Loss Errors Only
      *
     FPKCQCPL6IF  E           K        DISK
      * RSQ : Eval Trans Invalid UPL    Co/Kill/Shift
      *
     FPKENCPL1IF  E           K        DISK
      * RTV : Eval Trans Totals         Retrieval index
      *
     FPKENCPL0UF  E           K        DISK                      A
      * UPD : Eval Trans Totals         Update index
      *
     FPKLIPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Eval/Loss Excepts PF  Print file
      *
     I@B6CPLW
      * Eval/Loss Error           Eval Errors only
      * Renamed input format fields
     I              B6HRNB                          WAHRNB
     I              B6BPDT                          WABPDT
     I              B6IRNB                          WAIRNB
     I              B6BONM                          WABONM
     I              B6LDNM                          WALDNM
     I              B6FPNB                          WAFPNB
     I              B6DYST                          WADYST
     I              B6DXST                          WADXST
     I              B6B7TX                          WAB7TX
     I              B6AAVN                          WAAAVN
     I              B6AADT                          WAAADT
     I              B6AMTM                          WAAMTM
     I              B6AJST                          WAAJST
     I              B6AHVN                          WAAHVN
     I              B6AGVN                          WAAGVN
     I              B6ABVN                          WAABVN
     I              B6ABDT                          WAABDT
     I              B6ABTM                          WAABTM
      *
     I@B6CPNN
      * Eval/Loss Error           Loss Errors Only
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
     I@ENCPCS
      * Eval Trans Totals         Update index
      * Renamed input format fields
     I              ENESCO                          WCESCO
     I              ENDTDT                          WCDTDT
     I              ENTTST                          WCTTST
     I              ENTCUP                          WCTCUP
     I              ENTVUP                          WCTVUP
     I              ENTVBA                          WCTVBA
     I              ENTVEX                          WCTVEX
     I              ENTEUP                          WCTEUP
     I              ENUNHD                          WCUNHD
     I              ENUNH2                          WCUNH2
     I              ENAAVN                          WCAAVN
     I              ENAADT                          WCAADT
     I              ENAMTM                          WCAMTM
     I              ENAJST                          WCAJST
     I              ENAHVN                          WCAHVN
     I              ENAGVN                          WCAGVN
     I              ENABVN                          WCABVN
     I              ENABDT                          WCABDT
     I              ENABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKEN1    E DSPKENCPL0
      * UPD : Eval Trans Totals         Update index
      * Renamed input format fields
     I              ENESCO                          WCESCO
     I              ENDTDT                          WCDTDT
     I              ENTTST                          WCTTST
     I              ENTCUP                          WCTCUP
     I              ENTVUP                          WCTVUP
     I              ENTVBA                          WCTVBA
     I              ENTVEX                          WCTVEX
     I              ENTEUP                          WCTEUP
     I              ENUNHD                          WCUNHD
     I              ENUNH2                          WCUNH2
     I              ENAAVN                          WCAAVN
     I              ENAADT                          WCAADT
     I              ENAMTM                          WCAMTM
     I              ENAJST                          WCAJST
     I              ENAHVN                          WCAHVN
     I              ENAGVN                          WCAGVN
     I              ENABVN                          WCABVN
     I              ENABDT                          WCABDT
     I              ENABTM                          WCABTM
      *
     IYARDCS      DS                             92
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS                             11
      * KEY: Tattoo Header             Shft/Kill/Err/Tatto
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST TH Schedule Kill Shift
     I                                        3   3 P1LIST
      * I : RST TH Kill Date
     I                                    P   4   70P1B0DT
      * I : POS TH Kill Balancing Sts
     I                                        8   8 P1DWST
     IP2PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * I :  Execution Location    USR
     I                                        1   1 P3TUST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Tattoo Hea
     C           P2EVTX    PARM           WP0001 40        Oms System Valu
     C           P3TUST    PARM           WP0002  1        Execution Locat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Eval/Loss Excepts PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$QENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Eval/Loss Excepts PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
     C           *LIKE     DEFN A1LIST    WQKA02           TH Schedule Kil
     C           *LIKE     DEFN A1B0DT    WQKA03           TH Kill Date
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           WQKA02           TH Schedule Kil
     C                     KFLD           WQKA03           TH Kill Date
     C                     KFLD           A1DWST           TH Kill Balanci
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           WQKA02           TH Schedule Kil
     C                     KFLD           WQKA03           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
     C                     MOVELP1LIST    WQKA02           TH Schedule Kil
     C                     Z-ADDP1B0DT    WQKA03           TH Kill Date
     C                     MOVELP1DWST    A1DWST           TH Kill Balanci
      * Establish starting position
     C           KPSA      SETLL@A1CPHN                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Schedule Kil
     C                     MOVEL'Y'       W0AL02  1        TH Kill Date
     C                     MOVEL'Y'       W0AL03  1        TH Kill Balanci
     C                     MOVEL'Y'       W0AL04  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $PF0NB           Number of Error
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDA1HMNB    $OHMNB           BOH Company Num
     C                     MOVELA1LIST    $OLIST           TH Schedule Kil
     C                     Z-ADD*ZERO     $OTVBA           ES Total Valid
     C                     Z-ADD*ZERO     $OTVEX           ES Total Valid
     C                     Z-ADD*ZERO     $OTVUP           ES Total Valid
     C                     Z-ADD*ZERO     $OTEUP           ES Total Errors
     C                     Z-ADD*ZERO     $OTCUP           ES Total Carcs
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     MOVELA1LIST    $DLIST           TH Schedule Kil
     C                     Z-ADD*ZERO     $DCGDT           Kill Date Usr
     C                     MOVEL*BLANK    $DA4TX           Producer Name
     C                     Z-ADDA1BNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $DBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $DCVNB           TH Tattoo Numbe
     C                     Z-ADDA1AWDT    $DAWDT           TH Purchase Dat
     C                     Z-ADDA1B0DT    $DB0DT           TH Kill Date
     C                     MOVELA1BECD    $DBECD           HC Class Code
     C                     MOVELA1BDCD    $DBDCD           DF Defect Code
     C                     MOVELA1CSCD    $DCSCD           THP Process Cod
     C                     MOVEL*BLANK    $DEMTX           Kill Balance De
     C                     MOVELA1BICD    $DBICD           TH Group Refere
     C                     MOVELA1CPST    $DCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $DACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $DB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $DCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $DC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $DAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $DA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $DC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $DCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    $DCWNB           TH Head Receive
     C                     Z-ADDA1FCNB    $DFCNB           TH Yard Deads
     C                     Z-ADDA1FDNB    $DFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $DF6NB           Net Head Usr
     C                     Z-ADDA1FENB    $DFENB           TH Head Killed
     C                     Z-ADDA1LRNB    $DLRNB           TH Adj Live Wgt
     C                     Z-ADDA1H9NB    $DH9NB           TH Held Over
     C                     Z-ADDA1AWPC    $DAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $DCWPC           TH Adj Actual Y
     C                     Z-ADDA1HENB    $DHENB           TH Head Adds
     C                     Z-ADDA1J9NB    $DJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $DD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $DD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $DD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $DD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $DEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $DEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $DECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $DEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $DEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $DEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $DEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $DEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $DKAST           TH Source Type
     C                     MOVELA1J7ST    $DJ7ST           TH Scale Ticket
     C                     MOVELA1J8ST    $DJ8ST           TH Posted to HP
     C                     MOVELA1LJST    $DLJST           TH Shift Held O
     C                     MOVELA1NZTX    $DNZTX           TH State
     C                     MOVELA1HJCD    $DHJCD           TH Unused Code
     C                     MOVELA1R4ST    $DR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $DR5ST           TH Commission S
     C                     MOVELA1R6ST    $DR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $DR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $DTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $DT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $DTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $DT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $DOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $DKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $DOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $DOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $DIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $DOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $DOQET           TH PHA Add Type
     C                     MOVELA1URST    $DURST           TH PHA Average
     C                     MOVELA1USST    $DUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $DHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $DS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $DTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $DTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $DJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $DKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $DKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $DKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $DKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $DOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $DIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $DIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $DIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $DKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $DOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $DKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $DORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $DOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $DMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $DMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $DNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $DNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $DIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $DKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $DEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $DEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $DECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $DEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $DEEDT           TH Unused Date
     C                     MOVELA1U4ST    $DU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $DU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $DU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $DU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $DU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $DU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $DVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $DVBST           TH Unused Sts 8
     C                     MOVELA1J9ST    $DJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    $DOXNB           TH HPS Movement
     C                     MOVELA1LKST    $DLKST           TH Source Code
     C                     MOVELA1LLST    $DLLST           TH Hog Class Ty
     C                     Z-ADDA1HFNB    $DHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $DCYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    $DE0NB           TH Hot Wgt
     C                     Z-ADDA1FBNB    $DFBNB           TH Tot Backfat
     C                     Z-ADDA1A5PC    $DA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     $DATPC           @Lean %
     C                     Z-ADDA1A7PC    $DA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $DB8PR           TH CM Market Pr
     C                     Z-ADDA1A4PC    $DA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $DF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    $DHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F2NB    $DF2NB           TH Avg Backfat
     C                     Z-ADDA1F3NB    $DF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F4NB    $DF4NB           TH Avg Lean Per
     C                     Z-ADDA1F5NB    $DF5NB           TH Avg Light Re
     C                     Z-ADDA1AVPC    $DAVPC           TH Std Yield Pe
     C                     Z-ADDA1A8PC    $DA8PC           TH Yield Differ
     C                     Z-ADDA1AMPR    $DAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    $DANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $DAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $DAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $DAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $DAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $DAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $DASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $DA4VA           TH Total Net WO
     C                     Z-ADDA1A5VA    $DA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $DCBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    $DCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $DLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $DCDPR           TH Freight Amou
     C                     Z-ADDA1ATPR    $DATPR           TH Carcass Net
     C                     Z-ADDA1A7VA    $DA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $DA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $DJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $DCWST           TH Payment Sts
     C                     MOVELA1D7ST    $DD7ST           TH Header Error
     C                     MOVELA1D8ST    $DD8ST           TH Detail Error
     C                     MOVELA1DWST    $DDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $DD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $DGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $DBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $DE0ST           TH User Error O
     C                     MOVELA1E1ST    $DE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $DE2ST           TH Sex
     C                     Z-ADDA1BSDT    $DBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $DBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $DBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $DHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $DHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $DHINB           TH FFLI
     C                     Z-ADDA1A3PR    $DA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $DA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $DA6PR           TH Render Produ
     C                     MOVELA1AGCD    $DAGCD           GN Genetic Code
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
     C                     MOVELA1AECD    $DAECD           PL Location Cod
     C                     MOVELA1ACCD    $DACCD           HB Buyer Code
     C                     MOVELA1AAVN    $DAAVN           RS User Changed
     C                     Z-ADDA1AADT    $DAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $DAMTM           RS Time Changed
     C                     MOVELA1AJST    $DAJST           RS Record Statu
     C                     MOVELA1AHVN    $DAHVN           RS Job
     C                     MOVELA1AGVN    $DAGVN           RS Program
     C                     MOVELA1ABVN    $DABVN           RS User Added
     C                     Z-ADDA1ABDT    $DABDT           RS Date Added
     C                     Z-ADDA1ABTM    $DABTM           RS Time Added
      * USER: Process before print of detail format
      * CASE: LCL.First Time Flag Usr is No
     C           YL0001    IFEQ 'N'                        *IF
      * Only print tattoos that have a Balancing Error
      * CASE: DB1.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       W0NEWP           *Print New Page
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0NEWP           *Print New Page
     C                     END                             *FI
     C                     END                             *FI
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Header Errs PO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Evaluation Except PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Loss Error Except PO
     C                     EXSR UESUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1LIST    WZA002           TH Schedule Kil
     C                     MOVELA1LIST    WZA002
     C           *LIKE     DEFN A1B0DT    WZA003           TH Kill Date
     C                     Z-ADDA1B0DT    WZA003
     C           *LIKE     DEFN A1DWST    WZA004           TH Kill Balanci
     C                     MOVELA1DWST    WZA004
     C           *LIKE     DEFN A1CVNB    WZA005           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPHN                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE: PAR.TH Kill Balancing Sts is Not Balanced Record
     C           P1DWST    IFEQ *BLANK                     *IF
      * Select all records if the Par is blank
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     ELSE
      * CASE: *OTHERWISE
      * Force End of file
      * CASE: DB1.TH Kill Balancing Sts GT PAR.TH Kill Balancing Sts
     C           A1DWST    IFGT P1DWST                     *IF
      * EOF File A            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFA           END OF FILE
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        TH Schedule Kil
     C                     MOVEL*BLANK    W0AL02  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL03  1        TH Kill Balanci
     C                     MOVEL*BLANK    W0AL04  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Schedule Kil
     C                     MOVEL'Y'       W0AL02  1        TH Kill Date
     C                     MOVEL'Y'       W0AL03  1        TH Kill Balanci
     C                     MOVEL'Y'       W0AL04  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1LIST    IFNE WZA002                     TH Schedule Kil
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1B0DT    IFNE WZA003                     TH Kill Date
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1DWST    IFNE WZA004                     TH Kill Balanci
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           A1CVNB    IFNE WZA005                     TH Tattoo Numbe
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL04    IFEQ 'Y'
      * USER: On print of TH Tattoo Number format
      * CASE: WRK.Error Type 1 Usr is Yes
     C           WUGSNB    IFEQ 'Y'                        *IF
     C                     ADD  1         WUF0NB           Number of Error
     C                     END                             *FI
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Schedule Kill Shift format
      * CASE: PAR.Execution Location    USR is Upload
     C           P3TUST    IFEQ 'U'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
      * Rtv Evl Trn InvUpl CntRT - Eval Trans Invalid UPL  * 
     C                     EXSR SDRVGN
     C           WUTVUP    ADD  WUTEUP    $OTCUP           ES Total Carcs
     C                     Z-ADDWUTEUP    $OTEUP           ES Total Errors
     C                     Z-ADDWUTVBA    $OTVBA           ES Total Valid
     C                     Z-ADDWUTVEX    $OTVEX           ES Total Valid
     C                     Z-ADDWUTVUP    $OTVUP           ES Total Valid
      * Rtv/Chg/Crt Evl Total RT - Eval Trans Totals  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 13
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Print format
     C                     WRITE$OKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * USER: On print of BOH Company Number format
     C                     Z-ADDWUF0NB    $PF0NB           Number of Error
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * This format always starts a new page
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
      * Print format
     C                     WRITE$PFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Header Errs PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN B6HRNB    WQKB01           KV Company Numb
     C           *LIKE     DEFN B6BPDT    WQKB02           KV Kill Date
     C           *LIKE     DEFN B6IRNB    WQKB03           KV TATTOO NUMBE
     C           *LIKE     DEFN B6BONM    WQKB04           KV Buy Order Nu
     C           *LIKE     DEFN B6LDNM    WQKB05           KV Load Number
     C           *LIKE     DEFN B6FPNB    WQKB06           KV Record Numbe
     C           *LIKE     DEFN B6DYST    WQKB07           KV Record Type
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           KV Company Numb
     C                     KFLD           WQKB02           KV Kill Date
     C                     KFLD           WQKB03           KV TATTOO NUMBE
     C                     KFLD           WQKB04           KV Buy Order Nu
     C                     KFLD           WQKB05           KV Load Number
     C                     KFLD           WQKB06           KV Record Numbe
     C                     KFLD           WQKB07           KV Record Type
      * Setup key
     C                     Z-ADDA1HMNB    WQKB01           KV Company Numb
     C                     Z-ADDA1B0DT    WQKB02           KV Kill Date
     C                     Z-ADDA1CVNB    WQKB03           KV TATTOO NUMBE
     C                     Z-ADDA1BNNB    WQKB04           KV Buy Order Nu
     C                     Z-ADDA1BONB    WQKB05           KV Load Number
     C                     Z-ADD999999    WQKB06           KV Record Numbe
     C                     MOVEL'H'       WQKB07           KV Record Type
      * Establish starting position
     C           KRSB      SETLL@B6CPLX                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        KV Company Numb
     C                     MOVEL'Y'       W0BL01  1        KV Kill Date
     C                     MOVEL'Y'       W0BL02  1        KV TATTOO NUMBE
     C                     MOVEL'Y'       W0BL03  1        KV Buy Order Nu
     C                     MOVEL'Y'       W0BL04  1        KV Load Number
     C                     MOVEL'Y'       W0BL05  1        KV Record Numbe
     C                     MOVEL'Y'       W0BL06  1        KV Record Type
     C                     MOVEL'Y'       W0BL07  1        KV Error Code
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP06  1
     C                     END
      *
     C           W0BL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP07  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDB6HRNB    $EHRNB           KV Company Numb
     C                     Z-ADDB6BPDT    $EBPDT           KV Kill Date
     C                     Z-ADDB6IRNB    $EIRNB           KV TATTOO NUMBE
     C                     Z-ADDB6BONM    $EBONM           KV Buy Order Nu
     C                     Z-ADDB6LDNM    $ELDNM           KV Load Number
     C                     Z-ADDB6FPNB    $EFPNB           KV Record Numbe
     C                     MOVELB6DXST    $EDXST           KV Error Code
     C                     MOVELB6DYST    $EDYST           KV Record Type
     C                     MOVELB6B7TX    $EB7TX           KV Error Descri
     C                     MOVELB6AAVN    $EAAVN           RS User Changed
     C                     Z-ADDB6AADT    $EAADT           RS Date Changed
     C                     Z-ADDB6AMTM    $EAMTM           RS Time Changed
     C                     MOVELB6AJST    $EAJST           RS Record Statu
     C                     MOVELB6AHVN    $EAHVN           RS Job
     C                     MOVELB6AGVN    $EAGVN           RS Program
     C                     MOVELB6ABVN    $EABVN           RS User Added
     C                     Z-ADDB6ABDT    $EABDT           RS Date Added
     C                     Z-ADDB6ABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN B6HRNB    WZB001           KV Company Numb
     C                     Z-ADDB6HRNB    WZB001
     C           *LIKE     DEFN B6BPDT    WZB002           KV Kill Date
     C                     Z-ADDB6BPDT    WZB002
     C           *LIKE     DEFN B6IRNB    WZB003           KV TATTOO NUMBE
     C                     Z-ADDB6IRNB    WZB003
     C           *LIKE     DEFN B6BONM    WZB004           KV Buy Order Nu
     C                     Z-ADDB6BONM    WZB004
     C           *LIKE     DEFN B6LDNM    WZB005           KV Load Number
     C                     Z-ADDB6LDNM    WZB005
     C           *LIKE     DEFN B6FPNB    WZB006           KV Record Numbe
     C                     Z-ADDB6FPNB    WZB006
     C           *LIKE     DEFN B6DYST    WZB007           KV Record Type
     C                     MOVELB6DYST    WZB007
     C           *LIKE     DEFN B6DXST    WZB008           KV Error Code
     C                     MOVELB6DXST    WZB008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@B6CPLX                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        KV Company Numb
     C                     MOVEL*BLANK    W0BL01  1        KV Kill Date
     C                     MOVEL*BLANK    W0BL02  1        KV TATTOO NUMBE
     C                     MOVEL*BLANK    W0BL03  1        KV Buy Order Nu
     C                     MOVEL*BLANK    W0BL04  1        KV Load Number
     C                     MOVEL*BLANK    W0BL05  1        KV Record Numbe
     C                     MOVEL*BLANK    W0BL06  1        KV Record Type
     C                     MOVEL*BLANK    W0BL07  1        KV Error Code
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        KV Company Numb
     C                     MOVEL'Y'       W0BL01  1        KV Kill Date
     C                     MOVEL'Y'       W0BL02  1        KV TATTOO NUMBE
     C                     MOVEL'Y'       W0BL03  1        KV Buy Order Nu
     C                     MOVEL'Y'       W0BL04  1        KV Load Number
     C                     MOVEL'Y'       W0BL05  1        KV Record Numbe
     C                     MOVEL'Y'       W0BL06  1        KV Record Type
     C                     MOVEL'Y'       W0BL07  1        KV Error Code
     C                     ELSE
      * Next record - Detect level breaks
     C           B6HRNB    IFNE WZB001                     KV Company Numb
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           B6BPDT    IFNE WZB002                     KV Kill Date
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           B6IRNB    IFNE WZB003                     KV TATTOO NUMBE
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           B6BONM    IFNE WZB004                     KV Buy Order Nu
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           B6LDNM    IFNE WZB005                     KV Load Number
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           B6FPNB    IFNE WZB006                     KV Record Numbe
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C           B6DYST    IFNE WZB007                     KV Record Type
     C           W0BL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL06
     C                     END
     C           B6DXST    IFNE WZB008                     KV Error Code
     C           W0BL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL07
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP07
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP06
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$FFINTTL
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Evaluation Except PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQKC04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQKC05           TH Kill Date
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
     C                     KFLD           WQKC05           TH Kill Date
      * Setup key
     C                     Z-ADD$DHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$DBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$DBONB    WQKC03           BOL Load Number
     C                     Z-ADD$DCVNB    WQKC04           TH Tattoo Numbe
     C                     Z-ADD$DB0DT    WQKC05           TH Kill Date
      * Establish starting position
     C           KRSC      SETLL@BVCPL7                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     MOVEL'Y'       W0CL05  1        ET Error Sts
     C                     MOVEL'Y'       W0CL06  1        ET Hot Wgt
     C                     MOVEL'Y'       W0CL07  1        ET Carcass Numb
     C                     MOVEL'Y'       W0CL08  1        ET Carcass Numb
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBVHSNB    $GHSNB           ET Company Numb
     C                     Z-ADDBVA9DT    $GA9DT           ET Kill Date
     C                     Z-ADDBVFJNB    $GFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    $GHCNB           ET Carcass Numb
     C                     Z-ADDBVGDNB    $GGDNB           ET Carcass Numb
     C                     MOVELBVEAST    $GEAST           ET Shift
     C                     Z-ADDBVFINB    $GFINB           ET Tattoo Numbe
     C                     Z-ADDBVAMPC    $GAMPC           ET Hot Wgt
     C                     Z-ADDBVAIPC    $GAIPC           ET Backfat Thic
     C                     Z-ADDBVAJPC    $GAJPC           ET Loin-Eye Dep
     C                     Z-ADDBVAKPC    $GAKPC           ET Lean Percent
     C                     Z-ADDBVALPC    $GALPC           ET Light Reflec
     C                     MOVELBVDIST    $GDIST           ET Trim Area
     C                     MOVELBVFYST    $GFYST           ET Carcass Sex
     C                     MOVELBVD2ST    $GD2ST           ET Error Sts
     C                     MOVELBVEHST    $GEHST           ET Record Add/D
     C                     MOVELBVG1ST    $GG1ST           ET Record Creat
     C                     MOVELBVH4ST    $GH4ST           ET Record Creat
     C                     Z-ADDBVHMNB    $GHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDBVBONB    $GBONB           BOL Load Number
     C                     Z-ADDBVCVNB    $GCVNB           TH Tattoo Numbe
     C                     Z-ADDBVB0DT    $GB0DT           TH Kill Date
     C                     MOVELBVAAVN    $GAAVN           RS User Changed
     C                     Z-ADDBVAADT    $GAADT           RS Date Changed
     C                     Z-ADDBVAMTM    $GAMTM           RS Time Changed
     C                     MOVELBVAJST    $GAJST           RS Record Statu
     C                     MOVELBVAHVN    $GAHVN           RS Job
     C                     MOVELBVAGVN    $GAGVN           RS Program
     C                     MOVELBVABVN    $GABVN           RS User Added
     C                     Z-ADDBVABDT    $GABDT           RS Date Added
     C                     Z-ADDBVABTM    $GABTM           RS Time Added
     C                     Z-ADDBVB8DT    $GB8DT           RU Date
     C                     Z-ADDBVAOTM    $GAOTM           RU Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP05  1
     C                     END
      *
     C           W0CL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP06  1
     C                     END
      *
     C           W0CL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP07  1
     C                     END
      *
     C           W0CL08    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP08  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBVHSNB    $HHSNB           ET Company Numb
     C                     Z-ADDBVA9DT    $HA9DT           ET Kill Date
     C                     Z-ADDBVFJNB    $HFJNB           ET Scale Sequen
     C                     Z-ADDBVHCNB    $HHCNB           ET Carcass Numb
     C                     MOVELBVD2ST    $HD2ST           ET Error Sts
     C                     MOVELBVG1ST    $HG1ST           ET Record Creat
     C                     MOVELBVH4ST    $HH4ST           ET Record Creat
     C                     MOVELBVJLST    $HJLST           ET User Error O
     C                     MOVELBVUUST    $HUUST           ET Adjust/Add T
     C                     MOVELBVVHST    $HVHST           ET Broken Back
     C                     MOVELBVVIST    $HVIST           ET Unused Sts 2
     C                     MOVELBVVJST    $HVJST           ET Adjust/Add S
     C                     MOVELBVVKST    $HVKST           ET Unused Sts 4
     C                     MOVELBVVLST    $HVLST           ET Unused Sts 5
     C                     Z-ADDBVB0DT    $HB0DT           TH Kill Date
     C                     MOVELBVEHST    $HEHST           ET Record Add/D
     C                     Z-ADDBVGDNB    $HGDNB           ET Carcass Numb
     C                     Z-ADDBVFINB    $HFINB           ET Tattoo Numbe
     C                     Z-ADDBVLKNB    $HLKNB           ET Lot
     C                     MOVELBVEAST    $HEAST           ET Shift
     C                     MOVELBVDIST    $HDIST           ET Trim Area
     C                     MOVELBVFYST    $HFYST           ET Carcass Sex
     C                     Z-ADDBVAMPC    $HAMPC           ET Hot Wgt
     C                     Z-ADDBVAIPC    $HAIPC           ET Backfat Thic
     C                     Z-ADDBVAJPC    $HAJPC           ET Loin-Eye Dep
     C                     Z-ADDBVALPC    $HALPC           ET Light Reflec
     C                     Z-ADDBVFXPC    $HFXPC           ET Lean Percent
     C                     Z-ADDBVX8NB    $HX8NB           ET Backfat Thic
     C                     Z-ADDBVFVPC    $HFVPC           ET Loineye Dept
     C                     Z-ADDBVFWPC    $HFWPC           ET Light Reflec
     C                     Z-ADDBVAKPC    $HAKPC           ET Lean Percent
     C                     Z-ADDBVHMNB    $HHMNB           BOH Company Num
     C                     Z-ADDBVBNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDBVBONB    $HBONB           BOL Load Number
     C                     Z-ADDBVCVNB    $HCVNB           TH Tattoo Numbe
     C                     MOVELBVAAVN    $HAAVN           RS User Changed
     C                     Z-ADDBVAADT    $HAADT           RS Date Changed
     C                     Z-ADDBVAMTM    $HAMTM           RS Time Changed
     C                     MOVELBVAJST    $HAJST           RS Record Statu
     C                     MOVELBVAHVN    $HAHVN           RS Job
     C                     MOVELBVAGVN    $HAGVN           RS Program
     C                     MOVELBVABVN    $HABVN           RS User Added
     C                     Z-ADDBVABDT    $HABDT           RS Date Added
     C                     Z-ADDBVABTM    $HABTM           RS Time Added
     C                     Z-ADDBVB8DT    $HB8DT           RU Date
     C                     Z-ADDBVAOTM    $HAOTM           RU Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt By Tattoo Error   PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BVHMNB    WZC001           BOH Company Num
     C                     Z-ADDBVHMNB    WZC001
     C           *LIKE     DEFN BVBNNB    WZC002           BOH Buy Order N
     C                     Z-ADDBVBNNB    WZC002
     C           *LIKE     DEFN BVBONB    WZC003           BOL Load Number
     C                     Z-ADDBVBONB    WZC003
     C           *LIKE     DEFN BVCVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDBVCVNB    WZC004
     C           *LIKE     DEFN BVB0DT    WZC005           TH Kill Date
     C                     Z-ADDBVB0DT    WZC005
     C           *LIKE     DEFN BVD2ST    WZC006           ET Error Sts
     C                     MOVELBVD2ST    WZC006
     C           *LIKE     DEFN BVAMPC    WZC007           ET Hot Wgt
     C                     Z-ADDBVAMPC    WZC007
     C           *LIKE     DEFN BVHCNB    WZC008           ET Carcass Numb
     C                     Z-ADDBVHCNB    WZC008
     C           *LIKE     DEFN BVGDNB    WZC009           ET Carcass Numb
     C                     Z-ADDBVGDNB    WZC009
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@BVCPL7                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0CL04  1        TH Kill Date
     C                     MOVEL*BLANK    W0CL05  1        ET Error Sts
     C                     MOVEL*BLANK    W0CL06  1        ET Hot Wgt
     C                     MOVEL*BLANK    W0CL07  1        ET Carcass Numb
     C                     MOVEL*BLANK    W0CL08  1        ET Carcass Numb
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0CL04  1        TH Kill Date
     C                     MOVEL'Y'       W0CL05  1        ET Error Sts
     C                     MOVEL'Y'       W0CL06  1        ET Hot Wgt
     C                     MOVEL'Y'       W0CL07  1        ET Carcass Numb
     C                     MOVEL'Y'       W0CL08  1        ET Carcass Numb
     C                     ELSE
      * Next record - Detect level breaks
     C           BVHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           BVBNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           BVBONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           BVCVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           BVB0DT    IFNE WZC005                     TH Kill Date
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C           BVD2ST    IFNE WZC006                     ET Error Sts
     C           W0CL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL05
     C                     END
     C           BVAMPC    IFNE WZC007                     ET Hot Wgt
     C           W0CL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL06
     C                     END
     C           BVHCNB    IFNE WZC008                     ET Carcass Numb
     C           W0CL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL07
     C                     END
     C           BVGDNB    IFNE WZC009                     ET Carcass Numb
     C           W0CL07    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL08
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL08    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP08
     C                     END
      *
     C           W0CL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP07
     C                     END
      *
     C           W0CL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP06
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP05
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Evaluation Error  PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHRNB    WQKD01           KV Company Numb
     C           *LIKE     DEFN WABPDT    WQKD02           KV Kill Date
     C           *LIKE     DEFN WAIRNB    WQKD03           KV TATTOO NUMBE
     C           *LIKE     DEFN WABONM    WQKD04           KV Buy Order Nu
     C           *LIKE     DEFN WALDNM    WQKD05           KV Load Number
     C           *LIKE     DEFN WAFPNB    WQKD06           KV Record Numbe
     C           *LIKE     DEFN WADYST    WQKD07           KV Record Type
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           KV Company Numb
     C                     KFLD           WQKD02           KV Kill Date
     C                     KFLD           WQKD03           KV TATTOO NUMBE
     C                     KFLD           WQKD04           KV Buy Order Nu
     C                     KFLD           WQKD05           KV Load Number
     C                     KFLD           WQKD06           KV Record Numbe
     C                     KFLD           WQKD07           KV Record Type
      * Setup key
     C                     Z-ADDBVHSNB    WQKD01           KV Company Numb
     C                     Z-ADDBVA9DT    WQKD02           KV Kill Date
     C                     Z-ADDBVFINB    WQKD03           KV TATTOO NUMBE
     C                     Z-ADDBVBNNB    WQKD04           KV Buy Order Nu
     C                     Z-ADDBVBONB    WQKD05           KV Load Number
     C                     Z-ADDBVFJNB    WQKD06           KV Record Numbe
     C                     MOVEL'E'       WQKD07           KV Record Type
      * Establish starting position
     C           KRSD      SETLL@B6CPLW                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        KV Company Numb
     C                     MOVEL'Y'       W0DL01  1        KV Kill Date
     C                     MOVEL'Y'       W0DL02  1        KV TATTOO NUMBE
     C                     MOVEL'Y'       W0DL03  1        KV Buy Order Nu
     C                     MOVEL'Y'       W0DL04  1        KV Load Number
     C                     MOVEL'Y'       W0DL05  1        KV Record Numbe
     C                     MOVEL'Y'       W0DL06  1        KV Record Type
     C                     MOVEL'Y'       W0DL07  1        KV Error Code
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP04  1
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP05  1
     C                     END
      *
     C           W0DL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP06  1
     C                     END
      *
     C           W0DL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP07  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAHRNB    $IHRNB           KV Company Numb
     C                     Z-ADDWABPDT    $IBPDT           KV Kill Date
     C                     Z-ADDWAIRNB    $IIRNB           KV TATTOO NUMBE
     C                     Z-ADDWABONM    $IBONM           KV Buy Order Nu
     C                     Z-ADDWALDNM    $ILDNM           KV Load Number
     C                     Z-ADDWAFPNB    $IFPNB           KV Record Numbe
     C                     MOVELWADXST    $IDXST           KV Error Code
     C                     MOVELWADYST    $IDYST           KV Record Type
     C                     MOVELWAB7TX    $IB7TX           KV Error Descri
     C                     MOVELWAAAVN    $IAAVN           RS User Changed
     C                     Z-ADDWAAADT    $IAADT           RS Date Changed
     C                     Z-ADDWAAMTM    $IAMTM           RS Time Changed
     C                     MOVELWAAJST    $IAJST           RS Record Statu
     C                     MOVELWAAHVN    $IAHVN           RS Job
     C                     MOVELWAAGVN    $IAGVN           RS Program
     C                     MOVELWAABVN    $IABVN           RS User Added
     C                     Z-ADDWAABDT    $IABDT           RS Date Added
     C                     Z-ADDWAABTM    $IABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAHRNB    WZD001           KV Company Numb
     C                     Z-ADDWAHRNB    WZD001
     C           *LIKE     DEFN WABPDT    WZD002           KV Kill Date
     C                     Z-ADDWABPDT    WZD002
     C           *LIKE     DEFN WAIRNB    WZD003           KV TATTOO NUMBE
     C                     Z-ADDWAIRNB    WZD003
     C           *LIKE     DEFN WABONM    WZD004           KV Buy Order Nu
     C                     Z-ADDWABONM    WZD004
     C           *LIKE     DEFN WALDNM    WZD005           KV Load Number
     C                     Z-ADDWALDNM    WZD005
     C           *LIKE     DEFN WAFPNB    WZD006           KV Record Numbe
     C                     Z-ADDWAFPNB    WZD006
     C           *LIKE     DEFN WADYST    WZD007           KV Record Type
     C                     MOVELWADYST    WZD007
     C           *LIKE     DEFN WADXST    WZD008           KV Error Code
     C                     MOVELWADXST    WZD008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@B6CPLW                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        KV Company Numb
     C                     MOVEL*BLANK    W0DL01  1        KV Kill Date
     C                     MOVEL*BLANK    W0DL02  1        KV TATTOO NUMBE
     C                     MOVEL*BLANK    W0DL03  1        KV Buy Order Nu
     C                     MOVEL*BLANK    W0DL04  1        KV Load Number
     C                     MOVEL*BLANK    W0DL05  1        KV Record Numbe
     C                     MOVEL*BLANK    W0DL06  1        KV Record Type
     C                     MOVEL*BLANK    W0DL07  1        KV Error Code
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        KV Company Numb
     C                     MOVEL'Y'       W0DL01  1        KV Kill Date
     C                     MOVEL'Y'       W0DL02  1        KV TATTOO NUMBE
     C                     MOVEL'Y'       W0DL03  1        KV Buy Order Nu
     C                     MOVEL'Y'       W0DL04  1        KV Load Number
     C                     MOVEL'Y'       W0DL05  1        KV Record Numbe
     C                     MOVEL'Y'       W0DL06  1        KV Record Type
     C                     MOVEL'Y'       W0DL07  1        KV Error Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WAHRNB    IFNE WZD001                     KV Company Numb
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           WABPDT    IFNE WZD002                     KV Kill Date
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           WAIRNB    IFNE WZD003                     KV TATTOO NUMBE
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           WABONM    IFNE WZD004                     KV Buy Order Nu
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C           WALDNM    IFNE WZD005                     KV Load Number
     C           W0DL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL04
     C                     END
     C           WAFPNB    IFNE WZD006                     KV Record Numbe
     C           W0DL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL05
     C                     END
     C           WADYST    IFNE WZD007                     KV Record Type
     C           W0DL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL06
     C                     END
     C           WADXST    IFNE WZD008                     KV Error Code
     C           W0DL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL07
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP07
     C                     END
      *
     C           W0DL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP06
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP05
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP04
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$JFINTTL
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt Loss Error Except PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN BSHUNB    WQKE01           LTN Company Num
     C           *LIKE     DEFN BSA7DT    WQKE02           LTN Kill Date
     C           *LIKE     DEFN BSBNNB    WQKE03           BOH Buy Order N
     C           *LIKE     DEFN BSBONB    WQKE04           BOL Load Number
     C           *LIKE     DEFN BSCVNB    WQKE05           TH Tattoo Numbe
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           LTN Company Num
     C                     KFLD           WQKE02           LTN Kill Date
     C                     KFLD           WQKE03           BOH Buy Order N
     C                     KFLD           WQKE04           BOL Load Number
     C                     KFLD           WQKE05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$DHMNB    WQKE01           LTN Company Num
     C                     Z-ADD$DB0DT    WQKE02           LTN Kill Date
     C                     Z-ADD$DBNNB    WQKE03           BOH Buy Order N
     C                     Z-ADD$DBONB    WQKE04           BOL Load Number
     C                     Z-ADD$DCVNB    WQKE05           TH Tattoo Numbe
      * Establish starting position
     C           KRSE      SETLL@BSCPGU                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        LTN Company Num
     C                     MOVEL'Y'       W0EL01  1        LTN Kill Date
     C                     MOVEL'Y'       W0EL02  1        BOH Buy Order N
     C                     MOVEL'Y'       W0EL03  1        BOL Load Number
     C                     MOVEL'Y'       W0EL04  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0EL05  1        LTN Record Numb
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDBSHUNB    $KHUNB           LTN Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP03  1
     C                     END
      *
     C           W0EL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP04  1
     C                     END
      *
     C           W0EL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP05  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDBSHUNB    $LHUNB           LTN Company Num
     C                     Z-ADDBSA7DT    $LA7DT           LTN Kill Date
     C                     Z-ADDBSFHNB    $LFHNB           LTN Record Numb
     C                     Z-ADDBSFFNB    $LFFNB           LTN Tattoo Numb
     C                     MOVELBSEBST    $LEBST           LTN Shift
     C                     Z-ADDBSDSNB    $LDSNB           LTN Wgt
     C                     Z-ADDBSBWCD    $LBWCD           LT Type Code
     C                     MOVEL*BLANK    $LCCTX           LT Description
     C                     MOVELBSS3NB    $LS3NB           LTN Extent
     C                     MOVEL*BLANK    $LFETX           Ext Req Desc Us
     C                     MOVELBSS4NB    $LS4NB           LTN Trim Locati
     C                     MOVEL*BLANK    $LJUTX           Trim Loc Req De
     C                     Z-ADDBSBYCD    $LBYCD           LR Reason Code
     C                     MOVEL*BLANK    $LBYTX           LR Description
     C                     MOVELBSD1ST    $LD1ST           LTN Error Sts
     C                     MOVELBSH5ST    $LH5ST           LTN Record Crea
     C                     MOVELBSJMST    $LJMST           LTN User Error
     C                     MOVELBSSMST    $LSMST           LTN Source Type
     C                     Z-ADDBSHMNB    $LHMNB           BOH Company Num
     C                     Z-ADDBSBNNB    $LBNNB           BOH Buy Order N
     C                     Z-ADDBSBONB    $LBONB           BOL Load Number
     C                     Z-ADDBSCVNB    $LCVNB           TH Tattoo Numbe
     C                     Z-ADDBSB0DT    $LB0DT           TH Kill Date
     C                     MOVELBSAAVN    $LAAVN           RS User Changed
     C                     Z-ADDBSAADT    $LAADT           RS Date Changed
     C                     Z-ADDBSAMTM    $LAMTM           RS Time Changed
     C                     MOVELBSAJST    $LAJST           RS Record Statu
     C                     MOVELBSAHVN    $LAHVN           RS Job
     C                     MOVELBSAGVN    $LAGVN           RS Program
     C                     MOVELBSABVN    $LABVN           RS User Added
     C                     Z-ADDBSABDT    $LABDT           RS Date Added
     C                     Z-ADDBSABTM    $LABTM           RS Time Added
     C                     Z-ADDBSB8DT    $LB8DT           RU Date
     C                     Z-ADDBSAOTM    $LAOTM           RU Time
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Loss Error        PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN BSHUNB    WZE001           LTN Company Num
     C                     Z-ADDBSHUNB    WZE001
     C           *LIKE     DEFN BSA7DT    WZE002           LTN Kill Date
     C                     Z-ADDBSA7DT    WZE002
     C           *LIKE     DEFN BSBNNB    WZE003           BOH Buy Order N
     C                     Z-ADDBSBNNB    WZE003
     C           *LIKE     DEFN BSBONB    WZE004           BOL Load Number
     C                     Z-ADDBSBONB    WZE004
     C           *LIKE     DEFN BSCVNB    WZE005           TH Tattoo Numbe
     C                     Z-ADDBSCVNB    WZE005
     C           *LIKE     DEFN BSFHNB    WZE006           LTN Record Numb
     C                     Z-ADDBSFHNB    WZE006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@BSCPGU                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        LTN Company Num
     C                     MOVEL*BLANK    W0EL01  1        LTN Kill Date
     C                     MOVEL*BLANK    W0EL02  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0EL03  1        BOL Load Number
     C                     MOVEL*BLANK    W0EL04  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0EL05  1        LTN Record Numb
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        LTN Company Num
     C                     MOVEL'Y'       W0EL01  1        LTN Kill Date
     C                     MOVEL'Y'       W0EL02  1        BOH Buy Order N
     C                     MOVEL'Y'       W0EL03  1        BOL Load Number
     C                     MOVEL'Y'       W0EL04  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0EL05  1        LTN Record Numb
     C                     ELSE
      * Next record - Detect level breaks
     C           BSHUNB    IFNE WZE001                     LTN Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           BSA7DT    IFNE WZE002                     LTN Kill Date
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           BSBNNB    IFNE WZE003                     BOH Buy Order N
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C           BSBONB    IFNE WZE004                     BOL Load Number
     C           W0EL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL03
     C                     END
     C           BSCVNB    IFNE WZE005                     TH Tattoo Numbe
     C           W0EL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL04
     C                     END
     C           BSFHNB    IFNE WZE006                     LTN Record Numb
     C           W0EL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL05
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP05
     C                     END
      *
     C           W0EL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP04
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP03
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * Prt Loss Error        PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHRNB    WQKF01           KV Company Numb
     C           *LIKE     DEFN WBBPDT    WQKF02           KV Kill Date
     C           *LIKE     DEFN WBIRNB    WQKF03           KV TATTOO NUMBE
     C           *LIKE     DEFN WBBONM    WQKF04           KV Buy Order Nu
     C           *LIKE     DEFN WBLDNM    WQKF05           KV Load Number
     C           *LIKE     DEFN WBFPNB    WQKF06           KV Record Numbe
     C           *LIKE     DEFN WBDYST    WQKF07           KV Record Type
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           KV Company Numb
     C                     KFLD           WQKF02           KV Kill Date
     C                     KFLD           WQKF03           KV TATTOO NUMBE
     C                     KFLD           WQKF04           KV Buy Order Nu
     C                     KFLD           WQKF05           KV Load Number
     C                     KFLD           WQKF06           KV Record Numbe
     C                     KFLD           WQKF07           KV Record Type
      * Setup key
     C                     Z-ADD$LHUNB    WQKF01           KV Company Numb
     C                     Z-ADD$LA7DT    WQKF02           KV Kill Date
     C                     Z-ADD$LFFNB    WQKF03           KV TATTOO NUMBE
     C                     Z-ADD$LBNNB    WQKF04           KV Buy Order Nu
     C                     Z-ADD$LBONB    WQKF05           KV Load Number
     C                     Z-ADD$LFHNB    WQKF06           KV Record Numbe
     C                     MOVEL'L'       WQKF07           KV Record Type
      * Establish starting position
     C           KRSF      SETLL@B6CPNN                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        KV Company Numb
     C                     MOVEL'Y'       W0FL01  1        KV Kill Date
     C                     MOVEL'Y'       W0FL02  1        KV TATTOO NUMBE
     C                     MOVEL'Y'       W0FL03  1        KV Buy Order Nu
     C                     MOVEL'Y'       W0FL04  1        KV Load Number
     C                     MOVEL'Y'       W0FL05  1        KV Record Numbe
     C                     MOVEL'Y'       W0FL06  1        KV Record Type
     C                     MOVEL'Y'       W0FL07  1        KV Error Code
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP02  1
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP03  1
     C                     END
      *
     C           W0FL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP04  1
     C                     END
      *
     C           W0FL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP05  1
     C                     END
      *
     C           W0FL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP06  1
     C                     END
      *
     C           W0FL07    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP07  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHRNB    $MHRNB           KV Company Numb
     C                     Z-ADDWBBPDT    $MBPDT           KV Kill Date
     C                     Z-ADDWBIRNB    $MIRNB           KV TATTOO NUMBE
     C                     Z-ADDWBBONM    $MBONM           KV Buy Order Nu
     C                     Z-ADDWBLDNM    $MLDNM           KV Load Number
     C                     Z-ADDWBFPNB    $MFPNB           KV Record Numbe
     C                     MOVELWBDXST    $MDXST           KV Error Code
     C                     MOVELWBDYST    $MDYST           KV Record Type
     C                     MOVELWBB7TX    $MB7TX           KV Error Descri
     C                     MOVELWBAAVN    $MAAVN           RS User Changed
     C                     Z-ADDWBAADT    $MAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $MAMTM           RS Time Changed
     C                     MOVELWBAJST    $MAJST           RS Record Statu
     C                     MOVELWBAHVN    $MAHVN           RS Job
     C                     MOVELWBAGVN    $MAGVN           RS Program
     C                     MOVELWBABVN    $MABVN           RS User Added
     C                     Z-ADDWBABDT    $MABDT           RS Date Added
     C                     Z-ADDWBABTM    $MABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHRNB    WZF001           KV Company Numb
     C                     Z-ADDWBHRNB    WZF001
     C           *LIKE     DEFN WBBPDT    WZF002           KV Kill Date
     C                     Z-ADDWBBPDT    WZF002
     C           *LIKE     DEFN WBIRNB    WZF003           KV TATTOO NUMBE
     C                     Z-ADDWBIRNB    WZF003
     C           *LIKE     DEFN WBBONM    WZF004           KV Buy Order Nu
     C                     Z-ADDWBBONM    WZF004
     C           *LIKE     DEFN WBLDNM    WZF005           KV Load Number
     C                     Z-ADDWBLDNM    WZF005
     C           *LIKE     DEFN WBFPNB    WZF006           KV Record Numbe
     C                     Z-ADDWBFPNB    WZF006
     C           *LIKE     DEFN WBDYST    WZF007           KV Record Type
     C                     MOVELWBDYST    WZF007
     C           *LIKE     DEFN WBDXST    WZF008           KV Error Code
     C                     MOVELWBDXST    WZF008
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@B6CPNN                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        KV Company Numb
     C                     MOVEL*BLANK    W0FL01  1        KV Kill Date
     C                     MOVEL*BLANK    W0FL02  1        KV TATTOO NUMBE
     C                     MOVEL*BLANK    W0FL03  1        KV Buy Order Nu
     C                     MOVEL*BLANK    W0FL04  1        KV Load Number
     C                     MOVEL*BLANK    W0FL05  1        KV Record Numbe
     C                     MOVEL*BLANK    W0FL06  1        KV Record Type
     C                     MOVEL*BLANK    W0FL07  1        KV Error Code
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        KV Company Numb
     C                     MOVEL'Y'       W0FL01  1        KV Kill Date
     C                     MOVEL'Y'       W0FL02  1        KV TATTOO NUMBE
     C                     MOVEL'Y'       W0FL03  1        KV Buy Order Nu
     C                     MOVEL'Y'       W0FL04  1        KV Load Number
     C                     MOVEL'Y'       W0FL05  1        KV Record Numbe
     C                     MOVEL'Y'       W0FL06  1        KV Record Type
     C                     MOVEL'Y'       W0FL07  1        KV Error Code
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHRNB    IFNE WZF001                     KV Company Numb
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           WBBPDT    IFNE WZF002                     KV Kill Date
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C           WBIRNB    IFNE WZF003                     KV TATTOO NUMBE
     C           W0FL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL02
     C                     END
     C           WBBONM    IFNE WZF004                     KV Buy Order Nu
     C           W0FL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL03
     C                     END
     C           WBLDNM    IFNE WZF005                     KV Load Number
     C           W0FL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL04
     C                     END
     C           WBFPNB    IFNE WZF006                     KV Record Numbe
     C           W0FL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL05
     C                     END
     C           WBDYST    IFNE WZF007                     KV Record Type
     C           W0FL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL06
     C                     END
     C           WBDXST    IFNE WZF008                     KV Error Code
     C           W0FL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL07
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL07    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP07
     C                     END
      *
     C           W0FL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP06
     C                     END
      *
     C           W0FL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP05
     C                     END
      *
     C           W0FL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP04
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP03
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP02
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$NFINTTL
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Print format
     C                     WRITE$C1STPAG
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print TH Schedule Kill Shift of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print TH Kill Date of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Kill Balancing Sts of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print TH Tattoo Number of Prt Eval/Loss Excepts PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print Detail line. of Prt Eval/Loss Excepts PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Only print tattoos that have a Balancing Error
      * CASE: DB1.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     MOVEL'N'       YL0001           First Time Flag
     C                     Z-ADD$DB0DT    $DCGDT           Kill Date Usr
      * CUR.Kill Balance Desc Usr = Condition name of CUR.TH Kill Balanci
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1104537   Y2LSNO  70       List number
     C                     PARM $DDWST    W0INVL 25        TH Kill Balanci
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DEMTX    PARM           W0CNNM 25        Kill Balance De
      *
     C                     MOVEL*BLANK    $DA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SARVGN
     C           A1CWNB    SUB  A1FCNB    $DF6NB           Net Head Usr
     C                     SUB  A1FDNB    $DF6NB           Net Head Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Kill Date Usr to display format
      * Convert date
     C           1000000   ADD  $DCGDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDCGDT
      * Convert TH Purchase Date to display format
      * Convert date
     C           1000000   ADD  $DAWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDAWDT
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $DB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDB0DT
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print KV Company Number of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print KV Kill Date of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print KV TATTOO NUMBER of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print KV Buy Order Number of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print KV Load Number of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print KV Record Number of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print KV Record Type of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP06
     C                     END                             FI
      * Print KV Error Code of Prt Tattoo Header Errs PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP07
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Header Errs PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       WUGSNB           Error Type 1 Us
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$ECOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$EDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of BOH Company Number format
      * CASE: PAR.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$GKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print TH Kill Date of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print ET Error Sts of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP05
     C                     END                             FI
      * Print ET Hot Wgt of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP06
     C                     END                             FI
      * Print ET Carcass Number of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP07
     C                     END                             FI
      * Print ET Carcass Number Insert of Prt Evaluation Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP08    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP08    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP08
     C                     END                             FI
      * Print Detail line. of Prt Evaluation Except PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     ADD  1         WUTVUP           ES Total Valid
      * CASE: DB1.ET Error Sts is Balance
     C           BVD2ST    IFEQ 'B'                        *IF
     C                     ADD  1         WUTVBA           ES Total Valid
     C                     ELSE
      * CASE: DB1.ET Error Sts is Error
     C           BVD2ST    IFEQ 'E'                        *IF
     C                     ADD  1         WUTVEX           ES Total Valid
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $HB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHB0DT
     C                     MOVEL'0'       *IN79
     C           $HD2ST    IFEQ 'E'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print KV Company Number of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print KV Kill Date of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print KV TATTOO NUMBER of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print KV Buy Order Number of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print KV Load Number of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP04
     C                     END                             FI
      * Print KV Record Number of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP05
     C                     END                             FI
      * Print KV Record Type of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP06
     C                     END                             FI
      * Print KV Error Code of Prt Evaluation Error  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP07
     C                     END                             FI
      * Print Detail line. of Prt Evaluation Error  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'Y'       WUGSNB           Error Type 1 Us
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print LTN Company Number of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of LTN Company Number format
      * CASE: PAR.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$KKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print LTN Kill Date of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print BOL Load Number of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP03
     C                     END                             FI
      * Print TH Tattoo Number of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP04
     C                     END                             FI
      * Print LTN Record Number of Prt Loss Error Except PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP05
     C                     END                             FI
      * Print Detail line. of Prt Loss Error Except PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.TH Kill Balancing Sts is Error
     C           A1DWST    IFEQ 'E'                        *IF
     C                     MOVEL'Y'       W0PFM            *Print format
     C                     MOVEL'Y'       W0NEWP           *Print New Page
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       W0NEWP           *Print New Page
     C                     END                             *FI
      * Rtv Loss Type Desc    RT - Loss Type  * 
     C                     EXSR SBRVGN
      * Rtv Loss Reason       RT - Loss Reason  * 
     C                     EXSR SCRVGN
      * CUR.Ext Req Desc Usr = Condition name of DB1.LTN Extent
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158533   Y2LSNO  70       List number
     C                     PARM BSS3NB    W0INVL 25        LTN Extent
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $LFETX    PARM           W0CNNM 25        Ext Req Desc Us
      *
      * CUR.Trim Loc Req Desc Usr = Condition name of DB1.LTN Trim Locati
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1158543   Y2LSNO  70       List number
     C                     PARM BSS4NB    W0INVL 25        LTN Trim Locati
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $LJUTX    PARM           W0CNNM 25        Trim Loc Req De
      *
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
     C                     MOVEL'0'       *IN79
     C           $LD1ST    IFEQ 'B'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$LCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$LDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print KV Company Number of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print KV Kill Date of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP01
     C                     END                             FI
      * Print KV TATTOO NUMBER of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP02
     C                     END                             FI
      * Print KV Buy Order Number of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP03
     C                     END                             FI
      * Print KV Load Number of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP04
     C                     END                             FI
      * Print KV Record Number of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP05
     C                     END                             FI
      * Print KV Record Type of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP06
     C                     END                             FI
      * Print KV Error Code of Prt Loss Error        PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP07    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP07
     C                     END                             FI
      * Print Detail line. of Prt Loss Error        PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'Y'       WUGSNB           Error Type 1 Us
     C           W0PFM     IFEQ 'Y'
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$MCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$MDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Eval/Loss Excepts PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Eval/Loss Excepts PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Schedule Kill Shift of Prt Eval/Loss Excepts PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Eval/Loss Excepts PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Balancing Sts of Prt Eval/Loss Excepts PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Eval/Loss Excepts PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Eval/Loss Excepts PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD17        W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Header Errs PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Company Number of Prt Tattoo Header Errs PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Kill Date of Prt Tattoo Header Errs PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV TATTOO NUMBER of Prt Tattoo Header Errs PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Buy Order Number of Prt Tattoo Header Errs PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Load Number of Prt Tattoo Header Errs PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Record Number of Prt Tattoo Header Errs PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Record Type of Prt Tattoo Header Errs PO
     C           W0BP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Error Code of Prt Tattoo Header Errs PO
     C           W0BP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Header Errs PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Evaluation Except PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Evaluation Except PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Evaluation Except PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Evaluation Except PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Evaluation Except PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Evaluation Except PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Error Sts of Prt Evaluation Except PO
     C           W0CP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Hot Wgt of Prt Evaluation Except PO
     C           W0CP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Carcass Number of Prt Evaluation Except PO
     C           W0CP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * ET Carcass Number Insert of Prt Evaluation Except PO
     C           W0CP08    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Evaluation Except PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD5         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Evaluation Error  PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Company Number of Prt Evaluation Error  PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Kill Date of Prt Evaluation Error  PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV TATTOO NUMBER of Prt Evaluation Error  PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Buy Order Number of Prt Evaluation Error  PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Load Number of Prt Evaluation Error  PO
     C           W0DP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Record Number of Prt Evaluation Error  PO
     C           W0DP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Record Type of Prt Evaluation Error  PO
     C           W0DP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Error Code of Prt Evaluation Error  PO
     C           W0DP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Evaluation Error  PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Loss Error Except PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * LTN Company Number of Prt Loss Error Except PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  2         W0FSUM
     C                     END                             FI
      *
      * * LTN Kill Date of Prt Loss Error Except PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Loss Error Except PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Loss Error Except PO
     C           W0EP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Loss Error Except PO
     C           W0EP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * LTN Record Number of Prt Loss Error Except PO
     C           W0EP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Loss Error Except PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Loss Error        PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Company Number of Prt Loss Error        PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Kill Date of Prt Loss Error        PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV TATTOO NUMBER of Prt Loss Error        PO
     C           W0FP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Buy Order Number of Prt Loss Error        PO
     C           W0FP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Load Number of Prt Loss Error        PO
     C           W0FP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Record Number of Prt Loss Error        PO
     C           W0FP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Record Type of Prt Loss Error        PO
     C           W0FP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * KV Error Code of Prt Loss Error        PO
     C           W0FP07    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Loss Error        PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$DABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSA     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    $DA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Loss Type Desc    RT - Loss Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BPBWCD           LT Type Code
      * Setup key
     C                     Z-ADD$LBWCD    BPBWCD           LT Type Code
      * Establish starting position
     C           KRSSB     CHAIN@BPREFB              90    *
      * Data record not found
     C   90                MOVEL'PRK0109' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBPCCTX    $LCCTX           LT Description
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           BRBYCD           LR Reason Code
      * Setup key
     C                     Z-ADD$LBYCD    BRBYCD           LR Reason Code
      * Establish starting position
     C           KRSSC     CHAIN@BRREFQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $LBYTX           LR Description
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBRBYTX    $LBYTX           LR Description
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Evl Trn InvUpl CntRT - Eval Trans Invalid UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN CQKMNB    WQSD01           EB Company Numb
     C           *LIKE     DEFN CQB9DT    WQSD02           EB Kill Date
     C           *LIKE     DEFN CQHOST    WQSD03           EB Shift
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           EB Company Numb
     C                     KFLD           WQSD02           EB Kill Date
     C                     KFLD           WQSD03           EB Shift
      * Setup key
     C                     Z-ADDP1HMNB    WQSD01           EB Company Numb
     C                     Z-ADDP1B0DT    WQSD02           EB Kill Date
     C                     MOVELP1LIST    WQSD03           EB Shift
      * Establish starting position
     C           KRSSD     SETLL@CQCPCU                    *
     C           KRSSD     READE@CQCPCU                  90*
      * Data record not found
     C   90                MOVEL'PRK0345' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUTEUP           ES Total Errors
     C           KRSSD     READE@CQCPCU                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv/Chg/Crt Evl Total RT - Eval Trans Totals  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ENESCO           ES Company Numb
     C                     KFLD           ENDTDT           ES Kill Date
     C                     KFLD           ENTTST           ES Shift
      * Setup key
     C                     Z-ADDP1HMNB    ENESCO           ES Company Numb
     C                     Z-ADDP1B0DT    ENDTDT           ES Kill Date
     C                     MOVELP1LIST    ENTTST           ES Shift
      * Establish starting position
     C           KRSSE     CHAIN@ENCPCT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0886' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Eval Trans Totals CR - Eval Trans Totals  * 
     C                     EXSR SFCRRC
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Eval Trans Totals CH - Eval Trans Totals  * 
     C                     EXSR SGCHRC
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Crt Eval Trans Totals CR - Eval Trans Totals  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ENCPCS
     C                     Z-ADDP1HMNB    WCESCO           ES Company Numb
     C                     Z-ADDP1B0DT    WCDTDT           ES Kill Date
     C                     MOVELP1LIST    WCTTST           ES Shift
     C                     Z-ADD$OTCUP    WCTCUP           ES Total Carcs
     C                     Z-ADD$OTVUP    WCTVUP           ES Total Valid
     C                     Z-ADD$OTVBA    WCTVBA           ES Total Valid
     C                     Z-ADD$OTVEX    WCTVEX           ES Total Valid
     C                     Z-ADD$OTEUP    WCTEUP           ES Total Errors
     C                     Z-ADD*ZERO     WCUNHD           ES Unused Head
     C                     Z-ADD*ZERO     WCUNH2           ES Unused Head
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSF    KLIST
     C                     KFLD           WCESCO           ES Company Numb
     C                     KFLD           WCDTDT           ES Kill Date
     C                     KFLD           WCTTST           ES Shift
      * Check for duplicate primary key
     C           KLCRSF    SETLL@ENCPCS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0887' W0RTN   7
      * Send message 'Eval Trans Totals      EX'
     C                     MOVEL'PRK0887' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@ENCPCS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg Eval Trans Totals CH - Eval Trans Totals  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ENCPCS
     C                     Z-ADDP1HMNB    WCESCO           ES Company Numb
     C                     Z-ADDP1B0DT    WCDTDT           ES Kill Date
     C                     MOVELP1LIST    WCTTST    P      ES Shift
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCESCO           ES Company Numb
     C                     KFLD           WCDTDT           ES Kill Date
     C                     KFLD           WCTTST           ES Shift
     C           KLCHSG    CHAIN@ENCPCS              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKENCPL0'MDACP
     C                     MOVEL'@ENCPCS' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKEN1    YARDCS
      * Move non-key fields to @ENCPCS
     C                     Z-ADD$OTCUP    WCTCUP           ES Total Carcs
     C                     Z-ADD$OTVUP    WCTVUP           ES Total Valid
     C                     Z-ADD$OTVBA    WCTVBA           ES Total Valid
     C                     Z-ADD$OTVEX    WCTVEX           ES Total Valid
     C                     Z-ADD$OTEUP    WCTEUP           ES Total Errors
     C                     Z-ADD*ZERO     WCUNHD           ES Unused Head
     C                     Z-ADD*ZERO     WCUNH2           ES Unused Head
     C                     MOVEL*BLANK    WCAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST    P      RS Record Statu
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
     C                     MOVEL##USR     WCABVN    P      RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKEN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKEN1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ENCPCS                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKENCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 01/23/2021 - Increased the length from 5 to 7 and corr
      *                         alignment of Buy Order Number field.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Header Errs PO
      *================================================================
      * Prt Tattoo Header Errs PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Evaluation Except PO
      *================================================================
      * Prt Evaluation Except PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt By Tattoo Error   PO
      *================================================================
      * Prt Evaluation Error  PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Loss Error Except PO
      *================================================================
      * Prt Loss Error Except PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Loss Error        PO
      *================================================================
      * Prt Loss Error        PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field ES Total Carcs Uploaded
     C                     Z-ADD*ZERO     WUTCUP  70
      * Define work field ES Total Errors Uploaded
     C                     Z-ADD*ZERO     WUTEUP  70
      * Define work field ES Total Valid Balanced
     C                     Z-ADD*ZERO     WUTVBA  70
      * Define work field ES Total Valid Exception
     C                     Z-ADD*ZERO     WUTVEX  70
      * Define work field ES Total Valid Uploaded
     C                     Z-ADD*ZERO     WUTVUP  70
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1LIST           TH Schedule Kil
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1DWST           TH Kill Balanci
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Define work field Error Type 1 Usr
     C                     MOVEL*BLANK    WUGSNB  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    B6HRNB           KV Company Numb
     C                     MOVEL*LOVAL    B6BPDT           KV Kill Date
     C                     MOVEL*LOVAL    B6IRNB           KV TATTOO NUMBE
     C                     MOVEL*LOVAL    B6BONM           KV Buy Order Nu
     C                     MOVEL*LOVAL    B6LDNM           KV Load Number
     C                     MOVEL*LOVAL    B6FPNB           KV Record Numbe
     C                     MOVEL*LOVAL    B6DYST           KV Record Type
     C                     MOVEL*LOVAL    B6DXST           KV Error Code
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BVHMNB           BOH Company Num
     C                     MOVEL*LOVAL    BVBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    BVBONB           BOL Load Number
     C                     MOVEL*LOVAL    BVCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    BVB0DT           TH Kill Date
     C                     MOVEL*HIVAL    BVD2ST           ET Error Sts
     C                     MOVEL*LOVAL    BVAMPC           ET Hot Wgt
     C                     MOVEL*LOVAL    BVHCNB           ET Carcass Numb
     C                     MOVEL*LOVAL    BVGDNB           ET Carcass Numb
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WABPDT           KV Kill Date
     C                     Z-ADD*ZERO     WAIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WABONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WALDNM           KV Load Number
     C                     Z-ADD*ZERO     WAFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAHRNB           KV Company Numb
     C                     MOVEL*LOVAL    WABPDT           KV Kill Date
     C                     MOVEL*LOVAL    WAIRNB           KV TATTOO NUMBE
     C                     MOVEL*LOVAL    WABONM           KV Buy Order Nu
     C                     MOVEL*LOVAL    WALDNM           KV Load Number
     C                     MOVEL*LOVAL    WAFPNB           KV Record Numbe
     C                     MOVEL*LOVAL    WADYST           KV Record Type
     C                     MOVEL*LOVAL    WADXST           KV Error Code
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    BSHUNB           LTN Company Num
     C                     MOVEL*LOVAL    BSA7DT           LTN Kill Date
     C                     MOVEL*LOVAL    BSBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    BSBONB           BOL Load Number
     C                     MOVEL*LOVAL    BSCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    BSFHNB           LTN Record Numb
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHRNB           KV Company Numb
     C                     MOVEL*LOVAL    WBBPDT           KV Kill Date
     C                     MOVEL*LOVAL    WBIRNB           KV TATTOO NUMBE
     C                     MOVEL*LOVAL    WBBONM           KV Buy Order Nu
     C                     MOVEL*LOVAL    WBLDNM           KV Load Number
     C                     MOVEL*LOVAL    WBFPNB           KV Record Numbe
     C                     MOVEL*LOVAL    WBDYST           KV Record Type
     C                     MOVEL*LOVAL    WBDXST           KV Error Code
      * Define work field Number of Errors Usr
     C                     Z-ADD*ZERO     WUF0NB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCESCO           ES Company Numb
     C                     Z-ADD*ZERO     WCDTDT           ES Kill Date
     C                     Z-ADD*ZERO     WCTCUP           ES Total Carcs
     C                     Z-ADD*ZERO     WCTVUP           ES Total Valid
     C                     Z-ADD*ZERO     WCTVBA           ES Total Valid
     C                     Z-ADD*ZERO     WCTVEX           ES Total Valid
     C                     Z-ADD*ZERO     WCTEUP           ES Total Errors
     C                     Z-ADD*ZERO     WCUNHD           ES Unused Head
     C                     Z-ADD*ZERO     WCUNH2           ES Unused Head
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0001  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    $ACMP
     C                     Z-ADD*ZERO     WUTCUP           ES Total Carcs
     C                     Z-ADD*ZERO     WUTEUP           ES Total Errors
     C                     Z-ADD*ZERO     WUTVBA           ES Total Valid
     C                     Z-ADD*ZERO     WUTVEX           ES Total Valid
     C                     Z-ADD*ZERO     WUTVUP           ES Total Valid
     C                     MOVEL'Y'       YL0001           First Time Flag
     C                     MOVEL'N'       W0NEWP           *Print New Page
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
