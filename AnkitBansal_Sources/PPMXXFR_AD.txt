// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPMXXFR
// ?Date: 14.08.2025 Time: 03:41:13
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV default Company    IF) TYPE(EXCINTFUN)                     AC1592222;
PARAMETER(PAR.Company_Number);
{
 //?Execute internal function

 EXECUTE FUNCTION(Rtv Profile Model     RT) TYPE(RTVOBJ) FILE(CADRREP)           AC1445577;
 PARAMETER(JOB.*USER);
 PARAMETER(PAR.User_Code_Model);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF PAR.User Code Model is equal to blank
 IF PAR.User_Code_Model = *BLANK;

 EXECUTE FUNCTION(RTV Appl. Default Co   RT) TYPE(RTVOBJ) FILE(CADTREP)          AC1143068;
 PARAMETER(JOB.*USER);
 PARAMETER('P/S');
 PARAMETER(PAR.Company_Number);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(RTV Appl. Default Co   RT) TYPE(RTVOBJ) FILE(CADTREP)          AC1143068;
 PARAMETER(PAR.User_Code_Model);
 PARAMETER('P/S');
 PARAMETER(PAR.Company_Number);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 ENDIF;

}


EXECUTE FUNCTION(PFS All Box           RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1732182;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Active_Status_Flag);
{
 //?USER: Process Data record

 // PGM.*Record selected = CND.*YES
 PGM.*Record_selected = 'Y';

 //?SEL:  Active Only or ALL
 CASE;

 // IF PAR.Active Status Flag is Active
 IF PAR.Active_Status_Flag = 'A';

 CASE;

 // IF DB1.Record Status is Not Active
 IF DB1.Record_Status = *BLANK/'D'/'I';

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 ENDIF;

 //?SEL:  Boxes Only
 CASE;

 // IF DB1.Package Type Code is Box Kit
 IF DB1.Package_Type_Code = 'B';

 //?SEL:  Boxes Only
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PGM.*Record selected = CND.*NO
 PGM.*Record_selected = 'N';

 ENDIF;

 //?Process Selected Record
 CASE;

 // IF PGM.*Record selected is *YES
 IF PGM.*Record_selected = 'Y';

 // PAR.PFS Company Number = DB1.Company Number
 PAR.PFS_Company_Number = DB1.Company_Number;

 // PAR.PFS Box ID = DB1.Item Code
 PAR.PFS_Box_ID = DB1.Item_Code;

 // PAR.PSF Box Description = DB1.Description Line One
 PAR.PSF_Box_Description = DB1.Description_Line_One;

 // PAR.PFS Unit Weight = DB1.Unit Weight
 PAR.PFS_Unit_Weight = DB1.Unit_Weight;

 //?PFS Record Status
 CASE;

 // IF DB1.Record Status is Active
 IF DB1.Record_Status = 'A';

 // PAR.PFS Record Status = CND.Change
 PAR.PFS_Record_Status = 'C';

 //?PFS Record Status
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.PFS Record Status = CND.Delete
 PAR.PFS_Record_Status = 'D';

 ENDIF;

 EXECUTE FUNCTION(Upd PFS Box           RT) TYPE(RTVOBJ) FILE(PPA7REP)           AC1732180;
 PARAMETER(PAR.PFS_Company_Number);
 PARAMETER(PAR.PFS_Box_ID);
 PARAMETER(PAR.PSF_Box_Description);
 PARAMETER(PAR.PFS_Unit_Weight);
 PARAMETER(PAR.PFS_Record_Status);
 {
  //?USER: Processing if Data record not found

  CASE;

  // IF PAR.PFS Record Status is Not Delete
  IF PAR.PFS_Record_Status = 'A'/'C';

  EXECUTE FUNCTION(Crt PFS Box           CR) TYPE(CRTOBJ) FILE(PPA7REP)           AC1732164;
  PARAMETER(PAR.PFS_Company_Number);
  PARAMETER(PAR.PFS_Box_ID);
  PARAMETER(PAR.PSF_Box_Description);
  PARAMETER(PAR.PFS_Unit_Weight);
  PARAMETER(PAR.PFS_Record_Status);
  PARAMETER(PAR.PFS_Process_Status);
  PARAMETER(PAR.PFS_Error_Reason);
  PARAMETER(PAR.PFS_Create_Date);
  PARAMETER(PAR.PFS_Create_Time);
  PARAMETER(PAR.PFS_Change_Date);
  PARAMETER(PAR.PFS_Change_Time);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Create Stamp      IF) TYPE(EXCINTFUN)                      AC1732162;
   PARAMETER(DB1.PFS_Process_Status);
   PARAMETER(DB1.PFS_Create_Date);
   PARAMETER(DB1.PFS_Create_Time);
   {
    //?Execute internal function

    // PAR.PFS Process Status = CND.Not Processed
    PAR.PFS_Process_Status = *ZERO;

    // PAR.PFS Create Date = JOB.*Job date
    PAR.PFS_Create_Date = JOB.*Job_date;

    // PAR.PFS Create Time = JOB.*Job time
    PAR.PFS_Create_Time = JOB.*Job_time;

   }

  }

  ENDIF;

  //?USER: Process Data record

  EXECUTE FUNCTION(Chg PFS Box           CH) TYPE(CHGOBJ) FILE(PPA7REP)           AC1732165;
  PARAMETER(PAR.PFS_Company_Number);
  PARAMETER(PAR.PFS_Box_ID);
  PARAMETER(PAR.PSF_Box_Description);
  PARAMETER(PAR.PFS_Unit_Weight);
  PARAMETER(PAR.PFS_Record_Status);
  PARAMETER(PAR.PFS_Error_Reason);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Change Stamp      IF) TYPE(EXCINTFUN)                      AC1732163;
   PARAMETER(DB1.PFS_Change_Date);
   PARAMETER(DB1.PFS_Change_Time);
   {
    //?Execute internal function

    // PAR.PFS Change Date = JOB.*Job date
    PAR.PFS_Change_Date = JOB.*Job_date;

    // PAR.PFS Change time = JOB.*Job time
    PAR.PFS_Change_Time = JOB.*Job_time;

   }

  }

 }

 ENDIF;

}


