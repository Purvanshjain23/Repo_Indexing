     H/TITLE WW JDE E1 Batches     DF  Display file
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.7.1 (1635)
     H* Function type : Display file
     H* Object type   : *PGM
      *
     H* Company       : E1IDEVMDL
     H* System        : E1IDEVMDL
     H* User name     : ISJMIST
     H* Date          : 11/08/24  Time  : 06:49:15
     H* Copyright     : E1IDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FE1K3DFR#  CF   E             WORKSTN
     F                                     SFILE(#SFLRCD:##RR)
     F                                     INFDS(INFDS#)
      * DSP: WW JDE E1 Batches     DF  Display file
      *
     FE10011L1  IF   E           K DISK
     F                                     INFDS(INFDS1)
      * RTV : Batch Control File F0011  Retrieval index
      *
     FE10411L1  IF   E           K DISK
      * RTV : Run Log Vchr Dtl   F0411  Retrieval index
      *
     FE10911L1  IF   E           K DISK
      * RTV : Run Log J/E Detail F0911  Retrieval index
      *
     FE10011L0  UF   E           K DISK
      * UPD : Batch Control File F0011  Update index
      *
     FE10411L0  UF   E           K DISK
      * UPD : Run Log Vchr Dtl   F0411  Update index
      *
     FE10911L0  UF   E           K DISK
      * UPD : Run Log J/E Detail F0911  Update index
      *
      * Days in month for date validation
     D @XD             S              2  0 DIM(12)CTDATA PERRCD(12)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
      * ABO DEFINE LARGE STRING FOR CL CMD
     D YARTCM          DS           512
     D  DUMMY1                 1      1
     D INFDS#        E DS                  EXTNAME(Y2I#DSP)
      * Display file information data structure
      *
     D INFDS1        E DS                  EXTNAME(Y2I1DSP)
      * File information data structure
      *
      /EJECT
     D XDEX            DS
      * External date
     D  XDEXDT                 1      8  0
     D  XDEY01                 1      4  0
     D  XDEX01                 1      2  0
     D  XDEX02                 3      4  0
     D  XDEY02                 5      8  0
     D  XDEX03                 5      6  0
     D  XDEX04                 7      8  0
      /EJECT
     D XDINT           DS
      * Internal date
     D  XDINDT                 1      7  0
     D  XDINYY                 1      3  0
     D  XDINMM                 4      5  0
     D  XDINDD                 6      7  0
      /EJECT
     D XTCK            DS
      * Time: hours, minutes, seconds
     D  XTTIM                  1      6  0
     D  XTHH                   1      2  0
     D  XTNN                   3      4  0
     D  XTSS                   5      6  0
      /EJECT
     D XDOFF           DS
      * Cut-off year
     D  XOFF                   1      4  0
     D  XOFFYY                 3      4  0
     D QE1001        E DS                  EXTNAME(E10011L0)
      * UPD : Batch Control File F0011  Update index
      * Renamed input format fields
     D  WAICUT       E                     EXTFLD(ICICUT)
     D  WAICU        E                     EXTFLD(ICICU)
     D  WAIST        E                     EXTFLD(ICIST)
     D  WAIAPP       E                     EXTFLD(ICIAPP)
     D  WAAICU       E                     EXTFLD(ICAICU)
     D  WAUSER       E                     EXTFLD(ICUSER)
     D  WADICJ       E                     EXTFLD(ICDICJ)
     D  WANDO        E                     EXTFLD(ICNDO)
     D  WABAL        E                     EXTFLD(ICBAL)
     D  WABALJ       E                     EXTFLD(ICBALJ)
     D  WAAME        E                     EXTFLD(ICAME)
     D  WADOCN       E                     EXTFLD(ICDOCN)
     D  WAAUSR       E                     EXTFLD(ICAUSR)
     D  WAPOB        E                     EXTFLD(ICPOB)
     D  WAIBOI       E                     EXTFLD(ICIBOI)
     D  WAAIPT       E                     EXTFLD(ICAIPT)
     D  WAOFFP       E                     EXTFLD(ICOFFP)
     D  WAPID        E                     EXTFLD(ICPID)
     D  WAJOBN       E                     EXTFLD(ICJOBN)
     D  WAUPMJ       E                     EXTFLD(ICUPMJ)
     D  WAUPTM       E                     EXTFLD(ICUPTM)
     D  WADRSP       E                     EXTFLD(ICDRSP)
     D  WAS2PP       E                     EXTFLD(ICS2PP)
     D  WACBP        E                     EXTFLD(ICCBP)
     D  WAO6TX       E                     EXTFLD(ICO6TX)
     D  WAO7TX       E                     EXTFLD(ICO7TX)
      *
     D YARDCS          DS           152
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
     D QE1041        E DS                  EXTNAME(E10411L0)
      * UPD : Run Log Vchr Dtl   F0411  Update index
      * Renamed input format fields
     D  WBEDUS       E                     EXTFLD(ELEDUS)
     D  WBEDBT       E                     EXTFLD(ELEDBT)
     D  WBEDTN       E                     EXTFLD(ELEDTN)
     D  WBEDLN       E                     EXTFLD(ELEDLN)
     D  WBEDTY       E                     EXTFLD(ELEDTY)
     D  WBEDSQ       E                     EXTFLD(ELEDSQ)
     D  WBEDCT       E                     EXTFLD(ELEDCT)
     D  WBEDTS       E                     EXTFLD(ELEDTS)
     D  WBEDFT       E                     EXTFLD(ELEDFT)
     D  WBEDDT       E                     EXTFLD(ELEDDT)
     D  WBEDER       E                     EXTFLD(ELEDER)
     D  WBEDDL       E                     EXTFLD(ELEDDL)
     D  WBEDSP       E                     EXTFLD(ELEDSP)
     D  WBEDTC       E                     EXTFLD(ELEDTC)
     D  WBEDTR       E                     EXTFLD(ELEDTR)
     D  WBEDGL       E                     EXTFLD(ELEDGL)
     D  WBEDDH       E                     EXTFLD(ELEDDH)
     D  WBEDAN       E                     EXTFLD(ELEDAN)
     D  WBKCO        E                     EXTFLD(ELKCO)
     D  WBDOC        E                     EXTFLD(ELDOC)
     D  WBDCT        E                     EXTFLD(ELDCT)
     D  WBSFX        E                     EXTFLD(ELSFX)
     D  WBSFXE       E                     EXTFLD(ELSFXE)
     D  WBDCTA       E                     EXTFLD(ELDCTA)
     D  WBAN8        E                     EXTFLD(ELAN8)
     D  WBPYE        E                     EXTFLD(ELPYE)
     D  WBSNTO       E                     EXTFLD(ELSNTO)
     D  WBDIVJ       E                     EXTFLD(ELDIVJ)
     D  WBDSVJ       E                     EXTFLD(ELDSVJ)
     D  WBDDJ        E                     EXTFLD(ELDDJ)
     D  WBDDNJ       E                     EXTFLD(ELDDNJ)
     D  WBDGJ        E                     EXTFLD(ELDGJ)
     D  WBFY         E                     EXTFLD(ELFY)
     D  WBCTRY       E                     EXTFLD(ELCTRY)
     D  WBPN         E                     EXTFLD(ELPN)
     D  WBCO         E                     EXTFLD(ELCO)
     D  WBICU        E                     EXTFLD(ELICU)
     D  WBICUT       E                     EXTFLD(ELICUT)
     D  WBDICJ       E                     EXTFLD(ELDICJ)
     D  WBBALJ       E                     EXTFLD(ELBALJ)
     D  WBPSTC       E                     EXTFLD(ELPSTC)
     D  WBAG         E                     EXTFLD(ELAG)
     D  WBAAP        E                     EXTFLD(ELAAP)
     D  WBADSC       E                     EXTFLD(ELADSC)
     D  WBADSA       E                     EXTFLD(ELADSA)
     D  WBATXA       E                     EXTFLD(ELATXA)
     D  WBATXN       E                     EXTFLD(ELATXN)
     D  WBSTAM       E                     EXTFLD(ELSTAM)
     D  WBTXA1       E                     EXTFLD(ELTXA1)
     D  WBEXR1       E                     EXTFLD(ELEXR1)
     D  WBCRRM       E                     EXTFLD(ELCRRM)
     D  WBCRCD       E                     EXTFLD(ELCRCD)
     D  WBCRR        E                     EXTFLD(ELCRR)
     D  WBACR        E                     EXTFLD(ELACR)
     D  WBFAP        E                     EXTFLD(ELFAP)
     D  WBCDS        E                     EXTFLD(ELCDS)
     D  WBCDSA       E                     EXTFLD(ELCDSA)
     D  WBCTXA       E                     EXTFLD(ELCTXA)
     D  WBCTXN       E                     EXTFLD(ELCTXN)
     D  WBCTAM       E                     EXTFLD(ELCTAM)
     D  WBGLC        E                     EXTFLD(ELGLC)
     D  WBGLBA       E                     EXTFLD(ELGLBA)
     D  WBPOST       E                     EXTFLD(ELPOST)
     D  WBAM         E                     EXTFLD(ELAM)
     D  WBAID2       E                     EXTFLD(ELAID2)
     D  WBMCU        E                     EXTFLD(ELMCU)
     D  WBOBJ        E                     EXTFLD(ELOBJ)
     D  WBSUB        E                     EXTFLD(ELSUB)
     D  WBSBLT       E                     EXTFLD(ELSBLT)
     D  WBSBL        E                     EXTFLD(ELSBL)
     D  WBBAID       E                     EXTFLD(ELBAID)
     D  WBPTC        E                     EXTFLD(ELPTC)
     D  WBVOD        E                     EXTFLD(ELVOD)
     D  WBOKCO       E                     EXTFLD(ELOKCO)
     D  WBODCT       E                     EXTFLD(ELODCT)
     D  WBODOC       E                     EXTFLD(ELODOC)
     D  WBOSFX       E                     EXTFLD(ELOSFX)
     D  WBCRC        E                     EXTFLD(ELCRC)
     D  WBVINV       E                     EXTFLD(ELVINV)
     D  WBPKCO       E                     EXTFLD(ELPKCO)
     D  WBPO         E                     EXTFLD(ELPO)
     D  WBPDCT       E                     EXTFLD(ELPDCT)
     D  WBLNID       E                     EXTFLD(ELLNID)
     D  WBSFXO       E                     EXTFLD(ELSFXO)
     D  WBOPSQ       E                     EXTFLD(ELOPSQ)
     D  WBVR01       E                     EXTFLD(ELVR01)
     D  WBUNIT       E                     EXTFLD(ELUNIT)
     D  WBMCU2       E                     EXTFLD(ELMCU2)
     D  WBRMK        E                     EXTFLD(ELRMK)
     D  WBRF         E                     EXTFLD(ELRF)
     D  WBDRF        E                     EXTFLD(ELDRF)
     D  WBCTL        E                     EXTFLD(ELCTL)
     D  WBFNLP       E                     EXTFLD(ELFNLP)
     D  WBU          E                     EXTFLD(ELU)
     D  WBUM         E                     EXTFLD(ELUM)
     D  WBPYIN       E                     EXTFLD(ELPYIN)
     D  WBTXA3       E                     EXTFLD(ELTXA3)
     D  WBEXR3       E                     EXTFLD(ELEXR3)
     D  WBRP1        E                     EXTFLD(ELRP1)
     D  WBRP2        E                     EXTFLD(ELRP2)
     D  WBRP3        E                     EXTFLD(ELRP3)
     D  WBAC07       E                     EXTFLD(ELAC07)
     D  WBTNN        E                     EXTFLD(ELTNN)
     D  WBDMCD       E                     EXTFLD(ELDMCD)
     D  WBITM        E                     EXTFLD(ELITM)
     D  WBHCRR       E                     EXTFLD(ELHCRR)
     D  WBHDGJ       E                     EXTFLD(ELHDGJ)
     D  WBURCD       E                     EXTFLD(ELURCD)
     D  WBURDT       E                     EXTFLD(ELURDT)
     D  WBURAT       E                     EXTFLD(ELURAT)
     D  WBURAB       E                     EXTFLD(ELURAB)
     D  WBURRF       E                     EXTFLD(ELURRF)
     D  WBTORG       E                     EXTFLD(ELTORG)
     D  WBUSER       E                     EXTFLD(ELUSER)
     D  WBPID        E                     EXTFLD(ELPID)
     D  WBUPMJ       E                     EXTFLD(ELUPMJ)
     D  WBUPMT       E                     EXTFLD(ELUPMT)
     D  WBJOBN       E                     EXTFLD(ELJOBN)
     D  WBDIM        E                     EXTFLD(ELDIM)
     D  WBDID        E                     EXTFLD(ELDID)
     D  WBDIY        E                     EXTFLD(ELDIY)
     D  WBDI#        E                     EXTFLD(ELDI#)
     D  WBDSVM       E                     EXTFLD(ELDSVM)
     D  WBDSVD       E                     EXTFLD(ELDSVD)
     D  WBDSVY       E                     EXTFLD(ELDSVY)
     D  WBDSV#       E                     EXTFLD(ELDSV#)
     D  WBDDM        E                     EXTFLD(ELDDM)
     D  WBDDDA       E                     EXTFLD(ELDDDA)
     D  WBDDY        E                     EXTFLD(ELDDY)
     D  WBDD#        E                     EXTFLD(ELDD#)
     D  WBDDNM       E                     EXTFLD(ELDDNM)
     D  WBDDND       E                     EXTFLD(ELDDND)
     D  WBDDNY       E                     EXTFLD(ELDDNY)
     D  WBDDN#       E                     EXTFLD(ELDDN#)
     D  WBDGM        E                     EXTFLD(ELDGM)
     D  WBDGD        E                     EXTFLD(ELDGD)
     D  WBDGY        E                     EXTFLD(ELDGY)
     D  WBDG#        E                     EXTFLD(ELDG#)
     D  WBDICM       E                     EXTFLD(ELDICM)
     D  WBDICD       E                     EXTFLD(ELDICD)
     D  WBDICY       E                     EXTFLD(ELDICY)
     D  WBDIC#       E                     EXTFLD(ELDIC#)
     D  WBHDGM       E                     EXTFLD(ELHDGM)
     D  WBHDGD       E                     EXTFLD(ELHDGD)
     D  WBHDGY       E                     EXTFLD(ELHDGY)
     D  WBHDG#       E                     EXTFLD(ELHDG#)
     D  WBDOCM       E                     EXTFLD(ELDOCM)
     D  WBTNST       E                     EXTFLD(ELTNST)
     D  WBYC01       E                     EXTFLD(ELYC01)
     D  WBYC02       E                     EXTFLD(ELYC02)
     D  WBYC03       E                     EXTFLD(ELYC03)
     D  WBYC04       E                     EXTFLD(ELYC04)
     D  WBYC05       E                     EXTFLD(ELYC05)
     D  WBYC06       E                     EXTFLD(ELYC06)
     D  WBYC07       E                     EXTFLD(ELYC07)
     D  WBYC08       E                     EXTFLD(ELYC08)
     D  WBYC09       E                     EXTFLD(ELYC09)
     D  WBYC10       E                     EXTFLD(ELYC10)
     D  WBDTXS       E                     EXTFLD(ELDTXS)
     D  WBBCRC       E                     EXTFLD(ELBCRC)
     D  WBATAD       E                     EXTFLD(ELATAD)
     D  WBCTAD       E                     EXTFLD(ELCTAD)
     D  WBNRTA       E                     EXTFLD(ELNRTA)
     D  WBFNRT       E                     EXTFLD(ELFNRT)
     D  WBTAXP       E                     EXTFLD(ELTAXP)
     D  WBPRGF       E                     EXTFLD(ELPRGF)
     D  WBGFL5       E                     EXTFLD(ELGFL5)
     D  WBGFL6       E                     EXTFLD(ELGFL6)
     D  WBGAM1       E                     EXTFLD(ELGAM1)
     D  WBGAM2       E                     EXTFLD(ELGAM2)
     D  WBGEN4       E                     EXTFLD(ELGEN4)
     D  WBGEN5       E                     EXTFLD(ELGEN5)
     D  WBWTAD       E                     EXTFLD(ELWTAD)
     D  WBWTAF       E                     EXTFLD(ELWTAF)
     D  WBSMMF       E                     EXTFLD(ELSMMF)
     D  WBPYWP       E                     EXTFLD(ELPYWP)
     D  WBPWPG       E                     EXTFLD(ELPWPG)
     D  WBNETS       E                     EXTFLD(ELNETS)
     D  WBATFL       E                     EXTFLD(ELATFL)
     D  WBATRL       E                     EXTFLD(ELATRL)
     D  WBJOBS       E                     EXTFLD(ELJOBS)
     D  WBPSTE       E                     EXTFLD(ELPSTE)
     D  WBDWST       E                     EXTFLD(ELDWST)
     D  WBABDT       E                     EXTFLD(ELABDT)
     D  WBABTM       E                     EXTFLD(ELABTM)
     D  WBAJVN       E                     EXTFLD(ELAJVN)
     D  WBAKVN       E                     EXTFLD(ELAKVN)
     D  WBACDT       E                     EXTFLD(ELACDT)
     D  WBACTM       E                     EXTFLD(ELACTM)
     D  WBALVN       E                     EXTFLD(ELALVN)
     D  WBAMVN       E                     EXTFLD(ELAMVN)
     D  WBO6TX       E                     EXTFLD(ELO6TX)
     D  WBO7TX       E                     EXTFLD(ELO7TX)
      *
     D YBRDCS          DS          1068
     D QE1091        E DS                  EXTNAME(E10911L0)
      * UPD : Run Log J/E Detail F0911  Update index
      * Renamed input format fields
     D  WCEDUS       E                     EXTFLD(GLEDUS)
     D  WCEDBT       E                     EXTFLD(GLEDBT)
     D  WCEDTN       E                     EXTFLD(GLEDTN)
     D  WCEDLN       E                     EXTFLD(GLEDLN)
     D  WCEDTY       E                     EXTFLD(GLEDTY)
     D  WCEDSQ       E                     EXTFLD(GLEDSQ)
     D  WCEDCT       E                     EXTFLD(GLEDCT)
     D  WCEDTS       E                     EXTFLD(GLEDTS)
     D  WCEDFT       E                     EXTFLD(GLEDFT)
     D  WCEDDT       E                     EXTFLD(GLEDDT)
     D  WCEDER       E                     EXTFLD(GLEDER)
     D  WCEDDL       E                     EXTFLD(GLEDDL)
     D  WCEDSP       E                     EXTFLD(GLEDSP)
     D  WCEDTC       E                     EXTFLD(GLEDTC)
     D  WCEDTR       E                     EXTFLD(GLEDTR)
     D  WCEDGL       E                     EXTFLD(GLEDGL)
     D  WCEDAN       E                     EXTFLD(GLEDAN)
     D  WCKCO        E                     EXTFLD(GLKCO)
     D  WCDCT        E                     EXTFLD(GLDCT)
     D  WCDOC        E                     EXTFLD(GLDOC)
     D  WCDGJ        E                     EXTFLD(GLDGJ)
     D  WCJELN       E                     EXTFLD(GLJELN)
     D  WCEXTL       E                     EXTFLD(GLEXTL)
     D  WCPOST       E                     EXTFLD(GLPOST)
     D  WCICU        E                     EXTFLD(GLICU)
     D  WCICUT       E                     EXTFLD(GLICUT)
     D  WCDICJ       E                     EXTFLD(GLDICJ)
     D  WCDSYJ       E                     EXTFLD(GLDSYJ)
     D  WCTICU       E                     EXTFLD(GLTICU)
     D  WCCO         E                     EXTFLD(GLCO)
     D  WCANI        E                     EXTFLD(GLANI)
     D  WCAM         E                     EXTFLD(GLAM)
     D  WCAID        E                     EXTFLD(GLAID)
     D  WCMCU        E                     EXTFLD(GLMCU)
     D  WCOBJ        E                     EXTFLD(GLOBJ)
     D  WCSUB        E                     EXTFLD(GLSUB)
     D  WCSBL        E                     EXTFLD(GLSBL)
     D  WCSBLT       E                     EXTFLD(GLSBLT)
     D  WCLT         E                     EXTFLD(GLLT)
     D  WCPN         E                     EXTFLD(GLPN)
     D  WCCTRY       E                     EXTFLD(GLCTRY)
     D  WCFY         E                     EXTFLD(GLFY)
     D  WCFQ         E                     EXTFLD(GLFQ)
     D  WCCRCD       E                     EXTFLD(GLCRCD)
     D  WCCRR        E                     EXTFLD(GLCRR)
     D  WCHCRR       E                     EXTFLD(GLHCRR)
     D  WCHDGJ       E                     EXTFLD(GLHDGJ)
     D  WCAA         E                     EXTFLD(GLAA)
     D  WCU          E                     EXTFLD(GLU)
     D  WCUM         E                     EXTFLD(GLUM)
     D  WCGLC        E                     EXTFLD(GLGLC)
     D  WCRE         E                     EXTFLD(GLRE)
     D  WCEXA        E                     EXTFLD(GLEXA)
     D  WCEXR        E                     EXTFLD(GLEXR)
     D  WCR1         E                     EXTFLD(GLR1)
     D  WCR2         E                     EXTFLD(GLR2)
     D  WCR3         E                     EXTFLD(GLR3)
     D  WCSFX        E                     EXTFLD(GLSFX)
     D  WCODOC       E                     EXTFLD(GLODOC)
     D  WCODCT       E                     EXTFLD(GLODCT)
     D  WCOSFX       E                     EXTFLD(GLOSFX)
     D  WCPKCO       E                     EXTFLD(GLPKCO)
     D  WCOKCO       E                     EXTFLD(GLOKCO)
     D  WCPDCT       E                     EXTFLD(GLPDCT)
     D  WCAN8        E                     EXTFLD(GLAN8)
     D  WCCN         E                     EXTFLD(GLCN)
     D  WCDKJ        E                     EXTFLD(GLDKJ)
     D  WCDKC        E                     EXTFLD(GLDKC)
     D  WCASID       E                     EXTFLD(GLASID)
     D  WCBRE        E                     EXTFLD(GLBRE)
     D  WCRCND       E                     EXTFLD(GLRCND)
     D  WCSUMM       E                     EXTFLD(GLSUMM)
     D  WCPRGE       E                     EXTFLD(GLPRGE)
     D  WCTNN        E                     EXTFLD(GLTNN)
     D  WCALT1       E                     EXTFLD(GLALT1)
     D  WCALT2       E                     EXTFLD(GLALT2)
     D  WCALT3       E                     EXTFLD(GLALT3)
     D  WCALT4       E                     EXTFLD(GLALT4)
     D  WCALT5       E                     EXTFLD(GLALT5)
     D  WCALT6       E                     EXTFLD(GLALT6)
     D  WCALT7       E                     EXTFLD(GLALT7)
     D  WCALT8       E                     EXTFLD(GLALT8)
     D  WCALT9       E                     EXTFLD(GLALT9)
     D  WCALT0       E                     EXTFLD(GLALT0)
     D  WCALTT       E                     EXTFLD(GLALTT)
     D  WCALTU       E                     EXTFLD(GLALTU)
     D  WCALTV       E                     EXTFLD(GLALTV)
     D  WCALTW       E                     EXTFLD(GLALTW)
     D  WCALTX       E                     EXTFLD(GLALTX)
     D  WCALTZ       E                     EXTFLD(GLALTZ)
     D  WCDLNA       E                     EXTFLD(GLDLNA)
     D  WCCFF1       E                     EXTFLD(GLCFF1)
     D  WCCFF2       E                     EXTFLD(GLCFF2)
     D  WCASM        E                     EXTFLD(GLASM)
     D  WCBC         E                     EXTFLD(GLBC)
     D  WCVINV       E                     EXTFLD(GLVINV)
     D  WCIVD        E                     EXTFLD(GLIVD)
     D  WCWR01       E                     EXTFLD(GLWR01)
     D  WCPO         E                     EXTFLD(GLPO)
     D  WCPSFX       E                     EXTFLD(GLPSFX)
     D  WCDCTO       E                     EXTFLD(GLDCTO)
     D  WCLNID       E                     EXTFLD(GLLNID)
     D  WCWY         E                     EXTFLD(GLWY)
     D  WCWN         E                     EXTFLD(GLWN)
     D  WCFNLP       E                     EXTFLD(GLFNLP)
     D  WCOPSQ       E                     EXTFLD(GLOPSQ)
     D  WCJBCD       E                     EXTFLD(GLJBCD)
     D  WCJBST       E                     EXTFLD(GLJBST)
     D  WCHMCU       E                     EXTFLD(GLHMCU)
     D  WCDOI        E                     EXTFLD(GLDOI)
     D  WCALID       E                     EXTFLD(GLALID)
     D  WCALTY       E                     EXTFLD(GLALTY)
     D  WCDSVJ       E                     EXTFLD(GLDSVJ)
     D  WCTORG       E                     EXTFLD(GLTORG)
     D  WCREG#       E                     EXTFLD(GLREG#)
     D  WCPYID       E                     EXTFLD(GLPYID)
     D  WCUSER       E                     EXTFLD(GLUSER)
     D  WCPID        E                     EXTFLD(GLPID)
     D  WCJOBN       E                     EXTFLD(GLJOBN)
     D  WCUPMJ       E                     EXTFLD(GLUPMJ)
     D  WCUPMT       E                     EXTFLD(GLUPMT)
     D  WCCRRM       E                     EXTFLD(GLCRRM)
     D  WCACR        E                     EXTFLD(GLACR)
     D  WCDGM        E                     EXTFLD(GLDGM)
     D  WCDGD        E                     EXTFLD(GLDGD)
     D  WCDGY        E                     EXTFLD(GLDGY)
     D  WCDG#        E                     EXTFLD(GLDG#)
     D  WCDICM       E                     EXTFLD(GLDICM)
     D  WCDICD       E                     EXTFLD(GLDICD)
     D  WCDICY       E                     EXTFLD(GLDICY)
     D  WCDIC#       E                     EXTFLD(GLDIC#)
     D  WCDSYM       E                     EXTFLD(GLDSYM)
     D  WCDSYD       E                     EXTFLD(GLDSYD)
     D  WCDSYY       E                     EXTFLD(GLDSYY)
     D  WCDSY#       E                     EXTFLD(GLDSY#)
     D  WCDKM        E                     EXTFLD(GLDKM)
     D  WCDKD        E                     EXTFLD(GLDKD)
     D  WCDKY        E                     EXTFLD(GLDKY)
     D  WCDK#        E                     EXTFLD(GLDK#)
     D  WCDSVM       E                     EXTFLD(GLDSVM)
     D  WCDSVD       E                     EXTFLD(GLDSVD)
     D  WCDSVY       E                     EXTFLD(GLDSVY)
     D  WCDSV#       E                     EXTFLD(GLDSV#)
     D  WCHDGM       E                     EXTFLD(GLHDGM)
     D  WCHDGD       E                     EXTFLD(GLHDGD)
     D  WCHDGY       E                     EXTFLD(GLHDGY)
     D  WCHDG#       E                     EXTFLD(GLHDG#)
     D  WCDKCM       E                     EXTFLD(GLDKCM)
     D  WCDKCD       E                     EXTFLD(GLDKCD)
     D  WCDKCY       E                     EXTFLD(GLDKCY)
     D  WCDKC#       E                     EXTFLD(GLDKC#)
     D  WCDIM        E                     EXTFLD(GLDIM)
     D  WCDID        E                     EXTFLD(GLDID)
     D  WCDIY        E                     EXTFLD(GLDIY)
     D  WCDI#        E                     EXTFLD(GLDI#)
     D  WCABR1       E                     EXTFLD(GLABR1)
     D  WCABR2       E                     EXTFLD(GLABR2)
     D  WCABR3       E                     EXTFLD(GLABR3)
     D  WCABR4       E                     EXTFLD(GLABR4)
     D  WCABT1       E                     EXTFLD(GLABT1)
     D  WCABT2       E                     EXTFLD(GLABT2)
     D  WCABT3       E                     EXTFLD(GLABT3)
     D  WCABT4       E                     EXTFLD(GLABT4)
     D  WCITM        E                     EXTFLD(GLITM)
     D  WCPM01       E                     EXTFLD(GLPM01)
     D  WCPM02       E                     EXTFLD(GLPM02)
     D  WCPM03       E                     EXTFLD(GLPM03)
     D  WCPM04       E                     EXTFLD(GLPM04)
     D  WCPM05       E                     EXTFLD(GLPM05)
     D  WCPM06       E                     EXTFLD(GLPM06)
     D  WCPM07       E                     EXTFLD(GLPM07)
     D  WCPM08       E                     EXTFLD(GLPM08)
     D  WCPM09       E                     EXTFLD(GLPM09)
     D  WCPM10       E                     EXTFLD(GLPM10)
     D  WCBCRC       E                     EXTFLD(GLBCRC)
     D  WCEXR1       E                     EXTFLD(GLEXR1)
     D  WCTXA1       E                     EXTFLD(GLTXA1)
     D  WCTXIT       E                     EXTFLD(GLTXIT)
     D  WCACTB       E                     EXTFLD(GLACTB)
     D  WCSTAM       E                     EXTFLD(GLSTAM)
     D  WCCTAM       E                     EXTFLD(GLCTAM)
     D  WCAG         E                     EXTFLD(GLAG)
     D  WCAGF        E                     EXTFLD(GLAGF)
     D  WCTKTX       E                     EXTFLD(GLTKTX)
     D  WCDLNI       E                     EXTFLD(GLDLNI)
     D  WCCKNU       E                     EXTFLD(GLCKNU)
     D  WCBUPC       E                     EXTFLD(GLBUPC)
     D  WCAHBU       E                     EXTFLD(GLAHBU)
     D  WCEPGC       E                     EXTFLD(GLEPGC)
     D  WCJPGC       E                     EXTFLD(GLJPGC)
     D  WCRC5        E                     EXTFLD(GLRC5)
     D  WCSFXE       E                     EXTFLD(GLSFXE)
     D  WCOFM        E                     EXTFLD(GLOFM)
     D  WCDTNB       E                     EXTFLD(GLDTNB)
     D  WCDUNB       E                     EXTFLD(GLDUNB)
     D  WCO6TX       E                     EXTFLD(GLO6TX)
     D  WCO7TX       E                     EXTFLD(GLO7TX)
     D  WCDWST       E                     EXTFLD(GLDWST)
     D  WCABDT       E                     EXTFLD(GLABDT)
     D  WCABTM       E                     EXTFLD(GLABTM)
     D  WCAJVN       E                     EXTFLD(GLAJVN)
     D  WCAKVN       E                     EXTFLD(GLAKVN)
     D  WCACDT       E                     EXTFLD(GLACDT)
     D  WCACTM       E                     EXTFLD(GLACTM)
     D  WCALVN       E                     EXTFLD(GLALVN)
     D  WCAMVN       E                     EXTFLD(GLAMVN)
      *
     D YCRDCS          DS          1034
      * Outward parameters
     D PARC            DS            51
      * KEY : Run Log J/E Detail F0911  Retrieval index
      * I : RST EDI - User ID
     D  PAEDUS                 1     10
      * I : RST EDI - Batch Number
     D  PAEDBT                11     25
      *
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  WP0001         S              1
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  ##RRMX         S              5  0
     D  WUPUTX         S             25
     D  WZDICJ         S                   LIKE(#2DICJ)
     D  WZICUT         S                   LIKE(#2ICUT)
     D  WZICU          S                   LIKE(#2ICU)
     D  WZIST          S                   LIKE(#2IST)
     D  WZUSER         S                   LIKE(#2USER)
     D  ##RROK         S              5  0
     D  WKIND0         S              1
     D  ##RR           S              5  0
     D  ##RRRD         S              9  0
     D  ##SPG          S              3  0
     D  ##SLIN         S              3  0
     D  ##SFLN         S              9  0
     D  YL0001         S              5  0
     D  WQ0001         S              5  0
     D  WQ0002         S              7  0
     D  W0CLPG         S             10
     D  W0HLP          S              1
     D  YPMT04         S              1
     D  HELP25         S              1
     D  ##OFF          S             30
     D  CAIN81         S              1
     D  ZHCSRW         S              5  0
     D  ZHCSCL         S              5  0
     D  ZZCSRW         S              3  0
     D  ZZCSCL         S              3  0
     D  W0HPMB         S             10
     D  YYHPFL         S             10
     D  YYHPLB         S             10
     D  YYHLVN         S             10
     D  YYUSOP         S             10
     D  YYRW           S              5  0
     D  YYCL           S              5  0
     D  YYLGCT         S              5  0
     D  YYLGVN         S             10
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAFSMS         S              1
     D  W0DCF          S              1
     D  W0INVL         S             25
     D  XDWK1          S              8  0
     D  XDDTFM         S              3
     D  ZADFMF         S             10
     D  WL0001         S              2
     D  WL0002         S              8  0
     D  WL0003         S              1
     D  WL0004         S              7
     D  WL0005         S             25
     D  WN0001         S              1
     D  WN0002         S             15  0
     D  WN0003         S             10
     D  WN0004         S              6  0
     D  WN0005         S              5  0
     D  WN0006         S              1
     D  WN0007         S              1
     D  WN0008         S             15  2
     D  WN0009         S             15  0
     D  WN0010         S             10
     D  WN0011         S              1
     D  WN0012         S              1
     D  WN0013         S             15  0
     D  WN0014         S              1
     D  WN0015         S             10
     D  WN0016         S             10
     D  WN0017         S              6  0
     D  WN0018         S              6  0
     D  WN0019         S              1
     D  WN0020         S              1
     D  WN0021         S              1
     D  YARDC          S              1
     D  YL0002         S             15
     D  WQSB01         S                   LIKE(ELEDUS)
     D  WQSB02         S                   LIKE(ELEDBT)
     D  WN0022         S              1
     D  WN0023         S              2  0
     D  WN0024         S              2
     D  WN0025         S              6
     D  WN0026         S             10
     D  WN0027         S              6  0
     D  WN0028         S              1
     D  WN0029         S              5  0
     D  WN0030         S              1
     D  WN0031         S              1
     D  WN0032         S              1
     D  WN0033         S              1
     D  WN0034         S              8  0
     D  WN0035         S              5
     D  WN0036         S              8  0
     D  WN0037         S              2
     D  WN0038         S              3
     D  WN0039         S              2  0
     D  WN0040         S              2
     D  WN0041         S              8  0
     D  WN0042         S              8  0
     D  WN0043         S              8  0
     D  WN0044         S              6  0
     D  WN0045         S              6  0
     D  WN0046         S              6  0
     D  WN0047         S              6  0
     D  WN0048         S              6  0
     D  WN0049         S              2  0
     D  WN0050         S              2  0
     D  WN0051         S              2  0
     D  WN0052         S              5
     D  WN0053         S              8  0
     D  WN0054         S              2
     D  WN0055         S              6  0
     D  WN0056         S              1
     D  WN0057         S              1
     D  WN0058         S             15  2
     D  WN0059         S             15  2
     D  WN0060         S             15  2
     D  WN0061         S             15  2
     D  WN0062         S             15  2
     D  WN0063         S             15  2
     D  WN0064         S             15  2
     D  WN0065         S             10
     D  WN0066         S              2
     D  WN0067         S              1
     D  WN0068         S              3
     D  WN0069         S             15  0
     D  WN0070         S             15  2
     D  WN0071         S             15  2
     D  WN0072         S             15  2
     D  WN0073         S             15  2
     D  WN0074         S             15  2
     D  WN0075         S             15  2
     D  WN0076         S             15  2
     D  WN0077         S              4
     D  WN0078         S              8
     D  WN0079         S              1
     D  WN0080         S              1
     D  WN0081         S              8
     D  WN0082         S             12
     D  WN0083         S              6
     D  WN0084         S              8
     D  WN0085         S              1
     D  WN0086         S              8
     D  WN0087         S              8
     D  WN0088         S              3
     D  WN0089         S              1
     D  WN0090         S              5
     D  WN0091         S              2
     D  WN0092         S              8  0
     D  WN0093         S              3
     D  WN0094         S              3
     D  WN0095         S             25
     D  WN0096         S              5
     D  WN0097         S              8
     D  WN0098         S              2
     D  WN0099         S              6  3
     D  WN0100         S              3
     D  WN0101         S              5  2
     D  WN0102         S             25
     D  WN0103         S              8
     D  WN0104         S             12
     D  WN0105         S             30
     D  WN0106         S              2
     D  WN0107         S              3  0
     D  WN0108         S             13
     D  WN0109         S              1
     D  WN0110         S             15  2
     D  WN0111         S              2
     D  WN0112         S              1
     D  WN0113         S             10
     D  WN0114         S              2
     D  WN0115         S              1
     D  WN0116         S              1
     D  WN0117         S              1
     D  WN0118         S              3
     D  WN0119         S              1
     D  WN0120         S              1
     D  WN0121         S              8  0
     D  WN0122         S             15  0
     D  WN0123         S              6  0
     D  WN0124         S              2
     D  WN0125         S              6  0
     D  WN0126         S             15  2
     D  WN0127         S              8  0
     D  WN0128         S             15
     D  WN0129         S             10
     D  WN0130         S             10
     D  WN0131         S             10
     D  WN0132         S              6  0
     D  WN0133         S              6  0
     D  WN0134         S             10
     D  WN0135         S              2  0
     D  WN0136         S              2  0
     D  WN0137         S              2  0
     D  WN0138         S              2  0
     D  WN0139         S              2  0
     D  WN0140         S              2  0
     D  WN0141         S              2  0
     D  WN0142         S              2  0
     D  WN0143         S              2  0
     D  WN0144         S              2  0
     D  WN0145         S              2  0
     D  WN0146         S              2  0
     D  WN0147         S              2  0
     D  WN0148         S              2  0
     D  WN0149         S              2  0
     D  WN0150         S              2  0
     D  WN0151         S              2  0
     D  WN0152         S              2  0
     D  WN0153         S              2  0
     D  WN0154         S              2  0
     D  WN0155         S              2  0
     D  WN0156         S              2  0
     D  WN0157         S              2  0
     D  WN0158         S              2  0
     D  WN0159         S              2  0
     D  WN0160         S              2  0
     D  WN0161         S              2  0
     D  WN0162         S              2  0
     D  WN0163         S              8  0
     D  WN0164         S             20
     D  WN0165         S              3
     D  WN0166         S              3
     D  WN0167         S              3
     D  WN0168         S              3
     D  WN0169         S              3
     D  WN0170         S              3
     D  WN0171         S              3
     D  WN0172         S              3
     D  WN0173         S              3
     D  WN0174         S              3
     D  WN0175         S              1
     D  WN0176         S              3
     D  WN0177         S             15  2
     D  WN0178         S             15  2
     D  WN0179         S             15  2
     D  WN0180         S             15  2
     D  WN0181         S              1
     D  WN0182         S              1
     D  WN0183         S              1
     D  WN0184         S              1
     D  WN0185         S             15  2
     D  WN0186         S             15  2
     D  WN0187         S             25
     D  WN0188         S             25
     D  WN0189         S             15  2
     D  WN0190         S             15  2
     D  WN0191         S              1
     D  WN0192         S              1
     D  WN0193         S             15  0
     D  WN0194         S              1
     D  WN0195         S              1
     D  WN0196         S              2
     D  WN0197         S              8  0
     D  WN0198         S              1
     D  WN0199         S              1
     D  WN0200         S              7  0
     D  WN0201         S              6  0
     D  WN0202         S             10
     D  WN0203         S             10
     D  WN0204         S              7  0
     D  WN0205         S              6  0
     D  WN0206         S             10
     D  WN0207         S             10
     D  YBRDC          S              1
     D  WQSD01         S                   LIKE(GLEDUS)
     D  WQSD02         S                   LIKE(GLEDBT)
     D  WN0208         S              2  0
     D  WN0209         S              2
     D  WN0210         S              6
     D  WN0211         S             10
     D  WN0212         S              6  0
     D  WN0213         S              1
     D  WN0214         S              5  0
     D  WN0215         S              1
     D  WN0216         S              1
     D  WN0217         S              1
     D  WN0218         S              8  0
     D  WN0219         S              5
     D  WN0220         S              2
     D  WN0221         S              8  0
     D  WN0222         S              6  0
     D  WN0223         S              7  0
     D  WN0224         S              2
     D  WN0225         S              1
     D  WN0226         S              8  0
     D  WN0227         S              2
     D  WN0228         S              6  0
     D  WN0229         S              6  0
     D  WN0230         S              6  0
     D  WN0231         S              5
     D  WN0232         S             29
     D  WN0233         S              1
     D  WN0234         S              8
     D  WN0235         S             12
     D  WN0236         S              6
     D  WN0237         S              8
     D  WN0238         S              8
     D  WN0239         S              1
     D  WN0240         S              2
     D  WN0241         S              2  0
     D  WN0242         S              2  0
     D  WN0243         S              2  0
     D  WN0244         S              4
     D  WN0245         S              3
     D  WN0246         S             15  0
     D  WN0247         S             15  0
     D  WN0248         S              6  0
     D  WN0249         S             15  2
     D  WN0250         S             15  2
     D  WN0251         S              2
     D  WN0252         S              4
     D  WN0253         S              1
     D  WN0254         S             30
     D  WN0255         S             30
     D  WN0256         S              8
     D  WN0257         S              8
     D  WN0258         S              8
     D  WN0259         S              3
     D  WN0260         S              8  0
     D  WN0261         S              2
     D  WN0262         S              3
     D  WN0263         S              5
     D  WN0264         S              5
     D  WN0265         S              2
     D  WN0266         S              8  0
     D  WN0267         S              8
     D  WN0268         S              6  0
     D  WN0269         S              6  0
     D  WN0270         S             25
     D  WN0271         S              1
     D  WN0272         S              1
     D  WN0273         S              1
     D  WN0274         S              1
     D  WN0275         S              1
     D  WN0276         S              1
     D  WN0277         S              1
     D  WN0278         S              1
     D  WN0279         S              1
     D  WN0280         S              1
     D  WN0281         S              1
     D  WN0282         S              1
     D  WN0283         S              1
     D  WN0284         S              1
     D  WN0285         S              1
     D  WN0286         S              1
     D  WN0287         S              1
     D  WN0288         S              1
     D  WN0289         S              1
     D  WN0290         S              1
     D  WN0291         S              1
     D  WN0292         S              1
     D  WN0293         S              1
     D  WN0294         S              1
     D  WN0295         S              1
     D  WN0296         S              1
     D  WN0297         S             25
     D  WN0298         S              6  0
     D  WN0299         S              4
     D  WN0300         S              8
     D  WN0301         S              3
     D  WN0302         S              2
     D  WN0303         S              6  3
     D  WN0304         S              2  0
     D  WN0305         S              2  0
     D  WN0306         S              1
     D  WN0307         S              5  2
     D  WN0308         S              6
     D  WN0309         S              4
     D  WN0310         S             12
     D  WN0311         S              2  0
     D  WN0312         S             25
     D  WN0313         S              2
     D  WN0314         S              6  0
     D  WN0315         S             10
     D  WN0316         S              8  0
     D  WN0317         S             15  0
     D  WN0318         S             10
     D  WN0319         S             10
     D  WN0320         S             10
     D  WN0321         S              6  0
     D  WN0322         S              6  0
     D  WN0323         S              1
     D  WN0324         S             15  2
     D  WN0325         S              2  0
     D  WN0326         S              2  0
     D  WN0327         S              2  0
     D  WN0328         S              2  0
     D  WN0329         S              2  0
     D  WN0330         S              2  0
     D  WN0331         S              2  0
     D  WN0332         S              2  0
     D  WN0333         S              2  0
     D  WN0334         S              2  0
     D  WN0335         S              2  0
     D  WN0336         S              2  0
     D  WN0337         S              2  0
     D  WN0338         S              2  0
     D  WN0339         S              2  0
     D  WN0340         S              2  0
     D  WN0341         S              2  0
     D  WN0342         S              2  0
     D  WN0343         S              2  0
     D  WN0344         S              2  0
     D  WN0345         S              2  0
     D  WN0346         S              2  0
     D  WN0347         S              2  0
     D  WN0348         S              2  0
     D  WN0349         S              2  0
     D  WN0350         S              2  0
     D  WN0351         S              2  0
     D  WN0352         S              2  0
     D  WN0353         S              2  0
     D  WN0354         S              2  0
     D  WN0355         S              2  0
     D  WN0356         S              2  0
     D  WN0357         S             12
     D  WN0358         S             12
     D  WN0359         S             12
     D  WN0360         S             12
     D  WN0361         S              1
     D  WN0362         S              1
     D  WN0363         S              1
     D  WN0364         S              1
     D  WN0365         S              8  0
     D  WN0366         S              1
     D  WN0367         S              1
     D  WN0368         S              1
     D  WN0369         S              1
     D  WN0370         S              1
     D  WN0371         S              1
     D  WN0372         S              1
     D  WN0373         S              1
     D  WN0374         S              1
     D  WN0375         S              1
     D  WN0376         S              3
     D  WN0377         S              2
     D  WN0378         S             10
     D  WN0379         S              8  0
     D  WN0380         S             10
     D  WN0381         S             15  2
     D  WN0382         S             15  2
     D  WN0383         S             15  2
     D  WN0384         S             15  2
     D  WN0385         S              1
     D  WN0386         S              6  3
     D  WN0387         S             25
     D  WN0388         S              1
     D  WN0389         S             12
     D  WN0390         S              3
     D  WN0391         S              3
     D  WN0392         S              5  0
     D  WN0393         S              2  0
     D  WN0394         S              1
     D  WN0395         S              8  0
     D  WN0396         S              8  0
     D  WN0397         S              1
     D  WN0398         S              7  0
     D  WN0399         S              6  0
     D  WN0400         S             10
     D  WN0401         S             10
     D  WN0402         S              7  0
     D  WN0403         S              6  0
     D  WN0404         S             10
     D  WN0405         S             10
     D  YCRDC          S              1
     D  YL0003         S              7
     D  WQ0003         S              7
     D  WQ0004         S              8  0
     D  WQ0005         S             10
     D  WQ0006         S              2
     D  WQ0007         S             15
     D  WQ0008         S             10
     D  WQ0009         S             15
     D  YL0004         S             50
     D  WQ0010         S             50
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  YPMTFD         S             10
     D  YAFSCH         S              4  0
     D  YPMRRN         S              4  0
     D  Y#SFRC         S              4  0
     D  ZHSTRW         S              4  0
     D  ZHNDRW         S              4  0
     D  ZHRLEN         S              4  0
     D  ZHF4RW         S              4  0
     D  ZHWK1#         S              4  0
     D  YZSFDL         S              4  0
     D  ##SFPG         S              3  0
     D  W0SLM          S              9  0
     D  W0SPG          S              3  0
     D  W0RR0          S              4  0
     D  W0GRP          S              1
     D  WQ0011         S              3
     D  WQ0012         S              3  0
     D  WQ0013         S              6
     D  WQ0014         S              3
     D  WQ0015         S              1
     D  WQ0016         S             10
     D  WQ0017         S             30
     D  WQ0018         S             40
     D  WQ0019         S              1
     D  YSETCS         S              1
     D  WCSRLC         S              3
     D  ZINPOS         S              5  0
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  W0CFL          S             10
     D  W0CRW          S              5  0
     D  W0CCL          S              5  0
     D  ZZFFL          S             10
     D  ZZFLB          S             10
     D  ZZFMB          S             10
     D  ZZFQL          S             21
     D  W0PMT          S              1
      /EJECT
      * Parameter declarations
     D P1PARM          DS
      * I :  Allow Update Y/N
     D  P1NSST                 1      1
     D P2PARM          DS
      * FLD: *Arrays
      * N :  OMS Warehouse Code
     D  P2LCTX                 1      3
      * N :  OMS Company Number
     D  P2GUNB                 4      5P 0
      * N :  OMS Application code
     D  P2CQCD                 6     11
      * N :  OMS Salesperson Code
     D  P2CSCD                12     14
      * N :  OMS Allow Multi-Company
     D  P2I2ST                15     15
      * N :  OMS Default Printer
     D  P2LDTX                16     25
      * N :  OMS NAME
     D  P2LETX                26     55
      * N :  OMS System Value Alpha
     D  P2KRTX                56     95
      * N :  OMS Access Denied (Y/N)
     D  P2I1ST                96     96
     D                 DS
     D  ZAMSDA                 1    132
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     D  ZA0001                 1      1
      * Message data for 'Option Not Allowed'
      * *SFLSEL
     D  ZA0002                 1      1
      * Message data for 'Email generated for batch'
      * EDI - Batch Number
     D  ZA0003                 1     15
      * Message data for 'Exec Sql JDE Batch'
      * EDI - Batch Number
     D  ZA0004                 1     15
      * Email ID USR
     D  ZA0005                16     65
      * Description
     D  ZA0006                66     95
     II0011L0
      * Batch Control File F0011  Update index
      * Renamed input format fields
     I              ICICUT                      WAICUT
     I              ICICU                       WAICU
     I              ICIST                       WAIST
     I              ICIAPP                      WAIAPP
     I              ICAICU                      WAAICU
     I              ICUSER                      WAUSER
     I              ICDICJ                      WADICJ
     I              ICNDO                       WANDO
     I              ICBAL                       WABAL
     I              ICBALJ                      WABALJ
     I              ICAME                       WAAME
     I              ICDOCN                      WADOCN
     I              ICAUSR                      WAAUSR
     I              ICPOB                       WAPOB
     I              ICIBOI                      WAIBOI
     I              ICAIPT                      WAAIPT
     I              ICOFFP                      WAOFFP
     I              ICPID                       WAPID
     I              ICJOBN                      WAJOBN
     I              ICUPMJ                      WAUPMJ
     I              ICUPTM                      WAUPTM
     I              ICDRSP                      WADRSP
     I              ICS2PP                      WAS2PP
     I              ICCBP                       WACBP
     I              ICO6TX                      WAO6TX
     I              ICO7TX                      WAO7TX
      *
     II0411L0
      * Run Log Vchr Dtl   F0411  Update index
      * Renamed input format fields
     I              ELEDUS                      WBEDUS
     I              ELEDBT                      WBEDBT
     I              ELEDTN                      WBEDTN
     I              ELEDLN                      WBEDLN
     I              ELEDTY                      WBEDTY
     I              ELEDSQ                      WBEDSQ
     I              ELEDCT                      WBEDCT
     I              ELEDTS                      WBEDTS
     I              ELEDFT                      WBEDFT
     I              ELEDDT                      WBEDDT
     I              ELEDER                      WBEDER
     I              ELEDDL                      WBEDDL
     I              ELEDSP                      WBEDSP
     I              ELEDTC                      WBEDTC
     I              ELEDTR                      WBEDTR
     I              ELEDGL                      WBEDGL
     I              ELEDDH                      WBEDDH
     I              ELEDAN                      WBEDAN
     I              ELKCO                       WBKCO
     I              ELDOC                       WBDOC
     I              ELDCT                       WBDCT
     I              ELSFX                       WBSFX
     I              ELSFXE                      WBSFXE
     I              ELDCTA                      WBDCTA
     I              ELAN8                       WBAN8
     I              ELPYE                       WBPYE
     I              ELSNTO                      WBSNTO
     I              ELDIVJ                      WBDIVJ
     I              ELDSVJ                      WBDSVJ
     I              ELDDJ                       WBDDJ
     I              ELDDNJ                      WBDDNJ
     I              ELDGJ                       WBDGJ
     I              ELFY                        WBFY
     I              ELCTRY                      WBCTRY
     I              ELPN                        WBPN
     I              ELCO                        WBCO
     I              ELICU                       WBICU
     I              ELICUT                      WBICUT
     I              ELDICJ                      WBDICJ
     I              ELBALJ                      WBBALJ
     I              ELPSTC                      WBPSTC
     I              ELAG                        WBAG
     I              ELAAP                       WBAAP
     I              ELADSC                      WBADSC
     I              ELADSA                      WBADSA
     I              ELATXA                      WBATXA
     I              ELATXN                      WBATXN
     I              ELSTAM                      WBSTAM
     I              ELTXA1                      WBTXA1
     I              ELEXR1                      WBEXR1
     I              ELCRRM                      WBCRRM
     I              ELCRCD                      WBCRCD
     I              ELCRR                       WBCRR
     I              ELACR                       WBACR
     I              ELFAP                       WBFAP
     I              ELCDS                       WBCDS
     I              ELCDSA                      WBCDSA
     I              ELCTXA                      WBCTXA
     I              ELCTXN                      WBCTXN
     I              ELCTAM                      WBCTAM
     I              ELGLC                       WBGLC
     I              ELGLBA                      WBGLBA
     I              ELPOST                      WBPOST
     I              ELAM                        WBAM
     I              ELAID2                      WBAID2
     I              ELMCU                       WBMCU
     I              ELOBJ                       WBOBJ
     I              ELSUB                       WBSUB
     I              ELSBLT                      WBSBLT
     I              ELSBL                       WBSBL
     I              ELBAID                      WBBAID
     I              ELPTC                       WBPTC
     I              ELVOD                       WBVOD
     I              ELOKCO                      WBOKCO
     I              ELODCT                      WBODCT
     I              ELODOC                      WBODOC
     I              ELOSFX                      WBOSFX
     I              ELCRC                       WBCRC
     I              ELVINV                      WBVINV
     I              ELPKCO                      WBPKCO
     I              ELPO                        WBPO
     I              ELPDCT                      WBPDCT
     I              ELLNID                      WBLNID
     I              ELSFXO                      WBSFXO
     I              ELOPSQ                      WBOPSQ
     I              ELVR01                      WBVR01
     I              ELUNIT                      WBUNIT
     I              ELMCU2                      WBMCU2
     I              ELRMK                       WBRMK
     I              ELRF                        WBRF
     I              ELDRF                       WBDRF
     I              ELCTL                       WBCTL
     I              ELFNLP                      WBFNLP
     I              ELU                         WBU
     I              ELUM                        WBUM
     I              ELPYIN                      WBPYIN
     I              ELTXA3                      WBTXA3
     I              ELEXR3                      WBEXR3
     I              ELRP1                       WBRP1
     I              ELRP2                       WBRP2
     I              ELRP3                       WBRP3
     I              ELAC07                      WBAC07
     I              ELTNN                       WBTNN
     I              ELDMCD                      WBDMCD
     I              ELITM                       WBITM
     I              ELHCRR                      WBHCRR
     I              ELHDGJ                      WBHDGJ
     I              ELURCD                      WBURCD
     I              ELURDT                      WBURDT
     I              ELURAT                      WBURAT
     I              ELURAB                      WBURAB
     I              ELURRF                      WBURRF
     I              ELTORG                      WBTORG
     I              ELUSER                      WBUSER
     I              ELPID                       WBPID
     I              ELUPMJ                      WBUPMJ
     I              ELUPMT                      WBUPMT
     I              ELJOBN                      WBJOBN
     I              ELDIM                       WBDIM
     I              ELDID                       WBDID
     I              ELDIY                       WBDIY
     I              ELDI#                       WBDI#
     I              ELDSVM                      WBDSVM
     I              ELDSVD                      WBDSVD
     I              ELDSVY                      WBDSVY
     I              ELDSV#                      WBDSV#
     I              ELDDM                       WBDDM
     I              ELDDDA                      WBDDDA
     I              ELDDY                       WBDDY
     I              ELDD#                       WBDD#
     I              ELDDNM                      WBDDNM
     I              ELDDND                      WBDDND
     I              ELDDNY                      WBDDNY
     I              ELDDN#                      WBDDN#
     I              ELDGM                       WBDGM
     I              ELDGD                       WBDGD
     I              ELDGY                       WBDGY
     I              ELDG#                       WBDG#
     I              ELDICM                      WBDICM
     I              ELDICD                      WBDICD
     I              ELDICY                      WBDICY
     I              ELDIC#                      WBDIC#
     I              ELHDGM                      WBHDGM
     I              ELHDGD                      WBHDGD
     I              ELHDGY                      WBHDGY
     I              ELHDG#                      WBHDG#
     I              ELDOCM                      WBDOCM
     I              ELTNST                      WBTNST
     I              ELYC01                      WBYC01
     I              ELYC02                      WBYC02
     I              ELYC03                      WBYC03
     I              ELYC04                      WBYC04
     I              ELYC05                      WBYC05
     I              ELYC06                      WBYC06
     I              ELYC07                      WBYC07
     I              ELYC08                      WBYC08
     I              ELYC09                      WBYC09
     I              ELYC10                      WBYC10
     I              ELDTXS                      WBDTXS
     I              ELBCRC                      WBBCRC
     I              ELATAD                      WBATAD
     I              ELCTAD                      WBCTAD
     I              ELNRTA                      WBNRTA
     I              ELFNRT                      WBFNRT
     I              ELTAXP                      WBTAXP
     I              ELPRGF                      WBPRGF
     I              ELGFL5                      WBGFL5
     I              ELGFL6                      WBGFL6
     I              ELGAM1                      WBGAM1
     I              ELGAM2                      WBGAM2
     I              ELGEN4                      WBGEN4
     I              ELGEN5                      WBGEN5
     I              ELWTAD                      WBWTAD
     I              ELWTAF                      WBWTAF
     I              ELSMMF                      WBSMMF
     I              ELPYWP                      WBPYWP
     I              ELPWPG                      WBPWPG
     I              ELNETS                      WBNETS
     I              ELATFL                      WBATFL
     I              ELATRL                      WBATRL
     I              ELJOBS                      WBJOBS
     I              ELPSTE                      WBPSTE
     I              ELDWST                      WBDWST
     I              ELABDT                      WBABDT
     I              ELABTM                      WBABTM
     I              ELAJVN                      WBAJVN
     I              ELAKVN                      WBAKVN
     I              ELACDT                      WBACDT
     I              ELACTM                      WBACTM
     I              ELALVN                      WBALVN
     I              ELAMVN                      WBAMVN
     I              ELO6TX                      WBO6TX
     I              ELO7TX                      WBO7TX
      *
     II0911L0
      * Run Log J/E Detail F0911  Update index
      * Renamed input format fields
     I              GLEDUS                      WCEDUS
     I              GLEDBT                      WCEDBT
     I              GLEDTN                      WCEDTN
     I              GLEDLN                      WCEDLN
     I              GLEDTY                      WCEDTY
     I              GLEDSQ                      WCEDSQ
     I              GLEDCT                      WCEDCT
     I              GLEDTS                      WCEDTS
     I              GLEDFT                      WCEDFT
     I              GLEDDT                      WCEDDT
     I              GLEDER                      WCEDER
     I              GLEDDL                      WCEDDL
     I              GLEDSP                      WCEDSP
     I              GLEDTC                      WCEDTC
     I              GLEDTR                      WCEDTR
     I              GLEDGL                      WCEDGL
     I              GLEDAN                      WCEDAN
     I              GLKCO                       WCKCO
     I              GLDCT                       WCDCT
     I              GLDOC                       WCDOC
     I              GLDGJ                       WCDGJ
     I              GLJELN                      WCJELN
     I              GLEXTL                      WCEXTL
     I              GLPOST                      WCPOST
     I              GLICU                       WCICU
     I              GLICUT                      WCICUT
     I              GLDICJ                      WCDICJ
     I              GLDSYJ                      WCDSYJ
     I              GLTICU                      WCTICU
     I              GLCO                        WCCO
     I              GLANI                       WCANI
     I              GLAM                        WCAM
     I              GLAID                       WCAID
     I              GLMCU                       WCMCU
     I              GLOBJ                       WCOBJ
     I              GLSUB                       WCSUB
     I              GLSBL                       WCSBL
     I              GLSBLT                      WCSBLT
     I              GLLT                        WCLT
     I              GLPN                        WCPN
     I              GLCTRY                      WCCTRY
     I              GLFY                        WCFY
     I              GLFQ                        WCFQ
     I              GLCRCD                      WCCRCD
     I              GLCRR                       WCCRR
     I              GLHCRR                      WCHCRR
     I              GLHDGJ                      WCHDGJ
     I              GLAA                        WCAA
     I              GLU                         WCU
     I              GLUM                        WCUM
     I              GLGLC                       WCGLC
     I              GLRE                        WCRE
     I              GLEXA                       WCEXA
     I              GLEXR                       WCEXR
     I              GLR1                        WCR1
     I              GLR2                        WCR2
     I              GLR3                        WCR3
     I              GLSFX                       WCSFX
     I              GLODOC                      WCODOC
     I              GLODCT                      WCODCT
     I              GLOSFX                      WCOSFX
     I              GLPKCO                      WCPKCO
     I              GLOKCO                      WCOKCO
     I              GLPDCT                      WCPDCT
     I              GLAN8                       WCAN8
     I              GLCN                        WCCN
     I              GLDKJ                       WCDKJ
     I              GLDKC                       WCDKC
     I              GLASID                      WCASID
     I              GLBRE                       WCBRE
     I              GLRCND                      WCRCND
     I              GLSUMM                      WCSUMM
     I              GLPRGE                      WCPRGE
     I              GLTNN                       WCTNN
     I              GLALT1                      WCALT1
     I              GLALT2                      WCALT2
     I              GLALT3                      WCALT3
     I              GLALT4                      WCALT4
     I              GLALT5                      WCALT5
     I              GLALT6                      WCALT6
     I              GLALT7                      WCALT7
     I              GLALT8                      WCALT8
     I              GLALT9                      WCALT9
     I              GLALT0                      WCALT0
     I              GLALTT                      WCALTT
     I              GLALTU                      WCALTU
     I              GLALTV                      WCALTV
     I              GLALTW                      WCALTW
     I              GLALTX                      WCALTX
     I              GLALTZ                      WCALTZ
     I              GLDLNA                      WCDLNA
     I              GLCFF1                      WCCFF1
     I              GLCFF2                      WCCFF2
     I              GLASM                       WCASM
     I              GLBC                        WCBC
     I              GLVINV                      WCVINV
     I              GLIVD                       WCIVD
     I              GLWR01                      WCWR01
     I              GLPO                        WCPO
     I              GLPSFX                      WCPSFX
     I              GLDCTO                      WCDCTO
     I              GLLNID                      WCLNID
     I              GLWY                        WCWY
     I              GLWN                        WCWN
     I              GLFNLP                      WCFNLP
     I              GLOPSQ                      WCOPSQ
     I              GLJBCD                      WCJBCD
     I              GLJBST                      WCJBST
     I              GLHMCU                      WCHMCU
     I              GLDOI                       WCDOI
     I              GLALID                      WCALID
     I              GLALTY                      WCALTY
     I              GLDSVJ                      WCDSVJ
     I              GLTORG                      WCTORG
     I              GLREG#                      WCREG#
     I              GLPYID                      WCPYID
     I              GLUSER                      WCUSER
     I              GLPID                       WCPID
     I              GLJOBN                      WCJOBN
     I              GLUPMJ                      WCUPMJ
     I              GLUPMT                      WCUPMT
     I              GLCRRM                      WCCRRM
     I              GLACR                       WCACR
     I              GLDGM                       WCDGM
     I              GLDGD                       WCDGD
     I              GLDGY                       WCDGY
     I              GLDG#                       WCDG#
     I              GLDICM                      WCDICM
     I              GLDICD                      WCDICD
     I              GLDICY                      WCDICY
     I              GLDIC#                      WCDIC#
     I              GLDSYM                      WCDSYM
     I              GLDSYD                      WCDSYD
     I              GLDSYY                      WCDSYY
     I              GLDSY#                      WCDSY#
     I              GLDKM                       WCDKM
     I              GLDKD                       WCDKD
     I              GLDKY                       WCDKY
     I              GLDK#                       WCDK#
     I              GLDSVM                      WCDSVM
     I              GLDSVD                      WCDSVD
     I              GLDSVY                      WCDSVY
     I              GLDSV#                      WCDSV#
     I              GLHDGM                      WCHDGM
     I              GLHDGD                      WCHDGD
     I              GLHDGY                      WCHDGY
     I              GLHDG#                      WCHDG#
     I              GLDKCM                      WCDKCM
     I              GLDKCD                      WCDKCD
     I              GLDKCY                      WCDKCY
     I              GLDKC#                      WCDKC#
     I              GLDIM                       WCDIM
     I              GLDID                       WCDID
     I              GLDIY                       WCDIY
     I              GLDI#                       WCDI#
     I              GLABR1                      WCABR1
     I              GLABR2                      WCABR2
     I              GLABR3                      WCABR3
     I              GLABR4                      WCABR4
     I              GLABT1                      WCABT1
     I              GLABT2                      WCABT2
     I              GLABT3                      WCABT3
     I              GLABT4                      WCABT4
     I              GLITM                       WCITM
     I              GLPM01                      WCPM01
     I              GLPM02                      WCPM02
     I              GLPM03                      WCPM03
     I              GLPM04                      WCPM04
     I              GLPM05                      WCPM05
     I              GLPM06                      WCPM06
     I              GLPM07                      WCPM07
     I              GLPM08                      WCPM08
     I              GLPM09                      WCPM09
     I              GLPM10                      WCPM10
     I              GLBCRC                      WCBCRC
     I              GLEXR1                      WCEXR1
     I              GLTXA1                      WCTXA1
     I              GLTXIT                      WCTXIT
     I              GLACTB                      WCACTB
     I              GLSTAM                      WCSTAM
     I              GLCTAM                      WCCTAM
     I              GLAG                        WCAG
     I              GLAGF                       WCAGF
     I              GLTKTX                      WCTKTX
     I              GLDLNI                      WCDLNI
     I              GLCKNU                      WCCKNU
     I              GLBUPC                      WCBUPC
     I              GLAHBU                      WCAHBU
     I              GLEPGC                      WCEPGC
     I              GLJPGC                      WCJPGC
     I              GLRC5                       WCRC5
     I              GLSFXE                      WCSFXE
     I              GLOFM                       WCOFM
     I              GLDTNB                      WCDTNB
     I              GLDUNB                      WCDUNB
     I              GLO6TX                      WCO6TX
     I              GLO7TX                      WCO7TX
     I              GLDWST                      WCDWST
     I              GLABDT                      WCABDT
     I              GLABTM                      WCABTM
     I              GLAJVN                      WCAJVN
     I              GLAKVN                      WCAKVN
     I              GLACDT                      WCACDT
     I              GLACTM                      WCACTM
     I              GLALVN                      WCALVN
     I              GLAMVN                      WCAMVN
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
     C     P1NSST        PARM                    WP0001                         Allow Update Y/
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
     C                   DO        *HIVAL
      * Initialise & load subfile page
     C                   EXSR      BAIZSF
     C                   MOVEL     'N'           W0RSF
      * Display screen until reload requested
      * Display screen
     C                   DOW       W0RSF = 'N'
     C                   EXSR      CAEXFM
      * Process response
      * Cancel & exit program
     C   03              CAS                     ZXEXPG
      * HOME: Request subfile reload
     C   05              CAS                     FBRQRL
      * Display next SFL page
     C   27
     COR 08              CAS                     BBLDSF
      * Process screen input
     C                   CAS                     DAPR##
     C                   END
      *
     C                   END                                                    OD W0RSF
     C                   END                                                    OD *HIVAL
      *****************************************************************
      /EJECT
     CSR   BAIZSF        BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                   SETON                                        80
     C                   WRITE     #SFLCTL
     C                   SETOFF                                       80
      * Reset no of records in subfile
     C                   Z-ADD     *ZERO         ##RRMX               81         SETOF 81
      * USER: Initialize subfile control
     C                   Z-ADD     20000         W0SLM                          *Scan limit
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : CTL.USR Date cyymmdd is Entered
      *   |- c2    : CTL.Batch Type NE WRK.Blank usr
      *   |- c3    : CTL.Batch Number is Entered
      *   |- c4    : CTL.User ID NE WRK.Blank usr
      *   '-
     C                   IF        #CAFDT > 0 OR
     C                             #2ICUT <> WUPUTX OR
     C                             #2ICU <> 0 OR
     C                             #2USER <> WUPUTX
     C                   ELSE
      * CASE: *OTHERWISE
     C                   Z-ADD     ##JDT         #CAFDT                         USR Date cyymmd
     C                   END                                                    *FI
      * Position DBF file
     C     KPOS          KLIST
     C                   KFLD                    ICICUT                         Batch Type
     C                   KFLD                    ICICU                          Batch Number
      * Setup key
     C                   MOVEL     #2ICUT        ICICUT
     C                   Z-ADD     #2ICU         ICICU
     C     KPOS          SETLL     I0011L1
     C                   READ      I0011L1                              8782    *82=EOF
      * Save previous selector values
     C                   MOVEL     #2DICJ        WZDICJ                         Batch Date
     C                   MOVEL     #2ICUT        WZICUT                         Batch Type
     C                   MOVEL     #2ICU         WZICU                          Batch Number
     C                   MOVEL     #2IST         WZIST                          Batch Status
     C                   MOVEL     #2USER        WZUSER                         User ID
      * Load subfile page
     C                   Z-ADD     0             ##RROK
     C                   EXSR      BBLDSF
      *================================================================
     CSR   BAEXIT        ENDSR
      /EJECT
     CSR   BBLDSF        BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27
     COR 08              DO
     C  N82              READP     I0011L1                                90    *
     C  N82              READ      I0011L1                                90    *
     C                   END
      *
      * Setof record error indicators
     C                   MOVEL     *ALL'0'       WKIND0
     C                   MOVEA     WKIND0        *IN(36)
      * Start at previous highest record in SFL
     C                   Z-ADD     ##RRMX        ##RR
      * Reset count of DBF records read
     C                   Z-ADD     0             ##RRRD
      * Set required pages based on *Set Cursor or *Subfile Pages
     C                   IF        W0RR0 > 0
     C     W0RR0         DIV       ##SFPG        ##SPG
     C                   MVR                     ##SLIN
     C                   IF        ##SLIN > 0
     C                   ADD       1             ##SPG
     C                   END
     C                   IF        W0SPG > ##SPG
     C                   Z-ADD     W0SPG         ##SPG
     C                   END
     C                   ELSE
     C                   Z-ADD     W0SPG         ##SPG
     C                   END
      * Compute lines required based on pages
     C     ##SPG         MULT      ##SFPG        ##SFLN
     C                   IF        ##SFLN > 999
     C                   Z-ADD     999           ##SFLN
     C                   END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
      * Check selection fields - if fail, read next record
     C                   DOW       NOT *IN82 AND
     C                             ##RROK < ##SFLN AND
     C                             ##RRRD < W0SLM
     C                   IF        #2DICJ <> *ZERO
     C     ICDICJ        CABNE     #2DICJ        BB020                          Batch Date
     C                   END
     C                   IF        #2ICUT = ' '
     C                   IF        #2ICU <> *ZERO
     C     ICICU         CABNE     #2ICU         BB020                          Batch Number
     C                   END
     C                   END
     C                   IF        #2IST <> ' '
     C     ICIST         CABNE     #2IST         BB020                          Batch Status
     C                   END
     C                   IF        #2USER <> ' '
     C     ICUSER        CABNE     #2USER        BB020                          User ID
     C                   END
      * Load SFL fields
     C                   EXSR      MBFL#1
     C                   MOVEL     'Y'           W0RSL
      * Allow for possible *Set Cursor processing
     C                   ADD       1             ##RR
      * USER: Initialize subfile record from DBF record
     C                   Z-ADD     #1DICJ        YL0001                         USR Date Julian
      * Get MDY from JUL    X0028 - STR X* RPG Programs  * 
     C                   CALL      'E10028C'                            90      Get MDY from JU
     C                   PARM      YL0001        WQ0001                         USR Date Julian
     C     #RAFDT        PARM      *ZERO         WQ0002                         USR Date cyymmd
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E10028C'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        98        *
     C                   END
      * CASE: CTL.USR Date cyymmdd is Entered
      * CASE: CTL.USR Date cyymmdd EQ RCD.USR Date cyymmdd
     C                   IF        #CAFDT > 0
     C                   IF        #CAFDT = #RAFDT
     C                   ELSE
      * CASE: *OTHERWISE
     C                   MOVEL     'N'           W0RSL                          *Record selecte
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   SUB       1             ##RR
      * DBF record not selected
     C     W0RSL         CABNE     'Y'           BB020
      * Convert fields to external form
     C                   EXSR      MNCV#1
      * Output to subfile
     C                   ADD       1             ##RR
     C                   ADD       1             ##RROK               81        *
      * If SFLRCD invalid, note that errors present
     C   98
     CANN99              SETON                                        99        *
     C                   WRITE     #SFLRCD
     C     BB020         TAG
      * Increment scan check count
     C                   ADD       1             ##RRRD
     C                   READ      I0011L1                                82    *82=EOF
     C                   END                                                    OD 1 - ##SFPG
      *................................................................
     C     BB900         TAG
      *................................................................
      * If no DBF records found, display error message
      * Send message '*No data to display'
     C                   IF        ##RR = *ZERO AND
     C                             *IN82
     C                   MOVEL     'Y2U0008'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END                                                    FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
      * Calculate top line
     C                   IF        ##RR > ##RRMX
     C     ##RROK        DIV       ##SFPG        ##SPG
     C                   MVR                     ##SLIN
     C                   IF        ##SLIN > 0
     C     ##RR          SUB       ##SLIN        ##SFRC
     C                   ELSE
     C     ##RR          SUB       ##SFPG        ##SFRC
     C                   END
     C                   ADD       1             ##SFRC
     C                   Z-ADD     ##RR          ##RRMX
     C                   END
      * If scan limit reached, display error message
      * Send message '*Scan limit reached'
     C                   IF        ##RRRD >= W0SLM
     C                   MOVEL     'Y2U0017'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   ELSE
     C                   Z-ADD     0             ##RROK
     C                   END
      *================================================================
     CSR   BBEXIT        ENDSR
      /EJECT
     CSR   CAEXFM        BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N05
     CANN27              EXSR      MOCV#2
     C                   DOU       W0HLP = 'N'
     C                   MOVEL     'N'           W0HLP
     C                   MOVE      *IN04         YPMT04
     C                   MOVE      *IN25         HELP25
     C                   MOVE      *ALL'0'       ##OFF
     C                   MOVEA     ##OFF         *IN(1)
     C                   MOVE      YPMT04        *IN04
     C                   MOVE      HELP25        *IN25
      * Update screen time
     C                   TIME                    ##TME
      * PUTOVR unless conditioned fields change
     C                   SETON                                        86
     C                   IF        *IN81 <> CAIN81
     C                   SETOFF                                       86
     C                   END
     C                   MOVE      *IN81         CAIN81
      * Set cursor by *SET CURSOR data
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y0SET
     C                   END
     C                   WRITE     #MSGCTL
     C                   WRITE     #CMDTXT1
     C                   EXFMT     #SFLCTL
      * Maintain subfile position where possible
     C                   IF        @#SFRC > *ZERO
     C                   Z-ADD     @#SFRC        ##SFRC
     C                   END
      * Test cursor
     C                   EXSR      Y8TST
      * Check if prompt requested
     C                   EXSR      ZDVPMT
      * Clear set cursor DDS indicator
     C                   IF        WCSRLC = 'OFF'
     C                   SETOFF                                       94        *
     C                   END
     C                   EVALR     WCSRLC = ' '
      * If help requested, display help text
     C   25              EXSR      ZHHPKY
     C                   END
      * Update job time
     C                   TIME                    ##JTM
      * Clear messages from program message queue
     C                   CALL      'Y2CLMSC'
     C                   PARM      ##PGM         ZAPGMQ
     C                   PARM      '*SAME'       ZAPGRL
      * Reset first message only flag
     C                   MOVEL     'Y'           ZAFSMS                   99    *
     C                   SETOFF                                         8392    *
     C                   IF        YSETCS = 'Y'
     C                   EXSR      Y9CLR
     C                   END
      *================================================================
     CSR   CAEXIT        ENDSR
      /EJECT
     CSR   DAPR##        BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                   MOVEL     'N'           W0DCF
      * Validate Batch Status
     C                   EVAL      W0RTN = ' '
      * Name search required?
      * Batch Status
     C                   IF        '#2IST' = YPMTFD
     C                   MOVEL     #2IST         W0INVL
      * Set current value in drop down list.
     C                   MOVEL     *ZEROS        #FIST
     C                   SELECT
     C                   WHEN      W0INVL = 'D'                                 D
     C                   Z-ADD     1             #FIST
     C                   WHEN      W0INVL = 'A'                                 A
     C                   Z-ADD     2             #FIST
     C                   WHEN      W0INVL = 'P'                                 P
     C                   Z-ADD     3             #FIST
     C                   WHEN      W0INVL = 'U'                                 U
     C                   Z-ADD     4             #FIST
     C                   WHEN      W0INVL = 'X'                                 X
     C                   Z-ADD     5             #FIST
     C                   WHEN      W0INVL = *BLANK                              *BLANK
     C                   Z-ADD     6             #FIST
     C                   ENDSL
     C                   EXFMT     #EIST
      * Set selected value from drop down list.
     C                   EVAL      W0INVL = ' '
     C                   SELECT
     C                   WHEN      #FIST = 1
     C                   MOVEL     'D'           W0INVL                         D
     C                   WHEN      #FIST = 2
     C                   MOVEL     'A'           W0INVL                         A
     C                   WHEN      #FIST = 3
     C                   MOVEL     'P'           W0INVL                         P
     C                   WHEN      #FIST = 4
     C                   MOVEL     'U'           W0INVL                         U
     C                   WHEN      #FIST = 5
     C                   MOVEL     'X'           W0INVL                         X
     C                   WHEN      #FIST = 6
     C                   EVAL      W0INVL = ' '                                 *BLANK
     C                   ENDSL
     C                   SETOFF                                       90        *
     C                   MOVEL     W0INVL        #2IST
      * Defer confirm
     C                   MOVEL     'Y'           W0DCF
     C                   MOVEL     '*DONE'       YPMTFD
     C                   END
      *
      * Validate USR Date cyymmdd
      * External date
     C                   Z-ADD     VCAFDT        XDEXDT
      * Check date
     C                   EXSR      XDCK2
     C                   IF        W0RTN <> ' '
     C                   SETON                                        9935      *
     C                   END
     C                   Z-ADD     XDINDT        #CAFDT
      * If error, exit
     C     *IN99         CABEQ     '1'           DAEXIT
      *................................................................
     C                   IF        YPMTFD <> ' ' AND
     C                             YPMRRN = *ZERO
     C                   GOTO      DAEXIT
     C                   END
     C     YPMTFD        CABNE     *BLANKS       DATAG1
      * Change of position specified
     C     WZICUT        CASNE     #2ICUT        FBRQRL
     C     WZICU         CASNE     #2ICU         FBRQRL
     C     WZIST         CASNE     #2IST         FBRQRL
     C     WZUSER        CASNE     #2USER        FBRQRL
     C                   END
     C     DATAG1        TAG
      * Reload subfile requested
     C                   IF        YPMTFD = ' '
     C     W0RSF         CABEQ     'Y'           DAEXIT
     C                   END
      * Process subfile records
     C                   IF        *IN81
     C                   EXSR      DBPRSF
     C                   END
     C     YPMTFD        CABNE     *BLANKS       DAEXIT
      * USER: Final processing (Pre-confirm)
     C                   MOVEL     'Y'           W0RSF                          *Reload subfile
      * If error, quit processing
     C     *IN99         CABEQ     '1'           DAEXIT
      * Defer confirm/update requested
     C     W0DCF         CABEQ     'Y'           DAEXIT
      * USER: Process command keys
      * CASE: CTL.*CMD key is CF05
     C                   IF        *IN05
     C                   MOVEL     'Y'           W0RSF                          *Reload subfile
     C                   END                                                    *FI
      * CASE: CTL.*CMD key is CF10
      * CASE: PAR.Allow Update Y/N is Yes
     C                   IF        *IN10
      * Exc Rtv/Wrt E1 F0011   UP - Batch Control File F0011  * 
     C                   IF        P1NSST = 'Y'
     C                   CALL      'E1JZUPR'                            90      Exc Rtv/Wrt E1
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1JZUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
     C                   END
     C                   MOVEL     'Y'           W0RSF                          *Reload subfile
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                   MOVEL     WUPUTX        ZA0001                         Blank usr
      * Send message 'Option Not Allowed'
     C                   MOVEL     'E1I0184'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   END                                                    *FI
     C                   END                                                    *FI
      *================================================================
     CSR   DAEXIT        ENDSR
      /EJECT
     CSR   DBPRSF        BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C                   IF        YAFSCH <> *ZERO
     C     YAFSCH        CHAIN     #SFLRCD                            92        *
     C                   ELSE
     C                   READC     #SFLRCD                                92    *
     C                   END
      * Process subfile record
     C                   DOW       NOT *IN92
     C                   EXSR      DCPRSR
      * Convert fields to external form
     C                   EXSR      MNCV#1
     C                   UPDATE    #SFLRCD
     C                   READC     #SFLRCD                                92    *
     C                   END
      *================================================================
     CSR   DBEXIT        ENDSR
      /EJECT
     CSR   DCPRSR        BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                   MOVEA     WKIND0        *IN(36)
     C                   SETOFF                                       98        *
     C     YPMTFD        CABNE     *BLANKS       DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * CASE: PAR.Allow Update Y/N is Yes
      * set to unprocessed
      * CASE: RCD.*SFLSEL is Edit
     C                   IF        P1NSST = 'Y'
      * Chg Batch Ctl Sts     CH - Batch Control File F0011  * 
      * Move input parameters to subroutine local variables.
     C                   IF        #1SEL = '2'
     C                   MOVEL(P)  #1ICUT        WL0001                         Batch Type
     C                   Z-ADD     #1ICU         WL0002                         Batch Number
     C                   EVAL      WL0003 = ' '                                 Batch Status
     C                   EVAL      WL0004 = ' '                                 E1 Process Erro
     C                   EVAL      WL0005 = ' '                                 E1 Process Erro
     C                   EXSR      SACHRC
     C                   EVAL      YL0002 = ' '                                 EDI - Batch Num
     C                   MOVEL     #1ICU         YL0002                         EDI - Batch Num
      * Rtv Set Batch to Unprc RT - Run Log Vchr Dtl   F0411  * 
     C                   EXSR      SBRVGN
      * Rtv Set Batch to Unprc RT - Run Log J/E Detail F0911  * 
     C                   EXSR      SDRVGN
     C                   END                                                    *FI
      * Process 011/0411/0911
      * CASE: RCD.*SFLSEL is Option 3
     C                   IF        #1SEL = '3'
     C                   EVAL      YL0002 = ' '                                 EDI - Batch Num
     C                   MOVEL     #1ICU         YL0002                         EDI - Batch Num
      * Exc Write Batch to Zf  UP - Batch Control File F0011  * 
     C                   CALL      'E1LBUPR'                            90      Exc Write Batch
     C                   PARM      YL0003        WQ0003                         Return Code
     C                   PARM      #1ICU         WQ0004                         Batch Number
     C                   PARM      #1USER        WQ0005                         User ID
     C                   PARM      #1ICUT        WQ0006                         Batch Type
     C                   PARM      YL0002        WQ0007                         EDI - Batch Num
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1LBUPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        98        *
     C                   END
     C                   MOVEL     'Y'           W0RSF                          *Reload subfile
     C                   END                                                    *FI
      * X to not process
      * CASE: RCD.*SFLSEL is *Delete
      * Chg Batch Ctl Sts     CH - Batch Control File F0011  * 
      * Move input parameters to subroutine local variables.
     C                   IF        #1SEL = '4' OR
     C                             #1SEL = ' 4'
     C                   MOVEL(P)  #1ICUT        WL0001                         Batch Type
     C                   Z-ADD     #1ICU         WL0002                         Batch Number
     C                   MOVEL(P)  'X'           WL0003                         Batch Status
     C                   MOVEL(P)  #1O6TX        WL0004                         E1 Process Erro
     C                   MOVEL(P)  #1O7TX        WL0005                         E1 Process Erro
     C                   EXSR      SACHRC
     C                   END                                                    *FI
     C                   ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                   MOVEL     #1SEL         ZA0002                         *SFLSEL
      * Send message 'Option Not Allowed'
     C                   MOVEL     'E1I0184'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        9836      *
      *
     C                   END                                                    *FI
      * Dsp 0411
      * CASE: RCD.*SFLSEL is *Display
     C                   IF        #1SEL = '5' OR
     C                             #1SEL = ' 5'
     C                   EVAL      YL0002 = ' '                                 EDI - Batch Num
     C                   MOVEL     #1ICU         YL0002                         EDI - Batch Num
      * Dsp E10411 Voucher Ent DF - Run Log Vchr Dtl   F0411  * 
     C                   CALL      'E1BJDFR'                            90      Dsp E10411 Vouc
     C                   PARM      *BLANK        W0RTN
     C                   PARM      #1USER        WQ0008                         EDI - User ID
     C                   PARM      YL0002        WQ0009                         EDI - Batch Num
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1BJDFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        98        *
     C                   END
     C                   END                                                    *FI
      * Dsp 0911
      * CASE: RCD.*SFLSEL is Option 9
     C                   IF        #1SEL = '9'
     C                   EVAL      YL0002 = ' '                                 EDI - Batch Num
     C                   MOVEL     #1ICU         YL0002                         EDI - Batch Num
      * Dsp E10911 J/E       DF - Run Log J/E Detail F0911  * 
     C                   CLEAR                   PARC
     C                   MOVEL(P)  #1USER        PAEDUS                         EDI - User ID
     C                   MOVEL(P)  YL0002        PAEDBT                         EDI - Batch Num
      *
     C                   CALL      'E1BIDFR'                            90      Dsp E10911 J/E
     C                   PARM      *BLANK        W0RTN
     C                   PARM                    PARC                           KEY: Run Log J/
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1BIDFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        98        *
     C                   END
     C                   END                                                    *FI
      * Eml details
      * CASE: RCD.*SFLSEL is Option 8
     C                   IF        #1SEL = '8'
     C                   EVAL      YL0002 = ' '                                 EDI - Batch Num
     C                   MOVEL     #1ICU         YL0002                         EDI - Batch Num
      * Exc Search DistributionEX - STR User Source Functions  * 
     C                   CALL      'E1M1UPR'                            90      Exc Search Dist
     C     YL0004        PARM      *BLANK        WQ0010                         Email ID USR
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'E1M1UPR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   SETON                                        98        *
     C                   END
      * CASE: LCL.Email ID USR is Entered
      * Setup message data for message
     C                   IF        YL0004 <> ' '
     C                   MOVEL     YL0002        ZA0003                         EDI - Batch Num
      * Send message 'Email generated for batch'
     C                   MOVEL     'E1I0186'     ZAMSID
     C                   MOVEL     '*INFO  '     ZAMSTP                         Message type
     C                   EXSR      ZASNMS
      *
      * Setup message data for message
     C                   MOVEL     YL0002        ZA0004                         EDI - Batch Num
     C                   MOVEL     YL0004        ZA0005                         Email ID USR
     C                   MOVEL     YL0002        ZA0006                         EDI - Batch Num
      *
      * Execute message
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   CALL      'Y2EXMCC'                            90      *
     C                   PARM      *BLANK        W0RTN                          Return code
     C                   PARM      'E1I0183'     ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSGF = ' '
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   END
      *
      * Error detected during execution
     C                   IF        W0RTN <> ' '
     C                   SETON                                        98        *
     C                   END
      *
     C                   ELSE
      * CASE: *OTHERWISE
      * Send message 'Email ID is not found'
     C                   MOVEL     'E1I0185'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        98        *
      *
     C                   GOTO      DCEXIT                                       *QUIT
     C                   END                                                    *FI
     C                   END                                                    *FI
      * SFLRCD invalid
     C                   IF        *IN98
     C  N99              Z-ADD     ##RR          ##SFRC               99        *
      * SFLNXTCHG
     C                   SETON                                        84
     C                   ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                   SETOFF                                       84
     C                   EVAL      #1SEL = ' '
     C                   END                                                    FI *IN98
      *================================================================
     CSR   DCEXIT        ENDSR
      /EJECT
     CSR   FBRQRL        BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                   MOVEL     'Y'           W0RSF
      *================================================================
     CSR   FBEXIT        ENDSR
      /EJECT
     CSR   MBFL#1        BEGSR
      *================================================================
      * Move I0011L1 fields to subfile
      *================================================================
     C                   EVAL      #1SEL = ' '
     C                   Z-ADD     ICDICJ        #1DICJ                         Batch Date
     C                   MOVEL     ICBAL         #1BAL                          Balanced-Docs a
     C                   MOVEL     ICBALJ        #1BALJ                         Journal Entries
     C                   Z-ADD     ICDOCN        #1DOCN                         Documents Enter
     C                   MOVEL     ICAUSR        #1AUSR                         Authorized User
     C                   MOVEL     ICPOB         #1POB                          Post Out of Bal
     C                   MOVEL     ICIBOI        #1IBOI                         Include Batch o
     C                   Z-ADD     ICAIPT        #1AIPT                         Amount - input
     C                   MOVEL     ICOFFP        #1OFFP                         Auto Offset Mod
     C                   MOVEL     ICPID         #1PID                          Program ID
     C                   MOVEL     ICJOBN        #1JOBN                         Work Station ID
     C                   Z-ADD     ICUPMJ        #1UPMJ                         Date Updated 1
     C                   Z-ADD     ICUPTM        #1UPTM                         Time Last Updat
     C                   MOVEL     ICDRSP        #1DRSP                         Detailed Restat
     C                   MOVEL     ICS2PP        #1S2PP                         52 Period Proce
     C                   MOVEL     ICCBP         #1CBP                          Cash Basis Proc
     C                   MOVEL     ICICUT        #1ICUT                         Batch Type
     C                   Z-ADD     ICICU         #1ICU                          Batch Number
     C                   MOVEL     ICIST         #1IST                          Batch Status
     C                   MOVEL     ICIAPP        #1IAPP                         Batch Approval
     C                   Z-ADD     ICAICU        #1AICU                         Input Total
     C                   MOVEL     ICUSER        #1USER                         User ID
     C                   Z-ADD     ICAME         #1AME                          Amount Entered
     C                   Z-ADD     ICNDO         #1NDO                          Number of Docs
     C                   MOVEL     ICO6TX        #1O6TX                         E1 Process Erro
     C                   MOVEL     ICO7TX        #1O7TX                         E1 Process Erro
     C                   EVAL      #1SEL = ' '                                  *SFLSEL
     C                   Z-ADD     *ZERO         #RAFDT                         USR Date cyymmd
      * Clear external version also
     C                   Z-ADD     *ZERO         VRAFDT
      *================================================================
     CSR   MBEXIT        ENDSR
      /EJECT
     CSR   MEIZ#2        BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                   Z-ADD     *ZERO         #2DICJ                         Batch Date
     C                   EVAL      #2ICUT = ' '                                 Batch Type
     C                   Z-ADD     *ZERO         #2ICU                          Batch Number
     C                   EVAL      #2IST = ' '                                  Batch Status
     C                   EVAL      #2USER = ' '                                 User ID
     C                   Z-ADD     *ZERO         #CAFDT                         USR Date cyymmd
      * Clear external version also
     C                   Z-ADD     *ZERO         VCAFDT
      *================================================================
     CSR   MEEXIT        ENDSR
      /EJECT
     CSR   MNCV#1        BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert USR Date cyymmdd to display format
      * Convert date
     C     1000000       ADD       #RAFDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VRAFDT
      *================================================================
     CSR   MNEXIT        ENDSR
      /EJECT
     CSR   MOCV#2        BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert USR Date cyymmdd to display format
      * Convert date
     C     1000000       ADD       #CAFDT        XDINDT
     C                   EXSR      XDVC2T
     C                   Z-ADD     XDEXDT        VCAFDT
      *================================================================
     CSR   MOEXIT        ENDSR
      /EJECT
     CSR   SACHRC        BEGSR
      *================================================================
      * Chg Batch Ctl Sts     CH - Batch Control File F0011  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 Batch Approval
     C                   Z-ADD     *ZERO         WN0002                         Input Total
     C                   EVAL      WN0003 = ' '                                 User ID
     C                   Z-ADD     *ZERO         WN0004                         Batch Date
     C                   Z-ADD     *ZERO         WN0005                         Number of Docs
     C                   EVAL      WN0006 = ' '                                 Balanced-Docs a
     C                   EVAL      WN0007 = ' '                                 Journal Entries
     C                   Z-ADD     *ZERO         WN0008                         Amount Entered
     C                   Z-ADD     *ZERO         WN0009                         Documents Enter
     C                   EVAL      WN0010 = ' '                                 Authorized User
     C                   EVAL      WN0011 = ' '                                 Post Out of Bal
     C                   EVAL      WN0012 = ' '                                 Include Batch o
     C                   Z-ADD     *ZERO         WN0013                         Amount - input
     C                   EVAL      WN0014 = ' '                                 Auto Offset Mod
     C                   EVAL      WN0015 = ' '                                 Program ID
     C                   EVAL      WN0016 = ' '                                 Work Station ID
     C                   Z-ADD     *ZERO         WN0017                         Date Updated 1
     C                   Z-ADD     *ZERO         WN0018                         Time Last Updat
     C                   EVAL      WN0019 = ' '                                 Detailed Restat
     C                   EVAL      WN0020 = ' '                                 52 Period Proce
     C                   EVAL      WN0021 = ' '                                 Cash Basis Proc
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to I0011L0
     C                   MOVEL(P)  WL0001        WAICUT                         Batch Type
     C                   Z-ADD     WL0002        WAICU                          Batch Number
      *
     C     KLCHSA        KLIST
     C                   KFLD                    WAICUT                         Batch Type
     C                   KFLD                    WAICU                          Batch Number
     C     KLCHSA        CHAIN     I0011L0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10011L0'    MDACP
     C                   MOVEL     'I0011L0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SAEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QE1001        YARDCS
      * Move non-key fields to I0011L0
     C                   MOVEL(P)  WL0003        WAIST                          Batch Status
     C                   MOVEL(P)  WL0004        WAO6TX                         E1 Process Erro
     C                   MOVEL(P)  WL0005        WAO7TX                         E1 Process Erro
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QE1001 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    I0011L0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    E10011L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Rtv Set Batch to Unprc RT - Run Log Vchr Dtl   F0411  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB01                         EDI - User ID
     C                   KFLD                    WQSB02                         EDI - Batch Num
      * Setup key
     C                   MOVEL     #1USER        WQSB01                         EDI - User ID
     C                   MOVEL     YL0002        WQSB02                         EDI - Batch Num
      * Establish starting position
     C     KRSSB         SETLL     I0411L1                                      *
     C     KRSSB         READE     I0411L1                                90    *
      * Data record not found
     C   90              MOVEL     'E1I0074'     W0RTN
      * USER: Process Data record
      * Chg F0411 Proc Sts    CH - Run Log Vchr Dtl   F0411  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SCCHRC
     C     KRSSB         READE     I0411L1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCHRC        BEGSR
      *================================================================
      * Chg F0411 Proc Sts    CH - Run Log Vchr Dtl   F0411  * 
      *================================================================
      *
     C                   EVAL      WN0022 = ' '                                 Type Record
     C                   Z-ADD     *ZERO         WN0023                         Record Sequence
     C                   EVAL      WN0024 = ' '                                 EDI - Document
     C                   EVAL      WN0025 = ' '                                 EDI - Transacti
     C                   EVAL      WN0026 = ' '                                 EDI - Translati
     C                   Z-ADD     *ZERO         WN0027                         EDI - Transmiss
     C                   EVAL      WN0028 = ' '                                 EDI - Send/Rece
     C                   Z-ADD     *ZERO         WN0029                         EDI - Dtl Lines
     C                   EVAL      WN0030 = ' '                                 EDI - Transacti
     C                   EVAL      WN0031 = ' '                                 EDI - Transacti
     C                   EVAL      WN0032 = ' '                                 Batch File Crea
     C                   EVAL      WN0033 = ' '                                 Batch File Disc
     C                   Z-ADD     *ZERO         WN0034                         User Address nu
     C                   EVAL      WN0035 = ' '                                 Document Compan
     C                   Z-ADD     *ZERO         WN0036                         Document Number
     C                   EVAL      WN0037 = ' '                                 Document Type
     C                   EVAL      WN0038 = ' '                                 Document Pay It
     C                   Z-ADD     *ZERO         WN0039                         Pay Item Extens
     C                   EVAL      WN0040 = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         WN0041                         Address Number
     C                   Z-ADD     *ZERO         WN0042                         Payee Address N
     C                   Z-ADD     *ZERO         WN0043                         Address Number
     C                   Z-ADD     *ZERO         WN0044                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0045                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0046                         Date - Net Due
     C                   Z-ADD     *ZERO         WN0047                         Discount Due Da
     C                   Z-ADD     *ZERO         WN0048                         G/L Date
     C                   Z-ADD     *ZERO         WN0049                         Fiscal Year
     C                   Z-ADD     *ZERO         WN0050                         Century
     C                   Z-ADD     *ZERO         WN0051                         Period Number -
     C                   EVAL      WN0052 = ' '                                 Company
     C                   Z-ADD     *ZERO         WN0053                         Batch Number
     C                   EVAL      WN0054 = ' '                                 Batch Type
     C                   Z-ADD     *ZERO         WN0055                         Batch Date
     C                   EVAL      WN0056 = ' '                                 Journal Entries
     C                   EVAL      WN0057 = ' '                                 Pay Status Code
     C                   Z-ADD     *ZERO         WN0058                         Gross Amount
     C                   Z-ADD     *ZERO         WN0059                         Open Amount
     C                   Z-ADD     *ZERO         WN0060                         Discount Availa
     C                   Z-ADD     *ZERO         WN0061                         Discount Taken
     C                   Z-ADD     *ZERO         WN0062                         Taxable Amount
     C                   Z-ADD     *ZERO         WN0063                         Non-Taxable Amo
     C                   Z-ADD     *ZERO         WN0064                         Tax Amount
     C                   EVAL      WN0065 = ' '                                 Tax Rate_Area
     C                   EVAL      WN0066 = ' '                                 Tax Expl Code 1
     C                   EVAL      WN0067 = ' '                                 Currency Mode
     C                   EVAL      WN0068 = ' '                                 Currency Code F
     C                   Z-ADD     *ZERO         WN0069                         Currency Conver
     C                   Z-ADD     *ZERO         WN0070                         Currency Amount
     C                   Z-ADD     *ZERO         WN0071                         Foreign Open Am
     C                   Z-ADD     *ZERO         WN0072                         Foreign Disc Av
     C                   Z-ADD     *ZERO         WN0073                         Foreign Disc Ta
     C                   Z-ADD     *ZERO         WN0074                         Foreign Taxable
     C                   Z-ADD     *ZERO         WN0075                         Foreign Non-Tax
     C                   Z-ADD     *ZERO         WN0076                         Foreign Tax Amo
     C                   EVAL      WN0077 = ' '                                 G/L Offset
     C                   EVAL      WN0078 = ' '                                 G/L Bank Accoun
     C                   EVAL      WN0079 = ' '                                 G/L Posted Flag
     C                   EVAL      WN0080 = ' '                                 Account Mode -
     C                   EVAL      WN0081 = ' '                                 Account ID 2
     C                   EVAL      WN0082 = ' '                                 Business Unit/C
     C                   EVAL      WN0083 = ' '                                 Object Account
     C                   EVAL      WN0084 = ' '                                 Subsidiary
     C                   EVAL      WN0085 = ' '                                 Subledger Type
     C                   EVAL      WN0086 = ' '                                 Subledger - G/L
     C                   EVAL      WN0087 = ' '                                 Bank Transit Sh
     C                   EVAL      WN0088 = ' '                                 Payment Terms C
     C                   EVAL      WN0089 = ' '                                 Void Flag
     C                   EVAL      WN0090 = ' '                                 Document Co - O
     C                   EVAL      WN0091 = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         WN0092                         Document - Orig
     C                   EVAL      WN0093 = ' '                                 Document Pay It
     C                   EVAL      WN0094 = ' '                                 Payment Handlin
     C                   EVAL      WN0095 = ' '                                 Supplier Invoic
     C                   EVAL      WN0096 = ' '                                 Document Co - P
     C                   EVAL      WN0097 = ' '                                 Purchase Order
     C                   EVAL      WN0098 = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         WN0099                         Line number
     C                   EVAL      WN0100 = ' '                                 Order Suffix
     C                   Z-ADD     *ZERO         WN0101                         Sequence Nbr -
     C                   EVAL      WN0102 = ' '                                 Reference
     C                   EVAL      WN0103 = ' '                                 Unit
     C                   EVAL      WN0104 = ' '                                 Business Unit 2
     C                   EVAL      WN0105 = ' '                                 Name - Remark
     C                   EVAL      WN0106 = ' '                                 Frequency - Rec
     C                   Z-ADD     *ZERO         WN0107                         Recurring Freq
     C                   EVAL      WN0108 = ' '                                 Control/Stateme
     C                   EVAL      WN0109 = ' '                                 Closed Item as
     C                   Z-ADD     *ZERO         WN0110                         Units
     C                   EVAL      WN0111 = ' '                                 Unit of Measure
     C                   EVAL      WN0112 = ' '                                 Payment Instrum
     C                   EVAL      WN0113 = ' '                                 Tax Rate Area 3
     C                   EVAL      WN0114 = ' '                                 Tax Expl Code 3
     C                   EVAL      WN0115 = ' '                                 A/R-A/P-Misc Co
     C                   EVAL      WN0116 = ' '                                 A/R-A/P-Misc Co
     C                   EVAL      WN0117 = ' '                                 A/R-A/P-Cash Rc
     C                   EVAL      WN0118 = ' '                                 Catg Code - Add
     C                   EVAL      WN0119 = ' '                                 Flag for 1099
     C                   EVAL      WN0120 = ' '                                 Dom Entry w/ Mu
     C                   Z-ADD     *ZERO         WN0121                         Item Number - S
     C                   Z-ADD     *ZERO         WN0122                         Historical Curr
     C                   Z-ADD     *ZERO         WN0123                         Historical Date
     C                   EVAL      WN0124 = ' '                                 User Reserved C
     C                   Z-ADD     *ZERO         WN0125                         User Reserved D
     C                   Z-ADD     *ZERO         WN0126                         User Reserved A
     C                   Z-ADD     *ZERO         WN0127                         User Reserved N
     C                   EVAL      WN0128 = ' '                                 User Reserved R
     C                   EVAL      WN0129 = ' '                                 Transaction Ori
     C                   EVAL      WN0130 = ' '                                 User ID
     C                   EVAL      WN0131 = ' '                                 Program ID
     C                   Z-ADD     *ZERO         WN0132                         Date Updated 1
     C                   Z-ADD     *ZERO         WN0133                         Time Last Updat
     C                   EVAL      WN0134 = ' '                                 Work Station ID
     C                   Z-ADD     *ZERO         WN0135                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0136                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0137                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0138                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0139                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0140                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0141                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0142                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0143                         Net Due Date -
     C                   Z-ADD     *ZERO         WN0144                         Net Due Date -
     C                   Z-ADD     *ZERO         WN0145                         Net Due Date -
     C                   Z-ADD     *ZERO         WN0146                         Net Due Date -
     C                   Z-ADD     *ZERO         WN0147                         Discount Due Da
     C                   Z-ADD     *ZERO         WN0148                         Discount Due Da
     C                   Z-ADD     *ZERO         WN0149                         Discount Due Da
     C                   Z-ADD     *ZERO         WN0150                         Discount Due Da
     C                   Z-ADD     *ZERO         WN0151                         G/L Date - MO
     C                   Z-ADD     *ZERO         WN0152                         G/L Date - DA
     C                   Z-ADD     *ZERO         WN0153                         G/L Date - YR
     C                   Z-ADD     *ZERO         WN0154                         G/L Date - CTRY
     C                   Z-ADD     *ZERO         WN0155                         Batch Date - MO
     C                   Z-ADD     *ZERO         WN0156                         Batch Date - DA
     C                   Z-ADD     *ZERO         WN0157                         Batch Date - YR
     C                   Z-ADD     *ZERO         WN0158                         Batch Date - CT
     C                   Z-ADD     *ZERO         WN0159                         Historical Date
     C                   Z-ADD     *ZERO         WN0160                         Historical Date
     C                   Z-ADD     *ZERO         WN0161                         Historical Date
     C                   Z-ADD     *ZERO         WN0162                         Historical Date
     C                   Z-ADD     *ZERO         WN0163                         Document Matchi
     C                   EVAL      WN0164 = ' '                                 Bank Transit Nu
     C                   EVAL      WN0165 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0166 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0167 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0168 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0169 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0170 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0171 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0172 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0173 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0174 = ' '                                 Catg Code - A/P
     C                   EVAL      WN0175 = ' '                                 Deferred Tax St
     C                   EVAL      WN0176 = ' '                                 Base Currency C
     C                   Z-ADD     *ZERO         WN0177                         Amount To Distr
     C                   Z-ADD     *ZERO         WN0178                         Currency to Dis
     C                   Z-ADD     *ZERO         WN0179                         Non-Recoverable
     C                   Z-ADD     *ZERO         WN0180                         Non-Recoverable
     C                   EVAL      WN0181 = ' '                                 Purchasing Taxa
     C                   EVAL      WN0182 = ' '                                 Purge Flag
     C                   EVAL      WN0183 = ' '                                 Generic Flag 5
     C                   EVAL      WN0184 = ' '                                 Generic Flag 6
     C                   Z-ADD     *ZERO         WN0185                         Generic Amount
     C                   Z-ADD     *ZERO         WN0186                         Generic Amount
     C                   EVAL      WN0187 = ' '                                 Generic String
     C                   EVAL      WN0188 = ' '                                 Generic String
     C                   Z-ADD     *ZERO         WN0189                         Future W/H Tax
     C                   Z-ADD     *ZERO         WN0190                         Future W/H Tax
     C                   EVAL      WN0191 = ' '                                 Summarized Flag
     C                   EVAL      WN0192 = ' '                                 Pay When Paid
     C                   Z-ADD     *ZERO         WN0193                         Pay When Paid G
     C                   EVAL      WN0194 = ' '                                 Netting Status
     C                   EVAL      WN0195 = ' '                                 Automation Flag
     C                   EVAL      WN0196 = ' '                                 Automation Rule
     C                   Z-ADD     *ZERO         WN0197                         Job Number
     C                   EVAL      WN0198 = ' '                                 Process Type
     C                   EVAL      WN0199 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0200                         Create Date
     C                   Z-ADD     *ZERO         WN0201                         Create Time
     C                   EVAL      WN0202 = ' '                                 Create User
     C                   EVAL      WN0203 = ' '                                 Create Program
     C                   Z-ADD     *ZERO         WN0204                         Change Date
     C                   Z-ADD     *ZERO         WN0205                         Change Time
     C                   EVAL      WN0206 = ' '                                 Change User
     C                   EVAL      WN0207 = ' '                                 Change Program
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YBRDC = ' '
      *
      * Move key fields to I0411L0
     C                   MOVEL(P)  ELEDUS        WBEDUS                         EDI - User ID
     C                   MOVEL(P)  ELEDBT        WBEDBT                         EDI - Batch Num
     C                   MOVEL(P)  ELEDTN        WBEDTN                         EDI - Transacti
     C                   Z-ADD     ELEDLN        WBEDLN                         EDI - Line Numb
      *
     C     KLCHSC        KLIST
     C                   KFLD                    WBEDUS                         EDI - User ID
     C                   KFLD                    WBEDBT                         EDI - Batch Num
     C                   KFLD                    WBEDTN                         EDI - Transacti
     C                   KFLD                    WBEDLN                         EDI - Line Numb
     C     KLCHSC        CHAIN     I0411L0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10411L0'    MDACP
     C                   MOVEL     'I0411L0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL002.
     C                   MOVEL     'LBL002'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QE1041        YBRDCS
      * Move non-key fields to I0411L0
     C                   MOVEL(P)  '0'           WBEDSP                         EDI - Successfu
     C                   EVAL      WBO6TX = ' '                                 E1 Process Erro
     C                   EVAL      WBO7TX = ' '                                 E1 Process Erro
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QE1041 <> YBRDCS AND
     C                             YBRDC <> 'N'
     C                   MOVE      'Y'           YBRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YBRDC = 'Y'
     C                   UPDATE    I0411L0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    E10411L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   SDRVGN        BEGSR
      *================================================================
      * Rtv Set Batch to Unprc RT - Run Log J/E Detail F0911  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSD         KLIST
     C                   KFLD                    WQSD01                         EDI - User ID
     C                   KFLD                    WQSD02                         EDI - Batch Num
      * Setup key
     C                   MOVEL     #1USER        WQSD01                         EDI - User ID
     C                   MOVEL     YL0002        WQSD02                         EDI - Batch Num
      * Establish starting position
     C     KRSSD         SETLL     I0911L1                                      *
     C     KRSSD         READE     I0911L1                                90    *
      * Data record not found
     C   90              MOVEL     'E1I0072'     W0RTN
      * USER: Process Data record
      * Chg Run Log Prc Sts    CH - Run Log J/E Detail F0911  * 
     C                   DOW       NOT *IN90
     C                   EXSR      SECHRC
     C     KRSSD         READE     I0911L1                                90    *
     C                   ENDDO
      *================================================================
     CSR   SDEXIT        ENDSR
      /EJECT
     CSR   SECHRC        BEGSR
      *================================================================
      * Chg Run Log Prc Sts    CH - Run Log J/E Detail F0911  * 
      *================================================================
      *
     C                   Z-ADD     *ZERO         WN0208                         Record Sequence
     C                   EVAL      WN0209 = ' '                                 EDI - Document
     C                   EVAL      WN0210 = ' '                                 EDI - Transacti
     C                   EVAL      WN0211 = ' '                                 EDI - Translati
     C                   Z-ADD     *ZERO         WN0212                         EDI - Transmiss
     C                   EVAL      WN0213 = ' '                                 EDI - Send/Rece
     C                   Z-ADD     *ZERO         WN0214                         EDI - Dtl Lines
     C                   EVAL      WN0215 = ' '                                 EDI - Transacti
     C                   EVAL      WN0216 = ' '                                 EDI - Transacti
     C                   EVAL      WN0217 = ' '                                 Batch File Crea
     C                   Z-ADD     *ZERO         WN0218                         User Address nu
     C                   EVAL      WN0219 = ' '                                 Document Compan
     C                   EVAL      WN0220 = ' '                                 Document Type
     C                   Z-ADD     *ZERO         WN0221                         Document Number
     C                   Z-ADD     *ZERO         WN0222                         G/L Date
     C                   Z-ADD     *ZERO         WN0223                         Journal Entry L
     C                   EVAL      WN0224 = ' '                                 Line Extension
     C                   EVAL      WN0225 = ' '                                 G/L Posted Flag
     C                   Z-ADD     *ZERO         WN0226                         Batch Number
     C                   EVAL      WN0227 = ' '                                 Batch Type
     C                   Z-ADD     *ZERO         WN0228                         Batch Date
     C                   Z-ADD     *ZERO         WN0229                         Batch System Da
     C                   Z-ADD     *ZERO         WN0230                         Batch Time
     C                   EVAL      WN0231 = ' '                                 Company
     C                   EVAL      WN0232 = ' '                                 Account Number
     C                   EVAL      WN0233 = ' '                                 Account Mode -
     C                   EVAL      WN0234 = ' '                                 Account ID
     C                   EVAL      WN0235 = ' '                                 Business Unit/C
     C                   EVAL      WN0236 = ' '                                 Object Account
     C                   EVAL      WN0237 = ' '                                 Subsidiary
     C                   EVAL      WN0238 = ' '                                 Subledger - G/L
     C                   EVAL      WN0239 = ' '                                 Subledger Type
     C                   EVAL      WN0240 = ' '                                 Ledger Types
     C                   Z-ADD     *ZERO         WN0241                         Period Number -
     C                   Z-ADD     *ZERO         WN0242                         Century
     C                   Z-ADD     *ZERO         WN0243                         Fiscal Year
     C                   EVAL      WN0244 = ' '                                 Fiscal Quarter
     C                   EVAL      WN0245 = ' '                                 Currency Code F
     C                   Z-ADD     *ZERO         WN0246                         Currency Conver
     C                   Z-ADD     *ZERO         WN0247                         Historical Curr
     C                   Z-ADD     *ZERO         WN0248                         Historical Date
     C                   Z-ADD     *ZERO         WN0249                         Amount
     C                   Z-ADD     *ZERO         WN0250                         Units
     C                   EVAL      WN0251 = ' '                                 Unit of Measure
     C                   EVAL      WN0252 = ' '                                 G/L Offset
     C                   EVAL      WN0253 = ' '                                 Reverse or Void
     C                   EVAL      WN0254 = ' '                                 Name - Alpha Ex
     C                   EVAL      WN0255 = ' '                                 Name - Remark E
     C                   EVAL      WN0256 = ' '                                 Reference 1
     C                   EVAL      WN0257 = ' '                                 Reference 2
     C                   EVAL      WN0258 = ' '                                 Reference 3
     C                   EVAL      WN0259 = ' '                                 Document Pay It
     C                   Z-ADD     *ZERO         WN0260                         Document - Orig
     C                   EVAL      WN0261 = ' '                                 Document Type -
     C                   EVAL      WN0262 = ' '                                 Document Pay It
     C                   EVAL      WN0263 = ' '                                 Document Co - P
     C                   EVAL      WN0264 = ' '                                 Document Co - O
     C                   EVAL      WN0265 = ' '                                 Document Type -
     C                   Z-ADD     *ZERO         WN0266                         Address Number
     C                   EVAL      WN0267 = ' '                                 Payment Number
     C                   Z-ADD     *ZERO         WN0268                         Check Date
     C                   Z-ADD     *ZERO         WN0269                         Check Cleared D
     C                   EVAL      WN0270 = ' '                                 Serial Number
     C                   EVAL      WN0271 = ' '                                 Batch Rear End
     C                   EVAL      WN0272 = ' '                                 Reconciled Code
     C                   EVAL      WN0273 = ' '                                 Summarized Code
     C                   EVAL      WN0274 = ' '                                 Purge Code
     C                   EVAL      WN0275 = ' '                                 Flag for 1099
     C                   EVAL      WN0276 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0277 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0278 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0279 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0280 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0281 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0282 = ' '                                 Commitment Reli
     C                   EVAL      WN0283 = ' '                                 Billing Control
     C                   EVAL      WN0284 = ' '                                 Currency Update
     C                   EVAL      WN0285 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0286 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0287 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0288 = ' '                                 Stocked Invento
     C                   EVAL      WN0289 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0290 = ' '                                 Comsumption Tax
     C                   EVAL      WN0291 = ' '                                 G/L Posting Cod
     C                   EVAL      WN0292 = ' '                                 Delete Not Allo
     C                   EVAL      WN0293 = ' '                                 Client Free For
     C                   EVAL      WN0294 = ' '                                 Client Free For
     C                   EVAL      WN0295 = ' '                                 Lease Cost Ledg
     C                   EVAL      WN0296 = ' '                                 Bill Code
     C                   EVAL      WN0297 = ' '                                 Supplier Invoic
     C                   Z-ADD     *ZERO         WN0298                         Invoice Date
     C                   EVAL      WN0299 = ' '                                 Categories - Wo
     C                   EVAL      WN0300 = ' '                                 Purchase Order
     C                   EVAL      WN0301 = ' '                                 Purchase Order
     C                   EVAL      WN0302 = ' '                                 Order Type
     C                   Z-ADD     *ZERO         WN0303                         Line number
     C                   Z-ADD     *ZERO         WN0304                         Fiscal Year - W
     C                   Z-ADD     *ZERO         WN0305                         Fiscal Period -
     C                   EVAL      WN0306 = ' '                                 Closed Item as
     C                   Z-ADD     *ZERO         WN0307                         Sequence Nbr -
     C                   EVAL      WN0308 = ' '                                 Job Type Code
     C                   EVAL      WN0309 = ' '                                 Job Step
     C                   EVAL      WN0310 = ' '                                 Business Unit -
     C                   Z-ADD     *ZERO         WN0311                         DOI Sub
     C                   EVAL      WN0312 = ' '                                 Outsider Lease/
     C                   EVAL      WN0313 = ' '                                 ID Type
     C                   Z-ADD     *ZERO         WN0314                         Service/Tax Dat
     C                   EVAL      WN0315 = ' '                                 Transaction Ori
     C                   Z-ADD     *ZERO         WN0316                         Registration Nu
     C                   Z-ADD     *ZERO         WN0317                         Payment ID (Int
     C                   EVAL      WN0318 = ' '                                 User ID
     C                   EVAL      WN0319 = ' '                                 Program ID
     C                   EVAL      WN0320 = ' '                                 Work Station ID
     C                   Z-ADD     *ZERO         WN0321                         Date Updated 1
     C                   Z-ADD     *ZERO         WN0322                         Time Last Updat
     C                   EVAL      WN0323 = ' '                                 Currency Mode
     C                   Z-ADD     *ZERO         WN0324                         Currency Amount
     C                   Z-ADD     *ZERO         WN0325                         G/L Date - MO
     C                   Z-ADD     *ZERO         WN0326                         G/L Date - DA
     C                   Z-ADD     *ZERO         WN0327                         G/L Date - YR
     C                   Z-ADD     *ZERO         WN0328                         G/L Date - CTRY
     C                   Z-ADD     *ZERO         WN0329                         Batch Date - MO
     C                   Z-ADD     *ZERO         WN0330                         Batch Date - DA
     C                   Z-ADD     *ZERO         WN0331                         Batch Date - YR
     C                   Z-ADD     *ZERO         WN0332                         Batch Date - CT
     C                   Z-ADD     *ZERO         WN0333                         Batch System Da
     C                   Z-ADD     *ZERO         WN0334                         Batch System Da
     C                   Z-ADD     *ZERO         WN0335                         Batch System Da
     C                   Z-ADD     *ZERO         WN0336                         Batch System Da
     C                   Z-ADD     *ZERO         WN0337                         Check Date - MO
     C                   Z-ADD     *ZERO         WN0338                         Check Date - DA
     C                   Z-ADD     *ZERO         WN0339                         Check Date - YR
     C                   Z-ADD     *ZERO         WN0340                         Check Date - CT
     C                   Z-ADD     *ZERO         WN0341                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0342                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0343                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0344                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WN0345                         Historical Date
     C                   Z-ADD     *ZERO         WN0346                         Historical Date
     C                   Z-ADD     *ZERO         WN0347                         Historical Date
     C                   Z-ADD     *ZERO         WN0348                         Historical Date
     C                   Z-ADD     *ZERO         WN0349                         Check Cleared D
     C                   Z-ADD     *ZERO         WN0350                         Check Cleared D
     C                   Z-ADD     *ZERO         WN0351                         Check Cleared D
     C                   Z-ADD     *ZERO         WN0352                         Check Cleared D
     C                   Z-ADD     *ZERO         WN0353                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0354                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0355                         Invoice Date -
     C                   Z-ADD     *ZERO         WN0356                         Invoice Date -
     C                   EVAL      WN0357 = ' '                                 Managerial Anal
     C                   EVAL      WN0358 = ' '                                 Managerial Anal
     C                   EVAL      WN0359 = ' '                                 Managerial Anal
     C                   EVAL      WN0360 = ' '                                 Managerial Anal
     C                   EVAL      WN0361 = ' '                                 Managerial Anal
     C                   EVAL      WN0362 = ' '                                 Managerial Anal
     C                   EVAL      WN0363 = ' '                                 Managerial Anal
     C                   EVAL      WN0364 = ' '                                 Managerial Anal
     C                   Z-ADD     *ZERO         WN0365                         Item Number - S
     C                   EVAL      WN0366 = ' '                                 Posting Code 1
     C                   EVAL      WN0367 = ' '                                 Posting Code 2
     C                   EVAL      WN0368 = ' '                                 Posting Code 3
     C                   EVAL      WN0369 = ' '                                 Posting Code 4
     C                   EVAL      WN0370 = ' '                                 Posting Code 5
     C                   EVAL      WN0371 = ' '                                 Posting Code 6
     C                   EVAL      WN0372 = ' '                                 Posting Code 7
     C                   EVAL      WN0373 = ' '                                 Posting Code 8
     C                   EVAL      WN0374 = ' '                                 Posting Code 9
     C                   EVAL      WN0375 = ' '                                 Posting Code 10
     C                   EVAL      WN0376 = ' '                                 Base Currency C
     C                   EVAL      WN0377 = ' '                                 Tax Expl Code 1
     C                   EVAL      WN0378 = ' '                                 Tax Rate_Area
     C                   Z-ADD     *ZERO         WN0379                         Tax - Short Ite
     C                   EVAL      WN0380 = ' '                                 Activity Based
     C                   Z-ADD     *ZERO         WN0381                         Tax Amount
     C                   Z-ADD     *ZERO         WN0382                         Foreign Tax Amo
     C                   Z-ADD     *ZERO         WN0383                         Gross Amount
     C                   Z-ADD     *ZERO         WN0384                         Foreign Gross A
     C                   EVAL      WN0385 = ' '                                 Track Taxes Fla
     C                   Z-ADD     *ZERO         WN0386                         Distribution/Li
     C                   EVAL      WN0387 = ' '                                 Receipt Number
     C                   EVAL      WN0388 = ' '                                 Burdening Poste
     C                   EVAL      WN0389 = ' '                                 Alt Home Busine
     C                   EVAL      WN0390 = ' '                                 Employee Pool G
     C                   EVAL      WN0391 = ' '                                 Job Pool Groupi
     C                   Z-ADD     *ZERO         WN0392                         Full Line Ident
     C                   Z-ADD     *ZERO         WN0393                         Pay Item Extens
     C                   EVAL      WN0394 = ' '                                 Auto Offset Met
     C                   Z-ADD     *ZERO         WN0395                         IBMi Batch Numb
     C                   Z-ADD     *ZERO         WN0396                         IBMi Document N
     C                   EVAL      WN0397 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0398                         Create Date
     C                   Z-ADD     *ZERO         WN0399                         Create Time
     C                   EVAL      WN0400 = ' '                                 Create User
     C                   EVAL      WN0401 = ' '                                 Create Program
     C                   Z-ADD     *ZERO         WN0402                         Change Date
     C                   Z-ADD     *ZERO         WN0403                         Change Time
     C                   EVAL      WN0404 = ' '                                 Change User
     C                   EVAL      WN0405 = ' '                                 Change Program
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YCRDC = ' '
      *
      * Move key fields to I0911L0
     C                   MOVEL(P)  GLEDUS        WCEDUS                         EDI - User ID
     C                   MOVEL(P)  GLEDBT        WCEDBT                         EDI - Batch Num
     C                   MOVEL(P)  GLEDTN        WCEDTN                         EDI - Transacti
     C                   Z-ADD     GLEDLN        WCEDLN                         EDI - Line Numb
      *
     C     KLCHSE        KLIST
     C                   KFLD                    WCEDUS                         EDI - User ID
     C                   KFLD                    WCEDBT                         EDI - Batch Num
     C                   KFLD                    WCEDTN                         EDI - Transacti
     C                   KFLD                    WCEDLN                         EDI - Line Numb
     C     KLCHSE        CHAIN     I0911L0                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'E10911L0'    MDACP
     C                   MOVEL     'I0911L0'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL003.
     C                   MOVEL     'LBL003'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SEEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QE1091        YCRDCS
      * Move non-key fields to I0911L0
     C                   MOVEL(P)  GLEDTY        WCEDTY                         Type Record
     C                   MOVEL(P)  '0'           WCEDSP                         EDI - Successfu
     C                   EVAL      WCO6TX = ' '                                 E1 Process Erro
     C                   EVAL      WCO7TX = ' '                                 E1 Process Erro
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QE1091 <> YCRDCS AND
     C                             YCRDC <> 'N'
     C                   MOVE      'Y'           YCRDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YCRDC = 'Y'
     C                   UPDATE    I0911L0                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    E10911L0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SEEXIT        ENDSR
      /EJECT
     CSR   XDCK2         BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                   MOVEL     *BLANK        W0RTN
     C                   Z-ADD     *ZERO         XDINDT
      * If external date is zero, do not check
     C     XDEXDT        CABEQ     *ZERO         XDCK2E
      *................................................................
      * Map external to internal according to date format
     C                   IF        XDDTFM = 'DMY'
     C                   Z-ADD     XDEX02        XDINDD                         DD
     C                   Z-ADD     XDEX03        XDINMM                         MM
     C                   Z-ADD     XDEX04        XDINYY                         YY
     C                   ELSE
     C                   IF        XDDTFM = 'MDY'
     C                   Z-ADD     XDEX02        XDINMM                         MM
     C                   Z-ADD     XDEX03        XDINDD                         DD
     C                   Z-ADD     XDEX04        XDINYY                         YY
     C                   ELSE
      * YMD format
     C                   Z-ADD     XDEX02        XDINYY                         YY
     C                   Z-ADD     XDEX03        XDINMM                         MM
     C                   Z-ADD     XDEX04        XDINDD                         DD
     C                   END
     C                   END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C                   IF        XDINYY < XOFFYY
     C                   ADD       100           XDINYY
     C                   END
     C     YPMTFD        CABNE     *BLANK        XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C     XDINMM        CABLT     1             XDCK2M
     C     XDINMM        CABGT     12            XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C     XDINDD        CABLT     1             XDCK2M
     C     XDINDD        CABGT     @XD(XDINMM)   XDCK2M
      *................................................................
      * Special case: leap year
     C                   IF        XDINMM = 2
     C                   IF        XDINYY <> *ZERO AND
     C                             XDINYY <> 200
     C     XDINYY        DIV       4             XDWK1
     C                   MVR                     XDWK1
     C                   ELSE
     C                   Z-ADD     1             XDWK1
     C                   END
      * Year is not leap
     C                   IF        XDWK1 <> *ZERO
     C     XDINDD        CABGT     28            XDCK2M
     C                   END
     C                   END
     C                   GOTO      XDCK2E
      *................................................................
      * Send error message
     C     XDCK2M        TAG
      * Send message '*Invalid date'
     C                   MOVEL     'Y2U0006'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   MOVEL     'Y2U0006'     W0RTN
      * Disable time portion if timestamp is validated
     C                   Z-ADD     *ZERO         XTTIM
      *================================================================
     CSR   XDCK2E        ENDSR
      /EJECT
     CSR   XDVC2T        BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                   Z-ADD     0             XDEX01                         CC
     C                   IF        XDDTFM = 'DMY'
     C                   Z-ADD     XDINDD        XDEX02                         DD
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
     C                   IF        XDDTFM = 'MDY'
     C                   Z-ADD     XDINMM        XDEX02                         MM
     C                   Z-ADD     XDINDD        XDEX03                         DD
     C                   Z-ADD     XDINYY        XDEX04                         YY
     C                   ELSE
      * YMD format
     C                   Z-ADD     XDINYY        XDEX02                         YY
     C                   Z-ADD     XDINMM        XDEX03                         MM
     C                   Z-ADD     XDINDD        XDEX04                         DD
     C                   END
     C                   END
      *================================================================
     CSR   XDVC2E        ENDSR
      /EJECT
     CSR   Y0SET         BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y0EXIT        ENDSR
      /EJECT
     CSR   Y8TST         BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                   Z-ADD     @#RWCL        ZINPOS
     C     ZINPOS        DIV       256           W0CRW
     C                   MVR                     W0CCL
      *================================================================
     CSR   Y8EXIT        ENDSR
      /EJECT
     CSR   Y9CLR         BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR   Y9EXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
      * If no message file specified, use default
     C                   IF        ZAMSGF = ' '
     C                   MOVEL     ZADFMF        ZAMSGF
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZDVPMT        BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                   EVAL      YPMTFD = ' '
     C                   Z-ADD     *ZERO         YAFSCH
     C                   Z-ADD     *ZERO         YPMRRN
      *
      *
      * Extract cursor row and column
     C                   IF        *IN04
     C     @#RWCL        DIV       256           ZHCSRW
     C                   MVR                     ZHCSCL
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      * Save sfl rrn at top of page
     C                   Z-ADD     @#SFRC        Y#SFRC
      *
      * Initialise sfl workfields
     C                   Z-ADD     10            ZHSTRW
     C                   Z-ADD     23            ZHNDRW
     C                   Z-ADD     1             ZHRLEN
     C                   Z-ADD     *ZERO         ZHF4RW
     C                   Z-ADD     *ZERO         ZHWK1#
      *
      * Resolve prompt row number on sfl
     C                   IF        ZHCSRW >= ZHSTRW AND
     C                             ZHCSRW <= ZHNDRW
     C     ZHCSRW        SUB       ZHSTRW        ZHWK1#
     C     ZHWK1#        DIV       ZHRLEN        ZHWK1#
     C                   Z-ADD     ZHWK1#        YZSFDL
     C     ZHWK1#        MULT      ZHRLEN        ZHWK1#
     C     ZHCSRW        SUB       ZHWK1#        ZHF4RW
     C                   END
      *
     C                   IF        ZHCSRW = 009 AND
     C                             ZHCSCL = 024 AND
     C                             @#DFMT = '#SFLCTL'
     C                   MOVEL     '#2IST'       YPMTFD                         Batch Status
     C                   END
      *
      * Error if user defined prompting is not specified.
     C                   IF        YPMTFD = ' '
     C                   IF        W0PMT = 'N'
     C                   MOVEL     '*NONE'       YPMTFD
     C                   MOVEL     'Y'           W0HLP
     C                   MOVEL     'Y'           ZAFSMS
      * Send error message.
     C                   MOVEL     'Y2U0101'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   END
     C                   END
      *
      * Save first changed  rrn
      *
     C                   IF        ZHCSRW >= ZHSTRW AND
     C                             ZHCSRW <= ZHNDRW AND
     C                             YPMTFD <> '*NONE'
     C                   IF        ##RR <> *ZERO
     C                   READC     #SFLRCD                                92    *
     C                   IF        NOT *IN92
     C                   Z-ADD     ##RR          YAFSCH
     C                   SETON                                        84        *
     C                   UPDATE    #SFLRCD
     C                   END
     C                   END
      *
      * Calculate rrn for prompt slf record
     C     ZHCSRW        SUB       ZHSTRW        ZHWK1#
     C     ZHWK1#        DIV       ZHRLEN        ZHWK1#
     C     ZHWK1#        ADD       Y#SFRC        YPMRRN
      *
      * Chain to sfl record
     C     YPMRRN        CHAIN     #SFLRCD                            9292      *
     C                   IF        NOT *IN92
     C                   SETON                                        84        *
     C                   UPDATE    #SFLRCD
     C                   ELSE
     C                   Z-ADD     *ZERO         YPMRRN
     C                   END
      *
      * Test first changed rrn/prompt rrn
     C                   IF        YAFSCH = *ZERO
     C                   Z-ADD     YPMRRN        YAFSCH
     C                   END
      *
      * If prompt rrn < first changed rrn
     C                   IF        YPMRRN <> *ZERO AND
     C                             YPMRRN < YAFSCH
     C                   Z-ADD     YPMRRN        YAFSCH
     C                   END
      *
     C                   END
      *
     C                   END
      *================================================================
     CSR   ZDEXIT        ENDSR
      /EJECT
     CSR   ZHHPKY        BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                   MOVEL     'Y'           W0HLP
      *
      * Extract cursor row and column
     C     @#RWCL        DIV       256           ZHCSRW                         Row
     C                   MVR                     ZHCSCL                         Column
      *
      * Save cursor position for redisplay
     C                   Z-ADD     ZHCSRW        ZZCSRW                         Row
     C                   Z-ADD     ZHCSCL        ZZCSCL                         Column
      *
      *
     C                   CALL      'YDDSHPR'
     C                   PARM      ##PGM         W0HPMB                         Help text sourc
     C                   PARM      *BLANK        YYHPFL                         Help text file
     C                   PARM      *BLANK        YYHPLB                         Help text libra
     C                   PARM                    W0RTN
     C                   PARM      '*START'      YYHLVN                         Help label
     C                   PARM      '*NORMAL'     YYUSOP                         Options
     C                   PARM      ZHCSRW        YYRW                           Row
     C                   PARM      ZHCSCL        YYCL                           Column
     C                   PARM      *ZERO         YYLGCT                         # of grps
     C                   PARM      *BLANK        YYLGVN                         Label grps
      *
      * Clear set cursor DDS indicator
     C  N94              MOVEL     'OFF'         WCSRLC
     C  N94              SETON                                        94        *
      *================================================================
     CSR   ZHEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      *
      * Clear all neither parameters
     C                   EVAL      P2LCTX = ' '                                 OMS Warehouse C
     C                   Z-ADD     *ZERO         P2GUNB                         OMS Company Num
     C                   EVAL      P2CQCD = ' '                                 OMS Application
     C                   EVAL      P2CSCD = ' '                                 OMS Salesperson
     C                   EVAL      P2I2ST = ' '                                 OMS Allow Multi
     C                   EVAL      P2LDTX = ' '                                 OMS Default Pri
     C                   EVAL      P2LETX = ' '                                 OMS NAME
     C                   EVAL      P2KRTX = ' '                                 OMS System Valu
     C                   EVAL      P2I1ST = ' '                                 OMS Access Deni
      *
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Define work field Blank usr
     C                   EVAL      WUPUTX = ' '
      * Obtain default message file
     C     *DTAARA       DEFINE    E1MGFLA       ZADFMF
     C                   IN        ZADFMF
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAICU                          Batch Number
     C                   Z-ADD     *ZERO         WAAICU                         Input Total
     C                   Z-ADD     *ZERO         WADICJ                         Batch Date
     C                   Z-ADD     *ZERO         WANDO                          Number of Docs
     C                   Z-ADD     *ZERO         WAAME                          Amount Entered
     C                   Z-ADD     *ZERO         WADOCN                         Documents Enter
     C                   Z-ADD     *ZERO         WAAIPT                         Amount - input
     C                   Z-ADD     *ZERO         WAUPMJ                         Date Updated 1
     C                   Z-ADD     *ZERO         WAUPTM                         Time Last Updat
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBEDLN                         EDI - Line Numb
     C                   Z-ADD     *ZERO         WBEDSQ                         Record Sequence
     C                   Z-ADD     *ZERO         WBEDDT                         EDI - Transmiss
     C                   Z-ADD     *ZERO         WBEDDL                         EDI - Dtl Lines
     C                   Z-ADD     *ZERO         WBEDAN                         User Address nu
     C                   Z-ADD     *ZERO         WBDOC                          Document Number
     C                   Z-ADD     *ZERO         WBSFXE                         Pay Item Extens
     C                   Z-ADD     *ZERO         WBAN8                          Address Number
     C                   Z-ADD     *ZERO         WBPYE                          Payee Address N
     C                   Z-ADD     *ZERO         WBSNTO                         Address Number
     C                   Z-ADD     *ZERO         WBDIVJ                         Invoice Date -
     C                   Z-ADD     *ZERO         WBDSVJ                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WBDDJ                          Date - Net Due
     C                   Z-ADD     *ZERO         WBDDNJ                         Discount Due Da
     C                   Z-ADD     *ZERO         WBDGJ                          G/L Date
     C                   Z-ADD     *ZERO         WBFY                           Fiscal Year
     C                   Z-ADD     *ZERO         WBCTRY                         Century
     C                   Z-ADD     *ZERO         WBPN                           Period Number -
     C                   Z-ADD     *ZERO         WBICU                          Batch Number
     C                   Z-ADD     *ZERO         WBDICJ                         Batch Date
     C                   Z-ADD     *ZERO         WBAG                           Gross Amount
     C                   Z-ADD     *ZERO         WBAAP                          Open Amount
     C                   Z-ADD     *ZERO         WBADSC                         Discount Availa
     C                   Z-ADD     *ZERO         WBADSA                         Discount Taken
     C                   Z-ADD     *ZERO         WBATXA                         Taxable Amount
     C                   Z-ADD     *ZERO         WBATXN                         Non-Taxable Amo
     C                   Z-ADD     *ZERO         WBSTAM                         Tax Amount
     C                   Z-ADD     *ZERO         WBCRR                          Currency Conver
     C                   Z-ADD     *ZERO         WBACR                          Currency Amount
     C                   Z-ADD     *ZERO         WBFAP                          Foreign Open Am
     C                   Z-ADD     *ZERO         WBCDS                          Foreign Disc Av
     C                   Z-ADD     *ZERO         WBCDSA                         Foreign Disc Ta
     C                   Z-ADD     *ZERO         WBCTXA                         Foreign Taxable
     C                   Z-ADD     *ZERO         WBCTXN                         Foreign Non-Tax
     C                   Z-ADD     *ZERO         WBCTAM                         Foreign Tax Amo
     C                   Z-ADD     *ZERO         WBODOC                         Document - Orig
     C                   Z-ADD     *ZERO         WBLNID                         Line number
     C                   Z-ADD     *ZERO         WBOPSQ                         Sequence Nbr -
     C                   Z-ADD     *ZERO         WBDRF                          Recurring Freq
     C                   Z-ADD     *ZERO         WBU                            Units
     C                   Z-ADD     *ZERO         WBITM                          Item Number - S
     C                   Z-ADD     *ZERO         WBHCRR                         Historical Curr
     C                   Z-ADD     *ZERO         WBHDGJ                         Historical Date
     C                   Z-ADD     *ZERO         WBURDT                         User Reserved D
     C                   Z-ADD     *ZERO         WBURAT                         User Reserved A
     C                   Z-ADD     *ZERO         WBURAB                         User Reserved N
     C                   Z-ADD     *ZERO         WBUPMJ                         Date Updated 1
     C                   Z-ADD     *ZERO         WBUPMT                         Time Last Updat
     C                   Z-ADD     *ZERO         WBDIM                          Invoice Date -
     C                   Z-ADD     *ZERO         WBDID                          Invoice Date -
     C                   Z-ADD     *ZERO         WBDIY                          Invoice Date -
     C                   Z-ADD     *ZERO         WBDI#                          Invoice Date -
     C                   Z-ADD     *ZERO         WBDSVM                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WBDSVD                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WBDSVY                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WBDSV#                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WBDDM                          Net Due Date -
     C                   Z-ADD     *ZERO         WBDDDA                         Net Due Date -
     C                   Z-ADD     *ZERO         WBDDY                          Net Due Date -
     C                   Z-ADD     *ZERO         WBDD#                          Net Due Date -
     C                   Z-ADD     *ZERO         WBDDNM                         Discount Due Da
     C                   Z-ADD     *ZERO         WBDDND                         Discount Due Da
     C                   Z-ADD     *ZERO         WBDDNY                         Discount Due Da
     C                   Z-ADD     *ZERO         WBDDN#                         Discount Due Da
     C                   Z-ADD     *ZERO         WBDGM                          G/L Date - MO
     C                   Z-ADD     *ZERO         WBDGD                          G/L Date - DA
     C                   Z-ADD     *ZERO         WBDGY                          G/L Date - YR
     C                   Z-ADD     *ZERO         WBDG#                          G/L Date - CTRY
     C                   Z-ADD     *ZERO         WBDICM                         Batch Date - MO
     C                   Z-ADD     *ZERO         WBDICD                         Batch Date - DA
     C                   Z-ADD     *ZERO         WBDICY                         Batch Date - YR
     C                   Z-ADD     *ZERO         WBDIC#                         Batch Date - CT
     C                   Z-ADD     *ZERO         WBHDGM                         Historical Date
     C                   Z-ADD     *ZERO         WBHDGD                         Historical Date
     C                   Z-ADD     *ZERO         WBHDGY                         Historical Date
     C                   Z-ADD     *ZERO         WBHDG#                         Historical Date
     C                   Z-ADD     *ZERO         WBDOCM                         Document Matchi
     C                   Z-ADD     *ZERO         WBATAD                         Amount To Distr
     C                   Z-ADD     *ZERO         WBCTAD                         Currency to Dis
     C                   Z-ADD     *ZERO         WBNRTA                         Non-Recoverable
     C                   Z-ADD     *ZERO         WBFNRT                         Non-Recoverable
     C                   Z-ADD     *ZERO         WBGAM1                         Generic Amount
     C                   Z-ADD     *ZERO         WBGAM2                         Generic Amount
     C                   Z-ADD     *ZERO         WBWTAD                         Future W/H Tax
     C                   Z-ADD     *ZERO         WBWTAF                         Future W/H Tax
     C                   Z-ADD     *ZERO         WBPWPG                         Pay When Paid G
     C                   Z-ADD     *ZERO         WBJOBS                         Job Number
     C                   Z-ADD     *ZERO         WBABDT                         Create Date
     C                   Z-ADD     *ZERO         WBABTM                         Create Time
     C                   Z-ADD     *ZERO         WBACDT                         Change Date
     C                   Z-ADD     *ZERO         WBACTM                         Change Time
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WCEDLN                         EDI - Line Numb
     C                   Z-ADD     *ZERO         WCEDSQ                         Record Sequence
     C                   Z-ADD     *ZERO         WCEDDT                         EDI - Transmiss
     C                   Z-ADD     *ZERO         WCEDDL                         EDI - Dtl Lines
     C                   Z-ADD     *ZERO         WCEDAN                         User Address nu
     C                   Z-ADD     *ZERO         WCDOC                          Document Number
     C                   Z-ADD     *ZERO         WCDGJ                          G/L Date
     C                   Z-ADD     *ZERO         WCJELN                         Journal Entry L
     C                   Z-ADD     *ZERO         WCICU                          Batch Number
     C                   Z-ADD     *ZERO         WCDICJ                         Batch Date
     C                   Z-ADD     *ZERO         WCDSYJ                         Batch System Da
     C                   Z-ADD     *ZERO         WCTICU                         Batch Time
     C                   Z-ADD     *ZERO         WCPN                           Period Number -
     C                   Z-ADD     *ZERO         WCCTRY                         Century
     C                   Z-ADD     *ZERO         WCFY                           Fiscal Year
     C                   Z-ADD     *ZERO         WCCRR                          Currency Conver
     C                   Z-ADD     *ZERO         WCHCRR                         Historical Curr
     C                   Z-ADD     *ZERO         WCHDGJ                         Historical Date
     C                   Z-ADD     *ZERO         WCAA                           Amount
     C                   Z-ADD     *ZERO         WCU                            Units
     C                   Z-ADD     *ZERO         WCODOC                         Document - Orig
     C                   Z-ADD     *ZERO         WCAN8                          Address Number
     C                   Z-ADD     *ZERO         WCDKJ                          Check Date
     C                   Z-ADD     *ZERO         WCDKC                          Check Cleared D
     C                   Z-ADD     *ZERO         WCIVD                          Invoice Date
     C                   Z-ADD     *ZERO         WCLNID                         Line number
     C                   Z-ADD     *ZERO         WCWY                           Fiscal Year - W
     C                   Z-ADD     *ZERO         WCWN                           Fiscal Period -
     C                   Z-ADD     *ZERO         WCOPSQ                         Sequence Nbr -
     C                   Z-ADD     *ZERO         WCDOI                          DOI Sub
     C                   Z-ADD     *ZERO         WCDSVJ                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WCREG#                         Registration Nu
     C                   Z-ADD     *ZERO         WCPYID                         Payment ID (Int
     C                   Z-ADD     *ZERO         WCUPMJ                         Date Updated 1
     C                   Z-ADD     *ZERO         WCUPMT                         Time Last Updat
     C                   Z-ADD     *ZERO         WCACR                          Currency Amount
     C                   Z-ADD     *ZERO         WCDGM                          G/L Date - MO
     C                   Z-ADD     *ZERO         WCDGD                          G/L Date - DA
     C                   Z-ADD     *ZERO         WCDGY                          G/L Date - YR
     C                   Z-ADD     *ZERO         WCDG#                          G/L Date - CTRY
     C                   Z-ADD     *ZERO         WCDICM                         Batch Date - MO
     C                   Z-ADD     *ZERO         WCDICD                         Batch Date - DA
     C                   Z-ADD     *ZERO         WCDICY                         Batch Date - YR
     C                   Z-ADD     *ZERO         WCDIC#                         Batch Date - CT
     C                   Z-ADD     *ZERO         WCDSYM                         Batch System Da
     C                   Z-ADD     *ZERO         WCDSYD                         Batch System Da
     C                   Z-ADD     *ZERO         WCDSYY                         Batch System Da
     C                   Z-ADD     *ZERO         WCDSY#                         Batch System Da
     C                   Z-ADD     *ZERO         WCDKM                          Check Date - MO
     C                   Z-ADD     *ZERO         WCDKD                          Check Date - DA
     C                   Z-ADD     *ZERO         WCDKY                          Check Date - YR
     C                   Z-ADD     *ZERO         WCDK#                          Check Date - CT
     C                   Z-ADD     *ZERO         WCDSVM                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WCDSVD                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WCDSVY                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WCDSV#                         Service/Tax Dat
     C                   Z-ADD     *ZERO         WCHDGM                         Historical Date
     C                   Z-ADD     *ZERO         WCHDGD                         Historical Date
     C                   Z-ADD     *ZERO         WCHDGY                         Historical Date
     C                   Z-ADD     *ZERO         WCHDG#                         Historical Date
     C                   Z-ADD     *ZERO         WCDKCM                         Check Cleared D
     C                   Z-ADD     *ZERO         WCDKCD                         Check Cleared D
     C                   Z-ADD     *ZERO         WCDKCY                         Check Cleared D
     C                   Z-ADD     *ZERO         WCDKC#                         Check Cleared D
     C                   Z-ADD     *ZERO         WCDIM                          Invoice Date -
     C                   Z-ADD     *ZERO         WCDID                          Invoice Date -
     C                   Z-ADD     *ZERO         WCDIY                          Invoice Date -
     C                   Z-ADD     *ZERO         WCDI#                          Invoice Date -
     C                   Z-ADD     *ZERO         WCITM                          Item Number - S
     C                   Z-ADD     *ZERO         WCTXIT                         Tax - Short Ite
     C                   Z-ADD     *ZERO         WCSTAM                         Tax Amount
     C                   Z-ADD     *ZERO         WCCTAM                         Foreign Tax Amo
     C                   Z-ADD     *ZERO         WCAG                           Gross Amount
     C                   Z-ADD     *ZERO         WCAGF                          Foreign Gross A
     C                   Z-ADD     *ZERO         WCDLNI                         Distribution/Li
     C                   Z-ADD     *ZERO         WCRC5                          Full Line Ident
     C                   Z-ADD     *ZERO         WCSFXE                         Pay Item Extens
     C                   Z-ADD     *ZERO         WCDTNB                         IBMi Batch Numb
     C                   Z-ADD     *ZERO         WCDUNB                         IBMi Document N
     C                   Z-ADD     *ZERO         WCABDT                         Create Date
     C                   Z-ADD     *ZERO         WCABTM                         Create Time
     C                   Z-ADD     *ZERO         WCACDT                         Change Date
     C                   Z-ADD     *ZERO         WCACTM                         Change Time
      * Flag no *SET CURSOR in the program
     C                   MOVE      'N'           YSETCS
     C                   EVALR     WCSRLC = ' '
      * Define *Synon program work fields
     C                   EVAL      W0CFL = ' '                                  *Cursor field
     C                   Z-ADD     *ZEROS        W0CRW                          *Cursor row
     C                   Z-ADD     *ZEROS        W0CCL                          *Cursor column
      * Move main file information to JOB context
     C                   MOVE      @1FFL         ZZFFL                          Main file name
     C                   MOVE      @1FLB         ZZFLB                          Main file lib
     C                   MOVE      @1FMB         ZZFMB                          Main file mbr
     C                   CALL      'Y2QLVNR'
     C                   PARM                    ZZFFL
     C                   PARM                    ZZFLB
     C                   PARM                    ZZFQL                          LIBRARY/FILE
     C                   MOVEL     'N'           W0PMT
      * Define local variables for subroutine SACHRC.
     C                   EVAL      WL0001 = ' '
     C                   Z-ADD     *ZERO         WL0002
     C                   EVAL      WL0003 = ' '
     C                   EVAL      WL0004 = ' '
     C                   EVAL      WL0005 = ' '
      * Define local work field USR Date Julian 5.0
     C                   Z-ADD     *ZERO         YL0001
      * Define local work field EDI - Batch Number
     C                   EVAL      YL0002 = ' '
      * Define local work field Return Code - E1
     C                   EVAL      YL0003 = ' '
      * Define local work field Email ID USR
     C                   EVAL      YL0004 = ' '
      * Obtain system date format
     C     *DTAARA       DEFINE    Y2DTFMA       XDDTFM
     C                   IN        XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C     *DTAARA       DEFINE    Y2CTOFF       XOFF
     C                   IN        XOFF
      * *DTAARA = *COMPANY N
     C     *DTAARA       DEFINE    YYCOTXA       ##CMP
     C                   IN        *DTAARA
      *................................................................
     C                   Z-ADD     14            ##SFPG                         SFLPAG
     C                   Z-ADD     1             ##SFRC
      * Maximum record number
     C                   Z-ADD     *ZERO         ##RRMX
      * Scan limit
     C                   Z-ADD     000000500     W0SLM
      * Subfile pages
     C                   Z-ADD     1             W0SPG
      * Processed Subfile record
     C                   Z-ADD     0             W0RR0
      *................................................................
     C                   EVAL      W0GRP = ' '
      * USER: Initialize program
      * Val Application/UserRP4IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                   CALL      'PDGXXFR'                            90      Val Application
     C                   PARM      *BLANK        W0RTN
     C     P2LCTX        PARM      *BLANK        WQ0011                         OMS Warehouse C
     C     P2GUNB        PARM      *ZERO         WQ0012                         OMS Company Num
     C                   PARM      'A/R'         WQ0013                         OMS Application
     C     P2CSCD        PARM      *BLANK        WQ0014                         OMS Salesperson
     C     P2I2ST        PARM      *BLANK        WQ0015                         OMS Allow Multi
     C     P2LDTX        PARM      *BLANK        WQ0016                         OMS Default Pri
     C     P2LETX        PARM      *BLANK        WQ0017                         OMS NAME
     C     P2KRTX        PARM      *BLANK        WQ0018                         OMS System Valu
     C     P2I1ST        PARM      *BLANK        WQ0019                         OMS Access Deni
      *
      * Call to program ended in error
     C                   IF        *IN90
     C                   MOVEL     'Y2U0032'     W0RTN
     C                   EVAL      W0CLPG = ' '
     C                   MOVEL     'PDGXXFR'     W0CLPG
      * Send message '*Error occured on CALL...'
     C                   MOVEL     'Y2U0032'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     W0CLPG        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   END
      * Error detected?
     C                   IF        W0RTN <> ' '
     C                   SETON                                        99        *
     C                   END
      * CASE: PAR.OMS Access Denied (Y/N) is Yes
      * Send message 'Access Denied for User'
     C                   IF        P2I1ST = 'Y'
     C                   MOVEL     'E1I0112'     ZAMSID
     C                   EXSR      ZASNMS
     C                   SETON                                        99        *
      *
     C                   ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to CompanyRP4US - STR Order Management Sys  * 
     C***   MOVE USER SOURCE                      ***
     C                   movel     P2KRTX        ##CMP
     C                   END                                                    *FI
      * Initialise subfile control
     C                   EXSR      MEIZ#2
      *================================================================
     CSR   ZZEXIT        ENDSR
** @XD
312931303130313130313031
