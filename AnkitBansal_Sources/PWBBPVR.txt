     H/TITLE Utl Copy Tattoo  TST  PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 06/19/19  Time  : 16:53:59
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPWBBPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Utl Copy Tattoo  TST  PV  Prompt & validate record
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKAZREL1IF  E           K        DISK
      * RTV : Company Control HPE       Retrieval index
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKB3CPL1IF  E           K        DISK
      * RTV : Tattoo Scale Ticket       Retrieval index
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKB1CPL1IF  E           K        DISK
      * RTV : Carcass Detail            Retrieval index
      *
     FPKDDCPL2IF  E           K        DISK
      * RSQ : Company Kill Expense Rate Co/Kill/Exp
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKCCREL0IF  E           K        DISK
      * RTV : Tattoo Header Process     Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKADREL0IF  E           K        DISK
      * RTV : Hog Buyer                 Retrieval index
      *
     FPKAIREL0IF  E           K        DISK
      * RTV : Genetic                   Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKAZREL0UF  E           K        DISK
      * UPD : Company Control HPE       Update index
      *
     FPKAWCPL0IF  E           K        DISK                      A
      * UPD : Buy Order Header          Update index
      *
     FPKAXCPL1IF  E           K        DISK                      A
      * UPD : Buy Order Load            Update index
      *
     FPKA1CPL1IF  E           K        DISK                      A
      * UPD : Tattoo Header             Update index
      *
     FPKB3CPL0IF  E           K        DISK                      A
      * UPD : Tattoo Scale Ticket       Update index
      *
     FPKBVCPL0IF  E           K        DISK                      A
      * UPD : Eval Trans                Update index
      *
     FPKB1CPL0IF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index
      *
     FPKDDCPL0IF  E           K        DISK                      A
      * UPD : Company Kill Expense Rate Update index
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 007  5 0A
     E                    W0END   7 007  5 0A
     E                    W0NAM   7 007 10
     E                    YDOW        7  1               *Days of week
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WAHMNB
     I              AWBNNB                          WABNNB
     I              AWARDT                          WAARDT
     I              AWASDT                          WAASDT
     I              AWA4ST                          WAA4ST
     I              AWA5ST                          WAA5ST
     I              AWAAPR                          WAAAPR
     I              AWA6ST                          WAA6ST
     I              AWA7ST                          WAA7ST
     I              AWB3ST                          WAB3ST
     I              AWALPR                          WAALPR
     I              AWETCD                          WAETCD
     I              AWEUCD                          WAEUCD
     I              AWJ5TX                          WAJ5TX
     I              AWD5DT                          WAD5DT
     I              AWD6DT                          WAD6DT
     I              AWD7DT                          WAD7DT
     I              AWD8DT                          WAD8DT
     I              AWD9DT                          WAD9DT
     I              AWJOEJ                          WAJOEJ
     I              AWKOFF                          WAKOFF
     I              AWKWPE                          WAKWPE
     I              AWIMBF                          WAIMBF
     I              AWOPTR                          WAOPTR
     I              AWOEJD                          WAOEJD
     I              AWIRMF                          WAIRMF
     I              AWJIRM                          WAJIRM
     I              AWJRKF                          WAJRKF
     I              AWKFIR                          WAKFIR
     I              AWUZST                          WAUZST
     I              AWU0ST                          WAU0ST
     I              AWU1ST                          WAU1ST
     I              AWU2ST                          WAU2ST
     I              AWU3ST                          WAU3ST
     I              AWHXNB                          WAHXNB
     I              AWGANB                          WAGANB
     I              AWGBNB                          WAGBNB
     I              AWABCD                          WAABCD
     I              AWAECD                          WAAECD
     I              AWAKCD                          WAAKCD
     I              AWALCD                          WAALCD
     I              AWAGCD                          WAAGCD
     I              AWAICD                          WAAICD
     I              AWAMCD                          WAAMCD
     I              AWACCD                          WAACCD
     I              AWAAVN                          WAAAVN
     I              AWAADT                          WAAADT
     I              AWAMTM                          WAAMTM
     I              AWAJST                          WAAJST
     I              AWAHVN                          WAAHVN
     I              AWAGVN                          WAAGVN
     I              AWABVN                          WAABVN
     I              AWABDT                          WAABDT
     I              AWABTM                          WAABTM
      *
     I@AZCPCN
      * Company Control HPE       Retrieval index
      * Renamed input format fields
     I              AZHONB                          WBHONB
     I              AZBSNB                          WBBSNB
     I              AZB1DT                          WBB1DT
     I              AZB2DT                          WBB2DT
     I              AZH4NB                          WBH4NB
     I              AZK3NB                          WBK3NB
     I              AZCDDT                          WBCDDT
     I              AZCEDT                          WBCEDT
     I              AZAAVN                          WBAAVN
     I              AZAADT                          WBAADT
     I              AZAMTM                          WBAMTM
     I              AZAJST                          WBAJST
     I              AZAHVN                          WBAHVN
     I              AZAGVN                          WBAGVN
     I              AZABVN                          WBABVN
     I              AZABDT                          WBABDT
     I              AZABTM                          WBABTM
      *
     I@AZCPCM
      * Company Control HPE       Update index
      * Renamed input format fields
     I              AZHONB                          WCHONB
     I              AZBSNB                          WCBSNB
     I              AZB1DT                          WCB1DT
     I              AZB2DT                          WCB2DT
     I              AZH4NB                          WCH4NB
     I              AZK3NB                          WCK3NB
     I              AZCDDT                          WCCDDT
     I              AZCEDT                          WCCEDT
     I              AZAAVN                          WCAAVN
     I              AZAADT                          WCAADT
     I              AZAMTM                          WCAMTM
     I              AZAJST                          WCAJST
     I              AZAHVN                          WCAHVN
     I              AZAGVN                          WCAGVN
     I              AZABVN                          WCABVN
     I              AZABDT                          WCABDT
     I              AZABTM                          WCABTM
      *
     I@AWCPAZ
      * Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WDHMNB
     I              AWBNNB                          WDBNNB
     I              AWARDT                          WDARDT
     I              AWASDT                          WDASDT
     I              AWA4ST                          WDA4ST
     I              AWA5ST                          WDA5ST
     I              AWAAPR                          WDAAPR
     I              AWA6ST                          WDA6ST
     I              AWA7ST                          WDA7ST
     I              AWB3ST                          WDB3ST
     I              AWALPR                          WDALPR
     I              AWETCD                          WDETCD
     I              AWEUCD                          WDEUCD
     I              AWJ5TX                          WDJ5TX
     I              AWD5DT                          WDD5DT
     I              AWD6DT                          WDD6DT
     I              AWD7DT                          WDD7DT
     I              AWD8DT                          WDD8DT
     I              AWD9DT                          WDD9DT
     I              AWJOEJ                          WDJOEJ
     I              AWKOFF                          WDKOFF
     I              AWKWPE                          WDKWPE
     I              AWIMBF                          WDIMBF
     I              AWOPTR                          WDOPTR
     I              AWOEJD                          WDOEJD
     I              AWIRMF                          WDIRMF
     I              AWJIRM                          WDJIRM
     I              AWJRKF                          WDJRKF
     I              AWKFIR                          WDKFIR
     I              AWUZST                          WDUZST
     I              AWU0ST                          WDU0ST
     I              AWU1ST                          WDU1ST
     I              AWU2ST                          WDU2ST
     I              AWU3ST                          WDU3ST
     I              AWHXNB                          WDHXNB
     I              AWGANB                          WDGANB
     I              AWGBNB                          WDGBNB
     I              AWABCD                          WDABCD
     I              AWAECD                          WDAECD
     I              AWAKCD                          WDAKCD
     I              AWALCD                          WDALCD
     I              AWAGCD                          WDAGCD
     I              AWAICD                          WDAICD
     I              AWAMCD                          WDAMCD
     I              AWACCD                          WDACCD
     I              AWAAVN                          WDAAVN
     I              AWAADT                          WDAADT
     I              AWAMTM                          WDAMTM
     I              AWAJST                          WDAJST
     I              AWAHVN                          WDAHVN
     I              AWAGVN                          WDAGVN
     I              AWABVN                          WDABVN
     I              AWABDT                          WDABDT
     I              AWABTM                          WDABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WEHMNB
     I              AXBNNB                          WEBNNB
     I              AXBONB                          WEBONB
     I              AXCQDT                          WECQDT
     I              AXABTH                          WEABTH
     I              AXACTH                          WEACTH
     I              AXBPNB                          WEBPNB
     I              AXCSNB                          WECSNB
     I              AXAUDT                          WEAUDT
     I              AXCMST                          WECMST
     I              AXAGPR                          WEAGPR
     I              AXATVA                          WEATVA
     I              AXI1ST                          WEI1ST
     I              AXDHNB                          WEDHNB
     I              AXDINB                          WEDINB
     I              AXCNST                          WECNST
     I              AXGINB                          WEGINB
     I              AXBZDT                          WEBZDT
     I              AXLSNB                          WELSNB
     I              AXF3TX                          WEF3TX
     I              AXO8ST                          WEO8ST
     I              AXO9ST                          WEO9ST
     I              AXPAST                          WEPAST
     I              AXLDSH                          WELDSH
     I              AXPBST                          WEPBST
     I              AXPCST                          WEPCST
     I              AXPDST                          WEPDST
     I              AXUWST                          WEUWST
     I              AXUXST                          WEUXST
     I              AXUYST                          WEUYST
     I              AXJKRU                          WEJKRU
     I              AXKEOR                          WEKEOR
     I              AXIOEW                          WEIOEW
     I              AXKJIO                          WEKJIO
     I              AXIOJR                          WEIOJR
     I              AXEIRR                          WEEIRR
     I              AXITMF                          WEITMF
     I              AXODJE                          WEODJE
     I              AXRJIF                          WERJIF
     I              AXOEJF                          WEOEJF
     I              AXD0DT                          WED0DT
     I              AXD1DT                          WED1DT
     I              AXD2DT                          WED2DT
     I              AXD3DT                          WED3DT
     I              AXD4DT                          WED4DT
     I              AXBNCD                          WEBNCD
     I              AXABCD                          WEABCD
     I              AXAECD                          WEAECD
     I              AXAAVN                          WEAAVN
     I              AXAADT                          WEAADT
     I              AXAMTM                          WEAMTM
     I              AXAJST                          WEAJST
     I              AXAHVN                          WEAHVN
     I              AXAGVN                          WEAGVN
     I              AXABVN                          WEABVN
     I              AXABDT                          WEABDT
     I              AXABTM                          WEABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     I@B3CPHL
      * Tattoo Scale Ticket       Retrieval index
      * Renamed input format fields
     I              B3HMNB                          WHHMNB
     I              B3BNNB                          WHBNNB
     I              B3BONB                          WHBONB
     I              B3CVNB                          WHCVNB
     I              B3B0DT                          WHB0DT
     I              B3FKNB                          WHFKNB
     I              B3FMNB                          WHFMNB
     I              B3FLNB                          WHFLNB
     I              B3B6DT                          WHB6DT
     I              B3ANTM                          WHANTM
     I              B3JDA1                          WHJDA1
     I              B3CFDT                          WHCFDT
     I              B3APTM                          WHAPTM
     I              B3I3ST                          WHI3ST
     I              B3HVNB                          WHHVNB
     I              B3CMCD                          WHCMCD
     I              B3AAVN                          WHAAVN
     I              B3AADT                          WHAADT
     I              B3AMTM                          WHAMTM
     I              B3AJST                          WHAJST
     I              B3AHVN                          WHAHVN
     I              B3AGVN                          WHAGVN
     I              B3ABVN                          WHABVN
     I              B3ABDT                          WHABDT
     I              B3ABTM                          WHABTM
      *
     I@B3CPHK
      * Tattoo Scale Ticket       Update index
      * Renamed input format fields
     I              B3HMNB                          WIHMNB
     I              B3BNNB                          WIBNNB
     I              B3BONB                          WIBONB
     I              B3CVNB                          WICVNB
     I              B3B0DT                          WIB0DT
     I              B3FKNB                          WIFKNB
     I              B3FMNB                          WIFMNB
     I              B3FLNB                          WIFLNB
     I              B3B6DT                          WIB6DT
     I              B3ANTM                          WIANTM
     I              B3JDA1                          WIJDA1
     I              B3CFDT                          WICFDT
     I              B3APTM                          WIAPTM
     I              B3I3ST                          WII3ST
     I              B3HVNB                          WIHVNB
     I              B3CMCD                          WICMCD
     I              B3AAVN                          WIAAVN
     I              B3AADT                          WIAADT
     I              B3AMTM                          WIAMTM
     I              B3AJST                          WIAJST
     I              B3AHVN                          WIAHVN
     I              B3AGVN                          WIAGVN
     I              B3ABVN                          WIABVN
     I              B3ABDT                          WIABDT
     I              B3ABTM                          WIABTM
      *
     I@BVCPQ9
      * Eval Trans                Co/Bol/KillDt/Tattoo
      * Renamed input format fields
     I              BVHSNB                          WJHSNB
     I              BVA9DT                          WJA9DT
     I              BVFJNB                          WJFJNB
     I              BVHCNB                          WJHCNB
     I              BVGDNB                          WJGDNB
     I              BVFINB                          WJFINB
     I              BVLKNB                          WJLKNB
     I              BVEAST                          WJEAST
     I              BVAMPC                          WJAMPC
     I              BVAIPC                          WJAIPC
     I              BVAJPC                          WJAJPC
     I              BVAKPC                          WJAKPC
     I              BVX8NB                          WJX8NB
     I              BVFVPC                          WJFVPC
     I              BVFWPC                          WJFWPC
     I              BVFXPC                          WJFXPC
     I              BVALPC                          WJALPC
     I              BVDIST                          WJDIST
     I              BVFYST                          WJFYST
     I              BVD2ST                          WJD2ST
     I              BVEHST                          WJEHST
     I              BVG1ST                          WJG1ST
     I              BVH4ST                          WJH4ST
     I              BVJLST                          WJJLST
     I              BVUUST                          WJUUST
     I              BVVHST                          WJVHST
     I              BVVIST                          WJVIST
     I              BVVJST                          WJVJST
     I              BVVKST                          WJVKST
     I              BVVLST                          WJVLST
     I              BVHMNB                          WJHMNB
     I              BVBNNB                          WJBNNB
     I              BVBONB                          WJBONB
     I              BVCVNB                          WJCVNB
     I              BVB0DT                          WJB0DT
     I              BVAAVN                          WJAAVN
     I              BVAADT                          WJAADT
     I              BVAMTM                          WJAMTM
     I              BVAJST                          WJAJST
     I              BVAHVN                          WJAHVN
     I              BVAGVN                          WJAGVN
     I              BVABVN                          WJABVN
     I              BVABDT                          WJABDT
     I              BVABTM                          WJABTM
     I              BVB8DT                          WJB8DT
     I              BVAOTM                          WJAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WKHSNB
     I              BVA9DT                          WKA9DT
     I              BVFJNB                          WKFJNB
     I              BVHCNB                          WKHCNB
     I              BVGDNB                          WKGDNB
     I              BVFINB                          WKFINB
     I              BVLKNB                          WKLKNB
     I              BVEAST                          WKEAST
     I              BVAMPC                          WKAMPC
     I              BVAIPC                          WKAIPC
     I              BVAJPC                          WKAJPC
     I              BVAKPC                          WKAKPC
     I              BVX8NB                          WKX8NB
     I              BVFVPC                          WKFVPC
     I              BVFWPC                          WKFWPC
     I              BVFXPC                          WKFXPC
     I              BVALPC                          WKALPC
     I              BVDIST                          WKDIST
     I              BVFYST                          WKFYST
     I              BVD2ST                          WKD2ST
     I              BVEHST                          WKEHST
     I              BVG1ST                          WKG1ST
     I              BVH4ST                          WKH4ST
     I              BVJLST                          WKJLST
     I              BVUUST                          WKUUST
     I              BVVHST                          WKVHST
     I              BVVIST                          WKVIST
     I              BVVJST                          WKVJST
     I              BVVKST                          WKVKST
     I              BVVLST                          WKVLST
     I              BVHMNB                          WKHMNB
     I              BVBNNB                          WKBNNB
     I              BVBONB                          WKBONB
     I              BVCVNB                          WKCVNB
     I              BVB0DT                          WKB0DT
     I              BVAAVN                          WKAAVN
     I              BVAADT                          WKAADT
     I              BVAMTM                          WKAMTM
     I              BVAJST                          WKAJST
     I              BVAHVN                          WKAHVN
     I              BVAGVN                          WKAGVN
     I              BVABVN                          WKABVN
     I              BVABDT                          WKABDT
     I              BVABTM                          WKABTM
     I              BVB8DT                          WKB8DT
     I              BVAOTM                          WKAOTM
      *
     I@B1CPG7
      * Carcass Detail            Retrieval index
      * Renamed input format fields
     I              B1HMNB                          WLHMNB
     I              B1BNNB                          WLBNNB
     I              B1BONB                          WLBONB
     I              B1CVNB                          WLCVNB
     I              B1B0DT                          WLB0DT
     I              B1LGNB                          WLLGNB
     I              B1EUNB                          WLEUNB
     I              B1LHNB                          WLLHNB
     I              B1INST                          WLINST
     I              B1BEPR                          WLBEPR
     I              B1ASPC                          WLASPC
     I              B1EWNB                          WLEWNB
     I              B1B4PR                          WLB4PR
     I              B1EYNB                          WLEYNB
     I              B1B1PR                          WLB1PR
     I              B1AVPR                          WLAVPR
     I              B1AUPC                          WLAUPC
     I              B1AWPR                          WLAWPR
     I              B1AXPR                          WLAXPR
     I              B1EZNB                          WLEZNB
     I              B1AYPR                          WLAYPR
     I              B1BBDT                          WLBBDT
     I              B1AKTM                          WLAKTM
     I              B1IQST                          WLIQST
     I              B1EFST                          WLEFST
     I              B1H6NB                          WLH6NB
     I              B1BEPC                          WLBEPC
     I              B1GCST                          WLGCST
     I              B1GDST                          WLGDST
     I              B1GEST                          WLGEST
     I              B1BHPC                          WLBHPC
     I              B1IOST                          WLIOST
     I              B1IPST                          WLIPST
     I              B1LTNB                          WLLTNB
     I              B1JNST                          WLJNST
     I              B1X4NB                          WLX4NB
     I              B1FNPC                          WLFNPC
     I              B1FOPC                          WLFOPC
     I              B1FPPC                          WLFPPC
     I              B1K2ST                          WLK2ST
     I              B1K3ST                          WLK3ST
     I              B1JWPR                          WLJWPR
     I              B1F5PC                          WLF5PC
     I              B1JXPR                          WLJXPR
     I              B1JYPR                          WLJYPR
     I              B1JZPR                          WLJZPR
     I              B1J0PR                          WLJ0PR
     I              B1J1PR                          WLJ1PR
     I              B1J2PR                          WLJ2PR
     I              B1J3PR                          WLJ3PR
     I              B1J4PR                          WLJ4PR
     I              B1UTST                          WLUTST
     I              B1HVCD                          WLHVCD
     I              B1DKJR                          WLDKJR
     I              B1ITJF                          WLITJF
     I              B1IJGR                          WLIJGR
     I              B1ORJE                          WLORJE
     I              B1OTJR                          WLOTJR
     I              B1PEIR                          WLPEIR
     I              B1IEUF                          WLIEUF
     I              B1ORUE                          WLORUE
     I              B1IUTR                          WLIUTR
     I              B1IJRR                          WLIJRR
     I              B1VCST                          WLVCST
     I              B1VDST                          WLVDST
     I              B1VEST                          WLVEST
     I              B1VFST                          WLVFST
     I              B1VGST                          WLVGST
     I              B1ABCD                          WLABCD
     I              B1AACD                          WLAACD
     I              B1AAVN                          WLAAVN
     I              B1AADT                          WLAADT
     I              B1AMTM                          WLAMTM
     I              B1AJST                          WLAJST
     I              B1AHVN                          WLAHVN
     I              B1AGVN                          WLAGVN
     I              B1ABVN                          WLABVN
     I              B1ABDT                          WLABDT
     I              B1ABTM                          WLABTM
      *
     I@B1CPG6
      * Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WMHMNB
     I              B1BNNB                          WMBNNB
     I              B1BONB                          WMBONB
     I              B1CVNB                          WMCVNB
     I              B1B0DT                          WMB0DT
     I              B1LGNB                          WMLGNB
     I              B1EUNB                          WMEUNB
     I              B1LHNB                          WMLHNB
     I              B1INST                          WMINST
     I              B1BEPR                          WMBEPR
     I              B1ASPC                          WMASPC
     I              B1EWNB                          WMEWNB
     I              B1B4PR                          WMB4PR
     I              B1EYNB                          WMEYNB
     I              B1B1PR                          WMB1PR
     I              B1AVPR                          WMAVPR
     I              B1AUPC                          WMAUPC
     I              B1AWPR                          WMAWPR
     I              B1AXPR                          WMAXPR
     I              B1EZNB                          WMEZNB
     I              B1AYPR                          WMAYPR
     I              B1BBDT                          WMBBDT
     I              B1AKTM                          WMAKTM
     I              B1IQST                          WMIQST
     I              B1EFST                          WMEFST
     I              B1H6NB                          WMH6NB
     I              B1BEPC                          WMBEPC
     I              B1GCST                          WMGCST
     I              B1GDST                          WMGDST
     I              B1GEST                          WMGEST
     I              B1BHPC                          WMBHPC
     I              B1IOST                          WMIOST
     I              B1IPST                          WMIPST
     I              B1LTNB                          WMLTNB
     I              B1JNST                          WMJNST
     I              B1X4NB                          WMX4NB
     I              B1FNPC                          WMFNPC
     I              B1FOPC                          WMFOPC
     I              B1FPPC                          WMFPPC
     I              B1K2ST                          WMK2ST
     I              B1K3ST                          WMK3ST
     I              B1JWPR                          WMJWPR
     I              B1F5PC                          WMF5PC
     I              B1JXPR                          WMJXPR
     I              B1JYPR                          WMJYPR
     I              B1JZPR                          WMJZPR
     I              B1J0PR                          WMJ0PR
     I              B1J1PR                          WMJ1PR
     I              B1J2PR                          WMJ2PR
     I              B1J3PR                          WMJ3PR
     I              B1J4PR                          WMJ4PR
     I              B1UTST                          WMUTST
     I              B1HVCD                          WMHVCD
     I              B1DKJR                          WMDKJR
     I              B1ITJF                          WMITJF
     I              B1IJGR                          WMIJGR
     I              B1ORJE                          WMORJE
     I              B1OTJR                          WMOTJR
     I              B1PEIR                          WMPEIR
     I              B1IEUF                          WMIEUF
     I              B1ORUE                          WMORUE
     I              B1IUTR                          WMIUTR
     I              B1IJRR                          WMIJRR
     I              B1VCST                          WMVCST
     I              B1VDST                          WMVDST
     I              B1VEST                          WMVEST
     I              B1VFST                          WMVFST
     I              B1VGST                          WMVGST
     I              B1ABCD                          WMABCD
     I              B1AACD                          WMAACD
     I              B1AAVN                          WMAAVN
     I              B1AADT                          WMAADT
     I              B1AMTM                          WMAMTM
     I              B1AJST                          WMAJST
     I              B1AHVN                          WMAHVN
     I              B1AGVN                          WMAGVN
     I              B1ABVN                          WMABVN
     I              B1ABDT                          WMABDT
     I              B1ABTM                          WMABTM
      *
     I@DDCPSL
      * Company Kill Expense Rate Co/Kill/Exp
      * Renamed input format fields
     I              DDP9NB                          WOP9NB
     I              DDELCD                          WOELCD
     I              DDCSDT                          WOCSDT
     I              DDL7ST                          WOL7ST
     I              DDF5PR                          WOF5PR
     I              DDAAVN                          WOAAVN
     I              DDAADT                          WOAADT
     I              DDAMTM                          WOAMTM
     I              DDAJST                          WOAJST
     I              DDAHVN                          WOAHVN
     I              DDAGVN                          WOAGVN
     I              DDABVN                          WOABVN
     I              DDABDT                          WOABDT
     I              DDABTM                          WOABTM
      *
     I@DDCPSI
      * Company Kill Expense Rate Update index
      * Renamed input format fields
     I              DDP9NB                          WRP9NB
     I              DDELCD                          WRELCD
     I              DDCSDT                          WRCSDT
     I              DDL7ST                          WRL7ST
     I              DDF5PR                          WRF5PR
     I              DDAAVN                          WRAAVN
     I              DDAADT                          WRAADT
     I              DDAMTM                          WRAMTM
     I              DDAJST                          WRAJST
     I              DDAHVN                          WRAHVN
     I              DDAGVN                          WRAGVN
     I              DDABVN                          WRABVN
     I              DDABDT                          WRABDT
     I              DDABTM                          WRABTM
      *
     I@A7REC1
      * Hog Defect                Retrieval index
      * Renamed input format fields
     I              A7BDCD                          WSBDCD
     I              A7BCTX                          WSBCTX
     I              A7RXST                          WSRXST
     I              A7R2ST                          WSR2ST
     I              A7RYST                          WSRYST
     I              A7RZST                          WSRZST
     I              A7R0ST                          WSR0ST
     I              A7R1ST                          WSR1ST
     I              A7HYCD                          WSHYCD
     I              A7HZCD                          WSHZCD
     I              A7VYST                          WSVYST
     I              A7AEA1                          WSAEA1
     I              A7UOPR                          WSUOPR
     I              A7UPPR                          WSUPPR
     I              A7UQPR                          WSUQPR
     I              A7AAVN                          WSAAVN
     I              A7AADT                          WSAADT
     I              A7AMTM                          WSAMTM
     I              A7AJST                          WSAJST
     I              A7AHVN                          WSAHVN
     I              A7AGVN                          WSAGVN
     I              A7ABVN                          WSABVN
     I              A7ABDT                          WSABDT
     I              A7ABTM                          WSABTM
      *
     I@CCREH3
      * Tattoo Header Process     Retrieval index
      * Renamed input format fields
     I              CCCSCD                          WTCSCD
     I              CCCETX                          WTCETX
     I              CCAAVN                          WTAAVN
     I              CCAADT                          WTAADT
     I              CCAMTM                          WTAMTM
     I              CCAJST                          WTAJST
     I              CCAHVN                          WTAHVN
     I              CCAGVN                          WTAGVN
     I              CCABVN                          WTABVN
     I              CCABDT                          WTABDT
     I              CCABTM                          WTABTM
      *
     I@AFREAR
      * Producer Location         Retrieval index
      * Renamed input format fields
     I              AFABCD                          WVABCD
     I              AFAECD                          WVAECD
     I              AFA8TX                          WVA8TX
     I              AFGLNB                          WVGLNB
     I              AFATST                          WVATST
     I              AFASNB                          WVASNB
     I              AFAUST                          WVAUST
     I              AFQNST                          WVQNST
     I              AFQOST                          WVQOST
     I              AFQPST                          WVQPST
     I              AFQQST                          WVQQST
     I              AFQRST                          WVQRST
     I              AFN0TX                          WVN0TX
     I              AFQSST                          WVQSST
     I              AFQTST                          WVQTST
     I              AFQUST                          WVQUST
     I              AFQVST                          WVQVST
     I              AFR8ST                          WVR8ST
     I              AFR9ST                          WVR9ST
     I              AFSAST                          WVSAST
     I              AFSBST                          WVSBST
     I              AFSDST                          WVSDST
     I              AFSEST                          WVSEST
     I              AFSFST                          WVSFST
     I              AFHWNB                          WVHWNB
     I              AFFUCD                          WVFUCD
     I              AFAAVN                          WVAAVN
     I              AFAADT                          WVAADT
     I              AFAMTM                          WVAMTM
     I              AFAJST                          WVAJST
     I              AFAHVN                          WVAHVN
     I              AFAGVN                          WVAGVN
     I              AFABVN                          WVABVN
     I              AFABDT                          WVABDT
     I              AFABTM                          WVABTM
      *
     I@ADREAF
      * Hog Buyer                 Retrieval index
      * Renamed input format fields
     I              ADACCD                          WWACCD
     I              ADALTX                          WWALTX
     I              ADAQST                          WWAQST
     I              ADARST                          WWARST
     I              ADAAVN                          WWAAVN
     I              ADAADT                          WWAADT
     I              ADAMTM                          WWAMTM
     I              ADAJST                          WWAJST
     I              ADAHVN                          WWAHVN
     I              ADAGVN                          WWAGVN
     I              ADABVN                          WWABVN
     I              ADABDT                          WWABDT
     I              ADABTM                          WWABTM
      *
     I@AIREA9
      * Genetic                   Retrieval index
      * Renamed input format fields
     I              AIAGCD                          WXAGCD
     I              AIAWTX                          WXAWTX
     I              AIAAVN                          WXAAVN
     I              AIAADT                          WXAADT
     I              AIAMTM                          WXAMTM
     I              AIAJST                          WXAJST
     I              AIAHVN                          WXAHVN
     I              AIAGVN                          WXAGVN
     I              AIABVN                          WXABVN
     I              AIABDT                          WXABDT
     I              AIABTM                          WXABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WYBECD
     I              A8BDTX                          WYBDTX
     I              A8BXST                          WYBXST
     I              A8BYST                          WYBYST
     I              A8BITX                          WYBITX
     I              A8B0ST                          WYB0ST
     I              A8FBST                          WYFBST
     I              A8AAVN                          WYAAVN
     I              A8AADT                          WYAADT
     I              A8AMTM                          WYAMTM
     I              A8AJST                          WYAJST
     I              A8AHVN                          WYAHVN
     I              A8AGVN                          WYAGVN
     I              A8ABVN                          WYABVN
     I              A8ABDT                          WYABDT
     I              A8ABTM                          WYABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQPKAZ1    E DSPKAZREL0
      * UPD : Company Control HPE       Update index
      * Renamed input format fields
     I              AZHONB                          WCHONB
     I              AZBSNB                          WCBSNB
     I              AZB1DT                          WCB1DT
     I              AZB2DT                          WCB2DT
     I              AZH4NB                          WCH4NB
     I              AZK3NB                          WCK3NB
     I              AZCDDT                          WCCDDT
     I              AZCEDT                          WCCEDT
     I              AZAAVN                          WCAAVN
     I              AZAADT                          WCAADT
     I              AZAMTM                          WCAMTM
     I              AZAJST                          WCAJST
     I              AZAHVN                          WCAHVN
     I              AZAGVN                          WCAGVN
     I              AZABVN                          WCABVN
     I              AZABDT                          WCABDT
     I              AZABTM                          WCABTM
      *
     IYARDCS      DS                             83
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                             83
     IQPKAW1    E DSPKAWCPL0
      * UPD : Buy Order Header          Update index
      * Renamed input format fields
     I              AWHMNB                          WDHMNB
     I              AWBNNB                          WDBNNB
     I              AWARDT                          WDARDT
     I              AWASDT                          WDASDT
     I              AWA4ST                          WDA4ST
     I              AWA5ST                          WDA5ST
     I              AWAAPR                          WDAAPR
     I              AWA6ST                          WDA6ST
     I              AWA7ST                          WDA7ST
     I              AWB3ST                          WDB3ST
     I              AWALPR                          WDALPR
     I              AWETCD                          WDETCD
     I              AWEUCD                          WDEUCD
     I              AWJ5TX                          WDJ5TX
     I              AWD5DT                          WDD5DT
     I              AWD6DT                          WDD6DT
     I              AWD7DT                          WDD7DT
     I              AWD8DT                          WDD8DT
     I              AWD9DT                          WDD9DT
     I              AWJOEJ                          WDJOEJ
     I              AWKOFF                          WDKOFF
     I              AWKWPE                          WDKWPE
     I              AWIMBF                          WDIMBF
     I              AWOPTR                          WDOPTR
     I              AWOEJD                          WDOEJD
     I              AWIRMF                          WDIRMF
     I              AWJIRM                          WDJIRM
     I              AWJRKF                          WDJRKF
     I              AWKFIR                          WDKFIR
     I              AWUZST                          WDUZST
     I              AWU0ST                          WDU0ST
     I              AWU1ST                          WDU1ST
     I              AWU2ST                          WDU2ST
     I              AWU3ST                          WDU3ST
     I              AWHXNB                          WDHXNB
     I              AWGANB                          WDGANB
     I              AWGBNB                          WDGBNB
     I              AWABCD                          WDABCD
     I              AWAECD                          WDAECD
     I              AWAKCD                          WDAKCD
     I              AWALCD                          WDALCD
     I              AWAGCD                          WDAGCD
     I              AWAICD                          WDAICD
     I              AWAMCD                          WDAMCD
     I              AWACCD                          WDACCD
     I              AWAAVN                          WDAAVN
     I              AWAADT                          WDAADT
     I              AWAMTM                          WDAMTM
     I              AWAJST                          WDAJST
     I              AWAHVN                          WDAHVN
     I              AWAGVN                          WDAGVN
     I              AWABVN                          WDABVN
     I              AWABDT                          WDABDT
     I              AWABTM                          WDABTM
      *
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WFHMNB
     I              AXBNNB                          WFBNNB
     I              AXBONB                          WFBONB
     I              AXCQDT                          WFCQDT
     I              AXABTH                          WFABTH
     I              AXACTH                          WFACTH
     I              AXBPNB                          WFBPNB
     I              AXCSNB                          WFCSNB
     I              AXAUDT                          WFAUDT
     I              AXCMST                          WFCMST
     I              AXAGPR                          WFAGPR
     I              AXATVA                          WFATVA
     I              AXI1ST                          WFI1ST
     I              AXDHNB                          WFDHNB
     I              AXDINB                          WFDINB
     I              AXCNST                          WFCNST
     I              AXGINB                          WFGINB
     I              AXBZDT                          WFBZDT
     I              AXLSNB                          WFLSNB
     I              AXF3TX                          WFF3TX
     I              AXO8ST                          WFO8ST
     I              AXO9ST                          WFO9ST
     I              AXPAST                          WFPAST
     I              AXLDSH                          WFLDSH
     I              AXPBST                          WFPBST
     I              AXPCST                          WFPCST
     I              AXPDST                          WFPDST
     I              AXUWST                          WFUWST
     I              AXUXST                          WFUXST
     I              AXUYST                          WFUYST
     I              AXJKRU                          WFJKRU
     I              AXKEOR                          WFKEOR
     I              AXIOEW                          WFIOEW
     I              AXKJIO                          WFKJIO
     I              AXIOJR                          WFIOJR
     I              AXEIRR                          WFEIRR
     I              AXITMF                          WFITMF
     I              AXODJE                          WFODJE
     I              AXRJIF                          WFRJIF
     I              AXOEJF                          WFOEJF
     I              AXD0DT                          WFD0DT
     I              AXD1DT                          WFD1DT
     I              AXD2DT                          WFD2DT
     I              AXD3DT                          WFD3DT
     I              AXD4DT                          WFD4DT
     I              AXBNCD                          WFBNCD
     I              AXABCD                          WFABCD
     I              AXAECD                          WFAECD
     I              AXAAVN                          WFAAVN
     I              AXAADT                          WFAADT
     I              AXAMTM                          WFAMTM
     I              AXAJST                          WFAJST
     I              AXAHVN                          WFAHVN
     I              AXAGVN                          WFAGVN
     I              AXABVN                          WFABVN
     I              AXABDT                          WFABDT
     I              AXABTM                          WFABTM
      *
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WGHMNB
     I              A1BNNB                          WGBNNB
     I              A1BONB                          WGBONB
     I              A1CVNB                          WGCVNB
     I              A1B0DT                          WGB0DT
     I              A1AWDT                          WGAWDT
     I              A1BICD                          WGBICD
     I              A1CPST                          WGCPST
     I              A1ACPR                          WGACPR
     I              A1B9PR                          WGB9PR
     I              A1CAPR                          WGCAPR
     I              A1C4ST                          WGC4ST
     I              A1AIPR                          WGAIPR
     I              A1A6DT                          WGA6DT
     I              A1C2ST                          WGC2ST
     I              A1CXNB                          WGCXNB
     I              A1CWNB                          WGCWNB
     I              A1FCNB                          WGFCNB
     I              A1H9NB                          WGH9NB
     I              A1FDNB                          WGFDNB
     I              A1FENB                          WGFENB
     I              A1HENB                          WGHENB
     I              A1HFNB                          WGHFNB
     I              A1CYNB                          WGCYNB
     I              A1LRNB                          WGLRNB
     I              A1E0NB                          WGE0NB
     I              A1A5PC                          WGA5PC
     I              A1FBNB                          WGFBNB
     I              A1A4PC                          WGA4PC
     I              A1F7NB                          WGF7NB
     I              A1HDNB                          WGHDNB
     I              A1F5NB                          WGF5NB
     I              A1F4NB                          WGF4NB
     I              A1F3NB                          WGF3NB
     I              A1F2NB                          WGF2NB
     I              A1AVPC                          WGAVPC
     I              A1AWPC                          WGAWPC
     I              A1CWPC                          WGCWPC
     I              A1A8PC                          WGA8PC
     I              A1A7PC                          WGA7PC
     I              A1B8PR                          WGB8PR
     I              A1AMPR                          WGAMPR
     I              A1ANPR                          WGANPR
     I              A1AYVA                          WGAYVA
     I              A1AWVA                          WGAWVA
     I              A1AOPR                          WGAOPR
     I              A1AXVA                          WGAXVA
     I              A1APPR                          WGAPPR
     I              A1ASPR                          WGASPR
     I              A1A4VA                          WGA4VA
     I              A1ATPR                          WGATPR
     I              A1A5VA                          WGA5VA
     I              A1CBPR                          WGCBPR
     I              A1CCPR                          WGCCPR
     I              A1LPNB                          WGLPNB
     I              A1CDPR                          WGCDPR
     I              A1A7VA                          WGA7VA
     I              A1A2PR                          WGA2PR
     I              A1JWST                          WGJWST
     I              A1CWST                          WGCWST
     I              A1D7ST                          WGD7ST
     I              A1D8ST                          WGD8ST
     I              A1DWST                          WGDWST
     I              A1D6ST                          WGD6ST
     I              A1GHNB                          WGGHNB
     I              A1BYDT                          WGBYDT
     I              A1E0ST                          WGE0ST
     I              A1E1ST                          WGE1ST
     I              A1E2ST                          WGE2ST
     I              A1BSDT                          WGBSDT
     I              A1BTDT                          WGBTDT
     I              A1BUDT                          WGBUDT
     I              A1HGNB                          WGHGNB
     I              A1HHNB                          WGHHNB
     I              A1HINB                          WGHINB
     I              A1A3PR                          WGA3PR
     I              A1A4PR                          WGA4PR
     I              A1A6PR                          WGA6PR
     I              A1J9NB                          WGJ9NB
     I              A1D6PR                          WGD6PR
     I              A1D7PR                          WGD7PR
     I              A1D8PR                          WGD8PR
     I              A1D9PR                          WGD9PR
     I              A1EAPR                          WGEAPR
     I              A1EBPR                          WGEBPR
     I              A1ECPR                          WGECPR
     I              A1EDPR                          WGEDPR
     I              A1EEPR                          WGEEPR
     I              A1EFPR                          WGEFPR
     I              A1EGPR                          WGEGPR
     I              A1EHPR                          WGEHPR
     I              A1KAST                          WGKAST
     I              A1J7ST                          WGJ7ST
     I              A1J9ST                          WGJ9ST
     I              A1OXNB                          WGOXNB
     I              A1LKST                          WGLKST
     I              A1LLST                          WGLLST
     I              A1J8ST                          WGJ8ST
     I              A1LIST                          WGLIST
     I              A1LJST                          WGLJST
     I              A1NZTX                          WGNZTX
     I              A1HJCD                          WGHJCD
     I              A1R4ST                          WGR4ST
     I              A1R5ST                          WGR5ST
     I              A1R6ST                          WGR6ST
     I              A1R7ST                          WGR7ST
     I              A1THWT                          WGTHWT
     I              A1T2WT                          WGT2WT
     I              A1THHD                          WGTHHD
     I              A1T2HD                          WGT2HD
     I              A1OBPR                          WGOBPR
     I              A1KOER                          WGKOER
     I              A1OPIR                          WGOPIR
     I              A1OPEM                          WGOPEM
     I              A1IORP                          WGIORP
     I              A1OWEO                          WGOWEO
     I              A1OQET                          WGOQET
     I              A1URST                          WGURST
     I              A1USST                          WGUSST
     I              A1HHPC                          WGHHPC
     I              A1S9PR                          WGS9PR
     I              A1TAPR                          WGTAPR
     I              A1TBPR                          WGTBPR
     I              A1JFUR                          WGJFUR
     I              A1KRIF                          WGKRIF
     I              A1KORF                          WGKORF
     I              A1KAPR                          WGKAPR
     I              A1KROT                          WGKROT
     I              A1OTJG                          WGOTJG
     I              A1IRJG                          WGIRJG
     I              A1IMJF                          WGIMJF
     I              A1IRGF                          WGIRGF
     I              A1KRJF                          WGKRJF
     I              A1OJRF                          WGOJRF
     I              A1KFOR                          WGKFOR
     I              A1ORJK                          WGORJK
     I              A1OMVJ                          WGOMVJ
     I              A1MVNF                          WGMVNF
     I              A1MCNF                          WGMCNF
     I              A1NCNF                          WGNCNF
     I              A1NCHF                          WGNCHF
     I              A1IGIR                          WGIGIR
     I              A1KFJR                          WGKFJR
     I              A1EADT                          WGEADT
     I              A1EBDT                          WGEBDT
     I              A1ECDT                          WGECDT
     I              A1EDDT                          WGEDDT
     I              A1EEDT                          WGEEDT
     I              A1U4ST                          WGU4ST
     I              A1U5ST                          WGU5ST
     I              A1U6ST                          WGU6ST
     I              A1U7ST                          WGU7ST
     I              A1U8ST                          WGU8ST
     I              A1U9ST                          WGU9ST
     I              A1VAST                          WGVAST
     I              A1VBST                          WGVBST
     I              A1BDCD                          WGBDCD
     I              A1CSCD                          WGCSCD
     I              A1ABCD                          WGABCD
     I              A1AECD                          WGAECD
     I              A1ACCD                          WGACCD
     I              A1AGCD                          WGAGCD
     I              A1BECD                          WGBECD
     I              A1AAVN                          WGAAVN
     I              A1AADT                          WGAADT
     I              A1AMTM                          WGAMTM
     I              A1AJST                          WGAJST
     I              A1AHVN                          WGAHVN
     I              A1AGVN                          WGAGVN
     I              A1ABVN                          WGABVN
     I              A1ABDT                          WGABDT
     I              A1ABTM                          WGABTM
      *
     IQPKB31    E DSPKB3CPL0
      * UPD : Tattoo Scale Ticket       Update index
      * Renamed input format fields
     I              B3HMNB                          WIHMNB
     I              B3BNNB                          WIBNNB
     I              B3BONB                          WIBONB
     I              B3CVNB                          WICVNB
     I              B3B0DT                          WIB0DT
     I              B3FKNB                          WIFKNB
     I              B3FMNB                          WIFMNB
     I              B3FLNB                          WIFLNB
     I              B3B6DT                          WIB6DT
     I              B3ANTM                          WIANTM
     I              B3JDA1                          WIJDA1
     I              B3CFDT                          WICFDT
     I              B3APTM                          WIAPTM
     I              B3I3ST                          WII3ST
     I              B3HVNB                          WIHVNB
     I              B3CMCD                          WICMCD
     I              B3AAVN                          WIAAVN
     I              B3AADT                          WIAADT
     I              B3AMTM                          WIAMTM
     I              B3AJST                          WIAJST
     I              B3AHVN                          WIAHVN
     I              B3AGVN                          WIAGVN
     I              B3ABVN                          WIABVN
     I              B3ABDT                          WIABDT
     I              B3ABTM                          WIABTM
      *
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WKHSNB
     I              BVA9DT                          WKA9DT
     I              BVFJNB                          WKFJNB
     I              BVHCNB                          WKHCNB
     I              BVGDNB                          WKGDNB
     I              BVFINB                          WKFINB
     I              BVLKNB                          WKLKNB
     I              BVEAST                          WKEAST
     I              BVAMPC                          WKAMPC
     I              BVAIPC                          WKAIPC
     I              BVAJPC                          WKAJPC
     I              BVAKPC                          WKAKPC
     I              BVX8NB                          WKX8NB
     I              BVFVPC                          WKFVPC
     I              BVFWPC                          WKFWPC
     I              BVFXPC                          WKFXPC
     I              BVALPC                          WKALPC
     I              BVDIST                          WKDIST
     I              BVFYST                          WKFYST
     I              BVD2ST                          WKD2ST
     I              BVEHST                          WKEHST
     I              BVG1ST                          WKG1ST
     I              BVH4ST                          WKH4ST
     I              BVJLST                          WKJLST
     I              BVUUST                          WKUUST
     I              BVVHST                          WKVHST
     I              BVVIST                          WKVIST
     I              BVVJST                          WKVJST
     I              BVVKST                          WKVKST
     I              BVVLST                          WKVLST
     I              BVHMNB                          WKHMNB
     I              BVBNNB                          WKBNNB
     I              BVBONB                          WKBONB
     I              BVCVNB                          WKCVNB
     I              BVB0DT                          WKB0DT
     I              BVAAVN                          WKAAVN
     I              BVAADT                          WKAADT
     I              BVAMTM                          WKAMTM
     I              BVAJST                          WKAJST
     I              BVAHVN                          WKAHVN
     I              BVAGVN                          WKAGVN
     I              BVABVN                          WKABVN
     I              BVABDT                          WKABDT
     I              BVABTM                          WKABTM
     I              BVB8DT                          WKB8DT
     I              BVAOTM                          WKAOTM
      *
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      * Renamed input format fields
     I              B1HMNB                          WMHMNB
     I              B1BNNB                          WMBNNB
     I              B1BONB                          WMBONB
     I              B1CVNB                          WMCVNB
     I              B1B0DT                          WMB0DT
     I              B1LGNB                          WMLGNB
     I              B1EUNB                          WMEUNB
     I              B1LHNB                          WMLHNB
     I              B1INST                          WMINST
     I              B1BEPR                          WMBEPR
     I              B1ASPC                          WMASPC
     I              B1EWNB                          WMEWNB
     I              B1B4PR                          WMB4PR
     I              B1EYNB                          WMEYNB
     I              B1B1PR                          WMB1PR
     I              B1AVPR                          WMAVPR
     I              B1AUPC                          WMAUPC
     I              B1AWPR                          WMAWPR
     I              B1AXPR                          WMAXPR
     I              B1EZNB                          WMEZNB
     I              B1AYPR                          WMAYPR
     I              B1BBDT                          WMBBDT
     I              B1AKTM                          WMAKTM
     I              B1IQST                          WMIQST
     I              B1EFST                          WMEFST
     I              B1H6NB                          WMH6NB
     I              B1BEPC                          WMBEPC
     I              B1GCST                          WMGCST
     I              B1GDST                          WMGDST
     I              B1GEST                          WMGEST
     I              B1BHPC                          WMBHPC
     I              B1IOST                          WMIOST
     I              B1IPST                          WMIPST
     I              B1LTNB                          WMLTNB
     I              B1JNST                          WMJNST
     I              B1X4NB                          WMX4NB
     I              B1FNPC                          WMFNPC
     I              B1FOPC                          WMFOPC
     I              B1FPPC                          WMFPPC
     I              B1K2ST                          WMK2ST
     I              B1K3ST                          WMK3ST
     I              B1JWPR                          WMJWPR
     I              B1F5PC                          WMF5PC
     I              B1JXPR                          WMJXPR
     I              B1JYPR                          WMJYPR
     I              B1JZPR                          WMJZPR
     I              B1J0PR                          WMJ0PR
     I              B1J1PR                          WMJ1PR
     I              B1J2PR                          WMJ2PR
     I              B1J3PR                          WMJ3PR
     I              B1J4PR                          WMJ4PR
     I              B1UTST                          WMUTST
     I              B1HVCD                          WMHVCD
     I              B1DKJR                          WMDKJR
     I              B1ITJF                          WMITJF
     I              B1IJGR                          WMIJGR
     I              B1ORJE                          WMORJE
     I              B1OTJR                          WMOTJR
     I              B1PEIR                          WMPEIR
     I              B1IEUF                          WMIEUF
     I              B1ORUE                          WMORUE
     I              B1IUTR                          WMIUTR
     I              B1IJRR                          WMIJRR
     I              B1VCST                          WMVCST
     I              B1VDST                          WMVDST
     I              B1VEST                          WMVEST
     I              B1VFST                          WMVFST
     I              B1VGST                          WMVGST
     I              B1ABCD                          WMABCD
     I              B1AACD                          WMAACD
     I              B1AAVN                          WMAAVN
     I              B1AADT                          WMAADT
     I              B1AMTM                          WMAMTM
     I              B1AJST                          WMAJST
     I              B1AHVN                          WMAHVN
     I              B1AGVN                          WMAGVN
     I              B1ABVN                          WMABVN
     I              B1ABDT                          WMABDT
     I              B1ABTM                          WMABTM
      *
     IQPKDD1    E DSPKDDCPL0
      * UPD : Company Kill Expense Rate Update index
      * Renamed input format fields
     I              DDP9NB                          WRP9NB
     I              DDELCD                          WRELCD
     I              DDCSDT                          WRCSDT
     I              DDL7ST                          WRL7ST
     I              DDF5PR                          WRF5PR
     I              DDAAVN                          WRAAVN
     I              DDAADT                          WRAADT
     I              DDAMTM                          WRAMTM
     I              DDAJST                          WRAJST
     I              DDAHVN                          WRAHVN
     I              DDAGVN                          WRAGVN
     I              DDABVN                          WRABVN
     I              DDABDT                          WRABDT
     I              DDABTM                          WRABTM
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * N :  Oms Warehouse Code
     I                                        1   3 P1J8NB
      * N :  CC Company Number
     I                                    P   4   50P1HONB
      * N :  Oms Application Code
     I                                        6  11 P1C7CD
      * N :  Oms SalesPerson Code
     I                                       12  14 P1C8CD
      * N :  Oms Allow Multi-Company
     I                                       15  15 P1G8ST
      * N :  Oms Default Printer
     I                                       16  25 P1G9ST
      * N :  Oms Name
     I                                       26  55 P1EUTX
      * N :  Oms System Value Alpha
     I                                       56  95 P1EVTX
      * N :  Oms Access Denied (Y/N)
     I                                       96  96 P1HAST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Date 1 LE Date 2 Req'
      * Date To   USR
     I                                    P   1   40ZA0001
      * Date USR
     I                                    P   5   80ZA0002
      * Message data for 'Date 1 LE Date 2 Req'
      * Date To   USR
     I                                    P   1   40ZA0003
      * Date USR
     I                                    P   5   80ZA0004
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
     E* Y2V3111 - Actual parameter(s) not found
      * Utl Copy Buy Order    RT - Buy Order Header  * 
     C                     EXSR SARVGN
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate TH Kill Date
      * External date
     C                     Z-ADDV1B0DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9934  *
     C                     END
     C                     Z-ADDXDINDT    #1B0DT
      * Validate Kill Date 1 Usr
      * External date
     C                     Z-ADDVDC6DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9935  *
     C                     END
     C                     Z-ADDXDINDT    #DC6DT
      * Validate Kill Date 2 USR
      * External date
     C                     Z-ADDVDCWDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9936  *
     C                     END
     C                     Z-ADDXDINDT    #DCWDT
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
     C                     END                             *FI
      * RTV Tattoo Record     RT - Tattoo Header  * 
     C                     EXSR SRRVGN
      * CASE: DTL.Kill Date 1 Usr LE DTL.TH Kill Date
     C           #DC6DT    IFLE #1B0DT                     *IF
      * Setup message data for message
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0001
      * Convert Kill Date 1 Usr to display format
      * Convert date
     C           1000000   ADD  #DC6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0002
      * Send message 'Date 1 LE Date 2 Req'
     C                     MOVEL'PRK0635' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993435*
      *
     C                     END                             *FI
      * CASE: DTL.Kill Date 1 Usr GT DTL.Kill Date 2 USR
     C           #DC6DT    IFGT #DCWDT                     *IF
      * Setup message data for message
      * Convert Kill Date 1 Usr to display format
      * Convert date
     C           1000000   ADD  #DC6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
      * Convert Kill Date 2 USR to display format
      * Convert date
     C           1000000   ADD  #DCWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0004
      * Send message 'Date 1 LE Date 2 Req'
     C                     MOVEL'PRK0635' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993536*
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Hog Defect
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Tattoo Header Process
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Buyer
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Genetic
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Check reference to Hog Classification
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
      * Kill Date 1 Usr required
     C           #DC6DT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Kill Date 2 USR required
     C           #DCWDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9936  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Update screen time
     C                     TIME           ##TME
      * Enable PUTOVR
     C                     SETON                         86*
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADD*ZERO     #1AWDT           TH Purchase Dat
     C                     MOVEL*BLANK    #1BICD           TH Group Refere
     C                     MOVEL*BLANK    #1CPST           TH Live Purchas
     C                     Z-ADD*ZERO     #1ACPR           TH Live Purchas
     C                     Z-ADD*ZERO     #1B9PR           TH Live Gross A
     C                     Z-ADD*ZERO     #1CAPR           TH LIve Net Amt
     C                     MOVEL*BLANK    #1C4ST           TH Resale UOM
     C                     Z-ADD*ZERO     #1AIPR           TH Recalc Live
     C                     Z-ADD*ZERO     #1A6DT           TH Pricing Date
     C                     MOVEL*BLANK    #1C2ST           TH Resale Sprea
     C                     Z-ADD*ZERO     #1CXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     #1CWNB           TH Head Receive
     C                     Z-ADD*ZERO     #1FCNB           TH Yard Deads
     C                     Z-ADD*ZERO     #1H9NB           TH Held Over
     C                     Z-ADD*ZERO     #1FDNB           TH Head Condemn
     C                     Z-ADD*ZERO     #1FENB           TH Head Killed
     C                     Z-ADD*ZERO     #1HENB           TH Head Adds
     C                     Z-ADD*ZERO     #1HFNB           TH Head Accepte
     C                     Z-ADD*ZERO     #1CYNB           TH Live Wgt
     C                     Z-ADD*ZERO     #1LRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     #1E0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     #1A5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     #1FBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     #1A4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     #1F7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     #1HDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1F5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     #1F4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     #1F3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1F2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     #1AVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     #1AWPC           TH Actual Yield
     C                     Z-ADD*ZERO     #1CWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     #1A8PC           TH Yield Differ
     C                     Z-ADD*ZERO     #1A7PC           TH Recalc Live
     C                     Z-ADD*ZERO     #1B8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     #1AMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1ANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     #1AYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     #1AWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     #1AOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     #1AXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     #1APPR           TH CM Carcass G
     C                     Z-ADD*ZERO     #1ASPR           TH Deduction Am
     C                     Z-ADD*ZERO     #1A4VA           TH Total Net WO
     C                     Z-ADD*ZERO     #1ATPR           TH Carcass Net
     C                     Z-ADD*ZERO     #1A5VA           TH Additions Am
     C                     Z-ADD*ZERO     #1CBPR           TH Payment Gros
     C                     Z-ADD*ZERO     #1CCPR           Th Payment Net
     C                     Z-ADD*ZERO     #1LPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     #1CDPR           TH Freight Amou
     C                     Z-ADD*ZERO     #1A7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     #1A2PR           TH Fixed Cost A
     C                     MOVEL*BLANK    #1JWST           TH Calc Net Sts
     C                     MOVEL*BLANK    #1CWST           TH Payment Sts
     C                     MOVEL*BLANK    #1D7ST           TH Header Error
     C                     MOVEL*BLANK    #1D8ST           TH Detail Error
     C                     MOVEL*BLANK    #1DWST           TH Kill Balanci
     C                     MOVEL*BLANK    #1D6ST           TH Bal to Kill
     C                     Z-ADD*ZERO     #1GHNB           TH Commission A
     C                     Z-ADD*ZERO     #1BYDT           TH Voucher Paym
     C                     MOVEL*BLANK    #1E0ST           TH User Error O
     C                     MOVEL*BLANK    #1E1ST           TH Held Over Re
     C                     MOVEL*BLANK    #1E2ST           TH Sex
     C                     Z-ADD*ZERO     #1BSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     #1BTDT           TH Commission P
     C                     Z-ADD*ZERO     #1BUDT           TH Actual Check
     C                     Z-ADD*ZERO     #1HGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     #1HHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     #1HINB           TH FFLI
     C                     Z-ADD*ZERO     #1A3PR           TH Kill Product
     C                     Z-ADD*ZERO     #1A4PR           TH Cut Product
     C                     Z-ADD*ZERO     #1A6PR           TH Render Produ
     C                     Z-ADD*ZERO     #1J9NB           TH Head Exclude
     C                     Z-ADD*ZERO     #1D6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     #1D7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     #1D8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     #1D9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     #1EAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     #1EBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     #1ECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     #1EDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     #1EEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     #1EGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     #1EHPR           TH CM Gross Car
     C                     MOVEL*BLANK    #1KAST           TH Source Type
     C                     MOVEL*BLANK    #1J7ST           TH Scale Ticket
     C                     MOVEL*BLANK    #1J9ST           TH Payment Type
     C                     Z-ADD*ZERO     #1OXNB           TH HPS Movement
     C                     MOVEL*BLANK    #1LKST           TH Source Code
     C                     MOVEL*BLANK    #1LLST           TH Hog Class Ty
     C                     MOVEL*BLANK    #1J8ST           TH Posted to HP
     C                     MOVEL*BLANK    #1LIST           TH Schedule Kil
     C                     MOVEL*BLANK    #1LJST           TH Shift Held O
     C                     MOVEL*BLANK    #1NZTX           TH State
     C                     MOVEL*BLANK    #1HJCD           TH Unused Code
     C                     MOVEL*BLANK    #1R4ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1R5ST           TH Commission S
     C                     MOVEL*BLANK    #1R6ST           TH Paid 2 Week
     C                     MOVEL*BLANK    #1R7ST           TH Unused Sts 1
     C                     Z-ADD*ZERO     #1THWT           TH DOA Weight
     C                     Z-ADD*ZERO     #1T2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     #1THHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     #1T2HD           TH Shift Held O
     C                     Z-ADD*ZERO     #1OBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     #1KOER           TH Head Identif
     C                     Z-ADD*ZERO     #1OPIR           TH Percent Iden
     C                     Z-ADD*ZERO     #1OPEM           TH Percent Acce
     C                     Z-ADD*ZERO     #1IORP           TH Head Adjuste
     C                     Z-ADD*ZERO     #1OWEO           TH PHA Head Add
     C                     MOVEL*BLANK    #1OQET           TH PHA Add Type
     C                     MOVEL*BLANK    #1URST           TH PHA Average
     C                     MOVEL*BLANK    #1USST           TH PHA Add Reas
     C                     Z-ADD*ZERO     #1HHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     #1S9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     #1TAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     #1TBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     #1JFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     #1KRIF           TH Broken Back
     C                     Z-ADD*ZERO     #1KORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     #1KAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     #1KROT           TH Excluded Car
     C                     Z-ADD*ZERO     #1OTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     #1IRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     #1IMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     #1IRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     #1KRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1OJRF           TH Break Even P
     C                     Z-ADD*ZERO     #1KFOR           TH Meat Value F
     C                     Z-ADD*ZERO     #1ORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     #1OMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     #1MVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     #1MCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     #1NCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     #1NCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     #1IGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     #1KFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     #1EADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1EBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     #1ECDT           TH Head LFT
     C                     Z-ADD*ZERO     #1EDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     #1EEDT           TH Unused Date
     C                     MOVEL*BLANK    #1U4ST           TH Unused Sts 1
     C                     MOVEL*BLANK    #1U5ST           TH Unused Sts 2
     C                     MOVEL*BLANK    #1U6ST           TH Unused Sts 3
     C                     MOVEL*BLANK    #1U7ST           TH Unused Sts 4
     C                     MOVEL*BLANK    #1U8ST           TH Unused Sts 5
     C                     MOVEL*BLANK    #1U9ST           TH Unused Sts 6
     C                     MOVEL*BLANK    #1VAST           TH Unused Sts 7
     C                     MOVEL*BLANK    #1VBST           TH Unused Sts 8
     C                     MOVEL*BLANK    #1AGCD           GN Genetic Code
     C                     MOVEL*BLANK    #1BECD           HC Class Code
     C                     MOVEL*BLANK    #1BDCD           DF Defect Code
     C                     MOVEL*BLANK    #1CSCD           THP Process Cod
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #1AECD           PL Location Cod
     C                     MOVEL*BLANK    #1ACCD           HB Buyer Code
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADD*ZERO     #1HMNB           BOH Company Num
     C                     Z-ADD*ZERO     #1BNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     #1BONB           BOL Load Number
     C                     Z-ADD*ZERO     #1CVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     #1B0DT           TH Kill Date
      * Clear external version also
     C                     Z-ADD*ZERO     V1B0DT
     C                     Z-ADD*ZERO     #DC6DT           Kill Date 1 Usr
      * Clear external version also
     C                     Z-ADD*ZERO     VDC6DT
     C                     Z-ADD*ZERO     #DCWDT           Kill Date 2 USR
      * Clear external version also
     C                     Z-ADD*ZERO     VDCWDT
      * USER: Load screen
     C                     Z-ADDP1HONB    #1HMNB           BOH Company Num
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  #1B0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1B0DT
      * Convert Kill Date 1 Usr to display format
      * Convert date
     C           1000000   ADD  #DC6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDC6DT
      * Convert Kill Date 2 USR to display format
      * Convert date
     C           1000000   ADD  #DCWDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDCWDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Utl Copy Buy Order    RT - Buy Order Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       Kill Date Usr
     C                     Z-ADD*ZERO     WN0002  50       Buy Order Numbe
     C                     Z-ADD*ZERO     WN0003  10       Day of Week USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD#DC6DT    WN0001           Kill Date Usr
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSA     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * DO WHILE: PAR.Kill Date Usr LE PAR.Kill Date 2 USR
     C           WN0001    DOWLE#DCWDT                     *DOW
      * Rtv/Upd Next BO       RT - Company Control HPE  * 
     C                     EXSR SBRVGN
      * Crt Buy Order Header  CR - Buy Order Header  * 
     C                     EXSR SECRRC
      * Utl Copy Buy Order Ld RT - Buy Order Load  * 
     C                     EXSR SFRVGN
      * Utl Copy Tattoo Hdr   RT - Tattoo Header  * 
     C                     EXSR SHRVGN
      * Utl Copy Tattoo ST    RT - Tattoo Scale Ticket  * 
     C                     EXSR SJRVGN
      * Utl Copy Eval Trans   RT - Eval Trans  * 
     C                     EXSR SLRVGN
      * Utl Copy Carc Dtl     RT - Carcass Detail  * 
     C                     EXSR SNRVGN
      * Utl Copy Exp Rate     rt - Company Kill Expense Rate  * 
     C                     EXSR SPRVGN
      * PAR.Kill Date Usr = PAR.Kill Date Usr + CON.1 *DAYS
     C           WN0001    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111100' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0001
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0001
     C                     END
     C                     END                             *ITR
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv/Upd Next BO       RT - Company Control HPE  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP7UVA1    WBHONB           CC Company Numb
      * Establish starting position
     C           KRSSB     CHAIN@AZCPCN              90    *
      * Data record not found
     C   90                MOVEL'PRK0055' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWBBSNB    WN0002           BOH Buy Order N
      * CASE: DB1.Next Buy Order Number is EQ 99999
     C           WBBSNB    IFEQ 99999                      *IF
      * Chg Next BO           CH - Company Control HPE  * 
     C                     EXSR SCCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C           WBBSNB    ADD  1         WUBSNB           Next Buy Order
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBK3NB' defaulted for 'Last Tattoo Nbr'.
      * Field '(DB1) WBCDDT' defaulted for 'Current Production Date'.
      * Field '(DB1) WBCEDT' defaulted for 'Next Production Date'.
      * Chg Next BO           CH - Company Control HPE  * 
     C                     EXSR SDCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Next BO           CH - Company Control HPE  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  70       Current Kill Da
     C                     Z-ADD*ZERO     WN0005  70       Next Kill Date
     C                     Z-ADD*ZERO     WN0006  30       Last Drive Card
     C                     MOVEL*BLANK    WN0007 10        RS User Changed
     C                     Z-ADD*ZERO     WN0008  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0009  60       RS Time Changed
     C                     MOVEL*BLANK    WN0010  1        RS Record Statu
     C                     MOVEL*BLANK    WN0011 10        RS Job
     C                     MOVEL*BLANK    WN0012 10        RS Program
     C                     MOVEL*BLANK    WN0013 10        RS User Added
     C                     Z-ADD*ZERO     WN0014  70       RS Date Added
     C                     Z-ADD*ZERO     WN0015  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @AZCPCM
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C           KLCHSC    CHAIN@AZCPCM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAZREL0'MDACP
     C                     MOVEL'@AZCPCM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAZ1    YARDCS
      * Move non-key fields to @AZCPCM
     C                     Z-ADD10000     WCBSNB           Next Buy Order
     C                     Z-ADDWBK3NB    WCK3NB           Last Tattoo Nbr
     C                     Z-ADDWBCDDT    WCCDDT           Current Product
     C                     Z-ADDWBCEDT    WCCEDT           Next Production
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAZ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAZ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@AZCPCM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * Chg Next BO           CH - Company Control HPE  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0016  70       Current Kill Da
     C                     Z-ADD*ZERO     WN0017  70       Next Kill Date
     C                     Z-ADD*ZERO     WN0018  30       Last Drive Card
     C                     MOVEL*BLANK    WN0019 10        RS User Changed
     C                     Z-ADD*ZERO     WN0020  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0021  60       RS Time Changed
     C                     MOVEL*BLANK    WN0022  1        RS Record Statu
     C                     MOVEL*BLANK    WN0023 10        RS Job
     C                     MOVEL*BLANK    WN0024 10        RS Program
     C                     MOVEL*BLANK    WN0025 10        RS User Added
     C                     Z-ADD*ZERO     WN0026  70       RS Date Added
     C                     Z-ADD*ZERO     WN0027  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AZCPCM
     C                     Z-ADDWBHONB    WCHONB           CC Company Numb
      *
     C           KLCHSD    KLIST
     C                     KFLD           WCHONB           CC Company Numb
     C           KLCHSD    CHAIN@AZCPCM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAZREL0'MDACP
     C                     MOVEL'@AZCPCM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAZ1    YBRDCS
      * Move non-key fields to @AZCPCM
     C                     Z-ADDWUBSNB    WCBSNB           Next Buy Order
     C                     Z-ADDWBK3NB    WCK3NB           Last Tattoo Nbr
     C                     Z-ADDWBCDDT    WCCDDT           Current Product
     C                     Z-ADDWBCEDT    WCCEDT           Next Production
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAZ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAZ1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AZCPCM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Buy Order Header  CR - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AWCPAZ
     C                     Z-ADDP7UVA1    WDHMNB           BOH Company Num
     C                     Z-ADDWN0002    WDBNNB           BOH Buy Order N
     C                     Z-ADDWN0001    WDARDT           BOH Buy Order D
     C                     Z-ADDWN0001    WDASDT           BOH Kill Date
     C                     MOVELWAA4ST    WDA4ST           BOH Payment Typ
     C                     MOVELWAA5ST    WDA5ST           BOH Buy Order T
     C                     Z-ADDWAAAPR    WDAAPR           BOH Market Add/
     C                     MOVELWAA6ST    WDA6ST           BOH Status
     C                     MOVELWAA7ST    WDA7ST           BOH Delv Plan P
     C                     MOVELWAB3ST    WDB3ST           BOH Quote Price
     C                     Z-ADDWAALPR    WDALPR           BOH Quoted Base
     C                     MOVELWAETCD    WDETCD           BOH Commodity M
     C                     MOVELWAEUCD    WDEUCD           BOH Commodity P
     C                     MOVELWAJ5TX    WDJ5TX           BOH Market Date
     C                     Z-ADDWAD5DT    WDD5DT           BOH MPR Reporti
     C                     Z-ADDWAD6DT    WDD6DT           BOH Hedge Date
     C                     Z-ADDWAD7DT    WDD7DT           BOH Unused Date
     C                     Z-ADDWAD8DT    WDD8DT           BOH Unused Date
     C                     Z-ADDWAD9DT    WDD9DT           BOH Unused Date
     C                     Z-ADDWAJOEJ    WDJOEJ           BOH Hedge Head
     C                     Z-ADDWAKOFF    WDKOFF           BOH Hedge Refer
     C                     Z-ADDWAKWPE    WDKWPE           BOH Hedge Time
     C                     Z-ADDWAIMBF    WDIMBF           BOH Unused Nbr
     C                     Z-ADDWAOPTR    WDOPTR           BOH Unused Nbr
     C                     Z-ADDWAOEJD    WDOEJD           BOH Unused Nbr
     C                     Z-ADDWAIRMF    WDIRMF           BOH Unused Nbr
     C                     Z-ADDWAJIRM    WDJIRM           BOH Unused Nbr
     C                     Z-ADDWAJRKF    WDJRKF           BOH Unused Nbr
     C                     Z-ADDWAKFIR    WDKFIR           BOH Unused Nbr
     C                     MOVELWAUZST    WDUZST           BOH MPR Reporti
     C                     MOVELWAU0ST    WDU0ST           BOH MPR EST RPT
     C                     MOVELWAU1ST    WDU1ST           BOH MPR Purchas
     C                     MOVELWAU2ST    WDU2ST           BOH Status 4
     C                     MOVELWAU3ST    WDU3ST           BOH Status 5
     C                     Z-ADDWAHXNB    WDHXNB           PPWS Company Nu
     C                     Z-ADDWAGANB    WDGANB           CW Year
     C                     Z-ADDWAGBNB    WDGBNB           CW Week Number
     C                     MOVELWAABCD    WDABCD           PD Producer Cod
     C                     MOVELWAAECD    WDAECD           PL Location Cod
     C                     MOVELWAAKCD    WDAKCD           PC Contract Cod
     C                     MOVELWAALCD    WDALCD           PSC Sub-Contrac
     C                     MOVELWAAGCD    WDAGCD           GN Genetic Code
     C                     MOVELWAAICD    WDAICD           PO Option Code
     C                     MOVELWAAMCD    WDAMCD           CMP Program Cod
     C                     MOVELWAACCD    WDACCD           HB Buyer Code
     C                     MOVEL*BLANK    WDAAVN           RS User Changed
     C                     Z-ADD0         WDAADT           RS Date Changed
     C                     Z-ADD0         WDAMTM           RS Time Changed
     C                     MOVELWAAJST    WDAJST           RS Record Statu
     C                     MOVELWAAHVN    WDAHVN           RS Job
     C                     MOVELWAAGVN    WDAGVN           RS Program
     C                     MOVELWAABVN    WDABVN           RS User Added
     C                     Z-ADDWAABDT    WDABDT           RS Date Added
     C                     Z-ADDWAABTM    WDABTM           RS Time Added
      *
      * USER: Processing before Data update
      * RMC 6/19/19 whd 49122 Chg time to 1:45 per Jerry L at tf
      * RMC 9/23/16 R7307   Chg time as of 10/11/2016  per new MPR Rule:
      *             compile all functions that call this CRTOBJ
      *      9:55:59 changed to 9:30:59             9:56 changed to 9:31
      *      1:55:59 changed to 1:30:59
      * *****************************************************************
      * RMC  Chg time as of 01/10/07:
      *      9:30:59 changed to 9:55:59             9:31 changed to 9:56
      *      1:30:59 changed to 1:55:59
      * *****************************************************************
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WDAJST           RS Record Statu
     C                     MOVEL##USR     WDABVN           RS User Added
     C                     Z-ADD##JDT     WDABDT           RS Date Added
     C                     Z-ADD##JTM     WDABTM           RS Time Added
     C                     MOVEL##PGM     WDAGVN           RS Program
     C                     MOVEL##JOB     WDAHVN           RS Job
      * ** create record boh status as open
     C                     MOVEL'O'       WDA6ST           BOH Status
      * PK0254 -- MPR Reporting Time and Date       RMC 1/19/2001
      *   If Current Time < 9:30:59 am
      *     Reporting Date = Current Date
      *     Reporting Time = 1
      *   If 9:31 am < Current Time < 1:30:59 pm
      *     Reporting Date = Current Date
      *     Reporting Time = 2
      * *** replace with R7307 -- effective 10/11/2016
      *   * Otherwise         (These will not be reported at all.)
      *   * Reporting Date = 0
      *   * Reporting Time = 0
      * *** NEW     with R7307 -- effective 10/11/2016
      *     Reporting Date = Next kill date - skip sat/sun
      *     Reporting Time = 1
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           YL0001    PARM *ZERO     WQ0001  70       *DATE
     C           YL0002    PARM *ZERO     WQ0002  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.*TIME is LE 09:30:59
     C           YL0002    IFLE 093059                     *IF
     C                     Z-ADDYL0001    WDD5DT           BOH MPR Reporti
     C                     MOVEL'1'       WDUZST           BOH MPR Reporti
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.*TIME is LE 13:45:59
     C           YL0002    IFLE 134559                     *IF
      * 6/19/19 RMC time was LE 13:30:59
     C                     Z-ADDYL0001    WDD5DT           BOH MPR Reporti
     C                     MOVEL'2'       WDUZST           BOH MPR Reporti
     C                     ELSE
      * CASE: *OTHERWISE
      * R7307 -- GT 1:30 get reported at next day's 1st submission at 9:3
      * RTV Next WkDy,N=Holidy XF - STR Order Management Sys  * 
     C                     CALL 'PBYUXFR'              90  RTV Next WkDy,N
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDHMNB    WQ0003  30       BOH Company Num
     C                     PARM YL0001    WQ0004  70       Date Beg USR
     C           YL0003    PARM *ZERO     WQ0005  70       Date To   USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBYUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDYL0003    WDD5DT           BOH MPR Reporti
     C                     MOVEL'1'       WDUZST           BOH MPR Reporti
     C                     END                             *FI
     C                     END                             *FI
     C           KLCRSE    KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
      * Check for duplicate primary key
     C           KLCRSE    SETLL@AWCPAZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0050' W0RTN   7
      * Send message 'Buy Order Header       EX'
     C                     MOVEL'PRK0050' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@AWCPAZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Utl Copy Buy Order Ld RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
      * Setup key
     C                     Z-ADDWAHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WEBONB           BOL Load Number
      * Establish starting position
     C           KRSSF     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Crt Buy Order Detail  CR - Buy Order Load  * 
     C                     EXSR SGCRRC
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Buy Order Detail  CR - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AXCPBY
     C                     Z-ADDP7UVA1    WFHMNB           BOH Company Num
     C                     Z-ADDWN0002    WFBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WFBONB           BOL Load Number
     C                     Z-ADDWN0001    WFCQDT           BOL Kill Date
     C                     Z-ADDWEABTH    WFABTH           BOL Pln Delv St
     C                     Z-ADDWEACTH    WFACTH           BOL Pln Delv En
     C                     Z-ADDWEBPNB    WFBPNB           BOL Pln Head De
     C                     Z-ADDWECSNB    WFCSNB           BOL Shipped Wgt
     C                     Z-ADDWN0001    WFAUDT           BOL Pln Delv Da
     C                     MOVELWECMST    WFCMST           BOL Freight UOM
     C                     Z-ADDWEAGPR    WFAGPR           BOL Freight Uni
     C                     Z-ADDWEATVA    WFATVA           BOL Freight Amt
     C                     MOVELWEI1ST    WFI1ST           BOL Freight All
     C                     Z-ADDWEDHNB    WFDHNB           BOL Head Receiv
     C                     Z-ADDWEDINB    WFDINB           BOL Live Wgt Re
     C                     MOVELWECNST    WFCNST           BOL Trucker Pay
     C                     Z-ADDWEGINB    WFGINB           BOL Trucker Che
     C                     Z-ADDWEBZDT    WFBZDT           BOL Trucker Che
     C                     Z-ADDWELSNB    WFLSNB           BOL AP Voucher
     C                     MOVELWEF3TX    WFF3TX           BOL Trailer
     C                     MOVELWEO8ST    WFO8ST           BOL Freight Exp
     C                     MOVELWEO9ST    WFO9ST           BOL Scheduled K
     C                     MOVELWEPAST    WFPAST           BOL Truck Scale
     C                     Z-ADDWELDSH    WFLDSH           BOL Shipped Hea
     C                     MOVELWEPBST    WFPBST           Reported to USD
     C                     MOVELWEPCST    WFPCST           BOL MPR Prior D
     C                     MOVELWEPDST    WFPDST           BOL Violated Au
     C                     MOVELWEUWST    WFUWST           BOL Status 5
     C                     MOVELWEUXST    WFUXST           BOL Status 6
     C                     MOVELWEUYST    WFUYST           BOL Status 7
     C                     Z-ADDWEJKRU    WFJKRU           BOL HPS Movemen
     C                     Z-ADDWEKEOR    WFKEOR           BOL Head LFT
     C                     Z-ADDWEIOEW    WFIOEW           BOL Head EUT/KO
     C                     Z-ADDWEKJIO    WFKJIO           BOL Auth Gate E
     C                     Z-ADDWEIOJR    WFIOJR           BOL Head Receiv
     C                     Z-ADDWEEIRR    WFEIRR           BOL Unused Wgt
     C                     Z-ADDWEITMF    WFITMF           BOL Unused Wgt
     C                     Z-ADDWEODJE    WFODJE           BOL Unused Wgt
     C                     Z-ADDWERJIF    WFRJIF           BOL Unused Wgt
     C                     Z-ADDWEOEJF    WFOEJF           BOL Unused Wgt
     C                     Z-ADDWED0DT    WFD0DT           BOL Auth Gate E
     C                     Z-ADDWED1DT    WFD1DT           BOL Unused Date
     C                     Z-ADDWED2DT    WFD2DT           BOL Unused Date
     C                     Z-ADDWED3DT    WFD3DT           BOL Unused Date
     C                     Z-ADDWED4DT    WFD4DT           BOL Unused Date
     C                     MOVELWEBNCD    WFBNCD           TRK Trucker Cod
     C                     MOVELWEABCD    WFABCD           PD Producer Cod
     C                     MOVELWEAECD    WFAECD           PL Location Cod
     C                     MOVEL*BLANK    WFAAVN           RS User Changed
     C                     Z-ADD0         WFAADT           RS Date Changed
     C                     Z-ADD0         WFAMTM           RS Time Changed
     C                     MOVELWEAJST    WFAJST           RS Record Statu
     C                     MOVELWEAHVN    WFAHVN           RS Job
     C                     MOVELWEAGVN    WFAGVN           RS Program
     C                     MOVELWEABVN    WFABVN           RS User Added
     C                     Z-ADDWEABDT    WFABDT           RS Date Added
     C                     Z-ADDWEABTM    WFABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WFAJST           RS Record Statu
     C                     MOVEL##USR     WFABVN           RS User Added
     C                     Z-ADD##JDT     WFABDT           RS Date Added
     C                     Z-ADD##JTM     WFABTM           RS Time Added
     C                     MOVEL##PGM     WFAGVN           RS Program
     C                     MOVEL##JOB     WFAHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
      * Check for duplicate primary key
     C           KLCRSG    SETLL@AXCPBY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0052' W0RTN   7
      * Send message 'Buy Order Load         EX'
     C                     MOVEL'PRK0052' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@AXCPBY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Utl Copy Tattoo Hdr   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.TH Payment Type is Carcass Merit
     C           A1J9ST    IFEQ 'C'                        *IF
     C                     MOVEL'SC'      WUCWST           TH Payment Sts
     C                     ELSE
      * CASE: DB1.TH Payment Type is Live
     C           A1J9ST    IFEQ 'L'                        *IF
     C                     MOVEL'SL'      WUCWST           TH Payment Sts
     C                     END                             *FI
     C                     END                             *FI
      * Create Tattoo Header - Tattoo Header  * 
     C                     EXSR SICRRC
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Create Tattoo Header - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @A1CPC5
     C                     Z-ADDP7UVA1    WGHMNB           BOH Company Num
     C                     Z-ADDWN0002    WGBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WGBONB           BOL Load Number
     C                     Z-ADDA1CVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWN0001    WGB0DT           TH Kill Date
     C                     Z-ADDWN0001    WGAWDT           TH Purchase Dat
     C                     MOVELA1BICD    WGBICD           TH Group Refere
     C                     MOVELA1CPST    WGCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    WGACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    WGB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    WGCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    WGC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    WGAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    WGA6DT           TH Pricing Date
     C                     MOVELA1C2ST    WGC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    WGCXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    WGCWNB           TH Head Receive
     C                     Z-ADDA1FCNB    WGFCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    WGH9NB           TH Held Over
     C                     Z-ADDA1FDNB    WGFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    WGFENB           TH Head Killed
     C                     Z-ADDA1HENB    WGHENB           TH Head Adds
     C                     Z-ADDA1HFNB    WGHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    WGCYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    WGLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    WGE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    WGA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    WGFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    WGA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    WGF7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    WGHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    WGF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    WGF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    WGF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    WGF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    WGAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    WGAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    WGCWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    WGA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    WGA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    WGB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    WGAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    WGANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    WGAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    WGAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    WGAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    WGAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    WGAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    WGASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    WGA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    WGATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    WGA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    WGCBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    WGCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    WGLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    WGCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    WGA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    WGA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    WGJWST           TH Calc Net Sts
     C                     MOVELWUCWST    WGCWST           TH Payment Sts
     C                     MOVELA1D7ST    WGD7ST           TH Header Error
     C                     MOVELA1D8ST    WGD8ST           TH Detail Error
     C                     MOVELA1DWST    WGDWST           TH Kill Balanci
     C                     MOVELA1D6ST    WGD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    WGGHNB           TH Commission A
     C                     Z-ADDA1BYDT    WGBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    WGE0ST           TH User Error O
     C                     MOVELA1E1ST    WGE1ST           TH Held Over Re
     C                     MOVELA1E2ST    WGE2ST           TH Sex
     C                     Z-ADDA1BSDT    WGBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    WGBTDT           TH Commission P
     C                     Z-ADDA1BUDT    WGBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    WGHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    WGHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    WGHINB           TH FFLI
     C                     Z-ADDA1A3PR    WGA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    WGA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    WGA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    WGJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    WGD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    WGD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    WGD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    WGD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    WGEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    WGEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    WGECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    WGEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    WGEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    WGEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    WGEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    WGEHPR           TH CM Gross Car
     C                     MOVELA1KAST    WGKAST           TH Source Type
     C                     MOVELA1J7ST    WGJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    WGJ9ST           TH Payment Type
     C                     Z-ADDA1OXNB    WGOXNB           TH HPS Movement
     C                     MOVELA1LKST    WGLKST           TH Source Code
     C                     MOVELA1LLST    WGLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    WGJ8ST           TH Posted to HP
     C                     MOVELA1LIST    WGLIST           TH Schedule Kil
     C                     MOVELA1LJST    WGLJST           TH Shift Held O
     C                     MOVELA1NZTX    WGNZTX           TH State
     C                     MOVELA1HJCD    WGHJCD           TH Unused Code
     C                     MOVELA1R4ST    WGR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    WGR5ST           TH Commission S
     C                     MOVELA1R6ST    WGR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    WGR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    WGTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    WGT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    WGTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    WGT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    WGOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    WGKOER           TH Head Identif
     C                     Z-ADDA1OPIR    WGOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    WGOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    WGIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    WGOWEO           TH PHA Head Add
     C                     MOVELA1OQET    WGOQET           TH PHA Add Type
     C                     MOVELA1URST    WGURST           TH PHA Average
     C                     MOVELA1USST    WGUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    WGHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    WGS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    WGTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    WGTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    WGJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    WGKRIF           TH Broken Back
     C                     Z-ADDA1KORF    WGKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    WGKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    WGKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    WGOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    WGIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    WGIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    WGIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    WGKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    WGOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    WGKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    WGORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    WGOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    WGMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    WGMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    WGNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    WGNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    WGIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    WGKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    WGEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    WGEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    WGECDT           TH Head LFT
     C                     Z-ADDA1EDDT    WGEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    WGEEDT           TH Unused Date
     C                     MOVELA1U4ST    WGU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    WGU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    WGU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    WGU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    WGU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    WGU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    WGVAST           TH Unused Sts 7
     C                     MOVELA1VBST    WGVBST           TH Unused Sts 8
     C                     MOVELA1BDCD    WGBDCD           DF Defect Code
     C                     MOVELA1CSCD    WGCSCD           THP Process Cod
     C                     MOVELA1ABCD    WGABCD           PD Producer Cod
     C                     MOVELA1AECD    WGAECD           PL Location Cod
     C                     MOVELA1ACCD    WGACCD           HB Buyer Code
     C                     MOVELA1AGCD    WGAGCD           GN Genetic Code
     C                     MOVELA1BECD    WGBECD           HC Class Code
     C                     MOVEL*BLANK    WGAAVN           RS User Changed
     C                     Z-ADD0         WGAADT           RS Date Changed
     C                     Z-ADD0         WGAMTM           RS Time Changed
     C                     MOVELA1AJST    WGAJST           RS Record Statu
     C                     MOVELA1AHVN    WGAHVN           RS Job
     C                     MOVELA1AGVN    WGAGVN           RS Program
     C                     MOVELA1ABVN    WGABVN           RS User Added
     C                     Z-ADDA1ABDT    WGABDT           RS Date Added
     C                     Z-ADDA1ABTM    WGABTM           RS Time Added
      *
      * USER: Processing before Data update
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WGAJST           RS Record Statu
     C                     MOVEL##USR     WGABVN           RS User Added
     C                     Z-ADD##JDT     WGABDT           RS Date Added
     C                     Z-ADD##JTM     WGABTM           RS Time Added
     C                     MOVEL##PGM     WGAGVN           RS Program
     C                     MOVEL##JOB     WGAHVN           RS Job
     C                     MOVEL'N'       WGE0ST           TH User Error O
      * Chg/Crt Tatto/Spc Flds IF
      * HPE056 Payment Type
      * 1/10/96  HPE056   Allow payment type to be update based on
      *                   what the payment status is at the time this
      *                   tattoo is being updated
      * Function Description:  If there are any fields that need to be
      * Changed/Created during the Change functions or Create function
      * Presently: Payment Type
      * Add this routine to all of the change objects and create object
      * that update the Payment Type
      * CASE: PAR.TH Payment Sts is Live anything
     C           WGCWST    IFEQ 'ML'                       *IF
     C           WGCWST    OREQ 'PL'
     C           WGCWST    OREQ 'NL'
     C           WGCWST    OREQ 'SL'
     C           WGCWST    OREQ 'IL'
     C                     MOVEL'L'       WGJ9ST           TH Payment Type
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'C'       WGJ9ST           TH Payment Type
     C                     END                             *FI
     C           KLCRSI    KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@A1CPC5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0062' W0RTN   7
      * Send message 'Tattoo Header          EX'
     C                     MOVEL'PRK0062' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@A1CPC5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Utl Copy Tattoo ST    RT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSJ04           TH Tattoo Numbe
     C           *LIKE     DEFN WHB0DT    WQSJ05           TH Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
     C                     KFLD           WQSJ05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSJ01           BOH Company Num
     C                     Z-ADDWABNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSJ03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSJ04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSJ05           TH Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@B3CPHL                    *
     C           KRSSJ     READE@B3CPHL                  90*
      * Data record not found
     C   90                MOVEL'PRK0144' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Tattoo Scale Tkt  CR - Tattoo Scale Ticket  * 
     C                     EXSR SKCRRC
     C           KRSSJ     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Tattoo Scale Tkt  CR - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B3CPHK
     C                     Z-ADDP7UVA1    WIHMNB           BOH Company Num
     C                     Z-ADDWN0002    WIBNNB           BOH Buy Order N
     C                     Z-ADDWHBONB    WIBONB           BOL Load Number
     C                     Z-ADDWHCVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWN0001    WIB0DT           TH Kill Date
     C                     Z-ADDWHFKNB    WIFKNB           TST Sequence Nu
     C                     Z-ADDWHFMNB    WIFMNB           TST Head
     C                     Z-ADDWHFLNB    WIFLNB           TST Wgt
     C                     Z-ADDWN0001    WIB6DT           TST Wgt Date
     C                     Z-ADDWHANTM    WIANTM           TST Wgt Time
     C                     Z-ADDWHJDA1    WIJDA1           TST Wgt Hour
     C                     Z-ADDWHCFDT    WICFDT           TST Last Zero D
     C                     Z-ADDWHAPTM    WIAPTM           TST Last Zero T
     C                     MOVELWHI3ST    WII3ST           TST Record Crea
     C                     Z-ADDWHHVNB    WIHVNB           Pen Company Num
     C                     MOVELWHCMCD    WICMCD           Pen Number
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD0         WIAADT           RS Date Changed
     C                     Z-ADD0         WIAMTM           RS Time Changed
     C                     MOVELWHAJST    WIAJST           RS Record Statu
     C                     MOVELWHAHVN    WIAHVN           RS Job
     C                     MOVELWHAGVN    WIAGVN           RS Program
     C                     MOVELWHABVN    WIABVN           RS User Added
     C                     Z-ADDWHABDT    WIABDT           RS Date Added
     C                     Z-ADDWHABTM    WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIFKNB           TST Sequence Nu
      * Check for duplicate primary key
     C           KLCRSK    SETLL@B3CPHK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0145' W0RTN   7
      * Send message 'Tattoo Scale Ticket    EX'
     C                     MOVEL'PRK0145' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@B3CPHK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Utl Copy Eval Trans   RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN WJBNNB    WQSL02           BOH Buy Order N
     C           *LIKE     DEFN WJBONB    WQSL03           BOL Load Number
     C           *LIKE     DEFN WJCVNB    WQSL04           TH Tattoo Numbe
     C           *LIKE     DEFN WJB0DT    WQSL05           TH Kill Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           BOH Buy Order N
     C                     KFLD           WQSL03           BOL Load Number
     C                     KFLD           WQSL04           TH Tattoo Numbe
     C                     KFLD           WQSL05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSL01           BOH Company Num
     C                     Z-ADDWABNNB    WQSL02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSL03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSL04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSL05           TH Kill Date
      * Establish starting position
     C           KRSSL     SETLL@BVCPQ9                    *
     C           KRSSL     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create Evaluation Transac - Eval Trans  * 
     C                     EXSR SMCRRC
     C           KRSSL     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Create Evaluation Transac - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BVCPF0
     C                     Z-ADDP7UVA1    WKHSNB           ET Company Numb
     C                     Z-ADDWN0001    WKA9DT           ET Kill Date
     C                     Z-ADDWJFJNB    WKFJNB           ET Scale Sequen
     C                     Z-ADDWJHCNB    WKHCNB           ET Carcass Numb
     C                     Z-ADDWJGDNB    WKGDNB           ET Carcass Numb
     C                     Z-ADDWJFINB    WKFINB           ET Tattoo Numbe
     C                     Z-ADDWJLKNB    WKLKNB           ET Lot
     C                     MOVELWJEAST    WKEAST           ET Shift
     C                     Z-ADDWJAMPC    WKAMPC           ET Hot Wgt
     C                     Z-ADDWJAIPC    WKAIPC           ET Backfat Thic
     C                     Z-ADDWJAJPC    WKAJPC           ET Loin-Eye Dep
     C                     Z-ADDWJAKPC    WKAKPC           ET Lean Percent
     C                     Z-ADDWJX8NB    WKX8NB           ET Backfat Thic
     C                     Z-ADDWJFVPC    WKFVPC           ET Loineye Dept
     C                     Z-ADDWJFWPC    WKFWPC           ET Light Reflec
     C                     Z-ADDWJFXPC    WKFXPC           ET Lean Percent
     C                     Z-ADDWJALPC    WKALPC           ET Light Reflec
     C                     MOVELWJDIST    WKDIST           ET Trim Area
     C                     MOVELWJFYST    WKFYST           ET Carcass Sex
     C                     MOVELWJD2ST    WKD2ST           ET Error Sts
     C                     MOVELWJEHST    WKEHST           ET Record Add/D
     C                     MOVELWJG1ST    WKG1ST           ET Record Creat
     C                     MOVELWJH4ST    WKH4ST           ET Record Creat
     C                     MOVELWJJLST    WKJLST           ET User Error O
     C                     MOVELWJUUST    WKUUST           ET Adjust/Add T
     C                     MOVELWJVHST    WKVHST           ET Broken Back
     C                     MOVELWJVIST    WKVIST           ET Unused Sts 2
     C                     MOVELWJVJST    WKVJST           ET Adjust/Add S
     C                     MOVELWJVKST    WKVKST           ET Unused Sts 4
     C                     MOVELWJVLST    WKVLST           ET Unused Sts 5
     C                     Z-ADDP7UVA1    WKHMNB           BOH Company Num
     C                     Z-ADDWN0002    WKBNNB           BOH Buy Order N
     C                     Z-ADDWJBONB    WKBONB           BOL Load Number
     C                     Z-ADDWJCVNB    WKCVNB           TH Tattoo Numbe
     C                     Z-ADDWN0001    WKB0DT           TH Kill Date
     C                     MOVEL*BLANK    WKAAVN           RS User Changed
     C                     Z-ADD0         WKAADT           RS Date Changed
     C                     Z-ADD0         WKAMTM           RS Time Changed
     C                     MOVELWJAJST    WKAJST           RS Record Statu
     C                     MOVELWJAHVN    WKAHVN           RS Job
     C                     MOVELWJAGVN    WKAGVN           RS Program
     C                     MOVELWJABVN    WKABVN           RS User Added
     C                     Z-ADDWJABDT    WKABDT           RS Date Added
     C                     Z-ADDWJABTM    WKABTM           RS Time Added
     C                     Z-ADDWJB8DT    WKB8DT           RU Date
     C                     Z-ADDWJAOTM    WKAOTM           RU Time
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WKAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WKAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WKAJST           RS Record Statu
     C                     MOVEL##USR     WKABVN           RS User Added
     C                     Z-ADD##JDT     WKABDT           RS Date Added
     C                     Z-ADD##JTM     WKABTM           RS Time Added
     C                     MOVEL##PGM     WKAGVN           RS Program
     C                     MOVEL##JOB     WKAHVN           RS Job
     C           KLCRSM    KLIST
     C                     KFLD           WKHSNB           ET Company Numb
     C                     KFLD           WKA9DT           ET Kill Date
     C                     KFLD           WKFJNB           ET Scale Sequen
     C                     KFLD           WKHCNB           ET Carcass Numb
     C                     KFLD           WKGDNB           ET Carcass Numb
      * Check for duplicate primary key
     C           KLCRSM    SETLL@BVCPF0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0122' W0RTN   7
      * Send message 'Eval Trans             EX'
     C                     MOVEL'PRK0122' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@BVCPF0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Utl Copy Carc Dtl     RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WLBNNB    WQSN02           BOH Buy Order N
     C           *LIKE     DEFN WLBONB    WQSN03           BOL Load Number
     C           *LIKE     DEFN WLCVNB    WQSN04           TH Tattoo Numbe
     C           *LIKE     DEFN WLB0DT    WQSN05           TH Kill Date
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
     C                     KFLD           WQSN03           BOL Load Number
     C                     KFLD           WQSN04           TH Tattoo Numbe
     C                     KFLD           WQSN05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSN01           BOH Company Num
     C                     Z-ADDWABNNB    WQSN02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSN03           BOL Load Number
     C                     Z-ADD#1CVNB    WQSN04           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    WQSN05           TH Kill Date
      * Establish starting position
     C           KRSSN     SETLL@B1CPG7                    *
     C           KRSSN     READE@B1CPG7                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SOCRRC
     C           KRSSN     READE@B1CPG7                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDP7UVA1    WMHMNB           BOH Company Num
     C                     Z-ADDWN0002    WMBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WMBONB           BOL Load Number
     C                     Z-ADDWLCVNB    WMCVNB           TH Tattoo Numbe
     C                     Z-ADDWN0001    WMB0DT           TH Kill Date
     C                     Z-ADDWLLGNB    WMLGNB           CD Scale Sequen
     C                     Z-ADDWLEUNB    WMEUNB           CD Carcass Numb
     C                     Z-ADDWLLHNB    WMLHNB           CD Carcass Numb
     C                     MOVELWLINST    WMINST           CD Record Add/D
     C                     Z-ADDWLBEPR    WMBEPR           CD Sort Loss
     C                     Z-ADDWLASPC    WMASPC           CD STD Yield
     C                     Z-ADDWLEWNB    WMEWNB           CD Carcass/Hot
     C                     Z-ADDWLB4PR    WMB4PR           CD Base Carcass
     C                     Z-ADDWLEYNB    WMEYNB           CD Crc Value Pe
     C                     Z-ADDWLB1PR    WMB1PR           CD Base Carc Va
     C                     Z-ADDWLAVPR    WMAVPR           CD Crc Value $
     C                     Z-ADDWLAUPC    WMAUPC           CD Lean Percent
     C                     Z-ADDWLAWPR    WMAWPR           CD Lean Premium
     C                     Z-ADDWLAXPR    WMAXPR           CD Lean Premium
     C                     Z-ADDWLEZNB    WMEZNB           CD Gross Value
     C                     Z-ADDWLAYPR    WMAYPR           CD Gross Value
     C                     Z-ADDWN0001    WMBBDT           CD Kill Date
     C                     Z-ADDWLAKTM    WMAKTM           CD Kill Time
     C                     MOVELWLIQST    WMIQST           CD Shift
     C                     MOVELWLEFST    WMEFST           CD Carcass Acti
     C                     Z-ADDWLH6NB    WMH6NB           CD Backfat Thic
     C                     Z-ADDWLBEPC    WMBEPC           CD Loin-Eye Dep
     C                     Z-ADDWLGCST    WMGCST           CD Light Reflec
     C                     MOVELWLGDST    WMGDST           CD Trim Area
     C                     MOVELWLGEST    WMGEST           CD Carcass Sex
     C                     Z-ADDWLBHPC    WMBHPC           CD FFLI
     C                     MOVELWLIOST    WMIOST           CD Record Creat
     C                     MOVELWLIPST    WMIPST           CD Record Creat
     C                     Z-ADDWLLTNB    WMLTNB           CD LOT
     C                     MOVELWLJNST    WMJNST           CD User Error O
     C                     Z-ADDWLX4NB    WMX4NB           CD Backfat Thic
     C                     Z-ADDWLFNPC    WMFNPC           CD Loin-Eye Dep
     C                     Z-ADDWLFOPC    WMFOPC           CD Light Reflec
     C                     Z-ADDWLFPPC    WMFPPC           CD Lean Percent
     C                     MOVELWLK2ST    WMK2ST           CD Source Type
     C                     MOVELWLK3ST    WMK3ST           CD Payment Type
     C                     Z-ADDWLJWPR    WMJWPR           CD CA Sort Loss
     C                     Z-ADDWLF5PC    WMF5PC           CD CA Std Yield
     C                     Z-ADDWLJXPR    WMJXPR           CD CA Base Carc
     C                     Z-ADDWLJYPR    WMJYPR           CD CA Crc Value
     C                     Z-ADDWLJZPR    WMJZPR           CD CA Base Carc
     C                     Z-ADDWLJ0PR    WMJ0PR           CD CA Crc Value
     C                     Z-ADDWLJ1PR    WMJ1PR           CD CA Lean Prem
     C                     Z-ADDWLJ2PR    WMJ2PR           CD CA Lean Prem
     C                     Z-ADDWLJ3PR    WMJ3PR           CD CA Gross Val
     C                     Z-ADDWLJ4PR    WMJ4PR           CD CA Gross Val
     C                     MOVELWLUTST    WMUTST           CD Adjust/Add T
     C                     MOVELWLHVCD    WMHVCD           CD Producer Loc
     C                     Z-ADDWLDKJR    WMDKJR           CD Loin Eye Inc
     C                     Z-ADDWLITJF    WMITJF           CD Backfat Inch
     C                     Z-ADDWLIJGR    WMIJGR           CD Meat Value F
     C                     Z-ADDWLORJE    WMORJE           CD Lean Prem/Di
     C                     Z-ADDWLOTJR    WMOTJR           CD Fixed Cost F
     C                     Z-ADDWLPEIR    WMPEIR           CD MPR Sort Los
     C                     Z-ADDWLIEUF    WMIEUF           CD Meat Value F
     C                     Z-ADDWLORUE    WMORUE           CD Fixed Cost F
     C                     Z-ADDWLIUTR    WMIUTR           CD Gross Before
     C                     Z-ADDWLIJRR    WMIJRR           CD Gross Before
     C                     MOVELWLVCST    WMVCST           CD Broken Back
     C                     MOVELWLVDST    WMVDST           CD Adjust/Add S
     C                     MOVELWLVEST    WMVEST           CD Unused Sts 3
     C                     MOVELWLVFST    WMVFST           CD Unused Sts 4
     C                     MOVELWLVGST    WMVGST           CD Unused Sts 5
     C                     MOVELWLABCD    WMABCD           PD Producer Cod
     C                     MOVELWLAACD    WMAACD           SR Source Code
     C                     MOVEL*BLANK    WMAAVN           RS User Changed
     C                     Z-ADD0         WMAADT           RS Date Changed
     C                     Z-ADD0         WMAMTM           RS Time Changed
     C                     MOVELWLAJST    WMAJST           RS Record Statu
     C                     MOVELWLAHVN    WMAHVN           RS Job
     C                     MOVELWLAGVN    WMAGVN           RS Program
     C                     MOVELWLABVN    WMABVN           RS User Added
     C                     Z-ADDWLABDT    WMABDT           RS Date Added
     C                     Z-ADDWLABTM    WMABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WMAJST           RS Record Statu
     C                     MOVEL##USR     WMABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WMABDT    PARM *ZERO     WQ0006  70       *DATE
     C           WMABTM    PARM *ZERO     WQ0007  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WMAGVN           RS Program
     C                     MOVEL##JOB     WMAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
     C                     KFLD           WMBONB           BOL Load Number
     C                     KFLD           WMCVNB           TH Tattoo Numbe
     C                     KFLD           WMB0DT           TH Kill Date
     C                     KFLD           WMLGNB           CD Scale Sequen
     C                     KFLD           WMEUNB           CD Carcass Numb
     C                     KFLD           WMLHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSO    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Utl Copy Exp Rate     rt - Company Kill Expense Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOP9NB    WQSP01           CE Company
     C           *LIKE     DEFN WOCSDT    WQSP02           CKE Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           CE Company
     C                     KFLD           WQSP02           CKE Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    WQSP01           CE Company
     C                     Z-ADD#1B0DT    WQSP02           CKE Kill Date
      * Establish starting position
     C           KRSSP     SETLL@DDCPSL                    *
     C           KRSSP     READE@DDCPSL                  90*
      * Data record not found
     C   90                MOVEL'PRK0543' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Create Company Kill Expen - Company Kill Expense Rate  * 
     C                     EXSR SQCRRC
     C           KRSSP     READE@DDCPSL                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Company Kill Expen - Company Kill Expense Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DDCPSI
     C                     Z-ADDP7UVA1    WRP9NB           CE Company
     C                     MOVELWOELCD    WRELCD           CE Expense Code
     C                     Z-ADDWN0001    WRCSDT           CKE Kill Date
     C                     MOVELWOL7ST    WRL7ST           CKE Unit of Mea
     C                     Z-ADDWOF5PR    WRF5PR           CKE Unit Amount
     C                     MOVELWOAAVN    WRAAVN           RS User Changed
     C                     Z-ADDWOAADT    WRAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WRAMTM           RS Time Changed
     C                     MOVELWOAJST    WRAJST           RS Record Statu
     C                     MOVELWOAHVN    WRAHVN           RS Job
     C                     MOVELWOAGVN    WRAGVN           RS Program
     C                     MOVELWOABVN    WRABVN           RS User Added
     C                     Z-ADDWOABDT    WRABDT           RS Date Added
     C                     Z-ADDWOABTM    WRABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WRAJST           RS Record Statu
     C                     MOVEL##USR     WRABVN           RS User Added
     C                     Z-ADD##JDT     WRABDT           RS Date Added
     C                     Z-ADD##JTM     WRABTM           RS Time Added
     C                     MOVEL##PGM     WRAGVN           RS Program
     C                     MOVEL##JOB     WRAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           WRP9NB           CE Company
     C                     KFLD           WRELCD           CE Expense Code
     C                     KFLD           WRCSDT           CKE Kill Date
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@DDCPSI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0544' W0RTN   7
      * Send message 'Company Kill Expense R EX'
     C                     MOVEL'PRK0544' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@DDCPSI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           A1HMNB           BOH Company Num
     C                     KFLD           A1BNNB           BOH Buy Order N
     C                     KFLD           A1BONB           BOL Load Number
     C                     KFLD           A1CVNB           TH Tattoo Numbe
     C                     KFLD           A1B0DT           TH Kill Date
      * Setup key
     C                     Z-ADD#1HMNB    A1HMNB           BOH Company Num
     C                     Z-ADD#1BNNB    A1BNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    A1BONB           BOL Load Number
     C                     Z-ADD#1CVNB    A1CVNB           TH Tattoo Numbe
     C                     Z-ADD#1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KRSSR     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDA1AWDT    #1AWDT           TH Purchase Dat
     C                     MOVELA1BICD    #1BICD           TH Group Refere
     C                     MOVELA1CPST    #1CPST           TH Live Purchas
     C                     Z-ADDA1ACPR    #1ACPR           TH Live Purchas
     C                     MOVELA1C4ST    #1C4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    #1AIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    #1A6DT           TH Pricing Date
     C                     MOVELA1C2ST    #1C2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    #1CXNB           TH Dead On Arri
     C                     Z-ADDA1CWNB    #1CWNB           TH Head Receive
     C                     Z-ADDA1FCNB    #1FCNB           TH Yard Deads
     C                     Z-ADDA1H9NB    #1H9NB           TH Held Over
     C                     Z-ADDA1FDNB    #1FDNB           TH Head Condemn
     C                     Z-ADDA1FENB    #1FENB           TH Head Killed
     C                     Z-ADDA1HENB    #1HENB           TH Head Adds
     C                     Z-ADDA1HFNB    #1HFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    #1CYNB           TH Live Wgt
     C                     Z-ADDA1E0NB    #1E0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    #1A5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    #1FBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    #1A4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    #1F7NB           TH Avg Live Wgt
     C                     Z-ADDA1HDNB    #1HDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    #1F5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    #1F4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    #1F3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    #1F2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    #1AVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    #1AWPC           TH Actual Yield
     C                     Z-ADDA1A8PC    #1A8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    #1A7PC           TH Recalc Live
     C                     Z-ADDA1AMPR    #1AMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    #1ANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    #1AYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    #1AWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    #1AOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    #1AXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    #1APPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    #1ASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    #1A4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    #1ATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    #1A5VA           TH Additions Am
     C                     Z-ADDA1A7VA    #1A7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    #1A2PR           TH Fixed Cost A
     C                     MOVELA1CWST    #1CWST           TH Payment Sts
     C                     MOVELA1D7ST    #1D7ST           TH Header Error
     C                     MOVELA1D8ST    #1D8ST           TH Detail Error
     C                     MOVELA1DWST    #1DWST           TH Kill Balanci
     C                     MOVELA1D6ST    #1D6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    #1GHNB           TH Commission A
     C                     Z-ADDA1BYDT    #1BYDT           TH Voucher Paym
     C                     MOVELA1E0ST    #1E0ST           TH User Error O
     C                     MOVELA1E1ST    #1E1ST           TH Held Over Re
     C                     MOVELA1E2ST    #1E2ST           TH Sex
     C                     Z-ADDA1BSDT    #1BSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    #1BTDT           TH Commission P
     C                     Z-ADDA1BUDT    #1BUDT           TH Actual Check
     C                     Z-ADDA1HGNB    #1HGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    #1HHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    #1HINB           TH FFLI
     C                     Z-ADDA1A3PR    #1A3PR           TH Kill Product
     C                     Z-ADDA1A4PR    #1A4PR           TH Cut Product
     C                     Z-ADDA1A6PR    #1A6PR           TH Render Produ
     C                     Z-ADDA1T2HD    #1T2HD           TH Shift Held O
     C                     MOVELA1BDCD    #1BDCD           DF Defect Code
     C                     MOVELA1CSCD    #1CSCD           THP Process Cod
     C                     MOVELA1ACCD    #1ACCD           HB Buyer Code
     C                     MOVELA1AGCD    #1AGCD           GN Genetic Code
     C                     MOVELA1BECD    #1BECD           HC Class Code
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Hog Defect
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BDCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        DF Defect Code
     C           YPMTFD    OREQ '#1BDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BDCD' defaulted for 'DF Defect Code'.
     C                     CALL 'PKCWSRR'              90  Sel Hog Defect
     C                     PARM *BLANK    W0RTN   7
     C           #1BDCD    PARM #1BDCD    WQ0008  6        DF Defect Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKCWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BDCD    IFNE *BLANK                     DF Defect Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BDCD    IFEQ *BLANK                     DF Defect Code
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWS    KLIST
     C                     KFLD           WSBDCD           DF Defect Code
      * Setup key
     C                     MOVEL#1BDCD    WSBDCD
     C           KLVAWS    CHAIN@A7REC1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Hog Defect             NF'
     C                     MOVEL'PRK0073' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0073' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Tattoo Header Process
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1CSCD    IFEQ *BLANK                     THP Process Cod
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBWT    KLIST
     C                     KFLD           WTCSCD           THP Process Cod
      * Setup key
     C                     MOVEL#1CSCD    WTCSCD
     C           KLVBWT    CHAIN@CCREH3              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Tattoo Header Process  NF'
     C                     MOVEL'PRK0172' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0172' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0009  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0010  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWV    KLIST
     C                     KFLD           WVABCD           PD Producer Cod
     C                     KFLD           WVAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    WVABCD
     C                     MOVEL#1AECD    WVAECD
     C           KLVCWV    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Hog Buyer
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ACCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HB Buyer Code
     C           YPMTFD    OREQ '#1ACCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ACCD' defaulted for 'HB Buyer Code'.
     C                     CALL 'PKD3SRR'              90  Sel Hog Buyer
     C                     PARM *BLANK    W0RTN   7
     C           #1ACCD    PARM #1ACCD    WQ0011  3        HB Buyer Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKD3SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ACCD    IFNE *BLANK                     HB Buyer Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ACCD    IFEQ *BLANK                     HB Buyer Code
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWW    KLIST
     C                     KFLD           WWACCD           HB Buyer Code
      * Setup key
     C                     MOVEL#1ACCD    WWACCD
     C           KLVDWW    CHAIN@ADREAF              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Hog Buyer              NF'
     C                     MOVEL'PRK0011' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0011' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Genetic
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AGCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        GN Genetic Code
     C           YPMTFD    OREQ '#1AGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AGCD' defaulted for 'GN Genetic Code'.
     C                     CALL 'PKNASRR'              90  Sel Genetic Act
     C                     PARM *BLANK    W0RTN   7
     C           #1AGCD    PARM #1AGCD    WQ0012  5        GN Genetic Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKNASRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AGCD    IFNE *BLANK                     GN Genetic Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AGCD    IFEQ *BLANK                     GN Genetic Code
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWX    KLIST
     C                     KFLD           WXAGCD           GN Genetic Code
      * Setup key
     C                     MOVEL#1AGCD    WXAGCD
     C           KLVEWX    CHAIN@AIREA9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Genetic                NF'
     C                     MOVEL'PRK0021' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0021' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Hog Classification
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        HC Class Code
     C           YPMTFD    OREQ '#1BECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BECD' defaulted for 'HC Class Code'.
     C                     CALL 'PKC0SRR'              90  Sel Hog Classif
     C                     PARM *BLANK    W0RTN   7
     C           #1BECD    PARM #1BECD    WQ0013  3        HC Class Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKC0SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1BECD    IFNE *BLANK                     HC Class Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BECD    IFEQ *BLANK                     HC Class Code
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWY    KLIST
     C                     KFLD           WYBECD           HC Class Code
      * Setup key
     C                     MOVEL#1BECD    WYBECD
     C           KLVFWY    CHAIN@A8REDA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Hog Classification     NF'
     C                     MOVEL'PRK0075' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0075' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P1HONB           CC Company Numb
     C                     MOVEL*BLANK    P1C7CD           Oms Application
     C                     MOVEL*BLANK    P1C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P1G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P1G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P1EUTX           Oms Name
     C                     MOVEL*BLANK    P1EVTX           Oms System Valu
     C                     MOVEL*BLANK    P1HAST           Oms Access Deni
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WAARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WAASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WAAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WAALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WAD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WAD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WAD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WAJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WAKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WAKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WAIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WAHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WAGANB           CW Year
     C                     Z-ADD*ZERO     WAGBNB           CW Week Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBBSNB           Next Buy Order
     C                     Z-ADD*ZERO     WBB1DT           Current Kill Da
     C                     Z-ADD*ZERO     WBB2DT           Next Kill Date
     C                     Z-ADD*ZERO     WBH4NB           Last Drive Card
     C                     Z-ADD*ZERO     WBK3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     WBCDDT           Current Product
     C                     Z-ADD*ZERO     WBCEDT           Next Production
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Next Buy Order Number
     C                     Z-ADD*ZERO     WUBSNB  50
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WEABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WEACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WEBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WECSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WEAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WEAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WEATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WEDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WEDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WEGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WEBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WELSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WELDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WEJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WEKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WEIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WEKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WEIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WEEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WEITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WEODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WERJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WEOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WED0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WED1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WED2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WED3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WED4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field TH Payment Sts
     C                     MOVEL*BLANK    WUCWST  2
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WGACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WGB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WGCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WGAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WGA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WGCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WGCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WGFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WGH9NB           TH Held Over
     C                     Z-ADD*ZERO     WGFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WGFENB           TH Head Killed
     C                     Z-ADD*ZERO     WGHENB           TH Head Adds
     C                     Z-ADD*ZERO     WGHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WGCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WGLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WGE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WGA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WGFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WGA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WGF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WGHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WGF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WGF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WGAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WGAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WGCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WGA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WGA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WGB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WGAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WGAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WGAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WGAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WGAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WGAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WGASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WGA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WGATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WGA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WGCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WGCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WGLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WGCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WGA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WGA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WGGHNB           TH Commission A
     C                     Z-ADD*ZERO     WGBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WGBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WGBTDT           TH Commission P
     C                     Z-ADD*ZERO     WGBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WGHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WGHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WGHINB           TH FFLI
     C                     Z-ADD*ZERO     WGA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WGA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WGA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WGJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WGD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WGD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WGD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WGD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WGEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WGEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WGECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WGEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WGEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WGEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WGEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WGOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WGTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WGT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WGTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WGT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WGOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WGKOER           TH Head Identif
     C                     Z-ADD*ZERO     WGOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WGOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WGIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WGOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WGHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WGS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WGTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WGTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WGJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WGKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WGKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WGKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WGKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WGOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WGIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WGIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WGIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WGKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WGKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WGORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WGOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WGMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WGMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WGNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WGNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WGIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WGKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WGEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WGECDT           TH Head LFT
     C                     Z-ADD*ZERO     WGEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WGEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHFKNB           TST Sequence Nu
     C                     Z-ADD*ZERO     WHFMNB           TST Head
     C                     Z-ADD*ZERO     WHFLNB           TST Wgt
     C                     Z-ADD*ZERO     WHB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     WHANTM           TST Wgt Time
     C                     Z-ADD*ZERO     WHJDA1           TST Wgt Hour
     C                     Z-ADD*ZERO     WHCFDT           TST Last Zero D
     C                     Z-ADD*ZERO     WHAPTM           TST Last Zero T
     C                     Z-ADD*ZERO     WHHVNB           Pen Company Num
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WJA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WJFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WJHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WJGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WJFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WJLKNB           ET Lot
     C                     Z-ADD*ZERO     WJAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WJAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WJAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WJAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WJX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WJFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WJFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WJFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WJALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WJHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WJBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WJBONB           BOL Load Number
     C                     Z-ADD*ZERO     WJCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WJB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
     C                     Z-ADD*ZERO     WJB8DT           RU Date
     C                     Z-ADD*ZERO     WJAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLBONB           BOL Load Number
     C                     Z-ADD*ZERO     WLCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WLB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WLLGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WLEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WLLHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WLBEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WLASPC           CD STD Yield
     C                     Z-ADD*ZERO     WLEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WLB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WLEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WLB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WLAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WLAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WLAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WLAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WLEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WLAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WLBBDT           CD Kill Date
     C                     Z-ADD*ZERO     WLAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WLH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WLBEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WLGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WLBHPC           CD FFLI
     C                     Z-ADD*ZERO     WLLTNB           CD LOT
     C                     Z-ADD*ZERO     WLX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WLFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WLFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WLFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WLJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WLF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WLJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WLJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WLJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WLJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WLJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WLJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WLJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WLJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WLDKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WLITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WLIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WLORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WLOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WLPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WLIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WLORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WLIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WLIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOP9NB           CE Company
     C                     Z-ADD*ZERO     WOCSDT           CKE Kill Date
     C                     Z-ADD*ZERO     WOF5PR           CKE Unit Amount
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WSUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WSUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WSUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WSAADT           RS Date Changed
     C                     Z-ADD*ZERO     WSAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WSABDT           RS Date Added
     C                     Z-ADD*ZERO     WSABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVGLNB           Pl VND Address
     C                     Z-ADD*ZERO     WVASNB           PL Miles/Unused
     C                     Z-ADD*ZERO     WVHWNB           PL Primary Comp
     C                     Z-ADD*ZERO     WVAADT           RS Date Changed
     C                     Z-ADD*ZERO     WVAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WVABDT           RS Date Added
     C                     Z-ADD*ZERO     WVABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAADT           RS Date Changed
     C                     Z-ADD*ZERO     WXAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WXABDT           RS Date Added
     C                     Z-ADD*ZERO     WXABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WYAADT           RS Date Changed
     C                     Z-ADD*ZERO     WYAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WYABDT           RS Date Added
     C                     Z-ADD*ZERO     WYABTM           RS Time Added
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field *DATE
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field *TIME
     C                     Z-ADD*ZERO     YL0002  60
      * Define local work field MPR Reporting Date
     C                     Z-ADD*ZERO     YL0003  70
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01814020700232602582028380360603862
** W0END
01816020740233002586028430361103867
** W0NAM
#1HMNB    #1BNNB    #1BONB    #1CVNB    V1B0DT    VDC6DT    VDCWDT
