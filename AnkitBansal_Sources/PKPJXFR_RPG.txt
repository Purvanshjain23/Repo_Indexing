     H/TITLE Val Loss Trans        XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     W* Warning: This program does not set on the LR indicator
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:43:28
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKB6CPL5IF  E           K        DISK
      * RSQ : Eval/Loss Error           Loss Errors Only
      *
     FPKBPREL2IF  E           K        DISK
      * RTV : Loss Type                 Rtv Active Loss Type
      *
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKBRREL2IF  E           K        DISK
      * RTV : Loss Reason               Rtv Active Loss Reason
      *
     FPKB6CPL0UF  E           K        DISK                      A
      * UPD : Eval/Loss Error           Update index
      *
      * Long constants
     E                    @CN#    1  09  6   @CN    25
     I@B6CPNN
      * Eval/Loss Error           Loss Errors Only
      * Renamed input format fields
     I              B6HRNB                          WAHRNB
     I              B6BPDT                          WABPDT
     I              B6IRNB                          WAIRNB
     I              B6BONM                          WABONM
     I              B6LDNM                          WALDNM
     I              B6FPNB                          WAFPNB
     I              B6DYST                          WADYST
     I              B6DXST                          WADXST
     I              B6B7TX                          WAB7TX
     I              B6AAVN                          WAAAVN
     I              B6AADT                          WAAADT
     I              B6AMTM                          WAAMTM
     I              B6AJST                          WAAJST
     I              B6AHVN                          WAAHVN
     I              B6AGVN                          WAAGVN
     I              B6ABVN                          WAABVN
     I              B6ABDT                          WAABDT
     I              B6ABTM                          WAABTM
      *
     I@B6CPGW
      * Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
     I@BPREMS
      * Loss Type                 Rtv Active Loss Type
      * Renamed input format fields
     I              BPBWCD                          WCBWCD
     I              BPCCTX                          WCCCTX
     I              BPC7ST                          WCC7ST
     I              BPC8ST                          WCC8ST
     I              BPLNST                          WCLNST
     I              BPC9ST                          WCC9ST
     I              BPDAST                          WCDAST
     I              BPEZST                          WCEZST
     I              BPAAVN                          WCAAVN
     I              BPAADT                          WCAADT
     I              BPAMTM                          WCAMTM
     I              BPAJST                          WCAJST
     I              BPAHVN                          WCAHVN
     I              BPAGVN                          WCAGVN
     I              BPABVN                          WCABVN
     I              BPABDT                          WCABDT
     I              BPABTM                          WCABTM
      *
     I@BOREFN
      * Evaluation Validation     Retrieval index
      * Renamed input format fields
     I              BOBVCD                          WDBVCD
     I              BOCBTX                          WDCBTX
     I              BOC5ST                          WDC5ST
     I              BOAFPC                          WDAFPC
     I              BOAGPC                          WDAGPC
     I              BOFEST                          WDFEST
     I              BOAAVN                          WDAAVN
     I              BOAADT                          WDAADT
     I              BOAMTM                          WDAMTM
     I              BOAJST                          WDAJST
     I              BOAHVN                          WDAHVN
     I              BOAGVN                          WDAGVN
     I              BOABVN                          WDABVN
     I              BOABDT                          WDABDT
     I              BOABTM                          WDABTM
      *
     I@BRREMQ
      * Loss Reason               Rtv Active Loss Reason
      * Renamed input format fields
     I              BRBYCD                          WEBYCD
     I              BRBYTX                          WEBYTX
     I              BRAAVN                          WEAAVN
     I              BRAADT                          WEAADT
     I              BRAMTM                          WEAMTM
     I              BRAJST                          WEAJST
     I              BRAHVN                          WEAHVN
     I              BRAGVN                          WEAGVN
     I              BRABVN                          WEABVN
     I              BRABDT                          WEABDT
     I              BRABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKB61    E DSPKB6CPL0
      * UPD : Eval/Loss Error           Update index
      * Renamed input format fields
     I              B6HRNB                          WBHRNB
     I              B6BPDT                          WBBPDT
     I              B6IRNB                          WBIRNB
     I              B6BONM                          WBBONM
     I              B6LDNM                          WBLDNM
     I              B6FPNB                          WBFPNB
     I              B6DYST                          WBDYST
     I              B6DXST                          WBDXST
     I              B6B7TX                          WBB7TX
     I              B6AAVN                          WBAAVN
     I              B6AADT                          WBAADT
     I              B6AMTM                          WBAMTM
     I              B6AJST                          WBAJST
     I              B6AHVN                          WBAHVN
     I              B6AGVN                          WBAGVN
     I              B6ABVN                          WBABVN
     I              B6ABDT                          WBABDT
     I              B6ABTM                          WBABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS                            111
      * RCD: Loss Trans                Retrieval index
      * I : MAP LTN Company Number
     I                                    P   1   20P1HUNB
      * I : MAP LTN Kill Date
     I                                    P   3   60P1A7DT
      * I : MAP LTN Record Number
     I                                    P   7  100P1FHNB
      * I : MAP LTN Tattoo Number
     I                                    P  11  130P1FFNB
      * I : MAP LTN Shift
     I                                       14  14 P1EBST
      * I : MAP LTN Wgt
     I                                    P  15  181P1DSNB
      * I : MAP LTN Extent
     I                                       19  20 P1S3NB
      * I : MAP LTN Trim Location
     I                                       21  22 P1S4NB
      * B : MAP LTN Error Sts
     I                                       23  23 P1D1ST
      * I : MAP LTN Record Created Status
     I                                       24  24 P1H5ST
      * I : MAP LTN User Error Override
     I                                       25  25 P1JMST
      * I : MAP LTN Source Type
     I                                       26  26 P1SMST
      * I : MAP LT Type Code
     I                                    P  27  280P1BWCD
      * I : MAP LR Reason Code
     I                                    P  29  300P1BYCD
      * I : MAP BOH Company Number
     I                                    P  31  320P1HMNB
      * I : MAP BOH Buy Order Number
     I                                    P  33  360P1BNNB
      * I : MAP BOL Load Number
     I                                    P  37  390P1BONB
      * I : MAP TH Tattoo Number
     I                                    P  40  420P1CVNB
      * I : MAP TH Kill Date
     I                                    P  43  460P1B0DT
      * I : MAP RS User Changed
     I                                       47  56 P1AAVN
      * I : MAP RS Date Changed
     I                                    P  57  600P1AADT
      * I : MAP RS Time Changed
     I                                    P  61  640P1AMTM
      * I : MAP RS Record Status
     I                                       65  65 P1AJST
      * I : MAP RS Job
     I                                       66  75 P1AHVN
      * I : MAP RS Program
     I                                       76  85 P1AGVN
      * I : MAP RS User Added
     I                                       86  95 P1ABVN
      * I : MAP RS Date Added
     I                                    P  96  990P1ABDT
      * I : MAP RS Time Added
     I                                    P 100 1030P1ABTM
      * I : MAP RU Date
     I                                    P 104 1070P1B8DT
      * I : MAP RU Time
     I                                    P 108 1110P1AOTM
     IP2PARM      DS
      * B : MAP TH Head Condemned
     I                                    P   1   30P2FDNB
     IP3PARM      DS
      * FLD: *Arrays
      * B : MAP Loss Error 1 Usr
     I                                        1   1 P3H9ST
      * B : MAP Loss Error 2 Usr
     I                                        2   2 P3IAST
      * B : MAP Loss Error 3 Usr
     I                                        3   3 P3IBST
      * B : MAP Loss Error 4 Usr
     I                                        4   4 P3ICST
      * B : MAP Loss Error 5 Usr
     I                                        5   5 P3LRST
     IP4PARM      DS
      * B : MAP TH Detail Error Sts
     I                                        1   1 P4D8ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           RCD: Loss Trans
     C           P2FDNB    PARM P2FDNB    WP0001  50       TH Head Condemn
     C           P3H9ST    PARM P3H9ST    WP0002  1        Loss Error 1 Us
     C           P3IAST    PARM P3IAST    WP0003  1        Loss Error 2 Us
     C           P3IBST    PARM P3IBST    WP0004  1        Loss Error 3 Us
     C           P3ICST    PARM P3ICST    WP0005  1        Loss Error 4 Us
     C           P3LRST    PARM P3LRST    WP0006  1        Loss Error 5 Us
     C           P4D8ST    PARM P4D8ST    WP0007  1        TH Detail Error
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Val Loss Trans        XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
     C                     MOVEL'P'       P3H9ST           Loss Error 1 Us
     C                     MOVEL'P'       P3IAST           Loss Error 2 Us
     C                     MOVEL'P'       P3IBST           Loss Error 3 Us
     C                     MOVEL'P'       P3ICST           Loss Error 4 Us
     C                     MOVEL'P'       P3LRST           Loss Error 5 Us
      * Dlt TTo Loss Errors   RT - Eval/Loss Error  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    P1D1ST           LTN Error Sts
      * Rtv Loss Type         RT - Loss Type  * 
     C                     EXSR SCRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'B'       P1D1ST           LTN Error Sts
      * Validate
      * CASE: PAR.LTN User Error Override is Yes
     C           P1JMST    IFEQ 'Y'                        *IF
      * User override all validations do not validate
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate
      * VALIDATE WEIGHT
      * CASE: WRK.LT Wgt Required is Yes
     C           WUC7ST    IFEQ 'Y'                        *IF
      * CASE: PAR.LTN Wgt EQ WRK.Zero USR
     C           P1DSNB    IFEQ WUE9NB                     *IF
     C                     MOVEL'WGT'     WUDXST           KV Error Code
     C                     MOVEL@CN,001   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3H9ST           Loss Error 1 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SDCRRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'P'       P3H9ST           Loss Error 1 Us
     C                     END                             *FI
     C                     END                             *FI
      * VALIDATE EXTENT
      * CASE: WRK.LT Extent Required is Yes
     C           WUC8ST    IFEQ 'Y'                        *IF
      * CASE: PAR.LTN Extent EQ WRK.Blank USR
     C           P1S3NB    IFEQ WUCRTX                     *IF
     C                     MOVEL'EXT'     WUDXST           KV Error Code
     C                     MOVEL@CN,002   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3IAST           Loss Error 2 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SFCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Extents
      * CASE: PAR.LTN Extent is *ALL values
     C           P1S3NB    IFEQ '01'                       *IF
     C           P1S3NB    OREQ '02'
     C           P1S3NB    OREQ '00'
     C           P1S3NB    OREQ '03'
     C           P1S3NB    OREQ '04'
     C                     MOVEL'P'       P3IAST           Loss Error 2 Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EXT'     WUDXST           KV Error Code
     C                     MOVEL@CN,003   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'F'       P3IAST           Loss Error 2 Us
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Extents
      * CASE: PAR.LTN Extent is *ALL values
     C           P1S3NB    IFEQ '01'                       *IF
     C           P1S3NB    OREQ '02'
     C           P1S3NB    OREQ '00'
     C           P1S3NB    OREQ '03'
     C           P1S3NB    OREQ '04'
     C                     MOVEL'P'       P3IAST           Loss Error 2 Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'EXT'     WUDXST           KV Error Code
     C                     MOVEL@CN,003   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'F'       P3IAST           Loss Error 2 Us
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
     C                     END                             *FI
      * VALIDATE REASON
      * CASE: WRK.LT Reason Required is Yes
     C           WUC9ST    IFEQ 'Y'                        *IF
      * CASE: PAR.LR Reason Code EQ WRK.Zero USR
     C           P1BYCD    IFEQ WUE9NB                     *IF
     C                     MOVEL'RSN'     WUDXST           KV Error Code
     C                     MOVEL@CN,004   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3IBST           Loss Error 3 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SLCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Chk Loss Reason       RT - Loss Reason  * 
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,005                    *IF
     C                     MOVEL'RSN'     WUDXST           KV Error Code
     C                     MOVEL@CN,006   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3IBST           Loss Error 3 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SOCRRC
     C                     ELSE
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'P'       P3IBST           Loss Error 3 Us
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * VALIDATE TRIM LOCATION
      * CASE: WRK.Lt Trim Location Required is Yes
     C           WULNST    IFEQ 'Y'                        *IF
      * CASE: PAR.LTN Trim Location EQ WRK.Blank USR
     C           P1S4NB    IFEQ WUCRTX                     *IF
     C                     MOVEL'LOC'     WUDXST           KV Error Code
     C                     MOVEL@CN,007   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3LRST           Loss Error 5 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SQCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.LTN Trim Location is List of Trim
     C           P1S4NB    IFEQ '11'                       *IF
     C           P1S4NB    OREQ '13'
     C           P1S4NB    OREQ '12'
     C           P1S4NB    OREQ '14'
     C           P1S4NB    OREQ '10'
     C           P1S4NB    OREQ '15'
     C           P1S4NB    OREQ '00'
     C                     MOVEL'P'       P3LRST           Loss Error 5 Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'LOC'     WUDXST           KV Error Code
     C                     MOVEL@CN,008   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3LRST           Loss Error 5 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SSCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.LTN Trim Location is *ALL values
     C           P1S4NB    IFEQ '10'                       *IF
     C           P1S4NB    OREQ '11'
     C           P1S4NB    OREQ '12'
     C           P1S4NB    OREQ '13'
     C           P1S4NB    OREQ '14'
     C           P1S4NB    OREQ '00'
     C           P1S4NB    OREQ '15'
     C                     MOVEL'P'       P3LRST           Loss Error 5 Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'LOC'     WUDXST           KV Error Code
     C                     MOVEL@CN,008   WUB7TX           KV Error Descri
     C                     MOVEL'E'       P1D1ST           LTN Error Sts
     C                     MOVEL'Y'       P4D8ST           TH Detail Error
     C                     MOVEL'F'       P3LRST           Loss Error 5 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SUCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * All in balance accumulate totals
      * CASE: PAR.LTN Error Sts is Balance
     C           P1D1ST    IFEQ 'B'                        *IF
      * CASE: WRK.LT Loss Definition is Condemmed Hogs
     C           WUEZST    IFEQ 'C'                        *IF
     C                     ADD  1         P2FDNB           TH Head Condemn
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'LST'     WUDXST           KV Error Code
     C                     MOVEL@CN,009   WUB7TX           KV Error Descri
     C                     MOVEL'E'       WUD1ST           LTN Error Sts
     C                     MOVEL'F'       P3ICST           Loss Error 4 Us
      * Create Kill Validation - Eval/Loss Error  * 
     C                     EXSR SWCRRC
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Dlt TTo Loss Errors   RT - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHRNB    WQSA01           KV Company Numb
     C           *LIKE     DEFN WABPDT    WQSA02           KV Kill Date
     C           *LIKE     DEFN WAIRNB    WQSA03           KV TATTOO NUMBE
     C           *LIKE     DEFN WABONM    WQSA04           KV Buy Order Nu
     C           *LIKE     DEFN WALDNM    WQSA05           KV Load Number
     C           *LIKE     DEFN WAFPNB    WQSA06           KV Record Numbe
     C           *LIKE     DEFN WADYST    WQSA07           KV Record Type
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           KV Company Numb
     C                     KFLD           WQSA02           KV Kill Date
     C                     KFLD           WQSA03           KV TATTOO NUMBE
     C                     KFLD           WQSA04           KV Buy Order Nu
     C                     KFLD           WQSA05           KV Load Number
     C                     KFLD           WQSA06           KV Record Numbe
     C                     KFLD           WQSA07           KV Record Type
      * Setup key
     C                     Z-ADDP1HUNB    WQSA01           KV Company Numb
     C                     Z-ADDP1A7DT    WQSA02           KV Kill Date
     C                     Z-ADDP1FFNB    WQSA03           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WQSA04           KV Buy Order Nu
     C                     Z-ADDP1BONB    WQSA05           KV Load Number
     C                     Z-ADDP1FHNB    WQSA06           KV Record Numbe
     C                     MOVEL'L'       WQSA07           KV Record Type
      * Establish starting position
     C           KRSSA     SETLL@B6CPNN                    *
     C           KRSSA     READE@B6CPNN                  90*
      * Data record not found
     C   90                MOVEL'PRK0150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAIRNB' defaulted for 'KV TATTOO NUMBER'.
      * Field '(DB1) WABONM' defaulted for 'KV Buy Order Number'.
      * Field '(DB1) WALDNM' defaulted for 'KV Load Number'.
      * Delete Kill Validation - Eval Validation Error  * 
     C                     EXSR SBDLRC
     C           KRSSA     READE@B6CPNN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBDLRC    BEGSR
      *================================================================
      * Delete Kill Validation - Eval Validation Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPGW
     C                     Z-ADDWAHRNB    WBHRNB           KV Company Numb
     C                     Z-ADDWABPDT    WBBPDT           KV Kill Date
     C                     Z-ADDWAIRNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDWABONM    WBBONM           KV Buy Order Nu
     C                     Z-ADDWALDNM    WBLDNM           KV Load Number
     C                     Z-ADDWAFPNB    WBFPNB           KV Record Numbe
     C                     MOVELWADYST    WBDYST           KV Record Type
     C                     MOVELWADXST    WBDXST           KV Error Code
      *
     C           KLDLSB    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
     C           KLDLSB    CHAIN@B6CPGW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKB6CPL0'MDACP
     C                     MOVEL'@B6CPGW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPGW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Loss Type         RT - Loss Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBWCD           LT Type Code
      * Setup key
     C                     Z-ADDP1BWCD    WCBWCD           LT Type Code
      * Establish starting position
     C           KRSSC     CHAIN@BPREMS              90    *
      * Data record not found
     C   90                MOVEL'PRK0109' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCCCTX    WUCCTX           LT Description
     C                     MOVELWCC7ST    WUC7ST           LT Wgt Required
     C                     MOVELWCC8ST    WUC8ST           LT Extent Requi
     C                     MOVELWCLNST    WULNST           Lt Trim Locatio
     C                     MOVELWCC9ST    WUC9ST           LT Reason Requi
     C                     MOVELWCDAST    WUDAST           LT Tattoo Requi
     C                     MOVELWCEZST    WUEZST           LT Loss Definit
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSD    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSE     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVE *BLANK    WBAAVN           RS User Changed
     C                     MOVEL'*'       WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSF    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSF    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSG     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVE *BLANK    WBAAVN           RS User Changed
     C                     MOVEL'*'       WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSH    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSI     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVE *BLANK    WBAAVN           RS User Changed
     C                     MOVEL'*'       WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SKRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSK     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSL    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSL    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSM     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Chk Loss Reason       RT - Loss Reason  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WEBYCD           LR Reason Code
      * Setup key
     C                     Z-ADDP1BYCD    WEBYCD           LR Reason Code
      * Establish starting position
     C           KRSSN     CHAIN@BRREMQ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0113' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSO    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSP     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSR     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR STRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSST     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSU    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSV     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Create Kill Validation - Eval/Loss Error  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B6CPGW
     C                     Z-ADDP1HUNB    WBHRNB           KV Company Numb
     C                     Z-ADDP1A7DT    WBBPDT           KV Kill Date
     C                     Z-ADDP1FFNB    WBIRNB           KV TATTOO NUMBE
     C                     Z-ADDP1BNNB    WBBONM           KV Buy Order Nu
     C                     Z-ADDP1BONB    WBLDNM           KV Load Number
     C                     Z-ADDP1FHNB    WBFPNB           KV Record Numbe
     C                     MOVEL'L'       WBDYST           KV Record Type
     C                     MOVELWUDXST    WBDXST           KV Error Code
     C                     MOVELWUB7TX    WBB7TX           KV Error Descri
     C                     MOVEL*BLANK    WBAAVN           RS User Changed
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##JOB     WBAHVN           RS Job
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
      *
      * USER: Processing before Data update
      * CASE: PAR.KV Error Description is Entered
     C           WUB7TX    IFNE *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAHVN' defaulted for 'RS Job'.
      * Field '(DB1) WBAGVN' defaulted for 'RS Program'.
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WBAJST           RS Record Statu
     C                     MOVEL##USR     WBABVN           RS User Added
     C                     Z-ADD##JDT     WBABDT           RS Date Added
     C                     Z-ADD##JTM     WBABTM           RS Time Added
     C                     MOVEL##PGM     WBAGVN           RS Program
     C                     MOVEL##JOB     WBAHVN           RS Job
     C           KLCRSW    KLIST
     C                     KFLD           WBHRNB           KV Company Numb
     C                     KFLD           WBBPDT           KV Kill Date
     C                     KFLD           WBIRNB           KV TATTOO NUMBE
     C                     KFLD           WBBONM           KV Buy Order Nu
     C                     KFLD           WBLDNM           KV Load Number
     C                     KFLD           WBFPNB           KV Record Numbe
     C                     KFLD           WBDYST           KV Record Type
     C                     KFLD           WBDXST           KV Error Code
      * Check for duplicate primary key
     C           KLCRSW    SETLL@B6CPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0151' W0RTN   7
      * Send message 'Eval/Loss Error        EX'
     C                     MOVEL'PRK0151' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@B6CPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Evaluation Desc   Rt - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WDBVCD           EV Validation C
      * Setup key
     C                     MOVELWUDXST    WDBVCD           EV Validation C
      * Establish starting position
     C           KRSSX     CHAIN@BOREFN              90    *
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWDCBTX    WBB7TX           EV Description
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *                       length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Initialise indicators for re-entry
     C                     MOVE '0'       *IN
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHRNB           KV Company Numb
     C                     Z-ADD*ZERO     WABPDT           KV Kill Date
     C                     Z-ADD*ZERO     WAIRNB           KV TATTOO NUMBE
     C                     Z-ADD*ZERO     WABONM           KV Buy Order Nu
     C                     Z-ADD*ZERO     WALDNM           KV Load Number
     C                     Z-ADD*ZERO     WAFPNB           KV Record Numbe
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field LT Description
     C                     MOVEL*BLANK    WUCCTX 25
      * Define work field LT Wgt Required
     C                     MOVEL*BLANK    WUC7ST  1
      * Define work field LT Extent Required
     C                     MOVEL*BLANK    WUC8ST  1
      * Define work field Lt Trim Location Required
     C                     MOVEL*BLANK    WULNST  1
      * Define work field LT Reason Required
     C                     MOVEL*BLANK    WUC9ST  1
      * Define work field LT Tattoo Required
     C                     MOVEL*BLANK    WUDAST  1
      * Define work field LT Loss Definition
     C                     MOVEL*BLANK    WUEZST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBWCD           LT Type Code
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field KV Error Code
     C                     MOVEL*BLANK    WUDXST  3
      * Define work field KV Error Description
     C                     MOVEL*BLANK    WUB7TX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAFPC           EV Minimum
     C                     Z-ADD*ZERO     WDAGPC           EV Maximum
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBYCD           LR Reason Code
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field LTN Error Sts
     C                     MOVEL*BLANK    WUD1ST  1
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Weight is Required
00002 Extent is Required
00003 Extent is Invalid
00004 Reason is Required
00005 Y2U0005
00006 Reason is Invalid
00007 Trim Loc is Required
00008 Trim Location Invalid
00009 Loss Type is Required
