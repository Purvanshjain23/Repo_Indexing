     H/TITLE Bld Hog Pop Hdr Outf2 XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version: 62050
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISRCENT
     H* Date          : 04/26/01  Time  : 16:05:58
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKFBCPL1IF  E           K        DISK
      * RTV : Hog Population Hdr Outf 2 Retrieval index
      *
     FPKFCCPL1IF  E           K        DISK
      * RTV : Hog Population Dtl Outf 2 Retrieval index
      *
     FPKFBCPL0UF  E           K        DISK                      A
      * UPD : Hog Population Hdr Outf 2 Update index
      *
     FPKFCCPL0UF  E           K        DISK                      A
      * UPD : Hog Population Dtl Outf 2 Update index
      *
     I@FBCPGU
      * Hog Population Hdr Outf 2 Retrieval index
      * Renamed input format fields
     I              FBK1ST                          WAK1ST
     I              FBFJA1                          WAFJA1
     I              FBFKA1                          WAFKA1
     I              FBFIA1                          WAFIA1
     I              FBCMDT                          WACMDT
     I              FBCODT                          WACODT
     I              FBFLA1                          WAFLA1
     I              FBFMA1                          WAFMA1
     I              FBFNA1                          WAFNA1
     I              FBFOA1                          WAFOA1
     I              FBFPA1                          WAFPA1
      *
     I@FBCPGT
      * Hog Population Hdr Outf 2 Update index
      * Renamed input format fields
     I              FBK1ST                          WBK1ST
     I              FBFJA1                          WBFJA1
     I              FBFKA1                          WBFKA1
     I              FBFIA1                          WBFIA1
     I              FBCMDT                          WBCMDT
     I              FBCODT                          WBCODT
     I              FBFLA1                          WBFLA1
     I              FBFMA1                          WBFMA1
     I              FBFNA1                          WBFNA1
     I              FBFOA1                          WBFOA1
     I              FBFPA1                          WBFPA1
      *
     I@FCCPGX
      * Hog Population Dtl Outf 2 Retrieval index
      * Renamed input format fields
     I              FCK1ST                          WCK1ST
     I              FCB0DT                          WCB0DT
     I              FCQUNB                          WCQUNB
     I              FCQVNB                          WCQVNB
     I              FCFIA1                          WCFIA1
     I              FCQWNB                          WCQWNB
     I              FCQXNB                          WCQXNB
     I              FCFHA1                          WCFHA1
     I              FCRJNB                          WCRJNB
     I              FCU1PR                          WCU1PR
      *
     I@FCCPGW
      * Hog Population Dtl Outf 2 Update index
      * Renamed input format fields
     I              FCK1ST                          WDK1ST
     I              FCB0DT                          WDB0DT
     I              FCQUNB                          WDQUNB
     I              FCQVNB                          WDQVNB
     I              FCFIA1                          WDFIA1
     I              FCQWNB                          WDQWNB
     I              FCQXNB                          WDQXNB
     I              FCFHA1                          WDFHA1
     I              FCRJNB                          WDRJNB
     I              FCU1PR                          WDU1PR
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKFB1    E DSPKFBCPL0
      * UPD : Hog Population Hdr Outf 2 Update index
      * Renamed input format fields
     I              FBK1ST                          WBK1ST
     I              FBFJA1                          WBFJA1
     I              FBFKA1                          WBFKA1
     I              FBFIA1                          WBFIA1
     I              FBCMDT                          WBCMDT
     I              FBCODT                          WBCODT
     I              FBFLA1                          WBFLA1
     I              FBFMA1                          WBFMA1
     I              FBFNA1                          WBFNA1
     I              FBFOA1                          WBFOA1
     I              FBFPA1                          WBFPA1
      *
     IYARDCS      DS                             38
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKFC1    E DSPKFCCPL0
      * UPD : Hog Population Dtl Outf 2 Update index
      * Renamed input format fields
     I              FCK1ST                          WDK1ST
     I              FCB0DT                          WDB0DT
     I              FCQUNB                          WDQUNB
     I              FCQVNB                          WDQVNB
     I              FCFIA1                          WDFIA1
     I              FCQWNB                          WDQWNB
     I              FCQXNB                          WDQXNB
     I              FCFHA1                          WDFHA1
     I              FCRJNB                          WDRJNB
     I              FCU1PR                          WDU1PR
      *
     IYBRDCS      DS                             35
     IYCRDCS      DS                             38
     IYDRDCS      DS                             35
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Hog Population Hdr Outf 2
      * I :  HRH Min Carcass Weight
     I                                    P   1   30P1FJA1
      * I :  HRH Max Carcass Weight
     I                                    P   4   60P1FKA1
      * I :  HRH From Kill Date
     I                                    P   7  100P1CMDT
      * I :  HRH To Kill Date
     I                                    P  11  140P1CODT
      * I :  HRH Min Live Weight
     I                                    P  15  170P1FLA1
      * I :  HRH Max Live Weight
     I                                    P  18  200P1FMA1
     IP2PARM      DS
      * FLD: Hog Population Dist
      * I :  HPD Kill Date
     I                                    P   1   40P2CLDT
      * I :  HPD Carcass Weight
     I                                    P   5   70P2QQNB
      * I :  HPD Distribution
     I                                    P   8   91P2QRNB
      * I :  HPD No of Carcass
     I                                    P  10  130P2QTNB
     IP3PARM      DS
      * FLD: Hog Population Rpt Hdr
      * I : MAP HRH Type Of Distribution
     I                                        1   1 P3K1ST
      * I : MAP HRH Carcass Hdr 01
     I                                    P   2   31P3RKNB
      * I : MAP HRH Carcass Hdr 02
     I                                    P   4   51P3RLNB
      * I : MAP HRH Carcass Hdr 03
     I                                    P   6   71P3RMNB
      * I : MAP HRH Carcass Hdr 04
     I                                    P   8   91P3RNNB
      * I : MAP HRH Carcass Hdr 05
     I                                    P  10  111P3RONB
      * I : MAP HRH Carcass Hdr 06
     I                                    P  12  131P3RPNB
      * I : MAP HRH Carcass Hdr 07
     I                                    P  14  151P3RQNB
      * I : MAP HRH Carcass Hdr 08
     I                                    P  16  171P3RRNB
      * I : MAP HRH Carcass Hdr 09
     I                                    P  18  191P3RSNB
      * I : MAP HRH Carcass Hdr 10
     I                                    P  20  211P3RTNB
      * I : MAP HRH Carcass Hdr 11
     I                                    P  22  231P3RUNB
      * I : MAP HRH Carcass Hdr 12
     I                                    P  24  251P3RVNB
      * I : MAP HRH Carcass Hdr 13
     I                                    P  26  271P3RWNB
      * I : MAP HRH Carcass Hdr 14
     I                                    P  28  291P3RXNB
      * I : MAP HRH Carcass Hdr 15
     I                                    P  30  311P3RYNB
      * I : MAP HRH Carcass Hdr 16
     I                                    P  32  331P3RZNB
      * I : MAP HRH Carcass Hdr 17
     I                                    P  34  351P3R0NB
      * I : MAP HRH Carcass Hdr 18
     I                                    P  36  371P3R1NB
      * I : MAP HRH Carcass Hdr 19
     I                                    P  38  391P3R2NB
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1FJA1    PARM           WP0001  50       HRH Min Carcass
     C           P1FKA1    PARM           WP0002  50       HRH Max Carcass
     C           P1CMDT    PARM           WP0003  70       HRH From Kill D
     C           P1CODT    PARM           WP0004  70       HRH To Kill Dat
     C           P1FLA1    PARM           WP0005  50       HRH Min Live We
     C           P1FMA1    PARM           WP0006  50       HRH Max Live We
     C           P2CLDT    PARM           WP0007  70       HPD Kill Date
     C           P2QQNB    PARM           WP0008  50       HPD Carcass Wei
     C           P2QRNB    PARM           WP0009  31       HPD Distributio
     C           P2QTNB    PARM           WP0010  70       HPD No of Carca
     C           P3K1ST    PARM           WP0011  1        HRH Type Of Dis
     C           P3RKNB    PARM           WP0012  31       HRH Carcass Hdr
     C           P3RLNB    PARM           WP0013  31       HRH Carcass Hdr
     C           P3RMNB    PARM           WP0014  31       HRH Carcass Hdr
     C           P3RNNB    PARM           WP0015  31       HRH Carcass Hdr
     C           P3RONB    PARM           WP0016  31       HRH Carcass Hdr
     C           P3RPNB    PARM           WP0017  31       HRH Carcass Hdr
     C           P3RQNB    PARM           WP0018  31       HRH Carcass Hdr
     C           P3RRNB    PARM           WP0019  31       HRH Carcass Hdr
     C           P3RSNB    PARM           WP0020  31       HRH Carcass Hdr
     C           P3RTNB    PARM           WP0021  31       HRH Carcass Hdr
     C           P3RUNB    PARM           WP0022  31       HRH Carcass Hdr
     C           P3RVNB    PARM           WP0023  31       HRH Carcass Hdr
     C           P3RWNB    PARM           WP0024  31       HRH Carcass Hdr
     C           P3RXNB    PARM           WP0025  31       HRH Carcass Hdr
     C           P3RYNB    PARM           WP0026  31       HRH Carcass Hdr
     C           P3RZNB    PARM           WP0027  31       HRH Carcass Hdr
     C           P3R0NB    PARM           WP0028  31       HRH Carcass Hdr
     C           P3R1NB    PARM           WP0029  31       HRH Carcass Hdr
     C           P3R2NB    PARM           WP0030  31       HRH Carcass Hdr
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Hog Pop Hdr Outf2 XF
      * Build outfile 1) Summary record per type of dist, min carc wt, ma
      *     2) Detail record per type of dist, killdt,min carc wt, max cr
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.HRH Type Of Distribution is Lean %
      *   |- c2    : PAR.HRH Type Of Distribution is Loin Eye
      *   '-
     C           P3K1ST    IFEQ 'P'                        *IF
     C           P3K1ST    OREQ 'E'                        *OR
      * Add correct record highest to lowest
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 01
     C           P2QRNB    IFGE P3RKNB                     *IF
     C                     Z-ADDP3RKNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 02
     C           P2QRNB    IFGE P3RLNB                     *IF
     C                     Z-ADDP3RLNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 03
     C           P2QRNB    IFGE P3RMNB                     *IF
     C                     Z-ADDP3RMNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 04
     C           P2QRNB    IFGE P3RNNB                     *IF
     C                     Z-ADDP3RNNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 05
     C           P2QRNB    IFGE P3RONB                     *IF
     C                     Z-ADDP3RONB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 06
     C           P2QRNB    IFGE P3RPNB                     *IF
     C                     Z-ADDP3RPNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 07
     C           P2QRNB    IFGE P3RQNB                     *IF
     C                     Z-ADDP3RQNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 08
     C           P2QRNB    IFGE P3RRNB                     *IF
     C                     Z-ADDP3RRNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 09
     C           P2QRNB    IFGE P3RSNB                     *IF
     C                     Z-ADDP3RSNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 10
     C           P2QRNB    IFGE P3RTNB                     *IF
     C                     Z-ADDP3RTNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 11
     C           P2QRNB    IFGE P3RUNB                     *IF
     C                     Z-ADDP3RUNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 12
     C           P2QRNB    IFGE P3RVNB                     *IF
     C                     Z-ADDP3RVNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 13
     C           P2QRNB    IFGE P3RWNB                     *IF
     C                     Z-ADDP3RWNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 14
     C           P2QRNB    IFGE P3RXNB                     *IF
     C                     Z-ADDP3RXNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 15
     C           P2QRNB    IFGE P3RYNB                     *IF
     C                     Z-ADDP3RYNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 16
     C           P2QRNB    IFGE P3RZNB                     *IF
     C                     Z-ADDP3RZNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 17
     C           P2QRNB    IFGE P3R0NB                     *IF
     C                     Z-ADDP3R0NB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 18
     C           P2QRNB    IFGE P3R1NB                     *IF
     C                     Z-ADDP3R1NB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 19
     C           P2QRNB    IFGE P3R2NB                     *IF
     C                     Z-ADDP3R2NB    YL0001           HRH Carcass Hdr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR SARVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: PAR.HRH Type Of Distribution is Back fat
     C           P3K1ST    IFEQ 'B'                        *IF
      * Add correct record lowest to highest
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 19
     C           P2QRNB    IFGE P3R2NB                     *IF
     C                     Z-ADDP3R2NB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 18
     C           P2QRNB    IFGE P3R1NB                     *IF
     C                     Z-ADDP3R1NB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 17
     C           P2QRNB    IFGE P3R0NB                     *IF
     C                     Z-ADDP3R0NB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 16
     C           P2QRNB    IFGE P3RZNB                     *IF
     C                     Z-ADDP3RZNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 15
     C           P2QRNB    IFGE P3RYNB                     *IF
     C                     Z-ADDP3RYNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 14
     C           P2QRNB    IFGE P3RXNB                     *IF
     C                     Z-ADDP3RXNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 13
     C           P2QRNB    IFGE P3RWNB                     *IF
     C                     Z-ADDP3RWNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 12
     C           P2QRNB    IFGE P3RVNB                     *IF
     C                     Z-ADDP3RVNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 11
     C           P2QRNB    IFGE P3RUNB                     *IF
     C                     Z-ADDP3RUNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 10
     C           P2QRNB    IFGE P3RTNB                     *IF
     C                     Z-ADDP3RTNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 09
     C           P2QRNB    IFGE P3RSNB                     *IF
     C                     Z-ADDP3RSNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 08
     C           P2QRNB    IFGE P3RRNB                     *IF
     C                     Z-ADDP3RRNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 07
     C           P2QRNB    IFGE P3RQNB                     *IF
     C                     Z-ADDP3RQNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 06
     C           P2QRNB    IFGE P3RPNB                     *IF
     C                     Z-ADDP3RPNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 05
     C           P2QRNB    IFGE P3RONB                     *IF
     C                     Z-ADDP3RONB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 04
     C           P2QRNB    IFGE P3RNNB                     *IF
     C                     Z-ADDP3RNNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 03
     C           P2QRNB    IFGE P3RMNB                     *IF
     C                     Z-ADDP3RMNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 02
     C           P2QRNB    IFGE P3RLNB                     *IF
     C                     Z-ADDP3RLNB    YL0001           HRH Carcass Hdr
     C                     ELSE
      * CASE: PAR.HPD Distribution GE PAR.HRH Carcass Hdr 01
     C           P2QRNB    IFGE P3RKNB                     *IF
     C                     Z-ADDP3RKNB    YL0001           HRH Carcass Hdr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
     C                     EXSR SGRVGN
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAK1ST           HRH Type Of Dis
     C                     KFLD           WAFJA1           HRH Min Carcass
     C                     KFLD           WAFKA1           HRH Max Carcass
     C                     KFLD           WAFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELP3K1ST    WAK1ST           HRH Type Of Dis
     C                     Z-ADDP1FJA1    WAFJA1           HRH Min Carcass
     C                     Z-ADDP1FKA1    WAFKA1           HRH Max Carcass
     C                     Z-ADDYL0001    WAFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSA     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           P2QTNB    MULT P2QQNB    YL0002           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR SBCRRC
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WAFNA1    ADD  P2QTNB    YL0003           HRH Dist Carcas
     C           P2QTNB    MULT P2QQNB    YL0002           HRH Total Hot W
     C                     ADD  WAFOA1    YL0002           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR SCCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELP3K1ST    WBK1ST           HRH Type Of Dis
     C                     Z-ADDP1FJA1    WBFJA1           HRH Min Carcass
     C                     Z-ADDP1FKA1    WBFKA1           HRH Max Carcass
     C                     Z-ADDYL0001    WBFIA1           HRH Carcass Hdr
     C                     Z-ADDP1CMDT    WBCMDT           HRH From Kill D
     C                     Z-ADDP1CODT    WBCODT           HRH To Kill Dat
     C                     Z-ADDP1FLA1    WBFLA1           HRH Min Live We
     C                     Z-ADDP1FMA1    WBFMA1           HRH Max Live We
     C                     Z-ADDP2QTNB    WBFNA1           HRH Dist Carcas
     C                     Z-ADDYL0002    WBFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WBFPA1           HRH Avg Hot Wgt
      *
     C           KLCRSB    KLIST
     C                     KFLD           WBK1ST           HRH Type Of Dis
     C                     KFLD           WBFJA1           HRH Min Carcass
     C                     KFLD           WBFKA1           HRH Max Carcass
     C                     KFLD           WBFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSB    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWAK1ST    WBK1ST           HRH Type Of Dis
     C                     Z-ADDWAFJA1    WBFJA1           HRH Min Carcass
     C                     Z-ADDWAFKA1    WBFKA1           HRH Max Carcass
     C                     Z-ADDWAFIA1    WBFIA1           HRH Carcass Hdr
      *
     C           KLCHSC    KLIST
     C                     KFLD           WBK1ST           HRH Type Of Dis
     C                     KFLD           WBFJA1           HRH Min Carcass
     C                     KFLD           WBFKA1           HRH Max Carcass
     C                     KFLD           WBFIA1           HRH Carcass Hdr
     C           KLCHSC    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YARDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWACMDT    WBCMDT           HRH From Kill D
     C                     Z-ADDWACODT    WBCODT           HRH To Kill Dat
     C                     Z-ADDWAFLA1    WBFLA1           HRH Min Live We
     C                     Z-ADDWAFMA1    WBFMA1           HRH Max Live We
     C                     Z-ADDYL0003    WBFNA1           HRH Dist Carcas
     C                     Z-ADDYL0002    WBFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCQUNB           HRD Min Carcass
     C                     KFLD           WCQVNB           HRD Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELP3K1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDP2CLDT    WCB0DT           TH Kill Date
     C                     Z-ADDP1FJA1    WCQUNB           HRD Min Carcass
     C                     Z-ADDP1FKA1    WCQVNB           HRD Max Carcass
     C                     Z-ADDYL0001    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSD     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR SECRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFHA1    ADD  P2QTNB    YL0004           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0002  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0003 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELP3K1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDP2CLDT    WDB0DT           TH Kill Date
     C                     Z-ADDP1FJA1    WDQUNB           HRD Min Carcass
     C                     Z-ADDP1FKA1    WDQVNB           HRD Max Carcass
     C                     Z-ADDYL0001    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP1FLA1    WDQWNB           HRD Min Live We
     C                     Z-ADDP1FMA1    WDQXNB           HRD Max Live We
     C                     Z-ADDP2QTNB    WDFHA1           HRD Dist Carcas
      *
     C           KLCRSE    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDQUNB           HRD Min Carcass
     C                     KFLD           WDQVNB           HRD Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSE    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELP3K1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDP2CLDT    WDB0DT           TH Kill Date
     C                     Z-ADDP1FJA1    WDQUNB           HRD Min Carcass
     C                     Z-ADDP1FKA1    WDQVNB           HRD Max Carcass
     C                     Z-ADDYL0001    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHSF    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDQUNB           HRD Min Carcass
     C                     KFLD           WDQVNB           HRD Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHSF    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YBRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDP1FLA1    WDQWNB           HRD Min Live We
     C                     Z-ADDP1FMA1    WDQXNB           HRD Max Live We
     C                     Z-ADDYL0004    WDFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WDRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WDU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Hdr 2 RT - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WAK1ST           HRH Type Of Dis
     C                     KFLD           WAFJA1           HRH Min Carcass
     C                     KFLD           WAFKA1           HRH Max Carcass
     C                     KFLD           WAFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELP3K1ST    WAK1ST           HRH Type Of Dis
     C                     Z-ADDP1FJA1    WAFJA1           HRH Min Carcass
     C                     Z-ADDP1FKA1    WAFKA1           HRH Max Carcass
     C                     Z-ADDYL0001    WAFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSG     CHAIN@FBCPGU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0954' W0RTN   7
      * USER: Processing if Data record not found
     C           P2QTNB    MULT P2QQNB    YL0002           HRH Total Hot W
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
     C                     EXSR SHCRRC
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WAFNA1    ADD  P2QTNB    YL0003           HRH Dist Carcas
     C           P2QTNB    MULT P2QQNB    YL0002           HRH Total Hot W
     C                     ADD  WAFOA1    YL0002           HRH Total Hot W
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
     C                     EXSR SICHRC
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Hdr Outf2 CR - Hog Population Hdr Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FBCPGT
     C                     MOVELP3K1ST    WBK1ST           HRH Type Of Dis
     C                     Z-ADDP1FJA1    WBFJA1           HRH Min Carcass
     C                     Z-ADDP1FKA1    WBFKA1           HRH Max Carcass
     C                     Z-ADDYL0001    WBFIA1           HRH Carcass Hdr
     C                     Z-ADDP1CMDT    WBCMDT           HRH From Kill D
     C                     Z-ADDP1CODT    WBCODT           HRH To Kill Dat
     C                     Z-ADDP1FLA1    WBFLA1           HRH Min Live We
     C                     Z-ADDP1FMA1    WBFMA1           HRH Max Live We
     C                     Z-ADDP2QTNB    WBFNA1           HRH Dist Carcas
     C                     Z-ADDYL0002    WBFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WBFPA1           HRH Avg Hot Wgt
      *
     C           KLCRSH    KLIST
     C                     KFLD           WBK1ST           HRH Type Of Dis
     C                     KFLD           WBFJA1           HRH Min Carcass
     C                     KFLD           WBFKA1           HRH Max Carcass
     C                     KFLD           WBFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSH    SETLL@FBCPGT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0955' W0RTN   7
      * Send message 'Hog Population Hdr Out EX'
     C                     MOVEL'PRK0955' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@FBCPGT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Hog Pop Hde Outf2 CH - Hog Population Hdr Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004  51       HRH Avg Hot Wgt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @FBCPGT
     C                     MOVELWAK1ST    WBK1ST           HRH Type Of Dis
     C                     Z-ADDWAFJA1    WBFJA1           HRH Min Carcass
     C                     Z-ADDWAFKA1    WBFKA1           HRH Max Carcass
     C                     Z-ADDWAFIA1    WBFIA1           HRH Carcass Hdr
      *
     C           KLCHSI    KLIST
     C                     KFLD           WBK1ST           HRH Type Of Dis
     C                     KFLD           WBFJA1           HRH Min Carcass
     C                     KFLD           WBFKA1           HRH Max Carcass
     C                     KFLD           WBFIA1           HRH Carcass Hdr
     C           KLCHSI    CHAIN@FBCPGT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFBCPL0'MDACP
     C                     MOVEL'@FBCPGT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFB1    YCRDCS
      * Move non-key fields to @FBCPGT
     C                     Z-ADDWACMDT    WBCMDT           HRH From Kill D
     C                     Z-ADDWACODT    WBCODT           HRH To Kill Dat
     C                     Z-ADDWAFLA1    WBFLA1           HRH Min Live We
     C                     Z-ADDWAFMA1    WBFMA1           HRH Max Live We
     C                     Z-ADDYL0003    WBFNA1           HRH Dist Carcas
     C                     Z-ADDYL0002    WBFOA1           HRH Total Hot W
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFB1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@FBCPGT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFBCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv/Crt Hog Pop Dtl 2 RT - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WCK1ST           HRH Type Of Dis
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCQUNB           HRD Min Carcass
     C                     KFLD           WCQVNB           HRD Max Carcass
     C                     KFLD           WCFIA1           HRH Carcass Hdr
      * Setup key
     C                     MOVELP3K1ST    WCK1ST           HRH Type Of Dis
     C                     Z-ADDP2CLDT    WCB0DT           TH Kill Date
     C                     Z-ADDP1FJA1    WCQUNB           HRD Min Carcass
     C                     Z-ADDP1FKA1    WCQVNB           HRD Max Carcass
     C                     Z-ADDYL0001    WCFIA1           HRH Carcass Hdr
      * Establish starting position
     C           KRSSJ     CHAIN@FCCPGX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0985' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     EXSR SKCRRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WCFHA1    ADD  P2QTNB    YL0004           HRD Dist Carcas
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WN0006 152       HRD Dist Hot Wt
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FCCPGW
     C                     MOVELP3K1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDP2CLDT    WDB0DT           TH Kill Date
     C                     Z-ADDP1FJA1    WDQUNB           HRD Min Carcass
     C                     Z-ADDP1FKA1    WDQVNB           HRD Max Carcass
     C                     Z-ADDYL0001    WDFIA1           HRH Carcass Hdr
     C                     Z-ADDP1FLA1    WDQWNB           HRD Min Live We
     C                     Z-ADDP1FMA1    WDQXNB           HRD Max Live We
     C                     Z-ADDP2QTNB    WDFHA1           HRD Dist Carcas
      *
     C           KLCRSK    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDQUNB           HRD Min Carcass
     C                     KFLD           WDQVNB           HRD Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
      * Check for duplicate primary key
     C           KLCRSK    SETLL@FCCPGW                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0986' W0RTN   7
      * Send message 'Hog Population 1237180'
     C                     MOVEL'PRK0986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@FCCPGW                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Hog Pop Dtl Outf2 CH - Hog Population Dtl Outf 2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FCCPGW
     C                     MOVELP3K1ST    WDK1ST           HRH Type Of Dis
     C                     Z-ADDP2CLDT    WDB0DT           TH Kill Date
     C                     Z-ADDP1FJA1    WDQUNB           HRD Min Carcass
     C                     Z-ADDP1FKA1    WDQVNB           HRD Max Carcass
     C                     Z-ADDYL0001    WDFIA1           HRH Carcass Hdr
      *
     C           KLCHSL    KLIST
     C                     KFLD           WDK1ST           HRH Type Of Dis
     C                     KFLD           WDB0DT           TH Kill Date
     C                     KFLD           WDQUNB           HRD Min Carcass
     C                     KFLD           WDQVNB           HRD Max Carcass
     C                     KFLD           WDFIA1           HRH Carcass Hdr
     C           KLCHSL    CHAIN@FCCPGW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFCCPL0'MDACP
     C                     MOVEL'@FCCPGW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFC1    YDRDCS
      * Move non-key fields to @FCCPGW
     C                     Z-ADDP1FLA1    WDQWNB           HRD Min Live We
     C                     Z-ADDP1FMA1    WDQXNB           HRD Max Live We
     C                     Z-ADDYL0004    WDFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WDRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WDU1PR           HRD Dist Hot Wt
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFC1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FCCPGW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAFJA1           HRH Min Carcass
     C                     Z-ADD*ZERO     WAFKA1           HRH Max Carcass
     C                     Z-ADD*ZERO     WAFIA1           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WACMDT           HRH From Kill D
     C                     Z-ADD*ZERO     WACODT           HRH To Kill Dat
     C                     Z-ADD*ZERO     WAFLA1           HRH Min Live We
     C                     Z-ADD*ZERO     WAFMA1           HRH Max Live We
     C                     Z-ADD*ZERO     WAFNA1           HRH Dist Carcas
     C                     Z-ADD*ZERO     WAFOA1           HRH Total Hot W
     C                     Z-ADD*ZERO     WAFPA1           HRH Avg Hot Wgt
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCQUNB           HRD Min Carcass
     C                     Z-ADD*ZERO     WCQVNB           HRD Max Carcass
     C                     Z-ADD*ZERO     WCFIA1           HRH Carcass Hdr
     C                     Z-ADD*ZERO     WCQWNB           HRD Min Live We
     C                     Z-ADD*ZERO     WCQXNB           HRD Max Live We
     C                     Z-ADD*ZERO     WCFHA1           HRD Dist Carcas
     C                     Z-ADD*ZERO     WCRJNB           HRD Percent Tot
     C                     Z-ADD*ZERO     WCU1PR           HRD Dist Hot Wt
      * Clear all neither parameters
      * Crt Hog Pop Dtl Outf2 CR - Hog Population Dtl Outf 2  * 
     C                     Z-ADD*ZERO     WDRJNB  70       HRD Percent Tot
     C                     Z-ADD*ZERO     WDU1PR 152       HRD Dist Hot Wt
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local work field HRH Carcass Hdr 01
     C                     Z-ADD*ZERO     YL0001  31
      * Define local work field HRH Total Hot Wgt
     C                     Z-ADD*ZERO     YL0002 152
      * Define local work field HRH Dist Carcass Cnt
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field HRD Dist Carcass Cnt
     C                     Z-ADD*ZERO     YL0004  70
      *================================================================
     CSR         ZZEXIT    ENDSR
