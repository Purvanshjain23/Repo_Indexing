/***************************************************************** */
/*  SYSTEM:          DAILYS                                        */
/*  PROGRAM NUMBER:  PMW5UPR                                       */
/*  PROGRAM NAME:    PRE-COOKED LABOR/TONNAGE SUMMARY REPORT       */
/*  PROGRAMMER:      SHARON ZURN                                   */
/*  CREATE DATE:     06/24/08                                      */
/*                                                                 */
/*                   THIS CL DOES THE SAME THING THAT THE          */
/*                   SCRIPT MICRODTL DOES EXCEPT IT IS CALLED      */
/*                   FROM THE JOB SCHEDULER.                       */
/*                                                                 */
/*  FUNCTION:                                                      */
/*    PASS IN THE DATES AS MMDDYY TO WORK IN THE SCRIPT.           */
/*    -----------------------------------------                    */
/*  MODIFIED BY:                                                   */
/*******************************************************************/
             PGM        PARM(&FDTE &TDTE &CO)

             DCL        VAR(&FDTE) TYPE(*CHAR) LEN(6) /* MMDDYY */
             DCL        VAR(&TDTE) TYPE(*CHAR) LEN(6) /* MMDDYY */
             DCL        VAR(&CO) TYPE(*CHAR) LEN(3) /* COMPANY*/
             DCL        VAR(&COALPHA) TYPE(*CHAR) LEN(3) /* COMPANY*/
             DCL        VAR(&TITLE) TYPE(*CHAR) LEN(50)
/*------------------------------------------------------------------*/
/* THE SCRIPT POPULATES THE WORKFILE MICROCALC WITH THE DATE RANGE  */
/* PASSED IN.                                                       */
/*------------------------------------------------------------------*/
             CHGVAR     VAR(%SST(&TITLE 1 29)) VALUE('PreCooked +
                          Lbr/Ton by Grp Frm')

             IF         COND(&CO *EQ '364') THEN(DO) /* If Sale Lake */
             CHGVAR     VAR(&COALPHA) VALUE('SCL')


             CHGVAR     VAR(%SST(&TITLE 30 6)) VALUE(&FDTE)
             CHGVAR     VAR(%SST(&TITLE 37 2)) VALUE('To')
             CHGVAR     VAR(%SST(&TITLE 40 6)) VALUE(&TDTE)
             CHGVAR     VAR(%SST(&TITLE 47 3)) VALUE(&COALPHA)

             EXECUTE    VIEW(MICROCALC) OUTFILE(QTEMP/MICROCALC) +
                          SETVAR((&FDATE &FDTE) (&TDATE &TDTE))

             REPORT     REPORT(*LIBL/MICRODTLGR) TITLE(&TITLE) +
                          HOLD(*YES) PCFMT(*SPL) OUTQ(SLCPRT07)

             CHGVAR     VAR(&TITLE) VALUE('      ')
             CHGVAR     VAR(%SST(&TITLE 1 29)) VALUE('PreCooked +
                          Lbr/Ton by Std Frm')
             CHGVAR     VAR(%SST(&TITLE 30 6)) VALUE(&FDTE)
             CHGVAR     VAR(%SST(&TITLE 37 2)) VALUE('To')
             CHGVAR     VAR(%SST(&TITLE 40 6)) VALUE(&TDTE)
             CHGVAR     VAR(%SST(&TITLE 47 3)) VALUE(&COALPHA)

             REPORT     REPORT(*LIBL/MICRODTLSR) TITLE(&TITLE) +
                          HOLD(*YES) PCFMT(*SPL) OUTQ(SLCPRT07)

             ENDDO      /* Do for Salt Lake only */

             ENDPGM

