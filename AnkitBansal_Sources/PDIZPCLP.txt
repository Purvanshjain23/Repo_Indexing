/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - PRINT PROGRAM WITH SELECTIONS FOR PRELIMINARY PICK   */
/*             REPORT. COMPANY, LOAD ID, SCHED SHIP DATE, WAREHOUSES*/
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - PRINT PRELIMINARY PICK REPORT                       */
/*  DATE      -  2/29/96                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*                                                                  */
/*          &COMPNYN    - COMPANY NUMBER - BLANK FOR ALL            */
/*          &LOADN      - LOAD ID                                   */
/*          &DATEN      - SCHED SHIP DATE                           */
/*          &FLAG       - DETAIL/SUMMARY FLAG                       */
/*          &WHSE1      - WAREHOUSE 1                               */
/*          &WHSE2      - WAREHOUSE 2                               */
/*          &WHSE3      - WAREHOUSE 3                               */
/*          &WHSE4      - WAREHOUSE 4                               */
/*          &WHSE5      - WAREHOUSE 5                               */
/*          &WHSE6      - WAREHOUSE 6                               */
/*          &WHSE7      - WAREHOUSE 7                               */
/*          &WHSE8      - WAREHOUSE 8                               */
/*          &WHSE9      - WAREHOUSE 9                               */
/*          &WHSE10     - WAREHOUSE 10                              */
/*          &R1LOAD     - LOAD ID                                   */
/*          &R2SEQ      - SCHEDULED SEQUENCE NUMBER                 */
/*          &R3DEP      - DEADLINE DEPARTURE DATE/TIME              */
/*          &R4STRT     - LOAD PLAN START DATE/TIME                 */
/*          &LDPLTP     - LOAD PLAN TYPE                            */
/*          &SOFLAG     - SELECT/OMIT FLAG                          */
/*          &AUTOP      - AUTO PRINT                                */
/*          &OUTQ       - OUTPUT QUEUE                              */
/*          &HOLD       - HOLD PRINT                                */
/*          &SAVE       - SAVE PRINT                                */
/*          &COPYN      - NUMBER OF COPIES                          */
/*          &NIGHTQ     - NIGHT OUTPUT QUEUE                        */
/********************************************************************/
/*  RMC 7/27/06 IN OPNQRY, CHECK (DB1.COMP=&COMP   OR                */
/*              MULTIPICKUP=Y) FOR SELECTION  SO BOTH PLANTS CAN SEE */
/*              MULTI PICK LOADS                                    */
/* 108074 ERIC L 3 PARMS ADDED                                      */
/*               OPENQRYF ADDED TO RUN 2 DIFFERENT SORTS            */
/*  PIO 03/04/24 -  REPLACE OPNQRYF WITH OPNSQLF FOR OMFJCPL5 FILE */
/*                  ADDED NEEDED OVRDBF AROUND THE COMMAND.        */
/*                  CHANGE *AND TO AND, *EQ TO =, *GE TO >=, *LE TO*/
/*                  <=, *GT TO > IN &Q                             */
/*                                                                 */
/********************************************************************/

 PDIZPCLP:   PGM        PARM(&COMPNYN &LOADN &DATEN &FLAG &OUTQ +
                          &HOLD &SAVE &COPYN &NIGHTQ &WHSE1 &WHSE2 +
                          &WHSE3 &WHSE4 &WHSE5 &WHSE6 &WHSE7 &WHSE8 +
                          &WHSE9 &WHSE10 &R1LOAD &R2SEQ &R3DEP     +
                          &LDPLTP &SOFLAG &AUTOP)
/* PARMS                                                                      */
        DCL    &COMPNYN    *DEC                  /* Company Number (Passed)   */
        DCL    &LOADN      *DEC                  /* LOAD ID        (Passed)   */
        DCL    &DATEN      *DEC                  /* SCHD SHIP DATE (PASSED)   */
        DCL    &FLAG       *CHAR   (1)           /* DETAIL/SUMMARY RPT        */
        DCL    &SOFLAG     *CHAR   (1)           /* SELECT/OMIT WHSE          */
        DCL    &AUTOP      *CHAR   (1)           /* AUTO PRINT                */
        DCL    &WHSE1      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE2      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE3      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE4      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE5      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE6      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE7      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE8      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE9      *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &WHSE10     *CHAR   (3)           /* WAREHOUSE                 */
        DCL    &R1LOAD     *CHAR   (1)           /* LOAD ID                   */
        DCL    &R2SEQ      *CHAR   (1)           /* SCHEDULED SEQUENCE NUMBER */
        DCL    &R3DEP      *CHAR   (1)           /* DEADLINE DEPARTURE DATE/TI*/
 /***** DCL    &R4STRT     *CHAR   (1)           /* LOAD PLAN START DATE/TIME */
        DCL    &LDPLTP     *CHAR   (2)           /* LOAD PLAN TYPE            */
        DCL    &COPYN      *DEC                  /* No. of Copies             */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue              */
        DCL    &NEWOUTQ    *CHAR   (10)          /* Output Queue              */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status               */
        DCL    &SAVE       *CHAR   (4)           /* Save Status               */
        DCL    &NIGHTQ     *CHAR   (10)          /* Night Job Queue           */
        DCL    &COMMAND    *CHAR   (512)
        DCL    &LSTREG1  *DEC   (04)
        DCL    &LSTREGA  *CHAR  (04)

/* INTERNAL FIELDS                                                            */
        DCL    &COPY       *DEC    (2 0)         /* Number of copies          */
        DCL    &COMPANY    *DEC    (3 0)         /* Company Number            */
        DCL    &LOADID     *DEC    (7 0)         /* LOAD ID                   */
        DCL    &DATE       *DEC    (7 0)         /* SCHD SHIP DATE            */
        DCL    &INCAP      *CHAR   (1)           /* Include in Auto Prnt      */
        DCL    &INCAP1     *CHAR   (1)           /* Include in Auto Prnt WHS1 */

/* OPENQRYF FIELDS                                                            */
        DCL    &COMPA      *CHAR    3            /* ACK COMPLETE              */
        DCL    &DATEA      *CHAR    7            /* SCHD SHIP DATE (Passed)   */

        DCL    &RPTCO     *CHAR   14              /* REPORT/CO MSG  */
        DCL     &A        *CHAR   30              /* QRY SCHD DATE  */
        DCL     &B        *CHAR   30              /* QRY LD PLN TYP */
        DCL     &C        *CHAR   50              /* QRY COMPANY    */
        DCL     &D        *CHAR  100              /* QRY ALL        */
             DCL        VAR(&YES) TYPE(*CHAR) LEN(3) +
                          VALUE('"Y"') /* QRY ALL        */
        DCL     &QUOTE    *CHAR   1  VALUE('"') /* QRY COMPANY    */
        DCL     &LPTSEL   *CHAR   1   'N'       /* LOAD PLAN TYPE SELECTED */
/********************************************************************/
/* CHANGE VARIABLES FOR USE IN PROGRAM                              */
/********************************************************************/

             CHGVAR     VAR(&COMPANY) VALUE(&COMPNYN)
             CHGVAR     VAR(&COMPA) VALUE(&COMPANY)
             CHGVAR     VAR(&DATE) VALUE(&DATEN)
             CHGVAR     VAR(&DATEA) VALUE(&DATE)
             CHGVAR     VAR(&COPY) VALUE(&COPYN)
             CHGVAR     VAR(&LOADID) VALUE(&LOADN)

/*********************************************************************/
/*   CREATE OPEN QUERY FILE TO BE USED FOR PRELIMINARY PICK REPORT   */
/*********************************************************************/
             IF         (&COMPA *NE '000') THEN(DO)
   /*PIO     CHGVAR     VAR(&C) VALUE('(FJAIC3 *EQ ' *CAT +  +
                         &COMPA *BCAT '*OR FJRVSX *EQ ' *BCAT  &YES  *CAT ')' ++
                          *BCAT ' ')                         */
   /*PIO*/   CHGVAR     VAR(&C) VALUE('(FJAIC3   = ' *CAT +
                         &COMPA *BCAT ' OR FJRVSX  =  ' *BCAT  &YES  *CAT ')' +
                          *BCAT ' ')
             ENDDO

             IF         (&DATEA *NE '0000000') THEN(DO)
  /*PIO      CHGVAR     VAR(&A) VALUE('*AND FJAODT *EQ ' *CAT + +
                         &DATEA)                                */
  /*PIO*/    CHGVAR     VAR(&A) VALUE(' AND FJAODT =   ' *CAT +
                         &DATEA)
             ENDDO

             IF         (&LDPLTP *NE '  ') THEN(DO)
   /*PIO     CHGVAR     VAR(&B) VALUE('*AND FJR0SX *EQ ' *CAT + +
                         &QUOTE *CAT &LDPLTP *CAT &QUOTE)      */
   /*PIO*/   CHGVAR     VAR(&B) VALUE(' AND FJR0SX  =  ' *CAT +
                         &QUOTE *CAT &LDPLTP *CAT &QUOTE)
             ENDDO

             CHGVAR     VAR(&D) VALUE(&C *BCAT &A *BCAT &B)

  SELECT
/*============================================================*/
/* #1           DEADLINE DEPARTURE DATE/TIME                  */
/*============================================================*/
  WHEN COND(&R3DEP *EQ 'X') THEN(DO)
  /*PIO      OVRDBF     FILE(OMFJCPL5) SHARE(*YES)   +
             OPNQRYF    FILE((OMFJCPL5)) QRYSLT(&D) KEYFLD(*FILE) */

  /*PIO*/    OVRDBF     FILE(OMFJCPP) TOFILE(OMFJCPP) LVLCHK(*NO)
  /*PIO*/    OPNSQLF    SQL('Select * from OMFJCPP Where  ' *BCAT +
                          &D      *BCAT ' Order by FJAIC3 asc, +
                          FJKZDT asc, FJAXTM asc, FJRMNB asc') +
                          OPNID(OMFJCPL5) OPTION(*ALL) SEQONLY(*NO) +
                          RCDFMT(@FJCPD4) ALWCPY(*IFRQD)
  /*PIO*/    OVRDBF     FILE(OMFJCPL5) TOFILE(OMFJCPP) LVLCHK(*NO) +
                          OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)


     /* OMS259/C2750:  ADD FORCE DOT MATRIX PARM  PLL 5/22/97  */
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PDIZPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE) +
                          LETTER(*YES)
             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)
             CALL       PGM(PDIZPFR) PARM(' ' &LOADID &COMPANY &DATE +
                          &FLAG &WHSE1 &WHSE2 &WHSE3 &WHSE4 &WHSE5 +
                          &WHSE6 &WHSE7 &WHSE8 &WHSE9 &WHSE10      +
                          &SOFLAG &AUTOP &LDPLTP)
  ENDDO
/*============================================================*/
/* #2              LOAD PLAN START DATE/TIME                  */
/*============================================================*/
/*WHEN COND(&R4STRT *EQ 'X') THEN(DO)                                  */
/*           OVRDBF     FILE(OMFJCPL5) SHARE(*YES)                     */
/*           OPNQRYF    FILE((OMFJCPL5)) QRYSLT(&D) KEYFLD(  +         */
/*                                       FJAIC3  FJP0DT FJCMTM FJRMNB) */
/*           SBDPRTOVR  CMDVAR(&COMMAND) FILE(PUXCPFR$) OUTQ(&OUTQ) +  */
/*                        COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE) +      */
/*                        LETTER(*YES)                                 */
/*           CALL       PGM(QCMDEXC) PARM(&COMMAND 512)                */
/*           CALL       PGM(PUXCPFR) PARM(' ' &LOADID &COMPANY &DATE + */
/*                        &FLAG &WHSE1 &WHSE2 &WHSE3 &WHSE4 &WHSE5 +   */
/*                        &WHSE6 &WHSE7 &WHSE8 &WHSE9 &WHSE10      +   */
/*                        &SOFLAG &AUTOP &LDPLTP)                      */
/*ENDDO                                                                */
/*============================================================*/
/* #3           SCHEDULED SEQUENCE NUMBER                     */
/*============================================================*/
  WHEN COND(&R2SEQ *EQ 'X') THEN(DO)
  /*PIO      OVRDBF     FILE(OMFJCPL5) SHARE(*YES) +
             OPNQRYF    FILE((OMFJCPL5)) QRYSLT(&D) KEYFLD( FJAIC3 + +
               FJP0DT  FJCMTM FJT4NB)                           */

   /*PIO*/    OVRDBF     FILE(OMFJCPP) TOFILE(OMFJCPP) LVLCHK(*NO)
   /*PIO*/    OPNSQLF    SQL('SELECT * FROM OMFJCPP WHERE  ' *BCAT +
                           &D      *BCAT ' ORDER BY FJAIC3 ASC, +
                           FJKZDT ASC, FJAXTM ASC, FJRMNB ASC') +
                           OPNID(OMFJCPL5) OPTION(*ALL) SEQONLY(*NO) +
                           RCDFMT(@FJCPD4) ALWCPY(*IFRQD)
   /*PIO*/    OVRDBF     FILE(OMFJCPL5) TOFILE(OMFJCPP) LVLCHK(*NO) +
                           OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)

             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PUXEPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE) +
                          LETTER(*YES)
             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)
             CALL       PGM(PUXEPFR) PARM(' ' &LOADID &COMPANY &DATE +
                          &FLAG &WHSE1 &WHSE2 &WHSE3 &WHSE4 &WHSE5 +
                          &WHSE6 &WHSE7 &WHSE8 &WHSE9 &WHSE10      +
                          &SOFLAG &AUTOP &LDPLTP)
  ENDDO
/*============================================================*/
/* #4           LOAD ID                                       */
/*============================================================*/
  WHEN COND(&R1LOAD *EQ 'X') THEN(DO)
    /*PIO    OVRDBF     FILE(OMFJCPL5) SHARE(*YES)   +
             OPNQRYF    FILE((OMFJCPL5)) QRYSLT(&D) KEYFLD(  + +
                                         FJAIC3 FJRMNB)       */

   /*PIO*/    OVRDBF     FILE(OMFJCPP) TOFILE(OMFJCPP) LVLCHK(*NO)
   /*PIO*/    OPNSQLF    SQL('SELECT * FROM OMFJCPP WHERE  ' *BCAT +
                           &D      *BCAT ' ORDER BY FJAIC3 ASC, +
                           FJKZDT ASC, FJAXTM ASC, FJRMNB ASC') +
                           OPNID(OMFJCPL5) OPTION(*ALL) SEQONLY(*NO) +
                           RCDFMT(@FJCPD4) ALWCPY(*IFRQD)
   /*PIO*/    OVRDBF     FILE(OMFJCPL5) TOFILE(OMFJCPP) LVLCHK(*NO) +
                           OVRSCOPE(*JOB) SHARE(*YES) OPNSCOPE(*JOB)


             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PUXDPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE) +
                          LETTER(*YES)
             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)
             CALL       PGM(PUXDPFR) PARM(' ' &LOADID &COMPANY &DATE +
                          &FLAG &WHSE1 &WHSE2 &WHSE3 &WHSE4 &WHSE5 +
                          &WHSE6 &WHSE7 &WHSE8 &WHSE9 &WHSE10      +
                          &SOFLAG &AUTOP &LDPLTP)
  ENDDO

  ENDSELECT



             IF         (&AUTOP  *EQ 'Y') THEN(DO)
/* GET WHSE1 FLAG FOR USE LATER */
              CALL       PGM(PDCHXFR) PARM('' &WHSE1 &NEWOUTQ &INCAP1)
              RTVSPLFAN  SPLF(PDIZPFR$) SPLNBR(&LSTREG1)
              CHGVAR VAR(&LSTREGA) VALUE(&LSTREG1)

              IF         (&WHSE2 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE2 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)    +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE3 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE3 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE4 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE4 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)    +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE5 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE5 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE6 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE6 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE7 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE7 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE8 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE8 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE9 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE9 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF         (&WHSE10 *NE '   ') THEN(DO)
               CALL       PGM(PDCHXFR) PARM('' &WHSE10 &NEWOUTQ &INCAP)
               IF (&INCAP *EQ 'Y') DO
                DUPSPLFP   SPLF(PDIZPFR$) SPLNBR(&LSTREGA) +
                           OUTQ(&NEWOUTQ)
                RLSSPLF    FILE(PDIZPFR$) SPLNBR(*LAST)  +
                           SELECT(*CURRENT &NEWOUTQ)
               ENDDO
              ENDDO

              IF (&INCAP1 *EQ 'Y') THEN(DO)
               RLSSPLF    FILE(PDIZPFR$) SPLNBR(&LSTREG1) +
                            SELECT(*CURRENT)
               MONMSG     MSGID(CPF0001)
              ENDDO
              ELSE DO
               DLTSPLF    FILE(PDIZPFR$) SPLNBR(&LSTREG1) +
                            SELECT(*CURRENT)
              ENDDO
             ENDDO
             CLOF       OPNID(OMFJCPL5)
 END:        ENDPGM
