     H/TITLE Prt Receiving Rpt-Sum PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 10/27/21  Time  : 11:43:10
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPN1IF  E           K        DISK
      * RSQ : Tattoo Header             Co/ClassTp/KillDt/Ttt,Se
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPLAJCPL1IF  E           K        DISK
      * RTV : Delivery Tracking Split   Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKB3CPL1IF  E           K        DISK
      * RTV : Tattoo Scale Ticket       Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKA1CPN0IF  E           K        DISK
      * RSQ : Tattoo Header             Co/bol/Ttt/SelHeldOver
      *
     FPKA1CPM9IF  E           K        DISK
      * RSQ : Tattoo Header             Co/KillDt/ClassTp/Sel su
      *
     FPKDWPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Receiving Rpt-Sum PF  Print file
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@A1CPVF
      * Tattoo Header             Co/bol/Ttt/SelHeldOver
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@A1CPVE
      * Tattoo Header             Co/KillDt/ClassTp/Sel su
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  TH Source Type
     I                                        3   3 P1KAST
      * I :  TH Hog Class Type
     I                                        4   4 P1LLST
     IP2PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P2EVTX
     IP3PARM      DS
      * I :  Date From USR
     I                                    P   1   40P3B3DT
     IP4PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P4B4DT
     IP5PARM      DS
      * I :  SR Source Code
     I                                        1   3 P5AACD
     IP6PARM      DS
      * N :  Usr Display 1
     I                                        1   1 P6MFST
     IP7PARM      DS
      * I :  DT Load Type
     I                                        1   2 P7XHST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0001
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1KAST    PARM           WP0002  1        TH Source Type
     C           P1LLST    PARM           WP0003  1        TH Hog Class Ty
     C           P2EVTX    PARM           WP0004 40        Oms System Valu
     C           P3B3DT    PARM           WP0005  70       Date From USR
     C           P4B4DT    PARM           WP0006  70       Date To   USR
     C           P5AACD    PARM           WP0007  3        SR Source Code
     C           P7XHST    PARM           WP0008  2        DT Load Type
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Receiving Rpt-Sum PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$QENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Receiving Rpt-Sum PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
      * Establish starting position
     C           KRSA      SETLL@A1CPVP                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
      * USER: Null report processing
      * CLC Set for Null Rpt  US - STR User Source Functions  * 
     C                     MOVEL'Y'       W0AP1P
     C                     MOVEL'Y'       W0NEWP
     C                     MOVEL'N'       P6MFST           Usr Display 1
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0AL02  1        TH Kill Date
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $CHMNB           BOH Company Num
     C                     MOVEL*BLANK    $CBSTX           Name USR
     C                     Z-ADD*ZERO     $CB3DT           Date From USR
     C                     Z-ADD*ZERO     $CB4DT           Date To   USR
     C                     MOVEL*BLANK    $CAACD           SR Source Code
     C                     MOVEL*BLANK    $CAFTX           SR Description
     C                     MOVEL*BLANK    $CXHST           DT Load Type
     C                     MOVEL*BLANK    $CEVT1           Load Type Descr
     C                     MOVEL*BLANK    $CLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    $CKKTX           Description 30
     C                     MOVEL*BLANK    $CIXST           SR Type
     C                     MOVEL*BLANK    $CISTX           SR Type Desc
      * Load related totals format
     C                     Z-ADD*ZERO     $PSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $PSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $PWWNB           Head Received 1
     C                     Z-ADD*ZERO     $PX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $PQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $PB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $PTKNB           CKR Held Over
     C                     Z-ADD*ZERO     $POONB           Live Weight
     C                     Z-ADD*ZERO     $PXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $PXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $PZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $PB5NB           Head Total USR
     C                     Z-ADD*ZERO     $PZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $PZ8NB           Avg Live Wgt Us
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     MOVELA1LLST    $DLLST           TH Hog Class Ty
     C                     MOVEL*BLANK    $DKKTX           Description 30
      * Load related totals format
     C                     Z-ADDA1HMNB    $OHMNB           BOH Company Num
     C                     MOVELA1LLST    $OLLST           TH Hog Class Ty
     C                     Z-ADD*ZERO     $OWWNB           Head Received 1
     C                     Z-ADD*ZERO     $OSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $OSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $OX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $OQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $OB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $OCDNB           Head held over
     C                     Z-ADD*ZERO     $OQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $OXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $OXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $OZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $OB5NB           Head Total USR
     C                     Z-ADD*ZERO     $OZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $OZ8NB           Avg Live Wgt Us
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $EB0DT           TH Kill Date
     C                     MOVELA1LLST    $ELLST           TH Hog Class Ty
      * Load related totals format
     C                     Z-ADD*ZERO     $NSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $NSSA1           EUT/KOA Head To
     C                     Z-ADDA1HMNB    $NHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $NB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $NWWNB           Head Received 1
     C                     Z-ADD*ZERO     $NX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $NQMNB           Avg Live Wgt 2
     C                     Z-ADD*ZERO     $NB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $NCDNB           Head held over
     C                     Z-ADD*ZERO     $NQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $NXHNB           Avg Live Wgt Us
     C                     Z-ADD*ZERO     $NTKNB           CKR Held Over
     C                     Z-ADD*ZERO     $NOONB           Live Weight
     C                     Z-ADD*ZERO     $NXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $NZ9NB           Live Weight 3 S
     C                     Z-ADD*ZERO     $NB5NB           Head Total USR
     C                     Z-ADD*ZERO     $NZ7NB           Live wgt total
     C                     Z-ADD*ZERO     $NZ8NB           Avg Live Wgt Us
     C                     MOVELA1LLST    $NLLST           TH Hog Class Ty
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $FBONB           BOL Load Number
     C                     Z-ADDA1B0DT    $FB0DT           TH Kill Date
     C                     MOVEL*BLANK    $FNGST           @Status (Held o
     C                     Z-ADDA1CVNB    $FCVNB           TH Tattoo Numbe
     C                     MOVELA1ABCD    $FABCD           PD Producer Cod
     C                     Z-ADDA1AWDT    $FAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $FBICD           TH Group Refere
     C                     MOVELA1CPST    $FCPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $FACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $FB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $FCAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $FC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $FAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $FA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $FC2ST           TH Resale Sprea
     C                     Z-ADDA1CWNB    $FCWNB           TH Head Receive
     C                     Z-ADDA1CYNB    $FCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     $FOVNB           Avg Live Wgt Us
     C                     Z-ADDA1ECDT    $FECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $FEDDT           TH Head EUT/KOA
     C                     Z-ADDA1F7NB    $FF7NB           TH Avg Live Wgt
     C                     Z-ADDA1CXNB    $FCXNB           TH Dead On Arri
     C                     Z-ADDA1FCNB    $FFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     $FCCNB           Yard dead weigh
     C                     Z-ADDA1OXNB    $FOXNB           TH HPS Movement
     C                     Z-ADDA1H9NB    $FH9NB           TH Held Over
     C                     Z-ADDA1FDNB    $FFDNB           TH Head Condemn
     C                     Z-ADDA1FENB    $FFENB           TH Head Killed
     C                     Z-ADDA1HENB    $FHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $FHFNB           TH Head Accepte
     C                     Z-ADDA1LRNB    $FLRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $FE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $FA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $FFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $FA4PC           TH Tot Light Re
     C                     Z-ADDA1HDNB    $FHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    $FF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    $FF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $FF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $FF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $FAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    $FAWPC           TH Actual Yield
     C                     Z-ADDA1CWPC    $FCWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $FA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $FA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $FB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $FAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    $FANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $FAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $FAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $FAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $FAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $FAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $FASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $FA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $FATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $FA5VA           TH Additions Am
     C                     Z-ADDA1CBPR    $FCBPR           TH Payment Gros
     C                     Z-ADDA1CCPR    $FCCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $FLPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $FCDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $FA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $FA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $FJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $FCWST           TH Payment Sts
     C                     MOVELA1D7ST    $FD7ST           TH Header Error
     C                     MOVELA1D8ST    $FD8ST           TH Detail Error
     C                     MOVELA1DWST    $FDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $FD6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $FGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $FBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $FE0ST           TH User Error O
     C                     MOVELA1E1ST    $FE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $FE2ST           TH Sex
     C                     Z-ADDA1BSDT    $FBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $FBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $FBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $FHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $FHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $FHINB           TH FFLI
     C                     Z-ADDA1A3PR    $FA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $FA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $FA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $FJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $FD6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $FD7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $FD8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $FD9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $FEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $FEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $FECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $FEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $FEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $FEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $FEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $FEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $FKAST           TH Source Type
     C                     MOVELA1J7ST    $FJ7ST           TH Scale Ticket
     C                     MOVELA1J9ST    $FJ9ST           TH Payment Type
     C                     MOVELA1LKST    $FLKST           TH Source Code
     C                     MOVELA1LLST    $FLLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $FJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $FLIST           TH Schedule Kil
     C                     MOVELA1LJST    $FLJST           TH Shift Held O
     C                     MOVELA1NZTX    $FNZTX           TH State
     C                     MOVELA1HJCD    $FHJCD           TH Unused Code
     C                     MOVELA1R4ST    $FR4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $FR5ST           TH Commission S
     C                     MOVELA1R6ST    $FR6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $FR7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $FTHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $FT2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $FTHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $FT2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $FOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $FKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $FOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $FOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $FIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $FOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $FOQET           TH PHA Add Type
     C                     MOVELA1URST    $FURST           TH PHA Average
     C                     MOVELA1USST    $FUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $FHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $FS9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $FTAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $FTBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $FJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $FKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $FKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $FKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $FKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $FOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $FIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $FIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $FIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $FKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $FOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $FKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $FORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $FOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $FMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $FMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $FNCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $FNCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $FIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $FKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $FEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $FEBDT           TH Cold Scl Upl
     C                     Z-ADDA1EEDT    $FEEDT           TH Unused Date
     C                     MOVELA1U4ST    $FU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $FU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $FU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $FU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $FU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $FU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $FVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $FVBST           TH Unused Sts 8
     C                     MOVELA1AGCD    $FAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $FKQTX           Farm site Name
     C                     MOVEL*BLANK    $FNYCD           PS Site ID
     C                     MOVELA1BECD    $FBECD           HC Class Code
     C                     MOVELA1BDCD    $FBDCD           DF Defect Code
     C                     MOVELA1CSCD    $FCSCD           THP Process Cod
     C                     MOVELA1AECD    $FAECD           PL Location Cod
     C                     MOVELA1ACCD    $FACCD           HB Buyer Code
     C                     MOVELA1AAVN    $FAAVN           RS User Changed
     C                     Z-ADDA1AADT    $FAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $FAMTM           RS Time Changed
     C                     MOVELA1AJST    $FAJST           RS Record Statu
     C                     MOVELA1AHVN    $FAHVN           RS Job
     C                     MOVELA1AGVN    $FAGVN           RS Program
     C                     MOVELA1ABVN    $FABVN           RS User Added
     C                     Z-ADDA1ABDT    $FABDT           RS Date Added
     C                     Z-ADDA1ABTM    $FABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UCSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Recvng f/Hld-Sum  PO
     C                     EXSR UDSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
      * Accum DOA, yard dead head, and yard dead wgt, head received
      * doa
     C                     ADD  $FCXNB    $NB4NB           Head Total SUM
      * yard deads
     C                     ADD  $FFCNB    $NXRNB           Head Total Sum2
     C                     ADD  $FEDDT    $NSSA1           EUT/KOA Head To
     C                     ADD  $FECDT    $NSRA1           LFT Head Total
     C                     ADD  $FCCNB    $NZ9NB           Live Weight 3 S
     C                     ADD  $FCYNB    $NX5NB           Live Weight SUM
     C                     ADD  $FCWNB    $NWWNB           Head Received 1
     C                     ADD  WUQLNB    $NQLNB           Live Weight 2 S
     C                     ADD  WUCDNB    $NCDNB           Head held over
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1LLST    WZA002           TH Hog Class Ty
     C                     MOVELA1LLST    WZA002
     C           *LIKE     DEFN A1B0DT    WZA003           TH Kill Date
     C                     Z-ADDA1B0DT    WZA003
     C           *LIKE     DEFN A1CVNB    WZA004           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPVP                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * If PAR.Load Type is entered, retrieve Delivery Tracking Load Type
      * CASE:
      *  - NOTc1
      *   |- c1    : PAR.DT Load Type is Not Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P7XHST    IFEQ *BLANK                     *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Load Type         RT - Delivery Tracking  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Kill Date GE PAR.Date From USR
      *   |- c2    : DB1.TH Kill Date LE PAR.Date To   USR
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           A1B0DT    IFGE P3B3DT                     *IF
     C           A1B0DT    IFLE P4B4DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Hog Class Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Hog Class Type EQ PAR.TH Hog Class Type
      *   '-
     C           P1LLST    IFEQ WUCRTX                     *IF
     C           A1LLST    OREQ P1LLST                     *OR
      * E11245 JJH 07/24/17 - Add Selection by SR Source Code
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.SR Source Code is EQ Blank
      *   |- c2    : PAR.SR Source Code EQ DB1.TH Source Code
      *   '-
     C           P5AACD    IFEQ *BLANK                     *IF
     C           P5AACD    OREQ A1LKST                     *OR
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.DT Load Type is Not Entered
      *   |- c2    : PAR.DT Load Type EQ LCL.DT Load Type
      *   '-
     C           P7XHST    IFEQ *BLANK                     *IF
     C           P7XHST    OREQ YL0011                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Source Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Source Type EQ PAR.TH Source Type
      *   '-
     C           P1KAST    IFEQ WUCRTX                     *IF
     C           A1KAST    OREQ P1KAST                     *OR
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        TH Hog Class Ty
     C                     MOVEL*BLANK    W0AL02  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL03  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0AL02  1        TH Kill Date
     C                     MOVEL'Y'       W0AL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1LLST    IFNE WZA002                     TH Hog Class Ty
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1B0DT    IFNE WZA003                     TH Kill Date
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1CVNB    IFNE WZA004                     TH Tattoo Numbe
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * PRTOBJ calls before print of TH Kill Date format
      * Embedded PRTOBJ : Prt Recvng f/Sub-Sum  PO
     C                     EXSR UGSUBR                     Embedded PRTOBJ
      * Mention hidden format
     C   99N99             WRITE$NKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * USER: Process after print of TH Kill Date format
      * Accum head to be killed
      * CASE: CUR.TH Hog Class Type is Not Resale
     C           $NLLST    IFEQ 'M'                        *IF
     C           $NLLST    OREQ 'S'
     C                     ADD  $NB4NB    $OB4NB           Head Total SUM
     C                     ADD  $NSSA1    $OSSA1           EUT/KOA Head To
     C                     ADD  $NSRA1    $OSRA1           LFT Head Total
     C                     ADD  $NXRNB    $OXRNB           Head Total Sum2
     C                     ADD  $NZ9NB    $OZ9NB           Live Weight 3 S
     C                     ADD  $NCDNB    $OCDNB           Head held over
     C                     ADD  $NQLNB    $OQLNB           Live Weight 2 S
     C                     END                             *FI
     C                     ADD  $NX5NB    $OX5NB           Live Weight SUM
     C                     ADD  $NWWNB    $OWWNB           Head Received 1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Hog Class Type format
      * CASE: CUR.Head Received 1 SUM is Not 0
     C           $OWWNB    IFNE *ZERO                      *IF
     C           $OX5NB    DIV  $OWWNB    $OQMNB           Avg Live Wgt 2
     C                     END                             *FI
      * Total Head to Kill
      * CUR.Head Total USR =
      *    *COMPUTE ((x1 + x2) - x3)
      * x1    : CUR.Head Received 1 SUM
      * +     : PGM.*Synon (17,7) work field
      * x2    : CUR.Head held over        SUM
      * -     : PGM.*Synon (17,7) work field
      * x3    : CUR.Head Total Sum2
     C           $OWWNB    ADD  $OCDNB    W0WD01           *Synon (17,7) w
     C           W0WD01    SUB  $OXRNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $OB5NB           Head Total USR
      * Calc tot_head_to_kill wgt
      * CUR.Live wgt total 11.1   USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : CUR.Live Weight SUM
      * +     : CUR.Live wgt total 11.1   USR
      * x2    : CUR.Live Weight 2 SUM
      * -     : PGM.*Synon (17,7) work field
      * x3    : CUR.Live Weight 3 SUM
     C           $OX5NB    ADD  $OQLNB    $OZ7NB           Live wgt total
     C           $OZ7NB    SUB  $OZ9NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $OZ7NB           Live wgt total
      * Calc Held over avg weight
      * CASE: CUR.Head held over        SUM is Not 0
     C           $OCDNB    IFNE *ZERO                      *IF
     C           $OQLNB    DIV  $OCDNB    $OXHNB           Avg Live Wgt Us
     C                     END                             *FI
      * Calc Total_head_to_kill avg wgt
      * CASE: CUR.Head Total USR is Not 0
     C           $OB5NB    IFNE *ZERO                      *IF
     C           $OZ7NB    DIV  $OB5NB    $OZ8NB           Avg Live Wgt Us
     C                     END                             *FI
      * Reverse the sign for Yard deads to print as < - >
     C                     MULT -1        $OXRNB           Head Total Sum2
     C                     MULT -1        $OZ9NB           Live Weight 3 S
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 9
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
     C                     MOVEL'0'       *IN79
     C           WULLST    IFEQ 'R'                        *IF
     C           WULLST    OREQ 'S'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$OKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of TH Hog Class Type format
      * Accum totals for head received that are to be killed
      * CASE: CUR.TH Hog Class Type is Not Resale
     C           $OLLST    IFEQ 'M'                        *IF
     C           $OLLST    OREQ 'S'
     C                     ADD  $OWWNB    $PWWNB           Head Received 1
     C                     ADD  $OX5NB    $PX5NB           Live Weight SUM
     C                     ADD  $OB4NB    $PB4NB           Head Total SUM
     C                     ADD  $OSRA1    $PSRA1           LFT Head Total
     C                     ADD  $OSSA1    $PSSA1           EUT/KOA Head To
     C                     ADD  $OXRNB    $PXRNB           Head Total Sum2
     C                     ADD  $OZ9NB    $PZ9NB           Live Weight 3 S
     C                     END                             *FI
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
      * USER: On print of final totals format
      * Mention hidden format
     C   99N99             WRITE$PFINTTL
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKB02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKB03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKB04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKB05           TH Kill Date
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           BOH Buy Order N
     C                     KFLD           WQKB03           BOL Load Number
     C                     KFLD           WQKB04           TH Tattoo Numbe
     C                     KFLD           WQKB05           TH Kill Date
      * Setup key
     C                     Z-ADD$FHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$FBNNB    WQKB02           BOH Buy Order N
     C                     Z-ADD$FBONB    WQKB03           BOL Load Number
     C                     Z-ADD$FCVNB    WQKB04           TH Tattoo Numbe
     C                     Z-ADD$FB0DT    WQKB05           TH Kill Date
      * Establish starting position
     C           KRSB      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $GHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $GBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $GBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $GCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $GB0DT           TH Kill Date
     C                     MOVELDZBDCD    $GBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $GB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $GANTM           TST Wgt Time
     C                     MOVEL*BLANK    $GJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $GLJNB           TDF Head Defect
     C                     MOVELDZBECD    $GBECD           HC Class Code
     C                     MOVELDZB7SS    $GB7SS           TDF Classificat
     C                     MOVELDZB8SS    $GB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $GB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $GCASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $GNXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $GNYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $GNZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $GAAVN           RS User Changed
     C                     Z-ADDDZAADT    $GAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $GAMTM           RS Time Changed
     C                     MOVELDZAJST    $GAJST           RS Record Statu
     C                     MOVELDZAHVN    $GAHVN           RS Job
     C                     MOVELDZAGVN    $GAGVN           RS Program
     C                     MOVELDZABVN    $GABVN           RS User Added
     C                     Z-ADDDZABDT    $GABDT           RS Date Added
     C                     Z-ADDDZABTM    $GABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZB001           BOH Company Num
     C                     Z-ADDDZHMNB    WZB001
     C           *LIKE     DEFN DZBNNB    WZB002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZB002
     C           *LIKE     DEFN DZBONB    WZB003           BOL Load Number
     C                     Z-ADDDZBONB    WZB003
     C           *LIKE     DEFN DZCVNB    WZB004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZB004
     C           *LIKE     DEFN DZB0DT    WZB005           TH Kill Date
     C                     Z-ADDDZB0DT    WZB005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR SKRVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0BL04  1        TH Kill Date
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL02  1        BOL Load Number
     C                     MOVEL'Y'       W0BL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0BL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           DZBNNB    IFNE WZB002                     BOH Buy Order N
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           DZBONB    IFNE WZB003                     BOL Load Number
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           DZCVNB    IFNE WZB004                     TH Tattoo Numbe
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           DZB0DT    IFNE WZB005                     TH Kill Date
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt Recvng f/Hld-Sum  PO: Mainline
      *================================================================
      * Prt Recvng f/Hld-Sum  PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQKC02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQKC03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQKC04           TH Tattoo Numbe
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           BOH Buy Order N
     C                     KFLD           WQKC03           BOL Load Number
     C                     KFLD           WQKC04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADD$FHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$FBNNB    WQKC02           BOH Buy Order N
     C                     Z-ADD$FBONB    WQKC03           BOL Load Number
     C                     Z-ADD$FCVNB    WQKC04           TH Tattoo Numbe
      * Establish starting position
     C           KRSC      SETLL@A1CPVF                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $JSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $JSRA1           LFT Head Total
     C                     Z-ADD*ZERO     $JQLNB           Live Weight 2 S
     C                     Z-ADD*ZERO     $JCDNB           Head held over
     C                     Z-ADDWAHMNB    $JHMNB           BOH Company Num
     C                     Z-ADDWACVNB    $JCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     $JWWNB           Head Received 1
     C                     Z-ADD*ZERO     $JX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $JB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $JXRNB           Head Total Sum2
     C                     Z-ADDWAB0DT    $JB0DT           TH Kill Date
     C                     MOVELWALLST    $JLLST           TH Hog Class Ty
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWAHMNB    $HHMNB           BOH Company Num
     C                     Z-ADDWABNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    $HBONB           BOL Load Number
     C                     Z-ADDWAB0DT    $HB0DT           TH Kill Date
     C                     MOVEL*BLANK    $HNGST           @Status (Held o
     C                     Z-ADDWACVNB    $HCVNB           TH Tattoo Numbe
     C                     MOVELWAABCD    $HABCD           PD Producer Cod
     C                     Z-ADDWACWNB    $HCWNB           TH Head Receive
     C                     Z-ADDWACYNB    $HCYNB           TH Live Wgt
     C                     Z-ADDWAF7NB    $HF7NB           TH Avg Live Wgt
     C                     Z-ADDWAECDT    $HECDT           TH Head LFT
     C                     Z-ADDWAEDDT    $HEDDT           TH Head EUT/KOA
     C                     Z-ADDWACXNB    $HCXNB           TH Dead On Arri
     C                     Z-ADDWAFCNB    $HFCNB           TH Yard Deads
     C                     Z-ADDWAOXNB    $HOXNB           TH HPS Movement
     C                     MOVELWAAGCD    $HAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $HKQTX           Farm site Name
     C                     MOVEL*BLANK    $HNYCD           PS Site ID
     C                     Z-ADD*ZERO     $HCCNB           Yard dead weigh
     C                     Z-ADDWAAWDT    $HAWDT           TH Purchase Dat
     C                     MOVELWABICD    $HBICD           TH Group Refere
     C                     MOVELWACPST    $HCPST           TH Live Purchas
     C                     Z-ADDWAACPR    $HACPR           TH Live Purchas
     C                     Z-ADDWAB9PR    $HB9PR           TH Live Gross A
     C                     Z-ADDWACAPR    $HCAPR           TH LIve Net Amt
     C                     MOVELWAC4ST    $HC4ST           TH Resale UOM
     C                     Z-ADDWAAIPR    $HAIPR           TH Recalc Live
     C                     Z-ADDWAA6DT    $HA6DT           TH Pricing Date
     C                     MOVELWAC2ST    $HC2ST           TH Resale Sprea
     C                     Z-ADDWAH9NB    $HH9NB           TH Held Over
     C                     Z-ADDWAFDNB    $HFDNB           TH Head Condemn
     C                     Z-ADDWAFENB    $HFENB           TH Head Killed
     C                     Z-ADDWAHENB    $HHENB           TH Head Adds
     C                     Z-ADDWAHFNB    $HHFNB           TH Head Accepte
     C                     Z-ADDWALRNB    $HLRNB           TH Adj Live Wgt
     C                     Z-ADDWAE0NB    $HE0NB           TH Hot Wgt
     C                     Z-ADDWAA5PC    $HA5PC           TH Tot Loin Eye
     C                     Z-ADDWAFBNB    $HFBNB           TH Tot Backfat
     C                     Z-ADDWAA4PC    $HA4PC           TH Tot Light Re
     C                     Z-ADDWAHDNB    $HHDNB           TH Avg Hot Wgt
     C                     Z-ADDWAF5NB    $HF5NB           TH Avg Light Re
     C                     Z-ADDWAF4NB    $HF4NB           TH Avg Lean Per
     C                     Z-ADDWAF3NB    $HF3NB           TH Avg Loin Eye
     C                     Z-ADDWAF2NB    $HF2NB           TH Avg Backfat
     C                     Z-ADDWAAVPC    $HAVPC           TH Std Yield Pe
     C                     Z-ADDWAAWPC    $HAWPC           TH Actual Yield
     C                     Z-ADDWACWPC    $HCWPC           TH Adj Actual Y
     C                     Z-ADDWAA8PC    $HA8PC           TH Yield Differ
     C                     Z-ADDWAA7PC    $HA7PC           TH Recalc Live
     C                     Z-ADDWAB8PR    $HB8PR           TH CM Market Pr
     C                     Z-ADDWAAMPR    $HAMPR           TH CM Base Mkt
     C                     Z-ADDWAANPR    $HANPR           TH CM Base Mkt
     C                     Z-ADDWAAYVA    $HAYVA           TH CM Sort Disc
     C                     Z-ADDWAAWVA    $HAWVA           TH CM Yield Gai
     C                     Z-ADDWAAOPR    $HAOPR           TH CM Base Carc
     C                     Z-ADDWAAXVA    $HAXVA           TH CM LN AddOn/
     C                     Z-ADDWAAPPR    $HAPPR           TH CM Carcass G
     C                     Z-ADDWAASPR    $HASPR           TH Deduction Am
     C                     Z-ADDWAA4VA    $HA4VA           TH Total Net WO
     C                     Z-ADDWAATPR    $HATPR           TH Carcass Net
     C                     Z-ADDWAA5VA    $HA5VA           TH Additions Am
     C                     Z-ADDWACBPR    $HCBPR           TH Payment Gros
     C                     Z-ADDWACCPR    $HCCPR           Th Payment Net
     C                     Z-ADDWALPNB    $HLPNB           TH AP Voucher/D
     C                     Z-ADDWACDPR    $HCDPR           TH Freight Amou
     C                     Z-ADDWAA7VA    $HA7VA           TH Accrual Amou
     C                     Z-ADDWAA2PR    $HA2PR           TH Fixed Cost A
     C                     MOVELWAJWST    $HJWST           TH Calc Net Sts
     C                     MOVELWACWST    $HCWST           TH Payment Sts
     C                     MOVELWAD7ST    $HD7ST           TH Header Error
     C                     MOVELWAD8ST    $HD8ST           TH Detail Error
     C                     MOVELWADWST    $HDWST           TH Kill Balanci
     C                     MOVELWAD6ST    $HD6ST           TH Bal to Kill
     C                     Z-ADDWAGHNB    $HGHNB           TH Commission A
     C                     Z-ADDWABYDT    $HBYDT           TH Voucher Paym
     C                     MOVELWAE0ST    $HE0ST           TH User Error O
     C                     MOVELWAE1ST    $HE1ST           TH Held Over Re
     C                     MOVELWAE2ST    $HE2ST           TH Sex
     C                     Z-ADDWABSDT    $HBSDT           TH Held/Ovr Com
     C                     Z-ADDWABTDT    $HBTDT           TH Commission P
     C                     Z-ADDWABUDT    $HBUDT           TH Actual Check
     C                     Z-ADDWAHGNB    $HHGNB           TH Shipped Weig
     C                     Z-ADDWAHHNB    $HHHNB           TH Avg Hot Wgt
     C                     Z-ADDWAHINB    $HHINB           TH FFLI
     C                     Z-ADDWAA3PR    $HA3PR           TH Kill Product
     C                     Z-ADDWAA4PR    $HA4PR           TH Cut Product
     C                     Z-ADDWAA6PR    $HA6PR           TH Render Produ
     C                     Z-ADDWAJ9NB    $HJ9NB           TH Head Exclude
     C                     Z-ADDWAD6PR    $HD6PR           TH CM Bse Mkt L
     C                     Z-ADDWAD7PR    $HD7PR           TH CM Bse Mkt C
     C                     Z-ADDWAD8PR    $HD8PR           TH CM Srt Dsc L
     C                     Z-ADDWAD9PR    $HD9PR           TH CM Srt Dsc C
     C                     Z-ADDWAEAPR    $HEAPR           TH CM Yld G/L L
     C                     Z-ADDWAEBPR    $HEBPR           TH CM Yld G/L C
     C                     Z-ADDWAECPR    $HECPR           TH CM Crc Val L
     C                     Z-ADDWAEDPR    $HEDPR           TH CM Crc Val C
     C                     Z-ADDWAEEPR    $HEEPR           TH CM Lean Prem
     C                     Z-ADDWAEFPR    $HEFPR           TH CM Lean Prem
     C                     Z-ADDWAEGPR    $HEGPR           TH CM Gross Liv
     C                     Z-ADDWAEHPR    $HEHPR           TH CM Gross Car
     C                     MOVELWAKAST    $HKAST           TH Source Type
     C                     MOVELWAJ7ST    $HJ7ST           TH Scale Ticket
     C                     MOVELWAJ9ST    $HJ9ST           TH Payment Type
     C                     MOVELWALKST    $HLKST           TH Source Code
     C                     MOVELWALLST    $HLLST           TH Hog Class Ty
     C                     MOVELWAJ8ST    $HJ8ST           TH Posted to HP
     C                     MOVELWALIST    $HLIST           TH Schedule Kil
     C                     MOVELWALJST    $HLJST           TH Shift Held O
     C                     MOVELWANZTX    $HNZTX           TH State
     C                     MOVELWAHJCD    $HHJCD           TH Unused Code
     C                     MOVELWAR4ST    $HR4ST           TH Unused Sts 2
     C                     MOVELWAR5ST    $HR5ST           TH Commission S
     C                     MOVELWAR6ST    $HR6ST           TH Paid 2 Week
     C                     MOVELWAR7ST    $HR7ST           TH Unused Sts 1
     C                     Z-ADDWATHWT    $HTHWT           TH DOA Weight
     C                     Z-ADDWAT2WT    $HT2WT           TH Avg Lean % E
     C                     Z-ADDWATHHD    $HTHHD           TH HPS Farm Sit
     C                     Z-ADDWAT2HD    $HT2HD           TH Shift Held O
     C                     Z-ADDWAOBPR    $HOBPR           TH Sorting Amou
     C                     Z-ADDWAKOER    $HKOER           TH Head Identif
     C                     Z-ADDWAOPIR    $HOPIR           TH Percent Iden
     C                     Z-ADDWAOPEM    $HOPEM           TH Percent Acce
     C                     Z-ADDWAIORP    $HIORP           TH Head Adjuste
     C                     Z-ADDWAOWEO    $HOWEO           TH PHA Head Add
     C                     MOVELWAOQET    $HOQET           TH PHA Add Type
     C                     MOVELWAURST    $HURST           TH PHA Average
     C                     MOVELWAUSST    $HUSST           TH PHA Add Reas
     C                     Z-ADDWAHHPC    $HHHPC           TH PHA Yield Pe
     C                     Z-ADDWAS9PR    $HS9PR           TH PHA Lean Prm
     C                     Z-ADDWATAPR    $HTAPR           TH VC Gross Val
     C                     Z-ADDWATBPR    $HTBPR           TH Excluded Gro
     C                     Z-ADDWAJFUR    $HJFUR           TH Avg Lean %
     C                     Z-ADDWAKRIF    $HKRIF           TH Broken Back
     C                     Z-ADDWAKORF    $HKORF           TH Hot Scl Uplo
     C                     Z-ADDWAKAPR    $HKAPR           TH Unused Nbr 4
     C                     Z-ADDWAKROT    $HKROT           TH Excluded Car
     C                     Z-ADDWAOTJG    $HOTJG           TH Excluded Pre
     C                     Z-ADDWAIRJG    $HIRJG           TH Unused Nbr 7
     C                     Z-ADDWAIMJF    $HIMJF           TH Unused Nbr 8
     C                     Z-ADDWAIRGF    $HIRGF           TH Unused Nbr 9
     C                     Z-ADDWAKRJF    $HKRJF           TH Unused Nbr 1
     C                     Z-ADDWAOJRF    $HOJRF           TH Break Even P
     C                     Z-ADDWAKFOR    $HKFOR           TH Meat Value F
     C                     Z-ADDWAORJK    $HORJK           TH Yld Parm Adj
     C                     Z-ADDWAOMVJ    $HOMVJ           TH PHA Sort Dis
     C                     Z-ADDWAMVNF    $HMVNF           TH Avg Loin Eye
     C                     Z-ADDWAMCNF    $HMCNF           TH Avg Backfat
     C                     Z-ADDWANCNF    $HNCNF           TH HITCH Old Pa
     C                     Z-ADDWANCHF    $HNCHF           TH MPR Sort Los
     C                     Z-ADDWAIGIR    $HIGIR           TH Unused Nbr 1
     C                     Z-ADDWAKFJR    $HKFJR           TH Unused Nbr 2
     C                     Z-ADDWAEADT    $HEADT           TH Cold Scl Upl
     C                     Z-ADDWAEBDT    $HEBDT           TH Cold Scl Upl
     C                     Z-ADDWAEEDT    $HEEDT           TH Unused Date
     C                     MOVELWAU4ST    $HU4ST           TH Unused Sts 1
     C                     MOVELWAU5ST    $HU5ST           TH Unused Sts 2
     C                     MOVELWAU6ST    $HU6ST           TH Unused Sts 3
     C                     MOVELWAU7ST    $HU7ST           TH Unused Sts 4
     C                     MOVELWAU8ST    $HU8ST           TH Unused Sts 5
     C                     MOVELWAU9ST    $HU9ST           TH Unused Sts 6
     C                     MOVELWAVAST    $HVAST           TH Unused Sts 7
     C                     MOVELWAVBST    $HVBST           TH Unused Sts 8
     C                     MOVELWABECD    $HBECD           HC Class Code
     C                     MOVELWABDCD    $HBDCD           DF Defect Code
     C                     MOVELWACSCD    $HCSCD           THP Process Cod
     C                     MOVELWAAECD    $HAECD           PL Location Cod
     C                     MOVELWAACCD    $HACCD           HB Buyer Code
     C                     MOVELWAAAVN    $HAAVN           RS User Changed
     C                     Z-ADDWAAADT    $HAADT           RS Date Changed
     C                     Z-ADDWAAMTM    $HAMTM           RS Time Changed
     C                     MOVELWAAJST    $HAJST           RS Record Statu
     C                     MOVELWAAHVN    $HAHVN           RS Job
     C                     MOVELWAAGVN    $HAGVN           RS Program
     C                     MOVELWAABVN    $HABVN           RS User Added
     C                     Z-ADDWAABDT    $HABDT           RS Date Added
     C                     Z-ADDWAABTM    $HABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UFSUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $HCWNB    $JWWNB           Head Received 1
     C                     ADD  $HCYNB    $JX5NB           Live Weight SUM
     C                     ADD  $HCXNB    $JB4NB           Head Total SUM
     C                     ADD  $HFCNB    $JXRNB           Head Total Sum2
     C                     ADD  $HCWNB    $JCDNB           Head held over
     C                     ADD  $HCYNB    $JQLNB           Live Weight 2 S
     C                     ADD  $HECDT    $JSRA1           LFT Head Total
     C                     ADD  $HEDDT    $JSSA1           EUT/KOA Head To
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAHMNB    WZC001           BOH Company Num
     C                     Z-ADDWAHMNB    WZC001
     C           *LIKE     DEFN WABNNB    WZC002           BOH Buy Order N
     C                     Z-ADDWABNNB    WZC002
     C           *LIKE     DEFN WABONB    WZC003           BOL Load Number
     C                     Z-ADDWABONB    WZC003
     C           *LIKE     DEFN WACVNB    WZC004           TH Tattoo Numbe
     C                     Z-ADDWACVNB    WZC004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@A1CPVF                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL03  1        TH Tattoo Numbe
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL02  1        BOL Load Number
     C                     MOVEL'Y'       W0CL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WAHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WABNNB    IFNE WZC002                     BOH Buy Order N
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WABONB    IFNE WZC003                     BOL Load Number
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WACVNB    IFNE WZC004                     TH Tattoo Numbe
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL03    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
      * USER: Process after print of TH Tattoo Number format
      * Accums for Received Head  totals
     C                     ADD  $JWWNB    $NWWNB           Head Received 1
     C                     ADD  $JX5NB    $NX5NB           Live Weight SUM
     C                     ADD  $JB4NB    $NB4NB           Head Total SUM
     C                     ADD  $JXRNB    $NXRNB           Head Total Sum2
      * Subtract from Accums for Less/Add Held Over totals
     C                     SUB  $JWWNB    WUCDNB           Head held over
     C                     SUB  $JX5NB    WUQLNB           Live Weight 2 S
     C                     ADD  $JSRA1    $NSRA1           LFT Head Total
     C                     ADD  $JSSA1    $NSSA1           EUT/KOA Head To
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKD01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKD02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKD03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKD04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKD05           TH Kill Date
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           BOH Company Num
     C                     KFLD           WQKD02           BOH Buy Order N
     C                     KFLD           WQKD03           BOL Load Number
     C                     KFLD           WQKD04           TH Tattoo Numbe
     C                     KFLD           WQKD05           TH Kill Date
      * Setup key
     C                     Z-ADD$JHMNB    WQKD01           BOH Company Num
     C                     Z-ADD$HBNNB    WQKD02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQKD03           BOL Load Number
     C                     Z-ADD$JCVNB    WQKD04           TH Tattoo Numbe
     C                     Z-ADD$JB0DT    WQKD05           TH Kill Date
      * Establish starting position
     C           KRSD      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL02  1        BOL Load Number
     C                     MOVEL'Y'       W0DL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0DL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP04  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $IHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $IBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $IBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $ICVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $IB0DT           TH Kill Date
     C                     MOVELDZBDCD    $IBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $IB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $IANTM           TST Wgt Time
     C                     MOVEL*BLANK    $IJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $ILJNB           TDF Head Defect
     C                     MOVELDZBECD    $IBECD           HC Class Code
     C                     MOVELDZB7SS    $IB7SS           TDF Classificat
     C                     MOVELDZB8SS    $IB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $IB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $ICASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $INXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $INYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $INZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $IAAVN           RS User Changed
     C                     Z-ADDDZAADT    $IAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $IAMTM           RS Time Changed
     C                     MOVELDZAJST    $IAJST           RS Record Statu
     C                     MOVELDZAHVN    $IAHVN           RS Job
     C                     MOVELDZAGVN    $IAGVN           RS Program
     C                     MOVELDZABVN    $IABVN           RS User Added
     C                     Z-ADDDZABDT    $IABDT           RS Date Added
     C                     Z-ADDDZABTM    $IABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZD001           BOH Company Num
     C                     Z-ADDDZHMNB    WZD001
     C           *LIKE     DEFN DZBNNB    WZD002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZD002
     C           *LIKE     DEFN DZBONB    WZD003           BOL Load Number
     C                     Z-ADDDZBONB    WZD003
     C           *LIKE     DEFN DZCVNB    WZD004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZD004
     C           *LIKE     DEFN DZB0DT    WZD005           TH Kill Date
     C                     Z-ADDDZB0DT    WZD005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR SURVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0DL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0DL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0DL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0DL04  1        TH Kill Date
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL02  1        BOL Load Number
     C                     MOVEL'Y'       W0DL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0DL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZD001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           DZBNNB    IFNE WZD002                     BOH Buy Order N
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           DZBONB    IFNE WZD003                     BOL Load Number
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           DZCVNB    IFNE WZD004                     TH Tattoo Numbe
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C           DZB0DT    IFNE WZD005                     TH Kill Date
     C           W0DL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL04
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP04
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         E0MAIN    BEGSR
      *================================================================
      * Prt Recvng f/Sub-Sum  PO: Mainline
      *================================================================
      * Prt Recvng f/Sub-Sum  PO: Initialise
     C                     EXSR ZEINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQKE01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQKE02           TH Kill Date
      * Define keylist
     C           KRSE      KLIST
     C                     KFLD           WQKE01           BOH Company Num
     C                     KFLD           WQKE02           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQKE01           BOH Company Num
     C                     Z-ADDWUB0DT    WQKE02           TH Kill Date
      * Establish starting position
     C           KRSE      SETLL@A1CPVE                    *
      * Read first record with user selection
     C                     EXSR E3READ
     C           W0EOFE    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0EL1P  1        First page
     C                     MOVEL'Y'       W0EL00  1        BOH Company Num
     C                     MOVEL'Y'       W0EL01  1        TH Kill Date
     C                     MOVEL'Y'       W0EL02  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0EL03  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ECDT
      * Print report body
     C           W0EOFE    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR E1PHDR
      * Print report detail line
     C                     EXSR E2PDTL
      * Read next record with user selection
     C                     EXSR E3READ
      * Print totals
     C                     EXSR E4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         E0EXIT    ENDSR
      /EJECT
     CSR         E1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0EL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP1P  1
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP00  1
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP01  1
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADD*ZERO     $MSSA1           EUT/KOA Head To
     C                     Z-ADD*ZERO     $MSRA1           LFT Head Total
     C                     Z-ADDWBHMNB    $MHMNB           BOH Company Num
     C                     Z-ADDWBB0DT    $MB0DT           TH Kill Date
     C                     MOVELWBLLST    $MLLST           TH Hog Class Ty
     C                     Z-ADD*ZERO     $MWWNB           Head Received 1
     C                     Z-ADD*ZERO     $MX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $MB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $MXRNB           Head Total Sum2
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP02  1
     C                     END
      *
     C           W0EL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EP03  1
     C                     END
      *
      *================================================================
     CSR         E1EXIT    ENDSR
      /EJECT
     CSR         E2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHMNB    $KHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $KBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $KBONB           BOL Load Number
     C                     Z-ADDWBB0DT    $KB0DT           TH Kill Date
     C                     Z-ADDWBCVNB    $KCVNB           TH Tattoo Numbe
     C                     MOVELWBABCD    $KABCD           PD Producer Cod
     C                     Z-ADDWBCWNB    $KCWNB           TH Head Receive
     C                     Z-ADDWBCYNB    $KCYNB           TH Live Wgt
     C                     Z-ADDWBF7NB    $KF7NB           TH Avg Live Wgt
     C                     Z-ADDWBECDT    $KECDT           TH Head LFT
     C                     Z-ADDWBEDDT    $KEDDT           TH Head EUT/KOA
     C                     Z-ADDWBCXNB    $KCXNB           TH Dead On Arri
     C                     Z-ADDWBFCNB    $KFCNB           TH Yard Deads
     C                     Z-ADDWBOXNB    $KOXNB           TH HPS Movement
     C                     MOVELWBAGCD    $KAGCD           GN Genetic Code
     C                     MOVEL*BLANK    $KKQTX           Farm site Name
     C                     MOVEL*BLANK    $KNYCD           PS Site ID
     C                     Z-ADD*ZERO     $KCCNB           Yard dead weigh
     C                     Z-ADDWBAWDT    $KAWDT           TH Purchase Dat
     C                     MOVELWBBICD    $KBICD           TH Group Refere
     C                     MOVELWBCPST    $KCPST           TH Live Purchas
     C                     Z-ADDWBACPR    $KACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    $KB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    $KCAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    $KC4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    $KAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    $KA6DT           TH Pricing Date
     C                     MOVELWBC2ST    $KC2ST           TH Resale Sprea
     C                     Z-ADDWBH9NB    $KH9NB           TH Held Over
     C                     Z-ADDWBFDNB    $KFDNB           TH Head Condemn
     C                     Z-ADDWBFENB    $KFENB           TH Head Killed
     C                     Z-ADDWBHENB    $KHENB           TH Head Adds
     C                     Z-ADDWBHFNB    $KHFNB           TH Head Accepte
     C                     Z-ADDWBLRNB    $KLRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    $KE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    $KA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    $KFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    $KA4PC           TH Tot Light Re
     C                     Z-ADDWBHDNB    $KHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    $KF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    $KF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $KF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $KF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    $KAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    $KAWPC           TH Actual Yield
     C                     Z-ADDWBCWPC    $KCWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    $KA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    $KA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    $KB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    $KAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    $KANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    $KAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    $KAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    $KAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    $KAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    $KAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    $KASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    $KA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    $KATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    $KA5VA           TH Additions Am
     C                     Z-ADDWBCBPR    $KCBPR           TH Payment Gros
     C                     Z-ADDWBCCPR    $KCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    $KLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    $KCDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    $KA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    $KA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    $KJWST           TH Calc Net Sts
     C                     MOVELWBCWST    $KCWST           TH Payment Sts
     C                     MOVELWBD7ST    $KD7ST           TH Header Error
     C                     MOVELWBD8ST    $KD8ST           TH Detail Error
     C                     MOVELWBDWST    $KDWST           TH Kill Balanci
     C                     MOVELWBD6ST    $KD6ST           TH Bal to Kill
     C                     Z-ADDWBGHNB    $KGHNB           TH Commission A
     C                     Z-ADDWBBYDT    $KBYDT           TH Voucher Paym
     C                     MOVELWBE0ST    $KE0ST           TH User Error O
     C                     MOVELWBE1ST    $KE1ST           TH Held Over Re
     C                     MOVELWBE2ST    $KE2ST           TH Sex
     C                     Z-ADDWBBSDT    $KBSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    $KBTDT           TH Commission P
     C                     Z-ADDWBBUDT    $KBUDT           TH Actual Check
     C                     Z-ADDWBHGNB    $KHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    $KHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    $KHINB           TH FFLI
     C                     Z-ADDWBA3PR    $KA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    $KA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    $KA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    $KJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    $KD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    $KD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    $KD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    $KD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    $KEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    $KEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    $KECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    $KEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    $KEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    $KEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    $KEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    $KEHPR           TH CM Gross Car
     C                     MOVELWBKAST    $KKAST           TH Source Type
     C                     MOVELWBJ7ST    $KJ7ST           TH Scale Ticket
     C                     MOVELWBJ9ST    $KJ9ST           TH Payment Type
     C                     MOVELWBLKST    $KLKST           TH Source Code
     C                     MOVELWBLLST    $KLLST           TH Hog Class Ty
     C                     MOVELWBJ8ST    $KJ8ST           TH Posted to HP
     C                     MOVELWBLIST    $KLIST           TH Schedule Kil
     C                     MOVELWBLJST    $KLJST           TH Shift Held O
     C                     MOVELWBNZTX    $KNZTX           TH State
     C                     MOVELWBHJCD    $KHJCD           TH Unused Code
     C                     MOVELWBR4ST    $KR4ST           TH Unused Sts 2
     C                     MOVELWBR5ST    $KR5ST           TH Commission S
     C                     MOVELWBR6ST    $KR6ST           TH Paid 2 Week
     C                     MOVELWBR7ST    $KR7ST           TH Unused Sts 1
     C                     Z-ADDWBTHWT    $KTHWT           TH DOA Weight
     C                     Z-ADDWBT2WT    $KT2WT           TH Avg Lean % E
     C                     Z-ADDWBTHHD    $KTHHD           TH HPS Farm Sit
     C                     Z-ADDWBT2HD    $KT2HD           TH Shift Held O
     C                     Z-ADDWBOBPR    $KOBPR           TH Sorting Amou
     C                     Z-ADDWBKOER    $KKOER           TH Head Identif
     C                     Z-ADDWBOPIR    $KOPIR           TH Percent Iden
     C                     Z-ADDWBOPEM    $KOPEM           TH Percent Acce
     C                     Z-ADDWBIORP    $KIORP           TH Head Adjuste
     C                     Z-ADDWBOWEO    $KOWEO           TH PHA Head Add
     C                     MOVELWBOQET    $KOQET           TH PHA Add Type
     C                     MOVELWBURST    $KURST           TH PHA Average
     C                     MOVELWBUSST    $KUSST           TH PHA Add Reas
     C                     Z-ADDWBHHPC    $KHHPC           TH PHA Yield Pe
     C                     Z-ADDWBS9PR    $KS9PR           TH PHA Lean Prm
     C                     Z-ADDWBTAPR    $KTAPR           TH VC Gross Val
     C                     Z-ADDWBTBPR    $KTBPR           TH Excluded Gro
     C                     Z-ADDWBJFUR    $KJFUR           TH Avg Lean %
     C                     Z-ADDWBKRIF    $KKRIF           TH Broken Back
     C                     Z-ADDWBKORF    $KKORF           TH Hot Scl Uplo
     C                     Z-ADDWBKAPR    $KKAPR           TH Unused Nbr 4
     C                     Z-ADDWBKROT    $KKROT           TH Excluded Car
     C                     Z-ADDWBOTJG    $KOTJG           TH Excluded Pre
     C                     Z-ADDWBIRJG    $KIRJG           TH Unused Nbr 7
     C                     Z-ADDWBIMJF    $KIMJF           TH Unused Nbr 8
     C                     Z-ADDWBIRGF    $KIRGF           TH Unused Nbr 9
     C                     Z-ADDWBKRJF    $KKRJF           TH Unused Nbr 1
     C                     Z-ADDWBOJRF    $KOJRF           TH Break Even P
     C                     Z-ADDWBKFOR    $KKFOR           TH Meat Value F
     C                     Z-ADDWBORJK    $KORJK           TH Yld Parm Adj
     C                     Z-ADDWBOMVJ    $KOMVJ           TH PHA Sort Dis
     C                     Z-ADDWBMVNF    $KMVNF           TH Avg Loin Eye
     C                     Z-ADDWBMCNF    $KMCNF           TH Avg Backfat
     C                     Z-ADDWBNCNF    $KNCNF           TH HITCH Old Pa
     C                     Z-ADDWBNCHF    $KNCHF           TH MPR Sort Los
     C                     Z-ADDWBIGIR    $KIGIR           TH Unused Nbr 1
     C                     Z-ADDWBKFJR    $KKFJR           TH Unused Nbr 2
     C                     Z-ADDWBEADT    $KEADT           TH Cold Scl Upl
     C                     Z-ADDWBEBDT    $KEBDT           TH Cold Scl Upl
     C                     Z-ADDWBEEDT    $KEEDT           TH Unused Date
     C                     MOVELWBU4ST    $KU4ST           TH Unused Sts 1
     C                     MOVELWBU5ST    $KU5ST           TH Unused Sts 2
     C                     MOVELWBU6ST    $KU6ST           TH Unused Sts 3
     C                     MOVELWBU7ST    $KU7ST           TH Unused Sts 4
     C                     MOVELWBU8ST    $KU8ST           TH Unused Sts 5
     C                     MOVELWBU9ST    $KU9ST           TH Unused Sts 6
     C                     MOVELWBVAST    $KVAST           TH Unused Sts 7
     C                     MOVELWBVBST    $KVBST           TH Unused Sts 8
     C                     MOVELWBBECD    $KBECD           HC Class Code
     C                     MOVELWBBDCD    $KBDCD           DF Defect Code
     C                     MOVELWBCSCD    $KCSCD           THP Process Cod
     C                     MOVELWBAECD    $KAECD           PL Location Cod
     C                     MOVELWBACCD    $KACCD           HB Buyer Code
     C                     MOVELWBAAVN    $KAAVN           RS User Changed
     C                     Z-ADDWBAADT    $KAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $KAMTM           RS Time Changed
     C                     MOVELWBAJST    $KAJST           RS Record Statu
     C                     MOVELWBAHVN    $KAHVN           RS Job
     C                     MOVELWBAGVN    $KAGVN           RS Program
     C                     MOVELWBABVN    $KABVN           RS User Added
     C                     Z-ADDWBABDT    $KABDT           RS Date Added
     C                     Z-ADDWBABTM    $KABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0EPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * PRTOBJ calls after print of detail format
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
     C                     EXSR UISUBR                     Embedded PRTOBJ
      * USER: Process after print of detail format
     C                     ADD  $KCWNB    $MWWNB           Head Received 1
     C                     ADD  $KCYNB    $MX5NB           Live Weight SUM
      * doa
     C                     ADD  $KCXNB    $MB4NB           Head Total SUM
     C                     ADD  $KFCNB    $MXRNB           Head Total Sum2
     C                     ADD  $KECDT    $MSRA1           LFT Head Total
     C                     ADD  $KEDDT    $MSSA1           EUT/KOA Head To
      *
      *================================================================
     CSR         E2EXIT    ENDSR
      /EJECT
     CSR         E3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHMNB    WZE001           BOH Company Num
     C                     Z-ADDWBHMNB    WZE001
     C           *LIKE     DEFN WBB0DT    WZE002           TH Kill Date
     C                     Z-ADDWBB0DT    WZE002
     C           *LIKE     DEFN WBLLST    WZE003           TH Hog Class Ty
     C                     MOVELWBLLST    WZE003
     C           *LIKE     DEFN WBCVNB    WZE004           TH Tattoo Numbe
     C                     Z-ADDWBCVNB    WZE004
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFE    OREQ '1'
     C           KRSE      READE@A1CPVE                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFE  1
      * Quit if no record read
     C           W0EOFE    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Hog Class Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Hog Class Type EQ PAR.TH Hog Class Type
      *   '-
     C           P1LLST    IFEQ WUCRTX                     *IF
     C           WBLLST    OREQ P1LLST                     *OR
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.TH Source Type EQ WRK.Blank USR
      *   |- c2    : DB1.TH Source Type EQ PAR.TH Source Type
      *   '-
     C           P1KAST    IFEQ WUCRTX                     *IF
     C           WBKAST    OREQ P1KAST                     *OR
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0EL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0EL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0EL02  1        TH Hog Class Ty
     C                     MOVEL*BLANK    W0EL03  1        TH Tattoo Numbe
     C           W0EOFE    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0EL00  1        BOH Company Num
     C                     MOVEL'Y'       W0EL01  1        TH Kill Date
     C                     MOVEL'Y'       W0EL02  1        TH Hog Class Ty
     C                     MOVEL'Y'       W0EL03  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHMNB    IFNE WZE001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL00
     C                     END
     C           WBB0DT    IFNE WZE002                     TH Kill Date
     C           W0EL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL01
     C                     END
     C           WBLLST    IFNE WZE003                     TH Hog Class Ty
     C           W0EL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL02
     C                     END
     C           WBCVNB    IFNE WZE004                     TH Tattoo Numbe
     C           W0EL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0EL03
     C                     END
     C                     END
      *================================================================
     CSR         E3EXIT    ENDSR
      /EJECT
     CSR         E4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0EL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP03
     C                     END
      *
     C           W0EL02    IFEQ 'Y'
      * Mention hidden format
     C   99N99             WRITE$MKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP02
      * USER: Process after print of TH Hog Class Type format
     C                     ADD  $MWWNB    $NWWNB           Head Received 1
     C                     ADD  $MX5NB    $NX5NB           Live Weight SUM
     C                     ADD  $MB4NB    $NB4NB           Head Total SUM
     C                     ADD  $MXRNB    $NXRNB           Head Total Sum2
     C                     ADD  $MSRA1    $NSRA1           LFT Head Total
     C                     ADD  $MSSA1    $NSSA1           EUT/KOA Head To
     C                     END
      *
     C           W0EL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP01
     C                     END
      *
     C           W0EL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0EP00
     C                     END
      *
     C           W0EOFE    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         E4EXIT    ENDSR
      /EJECT
     CSR         F0MAIN    BEGSR
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN DZHMNB    WQKF01           BOH Company Num
     C           *LIKE     DEFN DZBNNB    WQKF02           BOH Buy Order N
     C           *LIKE     DEFN DZBONB    WQKF03           BOL Load Number
     C           *LIKE     DEFN DZCVNB    WQKF04           TH Tattoo Numbe
     C           *LIKE     DEFN DZB0DT    WQKF05           TH Kill Date
      * Define keylist
     C           KRSF      KLIST
     C                     KFLD           WQKF01           BOH Company Num
     C                     KFLD           WQKF02           BOH Buy Order N
     C                     KFLD           WQKF03           BOL Load Number
     C                     KFLD           WQKF04           TH Tattoo Numbe
     C                     KFLD           WQKF05           TH Kill Date
      * Setup key
     C                     Z-ADD$MHMNB    WQKF01           BOH Company Num
     C                     Z-ADD$KBNNB    WQKF02           BOH Buy Order N
     C                     Z-ADD$KBONB    WQKF03           BOL Load Number
     C                     Z-ADD$KCVNB    WQKF04           TH Tattoo Numbe
     C                     Z-ADD$MB0DT    WQKF05           TH Kill Date
      * Establish starting position
     C           KRSF      SETLL@DZREX3                    *
      * Read first record with user selection
     C                     EXSR F3READ
     C           W0EOFF    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0FL1P  1        First page
     C                     MOVEL'Y'       W0FL00  1        BOH Company Num
     C                     MOVEL'Y'       W0FL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0FL02  1        BOL Load Number
     C                     MOVEL'Y'       W0FL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0FL04  1        TH Kill Date
      * Set column headings flag
     C                     MOVE 'Y'       W0FCDT
      * Print report body
     C           W0EOFF    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR F1PHDR
      * Print report detail line
     C                     EXSR F2PDTL
      * Read next record with user selection
     C                     EXSR F3READ
      * Print totals
     C                     EXSR F4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         F0EXIT    ENDSR
      /EJECT
     CSR         F1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0FL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP1P  1
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP00  1
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP01  1
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP02  1
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP03  1
     C                     END
      *
     C           W0FL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FP04  1
     C                     END
      *
      *================================================================
     CSR         F1EXIT    ENDSR
      /EJECT
     CSR         F2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDDZHMNB    $LHMNB           BOH Company Num
     C                     Z-ADDDZBNNB    $LBNNB           BOH Buy Order N
     C                     Z-ADDDZBONB    $LBONB           BOL Load Number
     C                     Z-ADDDZCVNB    $LCVNB           TH Tattoo Numbe
     C                     Z-ADDDZB0DT    $LB0DT           TH Kill Date
     C                     MOVELDZBDCD    $LBDCD           DF Defect Code
     C                     Z-ADD*ZERO     $LB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $LANTM           TST Wgt Time
     C                     MOVEL*BLANK    $LJSTX           Defect Desc 10
     C                     Z-ADDDZLJNB    $LLJNB           TDF Head Defect
     C                     MOVELDZBECD    $LBECD           HC Class Code
     C                     MOVELDZB7SS    $LB7SS           TDF Classificat
     C                     MOVELDZB8SS    $LB8SS           TDF Unused Sts
     C                     MOVELDZB9SS    $LB9SS           TDF Unused Sts
     C                     MOVELDZCASS    $LCASS           TDF Unused Sts
     C                     Z-ADDDZNXA1    $LNXA1           TDF Unused Nbr
     C                     Z-ADDDZNYA1    $LNYA1           TDF Unused Nbr
     C                     Z-ADDDZNZA1    $LNZA1           TDF Unused Nbr
     C                     MOVELDZAAVN    $LAAVN           RS User Changed
     C                     Z-ADDDZAADT    $LAADT           RS Date Changed
     C                     Z-ADDDZAMTM    $LAMTM           RS Time Changed
     C                     MOVELDZAJST    $LAJST           RS Record Statu
     C                     MOVELDZAHVN    $LAHVN           RS Job
     C                     MOVELDZAGVN    $LAGVN           RS Program
     C                     MOVELDZABVN    $LABVN           RS User Added
     C                     Z-ADDDZABDT    $LABDT           RS Date Added
     C                     Z-ADDDZABTM    $LABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0FPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         F2EXIT    ENDSR
      /EJECT
     CSR         F3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN DZHMNB    WZF001           BOH Company Num
     C                     Z-ADDDZHMNB    WZF001
     C           *LIKE     DEFN DZBNNB    WZF002           BOH Buy Order N
     C                     Z-ADDDZBNNB    WZF002
     C           *LIKE     DEFN DZBONB    WZF003           BOL Load Number
     C                     Z-ADDDZBONB    WZF003
     C           *LIKE     DEFN DZCVNB    WZF004           TH Tattoo Numbe
     C                     Z-ADDDZCVNB    WZF004
     C           *LIKE     DEFN DZB0DT    WZF005           TH Kill Date
     C                     Z-ADDDZB0DT    WZF005
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFF    OREQ '1'
     C           KRSF      READE@DZREX3                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFF  1
      * Quit if no record read
     C           W0EOFF    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
     C                     MOVEL'N'       W0RSL            *Record selecte
      * Rtv Hog Class Type    RT - Hog Classification  * 
     C                     EXSR TFRVGN
      * CASE: LCL.HC Class Type is Resale
     C           YL0006    IFEQ 'R'                        *IF
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0FL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0FL01  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0FL02  1        BOL Load Number
     C                     MOVEL*BLANK    W0FL03  1        TH Tattoo Numbe
     C                     MOVEL*BLANK    W0FL04  1        TH Kill Date
     C           W0EOFF    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0FL00  1        BOH Company Num
     C                     MOVEL'Y'       W0FL01  1        BOH Buy Order N
     C                     MOVEL'Y'       W0FL02  1        BOL Load Number
     C                     MOVEL'Y'       W0FL03  1        TH Tattoo Numbe
     C                     MOVEL'Y'       W0FL04  1        TH Kill Date
     C                     ELSE
      * Next record - Detect level breaks
     C           DZHMNB    IFNE WZF001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL00
     C                     END
     C           DZBNNB    IFNE WZF002                     BOH Buy Order N
     C           W0FL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL01
     C                     END
     C           DZBONB    IFNE WZF003                     BOL Load Number
     C           W0FL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL02
     C                     END
     C           DZCVNB    IFNE WZF004                     TH Tattoo Numbe
     C           W0FL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL03
     C                     END
     C           DZB0DT    IFNE WZF005                     TH Kill Date
     C           W0FL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0FL04
     C                     END
     C                     END
      *================================================================
     CSR         F3EXIT    ENDSR
      /EJECT
     CSR         F4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0FL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP04
     C                     END
      *
     C           W0FL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP03
     C                     END
      *
     C           W0FL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP02
     C                     END
      *
     C           W0FL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP01
     C                     END
      *
     C           W0FL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0FP00
     C                     END
      *
     C           W0EOFF    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         F4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Receiving Rpt-Sum PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Receiving Rpt-Sum PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1HMNB    $CHMNB           BOH Company Num
     C                     Z-ADDP3B3DT    $CB3DT           Date From USR
     C                     Z-ADDP4B4DT    $CB4DT           Date To   USR
     C                     MOVELP5AACD    $CAACD           SR Source Code
     C                     MOVELP7XHST    $CXHST           DT Load Type
     C                     MOVELP1LLST    $CLLST           TH Hog Class Ty
     C                     MOVELP1KAST    $CIXST           SR Type
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $CHMNB    WQ0007  30       CC Company Numb
     C           $CBSTX    PARM *BLANK    WQ0008 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0009  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD$CHMNB    ZA0001           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
      * Hog Class Type Description
      * CASE: 1PG.TH Hog Class Type NE WRK.Blank USR
     C           $CLLST    IFNE WUCRTX                     *IF
      * 1PG.Description 30 USR = Condition name of 1PG.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $CLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CKKTX           Description 30
     C                     MOVEL'ALL'     $CKKTX           Description 30
     C                     END                             *FI
      * SR Type Description
      * CASE: 1PG.SR Type NE WRK.Blank USR
     C           $CIXST    IFNE WUCRTX                     *IF
      * 1PG.SR Type Desc = Condition name of 1PG.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM $CIXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CISTX    PARM           W0CNNM 25        SR Type Desc
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $CISTX           SR Type Desc
     C                     MOVEL'ALL'     $CISTX           SR Type Desc
     C                     END                             *FI
      * E11245 JJH 07/24/17 - Display SR Source Code and SR Source Desc
      * SR Description
      * CASE: PAR.SR Source Code is EQ Blank
     C           P5AACD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CAFTX           SR Description
     C                     MOVEL'ALL'     $CAFTX           SR Description
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Source Desc       RT - Source  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * ELDTYPE JBB 10/26/17 - Add Load Type Selection
      * Load Type
      * CASE: PAR.DT Load Type is Not Entered
     C           P7XHST    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $CEVT1           Load Type Descr
     C                     MOVEL'ALL'     $CEVT1           Load Type Descr
     C                     ELSE
      * CASE: *OTHERWISE
      * 1PG.Load Type Description USR = Condition name of 1PG.DT Load Typ
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1309802   Y2LSNO  70       List number
     C                     PARM $CXHST    W0INVL 25        DT Load Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $CEVT1    PARM           W0CNNM 25        Load Type Descr
      *
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Date From USR to display format
      * Convert date
     C           1000000   ADD  $CB3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCB3DT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  $CB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VCB4DT
     C                     MOVEL'0'       *IN79
     C           P6MFST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$C1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Receiving Rpt-Sum PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print TH Hog Class Type of Prt Receiving Rpt-Sum PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Hog Class Type format
      * CUR.Description 30 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $DLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $DKKTX    PARM           W0CNNM 25        Description 30
      *
     C                     MOVEL$DLLST    WULLST           TH Hog Class Ty
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$DKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print TH Kill Date of Prt Receiving Rpt-Sum PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * USER: On print of TH Kill Date format
     C                     Z-ADD$EB0DT    WUB0DT           TH Kill Date
      * Mention hidden format
     C   99N99             WRITE$EKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Receiving Rpt-Sum PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print Detail line. of Prt Receiving Rpt-Sum PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Suppress line if tattoo is completely held over
      * CASE:
      *  - c1 AND c2 AND c3 AND c4 AND c5
      *   |- c1    : CUR.TH Head Received is *Zeros
      *   |- c2    : CUR.TH Yard Deads is Zero
      *   |- c3    : CUR.TH Dead On Arrival is *Zeros
      *   |- c4    : CUR.TH Head LFT is *ZEROS
      *   |- c5    : CUR.TH Head EUT/KOA is *ZEROS
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $FCWNB    IFEQ *ZERO                      *IF
     C           $FFCNB    IFEQ *ZERO                      *IF
     C           $FCXNB    IFEQ *ZERO                      *IF
     C           $FECDT    IFEQ 0                          *IF
     C           $FEDDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * If Tattoo WAS held over from previous day
      * CASE: CUR.TH Held Over Record is Yes
     C           $FE1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'H+'      $FNGST           @Status (Held o
     C                     END                             *FI
      * Calc avg live wgt -- we want this to exclude the held over hogs
      * CASE: CUR.TH Head Received is Not Zero
     C           $FCWNB    IFNE *ZERO                      *IF
     C           $FCYNB    DIV  $FCWNB    $FOVNB           Avg Live Wgt Us
     C                     END                             *FI
      * Tattoo Reference
      * CASE: CUR.TH Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0003    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * 10/27/21 slm farm was losing the 4 position due to 3 digit logic
      * Replace 3.0 farm with 5.0 farm
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0010  7        *Return code
     C                     PARM A1OXNB    WQ0011  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0012 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0013  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0014  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0015  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0004           Farm Site 5.0 U
     C                     MOVELYL0004    $FKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0001  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0002  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0003  5        Building 1 USR
     C                     MOVEL*BLANK    WN0004  5        Room 1 USR
     C                     MOVEL*BLANK    WN0005  5        Building 2 USR
     C                     MOVEL*BLANK    WN0006  5        Room 2 USR
     C                     MOVEL*BLANK    WN0007  5        Building 3 USR
     C                     MOVEL*BLANK    WN0008  5        Room 3 USR
     C                     MOVEL*BLANK    WN0009  1        Status 1
     C                     MOVEL*BLANK    WN0010  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0011  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0012  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SBRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0003    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ':':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0003:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0004:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0010    CAT  WN0003:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0004:ZQ $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0005    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0005:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0006:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0011:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0005:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0006:ZQ $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0007    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0007:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0008:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $FKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0009    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  '+':ZQ    $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0003    IFEQ 'Y'                        *IF
     C                     Z-ADDA1THHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM A1THHD    WQ0016  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0017  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $FKQTX           Farm site Name
     C                     MOVELWUWWTX    $FKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0013  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0014  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0015  5        Building 1 USR
     C                     MOVEL*BLANK    WN0016  5        Room 1 USR
     C                     MOVEL*BLANK    WN0017  5        Building 2 USR
     C                     MOVEL*BLANK    WN0018  5        Room 2 USR
     C                     MOVEL*BLANK    WN0019  5        Building 3 USR
     C                     MOVEL*BLANK    WN0020  5        Room 3 USR
     C                     MOVEL*BLANK    WN0021  1        Status 1
     C                     MOVEL*BLANK    WN0022  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0023  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0024  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SDRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0015    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ':':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0015:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0016:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0022    CAT  WN0015:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0016:ZQ $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0017    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0017:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0018:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0023:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0017:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0018:ZQ $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0019    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0019:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0020:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $FKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0021    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  '+':ZQ    $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 3/02/04 RMC
      * CASE: CUR.TH Group Reference is Entered
     C           $FBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $FKQTX           Farm site Name
     C                     MOVEL$FBICD    $FKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0025  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0026  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0027  5        Building 1 USR
     C                     MOVEL*BLANK    WN0028  5        Room 1 USR
     C                     MOVEL*BLANK    WN0029  5        Building 2 USR
     C                     MOVEL*BLANK    WN0030  5        Room 2 USR
     C                     MOVEL*BLANK    WN0031  5        Building 3 USR
     C                     MOVEL*BLANK    WN0032  5        Room 3 USR
     C                     MOVEL*BLANK    WN0033  1        Status 1
     C                     MOVEL*BLANK    WN0034  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0035  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0036  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SFRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0027    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ':':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0027:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0028:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0034    CAT  WN0027:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0028:ZQ $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0029    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0029:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0030:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0035:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0029:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0030:ZQ $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0031    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  ';':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  WN0031:ZQ $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  '/':ZQ    $FKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $FKQTX    CAT  WN0032:ZQ $FKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $FKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0033    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $FKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $FKQTX    CAT  '+':ZQ    $FKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           $FFCNB    MULT $FOVNB    $FCCNB           Yard dead weigh
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
      * 12/12/12 E02361 IF EXTERNAL AND NO HPS then use the
      * producer site information
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SHRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $FB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VFB0DT
     C                     MOVEL'0'       *IN79
     C           $FNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$FCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$FDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR SIRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR SJRVGN
     C                     MOVELWUBCTX    $GJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $GB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VGB6DT
      * Print column headings if required
     C           W0BCDT    IFEQ 'Y'
     C                     WRITE$GCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0BCDT
     C                     END                             FI
      * Print format
     C                     WRITE$GDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt Recvng f/Hld-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Recvng f/Hld-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Recvng f/Hld-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print BOL Load Number of Prt Recvng f/Hld-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Recvng f/Hld-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print Detail line. of Prt Recvng f/Hld-Sum  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVEL'H-'      $HNGST           @Status (Held o
      * Tattoo Reference
      * CASE: CUR.TH Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0009    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0024  7        *Return code
     C                     PARM WAOXNB    WQ0025  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0026 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0027  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0028  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0029  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0010           Farm Site 3.0 U
     C                     MOVELYL0010    $HKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0037  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0038  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0039  5        Building 1 USR
     C                     MOVEL*BLANK    WN0040  5        Room 1 USR
     C                     MOVEL*BLANK    WN0041  5        Building 2 USR
     C                     MOVEL*BLANK    WN0042  5        Room 2 USR
     C                     MOVEL*BLANK    WN0043  5        Building 3 USR
     C                     MOVEL*BLANK    WN0044  5        Room 3 USR
     C                     MOVEL*BLANK    WN0045  1        Status 1
     C                     MOVEL*BLANK    WN0046  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0047  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0048  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SLRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0039    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ':':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0039:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0040:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0046    CAT  WN0039:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0040:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0041    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0041:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0042:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0047:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0041:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0042:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0043    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0043:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0044:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $HKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0045    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  '+':ZQ    $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0009    IFEQ 'Y'                        *IF
     C                     Z-ADDWATHHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM WATHHD    WQ0030  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0031  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $HKQTX           Farm site Name
     C                     MOVELWUWWTX    $HKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0049  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0050  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0051  5        Building 1 USR
     C                     MOVEL*BLANK    WN0052  5        Room 1 USR
     C                     MOVEL*BLANK    WN0053  5        Building 2 USR
     C                     MOVEL*BLANK    WN0054  5        Room 2 USR
     C                     MOVEL*BLANK    WN0055  5        Building 3 USR
     C                     MOVEL*BLANK    WN0056  5        Room 3 USR
     C                     MOVEL*BLANK    WN0057  1        Status 1
     C                     MOVEL*BLANK    WN0058  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0059  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0060  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SNRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0051    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ':':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0051:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0052:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0058    CAT  WN0051:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0052:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0053    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0053:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0054:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0059:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0053:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0054:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0055    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0055:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0056:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $HKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0057    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  '+':ZQ    $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 3/02/04 RMC
      * CASE: CUR.TH Group Reference is Entered
     C           $HBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $HKQTX           Farm site Name
     C                     MOVEL$HBICD    $HKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0061  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0062  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0063  5        Building 1 USR
     C                     MOVEL*BLANK    WN0064  5        Room 1 USR
     C                     MOVEL*BLANK    WN0065  5        Building 2 USR
     C                     MOVEL*BLANK    WN0066  5        Room 2 USR
     C                     MOVEL*BLANK    WN0067  5        Building 3 USR
     C                     MOVEL*BLANK    WN0068  5        Room 3 USR
     C                     MOVEL*BLANK    WN0069  1        Status 1
     C                     MOVEL*BLANK    WN0070  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0071  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0072  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SPRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0063    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ':':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0063:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0064:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0070    CAT  WN0063:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0064:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0065    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0065:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0066:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0071:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0065:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0066:ZQ $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0067    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  ';':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  WN0067:ZQ $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  '/':ZQ    $HKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $HKQTX    CAT  WN0068:ZQ $HKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $HKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0069    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $HKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $HKQTX    CAT  '+':ZQ    $HKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           $HFCNB    MULT $HF7NB    $HCCNB           Yard dead weigh
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SRRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $HB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VHB0DT
     C                     MOVEL'0'       *IN79
     C           $HNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0CCDT    IFEQ 'Y'
     C                     WRITE$HCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0CCDT
     C                     END                             FI
      * Print format
     C                     WRITE$HDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR SSRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR STRVGN
     C                     MOVELWUBCTX    $IJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $IB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VIB6DT
      * Print column headings if required
     C           W0DCDT    IFEQ 'Y'
     C                     WRITE$ICOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0DCDT
     C                     END                             FI
      * Print format
     C                     WRITE$IDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Print First Page Format of Prt Recvng f/Sub-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0EL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Recvng f/Sub-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP00
     C                     END                             FI
      * Print TH Kill Date of Prt Recvng f/Sub-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP01
     C                     END                             FI
      * Print TH Hog Class Type of Prt Recvng f/Sub-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Recvng f/Sub-Sum  PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0EP03
     C                     END                             FI
      * Print Detail line. of Prt Recvng f/Sub-Sum  PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ECDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0EPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0EPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * Tattoo Reference
      * CASE: CUR.TH Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0012    IFEQ 'N'                        *IF
      * * 01/27/03 PKD PK0495 Replaced HP255 with HP249.
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           WULMST    PARM WULMST    WQ0035  7        *Return code
     C                     PARM WBOXNB    WQ0036  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0037 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0038  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0039  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0040  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUETNB    YL0013           Farm Site 3.0 U
     C                     MOVELYL0013    $KKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0073  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0074  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0075  5        Building 1 USR
     C                     MOVEL*BLANK    WN0076  5        Room 1 USR
     C                     MOVEL*BLANK    WN0077  5        Building 2 USR
     C                     MOVEL*BLANK    WN0078  5        Room 2 USR
     C                     MOVEL*BLANK    WN0079  5        Building 3 USR
     C                     MOVEL*BLANK    WN0080  5        Room 3 USR
     C                     MOVEL*BLANK    WN0081  1        Status 1
     C                     MOVEL*BLANK    WN0082  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0083  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0084  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SWRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0075    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ':':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0075:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0076:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0082    CAT  WN0075:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0076:ZQ $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0077    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0077:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0078:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0083:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0077:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0078:ZQ $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0079    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0079:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0080:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $KKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0081    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  '+':ZQ    $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0012    IFEQ 'Y'                        *IF
     C                     Z-ADDWBTHHD    WUETNB           Farm Site USR
      * Rmv 0's from Farm SiteUP - STR Miscellaneous  * 
     C                     MOVEL'PKFSMOVU'WXPGM  10
     C                     MOVE 'S '      WXPGM
     C                     CALL WXPGM                  90  Rmv 0's from Fa
     C                     PARM WBTHHD    WQ0041  50       TH HPS Farm Sit
     C           WUWWTX    PARM *BLANK    WQ0042  5        TH HPS Farm Sit
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL'PKFSMOVU'W0CLPG 10
     C                     MOVE 'S '      W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL*BLANK    $KKQTX           Farm site Name
     C                     MOVELWUWWTX    $KKQTX           Farm site Name
      *
     C                     Z-ADD*ZERO     WN0085  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0086  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0087  5        Building 1 USR
     C                     MOVEL*BLANK    WN0088  5        Room 1 USR
     C                     MOVEL*BLANK    WN0089  5        Building 2 USR
     C                     MOVEL*BLANK    WN0090  5        Room 2 USR
     C                     MOVEL*BLANK    WN0091  5        Building 3 USR
     C                     MOVEL*BLANK    WN0092  5        Room 3 USR
     C                     MOVEL*BLANK    WN0093  1        Status 1
     C                     MOVEL*BLANK    WN0094  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0095  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0096  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR SYRVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0087    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ':':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0087:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0088:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0094    CAT  WN0087:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0088:ZQ $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0089    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0089:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0090:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0095:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0089:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0090:ZQ $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0091    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0091:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0092:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $KKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0093    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  '+':ZQ    $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * 3/02/04 RMC
      * CASE: CUR.TH Group Reference is Entered
     C           $KBICD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $KKQTX           Farm site Name
     C                     MOVEL$KBICD    $KKQTX           Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     Z-ADD*ZERO     WN0097  50       DT Farm Site Co
     C                     MOVEL*BLANK    WN0098  1        DT Full/Split L
     C                     MOVEL*BLANK    WN0099  5        Building 1 USR
     C                     MOVEL*BLANK    WN0100  5        Room 1 USR
     C                     MOVEL*BLANK    WN0101  5        Building 2 USR
     C                     MOVEL*BLANK    WN0102  5        Room 2 USR
     C                     MOVEL*BLANK    WN0103  5        Building 3 USR
     C                     MOVEL*BLANK    WN0104  5        Room 3 USR
     C                     MOVEL*BLANK    WN0105  1        Status 1
     C                     MOVEL*BLANK    WN0106  7        Farm 1 USR
     C                     MOVEL*BLANK    WN0107  7        Farm 2 USR
     C                     MOVEL*BLANK    WN0108  7        Farm 3 USR
      *
      * Rtv Farm,Bldg,Room    IF
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
     C                     EXSR TARVGN
      * ** Building/Room 1 **
      * CASE: PAR.Building 1 USR is Entered
     C           WN0099    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ':':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0099:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0100:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD1         ZQ      50
     C           WN0106    CAT  WN0099:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0100:ZQ $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 2 **
      * CASE: PAR.Building 2 USR is Entered
     C           WN0101    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0101:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0102:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0107:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0101:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0102:ZQ $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
      * ** Building/Room 3 **
      * CASE: PAR.Building 3 USR is Entered
     C           WN0103    IFNE *BLANK                     *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  ';':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  WN0103:ZQ $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  '/':ZQ    $KKQTX    P      Farm site Name
     C                     Z-ADD*ZERO     ZQ      50
     C           $KKQTX    CAT  WN0104:ZQ $KKQTX    P      Farm site Name
     C                     ELSE
      * CASE: *OTHERWISE
      * *Move-Right - STR User Source Functions  * 
     C                     MOVE '+'       $KKQTX
     C                     END                             *FI
     C                     END                             *FI
      * More then 3 Splits if Internal
      * CASE: PAR.Status 1 is Yes
     C           WN0105    IFEQ 'Y'                        *IF
      * CASE: PAR.DT Source Type is Internal
     C           $KKAST    IFEQ 'I'                        *IF
     C                     Z-ADD1         ZQ      50
     C           $KKQTX    CAT  '+':ZQ    $KKQTX    P      Farm site Name
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           $KFCNB    MULT $KF7NB    $KCCNB           Yard dead weigh
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR TCRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $KB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKB0DT
     C                     MOVEL'0'       *IN79
     C           $KNYCD    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ECDT    IFEQ 'Y'
     C                     WRITE$KCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ECDT
     C                     END                             FI
      * Print format
     C                     WRITE$KDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0EPDT
     C                     END                             FI
      * Print First Page Format of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0FL1P
     C                     END                             FI
      * Print BOH Company Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP00
     C                     END                             FI
      * Print BOH Buy Order Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP01
     C                     END                             FI
      * Print BOL Load Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP02
     C                     END                             FI
      * Print TH Tattoo Number of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP03
     C                     END                             FI
      * Print TH Kill Date of Prt Tattoo Defect     PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0FP04
     C                     END                             FI
      * Print Detail line. of Prt Tattoo Defect     PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0FCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0FPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0FPDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
     C                     EXSR TDRVGN
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
     C                     EXSR TERVGN
     C                     MOVELWUBCTX    $LJSTX           Defect Desc 10
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert TST Wgt Date to display format
      * Convert date
     C           1000000   ADD  $LB6DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VLB6DT
      * Print column headings if required
     C           W0FCDT    IFEQ 'Y'
     C                     WRITE$LCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0FCDT
     C                     END                             FI
      * Print format
     C                     WRITE$LDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0FPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0AP01    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Receiving Rpt-Sum PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  9         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Receiving Rpt-Sum PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Hog Class Type of Prt Receiving Rpt-Sum PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Receiving Rpt-Sum PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Receiving Rpt-Sum PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Receiving Rpt-Sum PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD4         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Recvng f/Hld-Sum  PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Recvng f/Hld-Sum  PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Recvng f/Hld-Sum  PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Recvng f/Hld-Sum  PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Recvng f/Hld-Sum  PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Recvng f/Hld-Sum  PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0DP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Recvng f/Sub-Sum  PO
     C           W0EP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Recvng f/Sub-Sum  PO
     C           W0EP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Recvng f/Sub-Sum  PO
     C           W0EP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Hog Class Type of Prt Recvng f/Sub-Sum  PO
     C           W0EP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Recvng f/Sub-Sum  PO
     C           W0EP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Recvng f/Sub-Sum  PO
     C           W0EPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ECDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Tattoo Defect     PO
     C           W0FP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt Tattoo Defect     PO
     C           W0FP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt Tattoo Defect     PO
     C           W0FP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt Tattoo Defect     PO
     C           W0FP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt Tattoo Defect     PO
     C           W0FP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt Tattoo Defect     PO
     C           W0FP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Tattoo Defect     PO
     C           W0FPDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0FCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Source Desc       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVEL$CAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSSA     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAAFTX    $CAFTX           SR Description
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           DT Farm Site Co
     C                     MOVEL*BLANK    WN0002           DT Full/Split L
     C                     MOVEL*BLANK    WN0003           Building 1 USR
     C                     MOVEL*BLANK    WN0004           Room 1 USR
     C                     MOVEL*BLANK    WN0005           Building 2 USR
     C                     MOVEL*BLANK    WN0006           Room 2 USR
     C                     MOVEL*BLANK    WN0007           Building 3 USR
     C                     MOVEL*BLANK    WN0008           Room 3 USR
     C                     MOVEL*BLANK    WN0009           Status 1
     C                     MOVEL*BLANK    WN0010           Farm 1 USR
     C                     MOVEL*BLANK    WN0011           Farm 2 USR
     C                     MOVEL*BLANK    WN0012           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSB03           BOL Load Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
      * Setup key
     C                     Z-ADD$FHMNB    WQSB01           BOH Company Num
     C                     Z-ADD$FBNNB    WQSB02           BOH Buy Order N
     C                     Z-ADD$FBONB    WQSB03           BOL Load Number
      * Establish starting position
     C           KRSSB     SETLL@AFCPI4                    *
     C           KRSSB     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0001           DT Farm Site Co
     C                     MOVELAFXIST    WN0002           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0003           Building 1 USR
     C                     MOVELAFK1CD    WN0004           Room 1 USR
     C                     MOVEL'N'       WN0009           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0009           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSC01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSC02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSC03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSC04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSC05           DT Delivery Tim
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           CC Company Numb
     C                     KFLD           WQSC02           DSH Kill Date
     C                     KFLD           WQSC03           DT Delivery Dat
     C                     KFLD           WQSC04           DT Delivery Tim
     C                     KFLD           WQSC05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSC01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSC02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSC03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSC04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSC05           DT Delivery Tim
      * Establish starting position
     C           KRSSC     SETLL@AJCPIY                    *
     C           KRSSC     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0003           Building 1 USR
     C                     MOVELAJK5CD    WN0004           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0010           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0005           Building 2 USR
     C                     MOVELAJK5CD    WN0006           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0011           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0007           Building 3 USR
     C                     MOVELAJK5CD    WN0008           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0012           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0009           Status 1
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSC     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0013           DT Farm Site Co
     C                     MOVEL*BLANK    WN0014           DT Full/Split L
     C                     MOVEL*BLANK    WN0015           Building 1 USR
     C                     MOVEL*BLANK    WN0016           Room 1 USR
     C                     MOVEL*BLANK    WN0017           Building 2 USR
     C                     MOVEL*BLANK    WN0018           Room 2 USR
     C                     MOVEL*BLANK    WN0019           Building 3 USR
     C                     MOVEL*BLANK    WN0020           Room 3 USR
     C                     MOVEL*BLANK    WN0021           Status 1
     C                     MOVEL*BLANK    WN0022           Farm 1 USR
     C                     MOVEL*BLANK    WN0023           Farm 2 USR
     C                     MOVEL*BLANK    WN0024           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSD03           BOL Load Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
      * Setup key
     C                     Z-ADD$FHMNB    WQSD01           BOH Company Num
     C                     Z-ADD$FBNNB    WQSD02           BOH Buy Order N
     C                     Z-ADD$FBONB    WQSD03           BOL Load Number
      * Establish starting position
     C           KRSSD     SETLL@AFCPI4                    *
     C           KRSSD     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0013           DT Farm Site Co
     C                     MOVELAFXIST    WN0014           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0015           Building 1 USR
     C                     MOVELAFK1CD    WN0016           Room 1 USR
     C                     MOVEL'N'       WN0021           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0021           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSE01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSE02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSE03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSE04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSE05           DT Delivery Tim
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CC Company Numb
     C                     KFLD           WQSE02           DSH Kill Date
     C                     KFLD           WQSE03           DT Delivery Dat
     C                     KFLD           WQSE04           DT Delivery Tim
     C                     KFLD           WQSE05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSE01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSE02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSE03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSE04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSE05           DT Delivery Tim
      * Establish starting position
     C           KRSSE     SETLL@AJCPIY                    *
     C           KRSSE     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0015           Building 1 USR
     C                     MOVELAJK5CD    WN0016           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0022           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0017           Building 2 USR
     C                     MOVELAJK5CD    WN0018           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0023           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0019           Building 3 USR
     C                     MOVELAJK5CD    WN0020           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0024           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0021           Status 1
     C                     GOTO SEEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSE     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0025           DT Farm Site Co
     C                     MOVEL*BLANK    WN0026           DT Full/Split L
     C                     MOVEL*BLANK    WN0027           Building 1 USR
     C                     MOVEL*BLANK    WN0028           Room 1 USR
     C                     MOVEL*BLANK    WN0029           Building 2 USR
     C                     MOVEL*BLANK    WN0030           Room 2 USR
     C                     MOVEL*BLANK    WN0031           Building 3 USR
     C                     MOVEL*BLANK    WN0032           Room 3 USR
     C                     MOVEL*BLANK    WN0033           Status 1
     C                     MOVEL*BLANK    WN0034           Farm 1 USR
     C                     MOVEL*BLANK    WN0035           Farm 2 USR
     C                     MOVEL*BLANK    WN0036           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSF03           BOL Load Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
      * Setup key
     C                     Z-ADD$FHMNB    WQSF01           BOH Company Num
     C                     Z-ADD$FBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD$FBONB    WQSF03           BOL Load Number
      * Establish starting position
     C           KRSSF     SETLL@AFCPI4                    *
     C           KRSSF     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0025           DT Farm Site Co
     C                     MOVELAFXIST    WN0026           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0027           Building 1 USR
     C                     MOVELAFK1CD    WN0028           Room 1 USR
     C                     MOVEL'N'       WN0033           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0033           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSG01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSG02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSG03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSG04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSG05           DT Delivery Tim
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           CC Company Numb
     C                     KFLD           WQSG02           DSH Kill Date
     C                     KFLD           WQSG03           DT Delivery Dat
     C                     KFLD           WQSG04           DT Delivery Tim
     C                     KFLD           WQSG05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSG01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSG02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSG03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSG04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSG05           DT Delivery Tim
      * Establish starting position
     C           KRSSG     SETLL@AJCPIY                    *
     C           KRSSG     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0027           Building 1 USR
     C                     MOVELAJK5CD    WN0028           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0034           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0029           Building 2 USR
     C                     MOVELAJK5CD    WN0030           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0035           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0031           Building 3 USR
     C                     MOVELAJK5CD    WN0032           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0036           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0033           Status 1
     C                     GOTO SGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSG     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$FHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$FBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$FBONB    DNBONB           BOL Load Number
     C                     Z-ADD$FCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$FB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSH     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $FNYCD           PS Site ID
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $FNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQSI01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQSI02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQSI03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQSI04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQSI05           TH Kill Date
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           BOH Company Num
     C                     KFLD           WQSI02           BOH Buy Order N
     C                     KFLD           WQSI03           BOL Load Number
     C                     KFLD           WQSI04           TH Tattoo Numbe
     C                     KFLD           WQSI05           TH Kill Date
      * Setup key
     C                     Z-ADD$GHMNB    WQSI01           BOH Company Num
     C                     Z-ADD$GBNNB    WQSI02           BOH Buy Order N
     C                     Z-ADD$GBONB    WQSI03           BOL Load Number
     C                     Z-ADD$GCVNB    WQSI04           TH Tattoo Numbe
     C                     Z-ADD$GB0DT    WQSI05           TH Kill Date
      * Establish starting position
     C           KRSSI     SETLL@B3CPHL                    *
     C           KRSSI     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $GB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $GANTM           TST Wgt Time
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $GB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $GANTM           TST Wgt Time
     C           KRSSI     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$GBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSSJ     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSSK     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO SKEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0037           DT Farm Site Co
     C                     MOVEL*BLANK    WN0038           DT Full/Split L
     C                     MOVEL*BLANK    WN0039           Building 1 USR
     C                     MOVEL*BLANK    WN0040           Room 1 USR
     C                     MOVEL*BLANK    WN0041           Building 2 USR
     C                     MOVEL*BLANK    WN0042           Room 2 USR
     C                     MOVEL*BLANK    WN0043           Building 3 USR
     C                     MOVEL*BLANK    WN0044           Room 3 USR
     C                     MOVEL*BLANK    WN0045           Status 1
     C                     MOVEL*BLANK    WN0046           Farm 1 USR
     C                     MOVEL*BLANK    WN0047           Farm 2 USR
     C                     MOVEL*BLANK    WN0048           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSL01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSL02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSL03           BOL Load Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WQSL02           BOH Buy Order N
     C                     KFLD           WQSL03           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    WQSL01           BOH Company Num
     C                     Z-ADD$HBNNB    WQSL02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQSL03           BOL Load Number
      * Establish starting position
     C           KRSSL     SETLL@AFCPI4                    *
     C           KRSSL     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0037           DT Farm Site Co
     C                     MOVELAFXIST    WN0038           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SMRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0039           Building 1 USR
     C                     MOVELAFK1CD    WN0040           Room 1 USR
     C                     MOVEL'N'       WN0045           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0045           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSM01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSM02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSM03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSM04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSM05           DT Delivery Tim
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           CC Company Numb
     C                     KFLD           WQSM02           DSH Kill Date
     C                     KFLD           WQSM03           DT Delivery Dat
     C                     KFLD           WQSM04           DT Delivery Tim
     C                     KFLD           WQSM05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSM01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSM02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSM03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSM04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSM05           DT Delivery Tim
      * Establish starting position
     C           KRSSM     SETLL@AJCPIY                    *
     C           KRSSM     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0039           Building 1 USR
     C                     MOVELAJK5CD    WN0040           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0046           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0041           Building 2 USR
     C                     MOVELAJK5CD    WN0042           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0047           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0043           Building 3 USR
     C                     MOVELAJK5CD    WN0044           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0048           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0045           Status 1
     C                     GOTO SMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSM     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0049           DT Farm Site Co
     C                     MOVEL*BLANK    WN0050           DT Full/Split L
     C                     MOVEL*BLANK    WN0051           Building 1 USR
     C                     MOVEL*BLANK    WN0052           Room 1 USR
     C                     MOVEL*BLANK    WN0053           Building 2 USR
     C                     MOVEL*BLANK    WN0054           Room 2 USR
     C                     MOVEL*BLANK    WN0055           Building 3 USR
     C                     MOVEL*BLANK    WN0056           Room 3 USR
     C                     MOVEL*BLANK    WN0057           Status 1
     C                     MOVEL*BLANK    WN0058           Farm 1 USR
     C                     MOVEL*BLANK    WN0059           Farm 2 USR
     C                     MOVEL*BLANK    WN0060           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSN02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSN03           BOL Load Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
     C                     KFLD           WQSN03           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    WQSN01           BOH Company Num
     C                     Z-ADD$HBNNB    WQSN02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQSN03           BOL Load Number
      * Establish starting position
     C           KRSSN     SETLL@AFCPI4                    *
     C           KRSSN     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0049           DT Farm Site Co
     C                     MOVELAFXIST    WN0050           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SORVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0051           Building 1 USR
     C                     MOVELAFK1CD    WN0052           Room 1 USR
     C                     MOVEL'N'       WN0057           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0057           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSO01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSO02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSO03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSO04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSO05           DT Delivery Tim
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           CC Company Numb
     C                     KFLD           WQSO02           DSH Kill Date
     C                     KFLD           WQSO03           DT Delivery Dat
     C                     KFLD           WQSO04           DT Delivery Tim
     C                     KFLD           WQSO05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSO01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSO02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSO03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSO04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSO05           DT Delivery Tim
      * Establish starting position
     C           KRSSO     SETLL@AJCPIY                    *
     C           KRSSO     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0051           Building 1 USR
     C                     MOVELAJK5CD    WN0052           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0058           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0053           Building 2 USR
     C                     MOVELAJK5CD    WN0054           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0059           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0055           Building 3 USR
     C                     MOVELAJK5CD    WN0056           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0060           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0057           Status 1
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSO     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0061           DT Farm Site Co
     C                     MOVEL*BLANK    WN0062           DT Full/Split L
     C                     MOVEL*BLANK    WN0063           Building 1 USR
     C                     MOVEL*BLANK    WN0064           Room 1 USR
     C                     MOVEL*BLANK    WN0065           Building 2 USR
     C                     MOVEL*BLANK    WN0066           Room 2 USR
     C                     MOVEL*BLANK    WN0067           Building 3 USR
     C                     MOVEL*BLANK    WN0068           Room 3 USR
     C                     MOVEL*BLANK    WN0069           Status 1
     C                     MOVEL*BLANK    WN0070           Farm 1 USR
     C                     MOVEL*BLANK    WN0071           Farm 2 USR
     C                     MOVEL*BLANK    WN0072           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSP03           BOL Load Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
      * Setup key
     C                     Z-ADD$HHMNB    WQSP01           BOH Company Num
     C                     Z-ADD$HBNNB    WQSP02           BOH Buy Order N
     C                     Z-ADD$HBONB    WQSP03           BOL Load Number
      * Establish starting position
     C           KRSSP     SETLL@AFCPI4                    *
     C           KRSSP     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0061           DT Farm Site Co
     C                     MOVELAFXIST    WN0062           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SQRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0063           Building 1 USR
     C                     MOVELAFK1CD    WN0064           Room 1 USR
     C                     MOVEL'N'       WN0069           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0069           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSQ01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSQ02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSQ03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSQ04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSQ05           DT Delivery Tim
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           CC Company Numb
     C                     KFLD           WQSQ02           DSH Kill Date
     C                     KFLD           WQSQ03           DT Delivery Dat
     C                     KFLD           WQSQ04           DT Delivery Tim
     C                     KFLD           WQSQ05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSQ01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSQ02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSQ03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSQ04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSQ05           DT Delivery Tim
      * Establish starting position
     C           KRSSQ     SETLL@AJCPIY                    *
     C           KRSSQ     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0063           Building 1 USR
     C                     MOVELAJK5CD    WN0064           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0070           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0065           Building 2 USR
     C                     MOVELAJK5CD    WN0066           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0071           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0067           Building 3 USR
     C                     MOVELAJK5CD    WN0068           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0072           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0069           Status 1
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSQ     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$HHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$HBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$HBONB    DNBONB           BOL Load Number
     C                     Z-ADD$HCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$HB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSSR     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $HNYCD           PS Site ID
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $HNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQSS01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQSS02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQSS03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQSS04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQSS05           TH Kill Date
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           BOH Company Num
     C                     KFLD           WQSS02           BOH Buy Order N
     C                     KFLD           WQSS03           BOL Load Number
     C                     KFLD           WQSS04           TH Tattoo Numbe
     C                     KFLD           WQSS05           TH Kill Date
      * Setup key
     C                     Z-ADD$IHMNB    WQSS01           BOH Company Num
     C                     Z-ADD$IBNNB    WQSS02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQSS03           BOL Load Number
     C                     Z-ADD$ICVNB    WQSS04           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    WQSS05           TH Kill Date
      * Establish starting position
     C           KRSSS     SETLL@B3CPHL                    *
     C           KRSSS     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $IB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $IANTM           TST Wgt Time
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $IB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $IANTM           TST Wgt Time
     C           KRSSS     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$IBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSST     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSSU     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO SUEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Load Type         RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSV01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSV02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSV03           BOL Load Number
     C           *LIKE     DEFN AFE0DT    WQSV04           DSH Kill Date
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           BOH Company Num
     C                     KFLD           WQSV02           BOH Buy Order N
     C                     KFLD           WQSV03           BOL Load Number
     C                     KFLD           WQSV04           DSH Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    WQSV01           BOH Company Num
     C                     Z-ADDA1BNNB    WQSV02           BOH Buy Order N
     C                     Z-ADDA1BONB    WQSV03           BOL Load Number
     C                     Z-ADDA1B0DT    WQSV04           DSH Kill Date
      * Establish starting position
     C           KRSSV     SETLL@AFCPI4                    *
     C           KRSSV     READE@AFCPI4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1030' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0011           DT Load Type
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFXHST    YL0011           DT Load Type
     C                     GOTO SVEXIT                     *QUIT
     C           KRSSV     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0073           DT Farm Site Co
     C                     MOVEL*BLANK    WN0074           DT Full/Split L
     C                     MOVEL*BLANK    WN0075           Building 1 USR
     C                     MOVEL*BLANK    WN0076           Room 1 USR
     C                     MOVEL*BLANK    WN0077           Building 2 USR
     C                     MOVEL*BLANK    WN0078           Room 2 USR
     C                     MOVEL*BLANK    WN0079           Building 3 USR
     C                     MOVEL*BLANK    WN0080           Room 3 USR
     C                     MOVEL*BLANK    WN0081           Status 1
     C                     MOVEL*BLANK    WN0082           Farm 1 USR
     C                     MOVEL*BLANK    WN0083           Farm 2 USR
     C                     MOVEL*BLANK    WN0084           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSW01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSW02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSW03           BOL Load Number
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           BOH Company Num
     C                     KFLD           WQSW02           BOH Buy Order N
     C                     KFLD           WQSW03           BOL Load Number
      * Setup key
     C                     Z-ADD$KHMNB    WQSW01           BOH Company Num
     C                     Z-ADD$KBNNB    WQSW02           BOH Buy Order N
     C                     Z-ADD$KBONB    WQSW03           BOL Load Number
      * Establish starting position
     C           KRSSW     SETLL@AFCPI4                    *
     C           KRSSW     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0073           DT Farm Site Co
     C                     MOVELAFXIST    WN0074           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SXRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0075           Building 1 USR
     C                     MOVELAFK1CD    WN0076           Room 1 USR
     C                     MOVEL'N'       WN0081           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0081           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSX01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSX02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSX03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSX04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSX05           DT Delivery Tim
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           CC Company Numb
     C                     KFLD           WQSX02           DSH Kill Date
     C                     KFLD           WQSX03           DT Delivery Dat
     C                     KFLD           WQSX04           DT Delivery Tim
     C                     KFLD           WQSX05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSX01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSX02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSX03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSX04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSX05           DT Delivery Tim
      * Establish starting position
     C           KRSSX     SETLL@AJCPIY                    *
     C           KRSSX     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0075           Building 1 USR
     C                     MOVELAJK5CD    WN0076           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0082           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0077           Building 2 USR
     C                     MOVELAJK5CD    WN0078           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0083           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0079           Building 3 USR
     C                     MOVELAJK5CD    WN0080           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0084           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0081           Status 1
     C                     GOTO SXEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSX     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0085           DT Farm Site Co
     C                     MOVEL*BLANK    WN0086           DT Full/Split L
     C                     MOVEL*BLANK    WN0087           Building 1 USR
     C                     MOVEL*BLANK    WN0088           Room 1 USR
     C                     MOVEL*BLANK    WN0089           Building 2 USR
     C                     MOVEL*BLANK    WN0090           Room 2 USR
     C                     MOVEL*BLANK    WN0091           Building 3 USR
     C                     MOVEL*BLANK    WN0092           Room 3 USR
     C                     MOVEL*BLANK    WN0093           Status 1
     C                     MOVEL*BLANK    WN0094           Farm 1 USR
     C                     MOVEL*BLANK    WN0095           Farm 2 USR
     C                     MOVEL*BLANK    WN0096           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQSY01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQSY02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQSY03           BOL Load Number
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           BOH Company Num
     C                     KFLD           WQSY02           BOH Buy Order N
     C                     KFLD           WQSY03           BOL Load Number
      * Setup key
     C                     Z-ADD$KHMNB    WQSY01           BOH Company Num
     C                     Z-ADD$KBNNB    WQSY02           BOH Buy Order N
     C                     Z-ADD$KBONB    WQSY03           BOL Load Number
      * Establish starting position
     C           KRSSY     SETLL@AFCPI4                    *
     C           KRSSY     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0085           DT Farm Site Co
     C                     MOVELAFXIST    WN0086           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR SZRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0087           Building 1 USR
     C                     MOVELAFK1CD    WN0088           Room 1 USR
     C                     MOVEL'N'       WN0093           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSY     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0093           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQSZ01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQSZ02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQSZ03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQSZ04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQSZ05           DT Delivery Tim
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           CC Company Numb
     C                     KFLD           WQSZ02           DSH Kill Date
     C                     KFLD           WQSZ03           DT Delivery Dat
     C                     KFLD           WQSZ04           DT Delivery Tim
     C                     KFLD           WQSZ05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQSZ01           CC Company Numb
     C                     Z-ADDAFE0DT    WQSZ02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQSZ03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQSZ04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQSZ05           DT Delivery Tim
      * Establish starting position
     C           KRSSZ     SETLL@AJCPIY                    *
     C           KRSSZ     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0087           Building 1 USR
     C                     MOVELAJK5CD    WN0088           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0094           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0089           Building 2 USR
     C                     MOVELAJK5CD    WN0090           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0095           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0091           Building 3 USR
     C                     MOVELAJK5CD    WN0092           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0096           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0093           Status 1
     C                     GOTO SZEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSSZ     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Farm,Bldg,Room    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0097           DT Farm Site Co
     C                     MOVEL*BLANK    WN0098           DT Full/Split L
     C                     MOVEL*BLANK    WN0099           Building 1 USR
     C                     MOVEL*BLANK    WN0100           Room 1 USR
     C                     MOVEL*BLANK    WN0101           Building 2 USR
     C                     MOVEL*BLANK    WN0102           Room 2 USR
     C                     MOVEL*BLANK    WN0103           Building 3 USR
     C                     MOVEL*BLANK    WN0104           Room 3 USR
     C                     MOVEL*BLANK    WN0105           Status 1
     C                     MOVEL*BLANK    WN0106           Farm 1 USR
     C                     MOVEL*BLANK    WN0107           Farm 2 USR
     C                     MOVEL*BLANK    WN0108           Farm 3 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFHMNB    WQTA01           BOH Company Num
     C           *LIKE     DEFN AFBNNB    WQTA02           BOH Buy Order N
     C           *LIKE     DEFN AFBONB    WQTA03           BOL Load Number
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           BOH Company Num
     C                     KFLD           WQTA02           BOH Buy Order N
     C                     KFLD           WQTA03           BOL Load Number
      * Setup key
     C                     Z-ADD$KHMNB    WQTA01           BOH Company Num
     C                     Z-ADD$KBNNB    WQTA02           BOH Buy Order N
     C                     Z-ADD$KBONB    WQTA03           BOL Load Number
      * Establish starting position
     C           KRSTA     SETLL@AFCPI4                    *
     C           KRSTA     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAFICA1    WN0097           DT Farm Site Co
     C                     MOVELAFXIST    WN0098           DT Full/Split L
      * CASE: DB1.DT Full/Split Load is Split
     C           AFXIST    IFEQ 'S'                        *IF
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
     C                     EXSR TBRVGN
     C                     ELSE
      * CASE: DB1.DT Full/Split Load is Full
     C           AFXIST    IFEQ 'F'                        *IF
     C                     MOVELAFK0CD    WN0099           Building 1 USR
     C                     MOVELAFK1CD    WN0100           Room 1 USR
     C                     MOVEL'N'       WN0105           Status 1
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@AFCPI4                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv 1st Bldg,Room     RT - Delivery Tracking Split  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         YL0005           Count USR
     C                     MOVEL'N'       WN0105           Status 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN AJHONB    WQTB01           CC Company Numb
     C           *LIKE     DEFN AJE0DT    WQTB02           DSH Kill Date
     C           *LIKE     DEFN AJE9DT    WQTB03           DT Delivery Dat
     C           *LIKE     DEFN AJAJTH    WQTB04           DT Delivery Tim
     C           *LIKE     DEFN AJH4A1    WQTB05           DT Delivery Tim
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           CC Company Numb
     C                     KFLD           WQTB02           DSH Kill Date
     C                     KFLD           WQTB03           DT Delivery Dat
     C                     KFLD           WQTB04           DT Delivery Tim
     C                     KFLD           WQTB05           DT Delivery Tim
      * Setup key
     C                     Z-ADDAFHONB    WQTB01           CC Company Numb
     C                     Z-ADDAFE0DT    WQTB02           DSH Kill Date
     C                     Z-ADDAFE9DT    WQTB03           DT Delivery Dat
     C                     Z-ADDAFAJTH    WQTB04           DT Delivery Tim
     C                     Z-ADDAFH4A1    WQTB05           DT Delivery Tim
      * Establish starting position
     C           KRSTB     SETLL@AJCPIY                    *
     C           KRSTB     READE@AJCPIY                  90*
      * Data record not found
     C   90                MOVEL'PRK1038' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Count USR is One
     C           YL0005    IFEQ 1                          *IF
     C                     MOVELAJK4CD    WN0099           Building 1 USR
     C                     MOVELAJK5CD    WN0100           Room 1 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0106           Farm 1 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0005    IFEQ 2                          *IF
     C                     MOVELAJK4CD    WN0101           Building 2 USR
     C                     MOVELAJK5CD    WN0102           Room 2 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0107           Farm 2 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0005    IFEQ 3                          *IF
     C                     MOVELAJK4CD    WN0103           Building 3 USR
     C                     MOVELAJK5CD    WN0104           Room 3 USR
      * CASE: PAR.DT Source Type is External
     C           AFXKST    IFEQ 'E'                        *IF
     C                     MOVELAJLKCD    WN0108           Farm 3 USR
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0105           Status 1
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         YL0005           Count USR
     C           KRSTB     READE@AJCPIY                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           DNHMNB           BOH Company Num
     C                     KFLD           DNBNNB           BOH Buy Order N
     C                     KFLD           DNBONB           BOL Load Number
     C                     KFLD           DNCVNB           TH Tattoo Numbe
     C                     KFLD           DNB0DT           TH Kill Date
      * Setup key
     C                     Z-ADD$KHMNB    DNHMNB           BOH Company Num
     C                     Z-ADD$KBNNB    DNBNNB           BOH Buy Order N
     C                     Z-ADD$KBONB    DNBONB           BOL Load Number
     C                     Z-ADD$KCVNB    DNCVNB           TH Tattoo Numbe
     C                     Z-ADD$KB0DT    DNB0DT           TH Kill Date
      * Establish starting position
     C           KRSTC     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $KNYCD           PS Site ID
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNNYCD    $KNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Scale dt,tm,No PenRT - Tattoo Scale Ticket  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B3HMNB    WQTD01           BOH Company Num
     C           *LIKE     DEFN B3BNNB    WQTD02           BOH Buy Order N
     C           *LIKE     DEFN B3BONB    WQTD03           BOL Load Number
     C           *LIKE     DEFN B3CVNB    WQTD04           TH Tattoo Numbe
     C           *LIKE     DEFN B3B0DT    WQTD05           TH Kill Date
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           BOH Company Num
     C                     KFLD           WQTD02           BOH Buy Order N
     C                     KFLD           WQTD03           BOL Load Number
     C                     KFLD           WQTD04           TH Tattoo Numbe
     C                     KFLD           WQTD05           TH Kill Date
      * Setup key
     C                     Z-ADD$LHMNB    WQTD01           BOH Company Num
     C                     Z-ADD$LBNNB    WQTD02           BOH Buy Order N
     C                     Z-ADD$LBONB    WQTD03           BOL Load Number
     C                     Z-ADD$LCVNB    WQTD04           TH Tattoo Numbe
     C                     Z-ADD$LB0DT    WQTD05           TH Kill Date
      * Establish starting position
     C           KRSTD     SETLL@B3CPHL                    *
     C           KRSTD     READE@B3CPHL                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0144' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     $LB6DT           TST Wgt Date
     C                     Z-ADD*ZERO     $LANTM           TST Wgt Time
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDB3B6DT    $LB6DT           TST Wgt Date
     C                     Z-ADDB3ANTM    $LANTM           TST Wgt Time
     C           KRSTD     READE@B3CPHL                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Hog Defect Desc   RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           A7BDCD           DF Defect Code
      * Setup key
     C                     MOVEL$LBDCD    A7BDCD           DF Defect Code
      * Establish starting position
     C           KRSTE     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVELWUCRTX    WUBCTX           DF Description
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA7BCTX    WUBCTX           DF Description
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Hog Class Type    RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           A8BECD           HC Class Code
      * Setup key
     C                     MOVELDZBECD    A8BECD           HC Class Code
      * Establish starting position
     C           KRSTF     CHAIN@A8REDA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0075' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           HC Class Type
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELA8FBST    YL0006           HC Class Type
     C                     GOTO TFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E11245 JJH 07/24/17 - Receiving Report Modifications
      * - Add Input Parm for SR Source
      * - Add record selection for SR Source
      * E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * ELDTYPE JBB 10/26/17 - Add Load Type Selection
      *   Add Load Type field as input parameter.  Add record selection
      *   using Load Type parameter.
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0004  30       BOH Company Num
     C                     PARM @CN,002   WQ0005 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0006 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0003           MTech Live Yes
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Recvng f/Hld-Sum  PO
      *================================================================
     C                     Z-ADD*ZERO     WUCDNB           Head held over
     C                     Z-ADD*ZERO     WUQLNB           Live Weight 2 S
      * If TATTOO is Held over until tomorrow's kill
      * CASE: CUR.TH Held Over is *Zeros
     C           $FH9NB    IFEQ *ZERO                      *IF
     C                     GOTO UDEXIT                     *QUIT
     C                     END                             *FI
      * Prt Recvng f/Hld-Sum  PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $FHMNB    WQ0021  30       BOH Company Num
     C                     PARM @CN,002   WQ0022 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0023 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0009           MTech Live Yes
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) $JHMNB' defaulted for 'BOH Company Number'.
      * Field '(CUR) $HBNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(CUR) $HBONB' defaulted for 'BOL Load Number'.
      * Field '(NXT) $JCVNB' defaulted for 'TH Tattoo Number'.
      * Field '(NXT) $JB0DT' defaulted for 'TH Kill Date'.
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Recvng f/Sub-Sum  PO
      *================================================================
      * CASE: CUR.TH Hog Class Type is Resale
     C           $NLLST    IFEQ 'R'                        *IF
     C                     GOTO UGEXIT                     *QUIT
     C                     END                             *FI
      * Prt Recvng f/Sub-Sum  PO: Mainline
     C                     EXSR E0MAIN
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0032  30       BOH Company Num
     C                     PARM @CN,002   WQ0033 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0034 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0012           MTech Live Yes
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Tattoo Defect     PO
      *================================================================
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(NXT) $MHMNB' defaulted for 'BOH Company Number'.
      * Field '(CUR) $KBNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(CUR) $KBONB' defaulted for 'BOL Load Number'.
      * Field '(CUR) $KCVNB' defaulted for 'TH Tattoo Number'.
      * Field '(NXT) $MB0DT' defaulted for 'TH Kill Date'.
      * Prt Tattoo Defect     PO: Mainline
     C                     EXSR F0MAIN
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt Recvng f/Hld-Sum  PO: Initialise
      *================================================================
      * USER: Initialize program
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
     C                     MOVEL@CN,001   YL0007           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $FHMNB    WQ0018  30       BOH Company Num
     C                     PARM YL0007    WQ0019 10        Company Value C
     C           YL0008    PARM *BLANK    WQ0020 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0008    WUD3SS           Co Uses HPE & H
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UESUBR                     Get the MTech L
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZEINIT    BEGSR
      *================================================================
      * Prt Recvng f/Sub-Sum  PO: Initialise
      *================================================================
      * USER: Initialize program
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UHSUBR                     Get the MTech L
      *================================================================
     CSR         ZEEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P6MFST           Usr Display 1
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Co Uses HPE & HPS usr
     C                     MOVEL*BLANK    WUD3SS  1
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1LLST           TH Hog Class Ty
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field TH Hog Class Type
     C                     MOVEL*BLANK    WULLST  1
      * Define work field TH Kill Date
     C                     Z-ADD*ZERO     WUB0DT  70
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Define work field TH HPS Farm Site Alpha
     C                     MOVEL*BLANK    WUWWTX  5
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Define work field DF Description
     C                     MOVEL*BLANK    WUBCTX 25
      * Define work field Head held over        SUM
     C                     Z-ADD*ZERO     WUCDNB  70
      * Define work field Live Weight 2 SUM
     C                     Z-ADD*ZERO     WUQLNB 111
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WABNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WABONB           BOL Load Number
     C                     MOVEL*LOVAL    WACVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WBB0DT           TH Kill Date
     C                     MOVEL*LOVAL    WBLLST           TH Hog Class Ty
     C                     MOVEL*LOVAL    WBCVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    DZHMNB           BOH Company Num
     C                     MOVEL*LOVAL    DZBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    DZBONB           BOL Load Number
     C                     MOVEL*LOVAL    DZCVNB           TH Tattoo Numbe
     C                     MOVEL*LOVAL    DZB0DT           TH Kill Date
     C                     MOVEL*LOVAL    DZBDCD           DF Defect Code
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0001 10
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0002 40
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Farm Site 5.0 USR
     C                     Z-ADD*ZERO     YL0004  50
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0005  30
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0001  6
      * Define null work field HC Description
     C                     MOVEL*BLANK    YN0002 25
      * Define local work field HC Class Type
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field Company Value Code    USR
     C                     MOVEL*BLANK    YL0007 10
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0008 40
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field Farm Site 3.0 USR
     C                     Z-ADD*ZERO     YL0010  30
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0003  6
      * Define local work field DT Load Type
     C                     MOVEL*BLANK    YL0011  2
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Farm Site 3.0 USR
     C                     Z-ADD*ZERO     YL0013  30
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0004  6
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE085
      * Hog Pop by farm site
      *  -- Rtv Farm Site - added parm for Farm Site nbr
      * E00282 SLM 111408 ADD LFT AND EUT/KOA TOTALS
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    $ACMP
     C                     MOVEL'N'       P6MFST           Usr Display 1
      * E02361 SLM 12/12/2012 SHOW THE PRODUCER SITE
     C                     MOVEL@CN,001   YL0001           Company Value C
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       BOH Company Num
     C                     PARM YL0001    WQ0002 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0002    WUD3SS           Co Uses HPE & H
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UBSUBR                     Get the MTech L
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 DLVTRKRULE
00002 MTECHLIVE
