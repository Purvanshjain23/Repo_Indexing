/*********************************************************************/
/* PROGRAM : PUY3UPC                                                 */
/* DESC    : PRT WIM 846 INTRANSIT CL  EXECUTE USER PROGRAM          */
/* DATE    : 04/12/2023                                              */
/* PROJECT : WI517 - WAREHOUSE INVENTORY MANAGEMENT (WIM)            */
/* BY      : DANNY NGUYEN                                            */
/* PURPOSE : Print WIM EDI 846 for current day Trading Partner /     */
/*           Warehouse Restoration process. Send emails for:         */
/*           1. Intransit Transfer Items.                            */
/*           2. Intransit Transfer Orders.                           */
/*           ** ONLY process #3 & #4 if & when Live with WIM=Y **    */
/*           3. Combine Email Messages for Posted, In Error, Not     */
/*              Received or Late.                                    */
/*           4. Raw Data.                                            */
/*                                                                   */
/*           JS 'INVRSTEDIW' calls this program.                     */
/*                                                                   */
/*********************************************************************/
/* MAINTENANCE LOG:                                                  */
/*-------------------------------------------------------------------*/
/* DATE       BY  CHANGE DESCRIPTION                                 */
/* --------   --- -------------------------------------------------- */
/*                                                                   */
/*                                                                   */
/*********************************************************************/

             PGM

             DCL        VAR(&RTNCDE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&CPRCDS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&NARCDS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&CORCDS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&RTNLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DTALIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EMAIL) TYPE(*CHAR) LEN(50)
             DCL        VAR(&EMLMSG) TYPE(*CHAR) LEN(170)
             DCL        VAR(&RLSSTS) TYPE(*CHAR) LEN(1)


             CHGVAR     VAR(&EMAIL) VALUE('edi_846_cmp_all')

/*-------------------------------------------------------------------*/
/* Get Data Library in Order to Concat 'TEST' Verbiage               */
/*-------------------------------------------------------------------*/
             CALL       PGM(PPJXXFR) PARM(' ' 'DTALIB' &DTALIB)

             CHGVAR     VAR(&EMLMSG) VALUE('Intransit Transfer +
                          Items: INTRANS846 Export to Excel')

    /* If not PROD Data Library then use 'TEST' Email DL. */
             IF         COND(&DTALIB *NE 'PRKFLIB') THEN(DO)
             CHGVAR     VAR(&EMAIL) VALUE(&EMAIL *TCAT '_tst')
             CHGVAR     VAR(&EMLMSG) VALUE(&EMLMSG *BCAT '- TEST')
             ENDDO

/*-------------------------------------------------------------------*/
/* Create/Send Excel Spreadsheet with SEQUEL Viewpoint and email to  */
/* receipient. INTRANS846 - EDI 846 Intransit Transfer Items.        */
/*-------------------------------------------------------------------*/
             EXECUTE    VIEW(INTRANS846) PCFMT(*XLS) +
                          RECIPIENT(&EMAIL) EMLMSG(&EMLMSG)

/*-------------------------------------------------------------------*/
/* Create/Send Excel Spreadsheet with SEQUEL Viewpoint and email to  */
/* receipient. Call PUL6UPC - EDI 846 Intransit Transfer Orders for  */
/* all Trading Partner/Warehouses.                                   */
/*-------------------------------------------------------------------*/
             CALL       PGM(PUL6UPC)


/*********************************************************************/
 /* GET WIM MODULE RELEASE STATUS */
             CALL       PGM(PUYLXFR) PARM('' 'WIM' X'001F' &RLSSTS)

 /* ONLY IF 'LIVE' WITH WIM RELEASE 1 THEN CONTINUE */
             IF         COND(&RLSSTS *EQ 'Y') THEN(DO)

/*-------------------------------------------------------------------*/
/* Create/Send Excel Spreadsheet with SEQUEL Viewpoint and email to  */
/* receipient. PUZFXFR - Send EDI 846 Combine Email Messages for     */
/* Physical Count Control transactions.                              */
/*-------------------------------------------------------------------*/
             CALL       PGM(PUZFXFR) PARM(' ')

/*-------------------------------------------------------------------*/
/* Create/Send Excel Spreadsheet with SEQUEL Viewpoint and email to  */
/* receipient. PUY4XFR - Send EDI 846 Raw Data.                      */
/*-------------------------------------------------------------------*/
             CALL       PGM(PUY4XFR) PARM(' ')

             ENDDO      /* &RLSSTS *EQ 'Y' */
/*********************************************************************/


 ENDPGM:
             ENDPGM
