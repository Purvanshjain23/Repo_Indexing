// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PWFHXFR
// ?Date: 14.08.2025 Time: 02:56:19
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?NOTE: Any changes to this program you should consider changing
//?      PWG8XFR program as well. PWG8XFR was a cloned from PWFHXFR.
EXECUTE FUNCTION(Eml Prod Dist Wrk XLS RT) TYPE(RTVOBJ) FILE(PWABCPP)           AB1342346;
PARAMETER(PAR.Company_Number_Alpha_Usr);
{
 //?USER: Process Data record

 //?Build the Delivery Schedule Report for the Producer
 //?08/22/2018 DN T13559-Added Producer Location as parm.
 // Call program Prt3Delivery Schedule XF.
 CALL PROGRAM(Prt3Delivery Schedule XF) ('PWFGXFR');
 PARAMETER(DB1.PDW_Company_Number);
 PARAMETER(DB1.PDW_Producer_Code);
 PARAMETER(DB1.PDW_Email);
 PARAMETER(DB1.PDW_BOL_Kill_Date);
 PARAMETER(DB1.PDW_Date_To);
 PARAMETER(*BLANK);

 //?Send Email to the Producer with .xls
 //?E14585 JJH 03/04/19 - Modify Email Subject Line
 //?Build Subject of Email.
 CASE;

 // IF PAR.Company Number Alpha Usr is SEB Foods-Guymon, OK
 IF PAR.Company_Number_Alpha_Usr = '360';

 // LCL.Email Subject-50 USR = CONCAT(CON.Guymon Delivery Schedule-,DB1.PDW Producer Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = 'Guymon Delivery Schedule-' + DB1.PDW_Producer_Code (*ZERO);

 //?Build Subject of Email.
 // IF PAR.Company Number Alpha Usr is SEB TF-Sioux City, IA
 IF PAR.Company_Number_Alpha_Usr = '440';

 // LCL.Email Subject-50 USR = CONCAT(CON.STF Delivery Schedule-,DB1.PDW Producer Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = 'STF Delivery Schedule-' + DB1.PDW_Producer_Code (*ZERO);

 //?Build Subject of Email.
 // IF PAR.Company Number Alpha Usr is Triumph Foods-StJoseph,MO
 IF PAR.Company_Number_Alpha_Usr = '960';

 // LCL.Email Subject-50 USR = CONCAT(CON.Triumph Delivery Schedule,CON.-,CON.*ZERO)
 LCL.Email_Subject_50_USR = 'Triumph Delivery Schedule' + '-' (*ZERO);

 // LCL.Email Subject-50 USR = CONCAT(LCL.Email Subject-50 USR,DB1.PDW Producer Code,CON.*ZERO)
 LCL.Email_Subject_50_USR = LCL.Email_Subject_50_USR + DB1.PDW_Producer_Code (*ZERO);

 ENDIF;

 //?Build email message
 CASE;

 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(IF Synon DTE to mm/dd/yy) TYPE(EXCINTFUN)                      AB1342397;
 PARAMETER(DB1.PDW_BOL_Kill_Date);
 PARAMETER(LCL.Date_Out_MM_DD_YY);
 {
  //?Execute internal function

  // LCL.Date Alpha USR = CVTVAR(PAR.Date In)
  LCL.Date_Alpha_USR = CVTVAR(PAR.Date_In);

  // LCL.Year Alpha Usr = SUBSTRING(LCL.Date Alpha USR,CON.2,CON.2)
  LCL.Year_Alpha_Usr = SUBSTRING(LCL.Date_Alpha_USR:2:2);

  // LCL.Month Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.4,CON.2)
  LCL.Month_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:4:2);

  // LCL.Day Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.6,CON.2)
  LCL.Day_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:6:2);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Month Alpha USR,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Month_Alpha_USR + '/' (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Day Alpha USR,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Day_Alpha_USR (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + '/' (*ZERO);

  // PAR.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Year Alpha Usr,CND.*None)
  PAR.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Year_Alpha_Usr (*ZERO);

 }

 //?Check if Kill Date and Date To are the same
 CASE;

 // IF DB1.PDW BOL Kill Date EQ DB1.PDW Date To
 IF DB1.PDW_BOL_Kill_Date = DB1.PDW_Date_To;

 // LCL.Text 200 = CONCAT(CON.Delivery Date:,LCL.Date Out MM/DD/YY,CND.*One)
 LCL.Text_200 = 'Delivery Date:' + LCL.Date_Out_MM_DD_YY (1);

 //?Check if Kill Date and Date To are the same
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(IF Synon DTE to mm/dd/yy) TYPE(EXCINTFUN)                      AB1342397;
 PARAMETER(DB1.PDW_Date_To);
 PARAMETER(LCL.Date_MM_DD_YY);
 {
  //?Execute internal function

  // LCL.Date Alpha USR = CVTVAR(PAR.Date In)
  LCL.Date_Alpha_USR = CVTVAR(PAR.Date_In);

  // LCL.Year Alpha Usr = SUBSTRING(LCL.Date Alpha USR,CON.2,CON.2)
  LCL.Year_Alpha_Usr = SUBSTRING(LCL.Date_Alpha_USR:2:2);

  // LCL.Month Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.4,CON.2)
  LCL.Month_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:4:2);

  // LCL.Day Alpha USR = SUBSTRING(LCL.Date Alpha USR,CON.6,CON.2)
  LCL.Day_Alpha_USR = SUBSTRING(LCL.Date_Alpha_USR:6:2);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Month Alpha USR,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Month_Alpha_USR + '/' (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Day Alpha USR,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Day_Alpha_USR (*ZERO);

  // LCL.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,CON./,CND.*None)
  LCL.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + '/' (*ZERO);

  // PAR.Date Out MM/DD/YY = CONCAT(LCL.Date Out MM/DD/YY,LCL.Year Alpha Usr,CND.*None)
  PAR.Date_Out_MM_DD_YY = LCL.Date_Out_MM_DD_YY + LCL.Year_Alpha_Usr (*ZERO);

 }

 // LCL.Text 200 = CONCAT(CON.Delivery Dates -,LCL.Date Out MM/DD/YY,CND.*One)
 LCL.Text_200 = 'Delivery Dates -' + LCL.Date_Out_MM_DD_YY (1);

 // LCL.Text 200 = CONCAT(LCL.Text 200,CON.thru,CND.*One)
 LCL.Text_200 = LCL.Text_200 + 'thru' (1);

 // LCL.Text 200 = CONCAT(LCL.Text 200,LCL.Date MM/DD/YY,CND.*One)
 LCL.Text_200 = LCL.Text_200 + LCL.Date_MM_DD_YY (1);

 ENDIF;

 ENDIF;

 //?Retrieve the From user for Email
 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(DB1.PDW_Company_Number);
 PARAMETER('DLVSCHFROM');
 PARAMETER(LCL.Override_User_Option_USR);

 //?Build Producer Distribution Wrk file for Sequel Viewpoint
 // Call program Prt3Delivery Schedule CL.
 CALL PROGRAM(Prt3Delivery Schedule CL) ('PWFFUPC');
 PARAMETER(DB1.PDW_Email);
 PARAMETER(LCL.Email_Subject_50_USR);
 PARAMETER(LCL.Text_200);

}


