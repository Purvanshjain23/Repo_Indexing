     H/TITLE Dsp Sel RIN for shipmnDF  Display file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Displays the records from DBF as a subfile
     H* - Loads the SFL from the DBF a page at a time
     H* - The DBF record at which the SFL display starts may be
     H*   controlled by positioning fields on the SFL header
     H* - Any key fields on the SFL header will be used as
     H*   positioning values
     H* - Any non-key fields on the SFL header will be used as
     H*   selection values: a maximum of W0SLM records will be
     H*   read from the DBF before giving up
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Display file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 04/21/20  Time  : 13:35:42
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNOKDFR#CF  E                    WORKSTN
     F                                        ##RR  KSFILE #SFLRCD
     F                                              KINFDS INFDS#
      * DSP: Dsp Sel RIN for shipmnDF  Display file
      *
     FPMDACPL9IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RSQ : COA Batch Header RIN      Whse/Co/ULSD/Btch/Ord,se
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPMDACPLDIF  E           K        DISK
      * RSQ : COA Batch Header RIN      CO/ULSD/Batch/Seq
      *
     FOMFNCPL1IF  E           K        DISK
      * RTV : Manifest Detail           Retrieval index
      *
     FPNFPCPL2IF  E           K        DISK
      * RSQ : Manifest Detail RIN Sell  Ulsd Co/Batch/Seq
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPNGJREL1IF  E           K        DISK
      * RTV : RFS API Volume Corr Table Retrieval index
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFNCPL3IF  E           K        DISK
      * RSQ : Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCABZRELDIF  E           K        DISK
      * RTV : Company Item              Active Items Only
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FOMFNCPL0IF  E           K        DISK                      A
      * UPD : Manifest Detail           Update index
      *
     FPNFPCPL0IF  E           K        DISK                      A
      * UPD : Manifest Detail RIN Sell  Update index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@DACPDR
      * COA Batch Header RIN      CO/ULSD/Batch/Seq
      * Renamed input format fields
     I              DAAIC3                          WAAIC3
     I              DAL6T1                          WAL6T1
     I              DAI3NY                          WAI3NY
     I              DAJYNY                          WAJYNY
     I              DAQ1NY                          WAQ1NY
     I              DAMUT1                          WAMUT1
     I              DAJZNY                          WAJZNY
     I              DAJ0NY                          WAJ0NY
     I              DAJ2NY                          WAJ2NY
     I              DARIDT                          WARIDT
     I              DAC5TM                          WAC5TM
     I              DAMVT1                          WAMVT1
     I              DAMWT1                          WAMWT1
     I              DARINT                          WARINT
     I              DARJDT                          WARJDT
     I              DAC6TM                          WAC6TM
     I              DAC4NB                          WAC4NB
     I              DADPNB                          WADPNB
     I              DAUENB                          WAUENB
     I              DARZNB                          WARZNB
     I              DANGT1                          WANGT1
     I              DARMNB                          WARMNB
     I              DARKDT                          WARKDT
     I              DAC7TM                          WAC7TM
     I              DARINS                          WARINS
     I              DAMXT1                          WAMXT1
     I              DAG3ST                          WAG3ST
     I              DAQWNY                          WAQWNY
     I              DAL0AA                          WAL0AA
     I              DAMAT1                          WAMAT1
     I              DATDNA                          WATDNA
     I              DACWC3                          WACWC3
     I              DAQXNY                          WAQXNY
     I              DAQZNY                          WAQZNY
     I              DAQ0NY                          WAQ0NY
     I              DALVTX                          WALVTX
     I              DANYT1                          WANYT1
     I              DAG5ST                          WAG5ST
     I              DAG7ST                          WAG7ST
     I              DATFDT                          WATFDT
     I              DATGDT                          WATGDT
     I              DAWIT1                          WAWIT1
     I              DAQYNY                          WAQYNY
     I              DAL7T1                          WAL7T1
     I              DAR8NY                          WAR8NY
     I              DAR0NY                          WAR0NY
     I              DAI7AA                          WAI7AA
     I              DAMXAA                          WAMXAA
     I              DAMSAA                          WAMSAA
     I              DAR7NY                          WAR7NY
     I              DAHEPR                          WAHEPR
     I              DAHFPR                          WAHFPR
     I              DAWVT1                          WAWVT1
     I              DAW0T1                          WAW0T1
     I              DAR5NY                          WAR5NY
     I              DAW1T1                          WAW1T1
     I              DAR6NY                          WAR6NY
     I              DAJ1ST                          WAJ1ST
     I              DAKHST                          WAKHST
     I              DATWDT                          WATWDT
     I              DADUTM                          WADUTM
     I              DAKGST                          WAKGST
     I              DATVDT                          WATVDT
     I              DADTTM                          WADTTM
     I              DAR9NY                          WAR9NY
     I              DASQNY                          WASQNY
     I              DABHR3                          WABHR3
     I              DASRNY                          WASRNY
     I              DAW7T1                          WAW7T1
     I              DAW8T1                          WAW8T1
     I              DAT2DT                          WAT2DT
     I              DASXNY                          WASXNY
     I              DASYNY                          WASYNY
     I              DASZNY                          WASZNY
     I              DAVSST                          WAVSST
     I              DAMJDT                          WAMJDT
     I              DABETM                          WABETM
     I              DACCVN                          WACCVN
     I              DACDVN                          WACDVN
     I              DAMKDT                          WAMKDT
     I              DABFTM                          WABFTM
     I              DACEVN                          WACEVN
     I              DACFVN                          WACFVN
      *
     I@FNCPUW
      * Manifest Detail           Co/Ord/Seq/SecSq/Cs(d)
      * Renamed input format fields
     I              FNAIC3                          WBAIC3
     I              FNC4NB                          WBC4NB
     I              FNDPNB                          WBDPNB
     I              FNUENB                          WBUENB
     I              FNRZNB                          WBRZNB
     I              FNFOQT                          WBFOQT
     I              FNR0NB                          WBR0NB
     I              FNPMST                          WBPMST
     I              FNK7DT                          WBK7DT
     I              FNPFNX                          WBPFNX
     I              FNHGCD                          WBHGCD
     I              FNAJCD                          WBAJCD
     I              FNELDT                          WBELDT
     I              FNN5WG                          WBN5WG
     I              FNRZNA                          WBRZNA
     I              FNH5NY                          WBH5NY
     I              FNH6NY                          WBH6NY
     I              FNH7NY                          WBH7NY
     I              FNGBTX                          WBGBTX
     I              FNN6WG                          WBN6WG
     I              FNN7WG                          WBN7WG
     I              FNGCTX                          WBGCTX
     I              FNGDTX                          WBGDTX
     I              FNRBDT                          WBRBDT
     I              FNITNY                          WBITNY
     I              FNIVNY                          WBIVNY
     I              FNIUNY                          WBIUNY
     I              FNIWNY                          WBIWNY
     I              FNIXNY                          WBIXNY
     I              FNIYNY                          WBIYNY
     I              FNUVST                          WBUVST
     I              FNUWST                          WBUWST
     I              FNUXST                          WBUXST
     I              FNVSST                          WBVSST
     I              FNAATM                          WBAATM
     I              FNAYNA                          WBAYNA
     I              FNA0NA                          WBA0NA
     I              FNAXDT                          WBAXDT
      *
     I@FNCPCS
      * Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
      *
     I@FPCPDO
      * Manifest Detail RIN Sell  Update index
      * Renamed input format fields
     I              FPAIC3                          WDAIC3
     I              FPC4NB                          WDC4NB
     I              FPDPNB                          WDDPNB
     I              FPUENB                          WDUENB
     I              FPRZNB                          WDRZNB
     I              FPL6T1                          WDL6T1
     I              FPI3NY                          WDI3NY
     I              FPJYNY                          WDJYNY
     I              FPQ1NY                          WDQ1NY
     I              FPN6WG                          WDN6WG
     I              FPRCNY                          WDRCNY
     I              FPHJST                          WDHJST
     I              FPVSST                          WDVSST
     I              FPMJDT                          WDMJDT
     I              FPBETM                          WDBETM
     I              FPCCVN                          WDCCVN
     I              FPCDVN                          WDCDVN
     I              FPMKDT                          WDMKDT
     I              FPBFTM                          WDBFTM
     I              FPCEVN                          WDCEVN
     I              FPCFVN                          WDCFVN
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WEAIC3
     I              AMC4NB                          WEC4NB
     I              AMRMNB                          WERMNB
     I              AMRUNB                          WERUNB
     I              AMXACD                          WEXACD
     I              AMOANA                          WEOANA
     I              AMHBAA                          WEHBAA
     I              AMJ0T1                          WEJ0T1
     I              AMGENY                          WEGENY
     I              AMJ1T1                          WEJ1T1
     I              AMHCAA                          WEHCAA
     I              AMQWDT                          WEQWDT
     I              AMQXDT                          WEQXDT
     I              AMQYDT                          WEQYDT
     I              AMHDAA                          WEHDAA
     I              AMCCTX                          WECCTX
     I              AMJ2T1                          WEJ2T1
     I              AMRLNA                          WERLNA
     I              AMRMNA                          WERMNA
     I              AMGINY                          WEGINY
     I              AMGFNY                          WEGFNY
     I              AMGGNY                          WEGGNY
     I              AMGHNY                          WEGHNY
     I              AMHEVL                          WEHEVL
     I              AMHFVL                          WEHFVL
     I              AMHGVL                          WEHGVL
     I              AMQZDT                          WEQZDT
     I              AMQ0DT                          WEQ0DT
     I              AMQ1DT                          WEQ1DT
     I              AMQ2DT                          WEQ2DT
     I              AMC2TX                          WEC2TX
     I              AMC3TX                          WEC3TX
     I              AMC6TX                          WEC6TX
     I              AMCHTX                          WECHTX
     I              AMCITX                          WECITX
     I              AMCLTX                          WECLTX
     I              AMB4TX                          WEB4TX
     I              AMCUTX                          WECUTX
     I              AMCVTX                          WECVTX
     I              AMB9TX                          WEB9TX
     I              AMJWSC                          WEJWSC
     I              AMITNY                          WEITNY
     I              AMLMT1                          WELMT1
     I              AMLWAA                          WELWAA
     I              AMFVST                          WEFVST
     I              AMF0ST                          WEF0ST
     I              AMF2ST                          WEF2ST
     I              AMF3ST                          WEF3ST
     I              AMJUSC                          WEJUSC
     I              AMJVSC                          WEJVSC
     I              AMV3T1                          WEV3T1
     I              AMV4T1                          WEV4T1
     I              AMV5T1                          WEV5T1
     I              AMV6T1                          WEV6T1
     I              AMV7T1                          WEV7T1
     I              AMV8T1                          WEV8T1
     I              AMV9T1                          WEV9T1
     I              AMWAT1                          WEWAT1
     I              AMWBT1                          WEWBT1
     I              AMWCT1                          WEWCT1
     I              AMWDT1                          WEWDT1
     I              AMQJNY                          WEQJNY
     I              AMQKNY                          WEQKNY
     I              AMQLNY                          WEQLNY
     I              AMP8NY                          WEP8NY
     I              AMP9NY                          WEP9NY
     I              AMQANY                          WEQANY
     I              AMQCNY                          WEQCNY
     I              AMQDNY                          WEQDNY
     I              AMQENY                          WEQENY
     I              AMQFNY                          WEQFNY
     I              AMQGNY                          WEQGNY
     I              AMQHNY                          WEQHNY
     I              AMQINY                          WEQINY
     I              AMQMNY                          WEQMNY
     I              AMMYU1                          WEMYU1
     I              AMJXSC                          WEJXSC
     I              AMJYSC                          WEJYSC
     I              AMJZSC                          WEJZSC
     I              AMJ0SC                          WEJ0SC
     I              AMMZU1                          WEMZU1
     I              AMM0U1                          WEM0U1
     I              AMM1U1                          WEM1U1
     I              AMM2U1                          WEM2U1
     I              AMM3U1                          WEM3U1
     I              AMW5DT                          WEW5DT
     I              AMW6DT                          WEW6DT
     I              AMUVST                          WEUVST
     I              AMUWST                          WEUWST
     I              AMUXST                          WEUXST
     I              AMVSST                          WEVSST
     I              AMAATM                          WEAATM
     I              AMAYNA                          WEAYNA
     I              AMA0NA                          WEA0NA
     I              AMAXDT                          WEAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     IQOMFN1    E DSOMFNCPL0
      * UPD : Manifest Detail           Update index
      * Renamed input format fields
     I              FNAIC3                          WCAIC3
     I              FNC4NB                          WCC4NB
     I              FNDPNB                          WCDPNB
     I              FNUENB                          WCUENB
     I              FNRZNB                          WCRZNB
     I              FNFOQT                          WCFOQT
     I              FNR0NB                          WCR0NB
     I              FNPMST                          WCPMST
     I              FNK7DT                          WCK7DT
     I              FNPFNX                          WCPFNX
     I              FNHGCD                          WCHGCD
     I              FNAJCD                          WCAJCD
     I              FNELDT                          WCELDT
     I              FNN5WG                          WCN5WG
     I              FNRZNA                          WCRZNA
     I              FNH5NY                          WCH5NY
     I              FNH6NY                          WCH6NY
     I              FNH7NY                          WCH7NY
     I              FNGBTX                          WCGBTX
     I              FNN6WG                          WCN6WG
     I              FNN7WG                          WCN7WG
     I              FNGCTX                          WCGCTX
     I              FNGDTX                          WCGDTX
     I              FNRBDT                          WCRBDT
     I              FNITNY                          WCITNY
     I              FNIVNY                          WCIVNY
     I              FNIUNY                          WCIUNY
     I              FNIWNY                          WCIWNY
     I              FNIXNY                          WCIXNY
     I              FNIYNY                          WCIYNY
     I              FNUVST                          WCUVST
     I              FNUWST                          WCUWST
     I              FNUXST                          WCUXST
     I              FNVSST                          WCVSST
     I              FNAATM                          WCAATM
     I              FNAYNA                          WCAYNA
     I              FNA0NA                          WCA0NA
     I              FNAXDT                          WCAXDT
      *
     IQPNFP1    E DSPNFPCPL0
      * UPD : Manifest Detail RIN Sell  Update index
      * Renamed input format fields
     I              FPAIC3                          WDAIC3
     I              FPC4NB                          WDC4NB
     I              FPDPNB                          WDDPNB
     I              FPUENB                          WDUENB
     I              FPRZNB                          WDRZNB
     I              FPL6T1                          WDL6T1
     I              FPI3NY                          WDI3NY
     I              FPJYNY                          WDJYNY
     I              FPQ1NY                          WDQ1NY
     I              FPN6WG                          WDN6WG
     I              FPRCNY                          WDRCNY
     I              FPHJST                          WDHJST
     I              FPVSST                          WDVSST
     I              FPMJDT                          WDMJDT
     I              FPBETM                          WDBETM
     I              FPCCVN                          WDCCVN
     I              FPCDVN                          WDCDVN
     I              FPMKDT                          WDMKDT
     I              FPBFTM                          WDBFTM
     I              FPCEVN                          WDCEVN
     I              FPCFVN                          WDCFVN
      *
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WEAIC3
     I              AMC4NB                          WEC4NB
     I              AMRMNB                          WERMNB
     I              AMRUNB                          WERUNB
     I              AMXACD                          WEXACD
     I              AMOANA                          WEOANA
     I              AMHBAA                          WEHBAA
     I              AMJ0T1                          WEJ0T1
     I              AMGENY                          WEGENY
     I              AMJ1T1                          WEJ1T1
     I              AMHCAA                          WEHCAA
     I              AMQWDT                          WEQWDT
     I              AMQXDT                          WEQXDT
     I              AMQYDT                          WEQYDT
     I              AMHDAA                          WEHDAA
     I              AMCCTX                          WECCTX
     I              AMJ2T1                          WEJ2T1
     I              AMRLNA                          WERLNA
     I              AMRMNA                          WERMNA
     I              AMGINY                          WEGINY
     I              AMGFNY                          WEGFNY
     I              AMGGNY                          WEGGNY
     I              AMGHNY                          WEGHNY
     I              AMHEVL                          WEHEVL
     I              AMHFVL                          WEHFVL
     I              AMHGVL                          WEHGVL
     I              AMQZDT                          WEQZDT
     I              AMQ0DT                          WEQ0DT
     I              AMQ1DT                          WEQ1DT
     I              AMQ2DT                          WEQ2DT
     I              AMC2TX                          WEC2TX
     I              AMC3TX                          WEC3TX
     I              AMC6TX                          WEC6TX
     I              AMCHTX                          WECHTX
     I              AMCITX                          WECITX
     I              AMCLTX                          WECLTX
     I              AMB4TX                          WEB4TX
     I              AMCUTX                          WECUTX
     I              AMCVTX                          WECVTX
     I              AMB9TX                          WEB9TX
     I              AMJWSC                          WEJWSC
     I              AMITNY                          WEITNY
     I              AMLMT1                          WELMT1
     I              AMLWAA                          WELWAA
     I              AMFVST                          WEFVST
     I              AMF0ST                          WEF0ST
     I              AMF2ST                          WEF2ST
     I              AMF3ST                          WEF3ST
     I              AMJUSC                          WEJUSC
     I              AMJVSC                          WEJVSC
     I              AMV3T1                          WEV3T1
     I              AMV4T1                          WEV4T1
     I              AMV5T1                          WEV5T1
     I              AMV6T1                          WEV6T1
     I              AMV7T1                          WEV7T1
     I              AMV8T1                          WEV8T1
     I              AMV9T1                          WEV9T1
     I              AMWAT1                          WEWAT1
     I              AMWBT1                          WEWBT1
     I              AMWCT1                          WEWCT1
     I              AMWDT1                          WEWDT1
     I              AMQJNY                          WEQJNY
     I              AMQKNY                          WEQKNY
     I              AMQLNY                          WEQLNY
     I              AMP8NY                          WEP8NY
     I              AMP9NY                          WEP9NY
     I              AMQANY                          WEQANY
     I              AMQCNY                          WEQCNY
     I              AMQDNY                          WEQDNY
     I              AMQENY                          WEQENY
     I              AMQFNY                          WEQFNY
     I              AMQGNY                          WEQGNY
     I              AMQHNY                          WEQHNY
     I              AMQINY                          WEQINY
     I              AMQMNY                          WEQMNY
     I              AMMYU1                          WEMYU1
     I              AMJXSC                          WEJXSC
     I              AMJYSC                          WEJYSC
     I              AMJZSC                          WEJZSC
     I              AMJ0SC                          WEJ0SC
     I              AMMZU1                          WEMZU1
     I              AMM0U1                          WEM0U1
     I              AMM1U1                          WEM1U1
     I              AMM2U1                          WEM2U1
     I              AMM3U1                          WEM3U1
     I              AMW5DT                          WEW5DT
     I              AMW6DT                          WEW6DT
     I              AMUVST                          WEUVST
     I              AMUWST                          WEUWST
     I              AMUXST                          WEUXST
     I              AMVSST                          WEVSST
     I              AMAATM                          WEAATM
     I              AMAYNA                          WEAYNA
     I              AMA0NA                          WEA0NA
     I              AMAXDT                          WEAXDT
      *
     IYBRDCS      DS                            894
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WGAIC3
     I              OMC4NB                          WGC4NB
     I              OMDPNB                          WGDPNB
     I              OMUENB                          WGUENB
     I              OMHGCD                          WGHGCD
     I              OMAJCD                          WGAJCD
     I              OMBKC7                          WGBKC7
     I              OMCFC7                          WGCFC7
     I              OMGMST                          WGGMST
     I              OMGNST                          WGGNST
     I              OMMAVA                          WGMAVA
     I              OMKDVA                          WGKDVA
     I              OML8VA                          WGL8VA
     I              OML9VA                          WGL9VA
     I              OMGTST                          WGGTST
     I              OMGVST                          WGGVST
     I              OMGUST                          WGGUST
     I              OMQFST                          WGQFST
     I              OMAYVA                          WGAYVA
     I              OMEXDT                          WGEXDT
     I              OMLQCD                          WGLQCD
     I              OMRDCD                          WGRDCD
     I              OMQ7CD                          WGQ7CD
     I              OMBZPR                          WGBZPR
     I              OML6NB                          WGL6NB
     I              OMU1ST                          WGU1ST
     I              OMGIDT                          WGGIDT
     I              OMCRCD                          WGCRCD
     I              OMAGCD                          WGAGCD
     I              OMRZST                          WGRZST
     I              OMR0ST                          WGR0ST
     I              OMR1ST                          WGR1ST
     I              OMG7NA                          WGG7NA
     I              OMG8NA                          WGG8NA
     I              OMRPCD                          WGRPCD
     I              OMVEST                          WGVEST
     I              OMVGST                          WGVGST
     I              OMAVST                          WGAVST
     I              OMU0ST                          WGU0ST
     I              OMRFCD                          WGRFCD
     I              OMFZST                          WGFZST
     I              OMR1NB                          WGR1NB
     I              OMAVQT                          WGAVQT
     I              OMD0WG                          WGD0WG
     I              OMCCQT                          WGCCQT
     I              OMAUWG                          WGAUWG
     I              OMCBQT                          WGCBQT
     I              OMATWG                          WGATWG
     I              OMAQCS                          WGAQCS
     I              OMAGCS                          WGAGCS
     I              OMAKPR                          WGAKPR
     I              OMALPR                          WGALPR
     I              OMAUPR                          WGAUPR
     I              OMAVWG                          WGAVWG
     I              OMA4WG                          WGA4WG
     I              OMA5DT                          WGA5DT
     I              OMAODT                          WGAODT
     I              OMGNDT                          WGGNDT
     I              OMAMST                          WGAMST
     I              OMANST                          WGANST
     I              OMVAST                          WGVAST
     I              OMRGNB                          WGRGNB
     I              OMRHNB                          WGRHNB
     I              OMRINB                          WGRINB
     I              OMRBCD                          WGRBCD
     I              OMHICD                          WGHICD
     I              OMRNCD                          WGRNCD
     I              OMROCD                          WGROCD
     I              OMCXDT                          WGCXDT
     I              OMAJVN                          WGAJVN
     I              OMKXCD                          WGKXCD
     I              OMJPCD                          WGJPCD
     I              OMCQCD                          WGCQCD
     I              OMR4CD                          WGR4CD
     I              OMZ1ST                          WGZ1ST
     I              OMZ3ST                          WGZ3ST
     I              OMZ4ST                          WGZ4ST
     I              OMDUPR                          WGDUPR
     I              OMB6VL                          WGB6VL
     I              OMA1AA                          WGA1AA
     I              OMFZSX                          WGFZSX
     I              OMF0SX                          WGF0SX
     I              OMF1SX                          WGF1SX
     I              OMF2SX                          WGF2SX
     I              OMF3SX                          WGF3SX
     I              OMF4SX                          WGF4SX
     I              OMF5SX                          WGF5SX
     I              OMF6SX                          WGF6SX
     I              OMF7SX                          WGF7SX
     I              OMNTDT                          WGNTDT
     I              OMNUDT                          WGNUDT
     I              OMNVDT                          WGNVDT
     I              OMNWDT                          WGNWDT
     I              OMNXDT                          WGNXDT
     I              OMBUTM                          WGBUTM
     I              OMBVTM                          WGBVTM
     I              OMBWTM                          WGBWTM
     I              OMBXTM                          WGBXTM
     I              OMBYTM                          WGBYTM
     I              OMH5NX                          WGH5NX
     I              OMH6NX                          WGH6NX
     I              OMH7NX                          WGH7NX
     I              OMH8NX                          WGH8NX
     I              OMH9NX                          WGH9NX
     I              OMDVPR                          WGDVPR
     I              OMDWPR                          WGDWPR
     I              OMDXPR                          WGDXPR
     I              OMDYPR                          WGDYPR
     I              OMDZPR                          WGDZPR
     I              OMGSPR                          WGGSPR
     I              OMGTPR                          WGGTPR
     I              OMGUPR                          WGGUPR
     I              OMHOST                          WGHOST
     I              OMHPST                          WGHPST
     I              OMIOST                          WGIOST
     I              OMPEWG                          WGPEWG
     I              OMRINY                          WGRINY
     I              OMTIDT                          WGTIDT
     I              OMTJDT                          WGTJDT
     I              OMH2ST                          WGH2ST
     I              OMH0ST                          WGH0ST
     I              OMH1ST                          WGH1ST
     I              OMTKDT                          WGTKDT
     I              OMTLDT                          WGTLDT
     I              OMTMDT                          WGTMDT
     I              OMUVST                          WGUVST
     I              OMUWST                          WGUWST
     I              OMUXST                          WGUXST
     I              OMAATM                          WGAATM
     I              OMAYNA                          WGAYNA
     I              OMA0NA                          WGA0NA
     I              OMAXDT                          WGAXDT
      *
     IYCRDCS      DS                            525
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: COA Batch Header RIN
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I : RST COA Ship To Warehouse
     I                                        3   5 P1L0AA
     IP2PARM      DS
      * FLD: Order Detail
      * I :  Order Number
     I                                    P   1   40P2C4NB
      * I :  Order Sequence Number
     I                                    P   5   60P2DPNB
      * I :  Order Secondary Line Seq
     I                                    P   7   80P2UENB
      * I :  Item Code
     I                                    P   9  120P2HGCD
      * I :  Warehouse Code
     I                                       13  15 P2AJCD
     IP3PARM      DS
      * I :  Load ID
     I                                    P   1   40P3RMNB
     IP4PARM      DS
      * I :  Carrier Broker
     I                                        1   3 P4XCCD
     IP5PARM      DS
      * O :  Status - Y or N
     I                                        1   1 P5B8ST
     IP6PARM      DS
      * I :  Customer Purchase Order #
     I                                        1  15 P6BCNA
     IP7PARM      DS
      * B :  COA Temperature Loadout
     I                                    P   1   20P7JENY
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1L0AA    PARM           WP0002  3        COA Ship To War
     C           P2C4NB    PARM           WP0003  70       Order Number
     C           P2DPNB    PARM           WP0004  30       Order Sequence
     C           P2UENB    PARM           WP0005  30       Order Secondary
     C           P2HGCD    PARM           WP0006  70       Item Code
     C           P2AJCD    PARM           WP0007  3        Warehouse Code
     C           P3RMNB    PARM           WP0008  70       Load ID
     C           P4XCCD    PARM           WP0009  3        Carrier Broker
     C           P5B8ST    PARM P5B8ST    WP0010  1        Status - Y or N
     C           P6BCNA    PARM           WP0011 15        Customer Purcha
     C           P7JENY    PARM P7JENY    WP0012  30       COA Temperature
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
     C                     DO   *HIVAL
      * Initialise & load subfile page
     C                     EXSR BAIZSF
     C                     MOVEL'N'       W0RSF   1
      * Display screen until reload requested
     C           W0RSF     DOWEQ'N'
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Request subfile reload
     C   30                CAS            FBRQRL
      * Display next SFL page
     C   27                CAS            BBLDSF
      * Process screen input
     C                     CAS            DAPR##
     C                     END
      *
     C                     END                             OD W0RSF
     C                     END                             OD *HIVAL
      *****************************************************************
      /EJECT
     CSR         BAIZSF    BEGSR
      *================================================================
      * Initialise and load subfile page
      *================================================================
      * Clear subfile
     C                     SETON                     80
     C                     WRITE#SFLCTL
     C                     SETOF                     80
      * Reset no of records in subfile
     C                     Z-ADD*ZERO     ##RRMX  50 81     SETOF 81
      * USER: Initialize subfile control
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
      * Company Name DRV
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
      * Warehouse Desc DRV
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SBRVGN
     C                     MOVELP6BCNA    #CBCNA           Customer Purcha
     C                     Z-ADDP7JENY    #CJENY           COA Temperature
      * Position DBF file
     C           KPOS      KLIST
     C                     KFLD           DAL0AA           COA Ship To War
     C                     KFLD           DAAIC3           Company Number
     C                     KFLD           DAI3NY           COA Batch Numbe
     C                     KFLD           DAJYNY           COA Batch Heade
     C                     KFLD           DAQ1NY           COA Batch Hdr R
     C                     KFLD           DAC4NB           Order Number
      * Setup key
     C                     MOVEL#2L0AA    DAL0AA
     C                     Z-ADD#2AIC3    DAAIC3
     C                     Z-ADD#2I3NY    DAI3NY
     C                     Z-ADD#2JYNY    DAJYNY
     C                     Z-ADD#2Q1NY    DAQ1NY
     C                     Z-ADD#2C4NB    DAC4NB
     C           KPOS      SETLL@DACPDK
     C           KRST      KLIST
     C                     KFLD           DAL0AA           COA Ship To War
      * Setup key
     C                     MOVEL#2L0AA    DAL0AA
     C           KRST      READE@DACPDK                8782*82=EOF
      * Save previous selector values
     C           *LIKE     DEFN #CSQTX    WZSQTX
     C                     MOVEL#CSQTX    WZSQTX           Company Name DR
     C           *LIKE     DEFN #2MUT1    WZMUT1
     C                     MOVEL#2MUT1    WZMUT1           COA Batch Heade
     C           *LIKE     DEFN #2L0AA    WZL0AA
     C                     MOVEL#2L0AA    WZL0AA           COA Ship To War
     C           *LIKE     DEFN #CO6NA    WZO6NA
     C                     MOVEL#CO6NA    WZO6NA           Warehouse Desc
     C           *LIKE     DEFN #2AIC3    WZAIC3
     C                     MOVEL#2AIC3    WZAIC3           Company Number
     C           *LIKE     DEFN #2L6T1    WZL6T1
     C                     MOVEL#2L6T1    WZL6T1           COA ULSD Compan
     C           *LIKE     DEFN #2I3NY    WZI3NY
     C                     MOVEL#2I3NY    WZI3NY           COA Batch Numbe
     C           *LIKE     DEFN #2JYNY    WZJYNY
     C                     MOVEL#2JYNY    WZJYNY           COA Batch Heade
     C           *LIKE     DEFN #2Q1NY    WZQ1NY
     C                     MOVEL#2Q1NY    WZQ1NY           COA Batch Hdr R
     C           *LIKE     DEFN #2TDNA    WZTDNA
     C                     MOVEL#2TDNA    WZTDNA           COA RIN Custome
     C           *LIKE     DEFN #2C4NB    WZC4NB
     C                     MOVEL#2C4NB    WZC4NB           Order Number
     C           *LIKE     DEFN #2RIDT    WZRIDT
     C                     MOVEL#2RIDT    WZRIDT           COA RIN Transac
     C           *LIKE     DEFN #2I7AA    WZI7AA
     C                     MOVEL#2I7AA    WZI7AA           RFS Transaction
     C           *LIKE     DEFN #2TFDT    WZTFDT
     C                     MOVEL#2TFDT    WZTFDT           COA BHR Net Gal
     C           *LIKE     DEFN #2J2NY    WZJ2NY
     C                     MOVEL#2J2NY    WZJ2NY           COA RIN Volume
      * Translate search mask for text field
     C                     MOVEL'QSYST'   WQB10X 10
     C                     MOVE 'RNTBL'   WQB10X
     C           *LIKE     DEFN #2TDNA    WQTDNA           COA RIN Custome
     C                     CALL 'QDCXLATE'
      * Length
     C                     PARM 15        WQA5N   50
     C                     PARM #2TDNA    WQTDNA           COA RIN Custome
     C                     PARM           WQB10X           QSYSTRNTBL
     C                     PARM 'QSYS'    WQC10X 10
      * Load subfile page
     C                     Z-ADD0         ##RROK  50
     C                     EXSR BBLDSF
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBLDSF    BEGSR
      *================================================================
      * Load subfile page
      *================================================================
      * Re-establish fields in read-ahead record
     C   27                DO
     C  N82                READP@DACPDK                  90*
     C  N82                READ @DACPDK                  90*
     C                     END
      *
      * Setof record error indicators
     C                     MOVEL*ALL'0'   WKIND0  1
     C                     MOVEAWKIND0    *IN,37
      * Start at previous highest record in SFL
     C                     Z-ADD##RRMX    ##RR    50
      * Reset count of DBF records read
     C                     Z-ADD0         ##RRRD  90
      * Set required pages based on *Set Cursor or *Subfile Pages
     C           W0RR0     IFGT 0
     C           W0RR0     DIV  ##SFPG    ##SPG   30
     C                     MVR            ##SLIN  30
     C           ##SLIN    IFGT 0
     C                     ADD  1         ##SPG
     C                     END
     C           W0SPG     IFGT ##SPG
     C                     Z-ADDW0SPG     ##SPG
     C                     END
     C                     ELSE
     C                     Z-ADDW0SPG     ##SPG
     C                     END
      * Compute lines required based on pages
     C           ##SPG     MULT ##SFPG    ##SFLN  90
     C           ##SFLN    IFGT 999
     C                     Z-ADD999       ##SFLN
     C                     END
      *................................................................
      * Load next SFL page until SFL page full, or
      * Scan limit reached
     C           *IN82     DOWEQ'0'                        DO
     C           ##RROK    ANDLT##SFLN
     C           ##RRRD    ANDLTW0SLM
      * Check selection fields - if fail, read next record
     C           #2MUT1    IFNE *BLANK                     COA Batch Heade
     C           DAMUT1    CABNE#2MUT1    BB020            COA Batch Heade
     C                     END
     C           #2L6T1    IFNE *BLANK                     COA ULSD Compan
     C           DAL6T1    CABNE#2L6T1    BB020            COA ULSD Compan
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2I3NY    IFNE *ZERO                      COA Batch Numbe
     C           DAI3NY    CABNE#2I3NY    BB020            COA Batch Numbe
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2I3NY    OREQ *ZERO                      COA Batch Numbe
     C           #2JYNY    IFNE *ZERO                      COA Batch Heade
     C           DAJYNY    CABNE#2JYNY    BB020            COA Batch Heade
     C                     END
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2I3NY    OREQ *ZERO                      COA Batch Numbe
     C           #2JYNY    OREQ *ZERO                      COA Batch Heade
     C           #2Q1NY    IFNE *ZERO                      COA Batch Hdr R
     C           DAQ1NY    CABNE#2Q1NY    BB020            COA Batch Hdr R
     C                     END
     C                     END
     C           #2TDNA    IFNE *BLANK                     COA RIN Custome
      * Scan for search string
     C                     CALL 'QCLSCAN'
     C                     PARM           DATDNA           COA RIN Custome
      * Length
     C                     PARM 15        WQA3N   30
      * Start
     C                     PARM 1         WQB3N   30
      * Mask
     C                     PARM           WQTDNA
      * Length
     C                     PARM 15        WQC3N   30
      * Translate
     C                     PARM '1'       WQD1    1
      * Trim
     C                     PARM '1'       WQE1    1
      * Wild
     C                     PARM '?'       WQF1    1
      * Result
     C                     PARM           WQG3N   30
     C           WQG3N     CABLT1         BB020
     C                     END
     C           #2AIC3    IFEQ *ZERO                      Company Number
     C           #2I3NY    OREQ *ZERO                      COA Batch Numbe
     C           #2JYNY    OREQ *ZERO                      COA Batch Heade
     C           #2Q1NY    OREQ *ZERO                      COA Batch Hdr R
     C           #2C4NB    IFNE *ZERO                      Order Number
     C           DAC4NB    CABNE#2C4NB    BB020            Order Number
     C                     END
     C                     END
     C           #2RIDT    IFNE *ZERO                      COA RIN Transac
     C           DARIDT    CABNE#2RIDT    BB020            COA RIN Transac
     C                     END
     C           #2I7AA    IFNE *BLANK                     RFS Transaction
     C           DAI7AA    CABNE#2I7AA    BB020            RFS Transaction
     C                     END
     C           #2TFDT    IFNE *ZERO                      COA BHR Net Gal
     C           DATFDT    CABNE#2TFDT    BB020            COA BHR Net Gal
     C                     END
     C           #2J2NY    IFNE *ZERO                      COA RIN Volume
     C           DAJ2NY    CABNE#2J2NY    BB020            COA RIN Volume
     C                     END
      * Load SFL fields
     C                     EXSR MBFL#1
     C                     MOVEL'Y'       W0RSL   1
      * Allow for possible *Set Cursor processing
     C                     ADD  1         ##RR
      * USER: Initialize subfile record from DBF record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.Company Number is greater than zero
      *   |- c2    : CTL.Company Number NE DB1.Company Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #2AIC3    IFGT *ZERO                      *IF
     C           #2AIC3    IFNE DAAIC3                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: RCD.RFS Transaction Type is Buy
     C           #1I7AA    IFEQ 'BUY'                      *IF
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SCRVGN
      * T14912 RMC 7/16/19 added company to key
      * Rtv Order for Ext Sel RT - COA Batch Header RIN  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * RTV HPB Gross Gall    RT - Manifest Detail  * 
     C                     EXSR SERVGN
     C                     Z-ADD*ZERO     YL0003           HPB Meter Net G
      * RMC added chk to compare batch to batch company 4/20/20
      * RTV RIN Net Sold GallsRT - Manifest Detail RIN Sell  * 
     C                     EXSR SFRVGN
     C                     SUB  YL0003    #1TFDT           COA BHR Net Gal
      * CASE: RCD.COA BHR Net Galls to Sell is Not Entered
     C           #1TFDT    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Calc Factor or Use API Table - Calc  Gross to sell    6/13/12
      * CASE: LCL.RFS Volume Corr Mthd  USR is Calculate factor per Prop
     C           YL0005    IFEQ 'C'                        *IF
      * New formula - after 6/27/10 -  goes in with RFS2/EMTS    P000579
     C                     Z-ADD-.00045767WUJQNY           COA Temp Conv F
     C                     Z-ADD1.02746025WUJRNY           COA Temp Conv F
      * Compute: gross galls
      * LCL.Gross Gallons        USR =
      *    *COMPUTE (x1/ x2)
      * x1    : RCD.COA BHR Net Galls to Sell
      * /     : PGM.*Synon (15,0) work field *
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1TFDT    DIV  WUJSNY    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Gross Gallons
     C                     ELSE
      * CASE: LCL.RFS Volume Corr Mthd  USR is API Volume Corr Table
     C           YL0005    IFEQ 'A'                        *IF
      * Gross gallons from new temp
      * CASE: CTL.COA Temperature Loadout is GT 0
     C           #CJENY    IFGT *ZERO                      *IF
     C                     Z-ADD#CJENY    YL0007           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0001           RFS API Gravity
     C                     Z-ADDYL0007    WL0002           RFS Loadout Tem
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0008           RFS API Vol Cor
     C                     Z-ADDYL0008    WUJSNY           HPB Temperature
      * Compute: gross galls
      * RCD.Quantity Sched 2 USR =
      *    *COMPUTE (x1/ x2)
      * x1    : RCD.COA BHR Net Galls to Sell
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1TFDT    DIV  WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    #RATNX           Quantity Sched
     C                     END                             *FI
      * Gross gallons from orig temp
     C                     Z-ADDDAQYNY    YL0007           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0001           RFS API Gravity
     C                     Z-ADDYL0007    WL0002           RFS Loadout Tem
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0008           RFS API Vol Cor
     C                     Z-ADDYL0008    WUJSNY           HPB Temperature
      * Compute: gross galls
      * RCD.Quantity Sched 1 USR =
      *    *COMPUTE (x1/ x2)
      * x1    : RCD.COA BHR Net Galls to Sell
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1TFDT    DIV  WUJSNY    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    #RASNX           Quantity Sched
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  1         ##RR
      * DBF record not selected
     C           W0RSL     CABNE'Y'       BB020
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Output to subfile
     C                     ADD  1         ##RR
     C                     ADD  1         ##RROK     81    *
      * If SFLRCD invalid, note that errors present
     C   98N99             SETON                     99    *
     C                     WRITE#SFLRCD
     C           BB020     TAG
      * Increment scan check count
     C                     ADD  1         ##RRRD
     C           KRST      READE@DACPDK                  82*82=EOF
     C                     END                             OD 1 - ##SFPG
      *................................................................
     C           BB900     TAG
      *................................................................
      * If no DBF records found, display error message
     C           ##RR      IFEQ *ZERO
     C           *IN82     ANDEQ'1'
      * Send message '*No data to display'
     C                     MOVEL'Y2U0008' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI ##RR = *ZERO
      *
      *................................................................
      * Save highest SFL record load can continue at end point
     C           ##RR      IFGT ##RRMX
      * Calculate top line
     C           ##RROK    DIV  ##SFPG    ##SPG
     C                     MVR            ##SLIN
     C           ##SLIN    IFGT 0
     C           ##RR      SUB  ##SLIN    ##SFRC
     C                     ELSE
     C           ##RR      SUB  ##SFPG    ##SFRC
     C                     END
     C                     ADD  1         ##SFRC
     C                     Z-ADD##RR      ##RRMX
     C                     END
      * If scan limit reached, display error message
     C           ##RRRD    IFGE W0SLM
      * Send message '*Scan limit reached'
     C                     MOVEL'Y2U0017' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     ELSE
     C                     Z-ADD0         ##RROK
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen
      *================================================================
      * Convert fields to external form
     C  N30N27             EXSR MOCV#2
      * Set screen conditioning indicators
     C                     EXSR GBDSA2
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#SFLCTL
      * Maintain subfile position where possible
     C           @#SFRC    IFGT *ZERO
     C                     Z-ADD@#SFRC    ##SFRC
     C                     END
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     SETOF                       8392*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPR##    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      *
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV2AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #2AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * Validate Order Number and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV2C4NB    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ @CN,001                    *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD0         #2C4NB           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #2C4NB           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      *................................................................
     C           YPMTFD    IFNE *BLANKS
     C           YPMRRN    ANDEQ*ZERO
     C                     GOTO DAEXIT
     C                     END
     C           YPMTFD    CABNE*BLANKS   DATAG1
      * Change of position specified
     C           WZAIC3    CASNE#2AIC3    FBRQRL
     C           WZL6T1    CASNE#2L6T1    FBRQRL
     C           WZI3NY    CASNE#2I3NY    FBRQRL
     C           WZJYNY    CASNE#2JYNY    FBRQRL
     C           WZTDNA    CASNE#2TDNA    FBRQRL
     C           WZC4NB    CASNE#2C4NB    FBRQRL
     C                     END
     C           DATAG1    TAG
     C           YPMTFD    IFEQ *BLANKS
      * Reload subfile requested
     C           W0RSF     CABEQ'Y'       DAEXIT
     C                     END
     C           *IN81     IFEQ '1'
      * Process subfile records
     C                     EXSR DBPRSF
     C                     END
     C           YPMTFD    CABNE*BLANKS   DAEXIT
      * USER: Final processing (Pre-confirm)
     C                     MOVEL'Y'       W0RSF            *Reload subfile
      * If error, quit processing
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBPRSF    BEGSR
      *================================================================
      * Process modified subfile record
      *================================================================
      * Read first changed slf record
     C           YAFSCH    IFNE *ZERO
     C           YAFSCH    CHAIN#SFLRCD              92    *
     C                     ELSE
     C                     READC#SFLRCD                  92*
     C                     END
     C           *IN92     DOWEQ'0'
      * Process subfile record
     C                     EXSR DCPRSR
      * Convert fields to external form
     C                     EXSR MNCV#1
     C                     UPDAT#SFLRCD
     C                     READC#SFLRCD                  92*
     C                     END
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DCPRSR    BEGSR
      *================================================================
      * Process subfile record
      *================================================================
      * Setof error indicators and SFLNXTCHG
     C                     MOVEAWKIND0    *IN,37
     C                     SETOF                     98    *
     C           YPMTFD    CABNE*BLANKS   DCEXIT
      * USER: Process subfile record (Pre-confirm)
      * Create SEL RIN from full volume on BUY RIN
      * CASE: RCD.*SFLSEL is *Select
     C           #1SEL     IFEQ '1'                        *IF
     C           #1SEL     OREQ ' 1'
      * Create Manifest & manifest rin sell rcd from order selected
      * CASE: RCD.Order Number is Greater then zero
     C           #1C4NB    IFGT *ZERO                      *IF
      * Selling all remaining gallons
     C                     Z-ADD#1TFDT    YL0009           Quantity 7.0 US
      * CASE:
      *  - c1ANDc2
      *   |- c1    : CTL.COA Temperature Loadout is GT 0
      *   |- c2    : CTL.COA Temperature Loadout NE RCD.COA BHR Loadout T
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #CJENY    IFGT *ZERO                      *IF
     C           #CJENY    IFNE #1QYNY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * E2079 code
      * Calc Factor or Use API Table - 5/03/12
      * CASE: LCL.RFS Volume Corr Mthd  USR is Calculate factor per Prop
     C           YL0005    IFEQ 'C'                        *IF
      * New formula - after 6/27/10 -  goes in with RFS2/EMTS    P000579
     C                     Z-ADD-.00045767WUJQNY           COA Temp Conv F
     C                     Z-ADD1.02746025WUJRNY           COA Temp Conv F
      * Compute: gross galls
      * LCL.Gross Gallons        USR =
      *    *COMPUTE (x1/ x2)
      * x1    : RCD.COA BHR Net Galls to Sell
      * /     : PGM.*Synon (15,0) work field *
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1TFDT    DIV  WUJSNY    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Gross Gallons
     C                     ELSE
      * CASE: LCL.RFS Volume Corr Mthd  USR is API Volume Corr Table
     C           YL0005    IFEQ 'A'                        *IF
     C                     Z-ADD#CJENY    YL0007           RFS Loadout Tem
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD30        WL0001           RFS API Gravity
     C                     Z-ADDYL0007    WL0002           RFS Loadout Tem
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0003    YL0008           RFS API Vol Cor
     C                     Z-ADDYL0008    WUJSNY           HPB Temperature
      * Compute: gross galls
      * LCL.Gross Gallons        USR =
      *    *COMPUTE (x1/ x2)
      * x1    : RCD.COA BHR Net Galls to Sell
      * /     : PGM.*Synon (15,0) work field *
      * x2    : WRK.HPB Temperature Adjustmnt
     C           #1TFDT    DIV  WUJSNY    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    YL0006           Gross Gallons
     C                     END                             *FI
     C                     END                             *FI
      * Do all processing for selling an order
     C                     EXSR UASUBR                     Do all processi
     C                     ELSE
      * CASE: *OTHERWISE
      * orig code
      * Do all processing for selling an order
     C                     EXSR UBSUBR                     Do all processi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create SEL RIN by splitting the BUY RIN
      * CASE: RCD.*SFLSEL is Option 3
     C           #1SEL     IFEQ '3'                        *IF
     C           #1SEL     OREQ ' 3'
     C                     Z-ADD#CJENY    YL0055           COA Temperature
      * Edt SEL RIN-w/order ER - COA Batch Header RIN  * 
     C                     CALL 'PNOPE1R'              90  Edt SEL RIN-w/o
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0001  30       Company Number
     C                     PARM #1L6T1    WQ0002  4        COA ULSD Compan
     C                     PARM #1I3NY    WQ0003  50       COA Batch Numbe
     C                     PARM #1JYNY    WQ0004  50       COA Batch Heade
     C                     PARM #1Q1NY    WQ0005  50       COA Batch Hdr R
     C                     PARM P1AIC3    WQ0006  30       COA Shipping Co
     C           YL0009    PARM *ZERO     WQ0007  70       Quantity 7.0 US
     C           YL0056    PARM YL0056    WQ0008  80       COA RIN Volume
     C           YL0055    PARM YL0055    WQ0009  30       COA Temperature
     C           YL0006    PARM *ZERO     WQ0010  50       Case Quantity
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNOPE1R' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     98    *
     C                     END
      * Create Manifest & manifest rin sell rcd from order selected
      * CASE:
      *  - c1ANDc2
      *   |- c1    : RCD.Order Number is Greater then zero
      *   |- c2    : LCL.Quantity 7.0 USR is Greater than Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1C4NB    IFGT *ZERO                      *IF
     C           YL0009    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Ship at temperature on orig order
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.COA Temperature Loadout is Not Entered
      *   |- c2    : LCL.COA Temperature Loadout EQ RCD.COA BHR Loadout T
      *   '-
     C           YL0055    IFEQ *ZERO                      *IF
     C           YL0055    OREQ #1QYNY                     *OR
      * Do all processing for selling an order
     C                     EXSR UCSUBR                     Do all processi
     C                     END                             *FI
      * Ship at temp entered on order selection screen   E2079 5/03/12
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.COA Temperature Loadout is GT 0
      *   |- c2    : LCL.COA Temperature Loadout NE RCD.COA BHR Loadout T
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0055    IFGT *ZERO                      *IF
     C           YL0055    IFNE #1QYNY                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Do all processing for selling an order
     C                     EXSR UDSUBR                     Do all processi
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           *IN98     IFEQ '1'
      * SFLRCD invalid
     C  N99                Z-ADD##RR      ##SFRC     99    *
      * SFLNXTCHG
     C                     SETON                     84
     C                     ELSE
      * SFLRCD valid
      * SFLNXTCHG
     C                     SETOF                     84
     C                     MOVEL*BLANK    #1SEL
     C                     END                             FI *IN98
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         FBRQRL    BEGSR
      *================================================================
      * Request subfile reload
      *================================================================
     C                     MOVEL'Y'       W0RSF
      *================================================================
     CSR         FBEXIT    ENDSR
      /EJECT
     CSR         GBDSA2    BEGSR
      *================================================================
      * Set display attributes for Subfile control
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0057    IFEQ 'FR'                       *IF
     C           YL0057    OREQ 'FZ'
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @DACPDK fields to subfile
      *================================================================
     C                     MOVEL*BLANK    #1SEL
     C                     MOVELDAL0AA    #1L0AA           COA Ship To War
     C                     MOVELDAMUT1    #1MUT1           COA Batch Heade
     C                     Z-ADDDAJZNY    #1JZNY           COA RIN SSSSSSS
     C                     Z-ADDDAJ0NY    #1J0NY           COA RIN EEEEEEE
     C                     Z-ADDDAC5TM    #1C5TM           COA RIN Transac
     C                     MOVELDAMVT1    #1MVT1           COA RIN Trans P
     C                     MOVELDAMWT1    #1MWT1           COA RIN Trans P
     C                     MOVELDARINT    #1RINT           COA Retired RIN
     C                     MOVELDAMXAA    #1MXAA           RFS Trans Reaso
     C                     MOVELDAMSAA    #1MSAA           RFS Fuel Code
     C                     Z-ADDDAR7NY    #1R7NY           COA BHR RIN Gen
     C                     Z-ADDDAHEPR    #1HEPR           COA BHR RIN Pri
     C                     Z-ADDDAHFPR    #1HFPR           COA BHR Gallon
     C                     MOVELDAWVT1    #1WVT1           COA Transaction
     C                     MOVELDAW0T1    #1W0T1           COA RIN Support
     C                     Z-ADDDAR5NY    #1R5NY           COA RIN Support
     C                     MOVELDAW1T1    #1W1T1           COA RIN Support
     C                     Z-ADDDAR6NY    #1R6NY           COA RIN Support
     C                     MOVELDAJ1ST    #1J1ST           COA BHR RFS Ver
     C                     MOVELDAKHST    #1KHST           COA GEN EMTS St
     C                     Z-ADDDATWDT    #1TWDT           COA GEN EMTS Da
     C                     Z-ADDDADUTM    #1DUTM           COA GEN EMTS Ti
     C                     MOVELDAKGST    #1KGST           COA RIN EMTS St
     C                     Z-ADDDATVDT    #1TVDT           COA RIN EMTS Da
     C                     Z-ADDDADTTM    #1DTTM           COA RIN EMTS Ti
     C                     Z-ADDDAR9NY    #1R9NY           COA EMTS PTD Nb
     C                     Z-ADDDASQNY    #1SQNY           COA EMTS Batch
     C                     MOVELDABHR3    #1BHR3           COA BHR Unused
     C                     Z-ADDDASRNY    #1SRNY           COA BHR Unused
     C                     MOVELDAW7T1    #1W7T1           COA EMTS Trans
     C                     MOVELDAW8T1    #1W8T1           COA EMTS Return
     C                     Z-ADDDAT2DT    #1T2DT           COA BHR Unused
     C                     Z-ADDDASXNY    #1SXNY           COA BHR Equiv V
     C                     Z-ADDDASYNY    #1SYNY           COA BHR RINs to
     C                     Z-ADDDASZNY    #1SZNY           COA Unassgnd Tx
     C                     Z-ADDDARJDT    #1RJDT           COA Retired RIN
     C                     Z-ADDDAC6TM    #1C6TM           COA Retired RIN
     C                     Z-ADDDADPNB    #1DPNB           Order Sequence
     C                     Z-ADDDAUENB    #1UENB           Order Secondary
     C                     Z-ADDDARZNB    #1RZNB           Case Sequence N
     C                     MOVELDANGT1    #1NGT1           COA Rail Car
     C                     Z-ADDDARMNB    #1RMNB           Load ID
     C                     Z-ADDDARKDT    #1RKDT           COA Date of 1st
     C                     Z-ADDDAC7TM    #1C7TM           COA RIN Unused
     C                     MOVELDARINS    #1RINS           COA RIN Modifie
     C                     MOVELDAMXT1    #1MXT1           COA RIN Unused
     C                     MOVELDAG3ST    #1G3ST           COA RIN SoldFul
     C                     Z-ADDDAQWNY    #1QWNY           COA RIN Gallons
     C                     MOVELDAMAT1    #1MAT1           COA RIN Type Fl
     C                     Z-ADDDACWC3    #1CWC3           COA Shipping Co
     C                     Z-ADDDAQXNY    #1QXNY           COA Ref Load Id
     C                     Z-ADDDAQZNY    #1QZNY           COA Reference B
     C                     Z-ADDDAQ0NY    #1Q0NY           COA Reference B
     C                     MOVELDALVTX    #1LVTX           RFS Compliance
     C                     MOVELDANYT1    #1NYT1           RFS Report Year
     C                     MOVELDAG5ST    #1G5ST           COA RIN Int/Ext
     C                     MOVELDAG7ST    #1G7ST           COA BHR Unused
     C                     Z-ADDDATGDT    #1TGDT           COA BHR Unused
     C                     MOVELDAWIT1    #1WIT1           COA BHR Unused
     C                     Z-ADDDAQYNY    #1QYNY           COA BHR Loadout
     C                     MOVELDAL7T1    #1L7T1           COA ULSD Facili
     C                     Z-ADDDAR8NY    #1R8NY           COA Batch RIN V
     C                     Z-ADDDAR0NY    #1R0NY           COA RIN Quantit
     C                     MOVELDAVSST    #1VSST           Record Status
     C                     Z-ADDDAMJDT    #1MJDT           Create Date
     C                     Z-ADDDABETM    #1BETM           Create Time
     C                     MOVELDACCVN    #1CCVN           Create User
     C                     MOVELDACDVN    #1CDVN           Create Program
     C                     Z-ADDDAMKDT    #1MKDT           Change Date
     C                     Z-ADDDABFTM    #1BFTM           Change Time
     C                     MOVELDACEVN    #1CEVN           Change User
     C                     MOVELDACFVN    #1CFVN           Change Program
     C                     Z-ADDDAAIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVELDAL6T1    #1L6T1           COA ULSD Compan
     C                     Z-ADDDAI3NY    #1I3NY           COA Batch Numbe
     C                     Z-ADDDAJYNY    #1JYNY           COA Batch Heade
     C                     Z-ADDDAQ1NY    #1Q1NY           COA Batch Hdr R
     C                     MOVELDATDNA    #1TDNA           COA RIN Custome
     C                     Z-ADDDAC4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     Z-ADDDARIDT    #1RIDT           COA RIN Transac
      * Clear external version also
     C                     Z-ADD*ZERO     V1RIDT
     C                     MOVELDAI7AA    #1I7AA           RFS Transaction
     C                     Z-ADDDATFDT    #1TFDT           COA BHR Net Gal
     C                     Z-ADDDAJ2NY    #1J2NY           COA RIN Volume
     C                     MOVEL*BLANK    #1SEL            *SFLSEL
     C                     Z-ADD*ZERO     #RASNX           Quantity Sched
     C                     Z-ADD*ZERO     #RATNX           Quantity Sched
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MEIZ#2    BEGSR
      *================================================================
      * Initialise subfile control
      *================================================================
     C                     MOVEL*BLANK    #CSQTX           Company Name DR
     C                     MOVEL*BLANK    #2MUT1           COA Batch Heade
     C                     MOVELP1L0AA    #2L0AA           COA Ship To War
     C                     MOVEL*BLANK    #CO6NA           Warehouse Desc
     C                     MOVEL*BLANK    #CBCNA           Customer Purcha
     C                     Z-ADD*ZERO     #CJENY           COA Temperature
     C                     Z-ADD*ZERO     #2AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V2AIC3
     C                     MOVEL*BLANK    #2L6T1           COA ULSD Compan
     C                     Z-ADD*ZERO     #2I3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     #2JYNY           COA Batch Heade
     C                     Z-ADD*ZERO     #2Q1NY           COA Batch Hdr R
     C                     MOVEL*BLANK    #2TDNA           COA RIN Custome
     C                     Z-ADD*ZERO     #2C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V2C4NB
     C                     Z-ADD*ZERO     #2RIDT           COA RIN Transac
      * Clear external version also
     C                     Z-ADD*ZERO     V2RIDT
     C                     MOVEL*BLANK    #2I7AA           RFS Transaction
     C                     Z-ADD*ZERO     #2TFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     #CASNX           Quantity Sched
     C                     Z-ADD*ZERO     #CATNX           Quantity Sched
     C                     Z-ADD*ZERO     #2J2NY           COA RIN Volume
      *================================================================
     CSR         MEEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert subfile fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert COA RIN Transaction Date to display format
      * Convert date
     C           1000000   ADD  #1RIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V1RIDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#2    BEGSR
      *================================================================
      * Convert control fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #2AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#2AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V2AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #2C4NB    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#2C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V2C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V2C4NB           CD7 Ext Numeric
     C                     END                             *FI
      * Convert COA RIN Transaction Date to display format
      * Convert date
     C           1000000   ADD  #2RIDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    V2RIDT
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD#2AIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSA     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #CSQTX           Name
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    #CSQTX           Name
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#2L0AA    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #CO6NA           Warehouse Descr
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #CO6NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           KMAIC3           Company Number
     C                     KFLD           KMV8CD           Company Value C
      * Setup key
     C                     Z-ADD#1AIC3    KMAIC3           Company Number
     C                     MOVE *BLANK    KMV8CD           Company Value C
     C                     MOVEL'HPBPLT'  KMV8CD           Company Value C
      * Establish starting position
     C           KRSSC     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDKMM8NB    YL0001           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Order for Ext Sel RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0002           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WAL6T1    WQSD02           COA ULSD Compan
     C           *LIKE     DEFN WAI3NY    WQSD03           COA Batch Numbe
     C           *LIKE     DEFN WAJYNY    WQSD04           COA Batch Heade
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           COA ULSD Compan
     C                     KFLD           WQSD03           COA Batch Numbe
     C                     KFLD           WQSD04           COA Batch Heade
      * Setup key
     C                     Z-ADDYL0001    WQSD01           Company Number
     C                     MOVEL#1L6T1    WQSD02           COA ULSD Compan
     C                     Z-ADD#1I3NY    WQSD03           COA Batch Numbe
     C                     Z-ADD#1JYNY    WQSD04           COA Batch Heade
      * Establish starting position
     C           KRSSD     SETLL@DACPDR                    *
     C           KRSSD     READE@DACPDR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3855' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         #1C4NB           Order Number
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.RFS Transaction Type is Sold or Delivered
      *   |- c2    : LCL.First Time Flag is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAI7AA    IFEQ 'SEL'                      *IF
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR = DB1 By name
     C                     Z-ADDWAC4NB    #1C4NB           Order Number
     C                     Z-ADDWADPNB    #1DPNB           Order Sequence
     C                     Z-ADDWAUENB    #1UENB           Order Secondary
     C                     Z-ADDWARZNB    #1RZNB           Case Sequence N
     C                     Z-ADDWARMNB    #1RMNB           Load ID
     C                     Z-ADDWACWC3    #1CWC3           COA Shipping Co
     C                     MOVEL'N'       YL0002           First Time Flag
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@DACPDR                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV HPB Gross Gall    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSE01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSE02           Order Number
      * Define keylist
     C           KPSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Order Number
      * Setup key
     C                     Z-ADD#1CWC3    WQSE01           Company Number
     C                     Z-ADD#1C4NB    WQSE02           Order Number
     C                     Z-ADD#1DPNB    FNDPNB           Order Sequence
     C                     Z-ADD#1UENB    FNUENB           Order Secondary
      * Establish starting position
     C           KPSSE     SETLL@FNCPCT                    *
     C           KRSSE     READE@FNCPCT                  90*
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  FNFOQT    #RASNX           Quantity Shippe
     C           KRSSE     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV RIN Net Sold GallsRT - Manifest Detail RIN Sell  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN FPL6T1    WQSF01           COA ULSD Compan
     C           *LIKE     DEFN FPI3NY    WQSF02           COA Batch Numbe
     C           *LIKE     DEFN FPJYNY    WQSF03           COA Batch Heade
     C           *LIKE     DEFN FPQ1NY    WQSF04           COA Batch Hdr R
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           COA ULSD Compan
     C                     KFLD           WQSF02           COA Batch Numbe
     C                     KFLD           WQSF03           COA Batch Heade
     C                     KFLD           WQSF04           COA Batch Hdr R
      * Setup key
     C                     MOVEL#1L6T1    WQSF01           COA ULSD Compan
     C                     Z-ADD#1I3NY    WQSF02           COA Batch Numbe
     C                     Z-ADD#1JYNY    WQSF03           COA Batch Heade
     C                     Z-ADD#1Q1NY    WQSF04           COA Batch Hdr R
      * Establish starting position
     C           KRSSF     SETLL@FPCPEM                    *
     C           KRSSF     READE@FPCPEM                  90*
      * Data record not found
     C   90                MOVEL'USR4210' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RMC added chk to compare to shipping company 4/20/20
      * CASE: DB1.COA Batch Company Nbr EQ PAR.Shipping Company
     C           FPRCNY    IFEQ #1AIC3                     *IF
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SGRVGN
      * CASE: LCL.Header Status is Closed or Cancelled
     C           YL0004    IFEQ 'X'                        *IF
     C           YL0004    OREQ 'C'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  FPN6WG    YL0003           HPB Meter Net G
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@FPCPEM                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDFPAIC3    BEAIC3           Company Number
     C                     Z-ADDFPC4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSG     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    YL0004           Header Status
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv API Vol Cor Fctor RT - RFS API Volume Corr Table  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           GJSSNY           RFS API Gravity
     C                     KFLD           GJSTNY           RFS Loadout Tem
      * Setup key
     C                     Z-ADDWL0001    GJSSNY           RFS API Gravity
     C                     Z-ADDWL0002    GJSTNY           RFS Loadout Tem
      * Establish starting position
     C           KRSSH     CHAIN@GJREHH              90    *
      * Data record not found
     C   90                MOVEL'USR4345' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDGJSUNY    WL0003           RFS API Vol Cor
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV HPB to Gen SEL RINRT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FNAIC3           Company Number
     C                     KFLD           FNC4NB           Order Number
     C                     KFLD           FNDPNB           Order Sequence
     C                     KFLD           FNUENB           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
      * Setup key
     C                     Z-ADDWL0004    FNAIC3           Company Number
     C                     Z-ADDWL0005    FNC4NB           Order Number
     C                     Z-ADDWL0006    FNDPNB           Order Sequence
     C                     Z-ADDWL0007    FNUENB           Order Secondary
     C                     Z-ADDWL0008    FNRZNB           Case Sequence N
      * Establish starting position
     C           KRSSI     SETGT@FNCPCT                91  *
     C                     READP@FNCPCT                9190*
      * Check high order keys
     C  N90      WL0004    IFNE FNAIC3                     Company Number
     C           WL0005    ORNE FNC4NB                     Order Number
     C           WL0006    ORNE FNDPNB                     Order Sequence
     C           WL0007    ORNE FNUENB                     Order Secondary
     C                     SETON                     90
     C                     END
      *
      * Data record not found
     C   90                MOVEL'USR1196' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFNFOQT    WL0009           Case Quantity
     C                     Z-ADDFNR0NB    WL0010           Case Weight
     C                     Z-ADDFNN6WG    WL0011           HPB Meter Net G
     C                     Z-ADDFNITNY    WL0012           HPB COA Batch N
     C                     Z-ADDFNIVNY    WL0013           HPB Meter Start
     C                     Z-ADDFNIUNY    WL0014           HPB Meter Endin
     C                     Z-ADDFNIWNY    WL0015           HPB Meter Total
     C                     Z-ADDFNIXNY    WL0016           HPB Meter Net W
     C                     Z-ADDFNIYNY    WL0017           HPB Density Ref
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Load ID            RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0018    BEAIC3           Company Number
     C                     Z-ADDWL0019    BEC4NB           Order Number
      * Establish starting position
     C           KRSSJ     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0020           Load ID
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBERMNB    WL0020           Load ID
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV HPB fields         RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0021    AMAIC3           Company Number
     C                     Z-ADDWL0022    AMC4NB           Order Number
      * Establish starting position
     C           KRSSK     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0023           HPB COA Batch N
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAMITNY    WL0023           HPB COA Batch N
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WBC4NB    WQSL02           Order Number
     C           *LIKE     DEFN WBDPNB    WQSL03           Order Sequence
     C           *LIKE     DEFN WBUENB    WQSL04           Order Secondary
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
     C                     KFLD           WQSL03           Order Sequence
     C                     KFLD           WQSL04           Order Secondary
      * Setup key
     C                     Z-ADDWL0024    WQSL01           Company Number
     C                     Z-ADDWL0025    WQSL02           Order Number
     C                     Z-ADDWL0026    WQSL03           Order Sequence
     C                     Z-ADDWL0027    WQSL04           Order Secondary
      * Establish starting position
     C           KRSSL     SETLL@FNCPUW                    *
     C           KRSSL     READE@FNCPUW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WL0028           Case Sequence N
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WBRZNB    ADD  1         WL0028           Case Sequence N
     C                     GOTO SLEXIT                     *QUIT
     C           KRSSL     READE@FNCPUW                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * Crt Manifest Detail   CR - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FNCPCS
     C                     Z-ADDWL0029    WCAIC3           Company Number
     C                     Z-ADDWL0030    WCC4NB           Order Number
     C                     Z-ADDWL0031    WCDPNB           Order Sequence
     C                     Z-ADDWL0032    WCUENB           Order Secondary
     C                     Z-ADDWL0033    WCRZNB           Case Sequence N
     C                     Z-ADDWL0034    WCFOQT           Case Quantity
     C                     Z-ADDWL0035    WCR0NB           Case Weight
     C                     MOVELWL0036    WCPMST           Inventory Updat
     C                     Z-ADDWL0037    WCK7DT           Label Date
     C                     Z-ADDWL0038    WCPFNX           PT Serial Numbe
     C                     Z-ADDWL0039    WCHGCD           Item Code
     C                     MOVELWL0040    WCAJCD           Warehouse Code
     C                     Z-ADDWL0041    WCELDT           Production Date
     C                     Z-ADDWL0042    WCN5WG           Manifest Gross
     C                     MOVELWL0043    WCRZNA           Manifest Lot ID
     C                     Z-ADDWL0044    WCH5NY           Manifest Total
     C                     Z-ADDWL0045    WCH6NY           Manifest Co-Par
     C                     Z-ADDWL0046    WCH7NY           Manifest Pallet
     C                     MOVELWL0047    WCGBTX           Manifest Shift
     C                     Z-ADDWL0048    WCN6WG           HPB Meter Net G
     C                     Z-ADDWL0049    WCN7WG           Manifest Net We
     C                     MOVELWL0050    WCGCTX           Manifest Unused
     C                     MOVELWL0051    WCGDTX           Manifest Unused
     C                     Z-ADDWL0052    WCRBDT           Manifest Unused
     C                     Z-ADDWL0053    WCITNY           HPB COA Batch N
     C                     Z-ADDWL0054    WCIVNY           HPB Meter Start
     C                     Z-ADDWL0055    WCIUNY           HPB Meter Endin
     C                     Z-ADDWL0056    WCIWNY           HPB Meter Total
     C                     Z-ADDWL0057    WCIXNY           HPB Meter Net W
     C                     Z-ADDWL0058    WCIYNY           HPB Density Ref
     C                     MOVELWL0059    WCUVST           EDI Status 1
     C                     MOVELWL0060    WCUWST           EDI Status 2
     C                     MOVELWL0061    WCUXST           EDI Status 3
     C                     MOVELWL0062    WCVSST           Record Status
     C                     Z-ADDWL0063    WCAATM           Job Time
     C                     MOVELWL0064    WCAYNA           User Id
     C                     MOVELWL0065    WCA0NA           Job Name
     C                     Z-ADDWL0066    WCAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WCVSST           Record Status
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##PGM     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSM    KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCDPNB           Order Sequence
     C                     KFLD           WCUENB           Order Secondary
     C                     KFLD           WCRZNB           Case Sequence N
      * Check for duplicate primary key
     C           KLCRSM    SETLL@FNCPCS                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1197' W0RTN   7
      * Send message 'Manifest Detail        EX'
     C                     MOVEL'USR1197' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@FNCPCS                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Manifest Dtl RIN  CR - Manifest Detail RIN Sell  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0013  70       Change Date
     C                     Z-ADD*ZERO     WN0014  60       Change Time
     C                     MOVEL*BLANK    WN0015 10        Change User
     C                     MOVEL*BLANK    WN0016 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FPCPDO
     C                     Z-ADDWL0067    WDAIC3           Company Number
     C                     Z-ADDWL0068    WDC4NB           Order Number
     C                     Z-ADDWL0069    WDDPNB           Order Sequence
     C                     Z-ADDWL0070    WDUENB           Order Secondary
     C                     Z-ADDWL0071    WDRZNB           Case Sequence N
     C                     MOVELWL0072    WDL6T1           COA ULSD Compan
     C                     Z-ADDWL0073    WDI3NY           COA Batch Numbe
     C                     Z-ADDWL0074    WDJYNY           COA Batch Heade
     C                     Z-ADDWL0075    WDQ1NY           COA Batch Hdr R
     C                     Z-ADDWL0076    WDN6WG           HPB Meter Net G
     C                     Z-ADDWL0077    WDRCNY           COA Batch Compa
     C                     MOVELWL0078    WDHJST           MDRS Unused sts
     C                     MOVELWL0079    WDVSST           Record Status
     C                     Z-ADDWL0080    WDMJDT           Create Date
     C                     Z-ADDWL0081    WDBETM           Create Time
     C                     MOVELWL0082    WDCCVN           Create User
     C                     MOVELWL0083    WDCDVN           Create Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WDVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WDMJDT           Create Date
     C                     Z-ADD##JTM     WDBETM           Create Time
     C                     MOVEL##USR     WDCCVN           Create User
     C                     MOVEL##PGM     WDCDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WDMKDT           Change Date
     C                     Z-ADD0         WDBFTM           Change Time
     C                     MOVEL*BLANK    WDCEVN           Change User
     C                     MOVEL*BLANK    WDCFVN           Change Program
     C           KLCRSN    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
     C                     KFLD           WDDPNB           Order Sequence
     C                     KFLD           WDUENB           Order Secondary
     C                     KFLD           WDRZNB           Case Sequence N
      * Check for duplicate primary key
     C           KLCRSN    SETLL@FPCPDO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4211' W0RTN   7
      * Send message 'Manifest Detail RIN Se EX'
     C                     MOVEL'USR4211' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@FPCPDO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * CHG Prod Temp-HPB     CH - Load Header  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  30       Company Number
     C                     Z-ADD*ZERO     WN0018  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0019  1        LTL Flag
     C                     MOVEL*BLANK    WN0020  1        Load Status
     C                     Z-ADD*ZERO     WN0021  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0022 15        Seal 1
     C                     MOVEL*BLANK    WN0023 15        Seal 2
     C                     MOVEL*BLANK    WN0024 15        Seal 3
     C                     MOVEL*BLANK    WN0025 15        Seal 4
     C                     MOVEL*BLANK    WN0026 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0027  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0028 112       Flat Amount
     C                     MOVEL*BLANK    WN0029  1        Allocate Pounds
     C                     Z-ADD*ZERO     WN0030  50       Total Stops
     C                     MOVEL*BLANK    WN0031 20        Trailer Id
     C                     MOVEL*BLANK    WN0032  3        Transloader Car
     C                     Z-ADD*ZERO     WN0033  40       BOL Time
     C                     MOVEL*BLANK    WN0034  3        Carrier Code
     C                     MOVEL*BLANK    WN0035  7        Truck Size
     C                     Z-ADD*ZERO     WN0036  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0037 112       Rated Freight
     C                     MOVEL*BLANK    WN0038  1        Ship Status
     C                     MOVEL*BLANK    WN0039  1        Load Type
     C                     Z-ADD*ZERO     WN0040  50       Number Pallets
     C                     Z-ADD*ZERO     WN0041  50       Number Pallets
     C                     Z-ADD*ZERO     WN0042 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0043  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0044  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0045  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0046 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0047 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0048  70       Actual Departur
     C                     Z-ADD*ZERO     WN0049  40       Departure Time
     C                     Z-ADD*ZERO     WN0050  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0051  50       Number Spacers
     C                     MOVEL*BLANK    WN0052 12        Car/Veh. Initia
     C                     Z-ADD*ZERO     WN0053  70       Total Load Mile
     C                     MOVEL*BLANK    WN0054 12        Recorder ID
     C                     MOVEL*BLANK    WN0055  2        Shipping Method
     C                     MOVEL*BLANK    WN0056  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0057  2        Ship To State C
     C                     Z-ADD*ZERO     WN0058  70       Gross Weight
     C                     MOVEL*BLANK    WN0059  1        Export Status
     C                     Z-ADD*ZERO     WN0060  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0061  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0062  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0063  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0064  70       Spotted Date
     C                     Z-ADD*ZERO     WN0065  60       Spotted Time
     C                     Z-ADD*ZERO     WN0066  70       Load Finished D
     C                     Z-ADD*ZERO     WN0067  60       Load Finished T
     C                     Z-ADD*ZERO     WN0068  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0069  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0070  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0071  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0072  70       Truck Departure
     C                     Z-ADD*ZERO     WN0073  60       Truck Departure
     C                     Z-ADD*ZERO     WN0074  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0075  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0076  3        Shipping Line
     C                     MOVEL*BLANK    WN0077 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0078 30        Vessel Name
     C                     Z-ADD*ZERO     WN0079  50       Voyage
     C                     Z-ADD*ZERO     WN0080  70       Sail Date
     C                     MOVEL*BLANK    WN0081 12        Booking Number
     C                     MOVEL*BLANK    WN0082 20        Discharge Port
     C                     Z-ADD*ZERO     WN0083  70       Arrival Date
     C                     MOVEL*BLANK    WN0084 12        Container Numbe
     C                     Z-ADD*ZERO     WN0085  70       Date In
     C                     Z-ADD*ZERO     WN0086  60       Time In
     C                     Z-ADD*ZERO     WN0087  70       Date Out
     C                     Z-ADD*ZERO     WN0088  60       Time Out
     C                     Z-ADD*ZERO     WN0089 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0090  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0091  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0092  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0093  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0094  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0095  70       Requested Deliv
     C                     MOVEL*BLANK    WN0096  1        Load Acceptance
     C                     MOVEL*BLANK    WN0097  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0098  70       On Yard Date
     C                     Z-ADD*ZERO     WN0099  60       On Yard Time
     C                     Z-ADD*ZERO     WN0100  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0101  60       Deadline Depart
     C                     MOVEL*BLANK    WN0102  1        Load Held Over
     C                     MOVEL*BLANK    WN0103  1        Load Held Over
     C                     MOVEL*BLANK    WN0104 15        Load Held Over
     C                     MOVEL*BLANK    WN0105 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0106 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0107  70       Express Mail Da
     C                     MOVEL*BLANK    WN0108  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0109  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0110  70       Product Complet
     C                     Z-ADD*ZERO     WN0111  60       Product Complet
     C                     Z-ADD*ZERO     WN0112  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0113  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0114  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0115  1        Load Confirmed
     C                     MOVEL*BLANK    WN0116 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0117  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0118  60       Load Door 1
     C                     Z-ADD*ZERO     WN0119  70       Override Total
     C                     Z-ADD*ZERO     WN0120  60       Load Door 2
     C                     MOVEL*BLANK    WN0121  1        Partial Load
     C                     MOVEL*BLANK    WN0122  1        Load Confirmati
     C                     MOVEL*BLANK    WN0123  1        Export Load USD
     C                     MOVEL*BLANK    WN0124  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0125 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0126 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0127 15        Late Billing Em
     C                     MOVEL*BLANK    WN0128 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0129 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0130  1        Multi Company L
     C                     MOVEL*BLANK    WN0131  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0132  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0133  1        LH Power Only L
     C                     MOVEL*BLANK    WN0134  1        MG Created Load
     C                     MOVEL*BLANK    WN0135  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0136  2        Load U/M
     C                     MOVEL*BLANK    WN0137  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0138  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0139  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0140  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0141  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0142  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0143  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0144  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0145  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0146  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0147  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0148  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0149  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0150  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0151  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0152  60       LH Unused Time
     C                     MOVEL*BLANK    WN0153  1        EDI Status 1
     C                     MOVEL*BLANK    WN0154  1        EDI Status 2
     C                     MOVEL*BLANK    WN0155  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0156  60       Job Time
     C                     MOVEL*BLANK    WN0157 10        User Id
     C                     MOVEL*BLANK    WN0158 10        Job Name
     C                     Z-ADD*ZERO     WN0159  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDWL0084    FJRMNB           Load ID
      *
     C           KLCHSO    KLIST
     C                     KFLD           FJRMNB           Load ID
     C           KLCHSO    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDWL0085    FJPRTM           Product Tempera
     C                     MOVELWL0086    FJXCCD    P      Carrier Broker
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     FJAATM           Job Time
     C                     MOVEL##USR     FJAYNA           User Id
     C                     MOVEL##PGM     FJA0NA           Job Name
     C                     Z-ADD##JDT     FJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AMAIC3           Company Number
     C                     KFLD           AMC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0087    AMAIC3           Company Number
     C                     Z-ADDWL0088    AMC4NB           Order Number
      * Establish starting position
     C           KRSSP     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * RTV Stop Drop Seq     RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0089    WL0091           Load ID
     C                     Z-ADDWL0088    WL0093           Order Number
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0092    YL0022           Stop/Drop Seque
      * CRT Existing OHE       CR - Order Header Extension  * 
     C                     EXSR SRCRRC
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Load ID is Blank
     C           AMRMNB    IFEQ 0                          *IF
     C                     Z-ADDWL0089    YL0047           Load ID
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAMRMNB    YL0047           Load ID
     C                     END                             *FI
      * CASE: DB1.Stop/Drop Sequence Number is Not Entered
     C           AMRUNB    IFEQ 0                          *IF
      * RTV Stop Drop Seq     RT - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0089    WL0091           Load ID
     C                     Z-ADDWL0088    WL0093           Order Number
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0092    YL0022           Stop/Drop Seque
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDAMRUNB    YL0022           Stop/Drop Seque
     C                     END                             *FI
      * CHG HPB Batch/Load    CH - Order Header Extension  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Stop Drop Seq     RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0092           Stop/Drop Seque
      * Declare restrictor key work fields
     C           *LIKE     DEFN FLRMNB    WQSQ02           Load ID
     C           *LIKE     DEFN FLC4NB    WQSQ03           Order Number
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
     C                     KFLD           WQSQ03           Order Number
      * Setup key
     C                     Z-ADDWL0091    WQSQ02           Load ID
     C                     Z-ADDWL0093    WQSQ03           Order Number
      * Establish starting position
     C           KRSSQ     SETLL@FLCPKF                    *
     C           KRSSQ     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFLRUNB    WL0092           Stop/Drop Seque
     C           KRSSQ     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * CRT Existing OHE       CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWL0087    WEAIC3           Company Number
     C                     Z-ADDWL0088    WEC4NB           Order Number
     C                     Z-ADDWL0089    WERMNB           Load ID
     C                     Z-ADDYL0022    WERUNB           Stop/Drop Seque
     C                     MOVEL*BLANK    WEXACD           Shipping Line
     C                     MOVEL*BLANK    WEOANA           Port Delv Termi
     C                     MOVEL*BLANK    WEHBAA           OHE City
     C                     MOVEL*BLANK    WEJ0T1           OHE Vessel/Airl
     C                     MOVEL*BLANK    WEGENY           OHE Voyage/Flig
     C                     MOVEL*BLANK    WEJ1T1           OHE Booking Num
     C                     MOVEL*BLANK    WEHCAA           OHE Discharge P
     C                     Z-ADD0         WEQWDT           OHE Sail/Flight
     C                     Z-ADD0         WEQXDT           OHE Port Cut Da
     C                     Z-ADD0         WEQYDT           OHE Arrival Dat
     C                     MOVEL*BLANK    WEHDAA           OHE Late Delive
     C                     MOVEL'R'       WECCTX           OHE Ship Status
     C                     MOVEL*BLANK    WEJ2T1           OHE Container N
     C                     MOVEL*BLANK    WERLNA           OHE Comment 1
     C                     MOVEL*BLANK    WERMNA           OHE Comment 2
     C                     Z-ADD0         WEGINY           OHE Unused Numb
     C                     Z-ADD0         WEGFNY           OHE Unused Numb
     C                     Z-ADD0         WEGGNY           OHE Unused Numb
     C                     Z-ADD0         WEGHNY           OHE Unused Numb
     C                     Z-ADD0         WEHEVL           OHE HPB RIN Equ
     C                     Z-ADD0         WEHFVL           OHE HPB RIN Pri
     C                     Z-ADD0         WEHGVL           Transload Termi
     C                     Z-ADD0         WEQZDT           OHE Est Arrv at
     C                     Z-ADD0         WEQ0DT           OHE Backhaul ET
     C                     Z-ADD0         WEQ1DT           OHE Port/Pier P
     C                     Z-ADD0         WEQ2DT           OHE Actual Ship
     C                     MOVELYL0023    WEC2TX           OHE Carrier SCA
     C                     MOVELYL0024    WEC3TX           OHE Spot Buy
     C                     MOVELYL0025    WEC6TX           OHE PO ACK Flag
     C                     MOVELYL0026    WECHTX           OHE Override Ty
     C                     MOVELYL0027    WECITX           OHE Backhaul St
     C                     MOVELYL0028    WECLTX           OHE Backhaul ET
     C                     MOVELYL0029    WEB4TX           OHE Load Haul T
     C                     MOVELYL0030    WECUTX           OHE Backhaul Ca
     C                     MOVELYL0031    WECVTX           OHE Bookings Co
     C                     MOVELYL0032    WEB9TX           OHE EDI Error R
     C                     MOVELYL0033    WEJWSC           OHE EDI Error R
     C                     Z-ADDWL0090    WEITNY           HPB COA Batch N
     C                     MOVEL*BLANK    WELMT1           Delivery P.O. N
     C                     MOVEL*BLANK    WELWAA           OHE Intended fo
     C                     MOVELYL0034    WEFVST           OHE EDI 943 Act
     C                     MOVELYL0035    WEF0ST           OHE EDI 944 Act
     C                     MOVELYL0036    WEF2ST           OHE EDI 940 Act
     C                     MOVELYL0037    WEF3ST           OHE EDI 945 Act
     C                     MOVELYL0038    WEJUSC           OHE EDI 856 Act
     C                     MOVELYL0039    WEJVSC           OHE EDI 824 Act
     C                     MOVEL*BLANK    WEV3T1           OHE Transload S
     C                     MOVEL*BLANK    WEV4T1           OHE Abs Rate Ov
     C                     MOVEL*BLANK    WEV5T1           OHE Appt Confir
     C                     MOVEL*BLANK    WEV6T1           OHE Backhaul Co
     C                     MOVEL*BLANK    WEV7T1           OHE Backhaul Ch
     C                     MOVEL*BLANK    WEV8T1           OHE Transload C
     C                     MOVEL*BLANK    WEV9T1           OHE Pier Pass I
     C                     MOVEL*BLANK    WEWAT1           OHE Carrier Nm
     C                     MOVEL*BLANK    WEWBT1           OHE Appt Confir
     C                     MOVEL*BLANK    WEWCT1           OHE Backhaul Co
     C                     MOVEL*BLANK    WEWDT1           Letter of Credi
     C                     Z-ADD0         WEQJNY           OHE Backhaul Re
     C                     Z-ADD0         WEQKNY           LD Stop/Drop
     C                     Z-ADD0         WEQLNY           OHE Unused Numb
     C                     Z-ADD0         WEP8NY           OHE Pier Pass F
     C                     Z-ADD0         WEP9NY           OHE Port Check
     C                     Z-ADD0         WEQANY           OHE Port Cut Ti
     C                     Z-ADD0         WEQCNY           OHE Backhaul Tr
     C                     Z-ADD0         WEQDNY           OHE Load Sched
     C                     Z-ADD0         WEQENY           Original Appoin
     C                     Z-ADD0         WEQFNY           Original Appoin
     C                     Z-ADD0         WEQGNY           OHE PowerPro Lo
     C                     Z-ADD0         WEQHNY           OHE PowerPro Lo
     C                     Z-ADD0         WEQINY           OHE Unused Nume
     C                     Z-ADD0         WEQMNY           OHE Orig ABS Fr
     C                     MOVEL*BLANK    WEMYU1           OHE Genset Numb
     C                     MOVELYL0040    WEJXSC           OHE Email BOL/S
     C                     MOVELYL0041    WEJYSC           OHE Unused Stat
     C                     MOVELYL0042    WEJZSC           OHE Unused Stat
     C                     MOVELYL0043    WEJ0SC           OHE Unused Stat
     C                     MOVEL*BLANK    WEMZU1           OHE Unused Text
     C                     MOVEL*BLANK    WEM0U1           OHE Unused Text
     C                     MOVEL*BLANK    WEM1U1           OHE Unused Text
     C                     MOVEL*BLANK    WEM2U1           OHE Unused Text
     C                     MOVEL*BLANK    WEM3U1           OHE Unused Text
     C                     Z-ADD0         WEW5DT           OHE Unused Date
     C                     Z-ADD0         WEW6DT           OHE Unused Date
     C                     MOVELYL0044    WEUVST           EDI Status 1
     C                     MOVELYL0045    WEUWST           EDI Status 2
     C                     MOVELYL0046    WEUXST           EDI Status 3
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD0         WEAATM           Job Time
     C                     MOVEL*BLANK    WEAYNA           User Id
     C                     MOVEL*BLANK    WEA0NA           Job Name
     C                     Z-ADD0         WEAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     MOVEL##USR     WEAYNA           User Id
     C           KLCRSR    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSR    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * Send message 'Order Header Extension EX'
     C                     MOVEL'USR3698' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * CHG HPB Batch/Load    CH - Order Header Extension  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0160  3        Shipping Line
     C                     MOVEL*BLANK    WN0161 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0162 25        OHE City
     C                     MOVEL*BLANK    WN0163 30        OHE Vessel/Airl
     C                     MOVEL*BLANK    WN0164 15        OHE Voyage/Flig
     C                     MOVEL*BLANK    WN0165 15        OHE Booking Num
     C                     MOVEL*BLANK    WN0166 20        OHE Discharge P
     C                     Z-ADD*ZERO     WN0167  70       OHE Sail/Flight
     C                     Z-ADD*ZERO     WN0168  70       OHE Port Cut Da
     C                     Z-ADD*ZERO     WN0169  70       OHE Arrival Dat
     C                     MOVEL*BLANK    WN0170  3        OHE Late Delive
     C                     MOVEL*BLANK    WN0171  1        OHE Ship Status
     C                     MOVEL*BLANK    WN0172 12        OHE Container N
     C                     MOVEL*BLANK    WN0173 35        OHE Comment 1
     C                     MOVEL*BLANK    WN0174 75        OHE Comment 2
     C                     Z-ADD*ZERO     WN0175 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0176 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0177 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0178 110       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0179 112       OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WN0180 112       OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WN0181 112       Transload Termi
     C                     Z-ADD*ZERO     WN0182  70       OHE Est Arrv at
     C                     Z-ADD*ZERO     WN0183  70       OHE Backhaul ET
     C                     Z-ADD*ZERO     WN0184  70       OHE Port/Pier P
     C                     Z-ADD*ZERO     WN0185  70       OHE Actual Ship
     C                     MOVEL*BLANK    WN0186  4        OHE Carrier SCA
     C                     MOVEL*BLANK    WN0187  4        OHE Spot Buy
     C                     MOVEL*BLANK    WN0188  4        OHE PO ACK Flag
     C                     MOVEL*BLANK    WN0189  2        OHE Override Ty
     C                     MOVEL*BLANK    WN0190  2        OHE Backhaul St
     C                     MOVEL*BLANK    WN0191  2        OHE Backhaul ET
     C                     MOVEL*BLANK    WN0192  3        OHE Load Haul T
     C                     MOVEL*BLANK    WN0193  3        OHE Backhaul Ca
     C                     MOVEL*BLANK    WN0194  3        OHE Bookings Co
     C                     MOVEL*BLANK    WN0195  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0196  5        OHE EDI Error R
     C                     MOVEL*BLANK    WN0197 38        Delivery P.O. N
     C                     MOVEL*BLANK    WN0198  6        OHE Intended fo
     C                     MOVEL*BLANK    WN0199  6        OHE EDI 943 Act
     C                     MOVEL*BLANK    WN0200  6        OHE EDI 944 Act
     C                     MOVEL*BLANK    WN0201  6        OHE EDI 940 Act
     C                     MOVEL*BLANK    WN0202  6        OHE EDI 945 Act
     C                     MOVEL*BLANK    WN0203  1        OHE EDI 856 Act
     C                     MOVEL*BLANK    WN0204  1        OHE EDI 824 Act
     C                     MOVEL*BLANK    WN0205 10        OHE Transload S
     C                     MOVEL*BLANK    WN0206 10        OHE Abs Rate Ov
     C                     MOVEL*BLANK    WN0207 10        OHE Appt Confir
     C                     MOVEL*BLANK    WN0208 15        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0209 15        OHE Backhaul Ch
     C                     MOVEL*BLANK    WN0210 15        OHE Transload C
     C                     MOVEL*BLANK    WN0211 30        OHE Pier Pass I
     C                     MOVEL*BLANK    WN0212 30        OHE Carrier Nm
     C                     MOVEL*BLANK    WN0213 30        OHE Appt Confir
     C                     MOVEL*BLANK    WN0214 50        OHE Backhaul Co
     C                     MOVEL*BLANK    WN0215 50        Letter of Credi
     C                     Z-ADD*ZERO     WN0216  30       OHE Backhaul Re
     C                     Z-ADD*ZERO     WN0217  30       LD Stop/Drop
     C                     Z-ADD*ZERO     WN0218  30       OHE Unused Numb
     C                     Z-ADD*ZERO     WN0219  52       OHE Pier Pass F
     C                     Z-ADD*ZERO     WN0220  52       OHE Port Check
     C                     Z-ADD*ZERO     WN0221  50       OHE Port Cut Ti
     C                     Z-ADD*ZERO     WN0222  60       OHE Backhaul Tr
     C                     Z-ADD*ZERO     WN0223  60       OHE Load Sched
     C                     Z-ADD*ZERO     WN0224  60       Original Appoin
     C                     Z-ADD*ZERO     WN0225  60       Original Appoin
     C                     Z-ADD*ZERO     WN0226  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0227  90       OHE PowerPro Lo
     C                     Z-ADD*ZERO     WN0228  90       OHE Unused Nume
     C                     Z-ADD*ZERO     WN0229  96       OHE Orig ABS Fr
     C                     MOVEL*BLANK    WN0230 15        OHE Genset Numb
     C                     MOVEL*BLANK    WN0231  1        OHE Email BOL/S
     C                     MOVEL*BLANK    WN0232  1        OHE Unused Stat
     C                     MOVEL*BLANK    WN0233  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0234  2        OHE Unused Stat
     C                     MOVEL*BLANK    WN0235  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0236  5        OHE Unused Text
     C                     MOVEL*BLANK    WN0237 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0238 15        OHE Unused Text
     C                     MOVEL*BLANK    WN0239 30        OHE Unused Text
     C                     Z-ADD*ZERO     WN0240  70       OHE Unused Date
     C                     Z-ADD*ZERO     WN0241  70       OHE Unused Date
     C                     MOVEL*BLANK    WN0242  1        EDI Status 1
     C                     MOVEL*BLANK    WN0243  1        EDI Status 2
     C                     MOVEL*BLANK    WN0244  1        EDI Status 3
     C                     MOVEL*BLANK    WN0245  1        Record Status
     C                     Z-ADD*ZERO     WN0246  60       Job Time
     C                     MOVEL*BLANK    WN0247 10        User Id
     C                     MOVEL*BLANK    WN0248 10        Job Name
     C                     Z-ADD*ZERO     WN0249  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWL0087    WEAIC3           Company Number
     C                     Z-ADDWL0088    WEC4NB           Order Number
      *
     C           KLCHSS    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C           KLCHSS    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDYL0047    WERMNB           Load ID
     C                     Z-ADDYL0022    WERUNB           Stop/Drop Seque
     C                     Z-ADDWL0090    WEITNY           HPB COA Batch N
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     MOVEL##USR     WEAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Chg for Confirm    RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0250  70       USR Min Weight
     C                     Z-ADD*ZERO     WN0251  70       USR Max Weight
     C                     Z-ADD*ZERO     WN0252 112       Minimum Weight
     C                     Z-ADD*ZERO     WN0253 112       Maximum Weight
     C                     Z-ADD*ZERO     WN0254 112       HPB Meter Net G
     C                     Z-ADD*ZERO     WN0255  80       HPB Meter Net W
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WL0103           USR Exit Progra
     C                     MOVEL'N'       WL0102           USR Over Max
     C                     MOVEL'N'       WL0101           USR Under Min
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           OMAIC3           Company Number
     C                     KFLD           OMC4NB           Order Number
     C                     KFLD           OMDPNB           Order Sequence
     C                     KFLD           OMUENB           Order Secondary
      * Setup key
     C                     Z-ADDWL0094    OMAIC3           Company Number
     C                     Z-ADDWL0095    OMC4NB           Order Number
     C                     Z-ADDWL0096    OMDPNB           Order Sequence
     C                     Z-ADDWL0097    OMUENB           Order Secondary
      * Establish starting position
     C           KRSST     CHAIN@BGWKL1              90    *
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * RTV Total Confirmed    RT - Manifest Detail  * 
     C                     EXSR SURVGN
      * Check min/max from the item master
     C                     Z-ADD0         WN0250           USR Min Weight
     C                     Z-ADD0         WN0251           USR Max Weight
      * RTV Qty Min/Max        RT - Company/Item  * 
     C                     EXSR SVRVGN
     C           WN0252    MULT WL0099    WN0250    H      USR Min Weight
     C           WN0253    MULT WL0099    WN0251    H      USR Max Weight
      * Weight entered as shipped is less than Minimum
      * CASE: PAR.USR Case Weight LT PAR.USR Min Weight
     C           WL0100    IFLT WN0250                     *IF
     C                     MOVEL'Y'       WL0101           USR Under Min
     C                     MOVEL'N'       WL0103           USR Exit Progra
      * Exit Prog. No  will set the program back to beginning
     C                     END                             *FI
      * Weight entered is greater than the maxiumum
      * CASE: PAR.USR Case Weight GT PAR.USR Max Weight
     C           WL0100    IFGT WN0251                     *IF
     C                     MOVEL'Y'       WL0102           USR Over Max
     C                     MOVEL'N'       WL0103           USR Exit Progra
      * Exit prog. no will set program back to beginning
     C                     END                             *FI
      * CASE: PAR.USR Case Quantity GT DB1.Quantity Allocated
     C           WL0099    IFGT OMCCQT                     *IF
     C                     MOVEL'O'       WUR0ST           Work Over/Short
     C                     END                             *FI
      * CASE: PAR.USR Case Quantity LT DB1.Quantity Allocated
     C           WL0099    IFLT OMCCQT                     *IF
     C                     MOVEL'S'       WUR0ST           Work Over/Short
     C                     END                             *FI
     C                     MOVEL'R'       WUGMST           Detail Line Sta
     C                     MOVELOMGMST    WUGNST           Detail Line Sta
      * FP1110 HPB ONLY 4/14/08 Output net gallons and net weight to Ord
      *   if Warehouse is Req Meter Readings is YES.
      *   Every other warehouse puts out the gross from manifest dtl
      * Rtv HPB fields        RT - Warehouse  * 
     C                     EXSR SWRVGN
      * CASE: LCL.WHS Req Meter Reading Shp is Yes
     C           YL0053    IFEQ 'Y'                        *IF
      * CHG Confirmed Qty      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0104           Company Number
     C                     Z-ADDOMC4NB    WL0105           Order Number
     C                     Z-ADDOMDPNB    WL0106           Order Sequence
     C                     Z-ADDOMUENB    WL0107           Order Secondary
     C                     MOVELWUGMST    WL0108    P      Detail Line Sta
     C                     MOVELWUGNST    WL0109    P      Detail Line Sta
     C                     MOVEL'P'       WL0110    P      Work Confirm St
     C                     MOVELWUR0ST    WL0111    P      Work Over/Short
     C                     Z-ADDWN0254    WL0112           Quantity Shippe
     C                     Z-ADDWN0255    WL0113           Weight Shipped
     C                     Z-ADDOMAODT    WL0114           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0115           Actual Shipped
     C                     MOVELOMZ1ST    WL0116    P      Modified Flag
     C                     MOVELOMZ3ST    WL0117    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0118    P      OD Schedule Ove
     C                     EXSR SXCHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Confirmed Qty      CH - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0104           Company Number
     C                     Z-ADDOMC4NB    WL0105           Order Number
     C                     Z-ADDOMDPNB    WL0106           Order Sequence
     C                     Z-ADDOMUENB    WL0107           Order Secondary
     C                     MOVELWUGMST    WL0108    P      Detail Line Sta
     C                     MOVELWUGNST    WL0109    P      Detail Line Sta
     C                     MOVEL'P'       WL0110    P      Work Confirm St
     C                     MOVELWUR0ST    WL0111    P      Work Over/Short
     C                     Z-ADDWL0099    WL0112           Quantity Shippe
     C                     Z-ADDWL0100    WL0113           Weight Shipped
     C                     Z-ADDOMAODT    WL0114           Scheduled Ship
     C                     Z-ADDOMGNDT    WL0115           Actual Shipped
     C                     MOVELOMZ1ST    WL0116    P      Modified Flag
     C                     MOVELOMZ3ST    WL0117    P      Substituted Fla
     C                     MOVELOMZ4ST    WL0118    P      OD Schedule Ove
     C                     EXSR SXCHRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Total Confirmed    RT - Manifest Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0099           USR Case Quanti
     C                     Z-ADD0         WL0100           USR Case Weight
     C                     Z-ADD0         WN0254           HPB Meter Net G
     C                     Z-ADD0         WN0255           HPB Meter Net W
      * Declare restrictor key work fields
     C           *LIKE     DEFN FNAIC3    WQSU01           Company Number
     C           *LIKE     DEFN FNC4NB    WQSU02           Order Number
     C           *LIKE     DEFN FNDPNB    WQSU03           Order Sequence
     C           *LIKE     DEFN FNUENB    WQSU04           Order Secondary
      * Define keylist
     C           KPSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Order Sequence
     C                     KFLD           WQSU04           Order Secondary
     C                     KFLD           FNRZNB           Case Sequence N
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           Company Number
     C                     KFLD           WQSU02           Order Number
     C                     KFLD           WQSU03           Order Sequence
     C                     KFLD           WQSU04           Order Secondary
      * Setup key
     C                     Z-ADDOMAIC3    WQSU01           Company Number
     C                     Z-ADDOMC4NB    WQSU02           Order Number
     C                     Z-ADDOMDPNB    WQSU03           Order Sequence
     C                     Z-ADDOMUENB    WQSU04           Order Secondary
     C                     Z-ADD0         FNRZNB           Case Sequence N
      * Establish starting position
     C           KPSSU     SETLL@FNCPCT                    *
     C           KRSSU     READE@FNCPCT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1196' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  FNFOQT    WL0099           USR Case Quanti
     C                     ADD  FNR0NB    WL0100           USR Case Weight
      * Only HPB will have these   4/14/08
     C                     ADD  FNN6WG    WN0254           HPB Meter Net G
     C                     ADD  FNIXNY    WN0255           HPB Meter Net W
     C           KRSSU     READE@FNCPCT                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Qty Min/Max        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0094    BZAIC3           Company Number
     C                     Z-ADDWL0098    BZHGCD           Item Code
      * Establish starting position
     C           KRSSV     CHAIN@BZREZG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBZCZWG    WN0252           Minimum Weight
     C                     Z-ADDBZC0WG    WN0253           Maximum Weight
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv HPB fields        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELOMAJCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0051           Production Ware
     C                     MOVEL*BLANK    YL0052           Warehouse Locat
     C                     MOVEL*BLANK    YL0053           WHS Req Meter R
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAOCD    YL0051           Production Ware
     C                     MOVELWFT0ST    YL0052           Warehouse Locat
     C                     MOVELWFRTSX    YL0053           WHS Req Meter R
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * CHG Confirmed Qty      CH - Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0256  70       Item Code
     C                     MOVEL*BLANK    WN0257  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0258  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0259  70       Order Group Cod
     C                     Z-ADD*ZERO     WN0260 112       Billing Detail
     C                     Z-ADD*ZERO     WN0261 112       Billing Detail
     C                     Z-ADD*ZERO     WN0262 112       Billing Detail
     C                     Z-ADD*ZERO     WN0263 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0264  1        Comment Print A
     C                     MOVEL*BLANK    WN0265  1        Comment Print I
     C                     MOVEL*BLANK    WN0266  1        Comment Print P
     C                     MOVEL*BLANK    WN0267  1        Comment Print S
     C                     Z-ADD*ZERO     WN0268 112       Extended Amount
     C                     Z-ADD*ZERO     WN0269  70       Market Pricing
     C                     MOVEL*BLANK    WN0270  3        Commodity Marke
     C                     MOVEL*BLANK    WN0271  3        Date Method Cod
     C                     MOVEL*BLANK    WN0272  3        Price Method Co
     C                     Z-ADD*ZERO     WN0273 114       Price Overage O
     C                     Z-ADD*ZERO     WN0274  70       Contract Number
     C                     MOVEL*BLANK    WN0275  1        Price Status
     C                     Z-ADD*ZERO     WN0276  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0277  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0278  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0279  1        OD Production P
     C                     MOVEL*BLANK    WN0280 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0281 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0282  1        Age Code
     C                     MOVEL*BLANK    WN0283  1        Palletize
     C                     MOVEL*BLANK    WN0284  1        Slip Sheet
     C                     MOVEL*BLANK    WN0285  1        Catch Weight St
     C                     MOVEL*BLANK    WN0286  1        Price Audit
     C                     MOVEL*BLANK    WN0287  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0288  1        Production Date
     C                     Z-ADD*ZERO     WN0289 112       Rated Freight
     C                     Z-ADD*ZERO     WN0290 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0291 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0292 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0293 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0294 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0295 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0296 114       Unit Price
     C                     Z-ADD*ZERO     WN0297 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0298 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0299 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0300 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0301  70       Requested Ship
     C                     MOVEL*BLANK    WN0302  1        Affect Inventor
     C                     MOVEL*BLANK    WN0303  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0304  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0305  30       Item Structure
     C                     Z-ADD*ZERO     WN0306  30       Item Structure
     C                     Z-ADD*ZERO     WN0307  30       Item Structure
     C                     MOVEL*BLANK    WN0308  2        Item Level
     C                     MOVEL*BLANK    WN0309  2        Quality Level
     C                     MOVEL*BLANK    WN0310  2        Pricing Product
     C                     MOVEL*BLANK    WN0311  2        Season Product
     C                     Z-ADD*ZERO     WN0312  70       Date of Origina
     C                     MOVEL*BLANK    WN0313 10        User Profile Na
     C                     MOVEL*BLANK    WN0314  6        Country Code
     C                     MOVEL*BLANK    WN0315  2        Event Code
     C                     MOVEL*BLANK    WN0316  3        Reason Code
     C                     MOVEL*BLANK    WN0317  3        Sales Route Cod
     C                     Z-ADD*ZERO     WN0318 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0319 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0320  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0321  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0322  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0323  1        Affect Commissi
     C                     MOVEL*BLANK    WN0324  1        Affect Pricing
     C                     MOVEL*BLANK    WN0325  1        Released by Use
     C                     MOVEL*BLANK    WN0326  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0327  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0328  3        Production Ware
     C                     MOVEL*BLANK    WN0329  3        OD Price Type
     C                     Z-ADD*ZERO     WN0330  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0331  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0332  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0333  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0334  70       OD Firm Date
     C                     Z-ADD*ZERO     WN0335  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0336  60       Price Code
     C                     Z-ADD*ZERO     WN0337  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0338  60       Substitution Li
     C                     Z-ADD*ZERO     WN0339  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0340 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0341 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0342 112       OD Item Target
     C                     Z-ADD*ZERO     WN0343 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0344 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0345 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0346 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0347 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0348 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0349 114       OD Original Ord
     C                     Z-ADD*ZERO     WN0350 114       OD Cancel Date
     C                     Z-ADD*ZERO     WN0351 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0352 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0353  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0354  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0355  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0356 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0357  40       Item Age Days
     C                     Z-ADD*ZERO     WN0358  70       Production Ovr
     C                     Z-ADD*ZERO     WN0359  70       Production Ovr
     C                     MOVEL*BLANK    WN0360  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0361  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0362  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0363  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0364  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0365  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0366  1        EDI Status 1
     C                     MOVEL*BLANK    WN0367  1        EDI Status 2
     C                     MOVEL*BLANK    WN0368  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0369  60       Job Time
     C                     MOVEL*BLANK    WN0370 10        User Id
     C                     MOVEL*BLANK    WN0371 10        Job Name
     C                     Z-ADD*ZERO     WN0372  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0104    WGAIC3           Company Number
     C                     Z-ADDWL0105    WGC4NB           Order Number
     C                     Z-ADDWL0106    WGDPNB           Order Sequence
     C                     Z-ADDWL0107    WGUENB           Order Secondary
      *
     C           KLCHSX    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C           KLCHSX    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YCRDCS
      * Move non-key fields to @BGWKL0
     C                     MOVELWL0108    WGGMST    P      Detail Line Sta
     C                     MOVELWL0109    WGGNST    P      Detail Line Sta
     C                     MOVELWL0110    WGRZST    P      Work Confirm St
     C                     MOVELWL0111    WGR0ST    P      Work Over/Short
     C                     Z-ADDWL0112    WGCBQT           Quantity Shippe
     C                     Z-ADDWL0113    WGATWG           Weight Shipped
     C                     Z-ADDWL0114    WGAODT           Scheduled Ship
     C                     Z-ADDWL0115    WGGNDT           Actual Shipped
     C                     MOVELWL0116    WGZ1ST    P      Modified Flag
     C                     MOVELWL0117    WGZ3ST    P      Substituted Fla
     C                     MOVELWL0118    WGZ4ST    P      OD Schedule Ove
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSY01           Application Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSY01           Application Cod
     C                     MOVEL'SHP'     WQSY01           Application Cod
      * Establish starting position
     C           KRSSY     SETLL@DNRESF                    *
     C           KRSSY     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SZRVGN
     C                     END                             *FI
     C           KRSSY     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSZ01           Application Cod
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSZ01           Application Cod
      * Establish starting position
     C           KRSSZ     SETLL@DNRESF                    *
     C           KRSSZ     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSZ     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Do all processing for selling an order
      *================================================================
      * lcl.quantity 7.0 usr = net gallons
      * lcl.gross gallons usr = gross gallons
      * ----- Retrieve from selected order -----
      * RTV HPB to Gen SEL RINRT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0004           Company Number
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1DPNB    WL0006           Order Sequence
     C                     Z-ADD#1UENB    WL0007           Order Secondary
     C                     Z-ADD#1RZNB    WL0008           Case Sequence N
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0010           Case Quantity
     C                     Z-ADDWL0010    YL0011           Case Weight
     C                     Z-ADDWL0011    YL0003           HPB Meter Net G
     C                     Z-ADDWL0012    YL0012           HPB COA Batch N
     C                     Z-ADDWL0013    YL0013           HPB Meter Start
     C                     Z-ADDWL0014    YL0014           HPB Meter Endin
     C                     Z-ADDWL0015    YL0015           HPB Meter Total
     C                     Z-ADDWL0016    YL0016           HPB Meter Net W
     C                     Z-ADDWL0017    YL0017           HPB Density Ref
      * old - calc multiplier
      * CASE: LCL.Case Quantity is GT *ZERO
     C           YL0010    IFGT *ZERO                      *IF
      * multiplier with 7 dec
     C           YL0011    DIV  YL0010    W0WD      H      *Synon (17,7) w
     C                     Z-ADDYL0010    YL0018           USR Quantity Sh
     C                     Z-ADDYL0011    YL0019           USR Weight Bill
     C                     END                             *FI
      * New gross gallon qty and weight  -- NEW use par coming back from
     C           YL0006    MULT W0WD      YL0011    H      Case Weight
      * In case it rounds up greater than what was on the orig order
      * CASE: LCL.Case Weight GT LCL.USR Weight Billed
     C           YL0011    IFGT YL0019                     *IF
     C                     Z-ADDYL0019    YL0011           Case Weight
     C                     END                             *FI
     C                     Z-ADDYL0006    YL0015           HPB Meter Total
     C                     Z-ADD1         YL0013           HPB Meter Start
     C                     Z-ADDYL0006    YL0014           HPB Meter Endin
      * new net weight & net gallons
     C           YL0009    MULT W0WD      YL0016           HPB Meter Net W
     C                     Z-ADDYL0009    YL0003           HPB Meter Net G
      * RTV Load ID            RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0018           Company Number
     C                     Z-ADD#1C4NB    WL0019           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    YL0020           Load ID
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0021           Company Number
     C                     Z-ADD#1C4NB    WL0022           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0012           HPB COA Batch N
      * ----- Set from selected order per gallons entered
      * ----- Create/ Update HPB data for the order that is being shipped
      *
     C                     Z-ADD*ZERO     WN0001  50       Case Sequence N
     C                     MOVEL*BLANK    WN0002  1        Inventory Updat
     C                     Z-ADD*ZERO     WN0003  70       Label Date
     C                     Z-ADD*ZERO     WN0004  80       PT Serial Numbe
     C                     MOVEL*BLANK    WN0005  1        EDI Status 1
     C                     MOVEL*BLANK    WN0006  1        EDI Status 2
     C                     MOVEL*BLANK    WN0007  1        EDI Status 3
     C                     MOVEL*BLANK    WN0008  1        Record Status
     C                     Z-ADD*ZERO     WN0009  60       Job Time
     C                     MOVEL*BLANK    WN0010 10        User Id
     C                     MOVEL*BLANK    WN0011 10        Job Name
     C                     Z-ADD*ZERO     WN0012  70       Job Date
      *
      * Crt Manifest Detl-HPB IF
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0024           Company Number
     C                     Z-ADDP2C4NB    WL0025           Order Number
     C                     Z-ADDP2DPNB    WL0026           Order Sequence
     C                     Z-ADDP2UENB    WL0027           Order Secondary
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WN0001           Case Sequence N
      * Crt Manifest Detail   CR - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0029           Company Number
     C                     Z-ADDP2C4NB    WL0030           Order Number
     C                     Z-ADDP2DPNB    WL0031           Order Sequence
     C                     Z-ADDP2UENB    WL0032           Order Secondary
     C                     Z-ADDWN0001    WL0033           Case Sequence N
     C                     Z-ADDYL0006    WL0034           Case Quantity
     C                     Z-ADDYL0011    WL0035           Case Weight
     C                     MOVELWN0002    WL0036    P      Inventory Updat
     C                     Z-ADDWN0003    WL0037           Label Date
     C                     Z-ADDWN0004    WL0038           PT Serial Numbe
     C                     Z-ADDP2HGCD    WL0039           Item Code
     C                     MOVELP2AJCD    WL0040    P      Warehouse Code
     C                     Z-ADD*ZERO     WL0041           Production Date
     C                     Z-ADD0         WL0042           Manifest Gross
     C                     MOVEL*BLANK    WL0043           Manifest Lot ID
     C                     Z-ADD0         WL0044           Manifest Total
     C                     Z-ADD0         WL0045           Manifest Co-Par
     C                     Z-ADD0         WL0046           Manifest Pallet
     C                     MOVELWUGBTX    WL0047    P      Manifest Shift
     C                     Z-ADDYL0003    WL0048           HPB Meter Net G
     C                     Z-ADD0         WL0049           Manifest Net We
     C                     MOVELWUGCTX    WL0050    P      Manifest Unused
     C                     MOVELWUGDTX    WL0051    P      Manifest Unused
     C                     Z-ADD0         WL0052           Manifest Unused
     C                     Z-ADDYL0012    WL0053           HPB COA Batch N
     C                     Z-ADDYL0013    WL0054           HPB Meter Start
     C                     Z-ADDYL0014    WL0055           HPB Meter Endin
     C                     Z-ADDYL0015    WL0056           HPB Meter Total
     C                     Z-ADDYL0016    WL0057           HPB Meter Net W
     C                     Z-ADDYL0017    WL0058           HPB Density Ref
     C                     MOVELWN0005    WL0059    P      EDI Status 1
     C                     MOVELWN0006    WL0060    P      EDI Status 2
     C                     MOVELWN0007    WL0061    P      EDI Status 3
     C                     MOVELWN0008    WL0062    P      Record Status
     C                     Z-ADDWN0009    WL0063           Job Time
     C                     MOVELWN0010    WL0064    P      User Id
     C                     MOVELWN0011    WL0065    P      Job Name
     C                     Z-ADDWN0012    WL0066           Job Date
     C                     EXSR SMCRRC
      * batch's company is in par.Company number 041405
      * Crt Manifest Dtl RIN  CR - Manifest Detail RIN Sell  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0067           Company Number
     C                     Z-ADDP2C4NB    WL0068           Order Number
     C                     Z-ADDP2DPNB    WL0069           Order Sequence
     C                     Z-ADDP2UENB    WL0070           Order Secondary
     C                     Z-ADDWN0001    WL0071           Case Sequence N
     C                     MOVEL#1L6T1    WL0072    P      COA ULSD Compan
     C                     Z-ADD#1I3NY    WL0073           COA Batch Numbe
     C                     Z-ADD#1JYNY    WL0074           COA Batch Heade
     C                     Z-ADD#1Q1NY    WL0075           COA Batch Hdr R
     C                     Z-ADDYL0003    WL0076           HPB Meter Net G
     C                     Z-ADD#1AIC3    WL0077           COA Batch Compa
     C                     MOVELYL0021    WL0078    P      MDRS Unused sts
     C                     MOVELWN0008    WL0079    P      Record Status
     C                     Z-ADD0         WL0080           Create Date
     C                     Z-ADD0         WL0081           Create Time
     C                     MOVEL*BLANK    WL0082           Create User
     C                     MOVEL*BLANK    WL0083           Create Program
     C                     EXSR SNCRRC
      * CHG Prod Temp-HPB     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3RMNB    WL0084           Load ID
     C                     Z-ADD#CJENY    WL0085           Product Tempera
     C                     MOVELP4XCCD    WL0086    P      Carrier Broker
     C                     EXSR SOCHRC
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0087           Company Number
     C                     Z-ADDP2C4NB    WL0088           Order Number
     C                     Z-ADDP3RMNB    WL0089           Load ID
     C                     Z-ADDYL0012    WL0090           HPB COA Batch N
     C                     EXSR SPRVGN
     C                     MOVEL'Y'       P5B8ST           Status - Y or N
      * RTV Chg for Confirm    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0094           Company Number
     C                     Z-ADDP2C4NB    WL0095           Order Number
     C                     Z-ADDP2DPNB    WL0096           Order Sequence
     C                     Z-ADDP2UENB    WL0097           Order Secondary
     C                     Z-ADDP2HGCD    WL0098           Item Code
     C                     Z-ADDYL0010    WL0099           USR Case Quanti
     C                     Z-ADDYL0011    WL0100           USR Case Weight
     C                     MOVELYL0048    WL0101    P      USR Under Min
     C                     MOVELYL0049    WL0102    P      USR Over Max
     C                     MOVELYL0050    WL0103    P      USR Exit Progra
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    YL0010           USR Case Quanti
     C                     Z-ADDWL0100    YL0011           USR Case Weight
     C                     MOVELWL0101    YL0048    P      USR Under Min
     C                     MOVELWL0102    YL0049    P      USR Over Max
     C                     MOVELWL0103    YL0050    P      USR Exit Progra
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Do all processing for selling an order
      *================================================================
      * quantity 7.0 usr = net gallons
      * ----- Retrieve from selected order -----
      * RTV HPB to Gen SEL RINRT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0004           Company Number
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1DPNB    WL0006           Order Sequence
     C                     Z-ADD#1UENB    WL0007           Order Secondary
     C                     Z-ADD#1RZNB    WL0008           Case Sequence N
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0010           Case Quantity
     C                     Z-ADDWL0010    YL0011           Case Weight
     C                     Z-ADDWL0011    YL0003           HPB Meter Net G
     C                     Z-ADDWL0012    YL0012           HPB COA Batch N
     C                     Z-ADDWL0013    YL0013           HPB Meter Start
     C                     Z-ADDWL0014    YL0014           HPB Meter Endin
     C                     Z-ADDWL0015    YL0015           HPB Meter Total
     C                     Z-ADDWL0016    YL0016           HPB Meter Net W
     C                     Z-ADDWL0017    YL0017           HPB Density Ref
      * CASE: LCL.Case Quantity is GT *ZERO
     C           YL0010    IFGT *ZERO                      *IF
      * multiplier with 7 decimals
     C           YL0011    DIV  YL0010    W0WD      H      *Synon (17,7) w
     C                     Z-ADDYL0010    YL0018           USR Quantity Sh
     C                     Z-ADDYL0011    YL0019           USR Weight Bill
     C                     END                             *FI
      * new gross gallon qty and weight
      * RMC round this calc for the multipler  3/29/10
     C           YL0010    DIV  YL0003    YL0054    H      Numeric Value 1
     C           YL0009    MULT YL0054    YL0010    H      Case Quantity
      * In case it rounds up greater than what was on the orig order
      * CASE: LCL.Case Quantity GT LCL.USR Quantity Shipped
     C           YL0010    IFGT YL0018                     *IF
     C                     Z-ADDYL0018    YL0010           Case Quantity
     C                     END                             *FI
     C           YL0010    MULT W0WD      YL0011    H      Case Weight
      * In case it rounds up greater than what was on the orig order
      * CASE: LCL.Case Weight GT LCL.USR Weight Billed
     C           YL0011    IFGT YL0019                     *IF
     C                     Z-ADDYL0019    YL0011           Case Weight
     C                     END                             *FI
     C                     Z-ADDYL0010    YL0015           HPB Meter Total
     C                     Z-ADD1         YL0013           HPB Meter Start
     C                     Z-ADDYL0010    YL0014           HPB Meter Endin
      * new net weight & net gallons
     C           YL0009    MULT W0WD      YL0016           HPB Meter Net W
     C                     Z-ADDYL0009    YL0003           HPB Meter Net G
      * RTV Load ID            RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0018           Company Number
     C                     Z-ADD#1C4NB    WL0019           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    YL0020           Load ID
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0021           Company Number
     C                     Z-ADD#1C4NB    WL0022           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0012           HPB COA Batch N
      * ----- Set from selected order per gallons entered
      * ----- Create/ Update HPB data for the order that is being shipped
      *
     C                     Z-ADD*ZERO     WN0373  50       Case Sequence N
     C                     MOVEL*BLANK    WN0374  1        Inventory Updat
     C                     Z-ADD*ZERO     WN0375  70       Label Date
     C                     Z-ADD*ZERO     WN0376  80       PT Serial Numbe
     C                     MOVEL*BLANK    WN0377  1        EDI Status 1
     C                     MOVEL*BLANK    WN0378  1        EDI Status 2
     C                     MOVEL*BLANK    WN0379  1        EDI Status 3
     C                     MOVEL*BLANK    WN0380  1        Record Status
     C                     Z-ADD*ZERO     WN0381  60       Job Time
     C                     MOVEL*BLANK    WN0382 10        User Id
     C                     MOVEL*BLANK    WN0383 10        Job Name
     C                     Z-ADD*ZERO     WN0384  70       Job Date
      *
      * Crt Manifest Detl-HPB IF
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0024           Company Number
     C                     Z-ADDP2C4NB    WL0025           Order Number
     C                     Z-ADDP2DPNB    WL0026           Order Sequence
     C                     Z-ADDP2UENB    WL0027           Order Secondary
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WN0373           Case Sequence N
      * Crt Manifest Detail   CR - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0029           Company Number
     C                     Z-ADDP2C4NB    WL0030           Order Number
     C                     Z-ADDP2DPNB    WL0031           Order Sequence
     C                     Z-ADDP2UENB    WL0032           Order Secondary
     C                     Z-ADDWN0373    WL0033           Case Sequence N
     C                     Z-ADDYL0010    WL0034           Case Quantity
     C                     Z-ADDYL0011    WL0035           Case Weight
     C                     MOVELWN0374    WL0036    P      Inventory Updat
     C                     Z-ADDWN0375    WL0037           Label Date
     C                     Z-ADDWN0376    WL0038           PT Serial Numbe
     C                     Z-ADDP2HGCD    WL0039           Item Code
     C                     MOVELP2AJCD    WL0040    P      Warehouse Code
     C                     Z-ADD*ZERO     WL0041           Production Date
     C                     Z-ADD0         WL0042           Manifest Gross
     C                     MOVEL*BLANK    WL0043           Manifest Lot ID
     C                     Z-ADD0         WL0044           Manifest Total
     C                     Z-ADD0         WL0045           Manifest Co-Par
     C                     Z-ADD0         WL0046           Manifest Pallet
     C                     MOVELWUGBTX    WL0047    P      Manifest Shift
     C                     Z-ADDYL0003    WL0048           HPB Meter Net G
     C                     Z-ADD0         WL0049           Manifest Net We
     C                     MOVELWUGCTX    WL0050    P      Manifest Unused
     C                     MOVELWUGDTX    WL0051    P      Manifest Unused
     C                     Z-ADD0         WL0052           Manifest Unused
     C                     Z-ADDYL0012    WL0053           HPB COA Batch N
     C                     Z-ADDYL0013    WL0054           HPB Meter Start
     C                     Z-ADDYL0014    WL0055           HPB Meter Endin
     C                     Z-ADDYL0015    WL0056           HPB Meter Total
     C                     Z-ADDYL0016    WL0057           HPB Meter Net W
     C                     Z-ADDYL0017    WL0058           HPB Density Ref
     C                     MOVELWN0377    WL0059    P      EDI Status 1
     C                     MOVELWN0378    WL0060    P      EDI Status 2
     C                     MOVELWN0379    WL0061    P      EDI Status 3
     C                     MOVELWN0380    WL0062    P      Record Status
     C                     Z-ADDWN0381    WL0063           Job Time
     C                     MOVELWN0382    WL0064    P      User Id
     C                     MOVELWN0383    WL0065    P      Job Name
     C                     Z-ADDWN0384    WL0066           Job Date
     C                     EXSR SMCRRC
      * batch's company is in par.Company number 041405
      * Crt Manifest Dtl RIN  CR - Manifest Detail RIN Sell  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0067           Company Number
     C                     Z-ADDP2C4NB    WL0068           Order Number
     C                     Z-ADDP2DPNB    WL0069           Order Sequence
     C                     Z-ADDP2UENB    WL0070           Order Secondary
     C                     Z-ADDWN0373    WL0071           Case Sequence N
     C                     MOVEL#1L6T1    WL0072    P      COA ULSD Compan
     C                     Z-ADD#1I3NY    WL0073           COA Batch Numbe
     C                     Z-ADD#1JYNY    WL0074           COA Batch Heade
     C                     Z-ADD#1Q1NY    WL0075           COA Batch Hdr R
     C                     Z-ADDYL0003    WL0076           HPB Meter Net G
     C                     Z-ADD#1AIC3    WL0077           COA Batch Compa
     C                     MOVELYL0021    WL0078    P      MDRS Unused sts
     C                     MOVELWN0380    WL0079    P      Record Status
     C                     Z-ADD0         WL0080           Create Date
     C                     Z-ADD0         WL0081           Create Time
     C                     MOVEL*BLANK    WL0082           Create User
     C                     MOVEL*BLANK    WL0083           Create Program
     C                     EXSR SNCRRC
      * CHG Prod Temp-HPB     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3RMNB    WL0084           Load ID
     C                     Z-ADD#1QYNY    WL0085           Product Tempera
     C                     MOVELP4XCCD    WL0086    P      Carrier Broker
     C                     EXSR SOCHRC
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0087           Company Number
     C                     Z-ADDP2C4NB    WL0088           Order Number
     C                     Z-ADDP3RMNB    WL0089           Load ID
     C                     Z-ADDYL0012    WL0090           HPB COA Batch N
     C                     EXSR SPRVGN
     C                     MOVEL'Y'       P5B8ST           Status - Y or N
      * RTV Chg for Confirm    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0094           Company Number
     C                     Z-ADDP2C4NB    WL0095           Order Number
     C                     Z-ADDP2DPNB    WL0096           Order Sequence
     C                     Z-ADDP2UENB    WL0097           Order Secondary
     C                     Z-ADDP2HGCD    WL0098           Item Code
     C                     Z-ADDYL0010    WL0099           USR Case Quanti
     C                     Z-ADDYL0011    WL0100           USR Case Weight
     C                     MOVELYL0048    WL0101    P      USR Under Min
     C                     MOVELYL0049    WL0102    P      USR Over Max
     C                     MOVELYL0050    WL0103    P      USR Exit Progra
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    YL0010           USR Case Quanti
     C                     Z-ADDWL0100    YL0011           USR Case Weight
     C                     MOVELWL0101    YL0048    P      USR Under Min
     C                     MOVELWL0102    YL0049    P      USR Over Max
     C                     MOVELWL0103    YL0050    P      USR Exit Progra
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Do all processing for selling an order
      *================================================================
      * quantity 7.0 usr = net gallons
      * ----- Retrieve from selected order -----
      * RTV HPB to Gen SEL RINRT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0004           Company Number
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1DPNB    WL0006           Order Sequence
     C                     Z-ADD#1UENB    WL0007           Order Secondary
     C                     Z-ADD#1RZNB    WL0008           Case Sequence N
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0010           Case Quantity
     C                     Z-ADDWL0010    YL0011           Case Weight
     C                     Z-ADDWL0011    YL0003           HPB Meter Net G
     C                     Z-ADDWL0012    YL0012           HPB COA Batch N
     C                     Z-ADDWL0013    YL0013           HPB Meter Start
     C                     Z-ADDWL0014    YL0014           HPB Meter Endin
     C                     Z-ADDWL0015    YL0015           HPB Meter Total
     C                     Z-ADDWL0016    YL0016           HPB Meter Net W
     C                     Z-ADDWL0017    YL0017           HPB Density Ref
      * CASE: LCL.Case Quantity is GT *ZERO
     C           YL0010    IFGT *ZERO                      *IF
      * multiplier with 7 dec
     C           YL0011    DIV  YL0010    W0WD      H      *Synon (17,7) w
     C                     Z-ADDYL0010    YL0018           USR Quantity Sh
     C                     Z-ADDYL0011    YL0019           USR Weight Bill
     C                     END                             *FI
      * new gross gallon qty and weight
     C           YL0010    DIV  YL0003    YL0054    H      Numeric Value 1
     C           YL0009    MULT YL0054    YL0010    H      Case Quantity
      * In case it rounds up greater than what was on the orig order
      * CASE: LCL.Case Quantity GT LCL.USR Quantity Shipped
     C           YL0010    IFGT YL0018                     *IF
     C                     Z-ADDYL0018    YL0010           Case Quantity
     C                     END                             *FI
     C           YL0010    MULT W0WD      YL0011    H      Case Weight
      * In case it rounds up greater than what was on the orig order
      * CASE: LCL.Case Weight GT LCL.USR Weight Billed
     C           YL0011    IFGT YL0019                     *IF
     C                     Z-ADDYL0019    YL0011           Case Weight
     C                     END                             *FI
     C                     Z-ADDYL0010    YL0015           HPB Meter Total
     C                     Z-ADD1         YL0013           HPB Meter Start
     C                     Z-ADDYL0010    YL0014           HPB Meter Endin
      * new net weight & net gallons
     C           YL0009    MULT W0WD      YL0016           HPB Meter Net W
     C                     Z-ADDYL0009    YL0003           HPB Meter Net G
      * RTV Load ID            RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0018           Company Number
     C                     Z-ADD#1C4NB    WL0019           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    YL0020           Load ID
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0021           Company Number
     C                     Z-ADD#1C4NB    WL0022           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0012           HPB COA Batch N
      * ----- Set from selected order per gallons entered
      * ----- Create/ Update HPB data for the order that is being shipped
      *
     C                     Z-ADD*ZERO     WN0385  50       Case Sequence N
     C                     MOVEL*BLANK    WN0386  1        Inventory Updat
     C                     Z-ADD*ZERO     WN0387  70       Label Date
     C                     Z-ADD*ZERO     WN0388  80       PT Serial Numbe
     C                     MOVEL*BLANK    WN0389  1        EDI Status 1
     C                     MOVEL*BLANK    WN0390  1        EDI Status 2
     C                     MOVEL*BLANK    WN0391  1        EDI Status 3
     C                     MOVEL*BLANK    WN0392  1        Record Status
     C                     Z-ADD*ZERO     WN0393  60       Job Time
     C                     MOVEL*BLANK    WN0394 10        User Id
     C                     MOVEL*BLANK    WN0395 10        Job Name
     C                     Z-ADD*ZERO     WN0396  70       Job Date
      *
      * Crt Manifest Detl-HPB IF
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0024           Company Number
     C                     Z-ADDP2C4NB    WL0025           Order Number
     C                     Z-ADDP2DPNB    WL0026           Order Sequence
     C                     Z-ADDP2UENB    WL0027           Order Secondary
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WN0385           Case Sequence N
      * Crt Manifest Detail   CR - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0029           Company Number
     C                     Z-ADDP2C4NB    WL0030           Order Number
     C                     Z-ADDP2DPNB    WL0031           Order Sequence
     C                     Z-ADDP2UENB    WL0032           Order Secondary
     C                     Z-ADDWN0385    WL0033           Case Sequence N
     C                     Z-ADDYL0010    WL0034           Case Quantity
     C                     Z-ADDYL0011    WL0035           Case Weight
     C                     MOVELWN0386    WL0036    P      Inventory Updat
     C                     Z-ADDWN0387    WL0037           Label Date
     C                     Z-ADDWN0388    WL0038           PT Serial Numbe
     C                     Z-ADDP2HGCD    WL0039           Item Code
     C                     MOVELP2AJCD    WL0040    P      Warehouse Code
     C                     Z-ADD*ZERO     WL0041           Production Date
     C                     Z-ADD0         WL0042           Manifest Gross
     C                     MOVEL*BLANK    WL0043           Manifest Lot ID
     C                     Z-ADD0         WL0044           Manifest Total
     C                     Z-ADD0         WL0045           Manifest Co-Par
     C                     Z-ADD0         WL0046           Manifest Pallet
     C                     MOVELWUGBTX    WL0047    P      Manifest Shift
     C                     Z-ADDYL0003    WL0048           HPB Meter Net G
     C                     Z-ADD0         WL0049           Manifest Net We
     C                     MOVELWUGCTX    WL0050    P      Manifest Unused
     C                     MOVELWUGDTX    WL0051    P      Manifest Unused
     C                     Z-ADD0         WL0052           Manifest Unused
     C                     Z-ADDYL0012    WL0053           HPB COA Batch N
     C                     Z-ADDYL0013    WL0054           HPB Meter Start
     C                     Z-ADDYL0014    WL0055           HPB Meter Endin
     C                     Z-ADDYL0015    WL0056           HPB Meter Total
     C                     Z-ADDYL0016    WL0057           HPB Meter Net W
     C                     Z-ADDYL0017    WL0058           HPB Density Ref
     C                     MOVELWN0389    WL0059    P      EDI Status 1
     C                     MOVELWN0390    WL0060    P      EDI Status 2
     C                     MOVELWN0391    WL0061    P      EDI Status 3
     C                     MOVELWN0392    WL0062    P      Record Status
     C                     Z-ADDWN0393    WL0063           Job Time
     C                     MOVELWN0394    WL0064    P      User Id
     C                     MOVELWN0395    WL0065    P      Job Name
     C                     Z-ADDWN0396    WL0066           Job Date
     C                     EXSR SMCRRC
      * batch's company is in par.Company number 041405
      * Crt Manifest Dtl RIN  CR - Manifest Detail RIN Sell  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0067           Company Number
     C                     Z-ADDP2C4NB    WL0068           Order Number
     C                     Z-ADDP2DPNB    WL0069           Order Sequence
     C                     Z-ADDP2UENB    WL0070           Order Secondary
     C                     Z-ADDWN0385    WL0071           Case Sequence N
     C                     MOVEL#1L6T1    WL0072    P      COA ULSD Compan
     C                     Z-ADD#1I3NY    WL0073           COA Batch Numbe
     C                     Z-ADD#1JYNY    WL0074           COA Batch Heade
     C                     Z-ADD#1Q1NY    WL0075           COA Batch Hdr R
     C                     Z-ADDYL0003    WL0076           HPB Meter Net G
     C                     Z-ADD#1AIC3    WL0077           COA Batch Compa
     C                     MOVELYL0021    WL0078    P      MDRS Unused sts
     C                     MOVELWN0392    WL0079    P      Record Status
     C                     Z-ADD0         WL0080           Create Date
     C                     Z-ADD0         WL0081           Create Time
     C                     MOVEL*BLANK    WL0082           Create User
     C                     MOVEL*BLANK    WL0083           Create Program
     C                     EXSR SNCRRC
      * CHG Prod Temp-HPB     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3RMNB    WL0084           Load ID
     C                     Z-ADD#1QYNY    WL0085           Product Tempera
     C                     MOVELP4XCCD    WL0086    P      Carrier Broker
     C                     EXSR SOCHRC
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0087           Company Number
     C                     Z-ADDP2C4NB    WL0088           Order Number
     C                     Z-ADDP3RMNB    WL0089           Load ID
     C                     Z-ADDYL0012    WL0090           HPB COA Batch N
     C                     EXSR SPRVGN
     C                     MOVEL'Y'       P5B8ST           Status - Y or N
      * RTV Chg for Confirm    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0094           Company Number
     C                     Z-ADDP2C4NB    WL0095           Order Number
     C                     Z-ADDP2DPNB    WL0096           Order Sequence
     C                     Z-ADDP2UENB    WL0097           Order Secondary
     C                     Z-ADDP2HGCD    WL0098           Item Code
     C                     Z-ADDYL0010    WL0099           USR Case Quanti
     C                     Z-ADDYL0011    WL0100           USR Case Weight
     C                     MOVELYL0048    WL0101    P      USR Under Min
     C                     MOVELYL0049    WL0102    P      USR Over Max
     C                     MOVELYL0050    WL0103    P      USR Exit Progra
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    YL0010           USR Case Quanti
     C                     Z-ADDWL0100    YL0011           USR Case Weight
     C                     MOVELWL0101    YL0048    P      USR Under Min
     C                     MOVELWL0102    YL0049    P      USR Over Max
     C                     MOVELWL0103    YL0050    P      USR Exit Progra
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Do all processing for selling an order
      *================================================================
      * lcl.quantity 7.0 usr = net gallons
      * lcl.gross gallons usr= gross gallons
      * ----- Retrieve from selected order -----
      * RTV HPB to Gen SEL RINRT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0004           Company Number
     C                     Z-ADD#1C4NB    WL0005           Order Number
     C                     Z-ADD#1DPNB    WL0006           Order Sequence
     C                     Z-ADD#1UENB    WL0007           Order Secondary
     C                     Z-ADD#1RZNB    WL0008           Case Sequence N
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0009    YL0010           Case Quantity
     C                     Z-ADDWL0010    YL0011           Case Weight
     C                     Z-ADDWL0011    YL0003           HPB Meter Net G
     C                     Z-ADDWL0012    YL0012           HPB COA Batch N
     C                     Z-ADDWL0013    YL0013           HPB Meter Start
     C                     Z-ADDWL0014    YL0014           HPB Meter Endin
     C                     Z-ADDWL0015    YL0015           HPB Meter Total
     C                     Z-ADDWL0016    YL0016           HPB Meter Net W
     C                     Z-ADDWL0017    YL0017           HPB Density Ref
      * old - calc multiplier
      * CASE: LCL.Case Quantity is GT *ZERO
     C           YL0010    IFGT *ZERO                      *IF
      * multiplier with 7 dec
     C           YL0011    DIV  YL0010    W0WD      H      *Synon (17,7) w
     C                     Z-ADDYL0010    YL0018           USR Quantity Sh
     C                     Z-ADDYL0011    YL0019           USR Weight Bill
     C                     END                             *FI
      * New gross gallon qty and weight  -- NEW use par coming back from
     C           YL0006    MULT W0WD      YL0011    H      Case Weight
      * In case it rounds up greater than what was on the orig order
      * CASE: LCL.Case Weight GT LCL.USR Weight Billed
     C           YL0011    IFGT YL0019                     *IF
     C                     Z-ADDYL0019    YL0011           Case Weight
     C                     END                             *FI
     C                     Z-ADDYL0006    YL0015           HPB Meter Total
     C                     Z-ADD1         YL0013           HPB Meter Start
     C                     Z-ADDYL0006    YL0014           HPB Meter Endin
      * new net weight & net gallons
     C           YL0009    MULT W0WD      YL0016           HPB Meter Net W
     C                     Z-ADDYL0009    YL0003           HPB Meter Net G
      * RTV Load ID            RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0018           Company Number
     C                     Z-ADD#1C4NB    WL0019           Order Number
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0020    YL0020           Load ID
      * RTV HPB fields         RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#1CWC3    WL0021           Company Number
     C                     Z-ADD#1C4NB    WL0022           Order Number
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    YL0012           HPB COA Batch N
      * ----- Set from selected order per gallons entered
      * ----- Create/ Update HPB data for the order that is being shipped
      *
     C                     Z-ADD*ZERO     WN0397  50       Case Sequence N
     C                     MOVEL*BLANK    WN0398  1        Inventory Updat
     C                     Z-ADD*ZERO     WN0399  70       Label Date
     C                     Z-ADD*ZERO     WN0400  80       PT Serial Numbe
     C                     MOVEL*BLANK    WN0401  1        EDI Status 1
     C                     MOVEL*BLANK    WN0402  1        EDI Status 2
     C                     MOVEL*BLANK    WN0403  1        EDI Status 3
     C                     MOVEL*BLANK    WN0404  1        Record Status
     C                     Z-ADD*ZERO     WN0405  60       Job Time
     C                     MOVEL*BLANK    WN0406 10        User Id
     C                     MOVEL*BLANK    WN0407 10        Job Name
     C                     Z-ADD*ZERO     WN0408  70       Job Date
      *
      * Crt Manifest Detl-HPB IF
      * Rtv Next Case Seq#    RT - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0024           Company Number
     C                     Z-ADDP2C4NB    WL0025           Order Number
     C                     Z-ADDP2DPNB    WL0026           Order Sequence
     C                     Z-ADDP2UENB    WL0027           Order Secondary
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0028    WN0397           Case Sequence N
      * Crt Manifest Detail   CR - Manifest Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0029           Company Number
     C                     Z-ADDP2C4NB    WL0030           Order Number
     C                     Z-ADDP2DPNB    WL0031           Order Sequence
     C                     Z-ADDP2UENB    WL0032           Order Secondary
     C                     Z-ADDWN0397    WL0033           Case Sequence N
     C                     Z-ADDYL0006    WL0034           Case Quantity
     C                     Z-ADDYL0011    WL0035           Case Weight
     C                     MOVELWN0398    WL0036    P      Inventory Updat
     C                     Z-ADDWN0399    WL0037           Label Date
     C                     Z-ADDWN0400    WL0038           PT Serial Numbe
     C                     Z-ADDP2HGCD    WL0039           Item Code
     C                     MOVELP2AJCD    WL0040    P      Warehouse Code
     C                     Z-ADD*ZERO     WL0041           Production Date
     C                     Z-ADD0         WL0042           Manifest Gross
     C                     MOVEL*BLANK    WL0043           Manifest Lot ID
     C                     Z-ADD0         WL0044           Manifest Total
     C                     Z-ADD0         WL0045           Manifest Co-Par
     C                     Z-ADD0         WL0046           Manifest Pallet
     C                     MOVELWUGBTX    WL0047    P      Manifest Shift
     C                     Z-ADDYL0003    WL0048           HPB Meter Net G
     C                     Z-ADD0         WL0049           Manifest Net We
     C                     MOVELWUGCTX    WL0050    P      Manifest Unused
     C                     MOVELWUGDTX    WL0051    P      Manifest Unused
     C                     Z-ADD0         WL0052           Manifest Unused
     C                     Z-ADDYL0012    WL0053           HPB COA Batch N
     C                     Z-ADDYL0013    WL0054           HPB Meter Start
     C                     Z-ADDYL0014    WL0055           HPB Meter Endin
     C                     Z-ADDYL0015    WL0056           HPB Meter Total
     C                     Z-ADDYL0016    WL0057           HPB Meter Net W
     C                     Z-ADDYL0017    WL0058           HPB Density Ref
     C                     MOVELWN0401    WL0059    P      EDI Status 1
     C                     MOVELWN0402    WL0060    P      EDI Status 2
     C                     MOVELWN0403    WL0061    P      EDI Status 3
     C                     MOVELWN0404    WL0062    P      Record Status
     C                     Z-ADDWN0405    WL0063           Job Time
     C                     MOVELWN0406    WL0064    P      User Id
     C                     MOVELWN0407    WL0065    P      Job Name
     C                     Z-ADDWN0408    WL0066           Job Date
     C                     EXSR SMCRRC
      * batch's company is in par.Company number 041405
      * Crt Manifest Dtl RIN  CR - Manifest Detail RIN Sell  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0067           Company Number
     C                     Z-ADDP2C4NB    WL0068           Order Number
     C                     Z-ADDP2DPNB    WL0069           Order Sequence
     C                     Z-ADDP2UENB    WL0070           Order Secondary
     C                     Z-ADDWN0397    WL0071           Case Sequence N
     C                     MOVEL#1L6T1    WL0072    P      COA ULSD Compan
     C                     Z-ADD#1I3NY    WL0073           COA Batch Numbe
     C                     Z-ADD#1JYNY    WL0074           COA Batch Heade
     C                     Z-ADD#1Q1NY    WL0075           COA Batch Hdr R
     C                     Z-ADDYL0003    WL0076           HPB Meter Net G
     C                     Z-ADD#1AIC3    WL0077           COA Batch Compa
     C                     MOVELYL0021    WL0078    P      MDRS Unused sts
     C                     MOVELWN0404    WL0079    P      Record Status
     C                     Z-ADD0         WL0080           Create Date
     C                     Z-ADD0         WL0081           Create Time
     C                     MOVEL*BLANK    WL0082           Create User
     C                     MOVEL*BLANK    WL0083           Create Program
     C                     EXSR SNCRRC
      * CHG Prod Temp-HPB     CH - Load Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3RMNB    WL0084           Load ID
     C                     Z-ADDYL0055    WL0085           Product Tempera
     C                     MOVELP4XCCD    WL0086    P      Carrier Broker
     C                     EXSR SOCHRC
      * RTV Crt/Chg HPB Batch RT - Order Header Extension  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0087           Company Number
     C                     Z-ADDP2C4NB    WL0088           Order Number
     C                     Z-ADDP3RMNB    WL0089           Load ID
     C                     Z-ADDYL0012    WL0090           HPB COA Batch N
     C                     EXSR SPRVGN
     C                     MOVEL'Y'       P5B8ST           Status - Y or N
      * RTV Chg for Confirm    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0094           Company Number
     C                     Z-ADDP2C4NB    WL0095           Order Number
     C                     Z-ADDP2DPNB    WL0096           Order Sequence
     C                     Z-ADDP2UENB    WL0097           Order Secondary
     C                     Z-ADDP2HGCD    WL0098           Item Code
     C                     Z-ADDYL0010    WL0099           USR Case Quanti
     C                     Z-ADDYL0011    WL0100           USR Case Weight
     C                     MOVELYL0048    WL0101    P      USR Under Min
     C                     MOVELYL0049    WL0102    P      USR Over Max
     C                     MOVELYL0050    WL0103    P      USR Exit Progra
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0099    YL0010           USR Case Quanti
     C                     Z-ADDWL0100    YL0011           USR Case Weight
     C                     MOVELWL0101    YL0048    P      USR Under Min
     C                     MOVELWL0102    YL0049    P      USR Over Max
     C                     MOVELWL0103    YL0050    P      USR Exit Progra
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      * Save sfl rrn at top of page
     C                     Z-ADD@#SFRC    Y#SFRC  40
      *
      * Initialise sfl workfields
     C                     Z-ADD11        ZHSTRW  40
     C                     Z-ADD23        ZHNDRW  40
     C                     Z-ADD1         ZHRLEN  40
     C                     Z-ADD*ZERO     ZHF4RW  40
     C                     Z-ADD*ZERO     ZHWK1#  40
      *
      * Resolve prompt row number on sfl
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C                     Z-ADDZHWK1#    YZSFDL  40
     C           ZHWK1#    MULT ZHRLEN    ZHWK1#
     C           ZHCSRW    SUB  ZHWK1#    ZHF4RW
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
      * Save first changed  rrn
     C           ZHCSRW    IFGE ZHSTRW
     C           ZHCSRW    ANDLEZHNDRW
     C           YPMTFD    ANDNE'*NONE'
      *
     C           ##RR      IFNE *ZERO
     C                     READC#SFLRCD                  92*
     C           *IN92     IFEQ '0'
     C                     Z-ADD##RR      YAFSCH
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     END
     C                     END
      *
      * Calculate rrn for prompt slf record
     C           ZHCSRW    SUB  ZHSTRW    ZHWK1#
     C           ZHWK1#    DIV  ZHRLEN    ZHWK1#
     C           ZHWK1#    ADD  Y#SFRC    YPMRRN
      *
      * Chain to sfl record
     C           YPMRRN    CHAIN#SFLRCD              9292  *
     C           *IN92     IFEQ '0'
     C                     SETON                     84    *
     C                     UPDAT#SFLRCD
     C                     ELSE
     C                     Z-ADD*ZERO     YPMRRN
     C                     END
      *
      * Test first changed rrn/prompt rrn
     C           YAFSCH    IFEQ *ZERO
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
      * If prompt rrn < first changed rrn
     C           YPMRRN    IFNE *ZERO
     C           YPMRRN    ANDLTYAFSCH
     C                     Z-ADDYPMRRN    YAFSCH
     C                     END
      *
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WAJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WAQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WAJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WAJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WAJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WARIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WAC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WARJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WAC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WARZNB           Case Sequence N
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WAC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WAQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WACWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WAQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WAQZNY           COA Reference B
     C                     Z-ADD*ZERO     WAQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WATFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WATGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WAQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WAR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WAR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WAHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WAHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WAR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WAR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WATWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WADUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WATVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WADTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WAR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WASQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WASRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WASXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WASYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WASZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Define work field COA Temp Conv Factor 1
     C                     Z-ADD*ZERO     WUJQNY 118
      * Define work field COA Temp Conv Factor 2
     C                     Z-ADD*ZERO     WUJRNY 118
      * Define work field HPB Temperature Adjustmnt
     C                     Z-ADD*ZERO     WUJSNY  96
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WBFOQT           Case Quantity
     C                     Z-ADD*ZERO     WBR0NB           Case Weight
     C                     Z-ADD*ZERO     WBK7DT           Label Date
     C                     Z-ADD*ZERO     WBPFNX           PT Serial Numbe
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBN5WG           Manifest Gross
     C                     Z-ADD*ZERO     WBH5NY           Manifest Total
     C                     Z-ADD*ZERO     WBH6NY           Manifest Co-Par
     C                     Z-ADD*ZERO     WBH7NY           Manifest Pallet
     C                     Z-ADD*ZERO     WBN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WBN7WG           Manifest Net We
     C                     Z-ADD*ZERO     WBRBDT           Manifest Unused
     C                     Z-ADD*ZERO     WBITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WBIVNY           HPB Meter Start
     C                     Z-ADD*ZERO     WBIUNY           HPB Meter Endin
     C                     Z-ADD*ZERO     WBIWNY           HPB Meter Total
     C                     Z-ADD*ZERO     WBIXNY           HPB Meter Net W
     C                     Z-ADD*ZERO     WBIYNY           HPB Density Ref
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field Manifest Shift
     C                     MOVEL*BLANK    WUGBTX  1
      * Define work field Manifest Unused Status 1A
     C                     MOVEL*BLANK    WUGCTX  1
      * Define work field Manifest Unused Status 2A
     C                     MOVEL*BLANK    WUGDTX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDRZNB           Case Sequence N
     C                     Z-ADD*ZERO     WDI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WDJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WDQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WDN6WG           HPB Meter Net G
     C                     Z-ADD*ZERO     WDRCNY           COA Batch Compa
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WERUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WEQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WEQXDT           OHE Port Cut Da
     C                     Z-ADD*ZERO     WEQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WEGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEHEVL           OHE HPB RIN Equ
     C                     Z-ADD*ZERO     WEHFVL           OHE HPB RIN Pri
     C                     Z-ADD*ZERO     WEHGVL           Transload Termi
     C                     Z-ADD*ZERO     WEQZDT           OHE Est Arrv at
     C                     Z-ADD*ZERO     WEQ0DT           OHE Backhaul ET
     C                     Z-ADD*ZERO     WEQ1DT           OHE Port/Pier P
     C                     Z-ADD*ZERO     WEQ2DT           OHE Actual Ship
     C                     Z-ADD*ZERO     WEITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WEQJNY           OHE Backhaul Re
     C                     Z-ADD*ZERO     WEQKNY           LD Stop/Drop
     C                     Z-ADD*ZERO     WEQLNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WEP8NY           OHE Pier Pass F
     C                     Z-ADD*ZERO     WEP9NY           OHE Port Check
     C                     Z-ADD*ZERO     WEQANY           OHE Port Cut Ti
     C                     Z-ADD*ZERO     WEQCNY           OHE Backhaul Tr
     C                     Z-ADD*ZERO     WEQDNY           OHE Load Sched
     C                     Z-ADD*ZERO     WEQENY           Original Appoin
     C                     Z-ADD*ZERO     WEQFNY           Original Appoin
     C                     Z-ADD*ZERO     WEQGNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WEQHNY           OHE PowerPro Lo
     C                     Z-ADD*ZERO     WEQINY           OHE Unused Nume
     C                     Z-ADD*ZERO     WEQMNY           OHE Orig ABS Fr
     C                     Z-ADD*ZERO     WEW5DT           OHE Unused Date
     C                     Z-ADD*ZERO     WEW6DT           OHE Unused Date
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Work Over/Short Status
     C                     MOVEL*BLANK    WUR0ST  1
      * Define work field Detail Line Status
     C                     MOVEL*BLANK    WUGMST  1
      * Define work field Detail Line Status Last
     C                     MOVEL*BLANK    WUGNST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WFBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WFBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WFBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WFBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGC4NB           Order Number
     C                     Z-ADD*ZERO     WGDPNB           Order Sequence
     C                     Z-ADD*ZERO     WGUENB           Order Secondary
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WGMAVA           Billing Detail
     C                     Z-ADD*ZERO     WGKDVA           Billing Detail
     C                     Z-ADD*ZERO     WGL8VA           Billing Detail
     C                     Z-ADD*ZERO     WGL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WGAYVA           Extended Amount
     C                     Z-ADD*ZERO     WGEXDT           Market Pricing
     C                     Z-ADD*ZERO     WGBZPR           Price Overage O
     C                     Z-ADD*ZERO     WGL6NB           Contract Number
     C                     Z-ADD*ZERO     WGGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WGR1NB           Rated Freight
     C                     Z-ADD*ZERO     WGAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WGD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WGCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WGAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WGCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WGATWG           Weight Shipped
     C                     Z-ADD*ZERO     WGAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAKPR           Unit Price
     C                     Z-ADD*ZERO     WGALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WGAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WGAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WGA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WGA5DT           Requested Ship
     C                     Z-ADD*ZERO     WGAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WGGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGCXDT           Date of Origina
     C                     Z-ADD*ZERO     WGDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WGB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WGA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WGNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WGNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WGNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WGNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WGNXDT           OD Firm Date
     C                     Z-ADD*ZERO     WGBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WGBXTM           Substitution Li
     C                     Z-ADD*ZERO     WGBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WGH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WGH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WGH7NX           OD Item Target
     C                     Z-ADD*ZERO     WGH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WGH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WGDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WGDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WGDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WGDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WGDZPR           OD Original Ord
     C                     Z-ADD*ZERO     WGGSPR           OD Cancel Date
     C                     Z-ADD*ZERO     WGGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WGGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WGPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WGRINY           Item Age Days
     C                     Z-ADD*ZERO     WGTIDT           Production Ovr
     C                     Z-ADD*ZERO     WGTJDT           Production Ovr
     C                     Z-ADD*ZERO     WGTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WGTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WGTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD   177       *Synon (17,7) w
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0001  41
     C                     Z-ADD*ZERO     WL0002  41
     C                     Z-ADD*ZERO     WL0003  54
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0004  30
     C                     Z-ADD*ZERO     WL0005  70
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  50
     C                     Z-ADD*ZERO     WL0009  50
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012  50
     C                     Z-ADD*ZERO     WL0013  80
     C                     Z-ADD*ZERO     WL0014  80
     C                     Z-ADD*ZERO     WL0015  80
     C                     Z-ADD*ZERO     WL0016  80
     C                     Z-ADD*ZERO     WL0017  74
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  70
     C                     Z-ADD*ZERO     WL0020  70
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0021  30
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  50
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0024  30
     C                     Z-ADD*ZERO     WL0025  70
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  50
      * Define local variables for subroutine SMCRRC.
     C                     Z-ADD*ZERO     WL0029  30
     C                     Z-ADD*ZERO     WL0030  70
     C                     Z-ADD*ZERO     WL0031  30
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  50
     C                     Z-ADD*ZERO     WL0034  50
     C                     Z-ADD*ZERO     WL0035 112
     C                     MOVEL*BLANK    WL0036  1
     C                     Z-ADD*ZERO     WL0037  70
     C                     Z-ADD*ZERO     WL0038  80
     C                     Z-ADD*ZERO     WL0039  70
     C                     MOVEL*BLANK    WL0040  3
     C                     Z-ADD*ZERO     WL0041  70
     C                     Z-ADD*ZERO     WL0042 112
     C                     MOVEL*BLANK    WL0043 10
     C                     Z-ADD*ZERO     WL0044  82
     C                     Z-ADD*ZERO     WL0045  50
     C                     Z-ADD*ZERO     WL0046  90
     C                     MOVEL*BLANK    WL0047  1
     C                     Z-ADD*ZERO     WL0048 112
     C                     Z-ADD*ZERO     WL0049 112
     C                     MOVEL*BLANK    WL0050  1
     C                     MOVEL*BLANK    WL0051  1
     C                     Z-ADD*ZERO     WL0052  70
     C                     Z-ADD*ZERO     WL0053  50
     C                     Z-ADD*ZERO     WL0054  80
     C                     Z-ADD*ZERO     WL0055  80
     C                     Z-ADD*ZERO     WL0056  80
     C                     Z-ADD*ZERO     WL0057  80
     C                     Z-ADD*ZERO     WL0058  74
     C                     MOVEL*BLANK    WL0059  1
     C                     MOVEL*BLANK    WL0060  1
     C                     MOVEL*BLANK    WL0061  1
     C                     MOVEL*BLANK    WL0062  1
     C                     Z-ADD*ZERO     WL0063  60
     C                     MOVEL*BLANK    WL0064 10
     C                     MOVEL*BLANK    WL0065 10
     C                     Z-ADD*ZERO     WL0066  70
      * Define local variables for subroutine SNCRRC.
     C                     Z-ADD*ZERO     WL0067  30
     C                     Z-ADD*ZERO     WL0068  70
     C                     Z-ADD*ZERO     WL0069  30
     C                     Z-ADD*ZERO     WL0070  30
     C                     Z-ADD*ZERO     WL0071  50
     C                     MOVEL*BLANK    WL0072  4
     C                     Z-ADD*ZERO     WL0073  50
     C                     Z-ADD*ZERO     WL0074  50
     C                     Z-ADD*ZERO     WL0075  50
     C                     Z-ADD*ZERO     WL0076 112
     C                     Z-ADD*ZERO     WL0077  70
     C                     MOVEL*BLANK    WL0078  1
     C                     MOVEL*BLANK    WL0079  1
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081  60
     C                     MOVEL*BLANK    WL0082 10
     C                     MOVEL*BLANK    WL0083 10
      * Define local variables for subroutine SOCHRC.
     C                     Z-ADD*ZERO     WL0084  70
     C                     Z-ADD*ZERO     WL0085  52
     C                     MOVEL*BLANK    WL0086  3
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0087  30
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  70
     C                     Z-ADD*ZERO     WL0090  50
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0091  70
     C                     Z-ADD*ZERO     WL0092  50
     C                     Z-ADD*ZERO     WL0093  70
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0094  30
     C                     Z-ADD*ZERO     WL0095  70
     C                     Z-ADD*ZERO     WL0096  30
     C                     Z-ADD*ZERO     WL0097  30
     C                     Z-ADD*ZERO     WL0098  70
     C                     Z-ADD*ZERO     WL0099  50
     C                     Z-ADD*ZERO     WL0100 112
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  1
     C                     MOVEL*BLANK    WL0103  1
      * Define local variables for subroutine SXCHRC.
     C                     Z-ADD*ZERO     WL0104  30
     C                     Z-ADD*ZERO     WL0105  70
     C                     Z-ADD*ZERO     WL0106  30
     C                     Z-ADD*ZERO     WL0107  30
     C                     MOVEL*BLANK    WL0108  1
     C                     MOVEL*BLANK    WL0109  1
     C                     MOVEL*BLANK    WL0110  1
     C                     MOVEL*BLANK    WL0111  1
     C                     Z-ADD*ZERO     WL0112 112
     C                     Z-ADD*ZERO     WL0113 112
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  70
     C                     MOVEL*BLANK    WL0116  1
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118  1
      * Define local work field Company Number     041405
     C                     Z-ADD*ZERO     YL0001  30
      * Define null work field COA RIN Gallons Sold
     C                     Z-ADD*ZERO     YN0001  80
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0002  1
      * Define local work field HPB Meter Net Gallon
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field RFS Volume Corr Mthd  USR
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field Gross Gallons        USR
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field RFS Loadout Temperature
     C                     Z-ADD*ZERO     YL0007  41
      * Define local work field RFS API Vol Corr Factor
     C                     Z-ADD*ZERO     YL0008  54
      * Define local work field Quantity 7.0 USR
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Case Quantity
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field Case Weight
     C                     Z-ADD*ZERO     YL0011 112
      * Define local work field HPB COA Batch Number
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field HPB Meter Start Gallon
     C                     Z-ADD*ZERO     YL0013  80
      * Define local work field HPB Meter Ending Gallon
     C                     Z-ADD*ZERO     YL0014  80
      * Define local work field HPB Meter Total Gallon
     C                     Z-ADD*ZERO     YL0015  80
      * Define local work field HPB Meter Net Weight
     C                     Z-ADD*ZERO     YL0016  80
      * Define local work field HPB Density Ref Gravity
     C                     Z-ADD*ZERO     YL0017  74
      * Define local work field USR Quantity Shipped
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field USR Weight Billed
     C                     Z-ADD*ZERO     YL0019  92
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field MDRS Unused sts
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YL0022  50
      * Define local work field OHE Carrier SCAC Code
     C                     MOVEL*BLANK    YL0023  4
      * Define local work field OHE Spot Buy
     C                     MOVEL*BLANK    YL0024  4
      * Define local work field OHE PO ACK Flag
     C                     MOVEL*BLANK    YL0025  4
      * Define local work field OHE Override Type Code
     C                     MOVEL*BLANK    YL0026  2
      * Define local work field OHE Backhaul Status
     C                     MOVEL*BLANK    YL0027  2
      * Define local work field OHE Backhaul ETA AM/PM
     C                     MOVEL*BLANK    YL0028  2
      * Define local work field OHE Load Haul Type
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field OHE Backhaul Carrier Code
     C                     MOVEL*BLANK    YL0030  3
      * Define local work field OHE Bookings Confirmed
     C                     MOVEL*BLANK    YL0031  3
      * Define local work field OHE EDI Error Reasons
     C                     MOVEL*BLANK    YL0032  5
      * Define local work field OHE EDI Error Reasons 2
     C                     MOVEL*BLANK    YL0033  5
      * Define local work field OHE EDI 943 Action
     C                     MOVEL*BLANK    YL0034  6
      * Define local work field OHE EDI 944 Action
     C                     MOVEL*BLANK    YL0035  6
      * Define local work field OHE EDI 940 Action
     C                     MOVEL*BLANK    YL0036  6
      * Define local work field OHE EDI 945 Action
     C                     MOVEL*BLANK    YL0037  6
      * Define local work field OHE EDI 856 Action
     C                     MOVEL*BLANK    YL0038  1
      * Define local work field OHE EDI 824 Action
     C                     MOVEL*BLANK    YL0039  1
      * Define local work field OHE Email BOL/Sent
     C                     MOVEL*BLANK    YL0040  1
      * Define local work field OHE Unused Status 2
     C                     MOVEL*BLANK    YL0041  1
      * Define local work field OHE Unused Status 3
     C                     MOVEL*BLANK    YL0042  2
      * Define local work field OHE Unused Status 4
     C                     MOVEL*BLANK    YL0043  2
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0044  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0046  1
      * Define local work field Load ID
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field USR Under Min
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field USR Over Max
     C                     MOVEL*BLANK    YL0049  1
      * Define local work field USR Exit Program
     C                     MOVEL*BLANK    YL0050  1
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0051  3
      * Define local work field Warehouse Location
     C                     MOVEL*BLANK    YL0052  1
      * Define local work field WHS Req Meter Reading Shp
     C                     MOVEL*BLANK    YL0053  1
      * Define local work field Numeric Value 1 USR
     C                     Z-ADD*ZERO     YL0054 155
      * Define local work field COA Temperature Loadout
     C                     Z-ADD*ZERO     YL0055  30
      * Define local work field COA RIN Volume New usr
     C                     Z-ADD*ZERO     YL0056  80
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0057  2
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     Z-ADD13        ##SFPG  30       SFLPAG
     C                     Z-ADD1         ##SFRC
      * Maximum record number
     C                     Z-ADD*ZERO     ##RRMX
      * Scan limit
     C                     Z-ADD000000500 W0SLM   90
      * Subfile pages
     C                     Z-ADD1         W0SPG   30
      * Processed Subfile record
     C                     Z-ADD0         W0RR0   40
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SYRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL'A'       YL0005           RFS Volume Corr
      * Initialise subfile control
     C                     EXSR MEIZ#2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 USR0752
