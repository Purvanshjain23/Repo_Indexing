// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKTDXFR
// ?Date: 14.08.2025 Time: 02:50:26
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?MODIFICATIONS
//?11/02/2020 ISE H16853 - CHANGE BUY ORDER NUMBER FIELD LENGTH FROM 5 TO 7
EXECUTE FUNCTION(HPE085) TYPE(EXCINTFUN)                                        AB1189549;
{
 //?Execute internal function

 //?Hog Pop by farm site
}


EXECUTE FUNCTION(Cpy to Curr Kill Date RT) TYPE(RTVOBJ) FILE(PKC0CPP)           AB1147060;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.TH_Voucher_Payment_Date);
{
 //?USER: Initialize routine

 // WRK.First Time Flag Usr = CND.Yes
 WRK.First_Time_Flag_Usr = 'Y';

 //?USER: Process Data record

 CASE;

 // IF WRK.First Time Flag Usr is Yes
 IF WRK.First_Time_Flag_Usr = 'Y';

 // WRK.PY As of Kill Date = DB1.PY As of Kill Date
 WRK.PY_As_of_Kill_Date = DB1.PY_As_of_Kill_Date;

 // WRK.First Time Flag Usr = CND.No
 WRK.First_Time_Flag_Usr = 'N';

 ENDIF;

 //?Quit if Par and Wrk are same.
 CASE;

 // IF WRK.PY As of Kill Date EQ PAR.PY As of Kill Date
 IF WRK.PY_As_of_Kill_Date = PAR.PY_As_of_Kill_Date;

 QUIT;

 ENDIF;

 //?Quit if the date changes.
 CASE;

 // IF DB1.PY As of Kill Date NE WRK.PY As of Kill Date
 IF DB1.PY_As_of_Kill_Date <> WRK.PY_As_of_Kill_Date;

 QUIT;

 ENDIF;

 EXECUTE FUNCTION(Crt CrcSum Prd Ln Dst CR) TYPE(CRTOBJ) FILE(PKC0CPP)           AB1146610;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(PAR.PY_As_of_Kill_Date);
 PARAMETER(DB1.PLDY_Lean);
 PARAMETER(DB1.PLDY_Head_Killed);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


EXECUTE FUNCTION(Cpy to Curr Kill Date RT) TYPE(RTVOBJ) FILE(PKCZCPP)           AB1147063;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.TH_Voucher_Payment_Date);
{
 //?USER: Initialize routine

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.First_Time_Flag_Usr = 'Y';

 //?USER: Process Data record

 CASE;

 // IF WRK.First Time Flag Usr is Yes
 IF WRK.First_Time_Flag_Usr = 'Y';

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PY_As_of_Kill_Date = DB1.PY_As_of_Kill_Date;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.First_Time_Flag_Usr = 'N';

 ENDIF;

 //?Quit if WRK = PAR
 CASE;

 // IF WRK.PY As of Kill Date EQ PAR.PY As of Kill Date
 IF WRK.PY_As_of_Kill_Date = PAR.PY_As_of_Kill_Date;

 QUIT;

 ENDIF;

 //?Quit if date changes
 CASE;

 // IF WRK.PY As of Kill Date NE DB1.PY As of Kill Date
 IF WRK.PY_As_of_Kill_Date <> DB1.PY_As_of_Kill_Date;

 QUIT;

 ENDIF;

 EXECUTE FUNCTION(Crt Crc Sum Prd YTD   CR) TYPE(CRTOBJ) FILE(PKCZCPP)           AB1146607;
 PARAMETER(DB1.CC_Company_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(PAR.PY_As_of_Kill_Date);
 PARAMETER(DB1.PY_Head_Received);
 PARAMETER(DB1.PY_Head_Killed);
 PARAMETER(DB1.PY_Live_Wgt);
 PARAMETER(DB1.PY_Hot_Wgt);
 PARAMETER(DB1.PY_Lean_Prem_Ded_Amt);
 PARAMETER(DB1.PY_Sort_Discount_Amt);
 PARAMETER(DB1.PY_Avg_Live_Wgt);
 PARAMETER(DB1.PY_Actual_Yield);
 PARAMETER(DB1.PY_Avg_Lean);
 PARAMETER(DB1.PY_Lean_Prem_Ded_Lv_CWT);
 PARAMETER(DB1.PY_Sort_Discount_Lv_CWT);
 PARAMETER(DB1.PY_Adj_Live_Weight);
 PARAMETER(DB1.PY_Adj_Avg_Live_Weight);
 PARAMETER(DB1.PY_Adj_Actual_Yield);
 PARAMETER(DB1.RS_User_Changed);
 PARAMETER(DB1.RS_Date_Changed);
 PARAMETER(DB1.RS_Time_Changed);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


EXECUTE FUNCTION(Upd Tto/Prd Lean Dist RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1148588;
PARAMETER(PAR.BOH_Company_Number);
PARAMETER(PAR.TH_Voucher_Payment_Date);
{
 //?USER: Initialize routine

 EXECUTE FUNCTION(HPE085) TYPE(EXCINTFUN)                                        AB1189549;
 {
  //?Execute internal function

  //?Hog Pop by farm site
 }

 //? -- RTV farm site to send to PF and RTV to output to HogPopDist
 //?E2423 Mtech Live or Not Live *** Interfaces to HPS ***
 //?Get the MTech Live Yes or No
 DO;

 //?Mtech Live Yes or no
 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER('MTECHLIVE');
 PARAMETER(WRK.System_Value_Alpha_USR);

 // LCL.MTech Live Yes or No = WRK.System Value Alpha    USR
 LCL.MTech_Live_Yes_or_No = WRK.System_Value_Alpha_USR;

 ENDDO;

 //?USER: Process Data record

 // WRK.Farm Site USR = CON.*ZERO
 WRK.Farm_Site_USR = *ZERO;

 //?For internal , get farm site from HPS
 CASE;

 // IF DB1.TH Source Type is Internal
 IF DB1.TH_Source_Type = 'I';

 CASE;

 // IF WRK.MTech Live Yes or No is No MTech not Live
 IF WRK.MTech_Live_Yes_or_No = 'N';

 //?* 01/27/03 PKD PK0495 Replaced HP255 with HP249.
 // Call program Z1v HPS Farm Info     UP.
 CALL PROGRAM(Z1v HPS Farm Info     UP) ('HP249');
 PARAMETER(PGM.*Return_code);
 PARAMETER(DB1.TH_HPS_Movement_Ref_#);
 PARAMETER(WRK.Farm_site_Name_f_HPS_USR);
 PARAMETER(WRK.Farm_Site_USR);
 PARAMETER(WRK.HPS_FS_Comp_Relation_USR);
 PARAMETER(WRK.State);

 // IF WRK.MTech Live Yes or No is Yes MTech is Live
 IF WRK.MTech_Live_Yes_or_No = 'Y';

 // WRK.Farm Site USR = DB1.TH HPS Farm Site
 WRK.Farm_Site_USR = DB1.TH_HPS_Farm_Site;

 ENDIF;

 ENDIF;

 CASE;

 // IF DB1.TH Payment Type is Carcass Merit
 IF DB1.TH_Payment_Type = 'C';

 // Call program Upd Cr/Tto/Prd Ln Dist PF.
 CALL PROGRAM(Upd Cr/Tto/Prd Ln Dist PF) ('PKSKPFR');
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.BOH_Buy_Order_Number);
 PARAMETER(DB1.BOL_Load_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(DB1.TH_Source_Type);
 PARAMETER(DB1.TH_Payment_Type);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.TH_Source_Code);
 PARAMETER(PAR.TH_Voucher_Payment_Date);
 PARAMETER(WRK.Farm_Site_USR);
 PARAMETER(DB1.PL_Location_Code);

 // Execute command - 'Del Spool File'
 EXECUTE COMMAND(PRK0450);
 PARAMETER('PKSKPFR$');

 ENDIF;

}


EXECUTE FUNCTION(Upd Tto/Prd Ln Dst Lv RT) TYPE(RTVOBJ) FILE(PKA1CPP)           AB1216546;
PARAMETER(PAR.TH_Voucher_Payment_Date);
PARAMETER(PAR.BOH_Company_Number);
{
 //?USER: Initialize routine

 //?E2423 Mtech Live or Not Live *** Interfaces to HPS ***
 //?Get the MTech Live Yes or No
 DO;

 //?Mtech Live Yes or no
 // Call program Rtv Company Values    XF.
 CALL PROGRAM(Rtv Company Values    XF) ('PDGKXFR');
 PARAMETER(PAR.BOH_Company_Number);
 PARAMETER('MTECHLIVE');
 PARAMETER(WRK.System_Value_Alpha_USR);

 // LCL.MTech Live Yes or No = WRK.System Value Alpha    USR
 LCL.MTech_Live_Yes_or_No = WRK.System_Value_Alpha_USR;

 ENDDO;

 //?USER: Process Data record

 // WRK.Farm Site USR = CON.*ZERO
 WRK.Farm_Site_USR = *ZERO;

 //?For internal , get farm site from HPS
 CASE;

 // IF DB1.TH Source Type is Internal
 IF DB1.TH_Source_Type = 'I';

 CASE;

 // IF WRK.MTech Live Yes or No is No MTech not Live
 IF WRK.MTech_Live_Yes_or_No = 'N';

 //?* 01/27/03 PKD PK0495 Replaced HP255 with HP249.
 // Call program Z1v HPS Farm Info     UP.
 CALL PROGRAM(Z1v HPS Farm Info     UP) ('HP249');
 PARAMETER(PGM.*Return_code);
 PARAMETER(DB1.TH_HPS_Movement_Ref_#);
 PARAMETER(WRK.Farm_site_Name_f_HPS_USR);
 PARAMETER(WRK.Farm_Site_USR);
 PARAMETER(WRK.HPS_FS_Comp_Relation_USR);
 PARAMETER(WRK.State);

 // IF WRK.MTech Live Yes or No is Yes MTech is Live
 IF WRK.MTech_Live_Yes_or_No = 'Y';

 // WRK.Farm Site USR = DB1.TH HPS Farm Site
 WRK.Farm_Site_USR = DB1.TH_HPS_Farm_Site;

 ENDIF;

 ENDIF;

 CASE;

 // IF DB1.TH Hog Class Type is Not Resale
 IF DB1.TH_Hog_Class_Type = 'M'/'S';

 EXECUTE FUNCTION(Upd Cr Pay Info       RT) TYPE(RTVOBJ) FILE(PKB1CPP)           AB1152949;
 PARAMETER(DB1.BOH_Company_Number);
 PARAMETER(DB1.TH_Tattoo_Number);
 PARAMETER(DB1.TH_Kill_Date);
 PARAMETER(DB1.TH_Source_Type);
 PARAMETER(DB1.TH_Payment_Type);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.TH_Source_Code);
 PARAMETER(WRK.Farm_Site_USR);
 PARAMETER(DB1.PL_Location_Code);
 {
  //?USER: Process Data record

  DO;

  EXECUTE FUNCTION(Chg Carc Dtl Paymnt   CH) TYPE(CHGOBJ) FILE(PKB1CPP)           AB1152898;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.BOH_Buy_Order_Number);
  PARAMETER(DB1.BOL_Load_Number);
  PARAMETER(DB1.TH_Tattoo_Number);
  PARAMETER(DB1.TH_Kill_Date);
  PARAMETER(DB1.CD_Scale_Sequence_Number);
  PARAMETER(DB1.CD_Carcass_Number);
  PARAMETER(DB1.CD_Carcass_Number_Insert);
  PARAMETER(PAR.CD_Source_Type);
  PARAMETER(PAR.CD_Payment_Type);
  PARAMETER(DB1.CD_CA_Sort_Loss);
  PARAMETER(DB1.CD_CA_Std_Yield);
  PARAMETER(DB1.CD_CA_Base_Carcass_CWT);
  PARAMETER(DB1.CD_CA_Crc_Value_Per_CWT);
  PARAMETER(DB1.CD_CA_Base_Carc_Value);
  PARAMETER(DB1.CD_CA_Crc_Value_$_Per_Hd);
  PARAMETER(DB1.CD_CA_Lean_Premium_CWT);
  PARAMETER(DB1.CD_CA_Lean_Premium_$_P_Hd);
  PARAMETER(DB1.CD_CA_Gross_Value_Per_CWT);
  PARAMETER(DB1.CD_CA_Gross_Value_$_P_Hd);
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.SR_Source_Code);
  {
   //?USER: Processing after Data read

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

  CASE;

  // IF DB1.CD Record Add/Del Sts is Delete
  IF DB1.CD_Record_Add_Del_Sts = 'D';

  // IF DB1.RS Record Status is Flag for Purge
  IF DB1.RS_Record_Status = 'D';

  // IF DB1.RS Record Status is InActive
  IF DB1.RS_Record_Status = 'I';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.HPD Carcass Weight = DB1.CD Carcass/Hot Weight * CON.1 *Rounded
  WRK.HPD_Carcass_Weight = DB1.CD_Carcass_Hot_Weight * 1 'H';

  //?Back fat record
  EXECUTE FUNCTION(Upd Hog Pop Dist      RT) TYPE(RTVOBJ) FILE(PKC8CPP)           AB1152916;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.TH_Kill_Date);
  PARAMETER(PAR.SR_Source_Code);
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.PL_Location_Code);
  PARAMETER(PAR.CD_Source_Type);
  PARAMETER(PAR.CD_Payment_Type);
  PARAMETER(WRK.HPD_Carcass_Weight);
  PARAMETER(DB1.CD_Backfat_Thickness_Inch);
  PARAMETER('B');
  PARAMETER(PAR.Farm_Site_USR);
  PARAMETER(DB1.CD_Shift);
  {
   //?USER: Processing if Data record not found

   // WRK.HPD No of Carcass = CON.1
   WRK.HPD_No_of_Carcass = 1;

   EXECUTE FUNCTION(Crt Hog Ppltn Dist    CR) TYPE(CRTOBJ) FILE(PKC8CPP)           AB1152910;
   PARAMETER(PAR.HPD_Company_Number);
   PARAMETER(PAR.HPD_Kill_Date);
   PARAMETER(PAR.HPD_Source_Code);
   PARAMETER(PAR.HPD_Producer_Code);
   PARAMETER(PAR.HPD_Pdcr_Location_Code);
   PARAMETER(PAR.HPD_Source_Type);
   PARAMETER(PAR.HPD_Payment_Type);
   PARAMETER(PAR.HPD_Carcass_Weight);
   PARAMETER(PAR.HPD_Distribution);
   PARAMETER(PAR.HPD_Type_of_Record);
   PARAMETER(PAR.HPD_Farm_Site);
   PARAMETER(PAR.HPD_Kill_Shift);
   PARAMETER(WRK.HPD_No_of_Carcass);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER('A');
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
    PARAMETER(DB1.RS_Record_Status);
    PARAMETER(DB1.RS_Job);
    PARAMETER(DB1.RS_Program);
    PARAMETER(DB1.RS_User_Added);
    PARAMETER(DB1.RS_Date_Added);
    PARAMETER(DB1.RS_Time_Added);
    {
     //?Execute internal function

     // PAR.RS Record Status = CND.Active
     PAR.RS_Record_Status = 'A';

     // PAR.RS User Added = JOB.*USER
     PAR.RS_User_Added = JOB.*USER;

     // PAR.RS Date Added = JOB.*Job date
     PAR.RS_Date_Added = JOB.*Job_date;

     // PAR.RS Time Added = JOB.*Job time
     PAR.RS_Time_Added = JOB.*Job_time;

     // PAR.RS Program = JOB.*PROGRAM
     PAR.RS_Program = JOB.*PROGRAM;

     // PAR.RS Job = JOB.*JOB
     PAR.RS_Job = JOB.*JOB;

    }

   }

   //?USER: Process Data record

   // WRK.HPD No of Carcass = DB1.HPD No of Carcass + CON.1
   WRK.HPD_No_of_Carcass = DB1.HPD_No_of_Carcass + 1;

   EXECUTE FUNCTION(Chg Hog Ppltn Dist    CH) TYPE(CHGOBJ) FILE(PKC8CPP)           AB1152911;
   PARAMETER(DB1.HPD_Company_Number);
   PARAMETER(DB1.HPD_Kill_Date);
   PARAMETER(DB1.HPD_Source_Code);
   PARAMETER(DB1.HPD_Producer_Code);
   PARAMETER(DB1.HPD_Pdcr_Location_Code);
   PARAMETER(DB1.HPD_Source_Type);
   PARAMETER(DB1.HPD_Payment_Type);
   PARAMETER(DB1.HPD_Carcass_Weight);
   PARAMETER(DB1.HPD_Distribution);
   PARAMETER(DB1.HPD_Type_of_Record);
   PARAMETER(DB1.HPD_Farm_Site);
   PARAMETER(DB1.HPD_Kill_Shift);
   PARAMETER(WRK.HPD_No_of_Carcass);
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
    PARAMETER(DB1.RS_User_Changed);
    PARAMETER(DB1.RS_Date_Changed);
    PARAMETER(DB1.RS_Time_Changed);
    PARAMETER(DB1.RS_Job);
    PARAMETER(DB1.RS_Program);
    {
     //?Execute internal function

     // PAR.RS User Changed = JOB.*USER
     PAR.RS_User_Changed = JOB.*USER;

     // PAR.RS Date Changed = JOB.*Job date
     PAR.RS_Date_Changed = JOB.*Job_date;

     // PAR.RS Time Changed = JOB.*Job time
     PAR.RS_Time_Changed = JOB.*Job_time;

     // PAR.RS Job = JOB.*JOB
     PAR.RS_Job = JOB.*JOB;

     // PAR.RS Program = JOB.*PROGRAM
     PAR.RS_Program = JOB.*PROGRAM;

    }

   }

  }

  //?Loin Eye
  EXECUTE FUNCTION(Upd Hog Pop Dist      RT) TYPE(RTVOBJ) FILE(PKC8CPP)           AB1152916;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.TH_Kill_Date);
  PARAMETER(PAR.SR_Source_Code);
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.PL_Location_Code);
  PARAMETER(PAR.CD_Source_Type);
  PARAMETER(PAR.CD_Payment_Type);
  PARAMETER(WRK.HPD_Carcass_Weight);
  PARAMETER(DB1.CD_Loin_Eye_Depth_Inch);
  PARAMETER('E');
  PARAMETER(PAR.Farm_Site_USR);
  PARAMETER(DB1.CD_Shift);
  {
   //?USER: Processing if Data record not found

   // WRK.HPD No of Carcass = CON.1
   WRK.HPD_No_of_Carcass = 1;

   EXECUTE FUNCTION(Crt Hog Ppltn Dist    CR) TYPE(CRTOBJ) FILE(PKC8CPP)           AB1152910;
   PARAMETER(PAR.HPD_Company_Number);
   PARAMETER(PAR.HPD_Kill_Date);
   PARAMETER(PAR.HPD_Source_Code);
   PARAMETER(PAR.HPD_Producer_Code);
   PARAMETER(PAR.HPD_Pdcr_Location_Code);
   PARAMETER(PAR.HPD_Source_Type);
   PARAMETER(PAR.HPD_Payment_Type);
   PARAMETER(PAR.HPD_Carcass_Weight);
   PARAMETER(PAR.HPD_Distribution);
   PARAMETER(PAR.HPD_Type_of_Record);
   PARAMETER(PAR.HPD_Farm_Site);
   PARAMETER(PAR.HPD_Kill_Shift);
   PARAMETER(WRK.HPD_No_of_Carcass);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER('A');
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
    PARAMETER(DB1.RS_Record_Status);
    PARAMETER(DB1.RS_Job);
    PARAMETER(DB1.RS_Program);
    PARAMETER(DB1.RS_User_Added);
    PARAMETER(DB1.RS_Date_Added);
    PARAMETER(DB1.RS_Time_Added);
    {
     //?Execute internal function

     // PAR.RS Record Status = CND.Active
     PAR.RS_Record_Status = 'A';

     // PAR.RS User Added = JOB.*USER
     PAR.RS_User_Added = JOB.*USER;

     // PAR.RS Date Added = JOB.*Job date
     PAR.RS_Date_Added = JOB.*Job_date;

     // PAR.RS Time Added = JOB.*Job time
     PAR.RS_Time_Added = JOB.*Job_time;

     // PAR.RS Program = JOB.*PROGRAM
     PAR.RS_Program = JOB.*PROGRAM;

     // PAR.RS Job = JOB.*JOB
     PAR.RS_Job = JOB.*JOB;

    }

   }

   //?USER: Process Data record

   // WRK.HPD No of Carcass = DB1.HPD No of Carcass + CON.1
   WRK.HPD_No_of_Carcass = DB1.HPD_No_of_Carcass + 1;

   EXECUTE FUNCTION(Chg Hog Ppltn Dist    CH) TYPE(CHGOBJ) FILE(PKC8CPP)           AB1152911;
   PARAMETER(DB1.HPD_Company_Number);
   PARAMETER(DB1.HPD_Kill_Date);
   PARAMETER(DB1.HPD_Source_Code);
   PARAMETER(DB1.HPD_Producer_Code);
   PARAMETER(DB1.HPD_Pdcr_Location_Code);
   PARAMETER(DB1.HPD_Source_Type);
   PARAMETER(DB1.HPD_Payment_Type);
   PARAMETER(DB1.HPD_Carcass_Weight);
   PARAMETER(DB1.HPD_Distribution);
   PARAMETER(DB1.HPD_Type_of_Record);
   PARAMETER(DB1.HPD_Farm_Site);
   PARAMETER(DB1.HPD_Kill_Shift);
   PARAMETER(WRK.HPD_No_of_Carcass);
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
    PARAMETER(DB1.RS_User_Changed);
    PARAMETER(DB1.RS_Date_Changed);
    PARAMETER(DB1.RS_Time_Changed);
    PARAMETER(DB1.RS_Job);
    PARAMETER(DB1.RS_Program);
    {
     //?Execute internal function

     // PAR.RS User Changed = JOB.*USER
     PAR.RS_User_Changed = JOB.*USER;

     // PAR.RS Date Changed = JOB.*Job date
     PAR.RS_Date_Changed = JOB.*Job_date;

     // PAR.RS Time Changed = JOB.*Job time
     PAR.RS_Time_Changed = JOB.*Job_time;

     // PAR.RS Job = JOB.*JOB
     PAR.RS_Job = JOB.*JOB;

     // PAR.RS Program = JOB.*PROGRAM
     PAR.RS_Program = JOB.*PROGRAM;

    }

   }

  }

  //?Lean %
  EXECUTE FUNCTION(Upd Hog Pop Dist      RT) TYPE(RTVOBJ) FILE(PKC8CPP)           AB1152916;
  PARAMETER(DB1.BOH_Company_Number);
  PARAMETER(DB1.TH_Kill_Date);
  PARAMETER(PAR.SR_Source_Code);
  PARAMETER(PAR.PD_Producer_Code);
  PARAMETER(PAR.PL_Location_Code);
  PARAMETER(PAR.CD_Source_Type);
  PARAMETER(PAR.CD_Payment_Type);
  PARAMETER(WRK.HPD_Carcass_Weight);
  PARAMETER(DB1.CD_Lean_Percent);
  PARAMETER('P');
  PARAMETER(PAR.Farm_Site_USR);
  PARAMETER(DB1.CD_Shift);
  {
   //?USER: Processing if Data record not found

   // WRK.HPD No of Carcass = CON.1
   WRK.HPD_No_of_Carcass = 1;

   EXECUTE FUNCTION(Crt Hog Ppltn Dist    CR) TYPE(CRTOBJ) FILE(PKC8CPP)           AB1152910;
   PARAMETER(PAR.HPD_Company_Number);
   PARAMETER(PAR.HPD_Kill_Date);
   PARAMETER(PAR.HPD_Source_Code);
   PARAMETER(PAR.HPD_Producer_Code);
   PARAMETER(PAR.HPD_Pdcr_Location_Code);
   PARAMETER(PAR.HPD_Source_Type);
   PARAMETER(PAR.HPD_Payment_Type);
   PARAMETER(PAR.HPD_Carcass_Weight);
   PARAMETER(PAR.HPD_Distribution);
   PARAMETER(PAR.HPD_Type_of_Record);
   PARAMETER(PAR.HPD_Farm_Site);
   PARAMETER(PAR.HPD_Kill_Shift);
   PARAMETER(WRK.HPD_No_of_Carcass);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   PARAMETER('A');
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*BLANK);
   PARAMETER(*ZERO);
   PARAMETER(*ZERO);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
    PARAMETER(DB1.RS_Record_Status);
    PARAMETER(DB1.RS_Job);
    PARAMETER(DB1.RS_Program);
    PARAMETER(DB1.RS_User_Added);
    PARAMETER(DB1.RS_Date_Added);
    PARAMETER(DB1.RS_Time_Added);
    {
     //?Execute internal function

     // PAR.RS Record Status = CND.Active
     PAR.RS_Record_Status = 'A';

     // PAR.RS User Added = JOB.*USER
     PAR.RS_User_Added = JOB.*USER;

     // PAR.RS Date Added = JOB.*Job date
     PAR.RS_Date_Added = JOB.*Job_date;

     // PAR.RS Time Added = JOB.*Job time
     PAR.RS_Time_Added = JOB.*Job_time;

     // PAR.RS Program = JOB.*PROGRAM
     PAR.RS_Program = JOB.*PROGRAM;

     // PAR.RS Job = JOB.*JOB
     PAR.RS_Job = JOB.*JOB;

    }

   }

   //?USER: Process Data record

   // WRK.HPD No of Carcass = DB1.HPD No of Carcass + CON.1
   WRK.HPD_No_of_Carcass = DB1.HPD_No_of_Carcass + 1;

   EXECUTE FUNCTION(Chg Hog Ppltn Dist    CH) TYPE(CHGOBJ) FILE(PKC8CPP)           AB1152911;
   PARAMETER(DB1.HPD_Company_Number);
   PARAMETER(DB1.HPD_Kill_Date);
   PARAMETER(DB1.HPD_Source_Code);
   PARAMETER(DB1.HPD_Producer_Code);
   PARAMETER(DB1.HPD_Pdcr_Location_Code);
   PARAMETER(DB1.HPD_Source_Type);
   PARAMETER(DB1.HPD_Payment_Type);
   PARAMETER(DB1.HPD_Carcass_Weight);
   PARAMETER(DB1.HPD_Distribution);
   PARAMETER(DB1.HPD_Type_of_Record);
   PARAMETER(DB1.HPD_Farm_Site);
   PARAMETER(DB1.HPD_Kill_Shift);
   PARAMETER(WRK.HPD_No_of_Carcass);
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Record_Status);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   PARAMETER(DB1.RS_User_Added);
   PARAMETER(DB1.RS_Date_Added);
   PARAMETER(DB1.RS_Time_Added);
   {
    //?USER: Processing before Data update

    EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
    PARAMETER(DB1.RS_User_Changed);
    PARAMETER(DB1.RS_Date_Changed);
    PARAMETER(DB1.RS_Time_Changed);
    PARAMETER(DB1.RS_Job);
    PARAMETER(DB1.RS_Program);
    {
     //?Execute internal function

     // PAR.RS User Changed = JOB.*USER
     PAR.RS_User_Changed = JOB.*USER;

     // PAR.RS Date Changed = JOB.*Job date
     PAR.RS_Date_Changed = JOB.*Job_date;

     // PAR.RS Time Changed = JOB.*Job time
     PAR.RS_Time_Changed = JOB.*Job_time;

     // PAR.RS Job = JOB.*JOB
     PAR.RS_Job = JOB.*JOB;

     // PAR.RS Program = JOB.*PROGRAM
     PAR.RS_Program = JOB.*PROGRAM;

    }

   }

  }

  ENDIF;

  ENDDO;

 }

 ENDIF;

}


