/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  BUILD THE WF A/R ORDERS BY NAME & PRINT REPORT      */
/*                                                                  */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                             */
/*  PROGRAM   - BUILD THE WF A/R ORDERS BY NAME & PRINT REPORT      */
/*  DATE      - 09/16/2009                                          */
/*                                                                  */
/*  PARAMETERS:                                                     */
/*                                                                  */
/*  &RETURN     - RETURN CODE                                       */
/*  &OUTQ       - OUTPUT QUEUE                                      */
/*  &COPIES     - NUMBER OF COPIES                                  */
/*  &NIGHTQ     - NIGHT QUEUE                                       */
/*  &HOLD       - HOLD PRINT FLAG                                   */
/*  &SAVE       - SAVE PRINT FLAG                                   */
/*  &APPLIC     - APPLICATION CODE                                  */
/*  &COMPNYN    - COMPANY NUMBER (PASSED)                           */
/*  &FRMDATN    - FROM DATE      (PASSED)                           */
/*  &THRDATN    - THRU DATE      (PASSED)                           */
/*  &CUSTNAME   - CUSTOMER NAME                                     */
/*  &CUSTNBR    - CUSTOMER NUMBER                                   */
/*  &ADJTYP1    - ADJUSTMENT TYPE 1                                 */
/*  &ADJTYP2    - ADJUSTMENT TYPE 2                                 */
/*  &ADJTYP3    - ADJUSTMENT TYPE 3                                 */
/*  &ADJTYP4    - ADJUSTMENT TYPE 4                                 */
/*  &ADJTYP5    - ADJUSTMENT TYPE 5                                 */
/*  &ADJTYP6    - ADJUSTMENT TYPE 6                                 */
/*  &ADJTYP7    - ADJUSTMENT TYPE 7                                 */
/*  &ADJTYP8    - ADJUSTMENT TYPE 8                                 */
/*  &ADJTYP9    - ADJUSTMENT TYPE 9                                 */
/*  &ADJTYP10   - ADJUSTMENT TYPE 10                                */
/*  &COMP1      - COMPANY NUMBER 1                                  */
/*  &COMP2      - COMPANY NUMBER 2                                  */
/*  &COMP3      - COMPANY NUMBER 3                                  */
/*  &INVSFX1    - INVOICE SUFFIX 1                                  */
/*  &INVSFX2    - INVOICE SUFFIX 2                                  */
/*  &INVSFX3    - INVOICE SUFFIX 3                                  */
/*  &INVSFX4    - INVOICE SUFFIX 4                                  */
/*  &INVSFX5    - INVOICE SUFFIX 5                                  */
/*  &INVSFX6    - INVOICE SUFFIX 6                                  */
/*  &RPTFMT     - REPORT FORMAT  (E OR P)                           */
/*  &EMAILADDR  - EMAIL ADDRESS                                     */
/********************************************************************/
/**             M O D I F I C A T I O N S                          **/
/********************************************************************/
/** 12/21/2022 E.L. 103904   ADD ONE CUST FUNCTIONALITY            **/
/** 03/30/2017 LJB  E009707   ADD INVOICE SUFFIX, REPORT FORMAT    **/
/**            EMAIL ADDRESS. PASS BLANKS FOR CUSTOMER NAME. ADD   **/
/**            ADDITIONAL COMPANY NUMBERS.                         **/
/** 06/22/2016 JBB  E5262 - CHARGE BACKS AND REBILLS MODIFICATIONS **/
/**            CHANGE SUBMITTED JOBNAME FROM ARWOREPORT TO         **/
/**            ARATREPORT.                                         **/
/********************************************************************/
 PNLQUPC:    PGM        PARM(&RETURN &DESC &OUTQ &HOLD &SAVE +
                          &COMPNYN &CUSTNBR &FRMDATN &THRDATN &COPIES +
                          &RPTTYPE &CUSTNAME &ADJTYP1 &ADJTYP2 +
                          &ADJTYP3 &ADJTYP4 &ADJTYP5 &ADJTYP6 +
                          &ADJTYP7 &ADJTYP8 &ADJTYP9 &ADJTYP10 +
                                 &COMP2 &COMP3 &INVSFX1 &INVSFX2 +
                          &INVSFX3 &INVSFX4 &INVSFX5 &INVSFX6 +
                          &RPTFMT &EMAILADDR)
/* PARMS                                                             */
             DCL        VAR(&RETURN) TYPE(*CHAR) LEN(7)
             DCL        VAR(&APPLIC) TYPE(*CHAR) LEN(6)
             DCL        VAR(&COMPNYN) TYPE(*DEC)
             DCL        VAR(&CUSTNBR) TYPE(*DEC)
             DCL        VAR(&FRMDATN) TYPE(*DEC)
             DCL        VAR(&THRDATN) TYPE(*DEC)
             DCL        VAR(&CUSTNAME) TYPE(*CHAR) LEN(30)
             DCL        VAR(&ADJTYP1) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP2) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP3) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP4) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP5) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP6) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP7) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP8) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP9) TYPE(*CHAR) LEN(3)
             DCL        VAR(&ADJTYP10) TYPE(*CHAR) LEN(3)
             DCL        VAR(&COMP1)   TYPE(*DEC)       /* NOT PASSED */
             DCL        VAR(&COMP2)   TYPE(*DEC)
             DCL        VAR(&COMP3)   TYPE(*DEC)
             DCL        VAR(&INVSFX1) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX2) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX3) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX4) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX5) TYPE(*CHAR) LEN(2)
             DCL        VAR(&INVSFX6) TYPE(*CHAR) LEN(2)
             DCL        VAR(&RPTTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&RPTFMT)  TYPE(*CHAR) LEN(1)
             DCL        VAR(&EMAILADDR) TYPE(*CHAR) LEN(50)
             DCL        VAR(&DESC) TYPE(*CHAR) LEN(30)
             DCL        VAR(&OUTQ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&HOLD) TYPE(*CHAR) LEN(4)
             DCL        VAR(&SAVE) TYPE(*CHAR) LEN(4)
             DCL        VAR(&COPIES) TYPE(*DEC)
             DCL  VAR(&NQSTAT)   TYPE(*CHAR) LEN(1)
             DCL  VAR(&NIGHTQ)   TYPE(*CHAR) LEN(10)
             DCL  VAR(&APPLIC)   TYPE(*CHAR) LEN(6) VALUE('ARS')
             DCL        VAR(&MSG) TYPE(*CHAR) LEN(512)
             DCL        VAR(&MSGID) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MSGL) TYPE(*DEC) LEN(5 0)

/*   MONITOR MESSAGES                                               */
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/*   INITIALIZE VARIABLES                                           */
             CHGVAR     VAR(&RETURN) VALUE('       ')

/*** FOR TESTING, SKIP THE SBMJOB                              +
GOTO TEST                                                      ******/

/*   SUBMIT PROGRAM TO BUILD THE WORKFILE THEN PRINT THE REPORT     */
 SUBMIT:     SBMJOB     CMD(CALL PGM(PNLSUPC) PARM(&RETURN &OUTQ +
                          &HOLD &SAVE &COMPNYN &CUSTNBR &FRMDATN &THRDATN +
                          &COPIES &RPTTYPE &CUSTNAME &ADJTYP1 +
                          &ADJTYP2 &ADJTYP3 &ADJTYP4 &ADJTYP5 +
                          &ADJTYP6 &ADJTYP7 &ADJTYP8 &ADJTYP9 +
                          &ADJTYP10 &COMP2 &COMP3 &INVSFX1 &INVSFX2 +
                          &INVSFX3 &INVSFX4 &INVSFX5 &INVSFX6 +
                          &RPTFMT &EMAILADDR)) JOB(ARWOREPORT)

             GOTO       CMDLBL(END)

/* FOR TESTING:                                                     */
 TEST:       CALL       PGM(PNLSUPC) PARM(&RETURN &OUTQ &HOLD &SAVE +
                          &COMPNYN &CUSTNBR &FRMDATN &THRDATN &COPIES +
                          &RPTTYPE &CUSTNAME &ADJTYP1 &ADJTYP2 +
                          &ADJTYP3 &ADJTYP4 &ADJTYP5 &ADJTYP6 +
                          &ADJTYP7 &ADJTYP8 &ADJTYP9 &ADJTYP10 +
                          &COMP2 &COMP3 &INVSFX1 &INVSFX2 &INVSFX3 +
                          &INVSFX4 &INVSFX5 &INVSFX6 &RPTFMT +
                          &EMAILADDR)

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/

 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
