// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBSZXFR
// ?Date: 14.08.2025 Time: 03:49:17
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(CHG A/R Claim RslPrdSA CH) TYPE(CHGOBJ) FILE(PDMPCPP)          AC1877296;
PARAMETER(PAR.Claim_Number);
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(PAR.Resale_Item_Line_Number);
PARAMETER(PAR.Resale_Company_Number);
PARAMETER(PAR.Resale_Item_Code);
PARAMETER(PAR.Reason_Code);
PARAMETER(PAR.UOM_Primary_Dft);
PARAMETER(PAR.Responsible_Department);
PARAMETER(PAR.Claim_Department_Code);
PARAMETER(PAR.Order_Sequence_Number);
PARAMETER(PAR.Order_Secondary_Line_Seq);
PARAMETER(PAR.Resale_Item_Quantity);
PARAMETER(PAR.Resale_Item_Weight);
PARAMETER(PAR.Resale_Item_Unit_Price);
PARAMETER(PAR.Resale_Item_Amount);
PARAMETER(PAR.Resale_Purchase_Order_Nbr);
PARAMETER(PAR.Affect_Trade_Fund);
PARAMETER(PAR.Affect_Commission);
PARAMETER(PAR.Affect_Pricing);
PARAMETER(PAR.Affect_Inventory_Status);
PARAMETER(PAR.Affect_Sales_Doll_Status);
PARAMETER(PAR.Affect_Sales_Pnds_Status);
PARAMETER(PAR.Resale_Responsibility);
PARAMETER(PAR.Resale_Prod_Reason_Type);
PARAMETER(PAR.CRP_Require_CM_Approval);
PARAMETER(PAR.Clm_Resale_TF_Exempt_Code);
PARAMETER(PAR.Record_Status);
PARAMETER(PAR.TF_Co_Ownership_Sts);
PARAMETER(PAR.Claim_Audit_Selection_Usr);
PARAMETER(PAR.Claim_Audit_Co_Value_Usr);
PARAMETER(PAR.Approval_Claim_Audit_Eml);
PARAMETER(PAR.Accounting_Company);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Claim Department   RT) TYPE(RTVOBJ) FILE(PPATREP)          AC1721713;
 PARAMETER(DB1.Claim_Department_Code);
 PARAMETER(NLL.Claim_Department_Desc);
 PARAMETER(DB1.Resale_Responsibility);
 PARAMETER(NLL.Record_Status);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

 //?OVERRIDE: Resale Responsibility
 CASE;

 // IF DB1.Clm Resale TF Exempt Code is Exempt Customer
 IF DB1.Clm_Resale_TF_Exempt_Code = 'EC';

 // OR DB1.Clm Resale TF Exempt Code is Exempt Product
 OR DB1.Clm_Resale_TF_Exempt_Code = 'EP';

 // OR DB1.Clm Resale TF Exempt Code is Pre Commencement
 OR DB1.Clm_Resale_TF_Exempt_Code = 'PC';

 // OR PAR.Accounting Company is Sioux City
 OR PAR.Accounting_Company = 440;

 //?RMC 11/16/18 added check of acctng company
 // DB1.Resale Responsibility = CND.Company
 DB1.Resale_Responsibility = 'C';

 //?OVERRIDE: Resale Responsibility
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Affect Sales Pounds = Y
 CASE;

 // IF DB1.Affect Sales Pnds Status is yes
 IF DB1.Affect_Sales_Pnds_Status = 'Y';

 // DB1.Resale Responsibility = CND.Company
 DB1.Resale_Responsibility = 'C';

 ENDIF;

 //?TFS037:  If the Item is Co-Owned, the responsibility is always
 //?         Shared.
 //?Item Co-Ownership = S or T
 CASE;

 // IF PAR.Item Co-Ownership Sts is Co-Owned
 IF PAR.TF_Co_Ownership_Sts = 'S'/'T';

 // DB1.Resale Responsibility = CND.Shared
 DB1.Resale_Responsibility = 'S';

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Set Chg Date/Time      IF) TYPE(EXCINTFUN)                     AC1523476;
 PARAMETER(DB1.Change_Date);
 PARAMETER(DB1.Change_Time);
 PARAMETER(DB1.Change_User);
 PARAMETER(DB1.Change_Program);
 {
  //?Execute internal function

  // PAR.Change Date = JOB.*Job date
  PAR.Change_Date = JOB.*Job_date;

  // PAR.Change Time = JOB.*Job time
  PAR.Change_Time = JOB.*Job_time;

  // PAR.Change User = JOB.*USER
  PAR.Change_User = JOB.*USER;

  // PAR.Change Program = JOB.*PROGRAM
  PAR.Change_Program = JOB.*PROGRAM;

 }

 //?USER: Processing after Data update

 CASE;

 // IF PAR.Claim Audit Selection Usr is yes
 IF PAR.Claim_Audit_Selection_Usr = 'Y';

 //?System generated action notes
 //?Resale Product changed
 // Call program Crt A/R Claim ExpComSG XF.
 CALL PROGRAM(Crt A/R Claim ExpComSG XF) ('PMTNXFR');
 PARAMETER(PAR.Claim_Number);
 PARAMETER('Resale Product changed');
 PARAMETER('S');
 PARAMETER('CLMCHANGE');
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER('CAR');

 ENDIF;

}


