     H/TITLE UPD Backout Spec'l Adj XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : COOL:2E  Version:  1000
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 02/27/02  Time  : 14:30:46
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB7CPLLIF  E           K        DISK
      * RSQ : Item Transaction Detail   Co/Itm/Whs/PrdDte/JobSt
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAB1REL4IF  E           K        DISK
      * RTV : Item Balance Detail       Active only
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@B7CPI8
      * Item Transaction Detail   Co/Itm/Whs/PrdDte/JobSt
      * Renamed input format fields
     I              B7AIC3                          WAAIC3
     I              B7HGCD                          WAHGCD
     I              B7AJCD                          WAAJCD
     I              B7W9ST                          WAW9ST
     I              B7BSST                          WABSST
     I              B7B4DT                          WAB4DT
     I              B7DXNB                          WADXNB
     I              B7ELDT                          WAELDT
     I              B7HVCD                          WAHVCD
     I              B7F1ST                          WAF1ST
     I              B7AUNA                          WAAUNA
     I              B7A5QT                          WAA5QT
     I              B7AHWG                          WAAHWG
     I              B7AKCS                          WAAKCS
     I              B7CGCD                          WACGCD
     I              B7AYVA                          WAAYVA
     I              B7BJNA                          WABJNA
     I              B7CKNB                          WACKNB
     I              B7BMST                          WABMST
     I              B7CQCD                          WACQCD
     I              B7DTCD                          WADTCD
     I              B7MGNA                          WAMGNA
     I              B7TRBN                          WATRBN
     I              B7TRBS                          WATRBS
     I              B7C4NB                          WAC4NB
     I              B7RINB                          WARINB
     I              B7RHNB                          WARHNB
     I              B7RGNB                          WARGNB
     I              B7M3NA                          WAM3NA
     I              B7AWTM                          WAAWTM
     I              B7XLCD                          WAXLCD
     I              B7K7DT                          WAK7DT
     I              B7UVST                          WAUVST
     I              B7UWST                          WAUWST
     I              B7UXST                          WAUXST
     I              B7VSST                          WAVSST
     I              B7AATM                          WAAATM
     I              B7AYNA                          WAAYNA
     I              B7A0NA                          WAA0NA
     I              B7AXDT                          WAAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WCAIC3
     I              B7HGCD                          WCHGCD
     I              B7AJCD                          WCAJCD
     I              B7W9ST                          WCW9ST
     I              B7BSST                          WCBSST
     I              B7B4DT                          WCB4DT
     I              B7DXNB                          WCDXNB
     I              B7ELDT                          WCELDT
     I              B7HVCD                          WCHVCD
     I              B7F1ST                          WCF1ST
     I              B7AUNA                          WCAUNA
     I              B7A5QT                          WCA5QT
     I              B7AHWG                          WCAHWG
     I              B7AKCS                          WCAKCS
     I              B7CGCD                          WCCGCD
     I              B7AYVA                          WCAYVA
     I              B7BJNA                          WCBJNA
     I              B7CKNB                          WCCKNB
     I              B7BMST                          WCBMST
     I              B7CQCD                          WCCQCD
     I              B7DTCD                          WCDTCD
     I              B7MGNA                          WCMGNA
     I              B7TRBN                          WCTRBN
     I              B7TRBS                          WCTRBS
     I              B7C4NB                          WCC4NB
     I              B7RINB                          WCRINB
     I              B7RHNB                          WCRHNB
     I              B7RGNB                          WCRGNB
     I              B7M3NA                          WCM3NA
     I              B7AWTM                          WCAWTM
     I              B7XLCD                          WCXLCD
     I              B7K7DT                          WCK7DT
     I              B7UVST                          WCUVST
     I              B7UWST                          WCUWST
     I              B7UXST                          WCUXST
     I              B7VSST                          WCVSST
     I              B7AATM                          WCAATM
     I              B7AYNA                          WCAYNA
     I              B7A0NA                          WCA0NA
     I              B7AXDT                          WCAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WDAIC3
     I              B7HGCD                          WDHGCD
     I              B7AJCD                          WDAJCD
     I              B7W9ST                          WDW9ST
     I              B7BSST                          WDBSST
     I              B7B4DT                          WDB4DT
     I              B7DXNB                          WDDXNB
     I              B7ELDT                          WDELDT
     I              B7HVCD                          WDHVCD
     I              B7F1ST                          WDF1ST
     I              B7AUNA                          WDAUNA
     I              B7A5QT                          WDA5QT
     I              B7AHWG                          WDAHWG
     I              B7AKCS                          WDAKCS
     I              B7CGCD                          WDCGCD
     I              B7AYVA                          WDAYVA
     I              B7BJNA                          WDBJNA
     I              B7CKNB                          WDCKNB
     I              B7BMST                          WDBMST
     I              B7CQCD                          WDCQCD
     I              B7DTCD                          WDDTCD
     I              B7MGNA                          WDMGNA
     I              B7TRBN                          WDTRBN
     I              B7TRBS                          WDTRBS
     I              B7C4NB                          WDC4NB
     I              B7RINB                          WDRINB
     I              B7RHNB                          WDRHNB
     I              B7RGNB                          WDRGNB
     I              B7M3NA                          WDM3NA
     I              B7AWTM                          WDAWTM
     I              B7XLCD                          WDXLCD
     I              B7K7DT                          WDK7DT
     I              B7UVST                          WDUVST
     I              B7UWST                          WDUWST
     I              B7UXST                          WDUXST
     I              B7VSST                          WDVSST
     I              B7AATM                          WDAATM
     I              B7AYNA                          WDAYNA
     I              B7A0NA                          WDA0NA
     I              B7AXDT                          WDAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WEAIC3
     I              B1HGCD                          WEHGCD
     I              B1AJCD                          WEAJCD
     I              B1ELDT                          WEELDT
     I              B1ABWG                          WEABWG
     I              B1AGQT                          WEAGQT
     I              B1AHQT                          WEAHQT
     I              B1AIQT                          WEAIQT
     I              B1CTST                          WECTST
     I              B1ACWG                          WEACWG
     I              B1ARQT                          WEARQT
     I              B1ASQT                          WEASQT
     I              B1ATQT                          WEATQT
     I              B1HDQT                          WEHDQT
     I              B1HEQT                          WEHEQT
     I              B1F6ST                          WEF6ST
     I              B1BMWG                          WEBMWG
     I              B1DSQT                          WEDSQT
     I              B1DTQT                          WEDTQT
     I              B1DUQT                          WEDUQT
     I              B1DHDT                          WEDHDT
     I              B1AGCS                          WEAGCS
     I              B1AECS                          WEAECS
     I              B1IDVA                          WEIDVA
     I              B1K7DT                          WEK7DT
     I              B1RINB                          WERINB
     I              B1RHNB                          WERHNB
     I              B1RGNB                          WERGNB
     I              B1UVST                          WEUVST
     I              B1UWST                          WEUWST
     I              B1UXST                          WEUXST
     I              B1VSST                          WEVSST
     I              B1AATM                          WEAATM
     I              B1AYNA                          WEAYNA
     I              B1A0NA                          WEA0NA
     I              B1AXDT                          WEAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     ICAB1RL4
      * Item Balance Detail       Active only
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WHAIC3
     I              B0HGCD                          WHHGCD
     I              B0AJCD                          WHAJCD
     I              B0AGCS                          WHAGCS
     I              B0AECS                          WHAECS
     I              B0BACS                          WHBACS
     I              B0BBCS                          WHBBCS
     I              B0CBPR                          WHCBPR
     I              B0GUDT                          WHGUDT
     I              B0XYST                          WHXYST
     I              B0CTPR                          WHCTPR
     I              B0G4DT                          WHG4DT
     I              B0BOWG                          WHBOWG
     I              B0DDQT                          WHDDQT
     I              B0DEQT                          WHDEQT
     I              B0DFQT                          WHDFQT
     I              B0HDQT                          WHHDQT
     I              B0HEQT                          WHHEQT
     I              B0AJQT                          WHAJQT
     I              B0AQQT                          WHAQQT
     I              B0AUQT                          WHAUQT
     I              B0EMQT                          WHEMQT
     I              B0DOQT                          WHDOQT
     I              B0ATNA                          WHATNA
     I              B0AKDT                          WHAKDT
     I              B0ANDT                          WHANDT
     I              B0IDVA                          WHIDVA
     I              B0JVST                          WHJVST
     I              B0BZPC                          WHBZPC
     I              B0DGQT                          WHDGQT
     I              B0DIDT                          WHDIDT
     I              B0ALCD                          WHALCD
     I              B0BFDY                          WHBFDY
     I              B0DJDT                          WHDJDT
     I              B0BGDY                          WHBGDY
     I              B0DKDT                          WHDKDT
     I              B0J2ST                          WHJ2ST
     I              B0DJQT                          WHDJQT
     I              B0BNWG                          WHBNWG
     I              B0DLDT                          WHDLDT
     I              B0DPQT                          WHDPQT
     I              B0DQQT                          WHDQQT
     I              B0DMDT                          WHDMDT
     I              B0M0ST                          WHM0ST
     I              B0J9ST                          WHJ9ST
     I              B0KBST                          WHKBST
     I              B0AKC8                          WHAKC8
     I              B0RINB                          WHRINB
     I              B0RHNB                          WHRHNB
     I              B0RGNB                          WHRGNB
     I              B0UVST                          WHUVST
     I              B0UWST                          WHUWST
     I              B0UXST                          WHUXST
     I              B0VSST                          WHVSST
     I              B0AATM                          WHAATM
     I              B0AYNA                          WHAYNA
     I              B0A0NA                          WHA0NA
     I              B0AXDT                          WHAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WDAIC3
     I              B7HGCD                          WDHGCD
     I              B7AJCD                          WDAJCD
     I              B7W9ST                          WDW9ST
     I              B7BSST                          WDBSST
     I              B7B4DT                          WDB4DT
     I              B7DXNB                          WDDXNB
     I              B7ELDT                          WDELDT
     I              B7HVCD                          WDHVCD
     I              B7F1ST                          WDF1ST
     I              B7AUNA                          WDAUNA
     I              B7A5QT                          WDA5QT
     I              B7AHWG                          WDAHWG
     I              B7AKCS                          WDAKCS
     I              B7CGCD                          WDCGCD
     I              B7AYVA                          WDAYVA
     I              B7BJNA                          WDBJNA
     I              B7CKNB                          WDCKNB
     I              B7BMST                          WDBMST
     I              B7CQCD                          WDCQCD
     I              B7DTCD                          WDDTCD
     I              B7MGNA                          WDMGNA
     I              B7TRBN                          WDTRBN
     I              B7TRBS                          WDTRBS
     I              B7C4NB                          WDC4NB
     I              B7RINB                          WDRINB
     I              B7RHNB                          WDRHNB
     I              B7RGNB                          WDRGNB
     I              B7M3NA                          WDM3NA
     I              B7AWTM                          WDAWTM
     I              B7XLCD                          WDXLCD
     I              B7K7DT                          WDK7DT
     I              B7UVST                          WDUVST
     I              B7UWST                          WDUWST
     I              B7UXST                          WDUXST
     I              B7VSST                          WDVSST
     I              B7AATM                          WDAATM
     I              B7AYNA                          WDAYNA
     I              B7A0NA                          WDA0NA
     I              B7AXDT                          WDAXDT
      *
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WEAIC3
     I              B1HGCD                          WEHGCD
     I              B1AJCD                          WEAJCD
     I              B1ELDT                          WEELDT
     I              B1ABWG                          WEABWG
     I              B1AGQT                          WEAGQT
     I              B1AHQT                          WEAHQT
     I              B1AIQT                          WEAIQT
     I              B1CTST                          WECTST
     I              B1ACWG                          WEACWG
     I              B1ARQT                          WEARQT
     I              B1ASQT                          WEASQT
     I              B1ATQT                          WEATQT
     I              B1HDQT                          WEHDQT
     I              B1HEQT                          WEHEQT
     I              B1F6ST                          WEF6ST
     I              B1BMWG                          WEBMWG
     I              B1DSQT                          WEDSQT
     I              B1DTQT                          WEDTQT
     I              B1DUQT                          WEDUQT
     I              B1DHDT                          WEDHDT
     I              B1AGCS                          WEAGCS
     I              B1AECS                          WEAECS
     I              B1IDVA                          WEIDVA
     I              B1K7DT                          WEK7DT
     I              B1RINB                          WERINB
     I              B1RHNB                          WERHNB
     I              B1RGNB                          WERGNB
     I              B1UVST                          WEUVST
     I              B1UWST                          WEUWST
     I              B1UXST                          WEUXST
     I              B1VSST                          WEVSST
     I              B1AATM                          WEAATM
     I              B1AYNA                          WEAYNA
     I              B1A0NA                          WEA0NA
     I              B1AXDT                          WEAXDT
      *
     IYARDCS      DS                            163
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WHAIC3
     I              B0HGCD                          WHHGCD
     I              B0AJCD                          WHAJCD
     I              B0AGCS                          WHAGCS
     I              B0AECS                          WHAECS
     I              B0BACS                          WHBACS
     I              B0BBCS                          WHBBCS
     I              B0CBPR                          WHCBPR
     I              B0GUDT                          WHGUDT
     I              B0XYST                          WHXYST
     I              B0CTPR                          WHCTPR
     I              B0G4DT                          WHG4DT
     I              B0BOWG                          WHBOWG
     I              B0DDQT                          WHDDQT
     I              B0DEQT                          WHDEQT
     I              B0DFQT                          WHDFQT
     I              B0HDQT                          WHHDQT
     I              B0HEQT                          WHHEQT
     I              B0AJQT                          WHAJQT
     I              B0AQQT                          WHAQQT
     I              B0AUQT                          WHAUQT
     I              B0EMQT                          WHEMQT
     I              B0DOQT                          WHDOQT
     I              B0ATNA                          WHATNA
     I              B0AKDT                          WHAKDT
     I              B0ANDT                          WHANDT
     I              B0IDVA                          WHIDVA
     I              B0JVST                          WHJVST
     I              B0BZPC                          WHBZPC
     I              B0DGQT                          WHDGQT
     I              B0DIDT                          WHDIDT
     I              B0ALCD                          WHALCD
     I              B0BFDY                          WHBFDY
     I              B0DJDT                          WHDJDT
     I              B0BGDY                          WHBGDY
     I              B0DKDT                          WHDKDT
     I              B0J2ST                          WHJ2ST
     I              B0DJQT                          WHDJQT
     I              B0BNWG                          WHBNWG
     I              B0DLDT                          WHDLDT
     I              B0DPQT                          WHDPQT
     I              B0DQQT                          WHDQQT
     I              B0DMDT                          WHDMDT
     I              B0M0ST                          WHM0ST
     I              B0J9ST                          WHJ9ST
     I              B0KBST                          WHKBST
     I              B0AKC8                          WHAKC8
     I              B0RINB                          WHRINB
     I              B0RHNB                          WHRHNB
     I              B0RGNB                          WHRGNB
     I              B0UVST                          WHUVST
     I              B0UWST                          WHUWST
     I              B0UXST                          WHUXST
     I              B0VSST                          WHVSST
     I              B0AATM                          WHAATM
     I              B0AYNA                          WHAYNA
     I              B0A0NA                          WHA0NA
     I              B0AXDT                          WHAXDT
      *
     IYBRDCS      DS                            245
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Transaction Detail
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Item Code
     I                                    P   3   60P1HGCD
      * I :  Warehouse Code
     I                                        7   9 P1AJCD
      * I :  Inventory Trans. ID
     I                                       10  10 P1W9ST
      * I :  Inventory Trans. Type
     I                                       11  12 P1BSST
      * I :  Transaction Date Code
     I                                    P  13  160P1B4DT
      * N :  Sequence Number
     I                                    P  17  180P1DXNB
      * I :  Production Date
     I                                    P  19  220P1ELDT
      * N :  Extended Amount
     I                                    P  23  282P1AYVA
      * N :  Shift Number
     I                                       29  29 P1XLCD
      * I :  Label Date
     I                                    P  30  330P1K7DT
     IP2PARM      DS
      * N :  Transaction Qty. Total
     I                                    P   1   62P2CZQT
     IP3PARM      DS
      * N :  Transaction Wgt. Total
     I                                    P   1   62P3A6WG
     IP4PARM      DS
      * FLD: Company Item
      * N :  U/M - Primary
     I                                        1   2 P4ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P4AWPC
      * N :  Operation Factor 1
     I                                        8   8 P4LXST
      * N :  U/M - Second
     I                                        9  10 P4AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P4AXPC
      * N :  Operation Factor 2
     I                                       16  16 P4LYST
      * N :  U/M - Third
     I                                       17  18 P4AFCD
      * N :  U/M - Pricing
     I                                       19  20 P4AICD
      * N :  Unit Weight
     I                                    P  21  262P4AIWG
      * N :  Production Date Control
     I                                       27  27 P4FZST
      * N :  Catch Weight Status
     I                                       28  28 P4AVST
      * N :  Item Structure Class Code
     I                                    P  29  300P4RINB
      * N :  Item Structure Group Code
     I                                    P  31  320P4RHNB
      * N :  Item Structure Type Code
     I                                    P  33  340P4RGNB
     IP5PARM      DS
      * FLD: Item Balance Detail
      * N :  Unit Cost Per Pound
     I                                    P   1   64P5AGCS
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1HGCD    PARM           WP0002  70       Item Code
     C           P1AJCD    PARM           WP0003  3        Warehouse Code
     C           P1W9ST    PARM           WP0004  1        Inventory Trans
     C           P1BSST    PARM           WP0005  2        Inventory Trans
     C           P1B4DT    PARM           WP0006  70       Transaction Dat
     C           P1ELDT    PARM           WP0007  70       Production Date
     C           P1K7DT    PARM           WP0008  70       Label Date
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Backout Spec'l Adj XF
      * Change Log
     C                     EXSR UASUBR                     Change Log
     C                     MOVEL'1'       P1XLCD           Shift Number
     C                     Z-ADD*ZERO     P2CZQT           Transaction Qty
     C                     Z-ADD*ZERO     P3A6WG           Transaction Wgt
      * RTV Backout Spec'l Adj RT - IC Transaction Detail  * 
     C                     EXSR SARVGN
      * CASE: Backout Qty or Wgt <> 0
      *  - c1 OR c2
      *   |- c1    : PAR.Transaction Qty. Total NE WRK.ZERO
      *   |- c2    : PAR.Transaction Wgt. Total NE WRK.ZERO
      *   '-
     C           P2CZQT    IFNE WUW0NB                     *IF
     C           P3A6WG    ORNE WUW0NB                     *OR
      * make transaction qty, wgt negative
     C           *ZERO     SUB  P2CZQT    P2CZQT           Transaction Qty
     C           *ZERO     SUB  P3A6WG    P3A6WG           Transaction Wgt
      * Rtv Base Values        RT - Company/Item  * 
     C                     EXSR SBRVGN
      *
     C                     Z-ADD*ZERO     WN0002  30       Item Structure
     C                     Z-ADD*ZERO     WN0003  30       Item Structure
     C                     Z-ADD*ZERO     WN0004  30       Item Structure
     C                     Z-ADD*ZERO     WN0005  30       Sequence Number
     C                     Z-ADD*ZERO     WN0006 114       USR Transaction
     C                     Z-ADD*ZERO     WN0007 112       Extended Amount
     C                     Z-ADD*ZERO     WN0008 112       On Hand Weight
     C                     Z-ADD*ZERO     WN0009 112       On Hand U/M1 Su
     C                     Z-ADD*ZERO     WN0010 112       Value of On Han
     C                     Z-ADD*ZERO     WN0011 112       Quantity based
     C                     Z-ADD*ZERO     WN0012 112       Quantity based
     C                     Z-ADD*ZERO     WN0013 112       Quantity based
     C                     Z-ADD*ZERO     WN0014 114       Cost based on U
     C                     Z-ADD*ZERO     WN0015 114       Cost based on U
     C                     Z-ADD*ZERO     WN0016 114       Cost based on U
     C                     Z-ADD*ZERO     WN0017 112       Quantity Total
     C                     Z-ADD*ZERO     WN0018 112       USR Transaction
     C                     MOVEL*BLANK    WN0019  3        USR Reason Code
      *
      * UPD Balances Issue/Adj IF
     C                     Z-ADDP2CZQT    WN0017           Quantity Total
     C                     Z-ADDP3A6WG    WN0018           USR Transaction
      * Adjust quantity, weight for trans type
      * CASE: PAR.Inventory Trans. Type is Issue types
     C           'BO'      IFEQ 'I'                        *IF
     C           'BO'      OREQ 'IO'
     C           'BO'      OREQ 'RW'
      * CASE: PAR.USR Unship Flag is yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Qty
      * CASE: PAR.Transaction Quantity GT WRK.ZERO
     C           P2CZQT    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  P2CZQT    WN0017           Quantity Total
     C                     END                             *FI
      * Wgt
      * CASE: PAR.Transaction Weight GT WRK.ZERO
     C           P3A6WG    IFGT WUW0NB                     *IF
     C           *ZERO     SUB  P3A6WG    WN0018           USR Transaction
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Send message 'Processing'
     C                     MOVEL'USR2303' ZAMSID
     C                     MOVEL'*EXT '   ZAPGRL           Rel queue
     C                     MOVEL'*STATUS' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      *
     C                     Z-ADD*ZERO     WN0020 112       Quantity based
     C                     Z-ADD*ZERO     WN0021 112       Quantity based
     C                     Z-ADD*ZERO     WN0022 112       Quantity based
      *
      * Clc Convert Quantity   IF
      * Clear output parameters
     C                     Z-ADD*ZERO     WN0011           USR Qty based o
     C                     Z-ADD*ZERO     WN0012           USR Qty based o
     C                     Z-ADD*ZERO     WN0013           USR Qty based o
      * Process based on transaction U/M
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Transaction
     C           P4ADCD    IFEQ P4ADCD                     *IF
     C                     Z-ADDWN0017    WN0011           USR Qty based o
      * Process entered U/M2
      * CASE: PAR.U/M - Second is Entered
     C           P4AECD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P4LXST    IFEQ 'M'                        *IF
     C           WN0017    MULT P4AWPC    WN0021    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P4LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P4AWPC    IFNE *ZERO                      *IF
     C           WN0017    DIV  P4AWPC    WN0021    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0021    WN0012           USR Qty based o
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P4AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P4LYST    IFEQ 'M'                        *IF
     C           WN0021    MULT P4AXPC    WN0022    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P4LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P4AXPC    IFNE *ZERO                      *IF
     C           WN0021    DIV  P4AXPC    WN0022    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0022    WN0013           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Transaction
     C           P4AECD    IFEQ P4ADCD                     *IF
     C                     Z-ADDWN0017    WN0012           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P4LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P4AWPC    IFNE *ZERO                      *IF
     C           WN0017    DIV  P4AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P4LXST    IFEQ 'D'                        *IF
     C           WN0017    MULT P4AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
      * Process entered U/M3
      * CASE: PAR.U/M - Third is Entered
     C           P4AFCD    IFNE *BLANK                     *IF
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P4LYST    IFEQ 'M'                        *IF
     C           WN0017    MULT P4AXPC    WN0022    H      Quantity based
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P4LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P4AXPC    IFNE *ZERO                      *IF
     C           WN0017    DIV  P4AXPC    WN0022    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0022    WN0013           USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Transaction
     C           P4AFCD    IFEQ P4ADCD                     *IF
     C                     Z-ADDWN0017    WN0013           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P4LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P4AXPC    IFNE *ZERO                      *IF
     C           WN0017    DIV  P4AXPC    WN0021    H      Quantity based
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P4LYST    IFEQ 'D'                        *IF
     C           WN0017    MULT P4AXPC    WN0021    H      Quantity based
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0021    WN0012           USR Qty based o
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P4LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P4AWPC    IFNE *ZERO                      *IF
     C           WN0021    DIV  P4AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P4LXST    IFEQ 'D'                        *IF
     C           WN0021    MULT P4AWPC    WN0011    H      USR Qty based o
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0023 114       Cost based on U
     C                     Z-ADD*ZERO     WN0024 114       Cost based on U
     C                     Z-ADD*ZERO     WN0025 114       Cost based on U
      *
      * Clc Convert Cost       IF
      * Initialize parameter values
     C                     Z-ADD*ZERO     WN0014           Cost based on U
     C                     Z-ADD*ZERO     WN0015           Cost based on U
     C                     Z-ADD*ZERO     WN0016           Cost based on U
      * Process based on Unit of Measure entered
      * CASE: PAR.U/M - Primary EQ PAR.U/M - Cost
     C           P4ADCD    IFEQ P4ADCD                     *IF
     C                     Z-ADDP5AGCS    WN0014           Cost based on U
      * Process second U/M if entered
      * CASE: PAR.U/M - Second is Entered
     C           P4AECD    IFNE *BLANK                     *IF
      * Convert based on operation code
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P4LXST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P4AWPC    IFNE *ZERO                      *IF
     C           P5AGCS    DIV  P4AWPC    WN0024    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P4LXST    IFEQ 'D'                        *IF
     C           P5AGCS    MULT P4AWPC    WN0024    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0024    WN0015           Cost based on U
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P4AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P4LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P4AXPC    IFNE *ZERO                      *IF
     C           WN0024    DIV  P4AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P4LYST    IFEQ 'D'                        *IF
     C           WN0024    MULT P4AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Second EQ PAR.U/M - Cost
     C           P4AECD    IFEQ P4ADCD                     *IF
     C                     Z-ADDP5AGCS    WN0015           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P4LXST    IFEQ 'M'                        *IF
     C           P5AGCS    MULT P4AWPC    WN0014    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P4LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P4AWPC    IFNE *ZERO                      *IF
     C           P5AGCS    DIV  P4AWPC    WN0014    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process third U/M if entered
      * CASE: PAR.U/M - Third is Entered
     C           P4AFCD    IFNE *BLANK                     *IF
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P4LYST    IFEQ 'M'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P4AXPC    IFNE *ZERO                      *IF
     C           P5AGCS    DIV  P4AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P4LYST    IFEQ 'D'                        *IF
     C           P5AGCS    MULT P4AXPC    WN0016    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.U/M - Third EQ PAR.U/M - Cost
     C           P4AFCD    IFEQ P4ADCD                     *IF
     C                     Z-ADDP5AGCS    WN0016           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 2 is Multiply
     C           P4LYST    IFEQ 'M'                        *IF
     C           P5AGCS    MULT P4AXPC    WN0024    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 2 is Divide
     C           P4LYST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 2 is Entered
     C           P4AXPC    IFNE *ZERO                      *IF
     C           P5AGCS    DIV  P4AXPC    WN0024    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWN0024    WN0015           Cost based on U
      * Convert based on operation factor
      * CASE: PAR.Operation Factor 1 is Multiply
     C           P4LXST    IFEQ 'M'                        *IF
     C           WN0024    MULT P4AWPC    WN0014    H      Cost based on U
     C                     ELSE
      * CASE: PAR.Operation Factor 1 is Divide
     C           P4LXST    IFEQ 'D'                        *IF
      * CASE: PAR.Conversion Factor 1 is Entered
     C           P4AWPC    IFNE *ZERO                      *IF
     C           WN0024    DIV  P4AWPC    WN0014    H      Cost based on U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P5AGCS    MULT WN0018    WN0007           Extended Amount
     C                     MOVEL*BLANK    WN0019           USR Reason Code
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
     C                     EXSR SCRVGN
      * Rtv Next Sequence No.  RT - IC Transaction Detail  * 
     C                     EXSR SDRVGN
      * Error if unit cost = 0
      * CASE: PAR.Unit Cost Pricing U/M EQ WRK.ZERO
     C           P5AGCS    IFEQ WUW0NB                     *IF
     C                     MOVEL'ERR'     WN0019           USR Reason Code
     C                     END                             *FI
      * Crt IC Trans. Detail   CR - IC Transaction Detail  * 
     C                     EXSR SECRRC
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
     C                     EXSR SFCHRC
      * Adjust available to sell for trans types Issues/Adj Qty/Adj Physi
      * CASE: PAR.Inventory Trans. Type is Issue/Adjustment Types
     C           'BO'      IFEQ 'AP'                       *IF
     C           'BO'      OREQ 'A'
     C           'BO'      OREQ 'I'
     C           'BO'      OREQ 'SA'
     C           'BO'      OREQ 'RW'
      * UPD Avail-To-Sell  INV XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDAFXFR'              90  UPD Avail-To-Se
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0050  30       Company Number
     C                     PARM P1HGCD    WQ0051  70       Item Code
     C                     PARM P1ELDT    WQ0052  70       Production Date
     C                     PARM P1AJCD    WQ0053  3        Warehouse Code
     C                     PARM WN0018    WQ0054 112       PSAA Weight Adj
     C                     PARM 'IA'      WQ0055  2        ATS Adj Type US
     C                     PARM ##PGM     WQ0056 10        PSAA Program Na
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
     C                     EXSR SJRVGN
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
     C                     EXSR SKCHRC
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Backout Spec'l Adj RT - IC Transaction Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        Reason Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAHGCD    WQSA02           Item Code
     C           *LIKE     DEFN WAAJCD    WQSA03           Warehouse Code
     C           *LIKE     DEFN WAELDT    WQSA04           Production Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Item Code
     C                     KFLD           WQSA03           Warehouse Code
     C                     KFLD           WQSA04           Production Date
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     Z-ADDP1HGCD    WQSA02           Item Code
     C                     MOVELP1AJCD    WQSA03           Warehouse Code
     C                     Z-ADDP1ELDT    WQSA04           Production Date
      * Establish starting position
     C           KRSSA     SETLL@B7CPI8                    *
     C           KRSSA     READE@B7CPI8                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'IAD'     WN0001           Reason Code
      * Special adjustment trans id and type are passed in as reference p
      * CASE: Special adjustment
      *  - c1 AND c2
      *   |- c1    : DB1.Inventory Trans. ID EQ PAR.Inventory Trans. ID
      *   |- c2    : DB1.Inventory Trans. Type EQ PAR.Inventory Trans. Ty
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAW9ST    IFEQ P1W9ST                     *IF
     C           WABSST    IFEQ P1BSST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  WAA5QT    P2CZQT           Transaction Qty
     C                     ADD  WAAHWG    P3A6WG           Transaction Wgt
     C                     ELSE
      * CASE: Latest Physical Adjustment
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Inventory Trans. ID is Adjustment
      *   |- c2    : DB1.Inventory Trans. Type is Adjustment Physical
      *   |- c3    : DB1.Reason Code EQ PAR.Reason Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAW9ST    IFEQ 'A'                        *IF
     C           WABSST    IFEQ 'AP'                       *IF
     C           WACQCD    IFEQ WN0001                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@B7CPI8                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Base Values        RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    P4ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P4AWPC           Conversion Fact
     C                     MOVEL*BLANK    P4LXST           Operation Facto
     C                     MOVEL*BLANK    P4AECD           U/M - Second
     C                     Z-ADD*ZERO     P4AXPC           Conversion Fact
     C                     MOVEL*BLANK    P4LYST           Operation Facto
     C                     MOVEL*BLANK    P4AFCD           U/M - Third
     C                     MOVEL*BLANK    P4AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P4AIWG           Unit Weight
     C                     MOVEL*BLANK    P4FZST           Production Date
     C                     MOVEL*BLANK    P4AVST           Catch Weight St
     C                     Z-ADD*ZERO     WUCHTM           Fresh Chilling
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBAVNA    WUAVNA           Description Lin
     C                     MOVELWBAWNA    WUAWNA           Description Lin
     C                     MOVELWBADCD    P4ADCD           U/M - Primary
     C                     Z-ADDWBAWPC    P4AWPC           Conversion Fact
     C                     MOVELWBLXST    P4LXST           Operation Facto
     C                     MOVELWBAECD    P4AECD           U/M - Second
     C                     Z-ADDWBAXPC    P4AXPC           Conversion Fact
     C                     MOVELWBLYST    P4LYST           Operation Facto
     C                     MOVELWBAFCD    P4AFCD           U/M - Third
     C                     MOVELWBAICD    P4AICD           U/M - Pricing
     C                     Z-ADDWBAIWG    P4AIWG           Unit Weight
     C                     MOVELWBFZST    P4FZST           Production Date
     C                     MOVELWBAVST    P4AVST           Catch Weight St
     C                     Z-ADDWBCHTM    WUCHTM           Fresh Chilling
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSC     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBRINB    WN0002           Item Structure
     C                     Z-ADDWBRHNB    WN0003           Item Structure
     C                     Z-ADDWBRGNB    WN0004           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - IC Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WCHGCD    WQSD02           Item Code
     C           *LIKE     DEFN WCAJCD    WQSD03           Warehouse Code
     C           *LIKE     DEFN WCW9ST    WQSD04           Inventory Trans
     C           *LIKE     DEFN WCBSST    WQSD05           Inventory Trans
     C           *LIKE     DEFN WCB4DT    WQSD06           Transaction Dat
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
     C                     KFLD           WQSD03           Warehouse Code
     C                     KFLD           WQSD04           Inventory Trans
     C                     KFLD           WQSD05           Inventory Trans
     C                     KFLD           WQSD06           Transaction Dat
      * Setup key
     C                     Z-ADDP1AIC3    WQSD01           Company Number
     C                     Z-ADDP1HGCD    WQSD02           Item Code
     C                     MOVELP1AJCD    WQSD03           Warehouse Code
     C                     MOVEL'A'       WQSD04           Inventory Trans
     C                     MOVEL'BO'      WQSD05           Inventory Trans
     C                     Z-ADDP1B4DT    WQSD06           Transaction Dat
      * Establish starting position
     C           KRSSD     SETLL@B7CPZA                    *
     C           KRSSD     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0005           Sequence Number
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WCDXNB    ADD  1         WN0005           Sequence Number
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - IC Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026  60       Job Time
     C                     MOVEL*BLANK    WN0027 10        User Id
     C                     MOVEL*BLANK    WN0028 10        Job Name
     C                     Z-ADD*ZERO     WN0029  70       Job Date
     C                     Z-ADD*ZERO     WN0030  20       Production Hour
     C                     Z-ADD*ZERO     WN0031 112       Production Weig
     C                     Z-ADD*ZERO     WN0032  50       Production Quan
     C                     Z-ADD*ZERO     WN0033  70       Production Piec
     C                     MOVEL*BLANK    WN0034  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDP1AIC3    WDAIC3           Company Number
     C                     Z-ADDP1HGCD    WDHGCD           Item Code
     C                     MOVELP1AJCD    WDAJCD           Warehouse Code
     C                     MOVEL'A'       WDW9ST           Inventory Trans
     C                     MOVEL'BO'      WDBSST           Inventory Trans
     C                     Z-ADDP1B4DT    WDB4DT           Transaction Dat
     C                     Z-ADDWN0005    WDDXNB           Sequence Number
     C                     Z-ADDP1ELDT    WDELDT           Production Date
     C                     MOVELP4ADCD    WDHVCD           U/M - Transacti
     C                     MOVEL'SG'      WDF1ST           Item Transactio
     C                     MOVEL@CN,01    WDAUNA           Description
     C                     Z-ADDWN0017    WDA5QT           Transaction Qua
     C                     Z-ADDWN0018    WDAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WDAKCS           USR Transaction
     C                     MOVELP4ADCD    WDCGCD           U/M - Cost
     C                     Z-ADDWN0007    WDAYVA           Extended Amount
     C                     MOVEL*BLANK    WDBJNA           Ticket Number
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     MOVEL*BLANK    WDBMST           G/L Update Stat
     C                     MOVELWN0019    WDCQCD           Reason Code
     C                     MOVEL*BLANK    WDDTCD           Reference Numbe
     C                     MOVEL*BLANK    WDMGNA           Lot ID
     C                     Z-ADD*ZERO     WDTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WDTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADDWN0002    WDRINB           Item Structure
     C                     Z-ADDWN0003    WDRHNB           Item Structure
     C                     Z-ADDWN0004    WDRGNB           Item Structure
     C                     MOVEL*BLANK    WDM3NA           Employee Badge
     C                     Z-ADD*ZERO     WDAWTM           Production Time
     C                     MOVELP1XLCD    WDXLCD           Shift Number
     C                     Z-ADDP1K7DT    WDK7DT           Label Date
     C                     MOVEL*BLANK    WDUVST           EDI Status 1
     C                     MOVEL*BLANK    WDUWST           EDI Status 2
     C                     MOVEL*BLANK    WDUXST           EDI Status 3
     C                     MOVEL'A'       WDVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSE    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDHGCD           Item Code
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDW9ST           Inventory Trans
     C                     KFLD           WDBSST           Inventory Trans
     C                     KFLD           WDB4DT           Transaction Dat
     C                     KFLD           WDDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WDAIC3    WQ0001  30       Company Number
     C                     PARM WDHGCD    WQ0002  70       Item Code
     C                     PARM WDAJCD    WQ0003  3        Warehouse Code
     C                     PARM WDW9ST    WQ0004  1        Inventory Trans
     C                     PARM WDBSST    WQ0005  2        Inventory Trans
     C                     PARM WDB4DT    WQ0006  70       Transaction Dat
     C                     PARM WDDXNB    WQ0007  30       Sequence Number
     C                     PARM WDELDT    WQ0008  70       Production Date
     C                     PARM WDHVCD    WQ0009  2        U/M - Transacti
     C                     PARM WDF1ST    WQ0010  2        Item Transactio
     C                     PARM WDAUNA    WQ0011 30        Description
     C                     PARM WDA5QT    WQ0012 112       Transaction Qua
     C                     PARM WDAHWG    WQ0013 112       Transaction Wei
     C                     PARM WDAKCS    WQ0014 114       USR Transaction
     C                     PARM WDCGCD    WQ0015  2        U/M - Cost
     C                     PARM WDAYVA    WQ0016 112       Extended Amount
     C                     PARM WDBJNA    WQ0017  6        Ticket Number
     C                     PARM WDCKNB    WQ0018  80       G/L Document Nu
     C                     PARM WDBMST    WQ0019  1        G/L Update Stat
     C                     PARM WDCQCD    WQ0020  3        Reason Code
     C                     PARM WDDTCD    WQ0021 15        Reference Numbe
     C                     PARM WDMGNA    WQ0022 10        Lot ID
     C                     PARM WDTRBN    WQ0023  70       Transfer Batch
     C                     PARM WDTRBS    WQ0024  30       Transfer Batch
     C                     PARM WDC4NB    WQ0025  70       Order Number
     C                     PARM WDRINB    WQ0026  30       Item Structure
     C                     PARM WDRHNB    WQ0027  30       Item Structure
     C                     PARM WDRGNB    WQ0028  30       Item Structure
     C                     PARM WDM3NA    WQ0029 10        Employee Badge
     C                     PARM WDAWTM    WQ0030  60       Production Time
     C                     PARM WDXLCD    WQ0031  1        Shift Number
     C                     PARM WDK7DT    WQ0032  70       Label Date
     C                     PARM WDVSST    WQ0033  1        Record Status
     C                     PARM WDAATM    WQ0034  60       Job Time
     C                     PARM WDAXDT    WQ0035  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * CHG Value/Qty/Wgt      CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0035 112       Physical Count
     C                     Z-ADD*ZERO     WN0036 112       Physical Count
     C                     Z-ADD*ZERO     WN0037 112       Physical Count
     C                     Z-ADD*ZERO     WN0038 112       Physical Count
     C                     MOVEL*BLANK    WN0039  1        Physical Count
     C                     Z-ADD*ZERO     WN0040 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0041 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0042 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0043 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0044 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0045 112       Weight In Chill
     C                     MOVEL*BLANK    WN0046  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0047 112       Physical Start
     C                     Z-ADD*ZERO     WN0048 112       Physical Start
     C                     Z-ADD*ZERO     WN0049 112       Physical Start
     C                     Z-ADD*ZERO     WN0050 112       Physical Start
     C                     Z-ADD*ZERO     WN0051  70       Physical Start
     C                     Z-ADD*ZERO     WN0052 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0053 114       Last Cost
     C                     Z-ADD*ZERO     WN0054 112       Value of On Han
     C                     Z-ADD*ZERO     WN0055  70       Label Date
     C                     MOVEL*BLANK    WN0056  1        EDI Status 1
     C                     MOVEL*BLANK    WN0057  1        EDI Status 2
     C                     MOVEL*BLANK    WN0058  1        EDI Status 3
     C                     MOVEL*BLANK    WN0059  1        Record Status
     C                     Z-ADD*ZERO     WN0060  60       Job Time
     C                     MOVEL*BLANK    WN0061 10        User Id
     C                     MOVEL*BLANK    WN0062 10        Job Name
     C                     Z-ADD*ZERO     WN0063  70       Job Date
     C                     MOVEL*BLANK    WN0064  1        Shift Number
     C                     MOVEL*BLANK    WN0065  1        Lot Tracking Fl
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
     C                     MOVEL'1'       WN0064           Shift Number
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADDP1HGCD    WEHGCD           Item Code
     C                     MOVELP1AJCD    WEAJCD    P      Warehouse Code
     C                     Z-ADDP1ELDT    WEELDT           Production Date
      *
     C           KLCHSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
     C           KLCHSF    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
     C                     EXSR SGCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YARDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWN0002    WERINB           Item Structure
     C                     Z-ADDWN0003    WERHNB           Item Structure
     C                     Z-ADDWN0004    WERGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     ADD  WN0011    WEARQT           Quantity on Han
     C                     ADD  WN0018    WEACWG           Quantity on Han
     C                     ADD  WN0007    WEIDVA           Value of On Han
      * If quantity is zero, so are weight, value of inventory
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WEARQT    IFEQ WUW0NB                     *IF
      * UPD Create Weight Adj. XF - IC Transaction Detail  * 
     C                     CALL 'PDMYXFR'              90  UPD Create Weig
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0036  30       Company Number
     C                     PARM WEHGCD    WQ0037  70       Item Code
     C                     PARM WEAJCD    WQ0038  3        Warehouse Code
     C                     PARM P1B4DT    WQ0039  70       Transaction Dat
     C                     PARM WEELDT    WQ0040  70       Production Date
     C                     PARM P4ADCD    WQ0041  2        U/M - Transacti
     C                     PARM WEACWG    WQ0042 112       Transaction Wei
     C                     PARM P5AGCS    WQ0043 114       USR Transaction
     C                     PARM P4ADCD    WQ0044  2        U/M - Cost
     C                     PARM WERINB    WQ0045  30       Item Structure
     C                     PARM WERHNB    WQ0046  30       Item Structure
     C                     PARM WERGNB    WQ0047  30       Item Structure
     C                     PARM WN0064    WQ0048  1        Shift Number
     C                     PARM WEK7DT    WQ0049  70       Label Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMYXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD*ZERO     WEACWG           Quantity on Han
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     END                             *FI
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
      * CASE: DB1.Quantity on Hand - U/M1 EQ WRK.ZERO
     C           WEARQT    IFEQ WUW0NB                     *IF
      * Rtv Lot Tracking Flag RT - Warehouse  * 
     C                     EXSR SHRVGN
      * CASE: PAR.Lot Tracking Flag is Not Yes
     C           WN0065    IFEQ *BLANK                     *IF
     C           WN0065    OREQ 'N'
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
     C                     EXSR SIDLRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Item Bal. Detail   CR - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0066  60       Job Time
     C                     MOVEL*BLANK    WN0067 10        User Id
     C                     MOVEL*BLANK    WN0068 10        Job Name
     C                     Z-ADD*ZERO     WN0069  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDP1AIC3    WEAIC3           Company Number
     C                     Z-ADDP1HGCD    WEHGCD           Item Code
     C                     MOVELP1AJCD    WEAJCD           Warehouse Code
     C                     Z-ADDP1ELDT    WEELDT           Production Date
     C                     Z-ADD*ZERO     WEABWG           Physical Count
     C                     Z-ADD*ZERO     WEAGQT           Physical Count
     C                     Z-ADD*ZERO     WEAHQT           Physical Count
     C                     Z-ADD*ZERO     WEAIQT           Physical Count
     C                     MOVEL*BLANK    WECTST           Physical Count
     C                     Z-ADDWN0018    WEACWG           Quantity on Han
     C                     Z-ADDWN0011    WEARQT           Quantity on Han
     C                     Z-ADD*ZERO     WEASQT           Quantity on Han
     C                     Z-ADD*ZERO     WEATQT           Quantity on Han
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     MOVEL'N'       WEF6ST           Update Exceptio
     C                     Z-ADD*ZERO     WEBMWG           Physical Start
     C                     Z-ADD*ZERO     WEDSQT           Physical Start
     C                     Z-ADD*ZERO     WEDTQT           Physical Start
     C                     Z-ADD*ZERO     WEDUQT           Physical Start
     C                     Z-ADD*ZERO     WEDHDT           Physical Start
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADDWN0007    WEIDVA           Value of On Han
     C                     Z-ADDP1K7DT    WEK7DT           Label Date
     C                     Z-ADDWN0002    WERINB           Item Structure
     C                     Z-ADDWN0003    WERHNB           Item Structure
     C                     Z-ADDWN0004    WERGNB           Item Structure
     C                     MOVEL*BLANK    WEUVST           EDI Status 1
     C                     MOVEL*BLANK    WEUWST           EDI Status 2
     C                     MOVEL*BLANK    WEUXST           EDI Status 3
     C                     MOVEL'A'       WEVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
     C           KLCRSG    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELWEAJCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0065           Lot Tracking Fl
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFVHST    WN0065           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIDLRC    BEGSR
      *================================================================
      * Dlt Item Bal. Detail   DL - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B1REJ1
      *
     C           KLDLSI    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WEAJCD           Warehouse Code
     C                     KFLD           WEELDT           Production Date
     C           KLDLSI    CHAIN@B1REJ1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B1REJ1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Sum Act Qty,Wgt,ValRT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WN0008           Quantity on Han
     C                     Z-ADD*ZERO     WN0009           Quantity on Han
     C                     Z-ADD*ZERO     WUNFNN           Quantity on Han
     C                     Z-ADD*ZERO     WUNFNN           Quantity on Han
     C                     Z-ADD*ZERO     WN0010           Value of On Han
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WGHGCD    WQSJ02           Item Code
     C           *LIKE     DEFN WGAJCD    WQSJ03           Warehouse Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
     C                     KFLD           WQSJ03           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSJ01           Company Number
     C                     Z-ADDP1HGCD    WQSJ02           Item Code
     C                     MOVELP1AJCD    WQSJ03           Warehouse Code
      * Establish starting position
     C           KRSSJ     SETLLCAB1RL4                    *
     C           KRSSJ     READECAB1RL4                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WGACWG    WN0008           Quantity on Han
     C                     ADD  WGARQT    WN0009           Quantity on Han
     C                     ADD  WGASQT    WUNFNN           Quantity on Han
     C                     ADD  WGATQT    WUNFNN           Quantity on Han
     C                     ADD  WGIDVA    WN0010           Value of On Han
     C           KRSSJ     READECAB1RL4                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Val/Qty/Wgt        Ch - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0070 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0071 114       Last Cost
     C                     Z-ADD*ZERO     WN0072 114       Cost per Primar
     C                     Z-ADD*ZERO     WN0073 114       Cost per Pricin
     C                     Z-ADD*ZERO     WN0074 114       Revaluation Cos
     C                     Z-ADD*ZERO     WN0075  70       Revaluation Eff
     C                     MOVEL*BLANK    WN0076  1        Revaluation Cos
     C                     Z-ADD*ZERO     WN0077 114       Last Revaluatio
     C                     Z-ADD*ZERO     WN0078  70       Last Revaluatio
     C                     Z-ADD*ZERO     WN0079 112       On Hand U/M2 Su
     C                     Z-ADD*ZERO     WN0080 112       On Hand U/M3 Su
     C                     Z-ADD*ZERO     WN0081 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0082 112       Weight In Chill
     C                     Z-ADD*ZERO     WN0083 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0084 112       Quantity on Sal
     C                     Z-ADD*ZERO     WN0085 112       Quantity on Pur
     C                     Z-ADD*ZERO     WN0086 112       Quantity on Tra
     C                     Z-ADD*ZERO     WN0087 112       Quantity Avail.
     C                     MOVEL*BLANK    WN0088  3        Cycle Count Cod
     C                     Z-ADD*ZERO     WN0089  70       Date of Last Or
     C                     Z-ADD*ZERO     WN0090  70       Date of Last Sh
     C                     MOVEL*BLANK    WN0091  1        Inventory Plann
     C                     Z-ADD*ZERO     WN0092  52       Safety Allowanc
     C                     Z-ADD*ZERO     WN0093 112       Safety Allowanc
     C                     Z-ADD*ZERO     WN0094  70       Stock Out Date
     C                     MOVEL*BLANK    WN0095  3        Buyer Code
     C                     Z-ADD*ZERO     WN0096  30       Lead Time - Las
     C                     Z-ADD*ZERO     WN0097  70       Lead Time - Dat
     C                     Z-ADD*ZERO     WN0098  30       Lead Time - Nex
     C                     Z-ADD*ZERO     WN0099  70       Lead Time - Dat
     C                     MOVEL*BLANK    WN0100  1        Lead Time - Exc
     C                     Z-ADD*ZERO     WN0101 112       Usage Qty per C
     C                     Z-ADD*ZERO     WN0102 112       Usage Weight pe
     C                     Z-ADD*ZERO     WN0103  70       Inventory Manag
     C                     Z-ADD*ZERO     WN0104 112       Minimum Quantit
     C                     Z-ADD*ZERO     WN0105 112       Maximum Quantit
     C                     Z-ADD*ZERO     WN0106  70       Last Physical C
     C                     MOVEL*BLANK    WN0107  1        Requisition Mod
     C                     MOVEL*BLANK    WN0108  1        Cost Update Pen
     C                     MOVEL*BLANK    WN0109  1        Post G/L Status
     C                     Z-ADD*ZERO     WN0110  80       Vendor - Item/W
     C                     Z-ADD*ZERO     WN0111  30       Item Structure
     C                     Z-ADD*ZERO     WN0112  30       Item Structure
     C                     Z-ADD*ZERO     WN0113  30       Item Structure
     C                     MOVEL*BLANK    WN0114  1        EDI Status 1
     C                     MOVEL*BLANK    WN0115  1        EDI Status 2
     C                     MOVEL*BLANK    WN0116  1        EDI Status 3
     C                     MOVEL*BLANK    WN0117  1        Record Status
     C                     Z-ADD*ZERO     WN0118  60       Job Time
     C                     MOVEL*BLANK    WN0119 10        User Id
     C                     MOVEL*BLANK    WN0120 10        Job Name
     C                     Z-ADD*ZERO     WN0121  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     Z-ADDP1HGCD    WHHGCD           Item Code
     C                     MOVELP1AJCD    WHAJCD    P      Warehouse Code
      *
     C           KLCHSK    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C           KLCHSK    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YBRDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDWN0008    WHBOWG           On Hand Weight
     C                     Z-ADDWN0009    WHDDQT           On Hand U/M1 Su
     C                     Z-ADDWN0010    WHIDVA           Value of On Han
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YBRDC            *Record Data Ch
      * Refresh the available to sell quantity
     C                     Z-ADDWHDDQT    WHDOQT           Quantity Avail.
     C                     SUB  WHAQQT    WHDOQT           Quantity Avail.
     C                     SUB  WHAUQT    WHDOQT           Quantity Avail.
     C                     SUB  WHEMQT    WHDOQT           Quantity Avail.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * INV018 3/19/97 PLL  Added shift # to processing; hard-coded 1 for
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1DXNB           Sequence Number
     C                     Z-ADD*ZERO     P1AYVA           Extended Amount
     C                     MOVEL*BLANK    P1XLCD           Shift Number
     C                     Z-ADD*ZERO     P2CZQT           Transaction Qty
     C                     Z-ADD*ZERO     P3A6WG           Transaction Wgt
     C                     MOVEL*BLANK    P4ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P4AWPC           Conversion Fact
     C                     MOVEL*BLANK    P4LXST           Operation Facto
     C                     MOVEL*BLANK    P4AECD           U/M - Second
     C                     Z-ADD*ZERO     P4AXPC           Conversion Fact
     C                     MOVEL*BLANK    P4LYST           Operation Facto
     C                     MOVEL*BLANK    P4AFCD           U/M - Third
     C                     MOVEL*BLANK    P4AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P4AIWG           Unit Weight
     C                     MOVEL*BLANK    P4FZST           Production Date
     C                     MOVEL*BLANK    P4AVST           Catch Weight St
     C                     Z-ADD*ZERO     P4RINB           Item Structure
     C                     Z-ADD*ZERO     P4RHNB           Item Structure
     C                     Z-ADD*ZERO     P4RGNB           Item Structure
     C                     Z-ADD*ZERO     P5AGCS           Unit Cost Per P
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WADXNB           Sequence Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WAAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WAAKCS           USR Transaction
     C                     Z-ADD*ZERO     WAAYVA           Extended Amount
     C                     Z-ADD*ZERO     WACKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WATRBN           Transfer Batch
     C                     Z-ADD*ZERO     WATRBS           Transfer Batch
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAWTM           Production Time
     C                     Z-ADD*ZERO     WAK7DT           Label Date
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field Fresh Chilling Time
     C                     Z-ADD*ZERO     WUCHTM  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Iten Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Packages (Trays
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           PM Crew Size
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           PM BOM Spec Dat
     C                     Z-ADD*ZERO     WBCNNB           PM Seaboard Spe
     C                     Z-ADD*ZERO     WBCRNB           PM Seaboard Rep
     C                     Z-ADD*ZERO     WBCSNB           PM Raw Yield
     C                     Z-ADD*ZERO     WBCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           CI Unused Wgt 2
     C                     Z-ADD*ZERO     WBF7WG           CI Unused Wgt 3
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           CI Unused Nbr 2
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Clear all neither parameters
      * Crt IC Trans. Detail   CR - IC Transaction Detail  * 
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEABWG           Physical Count
     C                     Z-ADD*ZERO     WEAGQT           Physical Count
     C                     Z-ADD*ZERO     WEAHQT           Physical Count
     C                     Z-ADD*ZERO     WEAIQT           Physical Count
     C                     Z-ADD*ZERO     WEACWG           Quantity on Han
     C                     Z-ADD*ZERO     WEARQT           Quantity on Han
     C                     Z-ADD*ZERO     WEASQT           Quantity on Han
     C                     Z-ADD*ZERO     WEATQT           Quantity on Han
     C                     Z-ADD*ZERO     WEHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WEHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WEBMWG           Physical Start
     C                     Z-ADD*ZERO     WEDSQT           Physical Start
     C                     Z-ADD*ZERO     WEDTQT           Physical Start
     C                     Z-ADD*ZERO     WEDUQT           Physical Start
     C                     Z-ADD*ZERO     WEDHDT           Physical Start
     C                     Z-ADD*ZERO     WEAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WEAECS           Last Cost
     C                     Z-ADD*ZERO     WEIDVA           Value of On Han
     C                     Z-ADD*ZERO     WEK7DT           Label Date
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADD*ZERO     WHBACS           Cost per Primar
     C                     Z-ADD*ZERO     WHBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WHCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WHGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WHCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WHG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WHBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WHDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WHDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WHDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WHAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WHAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WHAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WHEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WHDOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WHAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WHANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     Z-ADD*ZERO     WHBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WHDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WHDIDT           Stock Out Date
     C                     Z-ADD*ZERO     WHBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WHDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WHBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WHDKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WHDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WHBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WHDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WHDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WHDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WHDMDT           Last Physical C
     C                     Z-ADD*ZERO     WHAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Backout Special Adjustmts
