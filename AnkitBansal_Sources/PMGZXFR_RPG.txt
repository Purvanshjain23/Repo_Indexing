     H/TITLE Exc Crt Missing Items XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/26/17  Time  : 16:31:29
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBSCPL6IF  E           K        DISK
      * RSQ : Inventory Stock Closing   Weekend/Company/Whse
      *
     FPMALCPL1IF  E           K        DISK
      * RTV : WF ISC Trans Sum/Pkg Var  Retrieval index
      *
     FCAAFREL6IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Date Descending
      *
     FPPBSCPL1IF  E           K        DISK
      * RTV : Inventory Stock Closing   Retrieval index
      *
     FPPBSCPL3IF  E           K        DISK
      * RSQ : Inventory Stock Closing   WeekEnd/Item
      *
     FPMALCPL0IF  E           K        DISK                      A
      * UPD : WF ISC Trans Sum/Pkg Var  Update index
      *
     I@BSCPJ7
      * Inventory Stock Closing   Weekend/Company/Whse
      * Renamed input format fields
     I              BSAIDX                          WAAIDX
     I              BSB2C3                          WAB2C3
     I              BSGRAA                          WAGRAA
     I              BSEJC7                          WAEJC7
     I              BSV8SX                          WAV8SX
     I              BSGPAA                          WAGPAA
     I              BSGQAA                          WAGQAA
     I              BSW1SX                          WAW1SX
     I              BSF3PR                          WAF3PR
     I              BSBSNY                          WABSNY
     I              BSBTNY                          WABTNY
     I              BSBUNY                          WABUNY
     I              BSGSAA                          WAGSAA
     I              BSGTAA                          WAGTAA
     I              BSOEQT                          WAOEQT
     I              BSMQWG                          WAMQWG
     I              BSOFQT                          WAOFQT
     I              BSMRWG                          WAMRWG
     I              BSOGQT                          WAOGQT
     I              BSMXWG                          WAMXWG
     I              BSOHQT                          WAOHQT
     I              BSMSWG                          WAMSWG
     I              BSOWQT                          WAOWQT
     I              BSNAWG                          WANAWG
     I              BSOIQT                          WAOIQT
     I              BSMTWG                          WAMTWG
     I              BSOJQT                          WAOJQT
     I              BSMUWG                          WAMUWG
     I              BSOKQT                          WAOKQT
     I              BSMVWG                          WAMVWG
     I              BSOLQT                          WAOLQT
     I              BSMWWG                          WAMWWG
     I              BSFQVL                          WAFQVL
     I              BSOMQT                          WAOMQT
     I              BSMYWG                          WAMYWG
     I              BSONQT                          WAONQT
     I              BSMZWG                          WAMZWG
     I              BSOOQT                          WAOOQT
     I              BSM0WG                          WAM0WG
     I              BSDGVN                          WADGVN
     I              BSP9DT                          WAP9DT
     I              BSCTTM                          WACTTM
     I              BSOPQT                          WAOPQT
     I              BSM1WG                          WAM1WG
     I              BSOQQT                          WAOQQT
     I              BSM2WG                          WAM2WG
     I              BSORQT                          WAORQT
     I              BSM3WG                          WAM3WG
     I              BSOSQT                          WAOSQT
     I              BSM4WG                          WAM4WG
     I              BSRCNA                          WARCNA
     I              BSDFVN                          WADFVN
     I              BSP8DT                          WAP8DT
     I              BSCSTM                          WACSTM
     I              BSOTQT                          WAOTQT
     I              BSM5WG                          WAM5WG
     I              BSF4PR                          WAF4PR
     I              BSWBSX                          WAWBSX
     I              BSWNSX                          WAWNSX
     I              BSWOSX                          WAWOSX
     I              BSOUQT                          WAOUQT
     I              BSM6WG                          WAM6WG
     I              BSOVQT                          WAOVQT
     I              BSM7WG                          WAM7WG
     I              BSWCSX                          WAWCSX
     I              BSQADT                          WAQADT
     I              BSWDSX                          WAWDSX
     I              BSVSST                          WAVSST
     I              BSMJDT                          WAMJDT
     I              BSBETM                          WABETM
     I              BSCCVN                          WACCVN
     I              BSCDVN                          WACDVN
     I              BSMKDT                          WAMKDT
     I              BSBFTM                          WABFTM
     I              BSCEVN                          WACEVN
     I              BSCFVN                          WACFVN
      *
     I@ALCPJC
      * WF ISC Trans Sum/Pkg Var  Retrieval index
      * Renamed input format fields
     I              ALAIDX                          WBAIDX
     I              ALB2C3                          WBB2C3
     I              ALGRAA                          WBGRAA
     I              ALEJC7                          WBEJC7
     I              ALMQWG                          WBMQWG
     I              ALM5WG                          WBM5WG
     I              ALOEQT                          WBOEQT
     I              ALOTQT                          WBOTQT
     I              ALM2WG                          WBM2WG
     I              ALOQQT                          WBOQQT
     I              ALM1WG                          WBM1WG
     I              ALOPQT                          WBOPQT
     I              ALNOWG                          WBNOWG
     I              ALOYQT                          WBOYQT
     I              ALNPWG                          WBNPWG
     I              ALOZQT                          WBOZQT
     I              ALNQWG                          WBNQWG
     I              ALNRWG                          WBNRWG
     I              ALNSWG                          WBNSWG
     I              ALNTWG                          WBNTWG
     I              ALNUWG                          WBNUWG
     I              ALNVWG                          WBNVWG
     I              ALO4QT                          WBO4QT
     I              ALO0QT                          WBO0QT
     I              ALO5QT                          WBO5QT
     I              ALO1QT                          WBO1QT
     I              ALO2QT                          WBO2QT
     I              ALO3QT                          WBO3QT
     I              ALNWWG                          WBNWWG
     I              ALO6QT                          WBO6QT
     I              ALNXWG                          WBNXWG
     I              ALO7QT                          WBO7QT
     I              ALNYWG                          WBNYWG
     I              ALO8QT                          WBO8QT
     I              ALNZWG                          WBNZWG
     I              ALO9QT                          WBO9QT
     I              ALN0WG                          WBN0WG
     I              ALPAQT                          WBPAQT
     I              ALN1WG                          WBN1WG
     I              ALPBQT                          WBPBQT
     I              ALN2WG                          WBN2WG
     I              ALPCQT                          WBPCQT
     I              ALN3WG                          WBN3WG
     I              ALPDQT                          WBPDQT
     I              ALN4WG                          WBN4WG
     I              ALPEQT                          WBPEQT
      *
     I@AFREPU
      * Calendar                  RSQ Co/Date Descending
      * Renamed input format fields
     I              AFAIC3                          WCAIC3
     I              AFBCDT                          WCBCDT
     I              AFCQNB                          WCCQNB
     I              AFESNB                          WCESNB
     I              AFETNB                          WCETNB
     I              AFBZNB                          WCBZNB
     I              AFA9ST                          WCA9ST
     I              AFEINB                          WCEINB
     I              AFC5ST                          WCC5ST
     I              AFAQNB                          WCAQNB
     I              AFCMST                          WCCMST
     I              AFV9ST                          WCV9ST
     I              AFWAST                          WCWAST
     I              AFX2ST                          WCX2ST
     I              AFOJDT                          WCOJDT
     I              AFNQNX                          WCNQNX
     I              AFNRNX                          WCNRNX
     I              AFI9SX                          WCI9SX
     I              AFJASX                          WCJASX
     I              AFOKDT                          WCOKDT
     I              AFOLDT                          WCOLDT
     I              AFUVST                          WCUVST
     I              AFUWST                          WCUWST
     I              AFUXST                          WCUXST
     I              AFAATM                          WCAATM
     I              AFAYNA                          WCAYNA
     I              AFA0NA                          WCA0NA
     I              AFAXDT                          WCAXDT
      *
     I@BSCPA6
      * Inventory Stock Closing   Retrieval index
      * Renamed input format fields
     I              BSAIDX                          WDAIDX
     I              BSB2C3                          WDB2C3
     I              BSGRAA                          WDGRAA
     I              BSEJC7                          WDEJC7
     I              BSV8SX                          WDV8SX
     I              BSGPAA                          WDGPAA
     I              BSGQAA                          WDGQAA
     I              BSW1SX                          WDW1SX
     I              BSF3PR                          WDF3PR
     I              BSBSNY                          WDBSNY
     I              BSBTNY                          WDBTNY
     I              BSBUNY                          WDBUNY
     I              BSGSAA                          WDGSAA
     I              BSGTAA                          WDGTAA
     I              BSOEQT                          WDOEQT
     I              BSMQWG                          WDMQWG
     I              BSOFQT                          WDOFQT
     I              BSMRWG                          WDMRWG
     I              BSOGQT                          WDOGQT
     I              BSMXWG                          WDMXWG
     I              BSOHQT                          WDOHQT
     I              BSMSWG                          WDMSWG
     I              BSOWQT                          WDOWQT
     I              BSNAWG                          WDNAWG
     I              BSOIQT                          WDOIQT
     I              BSMTWG                          WDMTWG
     I              BSOJQT                          WDOJQT
     I              BSMUWG                          WDMUWG
     I              BSOKQT                          WDOKQT
     I              BSMVWG                          WDMVWG
     I              BSOLQT                          WDOLQT
     I              BSMWWG                          WDMWWG
     I              BSFQVL                          WDFQVL
     I              BSOMQT                          WDOMQT
     I              BSMYWG                          WDMYWG
     I              BSONQT                          WDONQT
     I              BSMZWG                          WDMZWG
     I              BSOOQT                          WDOOQT
     I              BSM0WG                          WDM0WG
     I              BSDGVN                          WDDGVN
     I              BSP9DT                          WDP9DT
     I              BSCTTM                          WDCTTM
     I              BSOPQT                          WDOPQT
     I              BSM1WG                          WDM1WG
     I              BSOQQT                          WDOQQT
     I              BSM2WG                          WDM2WG
     I              BSORQT                          WDORQT
     I              BSM3WG                          WDM3WG
     I              BSOSQT                          WDOSQT
     I              BSM4WG                          WDM4WG
     I              BSRCNA                          WDRCNA
     I              BSDFVN                          WDDFVN
     I              BSP8DT                          WDP8DT
     I              BSCSTM                          WDCSTM
     I              BSOTQT                          WDOTQT
     I              BSM5WG                          WDM5WG
     I              BSF4PR                          WDF4PR
     I              BSWBSX                          WDWBSX
     I              BSWNSX                          WDWNSX
     I              BSWOSX                          WDWOSX
     I              BSOUQT                          WDOUQT
     I              BSM6WG                          WDM6WG
     I              BSOVQT                          WDOVQT
     I              BSM7WG                          WDM7WG
     I              BSWCSX                          WDWCSX
     I              BSQADT                          WDQADT
     I              BSWDSX                          WDWDSX
     I              BSVSST                          WDVSST
     I              BSMJDT                          WDMJDT
     I              BSBETM                          WDBETM
     I              BSCCVN                          WDCCVN
     I              BSCDVN                          WDCDVN
     I              BSMKDT                          WDMKDT
     I              BSBFTM                          WDBFTM
     I              BSCEVN                          WDCEVN
     I              BSCFVN                          WDCFVN
      *
     I@BSCPBJ
      * Inventory Stock Closing   WeekEnd/Item
      * Renamed input format fields
     I              BSAIDX                          WEAIDX
     I              BSB2C3                          WEB2C3
     I              BSGRAA                          WEGRAA
     I              BSEJC7                          WEEJC7
     I              BSV8SX                          WEV8SX
     I              BSGPAA                          WEGPAA
     I              BSGQAA                          WEGQAA
     I              BSW1SX                          WEW1SX
     I              BSF3PR                          WEF3PR
     I              BSBSNY                          WEBSNY
     I              BSBTNY                          WEBTNY
     I              BSBUNY                          WEBUNY
     I              BSGSAA                          WEGSAA
     I              BSGTAA                          WEGTAA
     I              BSOEQT                          WEOEQT
     I              BSMQWG                          WEMQWG
     I              BSOFQT                          WEOFQT
     I              BSMRWG                          WEMRWG
     I              BSOGQT                          WEOGQT
     I              BSMXWG                          WEMXWG
     I              BSOHQT                          WEOHQT
     I              BSMSWG                          WEMSWG
     I              BSOWQT                          WEOWQT
     I              BSNAWG                          WENAWG
     I              BSOIQT                          WEOIQT
     I              BSMTWG                          WEMTWG
     I              BSOJQT                          WEOJQT
     I              BSMUWG                          WEMUWG
     I              BSOKQT                          WEOKQT
     I              BSMVWG                          WEMVWG
     I              BSOLQT                          WEOLQT
     I              BSMWWG                          WEMWWG
     I              BSFQVL                          WEFQVL
     I              BSOMQT                          WEOMQT
     I              BSMYWG                          WEMYWG
     I              BSONQT                          WEONQT
     I              BSMZWG                          WEMZWG
     I              BSOOQT                          WEOOQT
     I              BSM0WG                          WEM0WG
     I              BSDGVN                          WEDGVN
     I              BSP9DT                          WEP9DT
     I              BSCTTM                          WECTTM
     I              BSOPQT                          WEOPQT
     I              BSM1WG                          WEM1WG
     I              BSOQQT                          WEOQQT
     I              BSM2WG                          WEM2WG
     I              BSORQT                          WEORQT
     I              BSM3WG                          WEM3WG
     I              BSOSQT                          WEOSQT
     I              BSM4WG                          WEM4WG
     I              BSRCNA                          WERCNA
     I              BSDFVN                          WEDFVN
     I              BSP8DT                          WEP8DT
     I              BSCSTM                          WECSTM
     I              BSOTQT                          WEOTQT
     I              BSM5WG                          WEM5WG
     I              BSF4PR                          WEF4PR
     I              BSWBSX                          WEWBSX
     I              BSWNSX                          WEWNSX
     I              BSWOSX                          WEWOSX
     I              BSOUQT                          WEOUQT
     I              BSM6WG                          WEM6WG
     I              BSOVQT                          WEOVQT
     I              BSM7WG                          WEM7WG
     I              BSWCSX                          WEWCSX
     I              BSQADT                          WEQADT
     I              BSWDSX                          WEWDSX
     I              BSVSST                          WEVSST
     I              BSMJDT                          WEMJDT
     I              BSBETM                          WEBETM
     I              BSCCVN                          WECCVN
     I              BSCDVN                          WECDVN
     I              BSMKDT                          WEMKDT
     I              BSBFTM                          WEBFTM
     I              BSCEVN                          WECEVN
     I              BSCFVN                          WECFVN
      *
     I@ALCPJB
      * WF ISC Trans Sum/Pkg Var  Update index
      * Renamed input format fields
     I              ALAIDX                          WFAIDX
     I              ALB2C3                          WFB2C3
     I              ALGRAA                          WFGRAA
     I              ALEJC7                          WFEJC7
     I              ALMQWG                          WFMQWG
     I              ALM5WG                          WFM5WG
     I              ALOEQT                          WFOEQT
     I              ALOTQT                          WFOTQT
     I              ALM2WG                          WFM2WG
     I              ALOQQT                          WFOQQT
     I              ALM1WG                          WFM1WG
     I              ALOPQT                          WFOPQT
     I              ALNOWG                          WFNOWG
     I              ALOYQT                          WFOYQT
     I              ALNPWG                          WFNPWG
     I              ALOZQT                          WFOZQT
     I              ALNQWG                          WFNQWG
     I              ALNRWG                          WFNRWG
     I              ALNSWG                          WFNSWG
     I              ALNTWG                          WFNTWG
     I              ALNUWG                          WFNUWG
     I              ALNVWG                          WFNVWG
     I              ALO4QT                          WFO4QT
     I              ALO0QT                          WFO0QT
     I              ALO5QT                          WFO5QT
     I              ALO1QT                          WFO1QT
     I              ALO2QT                          WFO2QT
     I              ALO3QT                          WFO3QT
     I              ALNWWG                          WFNWWG
     I              ALO6QT                          WFO6QT
     I              ALNXWG                          WFNXWG
     I              ALO7QT                          WFO7QT
     I              ALNYWG                          WFNYWG
     I              ALO8QT                          WFO8QT
     I              ALNZWG                          WFNZWG
     I              ALO9QT                          WFO9QT
     I              ALN0WG                          WFN0WG
     I              ALPAQT                          WFPAQT
     I              ALN1WG                          WFN1WG
     I              ALPBQT                          WFPBQT
     I              ALN2WG                          WFN2WG
     I              ALPCQT                          WFPCQT
     I              ALN3WG                          WFN3WG
     I              ALPDQT                          WFPDQT
     I              ALN4WG                          WFN4WG
     I              ALPEQT                          WFPEQT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMAL1    E DSPMALCPL0
      * UPD : WF ISC Trans Sum/Pkg Var  Update index
      * Renamed input format fields
     I              ALAIDX                          WFAIDX
     I              ALB2C3                          WFB2C3
     I              ALGRAA                          WFGRAA
     I              ALEJC7                          WFEJC7
     I              ALMQWG                          WFMQWG
     I              ALM5WG                          WFM5WG
     I              ALOEQT                          WFOEQT
     I              ALOTQT                          WFOTQT
     I              ALM2WG                          WFM2WG
     I              ALOQQT                          WFOQQT
     I              ALM1WG                          WFM1WG
     I              ALOPQT                          WFOPQT
     I              ALNOWG                          WFNOWG
     I              ALOYQT                          WFOYQT
     I              ALNPWG                          WFNPWG
     I              ALOZQT                          WFOZQT
     I              ALNQWG                          WFNQWG
     I              ALNRWG                          WFNRWG
     I              ALNSWG                          WFNSWG
     I              ALNTWG                          WFNTWG
     I              ALNUWG                          WFNUWG
     I              ALNVWG                          WFNVWG
     I              ALO4QT                          WFO4QT
     I              ALO0QT                          WFO0QT
     I              ALO5QT                          WFO5QT
     I              ALO1QT                          WFO1QT
     I              ALO2QT                          WFO2QT
     I              ALO3QT                          WFO3QT
     I              ALNWWG                          WFNWWG
     I              ALO6QT                          WFO6QT
     I              ALNXWG                          WFNXWG
     I              ALO7QT                          WFO7QT
     I              ALNYWG                          WFNYWG
     I              ALO8QT                          WFO8QT
     I              ALNZWG                          WFNZWG
     I              ALO9QT                          WFO9QT
     I              ALN0WG                          WFN0WG
     I              ALPAQT                          WFPAQT
     I              ALN1WG                          WFN1WG
     I              ALPBQT                          WFPBQT
     I              ALN2WG                          WFN2WG
     I              ALPCQT                          WFPCQT
     I              ALN3WG                          WFN3WG
     I              ALPDQT                          WFPDQT
     I              ALN4WG                          WFN4WG
     I              ALPEQT                          WFPEQT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: WF ISC Trans Detail Total
      * I :  ISC Week Ending Date
     I                                    P   1   50P1AIDX
      * I :  ISC Warehouse Company
     I                                    P   6   70P1B2C3
      * I :  ISC Warehouse Code
     I                                        8  10 P1GRAA
     IP2PARM      DS
      * I :  Status - Y or N
     I                                        1   1 P2B8ST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIDX    PARM           WP0001  80       ISC Week Ending
     C           P1B2C3    PARM           WP0002  30       ISC Warehouse C
     C           P1GRAA    PARM           WP0003  3        ISC Warehouse C
     C           P2B8ST    PARM           WP0004  1        Status - Y or N
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt Missing Items XF
      * FP1100
      * If an item didnt have Trans for the week but has ISC, create the
      * Rtv Crt Missing WfISC RT - Inventory Stock Closing  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Crt Missing WfISC RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIDX    WQSA01           ISC Week Ending
     C           *LIKE     DEFN WAB2C3    WQSA02           ISC Warehouse C
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           ISC Week Ending
     C                     KFLD           WQSA02           ISC Warehouse C
      * Setup key
     C                     Z-ADDP1AIDX    WQSA01           ISC Week Ending
     C                     Z-ADDP1B2C3    WQSA02           ISC Warehouse C
      * Establish starting position
     C           KRSSA     SETLL@BSCPJ7                    *
     C           KRSSA     READE@BSCPJ7                  90*
      * Data record not found
     C   90                MOVEL'USR3529' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.ISC Warehouse Code is Warehouse Code Blank
      *   |- c2    : DB1.ISC Warehouse Code EQ PAR.ISC Warehouse Code
      *   '-
     C           P1GRAA    IFEQ *BLANK                     *IF
     C           WAGRAA    OREQ P1GRAA                     *OR
      * CASE: PAR.Status - Y or N is Not Yes
     C           P2B8ST    IFEQ *BLANK                     *IF
     C           P2B8ST    OREQ 'N'
     C                     MOVELWAGRAA    YL0001           ISC Warehouse C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1GRAA    YL0001           ISC Warehouse C
     C                     END                             *FI
      * Rtv Chg/Crt ISC TranSm RT - WF ISC Trans Sum/Pkg Var  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAAIDX    WL0001           ISC Week Ending
     C                     Z-ADDWAB2C3    WL0002           ISC Warehouse C
     C                     MOVELYL0001    WL0003    P      ISC Warehouse C
     C                     Z-ADDWAEJC7    WL0004           ISC Item Code
     C                     Z-ADD0         WL0005           WF Trans Total
     C                     Z-ADD0         WL0006           WF Trans total
     C                     Z-ADD0         WL0007           WF Trans Total
     C                     Z-ADD0         WL0008           WF Trans total
     C                     Z-ADD0         WL0009           WF Trans Total
     C                     Z-ADD0         WL0010           WF Trans total
     C                     Z-ADD0         WL0011           WF Trans Total
     C                     Z-ADD0         WL0012           WF Trans Total
     C                     Z-ADD0         WL0013           WF Trans total
     C                     Z-ADD0         WL0014           WF Trans total
     C                     Z-ADD0         WL0015           WF Trans Total
     C                     Z-ADD0         WL0016           WF Trans total
     C                     Z-ADD0         WL0017           WF Trans Total
     C                     Z-ADD0         WL0018           WF Trans Total
     C                     Z-ADD0         WL0019           WF Trans Total
     C                     Z-ADD0         WL0020           WF Trans Total
     C                     MOVELP2B8ST    WL0021    P      Status - Y or N
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@BSCPJ7                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Chg/Crt ISC TranSm RT - WF ISC Trans Sum/Pkg Var  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 112       ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WN0002 112       ISC End Inv Fin
     C                     Z-ADD*ZERO     WN0003 112       ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WN0004 112       ISC End Inv Fin
     C                     Z-ADD*ZERO     WN0005 112       ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0006 112       ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0007 112       ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0008 112       ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0009 112       WF Estimated En
     C                     Z-ADD*ZERO     WN0010 112       WF Estimated En
     C                     Z-ADD*ZERO     WN0011 112       WF ISC Part/Rej
     C                     Z-ADD*ZERO     WN0012 112       WF ISC Part/Rej
     C                     Z-ADD*ZERO     WN0013 112       WF ISC Floor Pr
     C                     Z-ADD*ZERO     WN0014 112       WF ISC Floor Pr
     C                     Z-ADD*ZERO     WN0015 112       WF ISC Part/Rej
     C                     Z-ADD*ZERO     WN0016 112       WF ISC Part/Rej
     C                     Z-ADD*ZERO     WN0017 112       WF ISC End Inv
     C                     Z-ADD*ZERO     WN0018 112       WF ISC End Inv
     C                     Z-ADD*ZERO     WN0019 112       WF Lst End Inv
     C                     Z-ADD*ZERO     WN0020 112       WF Lst End Inv
     C                     Z-ADD*ZERO     WN0021 112       WF Lst Sun Shp
     C                     Z-ADD*ZERO     WN0022 112       WF Lst Sun Shp
     C                     Z-ADD*ZERO     WN0023 112       WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WN0024 112       WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WN0025  70       Weight Sales us
     C                     Z-ADD*ZERO     WN0026  70       Weight End Inv
     C                     Z-ADD*ZERO     WN0027  70       Weight Prod usr
     C                     Z-ADD*ZERO     WN0028  70       Weight Beg Inv
     C                     Z-ADD*ZERO     WN0029  70       Weight Profit/l
     C                     Z-ADD*ZERO     WN0030  80       Last Week Endin
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RMC Rtv Prior week ending date to get ISC Lst End Inv Adj
      * R9083 06/26/17 DN-Update date conversion due to Synon version dif
     C                     Z-ADDWL0001    YL0002           Date Out (8,0)
     C                     MOVELYL0002    WUGWT1           Date (Char-8) U
     C                     Z-ADD6         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUGWT1:ZQ WUT7TX    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZEROS    ZQ      50
     C           '1'       CAT  WUT7TX:ZQ WUR4TX    P      Date (Alpha) US
     C                     MOVE WUR4TX    WUMADT           To Date
      * Rtv Prior Saturday    RT - Calendar  * 
     C                     EXSR SCRVGN
     C                     MOVEL*BLANK    WUR4TX           Date (Alpha) US
     C                     MOVELWUKDDT    WUR4TX           Date (Alpha) US
     C                     Z-ADD6         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUR4TX:ZQ WUT7TX    P  90  Date (Char-6) U
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           '20'      CAT  WUT7TX:ZQ YL0004    P      Date (Char-8) U
     C                     MOVE YL0004    WN0030           Last Week Endin
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIDX           ISC Week Ending
     C                     KFLD           WBB2C3           ISC Warehouse C
     C                     KFLD           WBGRAA           ISC Warehouse C
     C                     KFLD           WBEJC7           ISC Item Code
      * Setup key
     C                     Z-ADDWL0001    WBAIDX           ISC Week Ending
     C                     Z-ADDWL0002    WBB2C3           ISC Warehouse C
     C                     MOVELWL0003    WBGRAA           ISC Warehouse C
     C                     Z-ADDWL0004    WBEJC7           ISC Item Code
      * Establish starting position
     C           KRSSB     CHAIN@ALCPJC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3695' W0RTN   7
      * USER: Processing if Data record not found
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.ISC Warehouse Code is Warehouse Code not Blank
      *   |- c2    : PAR.Status - Y or N is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0003    IFNE *BLANK                     *IF
     C           WL0021    IFEQ *BLANK                     *IF
     C           WL0021    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv for WF ISC Dwnld  RT - Inventory Stock Closing  * 
     C                     EXSR SDRVGN
      * Rtv Last Week End Inv RT - Inventory Stock Closing  * 
     C                     EXSR SERVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Combine Warehouses
      * Rtv for WF ISC DwnCMB RT - Inventory Stock Closing  * 
     C                     EXSR SFRVGN
      * Rtv Last Week EndI-CM RT - Inventory Stock Closing  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
      * RMC take WF ISC Floor Prod Adj Lbs off of compute.theyre in the "
      * RMC add this week's WF ISC End Inv Adj & last week's-rev sign of
     C           0         SUB  WN0019    WN0019           WF Lst End Inv
     C           0         SUB  WN0020    WN0020           WF Lst End Inv
     C           0         SUB  WN0021    WN0021           WF Lst Sun Shp
     C           0         SUB  WN0022    WN0022           WF Lst Sun Shp
     C           0         SUB  WN0023    WN0023           WF Lst Unsh/Shi
     C           0         SUB  WN0024    WN0024           WF Lst Unsh/Shi
     C           0         SUB  WN0011    WN0011           WF ISC Part/Rej
     C           0         SUB  WN0012    WN0012           WF ISC Part/Rej
      * Compute:Est End Inv Lbs
      * PAR.WF Estimated End Inv Lbs =
      *    *COMPUTE (x1 + x2 +x3 +x4 +x5 +x6 +x7+x8+x9+x10+x11+x12+x13+x
      *    14+x15)
      * x1    : PAR.ISC Beg Inv Final Lbs
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.WF Trans Total type A
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.WF Trans total Type AW
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.WF Trans Total type AP
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.WF Trans Total type RR
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.WF Trans total Type TW
      * +     : PGM.*Synon (17,7) work field
      * x7    : PAR.WF Trans total Type IO
      * +     : PGM.*Synon (17,7) work field
      * x8    : PAR.WF ISC End Inv Adj Lbs
      * +     : PGM.*Synon (17,7) work field
      * x9    : PAR.WF Lst End Inv Adj Lbs
      * +     : PGM.*Synon (17,7) work field
      * x10   : PAR.WF ISC Part/Rej Curr Lbs
      * +     : PGM.*Synon (17,7) work field
      * x11   : PAR.WF ISC Part/Rej Last Lbs
      * +     : PGM.*Synon (17,7) work field
      * x12   : PAR.WF Lst Unsh/Ship Inv Lbs
      * +     : PGM.*Synon (17,7) work field
      * x13   : PAR.WF Lst Sun Shp Inv Adj Lb
      * +     : PGM.*Synon (17,7) work field
      * x14   : PAR.ISC Unsh/Ship Inv Adj Lbs
      * +     : PGM.*Synon (17,7) work field
      * x15   : PAR.ISC Sun Shp Inv Adj Lbs
     C           WN0001    ADD  WL0005    W0WD13           *Synon (17,7) w
     C           W0WD13    ADD  WL0006    W0WD12           *Synon (17,7) w
     C           W0WD12    ADD  WL0007    W0WD11           *Synon (17,7) w
     C           W0WD11    ADD  WL0009    W0WD10           *Synon (17,7) w
     C           W0WD10    ADD  WL0010    W0WD09           *Synon (17,7) w
     C           W0WD09    ADD  WL0008    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  WN0017    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  WN0019    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  WN0015    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  WN0011    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  WN0023    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  WN0021    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  WN0005    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WN0007    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0009           WF Estimated En
      * Compute:Est End Inv Qty
      * PAR.WF Estimated End Inv Qty =
      *    *COMPUTE (x1 + x2 +x3 +x4 +x5 +x6 +x7+x8+x9 +x10+x11+x12+x13+
      *    x14+x15)
      * x1    : PAR.ISC Beg Inv Final Qty
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.WF Trans Total type A qty
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.WF Trans total Type AW qt
      * +     : PGM.*Synon (17,7) work field
      * x4    : PAR.WF Trans Total type AP qt
      * +     : PGM.*Synon (17,7) work field
      * x5    : PAR.WF Trans Total type RR qt
      * +     : PGM.*Synon (17,7) work field
      * x6    : PAR.WF Trans total Type TW qt
      * +     : PGM.*Synon (17,7) work field
      * x7    : PAR.WF Trans total Type IO qt
      * +     : PGM.*Synon (17,7) work field
      * x8    : PAR.WF ISC End Inv Adj Qty
      * +     : PGM.*Synon (17,7) work field
      * x9    : PAR.WF Lst End Inv Adj Qty
      * +     : PGM.*Synon (17,7) work field
      * x10   : PAR.WF ISC Part/Rej Curr Qty
      * +     : PGM.*Synon (17,7) work field
      * x11   : PAR.WF ISC Part/Rej Last Qty
      * +     : PGM.*Synon (17,7) work field
      * x12   : PAR.WF Lst Sun Shp Inv Adj Qt
      * +     : PGM.*Synon (17,7) work field
      * x13   : PAR.WF Lst Unsh/Ship Inv Qty
      * +     : PGM.*Synon (17,7) work field
      * x14   : PAR.ISC Unsh/Ship Inv Adj Qty
      * +     : PGM.*Synon (17,7) work field
      * x15   : PAR.ISC Sun Shp Inv Adj Qty
     C           WN0003    ADD  WL0012    W0WD13           *Synon (17,7) w
     C           W0WD13    ADD  WL0014    W0WD12           *Synon (17,7) w
     C           W0WD12    ADD  WL0015    W0WD11           *Synon (17,7) w
     C           W0WD11    ADD  WL0011    W0WD10           *Synon (17,7) w
     C           W0WD10    ADD  WL0013    W0WD09           *Synon (17,7) w
     C           W0WD09    ADD  WL0016    W0WD08           *Synon (17,7) w
     C           W0WD08    ADD  WN0018    W0WD07           *Synon (17,7) w
     C           W0WD07    ADD  WN0020    W0WD06           *Synon (17,7) w
     C           W0WD06    ADD  WN0016    W0WD05           *Synon (17,7) w
     C           W0WD05    ADD  WN0012    W0WD04           *Synon (17,7) w
     C           W0WD04    ADD  WN0022    W0WD03           *Synon (17,7) w
     C           W0WD03    ADD  WN0024    W0WD02           *Synon (17,7) w
     C           W0WD02    ADD  WN0006    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WN0008    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0010           WF Estimated En
      * RMC dont calc these two fields 05/16/07
      * Crt WF ISC Trans Sum  CR - WF ISC Trans Sum/Pkg Var  * 
     C                     EXSR SHCRRC
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Prior Saturday    RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       YL0003           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WCBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWL0002    WQSC01           Company Number
     C                     Z-ADDWUMADT    WCBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSC     SETLL@AFREPU                    *
     C           KRSSC     READE@AFREPU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUKDDT           Date Out
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.First Time Flag is Yes
     C           YL0003    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       YL0003           First Time Flag
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Day of Week is Saturday
     C           WCA9ST    IFEQ '7'                        *IF
     C                     Z-ADDWCBCDT    WUKDDT           Date Out
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@AFREPU                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv for WF ISC Dwnld  RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIDX           ISC Week Ending
     C                     KFLD           WDB2C3           ISC Warehouse C
     C                     KFLD           WDGRAA           ISC Warehouse C
     C                     KFLD           WDEJC7           ISC Item Code
      * Setup key
     C                     Z-ADDWL0001    WDAIDX           ISC Week Ending
     C                     Z-ADDWL0002    WDB2C3           ISC Warehouse C
     C                     MOVELWL0003    WDGRAA           ISC Warehouse C
     C                     Z-ADDWL0004    WDEJC7           ISC Item Code
      * Establish starting position
     C           KRSSD     CHAIN@BSCPA6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3529' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0003           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WN0001           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WN0014           ISC Floor Prod
     C                     Z-ADD*ZERO     WN0013           ISC Floor Prod
     C                     Z-ADD*ZERO     WN0008           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0007           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0006           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0005           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0016           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0015           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0018           ISC End Inv Adj
     C                     Z-ADD*ZERO     WN0017           ISC End Inv Adj
     C                     Z-ADD*ZERO     WN0004           ISC End Inv Fin
     C                     Z-ADD*ZERO     WN0002           ISC End Inv Fin
     C                     Z-ADD*ZERO     WN0025           Weight Sales us
     C                     Z-ADD*ZERO     WN0026           Weight End Inv
     C                     Z-ADD*ZERO     WN0027           Weight Prod usr
     C                     Z-ADD*ZERO     WN0028           Weight Beg Inv
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDOEQT    WN0003           ISC Beg Inv Fin
     C                     Z-ADDWDMQWG    WN0001           ISC Beg Inv Fin
     C                     Z-ADDWDOWQT    WN0014           ISC Floor Prod
     C                     Z-ADDWDNAWG    WN0013           ISC Floor Prod
     C                     Z-ADDWDOPQT    WN0008           ISC Sun Shp Inv
     C                     Z-ADDWDM1WG    WN0007           ISC Sun Shp Inv
     C                     Z-ADDWDOQQT    WN0006           ISC Unsh/Ship I
     C                     Z-ADDWDM2WG    WN0005           ISC Unsh/Ship I
     C                     Z-ADDWDORQT    WN0016           ISC End Inv Par
     C                     Z-ADDWDM3WG    WN0015           ISC End Inv Par
     C                     Z-ADDWDOSQT    WN0018           ISC End Inv Adj
     C                     Z-ADDWDM4WG    WN0017           ISC End Inv Adj
     C                     Z-ADDWDOTQT    WN0004           ISC End Inv Fin
     C                     Z-ADDWDM5WG    WN0002           ISC End Inv Fin
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.ISC Item U/M - Pricing is Head Set
      *   |- c2    : DB1.ISC Item U/M - Pricing is Each
      *   '-
     C           WDGTAA    IFEQ 'HS'                       *IF
     C           WDGTAA    OREQ 'EA'                       *OR
      * For Casings -- use qty
      * Compute: qty    sales usr
      * PAR.Weight Sales usr =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Weight Sales usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Shipment Final Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WDOLQT    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0025    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0025           Weight Sales us
      * Compute: qty    End inv
      * PAR.Weight End Inv usr =
      *    *COMPUTE ((x2 * x4)+x1)
      * x2    : DB1.ISC End Inv Final Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
      * +     : PGM.*Synon (15,0) work field
      * x1    : PAR.Weight End Inv usr
     C           WDOTQT    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    ADD  WN0026    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0026           Weight End Inv
      * Compute: Qty    prod usr
      * PAR.Weight Prod usr =
      *    *COMPUTE (x1 + ((x2 + x3) * x4))
      * x1    : PAR.Weight Prod usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Floor Production Qty
      * +     : PGM.*Synon (17,7) work field
      * x3    : DB1.ISC Floor Prod Adj Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
     C           WDOHQT    ADD  WDOWQT    W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0027    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0027           Weight Prod usr
      * Compute: Qty   beg inv us
      * PAR.Weight Beg Inv usr =
      *    *COMPUTE (x1 +( x2 * x3))
      * x1    : PAR.Weight Beg Inv usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Beg Inv Final Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WDOEQT    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0028    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0028           Weight Beg Inv
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: weight sales usr
      * PAR.Weight Sales usr =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Weight Sales usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Shipment Final Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WDMWWG    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0025    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0025           Weight Sales us
      * Compute: weight End inv
      * PAR.Weight End Inv usr =
      *    *COMPUTE ((x2 * x4)+x3)
      * x2    : DB1.ISC End Inv Final Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.Weight End Inv usr
     C           WDM5WG    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    ADD  WN0026    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0026           Weight End Inv
      * Compute: Weight prod usr
      * PAR.Weight Prod usr =
      *    *COMPUTE (x1 + ((x2 + x3) * x4))
      * x1    : PAR.Weight Prod usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Floor Production Lbs
      * +     : PGM.*Synon (17,7) work field
      * x3    : DB1.ISC Floor Prod Adj Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
     C           WDMSWG    ADD  WDNAWG    W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0027    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0027           Weight Prod usr
      * Compute weight beg inv us
      * PAR.Weight Beg Inv usr =
      *    *COMPUTE (x1 +( x2 * x3))
      * x1    : PAR.Weight Beg Inv usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Beg Inv Final Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WDMQWG    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0028    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0028           Weight Beg Inv
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Last Week End Inv RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIDX           ISC Week Ending
     C                     KFLD           WDB2C3           ISC Warehouse C
     C                     KFLD           WDGRAA           ISC Warehouse C
     C                     KFLD           WDEJC7           ISC Item Code
      * Setup key
     C                     Z-ADDWN0030    WDAIDX           ISC Week Ending
     C                     Z-ADDWL0002    WDB2C3           ISC Warehouse C
     C                     MOVELWL0003    WDGRAA           ISC Warehouse C
     C                     Z-ADDWL0004    WDEJC7           ISC Item Code
      * Establish starting position
     C           KRSSE     CHAIN@BSCPA6              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3529' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0022           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0021           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0024           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0023           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0012           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0011           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0020           ISC End Inv Adj
     C                     Z-ADD*ZERO     WN0019           ISC End Inv Adj
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDOPQT    WN0022           ISC Sun Shp Inv
     C                     Z-ADDWDM1WG    WN0021           ISC Sun Shp Inv
     C                     Z-ADDWDOQQT    WN0024           ISC Unsh/Ship I
     C                     Z-ADDWDM2WG    WN0023           ISC Unsh/Ship I
     C                     Z-ADDWDORQT    WN0012           ISC End Inv Par
     C                     Z-ADDWDM3WG    WN0011           ISC End Inv Par
     C                     Z-ADDWDOSQT    WN0020           ISC End Inv Adj
     C                     Z-ADDWDM4WG    WN0019           ISC End Inv Adj
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv for WF ISC DwnCMB RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0001           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WN0002           ISC End Inv Fin
     C                     Z-ADD*ZERO     WN0003           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WN0004           ISC End Inv Fin
     C                     Z-ADD*ZERO     WN0005           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0006           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0007           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0008           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0013           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WN0014           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WN0015           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WN0016           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WN0017           WF ISC End Inv
     C                     Z-ADD*ZERO     WN0018           WF ISC End Inv
     C                     Z-ADD*ZERO     WN0025           Weight Sales us
     C                     Z-ADD*ZERO     WN0026           Weight End Inv
     C                     Z-ADD*ZERO     WN0027           Weight Prod usr
     C                     Z-ADD*ZERO     WN0028           Weight Beg Inv
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIDX    WQSF01           ISC Week Ending
     C           *LIKE     DEFN WEEJC7    WQSF02           ISC Item Code
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           ISC Week Ending
     C                     KFLD           WQSF02           ISC Item Code
      * Setup key
     C                     Z-ADDWL0001    WQSF01           ISC Week Ending
     C                     Z-ADDWL0004    WQSF02           ISC Item Code
      * Establish starting position
     C           KRSSF     SETLL@BSCPBJ                    *
     C           KRSSF     READE@BSCPBJ                  90*
      * Data record not found
     C   90                MOVEL'USR3529' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.ISC Warehouse Company EQ PAR.ISC Warehouse Company
     C           WEB2C3    IFEQ WL0002                     *IF
     C                     ADD  WEMQWG    WN0001           ISC Beg Inv Fin
     C                     ADD  WEOEQT    WN0003           ISC Beg Inv Fin
     C                     ADD  WEM5WG    WN0002           ISC End Inv Fin
     C                     ADD  WEOTQT    WN0004           ISC End Inv Fin
     C                     ADD  WEM2WG    WN0005           ISC Unsh/Ship I
     C                     ADD  WEOQQT    WN0006           ISC Unsh/Ship I
     C                     ADD  WEM1WG    WN0007           ISC Sun Shp Inv
     C                     ADD  WEM1WG    WN0008           ISC Sun Shp Inv
     C                     ADD  WENAWG    WN0013           WF ISC Floor Pr
     C                     ADD  WEOWQT    WN0014           WF ISC Floor Pr
     C                     ADD  WEM4WG    WN0017           WF ISC End Inv
     C                     ADD  WEOSQT    WN0018           WF ISC End Inv
     C                     ADD  WEM3WG    WN0015           WF ISC Part/Rej
     C                     ADD  WEORQT    WN0016           WF ISC Part/Rej
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.ISC Item U/M - Pricing is Head Set
      *   |- c2    : DB1.ISC Item U/M - Pricing is Each
      *   '-
     C           WEGTAA    IFEQ 'HS'                       *IF
     C           WEGTAA    OREQ 'EA'                       *OR
      * For Casings -- use qty
      * Compute: qty    sales usr
      * PAR.Weight Sales usr =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Weight Sales usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Shipment Final Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WEOLQT    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0025    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0025           Weight Sales us
      * Compute: qty    End inv
      * PAR.Weight End Inv usr =
      *    *COMPUTE ((x2 * x4)+x1)
      * x2    : DB1.ISC End Inv Final Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
      * +     : PGM.*Synon (15,0) work field
      * x1    : PAR.Weight End Inv usr
     C           WEOTQT    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    ADD  WN0026    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0026           Weight End Inv
      * Compute: Qty    prod usr
      * PAR.Weight Prod usr =
      *    *COMPUTE (x1 + ((x2 + x3) * x4))
      * x1    : PAR.Weight Prod usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Floor Production Qty
      * +     : PGM.*Synon (17,7) work field
      * x3    : DB1.ISC Floor Prod Adj Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
     C           WEOHQT    ADD  WEOWQT    W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0027    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0027           Weight Prod usr
      * Compute: Qty   beg inv us
      * PAR.Weight Beg Inv usr =
      *    *COMPUTE (x1 +( x2 * x3))
      * x1    : PAR.Weight Beg Inv usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Beg Inv Final Qty
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WEOEQT    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0028    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0028           Weight Beg Inv
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute: weight sales usr
      * PAR.Weight Sales usr =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Weight Sales usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Shipment Final Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WEMWWG    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0025    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0025           Weight Sales us
      * Compute: weight End inv
      * PAR.Weight End Inv usr =
      *    *COMPUTE ((x2 * x4)+x3)
      * x2    : DB1.ISC End Inv Final Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
      * +     : PGM.*Synon (15,0) work field
      * x3    : PAR.Weight End Inv usr
     C           WEM5WG    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           W0WJ01    ADD  WN0026    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0026           Weight End Inv
      * Compute: Weight prod usr
      * PAR.Weight Prod usr =
      *    *COMPUTE (x1 + ((x2 + x3) * x4))
      * x1    : PAR.Weight Prod usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Floor Production Lbs
      * +     : PGM.*Synon (17,7) work field
      * x3    : DB1.ISC Floor Prod Adj Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x4    : CON.1
     C           WEMSWG    ADD  WENAWG    W0WD02           *Synon (17,7) w
     C           W0WD02    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0027    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0027           Weight Prod usr
      * Compute weight beg inv us
      * PAR.Weight Beg Inv usr =
      *    *COMPUTE (x1 +( x2 * x3))
      * x1    : PAR.Weight Beg Inv usr
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.ISC Beg Inv Final Lbs
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : CON.1
     C           WEMQWG    MULT 1         W0WJ01    H      *Synon (15,0) w
     C           WN0028    ADD  W0WJ01    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0028           Weight Beg Inv
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BSCPBJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Last Week EndI-CM RT - Inventory Stock Closing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0022           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0021           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0024           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0023           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0012           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0011           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0020           ISC End Inv Adj
     C                     Z-ADD*ZERO     WN0019           ISC End Inv Adj
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIDX    WQSG01           ISC Week Ending
     C           *LIKE     DEFN WEEJC7    WQSG02           ISC Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           ISC Week Ending
     C                     KFLD           WQSG02           ISC Item Code
      * Setup key
     C                     Z-ADDWN0030    WQSG01           ISC Week Ending
     C                     Z-ADDWL0004    WQSG02           ISC Item Code
      * Establish starting position
     C           KRSSG     SETLL@BSCPBJ                    *
     C           KRSSG     READE@BSCPBJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3529' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0022           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0021           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WN0024           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0023           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WN0012           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0011           ISC End Inv Par
     C                     Z-ADD*ZERO     WN0020           ISC End Inv Adj
     C                     Z-ADD*ZERO     WN0019           ISC End Inv Adj
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.ISC Warehouse Company EQ DB1.ISC Warehouse Company
     C           WL0002    IFEQ WEB2C3                     *IF
     C                     ADD  WEM4WG    WN0019           ISC End Inv Adj
     C                     ADD  WEOSQT    WN0020           ISC End Inv Adj
     C                     ADD  WEM3WG    WN0011           ISC End Inv Par
     C                     ADD  WEORQT    WN0012           ISC End Inv Par
     C                     ADD  WEOPQT    WN0022           ISC Sun Shp Inv
     C                     ADD  WEM1WG    WN0021           ISC Sun Shp Inv
     C                     ADD  WEOQQT    WN0024           ISC Unsh/Ship I
     C                     ADD  WEM2WG    WN0023           ISC Unsh/Ship I
     C                     END                             *FI
     C           KRSSG     READE@BSCPBJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt WF ISC Trans Sum  CR - WF ISC Trans Sum/Pkg Var  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ALCPJB
     C                     Z-ADDWL0001    WFAIDX           ISC Week Ending
     C                     Z-ADDWL0002    WFB2C3           ISC Warehouse C
     C                     MOVELWL0003    WFGRAA           ISC Warehouse C
     C                     Z-ADDWL0004    WFEJC7           ISC Item Code
     C                     Z-ADDWN0001    WFMQWG           ISC Beg Inv Fin
     C                     Z-ADDWN0002    WFM5WG           ISC End Inv Fin
     C                     Z-ADDWN0003    WFOEQT           ISC Beg Inv Fin
     C                     Z-ADDWN0004    WFOTQT           ISC End Inv Fin
     C                     Z-ADDWN0005    WFM2WG           ISC Unsh/Ship I
     C                     Z-ADDWN0006    WFOQQT           ISC Unsh/Ship I
     C                     Z-ADDWN0007    WFM1WG           ISC Sun Shp Inv
     C                     Z-ADDWN0008    WFOPQT           ISC Sun Shp Inv
     C                     Z-ADDWN0009    WFNOWG           WF Estimated En
     C                     Z-ADDWN0010    WFOYQT           WF Estimated En
     C                     Z-ADDWN0011    WFNPWG           WF ISC Part/Rej
     C                     Z-ADDWN0012    WFOZQT           WF ISC Part/Rej
     C                     Z-ADDWL0005    WFNQWG           WF Trans Total
     C                     Z-ADDWL0006    WFNRWG           WF Trans total
     C                     Z-ADDWL0007    WFNSWG           WF Trans Total
     C                     Z-ADDWL0008    WFNTWG           WF Trans total
     C                     Z-ADDWL0009    WFNUWG           WF Trans Total
     C                     Z-ADDWL0010    WFNVWG           WF Trans total
     C                     Z-ADDWL0011    WFO4QT           WF Trans Total
     C                     Z-ADDWL0012    WFO0QT           WF Trans Total
     C                     Z-ADDWL0013    WFO5QT           WF Trans total
     C                     Z-ADDWL0014    WFO1QT           WF Trans total
     C                     Z-ADDWL0015    WFO2QT           WF Trans Total
     C                     Z-ADDWL0016    WFO3QT           WF Trans total
     C                     Z-ADDWN0013    WFNWWG           WF ISC Floor Pr
     C                     Z-ADDWN0014    WFO6QT           WF ISC Floor Pr
     C                     Z-ADDWN0015    WFNXWG           WF ISC Part/Rej
     C                     Z-ADDWN0016    WFO7QT           WF ISC Part/Rej
     C                     Z-ADDWN0017    WFNYWG           WF ISC End Inv
     C                     Z-ADDWN0018    WFO8QT           WF ISC End Inv
     C                     Z-ADDWN0019    WFNZWG           WF Lst End Inv
     C                     Z-ADDWN0020    WFO9QT           WF Lst End Inv
     C                     Z-ADDWN0021    WFN0WG           WF Lst Sun Shp
     C                     Z-ADDWN0022    WFPAQT           WF Lst Sun Shp
     C                     Z-ADDWN0023    WFN1WG           WF Lst Unsh/Shi
     C                     Z-ADDWN0024    WFPBQT           WF Lst Unsh/Shi
     C                     Z-ADDWL0017    WFN2WG           WF Trans Total
     C                     Z-ADDWL0018    WFPCQT           WF Trans Total
     C                     Z-ADDWL0019    WFN3WG           WF Trans Total
     C                     Z-ADDWL0020    WFPDQT           WF Trans Total
     C                     Z-ADD0         WFN4WG           WF Unused Lbs 3
     C                     Z-ADD0         WFPEQT           WF Unused Qty 3
      *
     C           KLCRSH    KLIST
     C                     KFLD           WFAIDX           ISC Week Ending
     C                     KFLD           WFB2C3           ISC Warehouse C
     C                     KFLD           WFGRAA           ISC Warehouse C
     C                     KFLD           WFEJC7           ISC Item Code
      * Check for duplicate primary key
     C           KLCRSH    SETLL@ALCPJB                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3696' W0RTN   7
      * Send message 'WF ISC Trans Sum/Pkg V EX'
     C                     MOVEL'USR3696' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@ALCPJB                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIDX           ISC Week Ending
     C                     Z-ADD*ZERO     WAB2C3           ISC Warehouse C
     C                     Z-ADD*ZERO     WAEJC7           ISC Item Code
     C                     Z-ADD*ZERO     WAF3PR           ISC Item Market
     C                     Z-ADD*ZERO     WABSNY           ISC Item Struct
     C                     Z-ADD*ZERO     WABTNY           ISC Item Struct
     C                     Z-ADD*ZERO     WABUNY           ISC Item Struct
     C                     Z-ADD*ZERO     WAOEQT           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WAMQWG           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WAOFQT           ISC Beg Inv Adj
     C                     Z-ADD*ZERO     WAMRWG           ISC Beg Inv Adj
     C                     Z-ADD*ZERO     WAOGQT           ISC Beg Inv Qty
     C                     Z-ADD*ZERO     WAMXWG           ISC Beg Inv Lbs
     C                     Z-ADD*ZERO     WAOHQT           ISC Floor Produ
     C                     Z-ADD*ZERO     WAMSWG           ISC Floor Produ
     C                     Z-ADD*ZERO     WAOWQT           ISC Floor Prod
     C                     Z-ADD*ZERO     WANAWG           ISC Floor Prod
     C                     Z-ADD*ZERO     WAOIQT           ISC Sales Produ
     C                     Z-ADD*ZERO     WAMTWG           ISC Sales Produ
     C                     Z-ADD*ZERO     WAOJQT           ISC Inventory S
     C                     Z-ADD*ZERO     WAMUWG           ISC Inventory S
     C                     Z-ADD*ZERO     WAOKQT           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WAMVWG           ISC Ord Dtl Shi
     C                     Z-ADD*ZERO     WAOLQT           ISC Shipment Fi
     C                     Z-ADD*ZERO     WAMWWG           ISC Shipment Fi
     C                     Z-ADD*ZERO     WAFQVL           ISC FOB Gross A
     C                     Z-ADD*ZERO     WAOMQT           ISC Inventory T
     C                     Z-ADD*ZERO     WAMYWG           ISC Inventory T
     C                     Z-ADD*ZERO     WAONQT           ISC Misc Invntr
     C                     Z-ADD*ZERO     WAMZWG           ISC Misc Invntr
     C                     Z-ADD*ZERO     WAOOQT           ISC Ending Inve
     C                     Z-ADD*ZERO     WAM0WG           ISC Ending Inve
     C                     Z-ADD*ZERO     WAP9DT           ISC End Inv Dat
     C                     Z-ADD*ZERO     WACTTM           ISC End Inv Tim
     C                     Z-ADD*ZERO     WAOPQT           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WAM1WG           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WAOQQT           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WAM2WG           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WAORQT           ISC End Inv Par
     C                     Z-ADD*ZERO     WAM3WG           ISC End Inv Par
     C                     Z-ADD*ZERO     WAOSQT           ISC End Inv Adj
     C                     Z-ADD*ZERO     WAM4WG           ISC End Inv Adj
     C                     Z-ADD*ZERO     WAP8DT           ISC Ending Inv
     C                     Z-ADD*ZERO     WACSTM           ISC Ending Inv
     C                     Z-ADD*ZERO     WAOTQT           ISC End Inv Fin
     C                     Z-ADD*ZERO     WAM5WG           ISC End Inv Fin
     C                     Z-ADD*ZERO     WAF4PR           ISC Warehouse P
     C                     Z-ADD*ZERO     WAOUQT           ISC Commission
     C                     Z-ADD*ZERO     WAM6WG           ISC Unused Lbs
     C                     Z-ADD*ZERO     WAOVQT           ISC TF Exempt N
     C                     Z-ADD*ZERO     WAM7WG           ISC TF Exempt L
     C                     Z-ADD*ZERO     WAQADT           ISC Unused Date
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIDX           ISC Week Ending
     C                     Z-ADD*ZERO     WBB2C3           ISC Warehouse C
     C                     Z-ADD*ZERO     WBEJC7           ISC Item Code
     C                     Z-ADD*ZERO     WBMQWG           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WBM5WG           ISC End Inv Fin
     C                     Z-ADD*ZERO     WBOEQT           ISC Beg Inv Fin
     C                     Z-ADD*ZERO     WBOTQT           ISC End Inv Fin
     C                     Z-ADD*ZERO     WBM2WG           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WBOQQT           ISC Unsh/Ship I
     C                     Z-ADD*ZERO     WBM1WG           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WBOPQT           ISC Sun Shp Inv
     C                     Z-ADD*ZERO     WBNOWG           WF Estimated En
     C                     Z-ADD*ZERO     WBOYQT           WF Estimated En
     C                     Z-ADD*ZERO     WBNPWG           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WBOZQT           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WBNQWG           WF Trans Total
     C                     Z-ADD*ZERO     WBNRWG           WF Trans total
     C                     Z-ADD*ZERO     WBNSWG           WF Trans Total
     C                     Z-ADD*ZERO     WBNTWG           WF Trans total
     C                     Z-ADD*ZERO     WBNUWG           WF Trans Total
     C                     Z-ADD*ZERO     WBNVWG           WF Trans total
     C                     Z-ADD*ZERO     WBO4QT           WF Trans Total
     C                     Z-ADD*ZERO     WBO0QT           WF Trans Total
     C                     Z-ADD*ZERO     WBO5QT           WF Trans total
     C                     Z-ADD*ZERO     WBO1QT           WF Trans total
     C                     Z-ADD*ZERO     WBO2QT           WF Trans Total
     C                     Z-ADD*ZERO     WBO3QT           WF Trans total
     C                     Z-ADD*ZERO     WBNWWG           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WBO6QT           WF ISC Floor Pr
     C                     Z-ADD*ZERO     WBNXWG           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WBO7QT           WF ISC Part/Rej
     C                     Z-ADD*ZERO     WBNYWG           WF ISC End Inv
     C                     Z-ADD*ZERO     WBO8QT           WF ISC End Inv
     C                     Z-ADD*ZERO     WBNZWG           WF Lst End Inv
     C                     Z-ADD*ZERO     WBO9QT           WF Lst End Inv
     C                     Z-ADD*ZERO     WBN0WG           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WBPAQT           WF Lst Sun Shp
     C                     Z-ADD*ZERO     WBN1WG           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WBPBQT           WF Lst Unsh/Shi
     C                     Z-ADD*ZERO     WBN2WG           WF Trans Total
     C                     Z-ADD*ZERO     WBPCQT           WF Trans Total
     C                     Z-ADD*ZERO     WBN3WG           WF Trans Total
     C                     Z-ADD*ZERO     WBPDQT           WF Trans Total
     C                     Z-ADD*ZERO     WBN4WG           WF Unused Lbs 3
     C                     Z-ADD*ZERO     WBPEQT           WF Unused Qty 3
      * Define work field Date (Char-8) USR
     C                     MOVEL*BLANK    WUGWT1  8
      * Define work field Date (Char-6) USR
     C                     MOVEL*BLANK    WUT7TX  6
      * Define work field Date (Alpha) USR
     C                     MOVEL*BLANK    WUR4TX  7
      * Define work field To Date               USR
     C                     Z-ADD*ZERO     WUMADT  70
      * Define work field Date Out
     C                     Z-ADD*ZERO     WUKDDT  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WCCQNB           Julian Date
     C                     Z-ADD*ZERO     WCESNB           Accounting Year
     C                     Z-ADD*ZERO     WCETNB           Accounting Peri
     C                     Z-ADD*ZERO     WCBZNB           OM Week
     C                     Z-ADD*ZERO     WCEINB           Week Number
     C                     Z-ADD*ZERO     WCAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WCOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WCNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WCNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WCOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WCOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD13 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD12 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD11 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD10 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD09 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD08 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD07 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD06 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD05 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  80
     C                     Z-ADD*ZERO     WL0002  30
     C                     MOVEL*BLANK    WL0003  3
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005 112
     C                     Z-ADD*ZERO     WL0006 112
     C                     Z-ADD*ZERO     WL0007 112
     C                     Z-ADD*ZERO     WL0008 112
     C                     Z-ADD*ZERO     WL0009 112
     C                     Z-ADD*ZERO     WL0010 112
     C                     Z-ADD*ZERO     WL0011 112
     C                     Z-ADD*ZERO     WL0012 112
     C                     Z-ADD*ZERO     WL0013 112
     C                     Z-ADD*ZERO     WL0014 112
     C                     Z-ADD*ZERO     WL0015 112
     C                     Z-ADD*ZERO     WL0016 112
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018 112
     C                     Z-ADD*ZERO     WL0019 112
     C                     Z-ADD*ZERO     WL0020 112
     C                     MOVEL*BLANK    WL0021  1
      * Define local work field ISC Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Date Out (8,0) USR
     C                     Z-ADD*ZERO     YL0002  80
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0004  8
      *================================================================
     CSR         ZZEXIT    ENDSR
