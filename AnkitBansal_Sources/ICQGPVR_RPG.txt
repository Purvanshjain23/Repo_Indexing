     H/TITLE Prt Inventory Trans Jr PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 05/08/18  Time  : 14:53:44
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FICQGPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Prt Inventory Trans Jr PV Prompt & validate record
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FCAABREL4IF  E           K        DISK
      * RTV : Company Name and Address  Active records
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FPDKKREL1IF  E           K        DISK
      * RTV : Availability Group        Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCABZREL7IF  E           K        DISK
      * RSQ : Company Item              RSQ by Item only      NV
      *
     FOME8REL0IF  E           K        DISK
      * RTV : Item Structure Type       Retrieval index
      *
     FOME9REL0IF  E           K        DISK
      * RTV : Item Structure Group      Retrieval index
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : Item Structure Class      Retrieval index
      *
     FCAEFREL1IF  E           K        DISK
      * RTV : Reason Codes              Retrieval index       NV
      *
     FCADRREL1IF  E           K        DISK
      * RTV : User Profile Control      Retrieval index       NV
      *
     FCADTREL1IF  E           K        DISK
      * RTV : User Application Profile  Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 037  5 0A
     E                    W0END   7 037  5 0A
     E                    W0NAM   7 037 10
      * Long constants
     E                    @CN#    1  10  6   @CN    25
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
     I@ABREUA
      * Company Name and Address  Active records
      * Renamed input format fields
     I              ABAIC3                          WBAIC3
     I              ABADTX                          WBADTX
     I              ABACNA                          WBACNA
     I              ABADNA                          WBADNA
     I              ABAENA                          WBAENA
     I              ABAJNA                          WBAJNA
     I              ABBTTX                          WBBTTX
     I              ABBVTX                          WBBVTX
     I              ABBWTX                          WBBWTX
     I              ABA2NA                          WBA2NA
     I              ABABTX                          WBABTX
     I              ABBGCD                          WBBGCD
     I              ABKXCD                          WBKXCD
     I              ABUVST                          WBUVST
     I              ABUWST                          WBUWST
     I              ABUXST                          WBUXST
     I              ABVSST                          WBVSST
     I              ABAATM                          WBAATM
     I              ABAYNA                          WBAYNA
     I              ABA0NA                          WBA0NA
     I              ABAXDT                          WBAXDT
      *
     I@ABREG3
      * Company Name and Address  Retrieval index       NV
      * Renamed input format fields
     I              ABAIC3                          WCAIC3
     I              ABADTX                          WCADTX
     I              ABACNA                          WCACNA
     I              ABADNA                          WCADNA
     I              ABAENA                          WCAENA
     I              ABAJNA                          WCAJNA
     I              ABBTTX                          WCBTTX
     I              ABBVTX                          WCBVTX
     I              ABBWTX                          WCBWTX
     I              ABA2NA                          WCA2NA
     I              ABABTX                          WCABTX
     I              ABBGCD                          WCBGCD
     I              ABKXCD                          WCKXCD
     I              ABUVST                          WCUVST
     I              ABUWST                          WCUWST
     I              ABUXST                          WCUXST
     I              ABVSST                          WCVSST
     I              ABAATM                          WCAATM
     I              ABAYNA                          WCAYNA
     I              ABA0NA                          WCA0NA
     I              ABAXDT                          WCAXDT
      *
     I@KKREG7
      * Availability Group        Retrieval index
      * Renamed input format fields
     I              KKV4CD                          WDV4CD
     I              KKNVNA                          WDNVNA
     I              KKUVST                          WDUVST
     I              KKUWST                          WDUWST
     I              KKUXST                          WDUXST
     I              KKVSST                          WDVSST
     I              KKAATM                          WDAATM
     I              KKAYNA                          WDAYNA
     I              KKA0NA                          WDA0NA
     I              KKAXDT                          WDAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
     I@BZRED0
      * Company Item              RSQ by Item only      NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@E8REBB
      * Item Structure Type       Retrieval index
      * Renamed input format fields
     I              E8RGNB                          WGRGNB
     I              E8DCTX                          WGDCTX
     I              E8UVST                          WGUVST
     I              E8UWST                          WGUWST
     I              E8UXST                          WGUXST
     I              E8VSST                          WGVSST
     I              E8AATM                          WGAATM
     I              E8AYNA                          WGAYNA
     I              E8A0NA                          WGA0NA
     I              E8AXDT                          WGAXDT
      *
     I@E9REA8
      * Item Structure Group      Retrieval index
      * Renamed input format fields
     I              E9RHNB                          WHRHNB
     I              E9RGNB                          WHRGNB
     I              E9DDTX                          WHDDTX
     I              E9UVST                          WHUVST
     I              E9UWST                          WHUWST
     I              E9UXST                          WHUXST
     I              E9VSST                          WHVSST
     I              E9AATM                          WHAATM
     I              E9AYNA                          WHAYNA
     I              E9A0NA                          WHA0NA
     I              E9AXDT                          WHAXDT
      *
     I@FAREBE
      * Item Structure Class      Retrieval index
      * Renamed input format fields
     I              FARINB                          WIRINB
     I              FARHNB                          WIRHNB
     I              FADETX                          WIDETX
     I              FAUVST                          WIUVST
     I              FAUWST                          WIUWST
     I              FAUXST                          WIUXST
     I              FAVSST                          WIVSST
     I              FAAATM                          WIAATM
     I              FAAYNA                          WIAYNA
     I              FAA0NA                          WIA0NA
     I              FAAXDT                          WIAXDT
      *
     I@EFREV2
      * Reason Codes              Retrieval index       NV
      * Renamed input format fields
     I              EFCQCD                          WJCQCD
     I              EFAUNA                          WJAUNA
     I              EFUVST                          WJUVST
     I              EFUWST                          WJUWST
     I              EFUXST                          WJUXST
     I              EFVSST                          WJVSST
     I              EFAATM                          WJAATM
     I              EFAYNA                          WJAYNA
     I              EFA0NA                          WJA0NA
     I              EFAXDT                          WJAXDT
      *
     I@DRRETH
      * User Profile Control      Retrieval index       NV
      * Renamed input format fields
     I              DRAJVN                          WKAJVN
     I              DRAUNA                          WKAUNA
     I              DRB8NA                          WKB8NA
     I              DRAHVN                          WKAHVN
     I              DRI6ST                          WKI6ST
     I              DRI7ST                          WKI7ST
     I              DRXMST                          WKXMST
     I              DRXNST                          WKXNST
     I              DRI8ST                          WKI8ST
     I              DRNLNB                          WKNLNB
     I              DRMPNA                          WKMPNA
     I              DRBCCD                          WKBCCD
     I              DRAIC3                          WKAIC3
     I              DRDQCD                          WKDQCD
     I              DRDRCD                          WKDRCD
     I              DRAJCD                          WKAJCD
     I              DRBUVN                          WKBUVN
     I              DRUVST                          WKUVST
     I              DRUWST                          WKUWST
     I              DRUXST                          WKUXST
     I              DRAATM                          WKAATM
     I              DRAYNA                          WKAYNA
     I              DRA0NA                          WKA0NA
     I              DRAXDT                          WKAXDT
      *
     I@DTRETE
      * User Application Profile  Retrieval index       NV
      * Renamed input format fields
     I              DTAJVN                          WLAJVN
     I              DTDNCD                          WLDNCD
     I              DTAIC3                          WLAIC3
     I              DTDQCD                          WLDQCD
     I              DTDRCD                          WLDRCD
     I              DTAJCD                          WLAJCD
     I              DTJFST                          WLJFST
     I              DTUVST                          WLUVST
     I              DTUWST                          WLUWST
     I              DTUXST                          WLUXST
     I              DTAATM                          WLAATM
     I              DTAYNA                          WLAYNA
     I              DTA0NA                          WLA0NA
     I              DTAXDT                          WLAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WMDNCD
     I              DNAUNA                          WMAUNA
     I              DNVKST                          WMVKST
     I              DNRSCD                          WMRSCD
     I              DNUVST                          WMUVST
     I              DNUWST                          WMUWST
     I              DNUXST                          WMUXST
     I              DNAATM                          WMAATM
     I              DNAYNA                          WMAYNA
     I              DNA0NA                          WMA0NA
     I              DNAXDT                          WMAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * B :  USR Program name
     I                                        1  10 P1BNVN
     IP2PARM      DS
      * B :  USR Program Name 2
     I                                        1  10 P2BQVN
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P3AJCD
      * N :  Company Number
     I                                    P   4   50P3AIC3
      * N :  Enterprise Code 1
     I                                        6   9 P3DQCD
      * N :  Enterprise Code 2
     I                                       10  21 P3DRCD
      * N :  Salesperson Code
     I                                       22  24 P3BCCD
      * N :  System Date Format
     I                                       25  27 P3B8NA
      * N :  User Profile Name
     I                                       28  37 P3AJVN
      * N :  Allow Multi-Company
     I                                       38  38 P3I6ST
      * N :  Default Printer
     I                                       39  48 P3MPNA
     IP4PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Printer Device
     I                                        1  10 P4WRST
      * N : MAP PRT Hold Output Sts
     I                                       11  14 P4WSST
      * N : MAP PRT Save Output Sts
     I                                       15  18 P4WTST
      * N : MAP PRT Number of Copies
     I                                       19  200P4DYNB
      * N : MAP PRT Night Queue Run Sts
     I                                       21  21 P4WUST
      * N : MAP PRT Night Queue
     I                                       22  31 P4BVVN
      * N : MAP Company Number Pass   USR
     I                                    P  32  395P4AJAA
      * N : MAP Date 1          PASS  USR
     I                                    P  40  475P4AJAB
      * N :  Date 2          PASS  USR
     I                                    P  48  555P4AJAC
      * N :  System Value Numeric
     I                                    P  56  635P4M8NB
      * N : MAP Warehouse Code PASS   USR
     I                                       64  66 P4T3CD
      * N :  Item Code PASS        USR
     I                                    P  67  745P4B8C7
      * N : MAP Trans Type 1 PASS     USR
     I                                       75  76 P4ZSST
      * N : MAP Trans Type 2 PASS     USR
     I                                       77  78 P4ZTST
      * N : MAP Trans Type 3 PASS     USR
     I                                       79  80 P4ZUST
      * N : MAP Trans Type 4 PASS     USR
     I                                       81  82 P4ZVST
      * N : MAP Reason Code 1 PASS    USR
     I                                       83  85 P4T4CD
      * N : MAP Reason Code 2 PASS    USR
     I                                       86  88 P4T5CD
      * N : MAP Reason Code 3 PASS    USR
     I                                       89  91 P4T6CD
      * N : MAP Reason Code 4 PASS    USR
     I                                       92  94 P4T7CD
      * N : MAP USR User ID Selected
     I                                       95 104 P4FJNA
      * N :  Item Str Class PASS   USR
     I                                    P 105 1125P4ISCP
      * N :  Item Str Group PASS   USR
     I                                    P 113 1205P4ISGP
      * N :  Item Str Type PASS    USR
     I                                    P 121 1285P4ISTP
      * N : MAP Dtl/Sum/Ttl/Typ Sts   USR
     I                                      129 129 P4BFST
      * N :  Status - Y or N
     I                                      130 130 P4B8ST
     IP5PARM      DS
      * N :  USR Display field
     I                                        1   1 P5GGST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Company Number  7.0 Not F'
      * Company Number CDE
     I                                    P   1   20ZA0001
      * Message data for 'Warehouse not found'
      * Message data for 'Item 7.0 Not Found'
      * Company Number CDE
     I                                    P   1   20ZA0002
      * Item Code Number 7.0  USR
     I                                    P   3   60ZA0003
      * Message data for 'Item 7.0 Not Found'
      * Company Number CDE
     I                                    P   1   20ZA0004
      * Item Code Number 7.0  USR
     I                                    P   3   60ZA0005
      * Message data for 'Through time not greater'
      * USR To Time 4.0
     I                                    P   1   30ZA0006
      * Message data for 'Reason Codes           NF'
      * Message data for 'Reason Codes           NF'
      * Message data for 'Reason Codes           NF'
      * Message data for 'Reason Codes           NF'
      * Message data for 'User profile not found'
      * User Profile Name
     I                                        1  10 ZA0007
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0008
      * Application Code
     I                                       11  16 ZA0009
      * Message data for 'Application access denied'
      * User Profile Name
     I                                        1  10 ZA0010
      * Application Code
     I                                       11  16 ZA0011
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1BNVN    PARM P1BNVN    WP0001 10        USR Program nam
     C           P2BQVN    PARM P2BQVN    WP0002 10        USR Program Nam
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
      * Submit job for Print
     C                     Z-ADD#DATNB    P4AJAA           Company Number
      * PAR.Date 1          PASS  USR = DTL.USR From Date
     C                     Z-ADD#DBDDT    P4AJAB           Date 1
      * PAR.Date 2          PASS  USR = DTL.USR To Date
     C                     Z-ADD#DFDDT    P4AJAC           Date 2
     C           #DHMNX    MULT 100       WUTMPS           Time 1
     C           #DHLNX    MULT 100       WUHNNX           Time 2
     C                     Z-ADD#DICNM    P4B8C7           Item Code PASS
     C                     Z-ADD#DRGNB    P4ISTP           Item Str Type P
     C                     Z-ADD#DRHNB    P4ISGP           Item Str Group
     C                     Z-ADD#DRINB    P4ISCP           Item Str Class
     C                     MOVEL#DBLSX    P4B8ST           Status - Y or N
      * Determine program name for passing based on report type
      * CASE: DTL.Dtl/Sum/Ttl/Typ Sts   USR is Adjustment Transactions
     C           #PBFST    IFEQ 'A'                        *IF
     C                     MOVEL@CN,001   P2BQVN           USR Program Nam
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Dtl/Sum/Ttl/Typ Sts   USR is Detail
      *   |- c2    : DTL.Date Type             USR is Transaction Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PBFST    IFEQ 'D'                        *IF
     C           #DR8ST    IFEQ 'T'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,002   P2BQVN           USR Program Nam
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Dtl/Sum/Ttl/Typ Sts   USR is Detail
      *   |- c2    : DTL.Date Type             USR is Production Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #PBFST    IFEQ 'D'                        *IF
     C           #DR8ST    IFEQ 'P'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL@CN,003   P2BQVN           USR Program Nam
     C                     ELSE
      * CASE: DTL.Dtl/Sum/Ttl/Typ Sts   USR is Summary
     C           #PBFST    IFEQ 'S'                        *IF
     C                     MOVEL@CN,004   P2BQVN           USR Program Nam
     C                     ELSE
      * CASE: DTL.Dtl/Sum/Ttl/Typ Sts   USR is Total
     C           #PBFST    IFEQ 'T'                        *IF
     C                     MOVEL@CN,005   P2BQVN           USR Program Nam
     C                     ELSE
      * CASE: DTL.Dtl/Sum/Ttl/Typ Sts   USR is Type/Group/Class
     C           #PBFST    IFEQ 'G'                        *IF
     C                     MOVEL@CN,006   P2BQVN           USR Program Nam
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.Warehouse Code PASS   USR is Blanks
     C           #PT3CD    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SARVGN
     C                     END                             *FI
      * E2516      3.21.13 RMC
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P3AIC3    WQ0001  30       Company Number
     C                     PARM @CN,007   WQ0002 10        Company Value C
     C           P4BVVN    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PRT Inventory Trans Jr UP - /UT User Programs  * 
     C                     CALL 'PDRCUPR'              90  PRT Inventory T
     C           WUH3TX    PARM *BLANK    WQ0004  7        Return Code Usr
     C                     PARM 'I/C'     WQ0005  6        Application Cod
     C                     PARM @CN,008   WQ0006 10        USR Program nam
     C                     PARM P2BQVN    WQ0007 10        USR Program Nam
     C                     PARM @CN,009   WQ0008 25        PRT Description
     C           P4WRST    PARM P4WRST    WQ0009 10        PRT Printer Dev
     C           P4WSST    PARM P4WSST    WQ0010  4        PRT Hold Output
     C           P4WTST    PARM P4WTST    WQ0011  4        PRT Save Output
     C           P4WUST    PARM P4WUST    WQ0012  1        PRT Night Queue
     C           P4BVVN    PARM P4BVVN    WQ0013 10        PRT Night Queue
     C           P4AJAA    PARM P4AJAA    WQ0014 155       Company Number
     C           P4AJAB    PARM P4AJAB    WQ0015 155       Date 1
     C           P4AJAC    PARM P4AJAC    WQ0016 155       Date 2
     C           P4M8NB    PARM P4M8NB    WQ0017 155       System Value Nu
     C           #PT3CD    PARM #PT3CD    WQ0018  3        Warehouse Code
     C           P4B8C7    PARM P4B8C7    WQ0019 155       Item Code PASS
     C           #PZSST    PARM #PZSST    WQ0020  2        Trans Type 1 PA
     C           #PZTST    PARM #PZTST    WQ0021  2        Trans Type 2 PA
     C           #PZUST    PARM #PZUST    WQ0022  2        Trans Type 3 PA
     C           #PZVST    PARM #PZVST    WQ0023  2        Trans Type 4 PA
     C           #PT4CD    PARM #PT4CD    WQ0024  3        Reason Code 1 P
     C           #PT5CD    PARM #PT5CD    WQ0025  3        Reason Code 2 P
     C           #PT6CD    PARM #PT6CD    WQ0026  3        Reason Code 3 P
     C           #PT7CD    PARM #PT7CD    WQ0027  3        Reason Code 4 P
     C           #PFJNA    PARM #PFJNA    WQ0028 10        USR User ID Sel
     C           P4ISCP    PARM P4ISCP    WQ0029 155       Item Str Class
     C           P4ISGP    PARM P4ISGP    WQ0030 155       Item Str Group
     C           P4ISTP    PARM P4ISTP    WQ0031 155       Item Str Type P
     C           #PBFST    PARM #PBFST    WQ0032  1        Dtl/Sum/Ttl/Typ
     C           P4B8ST    PARM P4B8ST    WQ0033  1        Status - Y or N
     C           #DR8ST    PARM #DR8ST    WQ0034  1        Date Type
     C                     PARM #DXLCD    WQ0035  1        Shift Number
     C           #DSUST    PARM #DSUST    WQ0036  1        Export/Domestic
     C                     PARM #DV4CD    WQ0037  3        Availability Gr
     C                     PARM WUTMPS    WQ0038 155       Time 1
     C                     PARM WUHNNX    WQ0039 155       Time 2
     C                     PARM #DW9ST    WQ0040  1        Inventory Trans
     C                     PARM #DUGTX    WQ0041 50        Email Address
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRCUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     993946*
     C                     SETON                     474849*
     C                     SETON                     515253*
     C                     SETON                     545536*
     C                     SETON                     355644*
     C                     END
      * CASE: WRK.Return Code Usr is *Blank
     C           WUH3TX    IFEQ *BLANK                     *IF
      * Send message 'Print has been Submitted'
     C                     MOVEL'USR1832' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Validate USR From Date
      * External date
     C                     Z-ADDVDBDDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
     C                     Z-ADDXDINDT    #DBDDT
      * Validate USR To Date
      * External date
     C                     Z-ADDVDFDDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #DFDDT
      * Validate Date Type             USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DR8ST'  IFEQ YPMTFD
      * Date Type             USR
     C                     MOVEL#DR8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHR8ST
     C                     SELEC
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD1         ZHR8ST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD2         ZHR8ST
     C                     ENDSL
     C                     EXFMTZGR8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHR8ST    WHEQ 1
     C                     MOVEL'T'       W0INVL           T
     C           ZHR8ST    WHEQ 2
     C                     MOVEL'P'       W0INVL           P
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DR8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Dtl/Sum/Ttl/Typ Sts   USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#PBFST'  IFEQ YPMTFD
      * Dtl/Sum/Ttl/Typ Sts   USR
     C                     MOVEL#PBFST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBFST
     C                     SELEC
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD1         ZHBFST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHBFST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD3         ZHBFST
     C           W0INVL    WHEQ 'G'                        G
     C                     Z-ADD4         ZHBFST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD5         ZHBFST
     C                     ENDSL
     C                     EXFMTZGBFST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBFST    WHEQ 1
     C                     MOVEL'D'       W0INVL           D
     C           ZHBFST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C           ZHBFST    WHEQ 3
     C                     MOVEL'T'       W0INVL           T
     C           ZHBFST    WHEQ 4
     C                     MOVEL'G'       W0INVL           G
     C           ZHBFST    WHEQ 5
     C                     MOVEL'A'       W0INVL           A
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #PBFST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Export/Domestic
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSUST'  IFEQ YPMTFD
      * Export/Domestic
     C                     MOVEL#DSUST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSUST
     C                     SELEC
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD1         ZHSUST
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD2         ZHSUST
     C                     ENDSL
     C                     EXFMTZGSUST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSUST    WHEQ 1
     C                     MOVEL'E'       W0INVL           E
     C           ZHSUST    WHEQ 2
     C                     MOVEL'D'       W0INVL           D
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSUST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Inventory Trans. ID
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DW9ST'  IFEQ YPMTFD
      * Inventory Trans. ID
     C                     MOVEL#DW9ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHW9ST
     C                     SELEC
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD1         ZHW9ST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD2         ZHW9ST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD3         ZHW9ST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD4         ZHW9ST
     C                     ENDSL
     C                     EXFMTZGW9ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHW9ST    WHEQ 1
     C                     MOVEL'I'       W0INVL           I
     C           ZHW9ST    WHEQ 2
     C                     MOVEL'R'       W0INVL           R
     C           ZHW9ST    WHEQ 3
     C                     MOVEL'A'       W0INVL           A
     C           ZHW9ST    WHEQ 4
     C                     MOVEL'T'       W0INVL           T
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DW9ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Trans Type 1 PASS     USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#PZSST'  IFEQ YPMTFD
      * Trans Type 1 PASS     USR
     C                     MOVEL#PZSST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHZSST
     C                     SELEC
     C           W0INVL    WHEQ 'AP'                       AP
     C                     Z-ADD1         ZHZSST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD2         ZHZSST
     C           W0INVL    WHEQ 'OB'                       OB
     C                     Z-ADD3         ZHZSST
     C           W0INVL    WHEQ 'BO'                       BO
     C                     Z-ADD4         ZHZSST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD5         ZHZSST
     C           W0INVL    WHEQ 'IO'                       IO
     C                     Z-ADD6         ZHZSST
     C           W0INVL    WHEQ 'PC'                       PC
     C                     Z-ADD7         ZHZSST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD8         ZHZSST
     C           W0INVL    WHEQ 'RC'                       RC
     C                     Z-ADD9         ZHZSST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD10        ZHZSST
     C           W0INVL    WHEQ 'RR'                       RR
     C                     Z-ADD11        ZHZSST
     C           W0INVL    WHEQ 'RP'                       RP
     C                     Z-ADD12        ZHZSST
     C           W0INVL    WHEQ 'RS'                       RS
     C                     Z-ADD13        ZHZSST
     C           W0INVL    WHEQ 'RV'                       RV
     C                     Z-ADD14        ZHZSST
     C           W0INVL    WHEQ 'RW'                       RW
     C                     Z-ADD15        ZHZSST
     C           W0INVL    WHEQ 'SA'                       SA
     C                     Z-ADD16        ZHZSST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD17        ZHZSST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD18        ZHZSST
     C           W0INVL    WHEQ 'TB'                       TB
     C                     Z-ADD19        ZHZSST
     C           W0INVL    WHEQ 'TW'                       TW
     C                     Z-ADD20        ZHZSST
     C           W0INVL    WHEQ 'AW'                       AW
     C                     Z-ADD21        ZHZSST
     C                     ENDSL
     C                     EXFMTZGZSST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHZSST    WHEQ 1
     C                     MOVEL'AP'      W0INVL           AP
     C           ZHZSST    WHEQ 2
     C                     MOVEL'A'       W0INVL           A
     C           ZHZSST    WHEQ 3
     C                     MOVEL'OB'      W0INVL           OB
     C           ZHZSST    WHEQ 4
     C                     MOVEL'BO'      W0INVL           BO
     C           ZHZSST    WHEQ 5
     C                     MOVEL'I'       W0INVL           I
     C           ZHZSST    WHEQ 6
     C                     MOVEL'IO'      W0INVL           IO
     C           ZHZSST    WHEQ 7
     C                     MOVEL'PC'      W0INVL           PC
     C           ZHZSST    WHEQ 8
     C                     MOVEL'P'       W0INVL           P
     C           ZHZSST    WHEQ 9
     C                     MOVEL'RC'      W0INVL           RC
     C           ZHZSST    WHEQ 10
     C                     MOVEL'R'       W0INVL           R
     C           ZHZSST    WHEQ 11
     C                     MOVEL'RR'      W0INVL           RR
     C           ZHZSST    WHEQ 12
     C                     MOVEL'RP'      W0INVL           RP
     C           ZHZSST    WHEQ 13
     C                     MOVEL'RS'      W0INVL           RS
     C           ZHZSST    WHEQ 14
     C                     MOVEL'RV'      W0INVL           RV
     C           ZHZSST    WHEQ 15
     C                     MOVEL'RW'      W0INVL           RW
     C           ZHZSST    WHEQ 16
     C                     MOVEL'SA'      W0INVL           SA
     C           ZHZSST    WHEQ 17
     C                     MOVEL'S'       W0INVL           S
     C           ZHZSST    WHEQ 18
     C                     MOVEL'T'       W0INVL           T
     C           ZHZSST    WHEQ 19
     C                     MOVEL'TB'      W0INVL           TB
     C           ZHZSST    WHEQ 20
     C                     MOVEL'TW'      W0INVL           TW
     C           ZHZSST    WHEQ 21
     C                     MOVEL'AW'      W0INVL           AW
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #PZSST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Trans Type 2 PASS     USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#PZTST'  IFEQ YPMTFD
      * Trans Type 2 PASS     USR
     C                     MOVEL#PZTST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHZTST
     C                     SELEC
     C           W0INVL    WHEQ 'AP'                       AP
     C                     Z-ADD1         ZHZTST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD2         ZHZTST
     C           W0INVL    WHEQ 'OB'                       OB
     C                     Z-ADD3         ZHZTST
     C           W0INVL    WHEQ 'BO'                       BO
     C                     Z-ADD4         ZHZTST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD5         ZHZTST
     C           W0INVL    WHEQ 'IO'                       IO
     C                     Z-ADD6         ZHZTST
     C           W0INVL    WHEQ 'PC'                       PC
     C                     Z-ADD7         ZHZTST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD8         ZHZTST
     C           W0INVL    WHEQ 'RC'                       RC
     C                     Z-ADD9         ZHZTST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD10        ZHZTST
     C           W0INVL    WHEQ 'RR'                       RR
     C                     Z-ADD11        ZHZTST
     C           W0INVL    WHEQ 'RP'                       RP
     C                     Z-ADD12        ZHZTST
     C           W0INVL    WHEQ 'RS'                       RS
     C                     Z-ADD13        ZHZTST
     C           W0INVL    WHEQ 'RV'                       RV
     C                     Z-ADD14        ZHZTST
     C           W0INVL    WHEQ 'RW'                       RW
     C                     Z-ADD15        ZHZTST
     C           W0INVL    WHEQ 'SA'                       SA
     C                     Z-ADD16        ZHZTST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD17        ZHZTST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD18        ZHZTST
     C           W0INVL    WHEQ 'TB'                       TB
     C                     Z-ADD19        ZHZTST
     C           W0INVL    WHEQ 'TW'                       TW
     C                     Z-ADD20        ZHZTST
     C           W0INVL    WHEQ 'AW'                       AW
     C                     Z-ADD21        ZHZTST
     C                     ENDSL
     C                     EXFMTZGZTST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHZTST    WHEQ 1
     C                     MOVEL'AP'      W0INVL           AP
     C           ZHZTST    WHEQ 2
     C                     MOVEL'A'       W0INVL           A
     C           ZHZTST    WHEQ 3
     C                     MOVEL'OB'      W0INVL           OB
     C           ZHZTST    WHEQ 4
     C                     MOVEL'BO'      W0INVL           BO
     C           ZHZTST    WHEQ 5
     C                     MOVEL'I'       W0INVL           I
     C           ZHZTST    WHEQ 6
     C                     MOVEL'IO'      W0INVL           IO
     C           ZHZTST    WHEQ 7
     C                     MOVEL'PC'      W0INVL           PC
     C           ZHZTST    WHEQ 8
     C                     MOVEL'P'       W0INVL           P
     C           ZHZTST    WHEQ 9
     C                     MOVEL'RC'      W0INVL           RC
     C           ZHZTST    WHEQ 10
     C                     MOVEL'R'       W0INVL           R
     C           ZHZTST    WHEQ 11
     C                     MOVEL'RR'      W0INVL           RR
     C           ZHZTST    WHEQ 12
     C                     MOVEL'RP'      W0INVL           RP
     C           ZHZTST    WHEQ 13
     C                     MOVEL'RS'      W0INVL           RS
     C           ZHZTST    WHEQ 14
     C                     MOVEL'RV'      W0INVL           RV
     C           ZHZTST    WHEQ 15
     C                     MOVEL'RW'      W0INVL           RW
     C           ZHZTST    WHEQ 16
     C                     MOVEL'SA'      W0INVL           SA
     C           ZHZTST    WHEQ 17
     C                     MOVEL'S'       W0INVL           S
     C           ZHZTST    WHEQ 18
     C                     MOVEL'T'       W0INVL           T
     C           ZHZTST    WHEQ 19
     C                     MOVEL'TB'      W0INVL           TB
     C           ZHZTST    WHEQ 20
     C                     MOVEL'TW'      W0INVL           TW
     C           ZHZTST    WHEQ 21
     C                     MOVEL'AW'      W0INVL           AW
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #PZTST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Trans Type 3 PASS     USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#PZUST'  IFEQ YPMTFD
      * Trans Type 3 PASS     USR
     C                     MOVEL#PZUST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHZUST
     C                     SELEC
     C           W0INVL    WHEQ 'AP'                       AP
     C                     Z-ADD1         ZHZUST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD2         ZHZUST
     C           W0INVL    WHEQ 'OB'                       OB
     C                     Z-ADD3         ZHZUST
     C           W0INVL    WHEQ 'BO'                       BO
     C                     Z-ADD4         ZHZUST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD5         ZHZUST
     C           W0INVL    WHEQ 'IO'                       IO
     C                     Z-ADD6         ZHZUST
     C           W0INVL    WHEQ 'PC'                       PC
     C                     Z-ADD7         ZHZUST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD8         ZHZUST
     C           W0INVL    WHEQ 'RC'                       RC
     C                     Z-ADD9         ZHZUST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD10        ZHZUST
     C           W0INVL    WHEQ 'RR'                       RR
     C                     Z-ADD11        ZHZUST
     C           W0INVL    WHEQ 'RP'                       RP
     C                     Z-ADD12        ZHZUST
     C           W0INVL    WHEQ 'RS'                       RS
     C                     Z-ADD13        ZHZUST
     C           W0INVL    WHEQ 'RV'                       RV
     C                     Z-ADD14        ZHZUST
     C           W0INVL    WHEQ 'RW'                       RW
     C                     Z-ADD15        ZHZUST
     C           W0INVL    WHEQ 'SA'                       SA
     C                     Z-ADD16        ZHZUST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD17        ZHZUST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD18        ZHZUST
     C           W0INVL    WHEQ 'TB'                       TB
     C                     Z-ADD19        ZHZUST
     C           W0INVL    WHEQ 'TW'                       TW
     C                     Z-ADD20        ZHZUST
     C           W0INVL    WHEQ 'AW'                       AW
     C                     Z-ADD21        ZHZUST
     C                     ENDSL
     C                     EXFMTZGZUST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHZUST    WHEQ 1
     C                     MOVEL'AP'      W0INVL           AP
     C           ZHZUST    WHEQ 2
     C                     MOVEL'A'       W0INVL           A
     C           ZHZUST    WHEQ 3
     C                     MOVEL'OB'      W0INVL           OB
     C           ZHZUST    WHEQ 4
     C                     MOVEL'BO'      W0INVL           BO
     C           ZHZUST    WHEQ 5
     C                     MOVEL'I'       W0INVL           I
     C           ZHZUST    WHEQ 6
     C                     MOVEL'IO'      W0INVL           IO
     C           ZHZUST    WHEQ 7
     C                     MOVEL'PC'      W0INVL           PC
     C           ZHZUST    WHEQ 8
     C                     MOVEL'P'       W0INVL           P
     C           ZHZUST    WHEQ 9
     C                     MOVEL'RC'      W0INVL           RC
     C           ZHZUST    WHEQ 10
     C                     MOVEL'R'       W0INVL           R
     C           ZHZUST    WHEQ 11
     C                     MOVEL'RR'      W0INVL           RR
     C           ZHZUST    WHEQ 12
     C                     MOVEL'RP'      W0INVL           RP
     C           ZHZUST    WHEQ 13
     C                     MOVEL'RS'      W0INVL           RS
     C           ZHZUST    WHEQ 14
     C                     MOVEL'RV'      W0INVL           RV
     C           ZHZUST    WHEQ 15
     C                     MOVEL'RW'      W0INVL           RW
     C           ZHZUST    WHEQ 16
     C                     MOVEL'SA'      W0INVL           SA
     C           ZHZUST    WHEQ 17
     C                     MOVEL'S'       W0INVL           S
     C           ZHZUST    WHEQ 18
     C                     MOVEL'T'       W0INVL           T
     C           ZHZUST    WHEQ 19
     C                     MOVEL'TB'      W0INVL           TB
     C           ZHZUST    WHEQ 20
     C                     MOVEL'TW'      W0INVL           TW
     C           ZHZUST    WHEQ 21
     C                     MOVEL'AW'      W0INVL           AW
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #PZUST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Trans Type 4 PASS     USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#PZVST'  IFEQ YPMTFD
      * Trans Type 4 PASS     USR
     C                     MOVEL#PZVST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHZVST
     C                     SELEC
     C           W0INVL    WHEQ 'AP'                       AP
     C                     Z-ADD1         ZHZVST
     C           W0INVL    WHEQ 'A'                        A
     C                     Z-ADD2         ZHZVST
     C           W0INVL    WHEQ 'OB'                       OB
     C                     Z-ADD3         ZHZVST
     C           W0INVL    WHEQ 'BO'                       BO
     C                     Z-ADD4         ZHZVST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD5         ZHZVST
     C           W0INVL    WHEQ 'IO'                       IO
     C                     Z-ADD6         ZHZVST
     C           W0INVL    WHEQ 'PC'                       PC
     C                     Z-ADD7         ZHZVST
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD8         ZHZVST
     C           W0INVL    WHEQ 'RC'                       RC
     C                     Z-ADD9         ZHZVST
     C           W0INVL    WHEQ 'R'                        R
     C                     Z-ADD10        ZHZVST
     C           W0INVL    WHEQ 'RR'                       RR
     C                     Z-ADD11        ZHZVST
     C           W0INVL    WHEQ 'RP'                       RP
     C                     Z-ADD12        ZHZVST
     C           W0INVL    WHEQ 'RS'                       RS
     C                     Z-ADD13        ZHZVST
     C           W0INVL    WHEQ 'RV'                       RV
     C                     Z-ADD14        ZHZVST
     C           W0INVL    WHEQ 'RW'                       RW
     C                     Z-ADD15        ZHZVST
     C           W0INVL    WHEQ 'SA'                       SA
     C                     Z-ADD16        ZHZVST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD17        ZHZVST
     C           W0INVL    WHEQ 'T'                        T
     C                     Z-ADD18        ZHZVST
     C           W0INVL    WHEQ 'TB'                       TB
     C                     Z-ADD19        ZHZVST
     C           W0INVL    WHEQ 'TW'                       TW
     C                     Z-ADD20        ZHZVST
     C           W0INVL    WHEQ 'AW'                       AW
     C                     Z-ADD21        ZHZVST
     C                     ENDSL
     C                     EXFMTZGZVST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHZVST    WHEQ 1
     C                     MOVEL'AP'      W0INVL           AP
     C           ZHZVST    WHEQ 2
     C                     MOVEL'A'       W0INVL           A
     C           ZHZVST    WHEQ 3
     C                     MOVEL'OB'      W0INVL           OB
     C           ZHZVST    WHEQ 4
     C                     MOVEL'BO'      W0INVL           BO
     C           ZHZVST    WHEQ 5
     C                     MOVEL'I'       W0INVL           I
     C           ZHZVST    WHEQ 6
     C                     MOVEL'IO'      W0INVL           IO
     C           ZHZVST    WHEQ 7
     C                     MOVEL'PC'      W0INVL           PC
     C           ZHZVST    WHEQ 8
     C                     MOVEL'P'       W0INVL           P
     C           ZHZVST    WHEQ 9
     C                     MOVEL'RC'      W0INVL           RC
     C           ZHZVST    WHEQ 10
     C                     MOVEL'R'       W0INVL           R
     C           ZHZVST    WHEQ 11
     C                     MOVEL'RR'      W0INVL           RR
     C           ZHZVST    WHEQ 12
     C                     MOVEL'RP'      W0INVL           RP
     C           ZHZVST    WHEQ 13
     C                     MOVEL'RS'      W0INVL           RS
     C           ZHZVST    WHEQ 14
     C                     MOVEL'RV'      W0INVL           RV
     C           ZHZVST    WHEQ 15
     C                     MOVEL'RW'      W0INVL           RW
     C           ZHZVST    WHEQ 16
     C                     MOVEL'SA'      W0INVL           SA
     C           ZHZVST    WHEQ 17
     C                     MOVEL'S'       W0INVL           S
     C           ZHZVST    WHEQ 18
     C                     MOVEL'T'       W0INVL           T
     C           ZHZVST    WHEQ 19
     C                     MOVEL'TB'      W0INVL           TB
     C           ZHZVST    WHEQ 20
     C                     MOVEL'TW'      W0INVL           TW
     C           ZHZVST    WHEQ 21
     C                     MOVEL'AW'      W0INVL           AW
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #PZVST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Yes/No Selection      USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DBLSX'  IFEQ YPMTFD
      * Yes/No Selection      USR
     C                     MOVEL#DBLSX    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHBLSX
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHBLSX
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHBLSX
     C                     ENDSL
     C                     EXFMTZGBLSX
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHBLSX    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHBLSX    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DBLSX
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Select Co/PA Grp/whse/item/type/group/class/reason codes/user
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Company Number
     C           W0CFL     IFEQ '#DATNB'                   *IF
      * Allow multi-company must be yes
      * CASE: PAR.Allow Multi-Company is yes
     C           P3I6ST    IFEQ 'Y'                        *IF
      * SEL Co By Number       SR - Company Name and Address  * 
     C                     CALL 'PDMESRR'              90  SEL Co By Numbe
     C                     PARM *BLANK    W0RTN   7
     C           #DATNB    PARM #DATNB    WQ0042  30       Company Number
     C           WUADTX    PARM *BLANK    WQ0043 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9937  *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Prompt Not Allowed'
     C                     MOVEL'USR2410' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Availability Group Code
     C           W0CFL     IFEQ '#DV4CD'                   *IF
      * SEL Avail Group        SR - Availability Group  * 
     C                     CALL 'PDDVSRR'              90  SEL Avail Group
     C                     PARM *BLANK    W0RTN   7
     C           #DV4CD    PARM #DV4CD    WQ0044  3        Availability Gr
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDDVSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9938  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Warehouse Code PASS   USR
     C           W0CFL     IFEQ '#PT3CD'                   *IF
      * 02/13/18 DN S12531-Change to Call PMCQSRR SELRCD.
      * SEL AcctCo/Warehouse   SR - Warehouse  * 
     C                     CALL 'PMCQSRR'              90  SEL AcctCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #PT3CD    PARM #PT3CD    WQ0045  3        Warehouse Code
     C                     PARM #DATNB    WQ0046  30       Accounting Comp
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMCQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993937*
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Item Code Number 7.0  USR
     C           W0CFL     IFEQ '#DICNM'                   *IF
      * CASE: DTL.Company Number is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * Sel Item              SR - Item  * 
     C                     CALL 'CAOSSRR'              90  Sel Item
     C                     PARM *BLANK    W0RTN   7
     C           #DATNB    PARM #DATNB    WQ0047  30       Company Number
     C           #DICNM    PARM #DICNM    WQ0048  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAOSSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993740*
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Sel Item Number No Co. SR - Item  * 
     C                     CALL 'PDRJSRR'              90  Sel Item Number
     C                     PARM *BLANK    W0RTN   7
     C           #DICNM    PARM *ZERO     WQ0049  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDRJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9940  *
     C                     END
     C                     END                             *FI
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Item Structure Type Code
     C           W0CFL     IFEQ '#DRGNB'                   *IF
      * SEL Item Type Active   SR - OM Item Structure Type  * 
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #DRGNB    PARM #DRGNB    WQ0050  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Item Structure Group Code
     C           W0CFL     IFEQ '#DRHNB'                   *IF
      * SEL Item Group Active  SR - OM Item Structure Group  * 
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #DRHNB    PARM #DRHNB    WQ0051  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9942  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Item Structure Class Code
     C           W0CFL     IFEQ '#DRINB'                   *IF
      * SEL Item Class Active  SR - OM Item Structure Class  * 
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #DRINB    PARM #DRINB    WQ0052  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9943  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Reason Code 1 PASS    USR
     C           W0CFL     IFEQ '#PT4CD'                   *IF
      * SEL Active Reason Cd   SL - Reason Codes  * 
     C                     CALL 'CAMWSRR'              90  SEL Active Reas
     C                     PARM *BLANK    W0RTN   7
     C           #PT4CD    PARM #PT4CD    WQ0053  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9951  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Reason Code 2 PASS    USR
     C           W0CFL     IFEQ '#PT5CD'                   *IF
      * SEL Active Reason Cd   SL - Reason Codes  * 
     C                     CALL 'CAMWSRR'              90  SEL Active Reas
     C                     PARM *BLANK    W0RTN   7
     C           #PT5CD    PARM #PT5CD    WQ0054  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9952  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Reason Code 3 PASS    USR
     C           W0CFL     IFEQ '#PT6CD'                   *IF
      * SEL Active Reason Cd   SL - Reason Codes  * 
     C                     CALL 'CAMWSRR'              90  SEL Active Reas
     C                     PARM *BLANK    W0RTN   7
     C           #PT6CD    PARM #PT6CD    WQ0055  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9953  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.Reason Code 4 PASS    USR
     C           W0CFL     IFEQ '#PT7CD'                   *IF
      * SEL Active Reason Cd   SL - Reason Codes  * 
     C                     CALL 'CAMWSRR'              90  SEL Active Reas
     C                     PARM *BLANK    W0RTN   7
     C           #PT7CD    PARM #PT7CD    WQ0056  3        Reason Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAMWSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9954  *
     C                     END
     C                     ELSE
      * CASE: PGM.*Cursor field <IS> DTL.USR User ID Selected
     C           W0CFL     IFEQ '#PFJNA'                   *IF
      * SEL User Profile Contr SR - User Profile Control  * 
     C                     CALL 'CAXPSRR'              90  SEL User Profil
     C                     PARM *BLANK    W0RTN   7
     C           P4FJNA    PARM P4FJNA    WQ0057 10        User Profile Na
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAXPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Check reference to Company Name and Address
     C                     EXSR VACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * Validate company if entered
      * CASE: DTL.Company Number is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0001           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DAGTX    P      Name
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#DATNB    ZA0001           Company Number
      * Send message 'Company Number  7.0 Not F'
     C                     MOVEL'USR2008' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate PA Group
      * CASE: DTL.Availability Group Code is NE Blank
     C           #DV4CD    IFNE *BLANK                     *IF
      * RTV Group Description  RT - Availability Group  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DV4CD    WL0003    P      Availability Gr
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DNVNA    P      Availability Gr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * ** If F&W selected, email address with *XLS must be entered as we
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Availability Group     NF'
     C                     MOVEL'USR2215' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'ALL'     #DV4CD           Availability Gr
      * RTV Group Description  RT - Availability Group  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DV4CD    WL0003    P      Availability Gr
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DNVNA    P      Availability Gr
     C                     END                             *FI
      * Validate warehouse if entered
      * CASE: DTL.Warehouse Code PASS   USR is Warehouse Code not Blank
     C           #PT3CD    IFNE *BLANK                     *IF
      * RTV Warehouse          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT3CD    WL0005    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DCCNA    P      Warehouse Descr
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Send message 'Warehouse not found'
     C                     MOVEL'USR0372' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9939  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate Company for Warehouse - 02/13/18 DN S12531
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.Company Number CDE is not equal to zero
      *   |- c2    : DTL.Warehouse Code PASS   USR is Not Blanks
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #DATNB    IFNE *ZERO                      *IF
     C           #PT3CD    IFNE *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Acct Co          RT - Warehouse  * 
     C                     EXSR SERVGN
      * CASE: LCL.Accounting Company NE DTL.Company Number CDE
     C           YL0002    IFNE #DATNB                     *IF
     C                     Z-ADD#DATNB    YL0003           Company Number
     C                     END                             *FI
     C                     END                             *FI
      * Validate item if entered
      * CASE: DTL.Item Code Number 7.0  USR is Entered
     C           #DICNM    IFNE *ZERO                      *IF
      * CASE: DTL.Company Number is not equal to zero
     C           #DATNB    IFNE *ZERO                      *IF
      * RTV Item desc/type     RT - Item  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#DATNB    ZA0002           Company Number
     C                     Z-ADD#DICNM    ZA0003           Item Code Numbe
      * Send message 'Item 7.0 Not Found'
     C                     MOVEL'USR2009' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     993740*
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Description   RT - Item  * 
     C                     EXSR SGRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0004           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0004           CD3 Ext Numeric
     C                     END                             *FI
     C                     Z-ADD#DICNM    ZA0005           Item Code Numbe
      * Send message 'Item 7.0 Not Found'
     C                     MOVEL'USR2009' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9940  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate item structure type if entered
      * CASE: DTL.Item Structure Type Code is Entered
     C           #DRGNB    IFNE *ZERO                      *IF
      * Rtv Type Description   RT - OM Item Structure Type  * 
     C                     EXSR SHRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Item Structure Type    NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate item structure group if entered
      * CASE: DTL.Item Structure Group Code is Entered
     C           #DRHNB    IFNE *ZERO                      *IF
      * Rtv Group Description  RT - OM Item Structure Group  * 
     C                     EXSR SIRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Item Structure Group   NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate item structure class if entered
      * CASE: DTL.Item Structure Class Code is Entered
     C           #DRINB    IFNE *ZERO                      *IF
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
     C                     EXSR SJRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Item Structure Class   NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Validate date range
      * CASE: DTL.USR From Date GT DTL.USR To Date
     C           #DBDDT    IFGT #DFDDT                     *IF
      * Send message 'Through date not greater'
     C                     MOVEL'USR0032' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Validate time range
      * CASE: DTL.USR From Date EQ DTL.USR To Date
     C           #DBDDT    IFEQ #DFDDT                     *IF
      * CASE: DTL.USR From Time 4.0 GT DTL.USR To Time 4.0
     C           #DHMNX    IFGT #DHLNX                     *IF
      * Setup message data for message
     C                     Z-ADD#DHLNX    ZA0006           USR To Time 4.0
      * Send message 'Through time not greater'
     C                     MOVEL'USR2830' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9934  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for valid reason code number 1
      * CASE: DTL.Reason Code 1 PASS    USR is Entered
     C           #PT4CD    IFNE *BLANK                     *IF
      * Val Reason Code - Reason Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT4CD    WL0007    P      Reason Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'Reason Codes           NF'
     C                     MOVEL'USR0858' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9951  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for valid reason code number 2
      * CASE: DTL.Reason Code 2 PASS    USR is Entered
     C           #PT5CD    IFNE *BLANK                     *IF
      * Val Reason Code - Reason Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT5CD    WL0007    P      Reason Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'Reason Codes           NF'
     C                     MOVEL'USR0858' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9952  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for valid reason code number 3
      * CASE: DTL.Reason Code 3 PASS    USR is Entered
     C           #PT6CD    IFNE *BLANK                     *IF
      * Val Reason Code - Reason Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT6CD    WL0007    P      Reason Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'Reason Codes           NF'
     C                     MOVEL'USR0858' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9953  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Check for valid reason code number 4
      * CASE: DTL.Reason Code 4 PASS    USR is Entered
     C           #PT7CD    IFNE *BLANK                     *IF
      * Val Reason Code - Reason Codes  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT7CD    WL0007    P      Reason Code
     C                     EXSR SKRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * Setup message data for message
      * Send message 'Reason Codes           NF'
     C                     MOVEL'USR0858' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9954  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Dtl/Sum/Ttl/Ty
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1354554   Y2LSNO  70       List number
     C                     PARM #PBFST    W0INVL 25        Dtl/Sum/Ttl/Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Condition Desc. 2  USR = Condition name of DTL.Date Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1471936   Y2LSNO  70       List number
     C                     PARM #DR8ST    W0INVL 25        Date Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * Validate user
      * CASE: DTL.USR User ID Selected is Not Entered
     C           #PFJNA    IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Profile Desc.      RT - User Profile Control  * 
     C                     EXSR SLRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#PFJNA    ZA0007           USR User ID Sel
      * Send message 'User profile not found'
     C                     MOVEL'USR0811' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * USR From Date required
     C           #DBDDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR To Date required
     C           #DFDDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Date Type             USR required
     C           #DR8ST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Dtl/Sum/Ttl/Typ Sts   USR required
     C           #PBFST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9936  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Availability Group Code required
     C           #DV4CD    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9938  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Yes/No Selection      USR required
     C           #DBLSX    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9950  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P5GGST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P3I6ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVELP4WRST    #PWRST           PRT Printer Dev
     C                     MOVELP4WSST    #PWSST           PRT Hold Output
     C                     MOVELP4WTST    #PWTST           PRT Save Output
     C                     Z-ADDP4DYNB    #PDYNB           PRT Number of C
     C                     MOVELP4WUST    #PWUST           PRT Night Queue
     C                     MOVELP4BVVN    #PBVVN           PRT Night Queue
     C                     Z-ADDP4AJAA    #PAJAA           Company Number
     C                     Z-ADDP4AJAB    #PAJAB           Date 1
     C                     Z-ADD*ZERO     #1AIC3           Company Number
     C                     MOVEL*BLANK    #DCDNA           USR Condition D
     C                     Z-ADD*ZERO     #1OJDT           HPS PIC Date
     C                     Z-ADD*ZERO     #1NQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     #1NRNX           HPS Calendar We
     C                     MOVEL*BLANK    #1I9SX           Number of Prod
     C                     MOVEL*BLANK    #1JASX           Calendar Unused
     C                     Z-ADD*ZERO     #1OKDT           Calendar Unused
     C                     Z-ADD*ZERO     #1OLDT           Calendar Unused
     C                     Z-ADD*ZERO     #DBDDT           USR From Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDBDDT
     C                     Z-ADD*ZERO     #DHMNX           USR From Time 4
     C                     Z-ADD*ZERO     #DFDDT           USR To Date
      * Clear external version also
     C                     Z-ADD*ZERO     VDFDDT
     C                     Z-ADD*ZERO     #DHLNX           USR To Time 4.0
     C                     MOVEL*BLANK    #DR8ST           Date Type
     C                     MOVEL*BLANK    #DHMTX           Condition Desc.
     C                     MOVELP4BFST    #PBFST           Dtl/Sum/Ttl/Typ
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     Z-ADD*ZERO     #DATNB           Company Number
     C                     MOVEL*BLANK    #DAGTX           USR Company Nam
     C                     MOVEL*BLANK    #DV4CD           Availability Gr
     C                     MOVEL*BLANK    #DNVNA           Availability Gr
     C                     MOVELP4T3CD    #PT3CD           Warehouse Code
     C                     MOVEL*BLANK    #DCCNA           USR Warehouse d
     C                     Z-ADD*ZERO     #DICNM           Item Code Numbe
     C                     MOVEL*BLANK    #DGENA           Item Descriptio
     C                     Z-ADD*ZERO     #DRGNB           Item Structure
     C                     MOVEL*BLANK    #DDCTX           Item Structure
     C                     Z-ADD*ZERO     #DRHNB           Item Structure
     C                     MOVEL*BLANK    #DDDTX           Item Structure
     C                     Z-ADD*ZERO     #DRINB           Item Structure
     C                     MOVEL*BLANK    #DDETX           Item Structure
     C                     MOVEL*BLANK    #DSUST           Export/Domestic
     C                     MOVEL*BLANK    #DW9ST           Inventory Trans
     C                     MOVELP4ZSST    #PZSST           Trans Type 1 PA
     C                     MOVELP4ZTST    #PZTST           Trans Type 2 PA
     C                     MOVELP4ZUST    #PZUST           Trans Type 3 PA
     C                     MOVELP4ZVST    #PZVST           Trans Type 4 PA
     C                     MOVEL*BLANK    #DBLSX           Yes/No Selectio
     C                     MOVELP4T4CD    #PT4CD           Reason Code 1 P
     C                     MOVELP4T5CD    #PT5CD           Reason Code 2 P
     C                     MOVELP4T6CD    #PT6CD           Reason Code 3 P
     C                     MOVELP4T7CD    #PT7CD           Reason Code 4 P
     C                     MOVELP4FJNA    #PFJNA           USR User ID Sel
     C                     MOVEL*BLANK    #DAUNA           Description
     C                     MOVEL*BLANK    #DXLCD           Shift Number
     C                     MOVEL*BLANK    #DUGTX           Email Address
      * USER: Load screen
     C                     MOVEL'S'       #PBFST           Dtl/Sum/Ttl/Typ
     C                     MOVEL'T'       #DR8ST           Date Type
     C                     Z-ADD*ZERO     #DHMNX           USR From Time 4
     C                     Z-ADD2359      #DHLNX           USR To Time 4.0
     C                     Z-ADDP3AIC3    #DATNB           Company Number
     C                     MOVELP3AJCD    #PT3CD           Warehouse Code
      * DTL.Condition Desc. 1  USR = Condition name of DTL.Dtl/Sum/Ttl/Ty
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1354554   Y2LSNO  70       List number
     C                     PARM #PBFST    W0INVL 25        Dtl/Sum/Ttl/Typ
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * DTL.Condition Desc. 2  USR = Condition name of DTL.Date Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1471936   Y2LSNO  70       List number
     C                     PARM #DR8ST    W0INVL 25        Date Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
     C                     MOVEL'ALL'     #DV4CD           Availability Gr
      * RTV Group Description  RT - Availability Group  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#DV4CD    WL0003    P      Availability Gr
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    #DNVNA    P      Availability Gr
      * RTV Company Name       RT - Company Name and Address  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD#DATNB    WL0001           Company Number
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    #DAGTX    P      Name
      * RTV Warehouse          RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL#PT3CD    WL0005    P      Warehouse Code
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0006    #DCCNA    P      Warehouse Descr
      * ** L70124A LJB Add "Include Zero Quantities" to the screen and
      * **             default the initial value to "N"
     C                     MOVELP4B8ST    #DBLSX           Yes/No Selectio
      * ** E00160 LJB Default email format to Excel spreadsheet, allow ch
      * ** E00320 SLM Project  E00160 was using the above field but this
      * was never generated, changes were made 05/08 but gen dates 02/07
      * This field is not used anywhere else--- decided to * this out
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert USR From Date to display format
      * Convert date
     C           1000000   ADD  #DBDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDBDDT
      * Convert USR To Date to display format
      * Convert date
     C           1000000   ADD  #DFDDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDFDDT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#PT3CD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSA     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P4AJAA           Shipping Compan
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABWC3    P4AJAA           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WCAIC3           Company Number
      * Setup key
     C                     Z-ADDWL0001    WCAIC3           Company Number
      * Establish starting position
     C           KRSSB     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Name
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCADTX    WL0002           Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Group Description  RT - Availability Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WDV4CD           Availability Gr
      * Setup key
     C                     MOVELWL0003    WDV4CD           Availability Gr
      * Establish starting position
     C           KRSSC     CHAIN@KKREG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2215' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0004           Availability Gr
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDNVNA    WL0004           Availability Gr
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Warehouse          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0005    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSD     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0006           Warehouse Descr
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWAF8NA    WL0006           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Acct Co          RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#PT3CD    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Accounting Comp
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWABTC3    YL0002           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item desc/type     RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADD#DATNB    WEAIC3           Company Number
     C                     Z-ADD#DICNM    WEHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DGENA           Description Lin
     C                     MOVEL*BLANK    WUFZST           Production Date
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWEAVNA    #DGENA           Description Lin
     C                     MOVELWEFZST    WUFZST           Production Date
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Description   RT - Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHGCD    WQSG01           Item Code
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Item Code
      * Setup key
     C                     Z-ADD#DICNM    WQSG01           Item Code
      * Establish starting position
     C           KRSSG     SETLL@BZRED0                    *
     C           KRSSG     READE@BZRED0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DGENA           Description Lin
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAVNA    #DGENA           Description Lin
     C           KRSSG     READE@BZRED0                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Type Description   RT - OM Item Structure Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WGRGNB           Item Structure
      * Setup key
     C                     Z-ADD#DRGNB    WGRGNB           Item Structure
      * Establish starting position
     C           KRSSH     CHAIN@E8REBB              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1166' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDCTX           Item Structure
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGDCTX    #DDCTX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Group Description  RT - OM Item Structure Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHRHNB           Item Structure
      * Setup key
     C                     Z-ADD#DRHNB    WHRHNB           Item Structure
      * Establish starting position
     C           KRSSI     CHAIN@E9REA8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1168' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WURGNB           Item Structure
     C                     MOVEL*BLANK    #DDDTX           Item Structure
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHRGNB    WURGNB           Item Structure
     C                     MOVELWHDDTX    #DDDTX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIRINB           Item Structure
      * Setup key
     C                     Z-ADD#DRINB    WIRINB           Item Structure
      * Establish starting position
     C           KRSSJ     CHAIN@FAREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDETX           Item Structure
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIDETX    #DDETX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Reason Code - Reason Codes  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WJCQCD           Reason Code
      * Setup key
     C                     MOVELWL0007    WJCQCD           Reason Code
      * Establish starting position
     C           KRSSK     CHAIN@EFREV2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0858' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Profile Desc.      RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAJVN           User Profile Na
      * Setup key
     C                     MOVELP3AJVN    WKAJVN           User Profile Na
      * Establish starting position
     C           KRSSL     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAUNA           Description
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKAUNA    #DAUNA           Description
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Program Setup w/Co RT - User Profile Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WKAJVN           User Profile Na
      * Setup key
     C                     MOVELWN0001    WKAJVN           User Profile Na
      * Establish starting position
     C           KRSSM     CHAIN@DRRETH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0763' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWKI6ST    P3I6ST           Allow Multi-Com
     C                     MOVELWKMPNA    P3MPNA           Default Printer
     C                     MOVELWKBCCD    P3BCCD           Salesperson Cod
     C                     Z-ADDWKAIC3    YL0004           Company Number
     C                     MOVELWKBUVN    WN0002           User Code Model
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Appl. Profile      RT - User Application Profile  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WLAJVN           User Profile Na
     C                     KFLD           WLDNCD           Application Cod
      * Setup key
     C                     MOVELWL0008    WLAJVN           User Profile Na
     C                     MOVELWL0009    WLDNCD           Application Cod
      * Establish starting position
     C           KRSSN     CHAIN@DTRETE              90    *
      * Data record not found
     C   90                MOVEL'USR0767' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLAIC3    WL0010           Company Number
     C                     MOVELWLAJCD    WL0011           Warehouse Code
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMDNCD    WQSO01           Application Cod
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSO01           Application Cod
     C                     MOVEL'I/C'     WQSO01           Application Cod
      * Establish starting position
     C           KRSSO     SETLL@DNRESF                    *
     C           KRSSO     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WMRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWMAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C           KRSSO     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMDNCD    WQSP01           Application Cod
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Application Cod
      * Setup key
     C                     MOVELWMRSCD    WQSP01           Application Cod
      * Establish starting position
     C           KRSSP     SETLL@DNRESF                    *
     C           KRSSP     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAUNA    WUAUNA           Description
     C           KRSSP     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(LCL) YL0001' defaulted for 'Name'.
     C                     CALL 'PDMESRR'              90  SEL Co By Numbe
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0058  30       Company Number
     C           YL0001    PARM *BLANK    WQ0059 30        Name
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMESRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VAEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VAEXIT
     C                     END
      *
     C           KLVAWB    KLIST
     C                     KFLD           WBAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WBAIC3
     C           KLVAWB    CHAIN@ABREUA              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VAEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DR8ST'  YPMTFD           Date Type
     C                     END
      *
     C           ZHCSRW    IFEQ 007
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#PBFST'  YPMTFD           Dtl/Sum/Ttl/Typ
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSUST'  YPMTFD           Export/Domestic
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DW9ST'  YPMTFD           Inventory Trans
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE063
     C           ZHCSCL    ANDLE064
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#PZSST'  YPMTFD           Trans Type 1 PA
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE066
     C           ZHCSCL    ANDLE067
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#PZTST'  YPMTFD           Trans Type 2 PA
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE069
     C           ZHCSCL    ANDLE070
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#PZUST'  YPMTFD           Trans Type 3 PA
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE072
     C           ZHCSCL    ANDLE073
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#PZVST'  YPMTFD           Trans Type 4 PA
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DBLSX'  YPMTFD           Yes/No Selectio
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*START'  YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
      * USER: Exit program processing
      * CASE: DTL.*CMD key is *Exit
     C           *IN03     IFEQ '1'                        *IF
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3AJCD           Warehouse Code
     C                     Z-ADD*ZERO     P3AIC3           Company Number
     C                     MOVEL*BLANK    P3DQCD           Enterprise Code
     C                     MOVEL*BLANK    P3DRCD           Enterprise Code
     C                     MOVEL*BLANK    P3BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P3B8NA           System Date For
     C                     MOVEL*BLANK    P3AJVN           User Profile Na
     C                     MOVEL*BLANK    P3I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P3MPNA           Default Printer
     C                     MOVEL*BLANK    P4WRST           PRT Printer Dev
     C                     MOVEL*BLANK    P4WSST           PRT Hold Output
     C                     MOVEL*BLANK    P4WTST           PRT Save Output
     C                     Z-ADD*ZERO     P4DYNB           PRT Number of C
     C                     MOVEL*BLANK    P4WUST           PRT Night Queue
     C                     MOVEL*BLANK    P4BVVN           PRT Night Queue
     C                     Z-ADD*ZERO     P4AJAA           Company Number
     C                     Z-ADD*ZERO     P4AJAB           Date 1
     C                     Z-ADD*ZERO     P4AJAC           Date 2
     C                     Z-ADD*ZERO     P4M8NB           System Value Nu
     C                     MOVEL*BLANK    P4T3CD           Warehouse Code
     C                     Z-ADD*ZERO     P4B8C7           Item Code PASS
     C                     MOVEL*BLANK    P4ZSST           Trans Type 1 PA
     C                     MOVEL*BLANK    P4ZTST           Trans Type 2 PA
     C                     MOVEL*BLANK    P4ZUST           Trans Type 3 PA
     C                     MOVEL*BLANK    P4ZVST           Trans Type 4 PA
     C                     MOVEL*BLANK    P4T4CD           Reason Code 1 P
     C                     MOVEL*BLANK    P4T5CD           Reason Code 2 P
     C                     MOVEL*BLANK    P4T6CD           Reason Code 3 P
     C                     MOVEL*BLANK    P4T7CD           Reason Code 4 P
     C                     MOVEL*BLANK    P4FJNA           USR User ID Sel
     C                     Z-ADD*ZERO     P4ISCP           Item Str Class
     C                     Z-ADD*ZERO     P4ISGP           Item Str Group
     C                     Z-ADD*ZERO     P4ISTP           Item Str Type P
     C                     MOVEL*BLANK    P4BFST           Dtl/Sum/Ttl/Typ
     C                     MOVEL*BLANK    P4B8ST           Status - Y or N
     C                     MOVEL*BLANK    P5GGST           USR Display fie
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Time 1           PASS USR
     C                     Z-ADD*ZERO     WUTMPS 155
      * Define work field Time 2           PASS USR
     C                     Z-ADD*ZERO     WUHNNX 155
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Return Code Usr
     C                     MOVEL*BLANK    WUH3TX  7
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Name
     C                     MOVEL*BLANK    WUADTX 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Define work field Production Date Control
     C                     MOVEL*BLANK    WUFZST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIRINB           Item Structure
     C                     Z-ADD*ZERO     WIRHNB           Item Structure
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKNLNB           Entity Number
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 30
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0003  3
     C                     MOVEL*BLANK    WL0004 30
      * Define local variables for subroutine SDRVGN.
     C                     MOVEL*BLANK    WL0005  3
     C                     MOVEL*BLANK    WL0006 30
      * Define local variables for subroutine SKRVGN.
     C                     MOVEL*BLANK    WL0007  3
      * Define local variables for subroutine SNRVGN.
     C                     MOVEL*BLANK    WL0008 10
     C                     MOVEL*BLANK    WL0009  6
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  3
      * Define local work field Name
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0002  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0004  30
      * Define local work field Warehouse Code
     C                     MOVEL*BLANK    YL0005  3
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      *
     C                     MOVEL*BLANK    WN0001 10        User Profile Na
      *
      * VAL Set Inter. Access  IF
     C                     MOVEL##USR     WN0001           User Profile Na
      *
     C                     MOVEL*BLANK    WN0002 10        User Code Model
      *
      * VAL User/Application   IF
      * RMC 5/11/09 Rtv default company from user profile --
      *   Override user code model company if it exists
      * RTV Program Setup w/Co RT - User Profile Control  * 
     C                     EXSR SMRVGN
      * User Profile Record Not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,010                    *IF
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0008           User Profile Na
     C                     MOVEL'I/C'     ZA0009           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * CASE: PAR.User Code Model is equal to blank
     C           WN0002    IFEQ *BLANK                     *IF
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0001    WL0008    P      User Profile Na
     C                     MOVEL'I/C'     WL0009    P      Application Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P3AIC3           Company Number
     C                     MOVELWL0011    YL0005    P      Warehouse Code
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Appl. Profile      RT - User Application Profile  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0002    WL0008    P      User Profile Na
     C                     MOVEL'I/C'     WL0009    P      Application Cod
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P3AIC3           Company Number
     C                     MOVELWL0011    YL0005    P      Warehouse Code
     C                     END                             *FI
     C                     MOVELYL0005    P3AJCD           Warehouse Code
      * Return code when not normal for Application Profile
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * SET Message Queue Dest US - /UT User Source  * 
     C                     MOVEL'*PRV '   ZAPGRL           PREVIOUS
      * Setup message data for message
     C                     MOVELWN0001    ZA0010           User Profile Na
     C                     MOVEL'I/C'     ZA0011           Application Cod
      * Send message 'Application access denied'
     C                     MOVEL'USR0810' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     MOVEL'Y2U9999' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Override company with User profile control's company if found
      * CASE: LCL.Company Number is not equal to zero
     C           YL0004    IFNE 0                          *IF
     C                     Z-ADDYL0004    P3AIC3           Company Number
      * Get prod warehouse, if the appl got a warehouse
      * CASE: LCL.Warehouse Code is Not Blanks
     C           YL0005    IFNE *BLANK                     *IF
      * RTV Prod Whse for Co  XF - Warehouse  * 
     C                     CALL 'PNKDXFR'              90  RTV Prod Whse f
     C                     PARM *BLANK    W0RTN   7
     C           P3AJCD    PARM *BLANK    WQ0060  3        Warehouse Code
     C                     PARM YL0004    WQ0061  30       Shipping Compan
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNKDXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SORVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
     C                     MOVEL*BLANK    P4WRST           PRT Printer Dev
     C                     MOVEL'N'       P4WUST           PRT Night Queue
     C                     MOVEL'N'       P4B8ST           Status - Y or N
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01054010640131001320015660157201822
01828023340234002590025960284602852
03102031130335803364036140362003870
03876041260438204415044180442104424
04638048940489804902049060515005163
0540605662
** W0END
01061010680131701324015660159601822
01852023360236902592026250284802881
03108031370336003393036160364903872
03905041260438204416044190442204425
04638048960490004904049080515905185
0540605711
** W0NAM
VDBDDT    #DHMNX    VDFDDT    #DHLNX    #DR8ST    #DHMTX    #PBFST
#DHLTX    #DATNB    #DAGTX    #DV4CD    #DNVNA    #PT3CD    #DCCNA
#DICNM    #DGENA    #DRGNB    #DDCTX    #DRHNB    #DDDTX    #DRINB
#DDETX    #DSUST    #DW9ST    #PZSST    #PZTST    #PZUST    #PZVST
#DBLSX    #PT4CD    #PT5CD    #PT6CD    #PT7CD    #PFJNA    #DAUNA
#DXLCD    #DUGTX
** @CN
00001 PPHNPFR
00002 ICQHPFR
00003 PDZ1PFR
00004 OMHCPFR
00005 OMQGPFR
00006 PDRVPFR
00007 JOBQLONG
00008 PDRCCLP
00009 Inventory Trans Journal
00010 Y2U0005
