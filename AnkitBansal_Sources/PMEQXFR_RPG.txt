     H/TITLE BLD Sls/Brkr Prc Rules XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/23/15  Time  : 13:12:27
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCABBREL9IF  E           K        DISK
      * RSQ : Customer                  Rsq Ship #, Active
      *
     FPDNEREL1IF  E           K        DISK
      * RTV : Customer EXT              Retrieval index
      *
     FPMDDREL1IF  E           K        DISK
      * RTV : Sales Market              Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FPOC6REL1IF  E           K        DISK
      * RTV : Customer Price Header     Retrieval index
      *
     FPOC7REL1IF  E           K        DISK
      * RTV : Customer Price Detail     Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDIPREL5IF  E           K        DISK
      * RSQ : Market Date Method        Sys/DtTyp/Co/DtMth
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
     FPNGBREL1IF  E           K        DISK
      * RTV : IP Item Market Details    Retrieval index
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOMHOREL0IF  E           K        DISK
      * RTV : Customer Accrual          Retrieval index
      *
     FOMHLREL1IF  E           K        DISK
      * RTV : Accrual Program           Retrieval index
      *
     FOMHPREL1IF  E           K        DISK
      * RTV : Customer Accrual Item     Retrieval index
      *
     FOPBGWKLDIF  E           K        DISK
      * RSQ : Order Detail              Co/Order#/Item/Whse Not
      *
     FPOC8REL1IF  E           K        DISK
      * RTV : Customer Accrual Str      Retrieval index
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPOC5REL0IF  E           K        DISK
      * RTV : Broker                    Retrieval index
      *
     FPME7CPL0IF  E           K        DISK                      A
      * UPD : WF Sales/Broker Pricing   Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WAAIC3
     I              AFBCDT                          WABCDT
     I              AFCQNB                          WACQNB
     I              AFESNB                          WAESNB
     I              AFETNB                          WAETNB
     I              AFBZNB                          WABZNB
     I              AFA9ST                          WAA9ST
     I              AFEINB                          WAEINB
     I              AFC5ST                          WAC5ST
     I              AFAQNB                          WAAQNB
     I              AFCMST                          WACMST
     I              AFV9ST                          WAV9ST
     I              AFWAST                          WAWAST
     I              AFX2ST                          WAX2ST
     I              AFOJDT                          WAOJDT
     I              AFNQNX                          WANQNX
     I              AFNRNX                          WANRNX
     I              AFI9SX                          WAI9SX
     I              AFJASX                          WAJASX
     I              AFOKDT                          WAOKDT
     I              AFOLDT                          WAOLDT
     I              AFUVST                          WAUVST
     I              AFUWST                          WAUWST
     I              AFUXST                          WAUXST
     I              AFAATM                          WAAATM
     I              AFAYNA                          WAAYNA
     I              AFA0NA                          WAA0NA
     I              AFAXDT                          WAAXDT
      *
     I@BBREU3
      * Customer                  Rsq Ship #, Active
      * Renamed input format fields
     I              BBBKC7                          WBBKC7
     I              BBAYTX                          WBAYTX
     I              BBACNA                          WBACNA
     I              BBADNA                          WBADNA
     I              BBAENA                          WBAENA
     I              BBAJNA                          WBAJNA
     I              BBBGCD                          WBBGCD
     I              BBG5CD                          WBG5CD
     I              BBBTTX                          WBBTTX
     I              BBBVTX                          WBBVTX
     I              BBBWTX                          WBBWTX
     I              BBABTX                          WBABTX
     I              BBA2NA                          WBA2NA
     I              BBCBST                          WBCBST
     I              BBB0NA                          WBB0NA
     I              BBP3NB                          WBP3NB
     I              BBAXNA                          WBAXNA
     I              BBI6DT                          WBI6DT
     I              BBAYDT                          WBAYDT
     I              BBANC7                          WBANC7
     I              BBBTC7                          WBBTC7
     I              BBK6ST                          WBK6ST
     I              BBUZST                          WBUZST
     I              BBKXCD                          WBKXCD
     I              BBLTCD                          WBLTCD
     I              BBQNST                          WBQNST
     I              BBS2NB                          WBS2NB
     I              BBVHVA                          WBVHVA
     I              BBI7DT                          WBI7DT
     I              BBRJST                          WBRJST
     I              BBRKST                          WBRKST
     I              BBQWST                          WBQWST
     I              BBQXST                          WBQXST
     I              BBQYST                          WBQYST
     I              BBUNCS                          WBUNCS
     I              BBUVST                          WBUVST
     I              BBUWST                          WBUWST
     I              BBUXST                          WBUXST
     I              BBVSST                          WBVSST
     I              BBAATM                          WBAATM
     I              BBAYNA                          WBAYNA
     I              BBA0NA                          WBA0NA
     I              BBAXDT                          WBAXDT
      *
     I@NEREAT
      * Customer EXT              Retrieval index
      * Renamed input format fields
     I              NEBKC7                          WCBKC7
     I              NEUFTX                          WCUFTX
     I              NEUGTX                          WCUGTX
     I              NEPFNA                          WCPFNA
     I              NEJ5NX                          WCJ5NX
     I              NEU5TX                          WCU5TX
     I              NEU6TX                          WCU6TX
     I              NEW0TX                          WCW0TX
     I              NEHSSX                          WCHSSX
     I              NEHUSX                          WCHUSX
     I              NEHVSX                          WCHVSX
     I              NEAAC8                          WCAAC8
     I              NEP0SX                          WCP0SX
     I              NEP1SX                          WCP1SX
     I              NEP2SX                          WCP2SX
     I              NEP3SX                          WCP3SX
     I              NEP4SX                          WCP4SX
     I              NEP5SX                          WCP5SX
     I              NEP6SX                          WCP6SX
     I              NEUVST                          WCUVST
     I              NEUWST                          WCUWST
     I              NEUXST                          WCUXST
     I              NEVSST                          WCVSST
     I              NEAATM                          WCAATM
     I              NEAYNA                          WCAYNA
     I              NEA0NA                          WCA0NA
     I              NEAXDT                          WCAXDT
      *
     I@DDREQI
      * Sales Market              Retrieval index
      * Renamed input format fields
     I              DDISAA                          WDISAA
     I              DDR3NA                          WDR3NA
     I              DDRSTY                          WDRSTY
     I              DDHHAA                          WDHHAA
     I              DDBCCD                          WDBCCD
     I              DDITAA                          WDITAA
     I              DDKBAA                          WDKBAA
     I              DDVSST                          WDVSST
     I              DDMJDT                          WDMJDT
     I              DDBETM                          WDBETM
     I              DDCCVN                          WDCCVN
     I              DDCDVN                          WDCDVN
     I              DDMKDT                          WDMKDT
     I              DDBFTM                          WDBFTM
     I              DDCEVN                          WDCEVN
     I              DDCFVN                          WDCFVN
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WEAIC3
     I              BZHGCD                          WEHGCD
     I              BZAVNA                          WEAVNA
     I              BZAWNA                          WEAWNA
     I              BZL7NA                          WEL7NA
     I              BZL8NA                          WEL8NA
     I              BZL6NA                          WEL6NA
     I              BZMFNA                          WEMFNA
     I              BZADCD                          WEADCD
     I              BZAWPC                          WEAWPC
     I              BZLXST                          WELXST
     I              BZAECD                          WEAECD
     I              BZAXPC                          WEAXPC
     I              BZLYST                          WELYST
     I              BZAFCD                          WEAFCD
     I              BZAICD                          WEAICD
     I              BZAIWG                          WEAIWG
     I              BZHICD                          WEHICD
     I              BZRBCD                          WERBCD
     I              BZFZST                          WEFZST
     I              BZAVST                          WEAVST
     I              BZCZWG                          WECZWG
     I              BZC0WG                          WEC0WG
     I              BZURTN                          WEURTN
     I              BZAJC8                          WEAJC8
     I              BZRINB                          WERINB
     I              BZRHNB                          WERHNB
     I              BZRGNB                          WERGNB
     I              BZLNCD                          WELNCD
     I              BZTFNB                          WETFNB
     I              BZN0CD                          WEN0CD
     I              BZX4ST                          WEX4ST
     I              BZTMVA                          WETMVA
     I              BZTNVA                          WETNVA
     I              BZBLPR                          WEBLPR
     I              BZBMPR                          WEBMPR
     I              BZLRCD                          WELRCD
     I              BZU9ST                          WEU9ST
     I              BZCMCO                          WECMCO
     I              BZQ1CD                          WEQ1CD
     I              BZQ8CD                          WEQ8CD
     I              BZCHTM                          WECHTM
     I              BZQZCD                          WEQZCD
     I              BZXWST                          WEXWST
     I              BZXXST                          WEXXST
     I              BZVMST                          WEVMST
     I              BZSWGH                          WESWGH
     I              BZPPHE                          WEPPHE
     I              BZR3CD                          WER3CD
     I              BZSDCD                          WESDCD
     I              BZICN1                          WEICN1
     I              BZSVCD                          WESVCD
     I              BZICN2                          WEICN2
     I              BZSWCD                          WESWCD
     I              BZV2NB                          WEV2NB
     I              BZSXCD                          WESXCD
     I              BZITCN                          WEITCN
     I              BZSYCD                          WESYCD
     I              BZITC5                          WEITC5
     I              BZSZCD                          WESZCD
     I              BZICN6                          WEICN6
     I              BZS0CD                          WES0CD
     I              BZICN7                          WEICN7
     I              BZS1CD                          WES1CD
     I              BZICN8                          WEICN8
     I              BZS2CD                          WES2CD
     I              BZICN9                          WEICN9
     I              BZS3CD                          WES3CD
     I              BZICN0                          WEICN0
     I              BZS4CD                          WES4CD
     I              BZSFNB                          WESFNB
     I              BZA3WG                          WEA3WG
     I              BZSJNB                          WESJNB
     I              BZLLCD                          WELLCD
     I              BZLMCD                          WELMCD
     I              BZP3ST                          WEP3ST
     I              BZSKNB                          WESKNB
     I              BZSLNB                          WESLNB
     I              BZSMNB                          WESMNB
     I              BZP4ST                          WEP4ST
     I              BZCFNB                          WECFNB
     I              BZCGNB                          WECGNB
     I              BZILNB                          WEILNB
     I              BZCHNB                          WECHNB
     I              BZCINB                          WECINB
     I              BZCJNB                          WECJNB
     I              BZCMNB                          WECMNB
     I              BZCNNB                          WECNNB
     I              BZCRNB                          WECRNB
     I              BZCSNB                          WECSNB
     I              BZCVNB                          WECVNB
     I              BZCWNB                          WECWNB
     I              BZCXNB                          WECXNB
     I              BZCZNB                          WECZNB
     I              BZC0NB                          WEC0NB
     I              BZN1CD                          WEN1CD
     I              BZB4NB                          WEB4NB
     I              BZB5NB                          WEB5NB
     I              BZX5ST                          WEX5ST
     I              BZX6ST                          WEX6ST
     I              BZX7ST                          WEX7ST
     I              BZPCCT                          WEPCCT
     I              BZBDNB                          WEBDNB
     I              BZBJNB                          WEBJNB
     I              BZSUST                          WESUST
     I              BZSVST                          WESVST
     I              BZSYST                          WESYST
     I              BZSZST                          WESZST
     I              BZS1ST                          WES1ST
     I              BZXRCD                          WEXRCD
     I              BZXTCD                          WEXTCD
     I              BZXUCD                          WEXUCD
     I              BZF5WG                          WEF5WG
     I              BZF6WG                          WEF6WG
     I              BZF7WG                          WEF7WG
     I              BZBLNB                          WEBLNB
     I              BZBNNB                          WEBNNB
     I              BZS2ST                          WES2ST
     I              BZS4ST                          WES4ST
     I              BZS5ST                          WES5ST
     I              BZS6ST                          WES6ST
     I              BZS8ST                          WES8ST
     I              BZS9ST                          WES9ST
     I              BZTCST                          WETCST
     I              BZTDST                          WETDST
     I              BZUVST                          WEUVST
     I              BZUWST                          WEUWST
     I              BZUXST                          WEUXST
     I              BZVSST                          WEVSST
     I              BZAATM                          WEAATM
     I              BZAYNA                          WEAYNA
     I              BZA0NA                          WEA0NA
     I              BZAXDT                          WEAXDT
      *
     I@C6RESO
      * Customer Price Header     Retrieval index
      * Renamed input format fields
     I              C6BKC7                          WFBKC7
     I              C6BVTM                          WFBVTM
     I              C6PLDT                          WFPLDT
     I              C6PMDT                          WFPMDT
     I              C6DCVN                          WFDCVN
     I              C6PNDT                          WFPNDT
     I              C6CJTM                          WFCJTM
     I              C6QKSX                          WFQKSX
     I              C6QLSX                          WFQLSX
     I              C6QMSX                          WFQMSX
     I              C6UVST                          WFUVST
     I              C6UWST                          WFUWST
     I              C6UXST                          WFUXST
     I              C6VSST                          WFVSST
     I              C6AATM                          WFAATM
     I              C6AYNA                          WFAYNA
     I              C6A0NA                          WFA0NA
     I              C6AXDT                          WFAXDT
      *
     I@C7RESR
      * Customer Price Detail     Retrieval index
      * Renamed input format fields
     I              C7BKC7                          WGBKC7
     I              C7BVTM                          WGBVTM
     I              C7HGCD                          WGHGCD
     I              C7KWWG                          WGKWWG
     I              C7FIPR                          WGFIPR
     I              C7LQCD                          WGLQCD
     I              C7Q7CD                          WGQ7CD
     I              C7RDCD                          WGRDCD
     I              C7KXWG                          WGKXWG
     I              C7FJPR                          WGFJPR
     I              C7QNSX                          WGQNSX
     I              C7QOSX                          WGQOSX
     I              C7QPSX                          WGQPSX
     I              C7UVST                          WGUVST
     I              C7UWST                          WGUWST
     I              C7UXST                          WGUXST
     I              C7VSST                          WGVSST
     I              C7AATM                          WGAATM
     I              C7AYNA                          WGAYNA
     I              C7A0NA                          WGA0NA
     I              C7AXDT                          WGAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WHBKC7
     I              BBAYTX                          WHAYTX
     I              BBACNA                          WHACNA
     I              BBADNA                          WHADNA
     I              BBAENA                          WHAENA
     I              BBAJNA                          WHAJNA
     I              BBBGCD                          WHBGCD
     I              BBG5CD                          WHG5CD
     I              BBBTTX                          WHBTTX
     I              BBBVTX                          WHBVTX
     I              BBBWTX                          WHBWTX
     I              BBABTX                          WHABTX
     I              BBA2NA                          WHA2NA
     I              BBCBST                          WHCBST
     I              BBB0NA                          WHB0NA
     I              BBP3NB                          WHP3NB
     I              BBAXNA                          WHAXNA
     I              BBI6DT                          WHI6DT
     I              BBAYDT                          WHAYDT
     I              BBANC7                          WHANC7
     I              BBBTC7                          WHBTC7
     I              BBK6ST                          WHK6ST
     I              BBUZST                          WHUZST
     I              BBKXCD                          WHKXCD
     I              BBLTCD                          WHLTCD
     I              BBQNST                          WHQNST
     I              BBS2NB                          WHS2NB
     I              BBVHVA                          WHVHVA
     I              BBI7DT                          WHI7DT
     I              BBRJST                          WHRJST
     I              BBRKST                          WHRKST
     I              BBQWST                          WHQWST
     I              BBQXST                          WHQXST
     I              BBQYST                          WHQYST
     I              BBUNCS                          WHUNCS
     I              BBUVST                          WHUVST
     I              BBUWST                          WHUWST
     I              BBUXST                          WHUXST
     I              BBVSST                          WHVSST
     I              BBAATM                          WHAATM
     I              BBAYNA                          WHAYNA
     I              BBA0NA                          WHA0NA
     I              BBAXDT                          WHAXDT
      *
     I@IPREHD
      * Market Date Method        Sys/DtTyp/Co/DtMth
      * Renamed input format fields
     I              IPAIC3                          WIAIC3
     I              IPRDCD                          WIRDCD
     I              IPMNNA                          WIMNNA
     I              IPRECD                          WIRECD
     I              IPCPRD                          WICPRD
     I              IPQMNB                          WIQMNB
     I              IPU7ST                          WIU7ST
     I              IPCNOT                          WICNOT
     I              IPU8ST                          WIU8ST
     I              IPCDOW                          WICDOW
     I              IPBXST                          WIBXST
     I              IPUVST                          WIUVST
     I              IPUWST                          WIUWST
     I              IPUXST                          WIUXST
     I              IPAATM                          WIAATM
     I              IPAYNA                          WIAYNA
     I              IPA0NA                          WIA0NA
     I              IPAXDT                          WIAXDT
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WJLQCD
     I              F0LRCD                          WJLRCD
     I              F0EQDT                          WJEQDT
     I              F0A5PR                          WJA5PR
     I              F0B8PR                          WJB8PR
     I              F0UVST                          WJUVST
     I              F0UWST                          WJUWST
     I              F0UXST                          WJUXST
     I              F0VSST                          WJVSST
     I              F0AATM                          WJAATM
     I              F0AYNA                          WJAYNA
     I              F0A0NA                          WJA0NA
     I              F0AXDT                          WJAXDT
      *
     I@GBREGM
      * IP Item Market Details    Retrieval index
      * Renamed input format fields
     I              GBHGCD                          WKHGCD
     I              GBLQCD                          WKLQCD
     I              GBLRCD                          WKLRCD
     I              GBG2PC                          WKG2PC
     I              GBG8PR                          WKG8PR
     I              GBVSST                          WKVSST
     I              GBMJDT                          WKMJDT
     I              GBBETM                          WKBETM
     I              GBCCVN                          WKCCVN
     I              GBCDVN                          WKCDVN
     I              GBMKDT                          WKMKDT
     I              GBBFTM                          WKBFTM
     I              GBCEVN                          WKCEVN
     I              GBCFVN                          WKCFVN
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WLAIC3
     I              EOBKC7                          WLBKC7
     I              EOAQCD                          WLAQCD
     I              EOR4CD                          WLR4CD
     I              EOBYNA                          WLBYNA
     I              EOB6NA                          WLB6NA
     I              EOBZNA                          WLBZNA
     I              EOLLST                          WLLLST
     I              EOPPST                          WLPPST
     I              EOR5NB                          WLR5NB
     I              EOR6NB                          WLR6NB
     I              EOQGST                          WLQGST
     I              EOBOCD                          WLBOCD
     I              EOTBNB                          WLTBNB
     I              EOMTCU                          WLMTCU
     I              EOW2NB                          WLW2NB
     I              EORPCD                          WLRPCD
     I              EOAJCD                          WLAJCD
     I              EOX9ST                          WLX9ST
     I              EOT9CD                          WLT9CD
     I              EOUBCD                          WLUBCD
     I              EOISTX                          WLISTX
     I              EOLQCD                          WLLQCD
     I              EONJNA                          WLNJNA
     I              EOI0TX                          WLI0TX
     I              EONKNA                          WLNKNA
     I              EOI1TX                          WLI1TX
     I              EOVLST                          WLVLST
     I              EORLST                          WLRLST
     I              EOMMTX                          WLMMTX
     I              EOOHNA                          WLOHNA
     I              EOQ6ST                          WLQ6ST
     I              EOQ8ST                          WLQ8ST
     I              EORBST                          WLRBST
     I              EOREST                          WLREST
     I              EOUVST                          WLUVST
     I              EOUWST                          WLUWST
     I              EOUXST                          WLUXST
     I              EOVSST                          WLVSST
     I              EOAATM                          WLAATM
     I              EOAYNA                          WLAYNA
     I              EOA0NA                          WLA0NA
     I              EOAXDT                          WLAXDT
      *
     I@HORELA
      * Customer Accrual          Retrieval index
      * Renamed input format fields
     I              HOBKC7                          WMBKC7
     I              HOOJCD                          WMOJCD
     I              HOGUNY                          WMGUNY
     I              HOBFDT                          WMBFDT
     I              HOA2DT                          WMA2DT
     I              HOBKPR                          WMBKPR
     I              HOTTST                          WMTTST
     I              HOSHSX                          WMSHSX
     I              HOQDSX                          WMQDSX
     I              HOPJDT                          WMPJDT
     I              HOPKDT                          WMPKDT
     I              HOECVL                          WMECVL
     I              HOQESX                          WMQESX
     I              HOQFSX                          WMQFSX
     I              HOHHAA                          WMHHAA
     I              HOHQVL                          WMHQVL
     I              HOQGSX                          WMQGSX
     I              HOQHSX                          WMQHSX
     I              HOQISX                          WMQISX
     I              HOQJSX                          WMQJSX
     I              HOUVST                          WMUVST
     I              HOUWST                          WMUWST
     I              HOUXST                          WMUXST
     I              HOAATM                          WMAATM
     I              HOAYNA                          WMAYNA
     I              HOA0NA                          WMA0NA
     I              HOAXDT                          WMAXDT
      *
     I@HLREK4
      * Accrual Program           Retrieval index
      * Renamed input format fields
     I              HLOJCD                          WOOJCD
     I              HLLENA                          WOLENA
     I              HLTOST                          WOTOST
     I              HLTQST                          WOTQST
     I              HLTRST                          WOTRST
     I              HLTSST                          WOTSST
     I              HLOKCD                          WOOKCD
     I              HLTYST                          WOTYST
     I              HLOQCD                          WOOQCD
     I              HLHHCD                          WOHHCD
     I              HLI2TX                          WOI2TX
     I              HLJFTX                          WOJFTX
     I              HLI3TX                          WOI3TX
     I              HLJGTX                          WOJGTX
     I              HLLEDG                          WOLEDG
     I              HLTTST                          WOTTST
     I              HLBKPR                          WOBKPR
     I              HLSHSX                          WOSHSX
     I              HLQFSX                          WOQFSX
     I              HLFDTX                          WOFDTX
     I              HLFETX                          WOFETX
     I              HLFFTX                          WOFFTX
     I              HLFGTX                          WOFGTX
     I              HLHQVL                          WOHQVL
     I              HLFHTX                          WOFHTX
     I              HLUVST                          WOUVST
     I              HLUWST                          WOUWST
     I              HLUXST                          WOUXST
     I              HLVSST                          WOVSST
     I              HLAATM                          WOAATM
     I              HLAYNA                          WOAYNA
     I              HLA0NA                          WOA0NA
     I              HLAXDT                          WOAXDT
      *
     I@HPRELD
      * Customer Accrual Item     Retrieval index
      * Renamed input format fields
     I              HPBKC7                          WRBKC7
     I              HPOJCD                          WROJCD
     I              HPGUNY                          WRGUNY
     I              HPHGCD                          WRHGCD
     I              HPBKPR                          WRBKPR
     I              HPSHSX                          WRSHSX
     I              HPUVST                          WRUVST
     I              HPUWST                          WRUWST
     I              HPUXST                          WRUXST
     I              HPAATM                          WRAATM
     I              HPAYNA                          WRAYNA
     I              HPA0NA                          WRA0NA
     I              HPAXDT                          WRAXDT
      *
     I@BGWKFW
      * Order Detail              Co/Order#/Item/Whse Not
      * Renamed input format fields
     I              OMAIC3                          WSAIC3
     I              OMC4NB                          WSC4NB
     I              OMDPNB                          WSDPNB
     I              OMUENB                          WSUENB
     I              OMHGCD                          WSHGCD
     I              OMAJCD                          WSAJCD
     I              OMBKC7                          WSBKC7
     I              OMCFC7                          WSCFC7
     I              OMGMST                          WSGMST
     I              OMGNST                          WSGNST
     I              OMMAVA                          WSMAVA
     I              OMKDVA                          WSKDVA
     I              OML8VA                          WSL8VA
     I              OML9VA                          WSL9VA
     I              OMGTST                          WSGTST
     I              OMGVST                          WSGVST
     I              OMGUST                          WSGUST
     I              OMQFST                          WSQFST
     I              OMAYVA                          WSAYVA
     I              OMEXDT                          WSEXDT
     I              OMLQCD                          WSLQCD
     I              OMRDCD                          WSRDCD
     I              OMQ7CD                          WSQ7CD
     I              OMBZPR                          WSBZPR
     I              OML6NB                          WSL6NB
     I              OMU1ST                          WSU1ST
     I              OMGIDT                          WSGIDT
     I              OMCRCD                          WSCRCD
     I              OMAGCD                          WSAGCD
     I              OMRZST                          WSRZST
     I              OMR0ST                          WSR0ST
     I              OMR1ST                          WSR1ST
     I              OMG7NA                          WSG7NA
     I              OMG8NA                          WSG8NA
     I              OMRPCD                          WSRPCD
     I              OMVEST                          WSVEST
     I              OMVGST                          WSVGST
     I              OMAVST                          WSAVST
     I              OMU0ST                          WSU0ST
     I              OMRFCD                          WSRFCD
     I              OMFZST                          WSFZST
     I              OMR1NB                          WSR1NB
     I              OMAVQT                          WSAVQT
     I              OMD0WG                          WSD0WG
     I              OMCCQT                          WSCCQT
     I              OMAUWG                          WSAUWG
     I              OMCBQT                          WSCBQT
     I              OMATWG                          WSATWG
     I              OMAQCS                          WSAQCS
     I              OMAGCS                          WSAGCS
     I              OMAKPR                          WSAKPR
     I              OMALPR                          WSALPR
     I              OMAUPR                          WSAUPR
     I              OMAVWG                          WSAVWG
     I              OMA4WG                          WSA4WG
     I              OMA5DT                          WSA5DT
     I              OMAODT                          WSAODT
     I              OMGNDT                          WSGNDT
     I              OMAMST                          WSAMST
     I              OMANST                          WSANST
     I              OMVAST                          WSVAST
     I              OMRGNB                          WSRGNB
     I              OMRHNB                          WSRHNB
     I              OMRINB                          WSRINB
     I              OMRBCD                          WSRBCD
     I              OMHICD                          WSHICD
     I              OMRNCD                          WSRNCD
     I              OMROCD                          WSROCD
     I              OMCXDT                          WSCXDT
     I              OMAJVN                          WSAJVN
     I              OMKXCD                          WSKXCD
     I              OMJPCD                          WSJPCD
     I              OMCQCD                          WSCQCD
     I              OMR4CD                          WSR4CD
     I              OMZ1ST                          WSZ1ST
     I              OMZ3ST                          WSZ3ST
     I              OMZ4ST                          WSZ4ST
     I              OMDUPR                          WSDUPR
     I              OMB6VL                          WSB6VL
     I              OMA1AA                          WSA1AA
     I              OMFZSX                          WSFZSX
     I              OMF0SX                          WSF0SX
     I              OMF1SX                          WSF1SX
     I              OMF2SX                          WSF2SX
     I              OMF3SX                          WSF3SX
     I              OMF4SX                          WSF4SX
     I              OMF5SX                          WSF5SX
     I              OMF6SX                          WSF6SX
     I              OMF7SX                          WSF7SX
     I              OMNTDT                          WSNTDT
     I              OMNUDT                          WSNUDT
     I              OMNVDT                          WSNVDT
     I              OMNWDT                          WSNWDT
     I              OMNXDT                          WSNXDT
     I              OMBUTM                          WSBUTM
     I              OMBVTM                          WSBVTM
     I              OMBWTM                          WSBWTM
     I              OMBXTM                          WSBXTM
     I              OMBYTM                          WSBYTM
     I              OMH5NX                          WSH5NX
     I              OMH6NX                          WSH6NX
     I              OMH7NX                          WSH7NX
     I              OMH8NX                          WSH8NX
     I              OMH9NX                          WSH9NX
     I              OMDVPR                          WSDVPR
     I              OMDWPR                          WSDWPR
     I              OMDXPR                          WSDXPR
     I              OMDYPR                          WSDYPR
     I              OMDZPR                          WSDZPR
     I              OMGSPR                          WSGSPR
     I              OMGTPR                          WSGTPR
     I              OMGUPR                          WSGUPR
     I              OMHOST                          WSHOST
     I              OMHPST                          WSHPST
     I              OMIOST                          WSIOST
     I              OMPEWG                          WSPEWG
     I              OMRINY                          WSRINY
     I              OMTIDT                          WSTIDT
     I              OMTJDT                          WSTJDT
     I              OMH2ST                          WSH2ST
     I              OMH0ST                          WSH0ST
     I              OMH1ST                          WSH1ST
     I              OMTKDT                          WSTKDT
     I              OMTLDT                          WSTLDT
     I              OMTMDT                          WSTMDT
     I              OMUVST                          WSUVST
     I              OMUWST                          WSUWST
     I              OMUXST                          WSUXST
     I              OMAATM                          WSAATM
     I              OMAYNA                          WSAYNA
     I              OMA0NA                          WSA0NA
     I              OMAXDT                          WSAXDT
      *
     I@C8RES1
      * Customer Accrual Str      Retrieval index
      * Renamed input format fields
     I              C8BKC7                          WTBKC7
     I              C8OJCD                          WTOJCD
     I              C8GUNY                          WTGUNY
     I              C8RGNB                          WTRGNB
     I              C8RHNB                          WTRHNB
     I              C8RINB                          WTRINB
     I              C8BKPR                          WTBKPR
     I              C8SHSX                          WTSHSX
     I              C8QTSX                          WTQTSX
     I              C8QUSX                          WTQUSX
     I              C8FKPR                          WTFKPR
     I              C8FLPR                          WTFLPR
     I              C8UVST                          WTUVST
     I              C8UWST                          WTUWST
     I              C8UXST                          WTUXST
     I              C8VSST                          WTVSST
     I              C8AATM                          WTAATM
     I              C8AYNA                          WTAYNA
     I              C8A0NA                          WTA0NA
     I              C8AXDT                          WTAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WVBCCD
     I              APALTX                          WVALTX
     I              APACNA                          WVACNA
     I              APADNA                          WVADNA
     I              APAENA                          WVAENA
     I              APAJNA                          WVAJNA
     I              APBGCD                          WVBGCD
     I              APBTTX                          WVBTTX
     I              APBVTX                          WVBVTX
     I              APBWTX                          WVBWTX
     I              APDZTX                          WVDZTX
     I              APD0TX                          WVD0TX
     I              APD1TX                          WVD1TX
     I              APLVCD                          WVLVCD
     I              APKZCD                          WVKZCD
     I              APAIC3                          WVAIC3
     I              APAVNB                          WVAVNB
     I              APDSCD                          WVDSCD
     I              APUVST                          WVUVST
     I              APUWST                          WVUWST
     I              APUXST                          WVUXST
     I              APVSST                          WVVSST
     I              APAATM                          WVAATM
     I              APAYNA                          WVAYNA
     I              APA0NA                          WVA0NA
     I              APAXDT                          WVAXDT
      *
     I@C5RESJ
      * Broker                    Retrieval index
      * Renamed input format fields
     I              C5HHAA                          WWHHAA
     I              C5C4T1                          WWC4T1
     I              C5QMNA                          WWQMNA
     I              C5QNNA                          WWQNNA
     I              C5QONA                          WWQONA
     I              C5QPNA                          WWQPNA
     I              C5C5T1                          WWC5T1
     I              C5C6T1                          WWC6T1
     I              C5C7T1                          WWC7T1
     I              C5C8T1                          WWC8T1
     I              C5C9T1                          WWC9T1
     I              C5DAT1                          WWDAT1
     I              C5DBT1                          WWDBT1
     I              C5DCT1                          WWDCT1
     I              C5DDT1                          WWDDT1
     I              C5PWSX                          WWPWSX
     I              C5PXSX                          WWPXSX
     I              C5PYSX                          WWPYSX
     I              C5PZSX                          WWPZSX
     I              C5BCCD                          WWBCCD
     I              C5UVST                          WWUVST
     I              C5UWST                          WWUWST
     I              C5UXST                          WWUXST
     I              C5VSST                          WWVSST
     I              C5AATM                          WWAATM
     I              C5AYNA                          WWAYNA
     I              C5A0NA                          WWA0NA
     I              C5AXDT                          WWAXDT
      *
     I@E7CPZ4
      * WF Sales/Broker Pricing   Update index
      * Renamed input format fields
     I              E7AIC3                          WXAIC3
     I              E7BKC7                          WXBKC7
     I              E7HGCD                          WXHGCD
     I              E7S8DT                          WXS8DT
     I              E7AYTX                          WXAYTX
     I              E7GENA                          WXGENA
     I              E7KVAA                          WXKVAA
     I              E7UGT1                          WXUGT1
     I              E7KWAA                          WXKWAA
     I              E7UHT1                          WXUHT1
     I              E7LMNY                          WXLMNY
     I              E7GMPR                          WXGMPR
     I              E7GNPR                          WXGNPR
     I              E7BVTM                          WXBVTM
     I              E7AICD                          WXAICD
     I              E7LRCD                          WXLRCD
     I              E7Q7CD                          WXQ7CD
     I              E7S7DT                          WXS7DT
     I              E7ISAA                          WXISAA
     I              E7S9DT                          WXS9DT
     I              E7OXNY                          WXOXNY
     I              E7OYNY                          WXOYNY
     I              E7OWNY                          WXOWNY
     I              E7KXAA                          WXKXAA
     I              E7JNVL                          WXJNVL
     I              E7KYAA                          WXKYAA
     I              E7J3VL                          WXJ3VL
     I              E7KZAA                          WXKZAA
     I              E7J4VL                          WXJ4VL
     I              E7LCAA                          WXLCAA
     I              E7KTVL                          WXKTVL
     I              E7LDAA                          WXLDAA
     I              E7KUVL                          WXKUVL
     I              E7LEAA                          WXLEAA
     I              E7KVVL                          WXKVVL
     I              E7LFAA                          WXLFAA
     I              E7KWVL                          WXKWVL
     I              E7LGAA                          WXLGAA
     I              E7KXVL                          WXKXVL
     I              E7LHAA                          WXLHAA
     I              E7KYVL                          WXKYVL
     I              E7LIAA                          WXLIAA
     I              E7KZVL                          WXKZVL
     I              E7LJAA                          WXLJAA
     I              E7K1VL                          WXK1VL
     I              E7LKAA                          WXLKAA
     I              E7K2VL                          WXK2VL
     I              E7LAAA                          WXLAAA
     I              E7K3VL                          WXK3VL
     I              E7LBAA                          WXLBAA
     I              E7K4VL                          WXK4VL
     I              E7DVST                          WXDVST
     I              E7DWST                          WXDWST
     I              E7DYST                          WXDYST
     I              E7DZST                          WXDZST
     I              E7S0DT                          WXS0DT
     I              E7S1DT                          WXS1DT
     I              E7GOPR                          WXGOPR
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPME71    E DSPME7CPL0
      * UPD : WF Sales/Broker Pricing   Update index
      * Renamed input format fields
     I              E7AIC3                          WXAIC3
     I              E7BKC7                          WXBKC7
     I              E7HGCD                          WXHGCD
     I              E7S8DT                          WXS8DT
     I              E7AYTX                          WXAYTX
     I              E7GENA                          WXGENA
     I              E7KVAA                          WXKVAA
     I              E7UGT1                          WXUGT1
     I              E7KWAA                          WXKWAA
     I              E7UHT1                          WXUHT1
     I              E7LMNY                          WXLMNY
     I              E7GMPR                          WXGMPR
     I              E7GNPR                          WXGNPR
     I              E7BVTM                          WXBVTM
     I              E7AICD                          WXAICD
     I              E7LRCD                          WXLRCD
     I              E7Q7CD                          WXQ7CD
     I              E7S7DT                          WXS7DT
     I              E7ISAA                          WXISAA
     I              E7S9DT                          WXS9DT
     I              E7OXNY                          WXOXNY
     I              E7OYNY                          WXOYNY
     I              E7OWNY                          WXOWNY
     I              E7KXAA                          WXKXAA
     I              E7JNVL                          WXJNVL
     I              E7KYAA                          WXKYAA
     I              E7J3VL                          WXJ3VL
     I              E7KZAA                          WXKZAA
     I              E7J4VL                          WXJ4VL
     I              E7LCAA                          WXLCAA
     I              E7KTVL                          WXKTVL
     I              E7LDAA                          WXLDAA
     I              E7KUVL                          WXKUVL
     I              E7LEAA                          WXLEAA
     I              E7KVVL                          WXKVVL
     I              E7LFAA                          WXLFAA
     I              E7KWVL                          WXKWVL
     I              E7LGAA                          WXLGAA
     I              E7KXVL                          WXKXVL
     I              E7LHAA                          WXLHAA
     I              E7KYVL                          WXKYVL
     I              E7LIAA                          WXLIAA
     I              E7KZVL                          WXKZVL
     I              E7LJAA                          WXLJAA
     I              E7K1VL                          WXK1VL
     I              E7LKAA                          WXLKAA
     I              E7K2VL                          WXK2VL
     I              E7LAAA                          WXLAAA
     I              E7K3VL                          WXK3VL
     I              E7LBAA                          WXLBAA
     I              E7K4VL                          WXK4VL
     I              E7DVST                          WXDVST
     I              E7DWST                          WXDWST
     I              E7DYST                          WXDYST
     I              E7DZST                          WXDZST
     I              E7S0DT                          WXS0DT
     I              E7S1DT                          WXS1DT
     I              E7GOPR                          WXGOPR
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Market Price Date
     I                                    P   1   40P1EQDT
     IP2PARM      DS
      * B :  Saturday              USR
     I                                    P   1   40P2MIDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1EQDT    PARM           WP0001  70       Market Price Da
     C           P2MIDT    PARM P2MIDT    WP0002  70       Saturday
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BLD Sls/Brkr Prc Rules XF
      * RTV Next Saturday      RT - Calendar  * 
     C                     EXSR SARVGN
     C                     Z-ADDP1EQDT    YL0001           Sunday
      * BLD Sls/Brkr Prc Rules RT - Customer  * 
     C                     EXSR SBRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Next Saturday      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WABCDT           Post to G/L Dat
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
      * Setup key
     C                     Z-ADD363       WQSA01           Company Number
     C                     Z-ADDP1EQDT    WABCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSA     SETLL@AFREBE                    *
     C           KRSSA     READE@AFREBE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2MIDT           Scheduled Ship
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Day of Week is Saturday
     C           WAA9ST    IFEQ '7'                        *IF
     C                     Z-ADDWABCDT    P2MIDT           Scheduled Ship
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * BLD Sls/Brkr Prc Rules RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BBREU3                    *
     C                     READ @BBREU3                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Must be a ship to cust and active to process
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Ship To Customer Flag is Allow Use as Ship To Cu
      *   |- c2    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBRJST    IFEQ 'Y'                        *IF
     C           WBVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv All Values FX/EM+ RT - Customer EXT  * 
     C                     EXSR SCRVGN
      * Rtv All values        RT - Sales Market  * 
     C                     EXSR SDRVGN
      * RTV Item for Pricing   RT - Company Item  * 
     C                     EXSR SERVGN
     C                     END                             *FI
     C                     READ @BBREU3                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv All Values FX/EM+ RT - Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@NEREAT              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2880' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0005           Internet Passwo
     C                     MOVEL*BLANK    YL0006           Email Address
     C                     MOVEL*BLANK    YL0007           Email User ID
     C                     MOVEL*BLANK    YL0008           EDI Trading Par
     C                     MOVEL*BLANK    YL0009           EDI Cust Duns N
     C                     MOVEL*BLANK    YL0010           EDI Warehouse/S
     C                     MOVEL*BLANK    YL0011           State Tax ID
     C                     MOVEL*BLANK    YL0012           Cust Shipping T
     C                     MOVEL*BLANK    YL0013           One Invoice Per
     C                     MOVEL*BLANK    YL0014           EDI Advanced Sh
     C                     Z-ADD*ZERO     YL0015           Customer G/L Ve
     C                     MOVEL*BLANK    YL0016           Air Freight Ord
     C                     MOVEL*BLANK    YL0017           Regional Mgr Fa
     C                     MOVEL*BLANK    YL0018           Employee Meat S
     C                     MOVEL*BLANK    YL0019           Customer TF Exe
     C                     MOVEL*BLANK    YL0020           Customer Watch
     C                     MOVEL*BLANK    YL0021           Customer Sales
     C                     MOVEL*BLANK    YL0022           Customer Market
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCUFTX    YL0005           Internet Passwo
     C                     MOVELWCUGTX    YL0006           Email Address
     C                     MOVELWCPFNA    YL0007           Email User ID
     C                     MOVELWCJ5NX    YL0008           EDI Trading Par
     C                     MOVELWCU5TX    YL0009           EDI Cust Duns N
     C                     MOVELWCU6TX    YL0010           EDI Warehouse/S
     C                     MOVELWCW0TX    YL0011           State Tax ID
     C                     MOVELWCHSSX    YL0012           Cust Shipping T
     C                     MOVELWCHUSX    YL0013           One Invoice Per
     C                     MOVELWCHVSX    YL0014           EDI Advanced Sh
     C                     Z-ADDWCAAC8    YL0015           Customer G/L Ve
     C                     MOVELWCP0SX    YL0016           Air Freight Ord
     C                     MOVELWCP1SX    YL0017           Regional Mgr Fa
     C                     MOVELWCP2SX    YL0018           Employee Meat S
     C                     MOVELWCP3SX    YL0019           Customer TF Exe
     C                     MOVELWCP4SX    YL0020           Customer Watch
     C                     MOVELWCP5SX    YL0021           Customer Sales
     C                     MOVELWCP6SX    YL0022           Customer Market
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv All values        RT - Sales Market  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDISAA           Market Code
      * Setup key
     C                     MOVELYL0022    WDISAA           Market Code
      * Establish starting position
     C           KRSSD     CHAIN@DDREQI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3863' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0023           Market Desc
     C                     MOVEL*BLANK    YL0024           Market Type
     C                     MOVEL*BLANK    YL0025           Broker Code
     C                     MOVEL*BLANK    YL0026           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDR3NA    YL0023           Market Desc
     C                     MOVELWDRSTY    YL0024           Market Type
     C                     MOVELWDHHAA    YL0025           Broker Code
     C                     MOVELWDBCCD    YL0026           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Item for Pricing   RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Establish starting position
     C           *LOVAL    SETLL@BZREJU                    *
     C                     READ @BZREJU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * CASE: DB1.Item Type Code is Not Finished Good
     C           WEN0CD    IFNE 'FG'                       *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: DB1.Record Status is Inactive
     C           WEVSST    IFEQ 'I'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Rtv get deviated price RT - Customer Price Header  * 
     C                     EXSR SFRVGN
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Retrieve customer name
      * RTV Customer Name      RT - Customer  * 
     C                     EXSR SHRVGN
      * Set up market date to retrieve pricing
     C                     Z-ADDYL0001    YL0039           Market Pricing
      * Get Published price
      *
     C                     Z-ADD*ZERO     WN0001  70       Date Used for C
     C                     MOVEL*BLANK    WN0002  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0003  94       Conversion Fact
     C                     MOVEL*BLANK    WN0004  1        Operation Facto
     C                     MOVEL*BLANK    WN0005  2        U/M - Second
     C                     Z-ADD*ZERO     WN0006  94       Conversion Fact
     C                     MOVEL*BLANK    WN0007  1        Operation Facto
     C                     MOVEL*BLANK    WN0008  2        U/M - Third
     C                     MOVEL*BLANK    WN0009  2        U/M - Pricing
     C                     MOVEL*BLANK    WN0010  3        Default Commod
     C                     Z-ADD*ZERO     WN0011 114       Price Adjustmen
     C                     MOVEL*BLANK    WN0012  7        Commodity Price
      *
      * RTV Pricing: MKTPRC   IF
      * Conversion Documentation
     C                     EXSR UASUBR                     Conversion Docu
      * E3947 2/23/2015 RMC
      *  If commodity price group is TPA, use item code as the group inst
     C                     MOVELWELRCD    WN0012           Commodity Price
      * *** Price Routine was call on or after Shipping, Calculate Price
      * CASE: PAR.Event Called From is All Values
     C           '99'      IFEQ '02'                       *IF
     C           '99'      OREQ '99'
     C           '99'      OREQ '**'
     C           '99'      OREQ 'AO'
     C           '99'      OREQ 'AI'
      * CASE: PAR.Commodity Price Group is Third Party Avg
     C           WELRCD    IFEQ 'TPA'                      *IF
     C                     MOVEL*BLANK    YL0050           Item Code Txt
     C                     MOVELWEHGCD    YL0050           Item Code Txt
     C                     MOVELYL0050    WN0012           Commodity Price
     C                     END                             *FI
      * *** Calculate Date Method Price if Selected
      * CASE: PAR.Date Method Code is Entered
     C           *BLANK    IFNE *BLANK                     *IF
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0001  30       Company Number
     C                     PARM *BLANK    WQ0002  3        Date Method Cod
     C                     PARM YL0040    WQ0003  70       Actual Shipped
     C                     PARM YL0041    WQ0004  70       Requested Deliv
     C                     PARM YL0042    WQ0005  70       Requested Ship
     C                     PARM YL0043    WQ0006  70       Date of Orig. E
     C                     PARM YL0044    WQ0007  3        Commodity Marke
     C                     PARM YL0039    WQ0008  70       Market Pricing
     C           YL0045    PARM YL0045    WQ0009  1        Price Status
     C           YL0031    PARM *ZERO     WQ0010  70       Pricing Date Us
     C           YL0046    PARM YL0046    WQ0011 114       Pricing Retriev
     C                     PARM '99'      WQ0012  2        Event Called Fr
     C                     PARM WN0012    WQ0013  7        Commodity Price
     C                     PARM YL0047    WQ0014  70       OD Market Begin
     C                     PARM YL0048    WQ0015  70       OD Market Endin
     C           WN0001    PARM WN0001    WQ0016  70       Date Used for C
     C           YL0049    PARM *BLANK    WQ0017  5        Date Error Retu
     C                     PARM WEHGCD    WQ0018  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: Market Price Date Range Entered
      *  - (c2 AND c3)
      *   |- c2    : PAR.OD Market Begin Date is Entered
      *   |- c3    : PAR.OD Market Ending Date is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0047    IFNE 0                          *IF
     C           YL0048    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Date Range Avg Cd RT - Market Date Method  * 
     C                     EXSR SIRVGN
      * CLC Date Method        XF - Market Date Method  * 
     C                     CALL 'PDLJXFR'              90  CLC Date Method
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0019  30       Company Number
     C                     PARM YL0051    WQ0020  3        Date Method Cod
     C                     PARM YL0040    WQ0021  70       Actual Shipped
     C                     PARM YL0041    WQ0022  70       Requested Deliv
     C                     PARM YL0042    WQ0023  70       Requested Ship
     C                     PARM YL0043    WQ0024  70       Date of Orig. E
     C                     PARM YL0044    WQ0025  3        Commodity Marke
     C                     PARM YL0039    WQ0026  70       Market Pricing
     C           YL0045    PARM YL0045    WQ0027  1        Price Status
     C           YL0031    PARM *ZERO     WQ0028  70       Pricing Date Us
     C           YL0046    PARM YL0046    WQ0029 114       Pricing Retriev
     C                     PARM '99'      WQ0030  2        Event Called Fr
     C                     PARM WN0012    WQ0031  7        Commodity Price
     C                     PARM YL0047    WQ0032  70       OD Market Begin
     C                     PARM YL0048    WQ0033  70       OD Market Endin
     C           WN0001    PARM WN0001    WQ0034  70       Date Used for C
     C           YL0049    PARM *BLANK    WQ0035  5        Date Error Retu
     C                     PARM WEHGCD    WQ0036  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLJXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * *** Load Date used for calculation (to retrieve Market date)
      * CASE: PAR.Market Pricing Date is NE Zero
     C           YL0039    IFNE 0                          *IF
     C                     Z-ADDYL0039    WN0001           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date Used for Calculation is not entered
     C           WN0001    IFEQ 0                          *IF
      * CASE: PAR.Actual Shipped Date is entered
     C           YL0040    IFNE 0                          *IF
     C                     Z-ADDYL0040    WN0001           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0042    WN0001           Date Used for C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELYL0044    WL0001    P      Commodity Marke
     C                     MOVELWN0012    WL0002    P      Commodity Price
     C                     Z-ADDWN0001    WL0003           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0046           Commodity Marke
     C                     Z-ADDWL0005    YL0031           USR Date Priced
      * Flag as Unpriced if Price Date doesn't match Market date entered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pricing Date Used NE PAR.Date Used for Calculati
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           YL0031    IFNE WN0001                     *IF
     C           W0RTN     OREQ @CN,001                    *OR
     C                     MOVEL'U'       YL0045           Price Status
      * If no pricing record was found then flag as pricing error.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    YL0049           Error Return
     C                     MOVEL'MKT'     YL0049           Error Return
     C                     END                             *FI
     C                     END                             *FI
      * If record not found use default commodity market from company/ite
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV Dflt Comm Mrkt     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDMNXFR'              90  RTV Dflt Comm M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0037  30       Company Number
     C                     PARM WEHGCD    WQ0038  70       Item Code
     C           WN0010    PARM *BLANK    WQ0039  3        Default Commod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C           YL0044    IFNE WN0010                     *IF
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWN0010    WL0001    P      Commodity Marke
     C                     MOVELWN0012    WL0002    P      Commodity Price
     C                     Z-ADDWN0001    WL0003           Market Price Da
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    YL0046           Commodity Marke
     C                     Z-ADDWL0005    YL0031           USR Date Priced
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Market Details    RT - IP Item Market Details  * 
     C                     EXSR SKRVGN
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Pricing Retrieved Amount is Not Zeros
      *   |- c2    : LCL.Market Percent is not equal to zeros
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFNE 0                          *IF
     C           YL0052    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Pricing Retrieved Amount
      * PAR.Pricing Retrieved Amount =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : PAR.Pricing Retrieved Amount
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : LCL.Market Percent
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.100
     C           YL0052    DIV  100       W0WD01    H      *Synon (17,7) w
     C           YL0046    MULT W0WD01    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0046           Pricing Retriev
     C                     END                             *FI
     C                     END                             *FI
      * Convert Price to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           YL0046    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0040  30       Company Number
     C                     PARM WEHGCD    WQ0041  70       Item Code
     C                     PARM YL0046    WQ0042 114       Unit Price
     C           WN0011    PARM *ZERO     WQ0043 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWN0011    YL0046           Pricing Retriev
     C                     END                             *FI
      * The 'Pricing Date Used'is returned & is the date of the mkt prc
     C           YL0046    MULT 1         YL0053    H      USR Value
     C                     Z-ADDYL0053    YL0046           Published Price
      * Get Absorbed Freight
      * RTV Abs Freight Rate   RT - Company Customer  * 
     C                     EXSR SLRVGN
      * Get Accruals
      * This pgm will put the accruals in separate buckets
      *
     C                     Z-ADD*ZERO     WN0013  30       Item Structure
     C                     Z-ADD*ZERO     WN0014  30       Item Structure
     C                     Z-ADD*ZERO     WN0015  30       Item Structure
     C                     Z-ADD*ZERO     WN0016 114       Price Adjustmen
      *
      * RTV Price: ACCRLS Ind IF
      * ** Routine to Accumulate Accrual Rates
      * CASE: PAR.Event Called From is All Values
     C           '99'      IFEQ '02'                       *IF
     C           '99'      OREQ '99'
     C           '99'      OREQ '**'
     C           '99'      OREQ 'AO'
     C           '99'      OREQ 'AI'
     C                     Z-ADD0         YL0081           Accrual Rate
      * ** This will read all accrual codes that are setup for the
      * ** ShipTo customer and accumulate the Accrual Rates.
      * ** If Actual Shipped Date is zeros, use Requested Ship Date
      * CASE: PAR.Actual Shipped Date is entered
     C           YL0040    IFNE 0                          *IF
     C                     Z-ADDYL0040    WUFADT           USR Date Shippe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0031    WUFADT           USR Date Shippe
     C                     END                             *FI
      * Rtv Accrl Info Indiv  RT - Customer Accrual  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
      * ** Convert Price to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           YL0055    IFNE 0                          *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WEAIC3    WQ0044  30       Company Number
     C                     PARM WEHGCD    WQ0045  70       Item Code
     C                     PARM YL0055    WQ0046 114       Unit Price
     C           WN0016    PARM *ZERO     WQ0047 114       Price Adjustmen
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Conversion Documentation
     C                     EXSR UBSUBR                     Conversion Docu
      * CASE: LCL.Customer Price /UM Prc is Equal zero
     C           YL0030    IFEQ 0                          *IF
     C                     Z-ADD0         YL0032           Price Code
     C                     END                             *FI
      * CASE: DB1.U/M - Pricing is Cases
     C           WEAICD    IFEQ 'CS'                       *IF
      * Published price
      * LCL.Published Price       USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.Published Price       USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Unit Weight
     C           YL0046    DIV  100       W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT WEAIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0046           Published Price
      * Absorbed Freight
      * LCL.Absorbed Freight 7.2  USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : LCL.Absorbed Freight 7.2  USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : DB1.Unit Weight
     C           YL0054    DIV  100       W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT WEAIWG    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0054           Absorbed Freigh
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Published Price       USR is Equal to one cent
     C           YL0046    IFEQ .0100                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Get Salesperson name
      * RTV Salesperson NmeOnlyRT - Salesperson  * 
     C                     EXSR STRVGN
     C                     MOVELYL0026    YL0087           Mkt Salesperson
      * Retreive Broker name
      * Rtv Broker Name       RT - Broker  * 
     C                     EXSR SURVGN
     C                     MOVELYL0025    YL0089           Mkt Broker Code
      * Write record
      * Create WF Sales/Broker Pr - WF Sales/Broker Pricing  * 
     C                     EXSR SVCRRC
     C                     END                             *FI
     C                     Z-ADD0         YL0057           WF BG1 Accrual
     C                     Z-ADD0         YL0059           WF BG2 Accrual
     C                     Z-ADD0         YL0061           WF BG3 Accrual
     C                     Z-ADD0         YL0063           WF CA1 Accrual
     C                     Z-ADD0         YL0065           WF CR1 Accrual
     C                     Z-ADD0         YL0067           WF IC1 Accrual
     C                     Z-ADD0         YL0069           WF IC2 Accrual
     C                     Z-ADD0         YL0071           WF IC3 Accrual
     C                     Z-ADD0         YL0073           WF PR1 Accrual
     C                     Z-ADD0         YL0075           WF SP1 Accrual
     C                     Z-ADD0         YL0077           WF SW1 Accrual
     C                     Z-ADD0         YL0079           WF WD1 Accrual
     C                     READ @BZREJU                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv get deviated price RT - Customer Price Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBKC7    WQSF01           Ship To Custome
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WQSF01           Ship To Custome
      * Establish starting position
     C           KRSSF     SETLL@C6RESO                    *
     C           KRSSF     READE@C6RESO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3290' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0030           Customer Price
     C                     Z-ADD*ZERO     YL0032           Price Code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.Price Start Date LE PAR.Pricing Date Used
      *   |- c2    : DB1.Price End Date GE PAR.Pricing Date Used
      *   |- c3    : DB1.Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WFPLDT    IFLE YL0031                     *IF
     C           WFPMDT    IFGE YL0031                     *IF
     C           WFVSST    IFEQ 'A'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Max Wt and price  RT - Customer Price Detail  * 
     C                     EXSR SGRVGN
     C                     END                             *FI
     C                     Z-ADDWFBVTM    YL0032           Price Code
     C           KRSSF     READE@C6RESO                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Max Wt and price  RT - Customer Price Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGBKC7           Ship To Custome
     C                     KFLD           WGBVTM           Price Code
     C                     KFLD           WGHGCD           Item Code
      * Setup key
     C                     Z-ADDWFBKC7    WGBKC7           Ship To Custome
     C                     Z-ADDWFBVTM    WGBVTM           Price Code
     C                     Z-ADDWEHGCD    WGHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@C7RESR              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3292' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0033           Maximum Contrac
     C                     Z-ADD*ZERO     YL0030           Customer Price
     C                     MOVEL*BLANK    YL0034           Commodity Marke
     C                     MOVEL*BLANK    YL0035           Price Method Co
     C                     MOVEL*BLANK    YL0036           Date Method Cod
     C                     MOVEL*BLANK    YL0037           Contract Unit T
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGKWWG    YL0033           Maximum Contrac
     C                     Z-ADDWGFIPR    YL0030           Customer Price
     C                     MOVELWGLQCD    YL0034           Commodity Marke
     C                     MOVELWGQ7CD    YL0035           Price Method Co
     C                     MOVELWGRDCD    YL0036           Date Method Cod
     C                     MOVELWGQNSX    YL0037           Contract Unit T
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Customer Name      RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WHBKC7           Ship To Custome
      * Establish starting position
     C           KRSSH     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0038           Customer Name
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHAYTX    YL0038           Customer Name
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Date Range Avg Cd RT - Market Date Method  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIBXST    WQSI01           System using Da
     C           *LIKE     DEFN WIRECD    WQSI02           CTL Date Type
     C           *LIKE     DEFN WIAIC3    WQSI03           Company Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           System using Da
     C                     KFLD           WQSI02           CTL Date Type
     C                     KFLD           WQSI03           Company Number
      * Setup key
     C                     MOVEL'O'       WQSI01           System using Da
     C                     MOVEL'R'       WQSI02           CTL Date Type
     C                     Z-ADDWEAIC3    WQSI03           Company Number
      * Establish starting position
     C           KRSSI     SETLL@IPREHD                    *
     C           KRSSI     READE@IPREHD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1681' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0051           Date Method Cod
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIRDCD    YL0051           Date Method Cod
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@IPREHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJLQCD    WQSJ01           Commodity Marke
     C           *LIKE     DEFN WJLRCD    WQSJ02           Commodity Price
      * Define keylist
     C           KPSSJ     KLIST
     C                     KFLD           WQSJ01           Commodity Marke
     C                     KFLD           WQSJ02           Commodity Price
     C                     KFLD           WJEQDT           Market Price Da
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Commodity Marke
     C                     KFLD           WQSJ02           Commodity Price
      * Setup key
     C                     MOVELWL0001    WQSJ01           Commodity Marke
     C                     MOVELWL0002    WQSJ02           Commodity Price
     C                     Z-ADDWL0003    WJEQDT           Market Price Da
      * Establish starting position
     C           KPSSJ     SETLL@F0CPEP                    *
     C           KRSSJ     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Commodity Marke
     C                     Z-ADD*ZERO     WL0005           USR Date Priced
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWJA5PR    WL0004           Commodity Marke
     C                     Z-ADDWJEQDT    WL0005           USR Date Priced
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Market Details    RT - IP Item Market Details  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKLQCD           Commodity Marke
      * Setup key
     C                     Z-ADDWEHGCD    WKHGCD           Item Code
     C                     MOVELYL0044    WKLQCD           Commodity Marke
      * Establish starting position
     C           KRSSK     CHAIN@GBREGM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4314' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0052           Market Percent
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKG2PC    YL0052           Market Percent
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Abs Freight Rate   RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWEAIC3    WLAIC3           Company Number
     C                     Z-ADDWBBKC7    WLBKC7           Ship To Custome
      * Establish starting position
     C           KRSSL     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0054           Absorbed Freigh
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWLTBNB    YL0054           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Accrl Info Indiv  RT - Customer Accrual  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0017  30       Item Structure
     C                     Z-ADD*ZERO     WN0018  30       Item Structure
     C                     Z-ADD*ZERO     WN0019  30       Item Structure
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         YL0055           Pricing Retriev
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMBKC7    WQSM01           Ship To Custome
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WQSM01           Ship To Custome
      * Establish starting position
     C           KRSSM     SETLL@HORELA                    *
     C           KRSSM     READE@HORELA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1520' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUBKPR           Accrual Rate
     C                     Z-ADD*ZERO     YL0055           Pricing Retriev
     C                     Z-ADD*ZERO     WN0017           Item Structure
     C                     Z-ADD*ZERO     WN0018           Item Structure
     C                     Z-ADD*ZERO     WN0019           Item Structure
     C                     Z-ADD*ZERO     YL0057           WF BG1 Accrual
     C                     MOVEL*BLANK    YL0058           WF BG1 Accrual
     C                     Z-ADD*ZERO     YL0059           WF BG2 Accrual
     C                     MOVEL*BLANK    YL0060           WF BG2 Accrual
     C                     Z-ADD*ZERO     YL0061           WF BG3 Accrual
     C                     MOVEL*BLANK    YL0062           WF BG3 Accrual
     C                     Z-ADD*ZERO     YL0063           WF CA1 Accrual
     C                     MOVEL*BLANK    YL0064           WF CA1 Accrual
     C                     Z-ADD*ZERO     YL0065           WF CR1 Accrual
     C                     MOVEL*BLANK    YL0066           WF CR1 Accrual
     C                     Z-ADD*ZERO     YL0067           WF IC1 Accrual
     C                     MOVEL*BLANK    YL0068           WF IC1 Accrual
     C                     Z-ADD*ZERO     YL0069           WF IC2 Accrual
     C                     MOVEL*BLANK    YL0070           WF IC2 Accrual
     C                     Z-ADD*ZERO     YL0071           WF IC3 Accrual
     C                     MOVEL*BLANK    YL0072           WF IC3 Accrual
     C                     Z-ADD*ZERO     YL0073           WF PR1 Accrual
     C                     MOVEL*BLANK    YL0074           WF PR1 Accrual
     C                     Z-ADD*ZERO     YL0075           WF SP1 Accrual
     C                     MOVEL*BLANK    YL0076           WF SP1 Accrual
     C                     Z-ADD*ZERO     YL0077           WF SW1 Accrual
     C                     MOVEL*BLANK    YL0078           WF SW1 Accrual
     C                     Z-ADD*ZERO     YL0079           WF WD1 Accrual
     C                     MOVEL*BLANK    YL0080           WF WD1 Accrual
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * ** The par.period begin date is either the Actual Shipped date
      * ** from the Order Detail file unless it is zeros, then it is
      * ** replaced by the Requested Ship Date.
      * ** Select the record where the ASD is within the date range
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Period Beginning Date GE DB1.Period Beginning Da
      *   |- c2    : PAR.Period Beginning Date LE DB1.Period Ending Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUFADT    IFGE WMBFDT                     *IF
     C           WUFADT    IFLE WMA2DT                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Retrieve the "Affect Invoice Price" field
      * RTV Accrual Info-All   RT - Accrual Program  * 
     C                     EXSR SNRVGN
      * CASE: LCL.Affect Invoice Price is yes
     C           YL0082    IFEQ 'Y'                        *IF
      * ** Accumulate rate based on All Products Y/N value
      * CASE: DB1.All Products (Y/N) is Yes
     C           WMTTST    IFEQ 'Y'                        *IF
      * ** If YES, then use the rate from the Customer Accrual record
      * Clc Accrual Rates     IF
      * CASE: PAR.Accrual Code is Bellissimo Buyer Group
     C           WMOJCD    IFEQ 'BG3'                      *IF
     C                     ADD  WMBKPR    YL0061           WF BG3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Accrual
     C           WMOJCD    IFEQ 'CA1'                      *IF
     C                     ADD  WMBKPR    YL0063           WF CA1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Rebate
     C           WMOJCD    IFEQ 'CR1'                      *IF
     C                     ADD  WMBKPR    YL0065           WF CR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is GOLBON Buyer Group
     C           WMOJCD    IFEQ 'BG2'                      *IF
     C                     ADD  WMBKPR    YL0059           WF BG2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is MSO-SLC IC Disc Raw
     C           WMOJCD    IFEQ 'IC2'                      *IF
     C                     ADD  WMBKPR    YL0069           WF IC2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Nugget Branded Prod Rbt
     C           WMOJCD    IFEQ 'PR1'                      *IF
     C                     ADD  WMBKPR    YL0073           WF PR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc PC
     C           WMOJCD    IFEQ 'IC3'                      *IF
     C                     ADD  WMBKPR    YL0071           WF IC3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc Raw
     C           WMOJCD    IFEQ 'IC1'                      *IF
     C                     ADD  WMBKPR    YL0067           WF IC1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Swell Allowance 1%
     C           WMOJCD    IFEQ 'SW1'                      *IF
     C                     ADD  WMBKPR    YL0077           WF SW1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Winder Spec Prc Raw
     C           WMOJCD    IFEQ 'SP1'                      *IF
     C                     ADD  WMBKPR    YL0075           WF SP1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Unipro Buyer Group
     C           WMOJCD    IFEQ 'BG1'                      *IF
     C                     ADD  WMBKPR    YL0057           WF BG1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is WalMart Swell Allow
     C           WMOJCD    IFEQ 'WD1'                      *IF
     C                     ADD  WMBKPR    YL0079           WF WD1 Accrual
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is Yes + Exceptions
     C           WMTTST    IFEQ 'X'                        *IF
      * ** If YES + Exceptions, then add the rate from either the Custome
      * ** Accrual Str or Customer Accrual Item file. The value in
      * ** the Accrual Detail Search field will determine which file.
      * ** If no record in either file then add the Customer Accural rate
      * CASE: DB1.Accrual Detail Search is Item
     C           WMQFSX    IFEQ 'I'                        *IF
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0006           Ship To Custome
     C                     MOVELWMOJCD    WL0007    P      Accrual Code
     C                     Z-ADDWMGUNY    WL0008           CAH Sequence No
     C                     Z-ADDWEHGCD    WL0009           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    YL0083           Accrual Rate
      * Clc Accrual Rates     IF
      * CASE: PAR.Accrual Code is Bellissimo Buyer Group
     C           WMOJCD    IFEQ 'BG3'                      *IF
     C                     ADD  YL0083    YL0061           WF BG3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Accrual
     C           WMOJCD    IFEQ 'CA1'                      *IF
     C                     ADD  YL0083    YL0063           WF CA1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Rebate
     C           WMOJCD    IFEQ 'CR1'                      *IF
     C                     ADD  YL0083    YL0065           WF CR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is GOLBON Buyer Group
     C           WMOJCD    IFEQ 'BG2'                      *IF
     C                     ADD  YL0083    YL0059           WF BG2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is MSO-SLC IC Disc Raw
     C           WMOJCD    IFEQ 'IC2'                      *IF
     C                     ADD  YL0083    YL0069           WF IC2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Nugget Branded Prod Rbt
     C           WMOJCD    IFEQ 'PR1'                      *IF
     C                     ADD  YL0083    YL0073           WF PR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc PC
     C           WMOJCD    IFEQ 'IC3'                      *IF
     C                     ADD  YL0083    YL0071           WF IC3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc Raw
     C           WMOJCD    IFEQ 'IC1'                      *IF
     C                     ADD  YL0083    YL0067           WF IC1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Swell Allowance 1%
     C           WMOJCD    IFEQ 'SW1'                      *IF
     C                     ADD  YL0083    YL0077           WF SW1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Winder Spec Prc Raw
     C           WMOJCD    IFEQ 'SP1'                      *IF
     C                     ADD  YL0083    YL0075           WF SP1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Unipro Buyer Group
     C           WMOJCD    IFEQ 'BG1'                      *IF
     C                     ADD  YL0083    YL0057           WF BG1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is WalMart Swell Allow
     C           WMOJCD    IFEQ 'WD1'                      *IF
     C                     ADD  YL0083    YL0079           WF WD1 Accrual
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WMQFSX    IFEQ 'S'                        *IF
      * ** Retrieve the Item Structure fields from the Order Detail
      * Rtv Item FOB Price    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0011           Company Number
     C                     Z-ADDYL0056    WL0012           Order Number
     C                     Z-ADDWEHGCD    WL0013           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    YN0038           Price Overage O
     C                     Z-ADDWL0015    YN0039           Contract Number
     C                     MOVELWL0016    YN0040    P      Price Status
     C                     MOVELWL0017    YN0041    P      U/M - Ordered
     C                     Z-ADDWL0018    YN0042           Unit Price
     C                     Z-ADDWL0019    YN0043           Unit Price - Cr
     C                     Z-ADDWL0020    YN0044           Unit Price Orde
     C                     Z-ADDWL0021    YN0045           Unit Weight Ord
     C                     Z-ADDWL0022    YN0046           Actual Shipped
     C                     MOVELWL0023    YN0047    P      Affect Inventor
     C                     MOVELWL0024    YN0048    P      Affect Sales Do
     C                     MOVELWL0025    YN0049    P      Affect Sales Pn
     C                     Z-ADDWL0026    WN0017           Item Structure
     C                     Z-ADDWL0027    WN0018           Item Structure
     C                     Z-ADDWL0028    WN0019           Item Structure
     C                     MOVELWL0029    YN0050    P      Affect Trade Fu
     C                     MOVELWL0030    YN0051    P      Affect Commissi
     C                     MOVELWL0031    YN0052    P      Affect Pricing
     C                     MOVELWL0032    YN0053    P      Ord TF Exempt C
      * RTV Cust Accrl Str     RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0033           Ship To Custome
     C                     MOVELWMOJCD    WL0034    P      Accrual Code
     C                     Z-ADDWMGUNY    WL0035           CAH Sequence No
     C                     Z-ADDWN0017    WL0036           Item Structure
     C                     Z-ADDWN0018    WL0037           Item Structure
     C                     Z-ADDWN0019    WL0044           Item Structure
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0038    YL0083           Accrual Rate
     C                     MOVELWL0039    YN0030    P      Accrual Rate Ty
     C                     MOVELWL0040    YN0054    P      CAS Unused Sts
     C                     MOVELWL0041    YN0055    P      CAS Unused Sts
     C                     Z-ADDWL0042    YN0056           CAS Rate Unused
     C                     Z-ADDWL0043    YN0057           CAS Rate Unused
     C                     END                             *FI
     C                     END                             *FI
      * ** If accrual rate is still zeros, use rate from cust accrual rec
      * CASE: LCL.Accrual Rate is equal to zero
     C           YL0083    IFEQ 0                          *IF
     C                     Z-ADDWMBKPR    YL0083           Accrual Rate
     C                     END                             *FI
      * Accumulate the Accruals
      * Clc Accrual Rates     IF
      * CASE: PAR.Accrual Code is Bellissimo Buyer Group
     C           WMOJCD    IFEQ 'BG3'                      *IF
     C                     ADD  YL0083    YL0061           WF BG3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Accrual
     C           WMOJCD    IFEQ 'CA1'                      *IF
     C                     ADD  YL0083    YL0063           WF CA1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Rebate
     C           WMOJCD    IFEQ 'CR1'                      *IF
     C                     ADD  YL0083    YL0065           WF CR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is GOLBON Buyer Group
     C           WMOJCD    IFEQ 'BG2'                      *IF
     C                     ADD  YL0083    YL0059           WF BG2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is MSO-SLC IC Disc Raw
     C           WMOJCD    IFEQ 'IC2'                      *IF
     C                     ADD  YL0083    YL0069           WF IC2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Nugget Branded Prod Rbt
     C           WMOJCD    IFEQ 'PR1'                      *IF
     C                     ADD  YL0083    YL0073           WF PR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc PC
     C           WMOJCD    IFEQ 'IC3'                      *IF
     C                     ADD  YL0083    YL0071           WF IC3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc Raw
     C           WMOJCD    IFEQ 'IC1'                      *IF
     C                     ADD  YL0083    YL0067           WF IC1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Swell Allowance 1%
     C           WMOJCD    IFEQ 'SW1'                      *IF
     C                     ADD  YL0083    YL0077           WF SW1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Winder Spec Prc Raw
     C           WMOJCD    IFEQ 'SP1'                      *IF
     C                     ADD  YL0083    YL0075           WF SP1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Unipro Buyer Group
     C           WMOJCD    IFEQ 'BG1'                      *IF
     C                     ADD  YL0083    YL0057           WF BG1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is WalMart Swell Allow
     C           WMOJCD    IFEQ 'WD1'                      *IF
     C                     ADD  YL0083    YL0079           WF WD1 Accrual
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.All Products (Y/N) is No
     C           WMTTST    IFEQ 'N'                        *IF
      * ** If NO, then only accumulate the rate if there is a record
      * ** in either the Customer Accrual Str or Customer Accrual Item
      * ** file. If no record in either file, just add zeros.
      * CASE: DB1.Accrual Detail Search is Item
     C           WMQFSX    IFEQ 'I'                        *IF
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0006           Ship To Custome
     C                     MOVELWMOJCD    WL0007    P      Accrual Code
     C                     Z-ADDWMGUNY    WL0008           CAH Sequence No
     C                     Z-ADDWEHGCD    WL0009           Item Code
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    YL0083           Accrual Rate
     C                     ELSE
      * CASE: DB1.Accrual Detail Search is Item Structure
     C           WMQFSX    IFEQ 'S'                        *IF
      * Rtv Item FOB Price    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0011           Company Number
     C                     Z-ADDYL0056    WL0012           Order Number
     C                     Z-ADDWEHGCD    WL0013           Item Code
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0014    YN0038           Price Overage O
     C                     Z-ADDWL0015    YN0039           Contract Number
     C                     MOVELWL0016    YN0040    P      Price Status
     C                     MOVELWL0017    YN0041    P      U/M - Ordered
     C                     Z-ADDWL0018    YN0042           Unit Price
     C                     Z-ADDWL0019    YN0043           Unit Price - Cr
     C                     Z-ADDWL0020    YN0044           Unit Price Orde
     C                     Z-ADDWL0021    YN0045           Unit Weight Ord
     C                     Z-ADDWL0022    YN0046           Actual Shipped
     C                     MOVELWL0023    YN0047    P      Affect Inventor
     C                     MOVELWL0024    YN0048    P      Affect Sales Do
     C                     MOVELWL0025    YN0049    P      Affect Sales Pn
     C                     Z-ADDWL0026    WN0017           Item Structure
     C                     Z-ADDWL0027    WN0018           Item Structure
     C                     Z-ADDWL0028    WN0019           Item Structure
     C                     MOVELWL0029    YN0050    P      Affect Trade Fu
     C                     MOVELWL0030    YN0051    P      Affect Commissi
     C                     MOVELWL0031    YN0052    P      Affect Pricing
     C                     MOVELWL0032    YN0053    P      Ord TF Exempt C
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Item Structure Type Code is Not Entered
      *   |- c2    : PAR.Item Structure Group Code is Not Entered
      *   '-
     C           WN0017    IFEQ 0                          *IF
     C           WN0018    OREQ 0                          *OR
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
     C                     EXSR SRRVGN
     C                     END                             *FI
      * RTV Cust Accrl Str     RT - Customer Accrual Str  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBBKC7    WL0033           Ship To Custome
     C                     MOVELWMOJCD    WL0034    P      Accrual Code
     C                     Z-ADDWMGUNY    WL0035           CAH Sequence No
     C                     Z-ADDWN0017    WL0036           Item Structure
     C                     Z-ADDWN0018    WL0037           Item Structure
     C                     Z-ADDWN0019    WL0044           Item Structure
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0038    YL0083           Accrual Rate
     C                     MOVELWL0039    YN0030    P      Accrual Rate Ty
     C                     MOVELWL0040    YN0054    P      CAS Unused Sts
     C                     MOVELWL0041    YN0055    P      CAS Unused Sts
     C                     Z-ADDWL0042    YN0056           CAS Rate Unused
     C                     Z-ADDWL0043    YN0057           CAS Rate Unused
     C                     END                             *FI
     C                     END                             *FI
      * Accumulate the Accruals
      * Clc Accrual Rates     IF
      * CASE: PAR.Accrual Code is Bellissimo Buyer Group
     C           WMOJCD    IFEQ 'BG3'                      *IF
     C                     ADD  YL0083    YL0061           WF BG3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Accrual
     C           WMOJCD    IFEQ 'CA1'                      *IF
     C                     ADD  YL0083    YL0063           WF CA1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Customer Rebate
     C           WMOJCD    IFEQ 'CR1'                      *IF
     C                     ADD  YL0083    YL0065           WF CR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is GOLBON Buyer Group
     C           WMOJCD    IFEQ 'BG2'                      *IF
     C                     ADD  YL0083    YL0059           WF BG2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is MSO-SLC IC Disc Raw
     C           WMOJCD    IFEQ 'IC2'                      *IF
     C                     ADD  YL0083    YL0069           WF IC2 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Nugget Branded Prod Rbt
     C           WMOJCD    IFEQ 'PR1'                      *IF
     C                     ADD  YL0083    YL0073           WF PR1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc PC
     C           WMOJCD    IFEQ 'IC3'                      *IF
     C                     ADD  YL0083    YL0071           WF IC3 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is SLC-MSO IC Disc Raw
     C           WMOJCD    IFEQ 'IC1'                      *IF
     C                     ADD  YL0083    YL0067           WF IC1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Swell Allowance 1%
     C           WMOJCD    IFEQ 'SW1'                      *IF
     C                     ADD  YL0083    YL0077           WF SW1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Winder Spec Prc Raw
     C           WMOJCD    IFEQ 'SP1'                      *IF
     C                     ADD  YL0083    YL0075           WF SP1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is Unipro Buyer Group
     C           WMOJCD    IFEQ 'BG1'                      *IF
     C                     ADD  YL0083    YL0057           WF BG1 Accrual
     C                     END                             *FI
      * CASE: PAR.Accrual Code is WalMart Swell Allow
     C           WMOJCD    IFEQ 'WD1'                      *IF
     C                     ADD  YL0083    YL0079           WF WD1 Accrual
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@HORELA                  90*
     C                     ENDDO
      * USER: Exit processing
      * RTV Item Pricing Info  RT - Company Item  * 
     C                     EXSR SSRVGN
      * CASE: If pricing CW/Thousand or Tons
      *  - c1 OR c3 OR c4
      *   |- c1    : LCL.U/M - Pricing is Carcass Hundred Weight
      *   |- c3    : LCL.U/M - Pricing is Thousand
      *   |- c4    : LCL.U/M - Pricing is Tons
      *   '-
     C           YL0084    IFEQ 'CW'                       *IF
     C           YL0084    OREQ 'M'                        *OR
     C           YL0084    OREQ 'TN'                       *OR
      * Hundred Weight
      * CASE: LCL.U/M - Pricing is Hundred Weight
     C           YL0084    IFEQ 'CW'                       *IF
     C                     Z-ADD100       YL0085           Usr Number fiel
     C                     END                             *FI
      * Thousand
      * CASE: LCL.U/M - Pricing is Thousand
     C           YL0084    IFEQ 'M'                        *IF
     C                     Z-ADD1000      YL0085           Usr Number fiel
     C                     END                             *FI
      * Tons
      * CASE: LCL.U/M - Pricing is Tons
     C           YL0084    IFEQ 'TN'                       *IF
     C                     Z-ADD2000      YL0085           Usr Number fiel
     C                     END                             *FI
      * Cnv Accrual Rte CW    IF
      * CASE: PAR.WF BG1 Accrual is Greater than zero
     C           YL0057    IFGT 0                          *IF
      * PAR.WF BG1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF BG1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0057    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0057           WF BG1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF BG2 Accrual is Greater than 0
     C           YL0059    IFGT 0                          *IF
      * PAR.WF BG2 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF BG2 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0059    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0059           WF BG2 Accrual
     C                     END                             *FI
      * CASE: PAR.WF BG3 Accrual is Greater than zero
     C           YL0061    IFGT 0                          *IF
      * PAR.WF BG3 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF BG3 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0061    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0061           WF BG3 Accrual
     C                     END                             *FI
      * CASE: PAR.WF CA1 Accrual is Greater than Zero
     C           YL0063    IFGT 0                          *IF
      * PAR.WF CA1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF CA1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0063    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0063           WF CA1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF CR1 Accrual is Greater than Zero
     C           YL0065    IFGT 0                          *IF
      * PAR.WF CR1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF CR1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0065    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0065           WF CR1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF IC2 Accrual is Greater than Zero
     C           YL0069    IFGT 0                          *IF
      * PAR.WF IC2 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF IC2 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0069    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0069           WF IC2 Accrual
     C                     END                             *FI
      * CASE: PAR.WF PR1 Accrual is Greater than Zero
     C           YL0073    IFGT 0                          *IF
      * PAR.WF PR1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF PR1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0073    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0073           WF PR1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF IC3 Accrual is Greater than Zero
     C           YL0071    IFGT 0                          *IF
      * PAR.WF IC3 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF IC3 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0071    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0071           WF IC3 Accrual
     C                     END                             *FI
      * CASE: PAR.WF IC1 Accrual is Greater than Zero
     C           YL0067    IFGT 0                          *IF
      * PAR.WF IC1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF IC1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0067    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0067           WF IC1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF SW1 Accrual is Greater than Zero
     C           YL0077    IFGT 0                          *IF
      * PAR.WF SW1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF SW1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0077    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0077           WF SW1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF SP1 Accrual is Greater than Zero
     C           YL0075    IFGT 0                          *IF
      * PAR.WF SP1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF SP1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0075    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0075           WF SP1 Accrual
     C                     END                             *FI
      * CASE: PAR.WF WD1 Accrual is Greater than Zero
     C           YL0079    IFGT 0                          *IF
      * PAR.WF WD1 Accrual =
      *    *COMPUTE (x1*x2)
      * x1    : PAR.WF WD1 Accrual
      * *     : PGM.*Synon (15,5) work field *
      * x2    : PAR.Usr Number field
     C           YL0079    MULT YL0085    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0079           WF WD1 Accrual
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Accrual Info-All   RT - Accrual Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WOOJCD           Accrual Code
      * Setup key
     C                     MOVELWMOJCD    WOOJCD           Accrual Code
      * Establish starting position
     C           KRSSN     CHAIN@HLREK4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1514' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0082           Affect Invoice
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELWOFFTX    YL0082           Affect Invoice
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Item Accrual Rate RT - Customer Accrual Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WRBKC7           Ship To Custome
     C                     KFLD           WROJCD           Accrual Code
     C                     KFLD           WRGUNY           CAH Sequence No
     C                     KFLD           WRHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0006    WRBKC7           Ship To Custome
     C                     MOVELWL0007    WROJCD           Accrual Code
     C                     Z-ADDWL0008    WRGUNY           CAH Sequence No
     C                     Z-ADDWL0009    WRHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@HPRELD              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1522' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0010           Accrual Rate
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWRBKPR    WL0010           Accrual Rate
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Item FOB Price    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WSC4NB    WQSP02           Order Number
     C           *LIKE     DEFN WSHGCD    WQSP03           Item Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Order Number
     C                     KFLD           WQSP03           Item Code
      * Setup key
     C                     Z-ADDWL0011    WQSP01           Company Number
     C                     Z-ADDWL0012    WQSP02           Order Number
     C                     Z-ADDWL0013    WQSP03           Item Code
      * Establish starting position
     C           KRSSP     SETLL@BGWKFW                    *
     C           KRSSP     READE@BGWKFW                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0014           Price Overage O
     C                     Z-ADD*ZERO     WL0015           Contract Number
     C                     MOVEL*BLANK    WL0016           Price Status
     C                     MOVEL*BLANK    WL0017           U/M - Ordered
     C                     Z-ADD*ZERO     WL0018           Unit Price
     C                     Z-ADD*ZERO     WL0019           Unit Price - Cr
     C                     Z-ADD*ZERO     WL0020           Unit Price Orde
     C                     Z-ADD*ZERO     WL0021           Unit Weight Ord
     C                     Z-ADD*ZERO     WL0022           Actual Shipped
     C                     MOVEL*BLANK    WL0023           Affect Inventor
     C                     MOVEL*BLANK    WL0024           Affect Sales Do
     C                     MOVEL*BLANK    WL0025           Affect Sales Pn
     C                     Z-ADD*ZERO     WL0026           Item Structure
     C                     Z-ADD*ZERO     WL0027           Item Structure
     C                     Z-ADD*ZERO     WL0028           Item Structure
     C                     MOVEL*BLANK    WL0029           Affect Trade Fu
     C                     MOVEL*BLANK    WL0030           Affect Commissi
     C                     MOVEL*BLANK    WL0031           Affect Pricing
     C                     MOVEL*BLANK    WL0032           Ord TF Exempt C
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWSBZPR    WL0014           Price Overage O
     C                     Z-ADDWSL6NB    WL0015           Contract Number
     C                     MOVELWSU1ST    WL0016           Price Status
     C                     MOVELWSAGCD    WL0017           U/M - Ordered
     C                     Z-ADDWSAKPR    WL0018           Unit Price
     C                     Z-ADDWSALPR    WL0019           Unit Price - Cr
     C                     Z-ADDWSAUPR    WL0020           Unit Price Orde
     C                     Z-ADDWSAVWG    WL0021           Unit Weight Ord
     C                     Z-ADDWSGNDT    WL0022           Actual Shipped
     C                     MOVELWSAMST    WL0023           Affect Inventor
     C                     MOVELWSANST    WL0024           Affect Sales Do
     C                     MOVELWSVAST    WL0025           Affect Sales Pn
     C                     Z-ADDWSRGNB    WL0026           Item Structure
     C                     Z-ADDWSRHNB    WL0027           Item Structure
     C                     Z-ADDWSRINB    WL0028           Item Structure
     C                     MOVELWSF0SX    WL0029           Affect Trade Fu
     C                     MOVELWSF1SX    WL0030           Affect Commissi
     C                     MOVELWSF2SX    WL0031           Affect Pricing
     C                     MOVELWSF4SX    WL0032           Ord TF Exempt C
     C           KRSSP     READE@BGWKFW                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Cust Accrl Str     RT - Customer Accrual Str  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0038           Accrual Rate
     C                     MOVEL*BLANK    WL0039           Accrual Rate Ty
     C                     MOVEL*BLANK    WL0040           CAS Unused Sts
     C                     MOVEL*BLANK    WL0041           CAS Unused Sts
     C                     Z-ADD*ZERO     WL0042           CAS Rate Unused
     C                     Z-ADD*ZERO     WL0043           CAS Rate Unused
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTBKC7    WQSQ01           Ship To Custome
     C           *LIKE     DEFN WTOJCD    WQSQ02           Accrual Code
     C           *LIKE     DEFN WTGUNY    WQSQ03           CAH Sequence No
     C           *LIKE     DEFN WTRGNB    WQSQ04           Item Structure
     C           *LIKE     DEFN WTRHNB    WQSQ05           Item Structure
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Ship To Custome
     C                     KFLD           WQSQ02           Accrual Code
     C                     KFLD           WQSQ03           CAH Sequence No
     C                     KFLD           WQSQ04           Item Structure
     C                     KFLD           WQSQ05           Item Structure
      * Setup key
     C                     Z-ADDWL0033    WQSQ01           Ship To Custome
     C                     MOVELWL0034    WQSQ02           Accrual Code
     C                     Z-ADDWL0035    WQSQ03           CAH Sequence No
     C                     Z-ADDWL0036    WQSQ04           Item Structure
     C                     Z-ADDWL0037    WQSQ05           Item Structure
      * Establish starting position
     C           KRSSQ     SETLL@C8RES1                    *
     C           KRSSQ     READE@C8RES1                  90*
      * Data record not found
     C   90                MOVEL'USR3294' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Item Structure Class Code is Equal Zero
     C           WTRINB    IFEQ 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDWTBKPR    WL0038           Accrual Rate
     C                     MOVELWTSHSX    WL0039           Accrual Rate Ty
     C                     MOVELWTQTSX    WL0040           CAS Unused Sts
     C                     MOVELWTQUSX    WL0041           CAS Unused Sts
     C                     Z-ADDWTFKPR    WL0042           CAS Rate Unused
     C                     Z-ADDWTFLPR    WL0043           CAS Rate Unused
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Item Structure Class Code EQ PAR.Item Structure Class U
     C           WTRINB    IFEQ WL0044                     *IF
      * PAR = DB1 By name
     C                     Z-ADDWTBKPR    WL0038           Accrual Rate
     C                     MOVELWTSHSX    WL0039           Accrual Rate Ty
     C                     MOVELWTQTSX    WL0040           CAS Unused Sts
     C                     MOVELWTQUSX    WL0041           CAS Unused Sts
     C                     Z-ADDWTFKPR    WL0042           CAS Rate Unused
     C                     Z-ADDWTFLPR    WL0043           CAS Rate Unused
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSQ     READE@C8RES1                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WEAIC3           Company Number
     C                     Z-ADDWEHGCD    WEHGCD           Item Code
      * Establish starting position
     C           KRSSR     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWERINB    WN0019           Item Structure
     C                     Z-ADDWERHNB    WN0018           Item Structure
     C                     Z-ADDWERGNB    WN0017           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Item Pricing Info  RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEHGCD           Item Code
      * Setup key
     C                     Z-ADDWEAIC3    WEAIC3           Company Number
     C                     Z-ADDWEHGCD    WEHGCD           Item Code
      * Establish starting position
     C           KRSSS     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAICD    YL0084           U/M - Pricing
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV Salesperson NmeOnlyRT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WVBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0026    WVBCCD           Salesperson Cod
      * Establish starting position
     C           KRSST     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0086           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVALTX    YL0086           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Broker Name       RT - Broker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WWHHAA           Broker Code
      * Setup key
     C                     MOVELYL0025    WWHHAA           Broker Code
      * Establish starting position
     C           KRSSU     CHAIN@C5RESJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3288' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0088           Broker Name
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWC4T1    YL0088           Broker Name
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create WF Sales/Broker Pr - WF Sales/Broker Pricing  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E7CPZ4
     C                     Z-ADDWEAIC3    WXAIC3           Company Number
     C                     Z-ADDWBBKC7    WXBKC7           Ship To Custome
     C                     Z-ADDWEHGCD    WXHGCD           Item Code
     C                     Z-ADDYL0001    WXS8DT           WF Begin Date
     C                     MOVELYL0038    WXAYTX           Customer Name
     C                     MOVELWEAVNA    WXGENA           Item Descriptio
     C                     MOVELYL0087    WXKVAA           Mkt Salesperson
     C                     MOVELYL0086    WXUGT1           Mkt Salesperson
     C                     MOVELYL0089    WXKWAA           Mkt Broker Code
     C                     MOVELYL0088    WXUHT1           Mkt Broker Name
     C                     Z-ADDYL0054    WXLMNY           Absorbed Freigh
     C                     Z-ADDYL0046    WXGMPR           Published price
     C                     Z-ADDYL0030    WXGNPR           Deviated price
     C                     Z-ADDYL0032    WXBVTM           Price Code
     C                     MOVELWEAICD    WXAICD           U/M - Pricing
     C                     MOVELWELRCD    WXLRCD           Commodity Price
     C                     MOVELWEQ8CD    WXQ7CD           Price Method Co
     C                     Z-ADDP2MIDT    WXS7DT           WF End Date
     C                     MOVELYL0022    WXISAA           Market Code
     C                     Z-ADDYL0031    WXS9DT           WF Market Price
     C                     Z-ADDWERHNB    WXOXNY           WF Item Struct
     C                     Z-ADDWERINB    WXOYNY           WF Item Struct
     C                     Z-ADDWERGNB    WXOWNY           WF Item Struct
     C                     MOVEL'BG1'     WXKXAA           WF BG1 Accrual
     C                     Z-ADDYL0057    WXJNVL           WF BG1 Accrual
     C                     MOVEL'BG2'     WXKYAA           WF BG2 Accrual
     C                     Z-ADDYL0059    WXJ3VL           WF BG2 Accrual
     C                     MOVEL'BG3'     WXKZAA           WF BG3 Accrual
     C                     Z-ADDYL0061    WXJ4VL           WF BG3 Accrual
     C                     MOVEL'CA1'     WXLCAA           WF CA1 Accrual
     C                     Z-ADDYL0063    WXKTVL           WF CA1 Accrual
     C                     MOVEL'CR1'     WXLDAA           WF CR1 Accrual
     C                     Z-ADDYL0065    WXKUVL           WF CR1 Accrual
     C                     MOVEL'IC1'     WXLEAA           WF IC1 Accrual
     C                     Z-ADDYL0067    WXKVVL           WF IC1 Accrual
     C                     MOVEL'IC2'     WXLFAA           WF IC2 Accrual
     C                     Z-ADDYL0069    WXKWVL           WF IC2 Accrual
     C                     MOVEL'IC3'     WXLGAA           WF IC3 Accrual
     C                     Z-ADDYL0071    WXKXVL           WF IC3 Accrual
     C                     MOVEL'PR1'     WXLHAA           WF PR1 Accrual
     C                     Z-ADDYL0073    WXKYVL           WF PR1 Accrual
     C                     MOVEL'SP1'     WXLIAA           WF SP1 Accrual
     C                     Z-ADDYL0075    WXKZVL           WF SP1 Accrual
     C                     MOVEL'SW1'     WXLJAA           WF SW1 Accrual
     C                     Z-ADDYL0077    WXK1VL           WF SW1 Accrual
     C                     MOVEL'WD1'     WXLKAA           WF WD1 Accrual
     C                     Z-ADDYL0079    WXK2VL           WF WD1 Accrual
     C                     MOVELYL0090    WXLAAA           WF Accrual 1 CD
     C                     Z-ADDYL0091    WXK3VL           WF Accrual 1 no
     C                     MOVELYL0092    WXLBAA           WF Accrual 2 CD
     C                     Z-ADDYL0093    WXK4VL           WF Accrual 2 no
     C                     MOVELYL0094    WXDVST           WF Flag 1
     C                     MOVELYL0095    WXDWST           WF Status Unuse
     C                     MOVELYL0096    WXDYST           WF Status Unuse
     C                     MOVELYL0097    WXDZST           WF Status Unuse
     C                     Z-ADDYL0098    WXS0DT           WF Date unused
     C                     Z-ADDYL0099    WXS1DT           WF Date unused
     C                     Z-ADDYL0100    WXGOPR           WF Price Unused
      *
     C           KLCRSV    KLIST
     C                     KFLD           WXAIC3           Company Number
     C                     KFLD           WXBKC7           Ship To Custome
     C                     KFLD           WXHGCD           Item Code
     C                     KFLD           WXS8DT           WF Begin Date
      * Check for duplicate primary key
     C           KLCRSV    SETLL@E7CPZ4                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4112' W0RTN   7
      * Send message 'WF Sales/Broker Pricin EX'
     C                     MOVEL'USR4112' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@E7CPZ4                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * Market Price will be converted to CWT because Overages will be
      * by CWT if it is Customer Overage, and Market Price may not be.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * *****
      * ** Accumulate rate for all Accrual Codes for this Ship To
      * ** Customer based on the value in the All Products Y/N field
      * **
      * ** If Actual Shipped Date is zeros, use the Requested Ship Date.
      * **
      * ** If YES, then use the rate from the Customer Accrual record.
      * **
      * ** If YES + EXCEPTIONS, then use the rate from either the Custome
      * ** Accrual Structure or Customer Accrual Item file which is based
      * ** on the value in Accrual Detail Search field. If no record in
      * ** either file, then use the rate in the Customer Accrual record.
      * **
      * ** If NO, then only accumulate the rate if there is a record
      * ** in either the Customer Accrual Str or Customer Accrual Item
      * ** file. If no record in either file, just add zeros.
      * **
      * ** Price will be converted to CWT
      * *****
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WACQNB           Julian Date
     C                     Z-ADD*ZERO     WAESNB           Accounting Year
     C                     Z-ADD*ZERO     WAETNB           Accounting Peri
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAEINB           Week Number
     C                     Z-ADD*ZERO     WAAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WAOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WANQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WANRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WAOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WAOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBP3NB           D & B Number
     C                     Z-ADD*ZERO     WBI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WBAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WBVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WBI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCAAC8           Customer G/L Ve
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDMJDT           Create Date
     C                     Z-ADD*ZERO     WDBETM           Create Time
     C                     Z-ADD*ZERO     WDMKDT           Change Date
     C                     Z-ADD*ZERO     WDBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WEAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WEAIWG           Unit Weight
     C                     Z-ADD*ZERO     WECZWG           Minimum Weight
     C                     Z-ADD*ZERO     WEC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WEURTN           Number Cases On
     C                     Z-ADD*ZERO     WEAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WETFNB           Transportation
     C                     Z-ADD*ZERO     WETMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WETNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WEBLPR           Market Overage
     C                     Z-ADD*ZERO     WEBMPR           Standard Overag
     C                     Z-ADD*ZERO     WECMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WECHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WESWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WEPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WEICN1           Item Category N
     C                     Z-ADD*ZERO     WEICN2           Item Category N
     C                     Z-ADD*ZERO     WEV2NB           Item Category N
     C                     Z-ADD*ZERO     WEITCN           Item Category N
     C                     Z-ADD*ZERO     WEITC5           Item Category N
     C                     Z-ADD*ZERO     WEICN6           Item Category N
     C                     Z-ADD*ZERO     WEICN7           Item Category N
     C                     Z-ADD*ZERO     WEICN8           Item Category N
     C                     Z-ADD*ZERO     WEICN9           Item Category N
     C                     Z-ADD*ZERO     WEICN0           Item Category N
     C                     Z-ADD*ZERO     WESFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WEA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WESJNB           Production Lead
     C                     Z-ADD*ZERO     WESKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WESLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WESMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WECFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WECGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WEILNB           Packages per ca
     C                     Z-ADD*ZERO     WECHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WECINB           PM Batch Size
     C                     Z-ADD*ZERO     WECJNB           Package Level s
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WECNNB           WIP Item Code
     C                     Z-ADD*ZERO     WECRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WECSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WECVNB           FP Std Green We
     C                     Z-ADD*ZERO     WECWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WECXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WECZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WEC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WEB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WEB5NB           PM Line Number
     C                     Z-ADD*ZERO     WEBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WEBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WEF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WEF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WEF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WEBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WEBNNB           Production Qty
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFBVTM           Price Code
     C                     Z-ADD*ZERO     WFPLDT           Price Start Dat
     C                     Z-ADD*ZERO     WFPMDT           Price End Date
     C                     Z-ADD*ZERO     WFPNDT           Date Entered
     C                     Z-ADD*ZERO     WFCJTM           Time Entered
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WGBVTM           Price Code
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGKWWG           Maximum Contrac
     C                     Z-ADD*ZERO     WGFIPR           Customer Price
     C                     Z-ADD*ZERO     WGKXWG           CPD Weight Unus
     C                     Z-ADD*ZERO     WGFJPR           CPD Price Unuse
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIAIC3           Company Number
     C                     Z-ADD*ZERO     WICPRD           CTL Prior Day
     C                     Z-ADD*ZERO     WIQMNB           CTL Prior Week
     C                     Z-ADD*ZERO     WICNOT           CTL Number of T
     C                     Z-ADD*ZERO     WICDOW           CTL Day of Week
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJEQDT           Market Price Da
     C                     Z-ADD*ZERO     WJA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WJB8PR           Projected Marke
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKG2PC           Market Percent
     C                     Z-ADD*ZERO     WKG8PR           Market Prem/Ded
     C                     Z-ADD*ZERO     WKMJDT           Create Date
     C                     Z-ADD*ZERO     WKBETM           Create Time
     C                     Z-ADD*ZERO     WKMKDT           Change Date
     C                     Z-ADD*ZERO     WKBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WLR5NB           Deliver after t
     C                     Z-ADD*ZERO     WLR6NB           Deliver before
     C                     Z-ADD*ZERO     WLTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WLMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WLW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field USR Date Shipped
     C                     Z-ADD*ZERO     WUFADT  70
      * Define work field Accrual Code
     C                     MOVEL*BLANK    WUOJCD  3
      * Define work field Period Ending Date
     C                     Z-ADD*ZERO     WUA2DT  70
      * Define work field Accrual Rate
     C                     Z-ADD*ZERO     WUBKPR  96
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WMGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WMBFDT           Period Beginnin
     C                     Z-ADD*ZERO     WMA2DT           Period Ending D
     C                     Z-ADD*ZERO     WMBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WMPJDT           CAH Unused Date
     C                     Z-ADD*ZERO     WMPKDT           CAH Unused Date
     C                     Z-ADD*ZERO     WMECVL           Comm Min Amt /P
     C                     Z-ADD*ZERO     WMHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WOHQVL           Max Accrual Amo
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WRGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WSAIC3           Company Number
     C                     Z-ADD*ZERO     WSC4NB           Order Number
     C                     Z-ADD*ZERO     WSDPNB           Order Sequence
     C                     Z-ADD*ZERO     WSUENB           Order Secondary
     C                     Z-ADD*ZERO     WSHGCD           Item Code
     C                     Z-ADD*ZERO     WSBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WSCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WSMAVA           Billing Detail
     C                     Z-ADD*ZERO     WSKDVA           Billing Detail
     C                     Z-ADD*ZERO     WSL8VA           Billing Detail
     C                     Z-ADD*ZERO     WSL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WSAYVA           Extended Amount
     C                     Z-ADD*ZERO     WSEXDT           Market Pricing
     C                     Z-ADD*ZERO     WSBZPR           Price Overage O
     C                     Z-ADD*ZERO     WSL6NB           Contract Number
     C                     Z-ADD*ZERO     WSGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WSR1NB           Rated Freight
     C                     Z-ADD*ZERO     WSAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WSD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WSCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WSAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WSCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WSATWG           Weight Shipped
     C                     Z-ADD*ZERO     WSAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WSAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WSAKPR           Unit Price
     C                     Z-ADD*ZERO     WSALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WSAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WSAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WSA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WSA5DT           Requested Ship
     C                     Z-ADD*ZERO     WSAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WSGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WSRGNB           Item Structure
     C                     Z-ADD*ZERO     WSRHNB           Item Structure
     C                     Z-ADD*ZERO     WSRINB           Item Structure
     C                     Z-ADD*ZERO     WSCXDT           Date of Origina
     C                     Z-ADD*ZERO     WSDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WSB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WSA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WSNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WSNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WSNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WSNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WSNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WSBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WSBVTM           Price Code
     C                     Z-ADD*ZERO     WSBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WSBXTM           Substitution Li
     C                     Z-ADD*ZERO     WSBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WSH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WSH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WSH7NX           OD Item Target
     C                     Z-ADD*ZERO     WSH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WSH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WSDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WSDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WSDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WSDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WSDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WSGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WSGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WSGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WSPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WSRINY           Item Age Days
     C                     Z-ADD*ZERO     WSTIDT           Production Ovr
     C                     Z-ADD*ZERO     WSTJDT           Production Ovr
     C                     Z-ADD*ZERO     WSTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WSTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WSTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WTGUNY           CAH Sequence No
     C                     Z-ADD*ZERO     WTRGNB           Item Structure
     C                     Z-ADD*ZERO     WTRHNB           Item Structure
     C                     Z-ADD*ZERO     WTRINB           Item Structure
     C                     Z-ADD*ZERO     WTBKPR           Accrual Rate
     C                     Z-ADD*ZERO     WTFKPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WTFLPR           CAS Rate Unused
     C                     Z-ADD*ZERO     WTAATM           Job Time
     C                     Z-ADD*ZERO     WTAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAIC3           Company Number
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWDAT1           Broker G/L Vend
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXAIC3           Company Number
     C                     Z-ADD*ZERO     WXBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WXHGCD           Item Code
     C                     Z-ADD*ZERO     WXS8DT           WF Begin Date
     C                     Z-ADD*ZERO     WXLMNY           Absorbed Freigh
     C                     Z-ADD*ZERO     WXGMPR           Published price
     C                     Z-ADD*ZERO     WXGNPR           Deviated price
     C                     Z-ADD*ZERO     WXBVTM           Price Code
     C                     Z-ADD*ZERO     WXS7DT           WF End Date
     C                     Z-ADD*ZERO     WXS9DT           WF Market Price
     C                     Z-ADD*ZERO     WXOXNY           WF Item Struct
     C                     Z-ADD*ZERO     WXOYNY           WF Item Struct
     C                     Z-ADD*ZERO     WXOWNY           WF Item Struct
     C                     Z-ADD*ZERO     WXJNVL           WF BG1 Accrual
     C                     Z-ADD*ZERO     WXJ3VL           WF BG2 Accrual
     C                     Z-ADD*ZERO     WXJ4VL           WF BG3 Accrual
     C                     Z-ADD*ZERO     WXKTVL           WF CA1 Accrual
     C                     Z-ADD*ZERO     WXKUVL           WF CR1 Accrual
     C                     Z-ADD*ZERO     WXKVVL           WF IC1 Accrual
     C                     Z-ADD*ZERO     WXKWVL           WF IC2 Accrual
     C                     Z-ADD*ZERO     WXKXVL           WF IC3 Accrual
     C                     Z-ADD*ZERO     WXKYVL           WF PR1 Accrual
     C                     Z-ADD*ZERO     WXKZVL           WF SP1 Accrual
     C                     Z-ADD*ZERO     WXK1VL           WF SW1 Accrual
     C                     Z-ADD*ZERO     WXK2VL           WF WD1 Accrual
     C                     Z-ADD*ZERO     WXK3VL           WF Accrual 1 no
     C                     Z-ADD*ZERO     WXK4VL           WF Accrual 2 no
     C                     Z-ADD*ZERO     WXS0DT           WF Date unused
     C                     Z-ADD*ZERO     WXS1DT           WF Date unused
     C                     Z-ADD*ZERO     WXGOPR           WF Price Unused
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  7
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004 114
     C                     Z-ADD*ZERO     WL0005  70
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  3
     C                     Z-ADD*ZERO     WL0008  50
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010  96
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014 114
     C                     Z-ADD*ZERO     WL0015  70
     C                     MOVEL*BLANK    WL0016  1
     C                     MOVEL*BLANK    WL0017  2
     C                     Z-ADD*ZERO     WL0018 114
     C                     Z-ADD*ZERO     WL0019 114
     C                     Z-ADD*ZERO     WL0020 114
     C                     Z-ADD*ZERO     WL0021 112
     C                     Z-ADD*ZERO     WL0022  70
     C                     MOVEL*BLANK    WL0023  1
     C                     MOVEL*BLANK    WL0024  1
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  30
     C                     Z-ADD*ZERO     WL0028  30
     C                     MOVEL*BLANK    WL0029  1
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031  1
     C                     MOVEL*BLANK    WL0032  2
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  3
     C                     Z-ADD*ZERO     WL0035  50
     C                     Z-ADD*ZERO     WL0036  30
     C                     Z-ADD*ZERO     WL0037  30
     C                     Z-ADD*ZERO     WL0038  96
     C                     MOVEL*BLANK    WL0039  2
     C                     MOVEL*BLANK    WL0040  1
     C                     MOVEL*BLANK    WL0041  1
     C                     Z-ADD*ZERO     WL0042  96
     C                     Z-ADD*ZERO     WL0043  96
     C                     Z-ADD*ZERO     WL0044  30
      * Define local work field Sunday                USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Customer Name
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Ship To Customer Flag
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0004  1
      * Define local work field Internet Password
     C                     MOVEL*BLANK    YL0005 10
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0006 50
      * Define local work field Email User ID
     C                     MOVEL*BLANK    YL0007  8
      * Define local work field EDI Trading Partner No.
     C                     MOVEL*BLANK    YL0008  6
      * Define local work field EDI Cust Duns Number
     C                     MOVEL*BLANK    YL0009 20
      * Define local work field EDI Warehouse/Store No.
     C                     MOVEL*BLANK    YL0010 20
      * Define local work field State Tax ID
     C                     MOVEL*BLANK    YL0011 20
      * Define local work field Cust Shipping Temp C/F
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field One Invoice Per PO
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field EDI Advanced Ship Notice
     C                     MOVEL*BLANK    YL0014  1
      * Define local work field Customer G/L Vendor Num
     C                     Z-ADD*ZERO     YL0015  80
      * Define local work field Air Freight Orders
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Regional Mgr Fax/Email
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Employee Meat Sales Y/N
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Customer TF Exempt Code
     C                     MOVEL*BLANK    YL0019  2
      * Define local work field Customer Watch Flag
     C                     MOVEL*BLANK    YL0020  2
      * Define local work field Customer Sales Region
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field Customer Market Code
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Market Desc
     C                     MOVEL*BLANK    YL0023 30
      * Define local work field Market Type
     C                     MOVEL*BLANK    YL0024  1
      * Define local work field Broker Code
     C                     MOVEL*BLANK    YL0025  6
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0026  3
      * Define null work field Regional Salesperson
     C                     MOVEL*BLANK    YN0001  3
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0027  30
      * Define local work field Item Code
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field Description Line One
     C                     MOVEL*BLANK    YL0029 30
      * Define local work field Customer Price /UM Prc
     C                     Z-ADD*ZERO     YL0030 114
      * Define local work field Pricing Date Used
     C                     Z-ADD*ZERO     YL0031  70
      * Define local work field Price Code
     C                     Z-ADD*ZERO     YL0032  60
      * Define local work field Maximum Contract Units
     C                     Z-ADD*ZERO     YL0033 112
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0034  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0035  3
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0036  3
      * Define local work field Contract Unit Type
     C                     MOVEL*BLANK    YL0037  1
      * Define local work field Customer Name
     C                     MOVEL*BLANK    YL0038 30
      * Define local work field Market Pricing Date
     C                     Z-ADD*ZERO     YL0039  70
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0040  70
      * Define local work field Requested Delivery Date
     C                     Z-ADD*ZERO     YL0041  70
      * Define local work field Requested Ship Date
     C                     Z-ADD*ZERO     YL0042  70
      * Define local work field Date of Orig. Entry Det.
     C                     Z-ADD*ZERO     YL0043  70
      * Define local work field Default Commod Mark basis
     C                     MOVEL*BLANK    YL0044  3
      * Define local work field Price Status
     C                     MOVEL*BLANK    YL0045  1
      * Define local work field Published Price       USR
     C                     Z-ADD*ZERO     YL0046  94
      * Define local work field OD Market Begin Date
     C                     Z-ADD*ZERO     YL0047  70
      * Define local work field OD Market Ending Date
     C                     Z-ADD*ZERO     YL0048  70
      * Define local work field Error Return
     C                     MOVEL*BLANK    YL0049  5
      * Define local work field Item Code Txt
     C                     MOVEL*BLANK    YL0050  7
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0051  3
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0002  7
      * Define local work field Market Percent
     C                     Z-ADD*ZERO     YL0052  52
      * Define null work field Market Prem/Ded
     C                     Z-ADD*ZERO     YN0003  94
      * Define local work field USR Value
     C                     Z-ADD*ZERO     YL0053 112
      * Define local work field Absorbed Freight 7.2  USR
     C                     Z-ADD*ZERO     YL0054  72
      * Define local work field Accrual (Pricing)     USR
     C                     Z-ADD*ZERO     YL0055  94
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0056  70
      * Define local work field WF BG1 Accrual
     C                     Z-ADD*ZERO     YL0057 112
      * Define local work field WF BG1 Accrual Code
     C                     MOVEL*BLANK    YL0058  3
      * Define local work field WF BG2 Accrual
     C                     Z-ADD*ZERO     YL0059 112
      * Define local work field WF BG2 Accrual Code
     C                     MOVEL*BLANK    YL0060  3
      * Define local work field WF BG3 Accrual
     C                     Z-ADD*ZERO     YL0061 112
      * Define local work field WF BG3 Accrual Code
     C                     MOVEL*BLANK    YL0062  3
      * Define local work field WF CA1 Accrual
     C                     Z-ADD*ZERO     YL0063 112
      * Define local work field WF CA1 Accrual Code
     C                     MOVEL*BLANK    YL0064  3
      * Define local work field WF CR1 Accrual
     C                     Z-ADD*ZERO     YL0065 112
      * Define local work field WF CR1 Accrual Code
     C                     MOVEL*BLANK    YL0066  3
      * Define local work field WF IC1 Accrual
     C                     Z-ADD*ZERO     YL0067 112
      * Define local work field WF IC1 Accrual Code
     C                     MOVEL*BLANK    YL0068  3
      * Define local work field WF IC2 Accrual
     C                     Z-ADD*ZERO     YL0069 112
      * Define local work field WF IC2 Accrual Code
     C                     MOVEL*BLANK    YL0070  3
      * Define local work field WF IC3 Accrual
     C                     Z-ADD*ZERO     YL0071 112
      * Define local work field WF IC3 Accrual Code
     C                     MOVEL*BLANK    YL0072  3
      * Define local work field WF PR1 Accrual
     C                     Z-ADD*ZERO     YL0073 112
      * Define local work field WF PR1 Accrual Code
     C                     MOVEL*BLANK    YL0074  3
      * Define local work field WF SP1 Accrual
     C                     Z-ADD*ZERO     YL0075 112
      * Define local work field WF SP1 Accrual Code
     C                     MOVEL*BLANK    YL0076  3
      * Define local work field WF SW1 Accrual
     C                     Z-ADD*ZERO     YL0077 112
      * Define local work field WF SW1 Accrual Code
     C                     MOVEL*BLANK    YL0078  3
      * Define local work field WF WD1 Accrual
     C                     Z-ADD*ZERO     YL0079 112
      * Define local work field WF WD1 Accrual Code
     C                     MOVEL*BLANK    YL0080  3
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0081  96
      * Define null work field All Products (Y/N)
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Accrual Rate Type
     C                     MOVEL*BLANK    YN0005  2
      * Define null work field Comm Threshold Period
     C                     MOVEL*BLANK    YN0006  2
      * Define null work field CAH Unused Date 1
     C                     Z-ADD*ZERO     YN0007  70
      * Define null work field CAH Unused Date 2
     C                     Z-ADD*ZERO     YN0008  70
      * Define null work field Comm Min Amt /Period
     C                     Z-ADD*ZERO     YN0009 112
      * Define null work field Comm Retroactive Sts
     C                     MOVEL*BLANK    YN0010  1
      * Define null work field Accrual Detail Search
     C                     MOVEL*BLANK    YN0011  1
      * Define null work field Broker Code
     C                     MOVEL*BLANK    YN0012  6
      * Define null work field Max Accrual Amount
     C                     Z-ADD*ZERO     YN0013 112
      * Define null work field Accrual Description
     C                     MOVEL*BLANK    YN0014 30
      * Define null work field Automatic Accrual (Y/N)
     C                     MOVEL*BLANK    YN0015  1
      * Define null work field Print On Invoice (Y/N)
     C                     MOVEL*BLANK    YN0016  1
      * Define null work field Rate Usage
     C                     MOVEL*BLANK    YN0017  1
      * Define null work field Add-on/Allowance
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field Accrual Type
     C                     MOVEL*BLANK    YN0019  2
      * Define null work field Sub Ledger Code
     C                     MOVEL*BLANK    YN0020  2
      * Define null work field Reverse Accrual Code
     C                     MOVEL*BLANK    YN0021  3
      * Define null work field U/M - Primary Dft
     C                     MOVEL*BLANK    YN0022  2
      * Define null work field G/L Code Dr
     C                     MOVEL*BLANK    YN0023  8
      * Define null work field G/L Code Cr
     C                     MOVEL*BLANK    YN0024  8
      * Define null work field G/L Sub Account Code
     C                     MOVEL*BLANK    YN0025  8
      * Define null work field Sales History Exp Bucket
     C                     MOVEL*BLANK    YN0026  8
      * Define null work field Post to G/L (Y/N)
     C                     MOVEL*BLANK    YN0027  1
      * Define null work field All Products (Y/N)
     C                     MOVEL*BLANK    YN0028  1
      * Define null work field Accrual Rate
     C                     Z-ADD*ZERO     YN0029  96
      * Define null work field Accrual Rate Type
     C                     MOVEL*BLANK    YN0030  2
      * Define null work field Accrual Detail Search
     C                     MOVEL*BLANK    YN0031  1
      * Define null work field Standard Schedule (Y/N)
     C                     MOVEL*BLANK    YN0032  1
      * Define null work field Affect Sales Realz Rpt
     C                     MOVEL*BLANK    YN0033  1
      * Define local work field Affect Invoice Price
     C                     MOVEL*BLANK    YL0082  1
      * Define null work field Invoice Print Type
     C                     MOVEL*BLANK    YN0034  2
      * Define null work field Max Accrual Amount
     C                     Z-ADD*ZERO     YN0035 112
      * Define null work field Max Accrual Amount Type
     C                     MOVEL*BLANK    YN0036  2
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0037  1
      * Define local work field Accrual Rate
     C                     Z-ADD*ZERO     YL0083  96
      * Define null work field Price Overage Override
     C                     Z-ADD*ZERO     YN0038 114
      * Define null work field Contract Number
     C                     Z-ADD*ZERO     YN0039  70
      * Define null work field Price Status
     C                     MOVEL*BLANK    YN0040  1
      * Define null work field U/M - Ordered
     C                     MOVEL*BLANK    YN0041  2
      * Define null work field Unit Price
     C                     Z-ADD*ZERO     YN0042 114
      * Define null work field Unit Price - Credit
     C                     Z-ADD*ZERO     YN0043 114
      * Define null work field Unit Price Ordered U/M
     C                     Z-ADD*ZERO     YN0044 114
      * Define null work field Unit Weight Ordered U/M
     C                     Z-ADD*ZERO     YN0045 112
      * Define null work field Actual Shipped Date
     C                     Z-ADD*ZERO     YN0046  70
      * Define null work field Affect Inventory Status
     C                     MOVEL*BLANK    YN0047  1
      * Define null work field Affect Sales Doll Status
     C                     MOVEL*BLANK    YN0048  1
      * Define null work field Affect Sales Pnds Status
     C                     MOVEL*BLANK    YN0049  1
      * Define null work field Affect Trade Fund
     C                     MOVEL*BLANK    YN0050  1
      * Define null work field Affect Commission
     C                     MOVEL*BLANK    YN0051  1
      * Define null work field Affect Pricing
     C                     MOVEL*BLANK    YN0052  1
      * Define null work field Ord TF Exempt Code
     C                     MOVEL*BLANK    YN0053  2
      * Define null work field CAS Unused Sts 1
     C                     MOVEL*BLANK    YN0054  1
      * Define null work field CAS Unused Sts 2
     C                     MOVEL*BLANK    YN0055  1
      * Define null work field CAS Rate Unused 1
     C                     Z-ADD*ZERO     YN0056  96
      * Define null work field CAS Rate Unused 2
     C                     Z-ADD*ZERO     YN0057  96
      * Define null work field U/M - Primary
     C                     MOVEL*BLANK    YN0058  2
      * Define null work field Conversion Factor 1
     C                     Z-ADD*ZERO     YN0059  94
      * Define null work field Operation Factor 1
     C                     MOVEL*BLANK    YN0060  1
      * Define null work field U/M - Second
     C                     MOVEL*BLANK    YN0061  2
      * Define null work field Conversion Factor 2
     C                     Z-ADD*ZERO     YN0062  94
      * Define null work field Operation Factor 2
     C                     MOVEL*BLANK    YN0063  1
      * Define null work field U/M - Third
     C                     MOVEL*BLANK    YN0064  2
      * Define local work field U/M - Pricing
     C                     MOVEL*BLANK    YL0084  2
      * Define null work field Unit Weight
     C                     Z-ADD*ZERO     YN0065 112
      * Define null work field Production Date Control
     C                     MOVEL*BLANK    YN0066  1
      * Define null work field Catch Weight Status
     C                     MOVEL*BLANK    YN0067  1
      * Define null work field Default Commod Mark basis
     C                     MOVEL*BLANK    YN0068  3
      * Define null work field Commodity Price Group
     C                     MOVEL*BLANK    YN0069  7
      * Define local work field Usr Number field
     C                     Z-ADD*ZERO     YL0085  40
      * Define local work field Mkt Salesperson Name
     C                     MOVEL*BLANK    YL0086 30
      * Define local work field Mkt Salesperson Code
     C                     MOVEL*BLANK    YL0087  3
      * Define local work field Mkt Broker Name
     C                     MOVEL*BLANK    YL0088 30
      * Define local work field Mkt Broker Code
     C                     MOVEL*BLANK    YL0089  6
      * Define local work field WF Accrual 1 CDE not used
     C                     MOVEL*BLANK    YL0090  3
      * Define local work field WF Accrual 1 not used
     C                     Z-ADD*ZERO     YL0091 112
      * Define local work field WF Accrual 2 CDE not used
     C                     MOVEL*BLANK    YL0092  3
      * Define local work field WF Accrual 2 not used
     C                     Z-ADD*ZERO     YL0093 112
      * Define local work field WF Flag 1
     C                     MOVEL*BLANK    YL0094  1
      * Define local work field WF Status Unused 1
     C                     MOVEL*BLANK    YL0095  1
      * Define local work field WF Status Unused 2
     C                     MOVEL*BLANK    YL0096  1
      * Define local work field WF Status Unused 3
     C                     MOVEL*BLANK    YL0097  3
      * Define local work field WF Date unused 1
     C                     Z-ADD*ZERO     YL0098  70
      * Define local work field WF Date unused 2
     C                     Z-ADD*ZERO     YL0099  70
      * Define local work field WF Price Unused 9.4
     C                     Z-ADD*ZERO     YL0100 114
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
