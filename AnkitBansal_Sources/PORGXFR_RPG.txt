     H/TITLE Rtv Print Statements  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJBADE
     H* Date          : 09/20/19  Time  : 09:04:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCABBRELBIF  E           K        DISK
      * RSQ : Customer                  RSQ Bill to (A/R) Active
      *
     FARBDCPL6IF  E           K        DISK
      * RSQ : A/R Header                Co/Customer AR        V
      *
     FARBDCPLZIF  E           K        DISK
      * RSQ : A/R Header                Cust/Inv - all
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@BBREXJ
      * Customer                  RSQ Bill to (A/R) Active
      * Renamed input format fields
     I              BBBKC7                          WABKC7
     I              BBAYTX                          WAAYTX
     I              BBACNA                          WAACNA
     I              BBADNA                          WAADNA
     I              BBAENA                          WAAENA
     I              BBAJNA                          WAAJNA
     I              BBBGCD                          WABGCD
     I              BBG5CD                          WAG5CD
     I              BBBTTX                          WABTTX
     I              BBBVTX                          WABVTX
     I              BBBWTX                          WABWTX
     I              BBABTX                          WAABTX
     I              BBA2NA                          WAA2NA
     I              BBCBST                          WACBST
     I              BBB0NA                          WAB0NA
     I              BBP3NB                          WAP3NB
     I              BBAXNA                          WAAXNA
     I              BBI6DT                          WAI6DT
     I              BBAYDT                          WAAYDT
     I              BBANC7                          WAANC7
     I              BBBTC7                          WABTC7
     I              BBK6ST                          WAK6ST
     I              BBUZST                          WAUZST
     I              BBKXCD                          WAKXCD
     I              BBLTCD                          WALTCD
     I              BBQNST                          WAQNST
     I              BBS2NB                          WAS2NB
     I              BBVHVA                          WAVHVA
     I              BBI7DT                          WAI7DT
     I              BBRJST                          WARJST
     I              BBRKST                          WARKST
     I              BBQWST                          WAQWST
     I              BBQXST                          WAQXST
     I              BBQYST                          WAQYST
     I              BBUNCS                          WAUNCS
     I              BBUVST                          WAUVST
     I              BBUWST                          WAUWST
     I              BBUXST                          WAUXST
     I              BBVSST                          WAVSST
     I              BBAATM                          WAAATM
     I              BBAYNA                          WAAYNA
     I              BBA0NA                          WAA0NA
     I              BBAXDT                          WAAXDT
      *
     I@BDCPGB
      * A/R Header                Co/Customer AR        V
      * Renamed input format fields
     I              BDAIC3                          WBAIC3
     I              BDCONB                          WBCONB
     I              BDCEST                          WBCEST
     I              BDUHCD                          WBUHCD
     I              BDBSVA                          WBBSVA
     I              BDAIVA                          WBAIVA
     I              BDAOVA                          WBAOVA
     I              BDBGVA                          WBBGVA
     I              BDAJST                          WBAJST
     I              BDE3ST                          WBE3ST
     I              BDG4CD                          WBG4CD
     I              BDCKNB                          WBCKNB
     I              BDCAC7                          WBCAC7
     I              BDBKC7                          WBBKC7
     I              BDBCCD                          WBBCCD
     I              BDR4CD                          WBR4CD
     I              BDB4DT                          WBB4DT
     I              BDATDT                          WBATDT
     I              BDH0DT                          WBH0DT
     I              BDH3DT                          WBH3DT
     I              BDH4DT                          WBH4DT
     I              BDH5DT                          WBH5DT
     I              BDANC7                          WBANC7
     I              BDCPTX                          WBCPTX
     I              BDBSDY                          WBBSDY
     I              BDUVST                          WBUVST
     I              BDUWST                          WBUWST
     I              BDUXST                          WBUXST
     I              BDAATM                          WBAATM
     I              BDAYNA                          WBAYNA
     I              BDA0NA                          WBA0NA
     I              BDAXDT                          WBAXDT
      *
     I@BDCPAO
      * A/R Header                Cust/Inv - all
      * Renamed input format fields
     I              BDAIC3                          WCAIC3
     I              BDCONB                          WCCONB
     I              BDCEST                          WCCEST
     I              BDUHCD                          WCUHCD
     I              BDBSVA                          WCBSVA
     I              BDAIVA                          WCAIVA
     I              BDAOVA                          WCAOVA
     I              BDBGVA                          WCBGVA
     I              BDAJST                          WCAJST
     I              BDE3ST                          WCE3ST
     I              BDG4CD                          WCG4CD
     I              BDCKNB                          WCCKNB
     I              BDCAC7                          WCCAC7
     I              BDBKC7                          WCBKC7
     I              BDBCCD                          WCBCCD
     I              BDR4CD                          WCR4CD
     I              BDB4DT                          WCB4DT
     I              BDATDT                          WCATDT
     I              BDH0DT                          WCH0DT
     I              BDH3DT                          WCH3DT
     I              BDH4DT                          WCH4DT
     I              BDH5DT                          WCH5DT
     I              BDANC7                          WCANC7
     I              BDCPTX                          WCCPTX
     I              BDBSDY                          WCBSDY
     I              BDUVST                          WCUVST
     I              BDUWST                          WCUWST
     I              BDUXST                          WCUXST
     I              BDAATM                          WCAATM
     I              BDAYNA                          WCAYNA
     I              BDA0NA                          WCA0NA
     I              BDAXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Statement Print Frequency
     I                                        1   1 P1UNCS
     IP2PARM      DS
      * I :  Company Number
     I                                    P   1   20P2AIC3
     IP3PARM      DS
      * I :  PRT Printer Device
     I                                        1  10 P3WRST
     IP4PARM      DS
      * I :  PRT Hold Output Sts
     I                                        1   4 P4WSST
     IP5PARM      DS
      * I :  PRT Save Output Sts
     I                                        1   4 P5WTST
     IP6PARM      DS
      * I :  Copies
     I                                    P   1   20P6GWNY
     IP7PARM      DS
      * I :  Statement Type
     I                                        1   1 P7MYSX
     IP8PARM      DS
      * I :  Text 1 Length USR
     I                                        1   1 P8PFTX
     IP9PARM      DS
      * FLD: *Arrays
      * N :  Status Flag 1  Y/N
     I                                        1   1 P9Q1ST
      * N :  Status Flag 2  Y/N
     I                                        2   2 P9Q2ST
      * N :  Status Flag 3  Y/N
     I                                        3   3 P9Q3ST
      * N :  Status Flag 4  Y/N
     I                                        4   4 P9FMST
      * N :  Status Flag 5  Y/N
     I                                        5   5 P9AJTX
      * N :  Status Flag 6  Y/N
     I                                        6   6 P9ACTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1UNCS    PARM           WP0001  1        Statement Print
     C           P2AIC3    PARM           WP0002  30       Company Number
     C           P3WRST    PARM           WP0003 10        PRT Printer Dev
     C           P4WSST    PARM           WP0004  4        PRT Hold Output
     C           P5WTST    PARM           WP0005  4        PRT Save Output
     C           P6GWNY    PARM           WP0006  30       Copies
     C           P7MYSX    PARM           WP0007  1        Statement Type
     C           P8PFTX    PARM           WP0008  1        Text 1 Length U
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Print Statements  XF
      * ***** Changes and Comments
     C                     EXSR UASUBR                     ***** Changes a
      * 1=Fax: Default to *NO for job scheduler job (don't pass from here
     C                     MOVEL'N'       P9Q1ST           Status Flag 1
      * 2=Print: Default to *NO for job scheduler job (don't pass from he
     C                     MOVEL'N'       P9Q2ST           Status Flag 2
      * 3=Email: Default to *NO for job scheduler job (don't pass from he
     C                     MOVEL'N'       P9Q3ST           Status Flag 3
      * 4=Print Co# on statement:
     C                     MOVEL'N'       P9FMST           Status Flag 4
      * 6=Sent from Job Scheduler:
     C                     MOVEL'Y'       P9ACTX           Status Flag 6
     C                     MOVEL*BLANK    WUWLT1           CDE Name
     C                     MOVEL*BLANK    WUWMT1           CDE Destination
     C                     MOVELP3WRST    WUWMT1           CDE Destination
      * Rtv Print Statements  RT - Customer  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Print Statements  RT - Customer  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 10        Distribution Co
     C                     Z-ADD*ZERO     WN0002  30       CDE Sequence Nu
     C                     MOVEL*BLANK    WN0003  1        Record Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * ***** Changes and Comments
     C                     EXSR UBSUBR                     ***** Changes a
     C                     Z-ADDP2AIC3    YL0001           Company Number
      * Rtv Plant Co/Org      XF - Company Defaults Internal  * 
     C                     CALL 'PMOVXFR'              90  Rtv Plant Co/Or
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P2AIC3    WQ0001  30       Company Number
     C                     PARM *BLANK    WQ0002  1        Plant Company S
     C           WUYJSX    PARM *BLANK    WQ0003  1        Company Organiz
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMOVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUYJSX    P9AJTX           Status Flag 5
      * RTV System Value Alpha XF - System Values  * 
     C                     CALL 'PPJXXFR'              90  RTV System Valu
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,001   WQ0004 10        System Value Co
     C           WUMPNA    PARM *BLANK    WQ0005 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPJXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Establish starting position
     C           *LOVAL    SETLL@BBREXJ                    *
     C                     READ @BBREXJ                  90*
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PRINT STATEMENTS MATCHING THE PAR STATEMENT FREQUENCY
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Statement Print Frequency EQ DB1.Statement Print
      *   |- c2    : DB1.Ship To Customer EQ DB1.A/R Customer Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1UNCS    IFEQ WAUNCS                     *IF
     C           WABKC7    IFEQ WAANC7                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWAANC7    YL0002           Customer Number
      * 5/22/03 Call print statement if a balance exists
      * If company # entered
      * chk bal
      * CASE: PAR.Company Number is greater than zero
     C           P2AIC3    IFGT 0                          *IF
      * RTV Check Bal exist   RT - A/R Header  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Check Balance exst RT - A/R Header  * 
     C                     EXSR SCRVGN
     C                     END                             *FI
      * sbmjob
      * CASE: WRK.Status Flag 1  Y/N is Yes
     C           WUQ1ST    IFEQ 'Y'                        *IF
      * 05/01/12 LJB E000909  Change to submit a program that will Fax/Em
      * ARS011 RMC 8/30/05 Default the Print Co on Stmt to NO, pass 000 c
     C                     MOVEL'N'       YL0003           Include Credit
     C                     MOVEL*BLANK    WN0001           Distribution Co
     C                     MOVEL'AR-STMTS'WN0001           Distribution Co
     C                     MOVEL'A'       WN0003           Record Status
      *  9/20/19 JBB E15505 - Change parameter to always print rebills
      * PRC Fax A/R Statement  UP - /UT User Programs  * 
     C                     CALL 'POQ1UPC'              90  PRC Fax A/R Sta
     C                     PARM WUWMT1    WQ0006 10        PRT Printer Dev
     C                     PARM P4WSST    WQ0007  4        PRT Hold Output
     C                     PARM P5WTST    WQ0008  4        PRT Save Output
     C                     PARM YL0001    WQ0009 155       Company Number
     C                     PARM YL0002    WQ0010 155       Customer Number
     C                     PARM P6GWNY    WQ0011 155       System Value Nu
     C                     PARM YL0003    WQ0012  1        USR Detail or S
     C                     PARM 'Y'       WQ0013  1        Status - Y or N
     C                     PARM WAAYTX    WQ0014 30        Customer Name
     C                     PARM P7MYSX    WQ0015  1        Statement Type
     C                     PARM 'Y'       WQ0016  1        Use Credit Cont
     C                     PARM P9Q1ST    WQ0017  1        Status Flag 1
     C                     PARM P9Q2ST    WQ0018  1        Status Flag 2
     C                     PARM P9Q3ST    WQ0019  1        Status Flag 3
     C                     PARM P9FMST    WQ0020  1        Status Flag 4
     C                     PARM P9AJTX    WQ0021  1        Status Flag 5
     C                     PARM P9ACTX    WQ0022  1        Status Flag 6
     C                     PARM WUMPNA    WQ0023 10        Default Printer
     C                     PARM P8PFTX    WQ0024  1        Text 1 Length U
     C                     PARM WN0001    WQ0025 10        Distribution Co
     C                     PARM WN0003    WQ0026  1        Record Status
     C                     PARM 'Y'       WQ0027  1        Include Rebills
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQ1UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BBREXJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Check Bal exist   RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * rmc 11/1/13 e2855 chg to arbdcpl6
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBANC7    WQSB02           A/R Customer Nu
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           A/R Customer Nu
      * Setup key
     C                     Z-ADDP2AIC3    WQSB01           Company Number
     C                     Z-ADDWAANC7    WQSB02           A/R Customer Nu
      * Establish starting position
     C           KRSSB     SETLL@BDCPGB                    *
     C           KRSSB     READE@BDCPGB                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1OR(c2ANDc3)ORc4ORc5
      *   |- c1    : DB1.Remaining Balance Due is less or equal to zero
      *   |- c2    : DB1.Invoice Suffix is CM or OA
      *   |- c3    : DB1.Transaction Amount is greater than zero
      *   |- c4    : DB1.Adjustment Type Code is A/R Entry by Customer
      *   |- c5    : DB1.Adjustment Type Code is A/R Miscellaneous Acct
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBBGVA    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WBCEST    IFEQ 'CM'                       *IF
     C           WBCEST    OREQ 'OA'
     C           WBBSVA    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WBUHCD    IFEQ 'ARC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WBUHCD    IFEQ 'ARM'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUQ1ST           Status Flag 1
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@BDCPGB                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Check Balance exst RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUQ1ST           Status Flag 1
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCANC7    WQSC01           A/R Customer Nu
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           A/R Customer Nu
      * Setup key
     C                     Z-ADDWAANC7    WQSC01           A/R Customer Nu
      * Establish starting position
     C           KRSSC     SETLL@BDCPAO                    *
     C           KRSSC     READE@BDCPAO                  90*
      * Data record not found
     C   90                MOVEL'USR0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1OR(c2ANDc3)ORc4ORc5
      *   |- c1    : DB1.Remaining Balance Due is less or equal to zero
      *   |- c2    : DB1.Invoice Suffix is CM or OA
      *   |- c3    : DB1.Transaction Amount is greater than zero
      *   |- c4    : DB1.Adjustment Type Code is A/R Entry by Customer
      *   |- c5    : DB1.Adjustment Type Code is A/R Miscellaneous Acct
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WCBGVA    IFLE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WCCEST    IFEQ 'CM'                       *IF
     C           WCCEST    OREQ 'OA'
     C           WCBSVA    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WCUHCD    IFEQ 'ARC'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WCUHCD    IFEQ 'ARM'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUQ1ST           Status Flag 1
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@BDCPAO                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** Changes and Comments
      *================================================================
      *  9/20/19 JBB E15505 - Change parameter to always print rebills in
      *   RTVOBJ Rtv Print Statements  RT - Customer.  Recompile.
      * RMC 11/1/13 E2855 chg ar lf used from arbdcplx to arbdcpl6
      * 07/09/12 LJB E002169   Change passed outq to the outq in the comm
      *   line, per Helen. (Changed back from Rob Wallace's request)
      * 06/01/12 LJB E002121   Add status flags for Print, Fax, Email, an
      *   Print Co# on Statement and default in their required values,
      *   which, for the job scheduler, will be *NO.
      *   Also, send default values for Cust Distribution Entry fields.
      * 05/01/12 LJB E000909   Change Statements to Fax or Email to
      *   the number(s) in Cust Distribution file. Also, if not Dailys th
      *   dup the spooled file to A/R outq so it prints for Soni.
      * 8/22/02 RMC PK0476  Print statements matching the input parm
      *   frequency from the job scheduler
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * ***** Changes and Comments
      *================================================================
      *  9/20/19 JBB E15505 - Change parameter to always print rebills
      *   separate functions for Statements.
      * 06/01/12 LJB E002121  Pass new parms because Fax and Email are no
      *   separate functions for Statements.
      * 05/01/12 LJB E000909  Change to submit a program that will Fax/Em
      *   Pass org to AR605CLP so splf will be dup'd if not Dailys
      * RMC ARS011 pass 000 company to print combined stmt
      * SAZ Pass company to print stmts for SLC or MSL,for Pork it will s
      * be zeros.
      * Text 1 Length USR = Drawer
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P9Q1ST           Status Flag 1
     C                     MOVEL*BLANK    P9Q2ST           Status Flag 2
     C                     MOVEL*BLANK    P9Q3ST           Status Flag 3
     C                     MOVEL*BLANK    P9FMST           Status Flag 4
     C                     MOVEL*BLANK    P9AJTX           Status Flag 5
     C                     MOVEL*BLANK    P9ACTX           Status Flag 6
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field CDE Name
     C                     MOVEL*BLANK    WUWLT1 30
      * Define work field CDE Destination
     C                     MOVEL*BLANK    WUWMT1 50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAP3NB           D & B Number
     C                     Z-ADD*ZERO     WAI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WAAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WAANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WABTC7           Parent Customer
     C                     Z-ADD*ZERO     WAS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WAVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WAI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Company Organization
     C                     MOVEL*BLANK    WUYJSX  1
      * Define work field Default Printer
     C                     MOVEL*BLANK    WUMPNA 10
      * Define work field Status Flag 1  Y/N
     C                     MOVEL*BLANK    WUQ1ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WBAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WBAOVA           Amount Paid
     C                     Z-ADD*ZERO     WBBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBCAC7           Order Number Re
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WBATDT           Due Date
     C                     Z-ADD*ZERO     WBH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WBH3DT           Original Inv fo
     C                     Z-ADD*ZERO     WBH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WBH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBSDY           Days to Pay
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Company Number Pass   USR
     C                     Z-ADD*ZERO     YL0001 155
      * Define null work field Plant Company Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define local work field Customer Number Pass  USR
     C                     Z-ADD*ZERO     YL0002 155
      * Define local work field Include Credit Memos
     C                     MOVEL*BLANK    YL0003  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ARSTMTOUTQ
