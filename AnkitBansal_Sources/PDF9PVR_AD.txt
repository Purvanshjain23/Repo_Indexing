// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDF9PVR
// ?Date: 14.08.2025 Time: 03:28:18
// ?------------------------------------------------------------------------------------------------

//?USER: Load screen

EXECUTE FUNCTION(RTV Company Name       RT) TYPE(RTVOBJ) FILE(CAABREP)          AC1255767;
PARAMETER(DTL.Company_Number);
PARAMETER(DTL.Company_Name);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// PAR.Accounting Company Number = CON.*ZERO
PAR.Company_Number = *ZERO;

//?USER: Process command keys

CASE;

// IF DTL.*CMD key is Report Contents Help
IF DTL.*CMD_key = '13';

// WRK.USR Work Field 3A = CON.PFR
WRK.USR_Work_Field_3A = 'PFR';

// WRK.Program name = SUBSTRING(PAR.Program name,CON.1,CON.4)
WRK.Program_name_USR = SUBSTRING(PAR.Program_name_USR:1:4);

// WRK.Program name = CONCAT(WRK.Program name,WRK.USR Work Field 3A,CON.*ZERO)
WRK.Program_name_USR = WRK.Program_name_USR + WRK.USR_Work_Field_3A (*ZERO);

// Call program Zzz Report Help        UP.
CALL PROGRAM(Zzz Report Help        UP) ('PDIJUPR');
PARAMETER(WRK.Program_name_USR);

// PGM.*Defer confirm = CND.Defer confirm
PGM.*Defer_confirm = 'Y';

ENDIF;

//?USER: Validate fields

CASE;

// IF DTL.USR Through Date is not entered
IF DTL.USR_Through_Date = *ZERO;

// IF DTL.USR Through Date LT DTL.USR From Date
IF DTL.USR_Through_Date < DTL.USR_From_Date;

// Send error message - 'Through date must be greater than the from date'
ERROR(USR0032);

ENDIF;

//?USER: User defined action

//?return thru date value
CASE;

// IF DTL.USR Through Date is not entered
IF DTL.USR_Through_Date = *ZERO;

// PAR.USR Through Date = CND.high value
PAR.USR_Through_Date = 9999999;

//?return thru date value
// IF *OTHERWISE
IF *OTHERWISE;

// PAR.USR Through Date = DTL.USR Through Date
PAR.USR_Through_Date = DTL.USR_Through_Date;

ENDIF;

// PAR.USR From Date = DTL.USR From Date
PAR.USR_From_Date = DTL.USR_From_Date;

// PAR.Accounting Company Number = DTL.Accounting Company Number
PAR.Company_Number = DTL.Company_Number;

//?USER: Exit program processing

CASE;

// IF DTL.*CMD key is *Exit
IF DTL.*CMD_key = '03';

// PAR.Accounting Company Number = CON.*ZERO
PAR.Company_Number = *ZERO;

PGM.*Return_code = 'Y2U9999';

RETURN;

ENDIF;

