/**************************************************************************/
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                                   */
/*  PROGRAM   - PUZEUPC - EXC CPY REG CARLISLE CL   EXECUTE USER PROGRAM  */
/*  PROJECT   - WI572  - CA PROP 12                                       */
/*  BY        - ERIC L                                                    */
/*  DATE      - 04/17/2023                                                */
/*  PURPOSE   - Copy the Regulation Code Master  (PUC7REP) file to        */
/*              Carlisle's staging filename based on Company:             */
/*              PUC7REPGUY - 360                                          */
/*              PUC7REPSTF - 440                                          */
/*              PUC7REPSTJ - 960                                          */
/*              Data will be replaced.                                    */
/*                                                                        */
/*  PARAMETERS:                                                           */
/*     I    &COMP       - Company Number                                  */
/**************************************************************************/
/* MODIFICATION HISTORY                                                   */
/*========================================================================*/
/* DATE     INT  PROJECT DESCRIPTION                                      */
/* -------- ---- ------- -------------------------------------------------*/
/* MM/DD/YY BY   XXXXXX                                                   */
/**************************************************************************/
/* WI572  - COPY FROM PUC8REP TO PUC7REP                    ERIC L  6/30/23*/
/*          CPYF WOULD NOT WORK AS THE 2 FILES ARE VERY DIFFERENT          */
/*          CALLING PVAVXFR INSTEAD                                        */

             PGM        PARM(&COMP)

             DCL        VAR(&COMP) TYPE(*CHAR) LEN(3)
             DCL        VAR(&TOFILE) TYPE(*CHAR) LEN(10)

   /*-------------------------------*/
   /* Set &TOFILE based on Company  */
   /*-------------------------------*/
             SELECT
             WHEN       COND(&COMP *EQ '360') THEN(DO)
             CHGVAR     VAR(&TOFILE) VALUE('PUC7REPGUY')
             ENDDO
             WHEN       COND(&COMP *EQ '440') THEN(DO)
             CHGVAR     VAR(&TOFILE) VALUE('PUC7REPSTF')
             ENDDO
             WHEN       COND(&COMP *EQ '960') THEN(DO)
             CHGVAR     VAR(&TOFILE) VALUE('PUC7REPSTJ')
             ENDDO
             ENDSELECT

   /*---------------------------------------------------------------*/
   /* Execute the 'Copy File' USING PVAVXFR FROM PUC8REP TO PUC7REP */
   /*---------------------------------------------------------------*/
             CALL PVAVXFR ''
             CPYF       FROMFILE(*LIBL/PUC7REP) +
                          TOFILE(QTEMP/&TOFILE) MBROPT(*REPLACE) CRTFILE(*YES)
             MONMSG MSGID(CPF0000)

             ENDPGM
