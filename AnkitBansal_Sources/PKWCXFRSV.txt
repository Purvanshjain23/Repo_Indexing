     H/TITLE Bld Prior Day Report  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL                     n
     H* System        : HPEDEVMDL
     H* User name     : ISSMASO
     H* Date          : 06/16/05  Time  : 10:41:38
     H* Copyright     : HPEDEVMDL                     n
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKC4REL1IF  E           K        DISK
      * RTV : Payment Processing Parms  Retrieval index
      *
     FPKA1CP11IF  E           K        DISK
      * RSQ : Tattoo Header             Co/KlDte/Prd/PayTp/Tatoo
      *
     FPKE3CPL1IF  E           K        DISK
      * RTV : MPR Producer Purch Type   Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKARREL3IF  E           K        DISK
      * RSQ : Carcass Merit Program     Active CMP only
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPKCDCPL8IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Rtv Index - Seab's
      *
     FPKE6CPL1IF  E           K        DISK
      * RTV : MPR Prior Day Slaughtered Retrieval index
      *
     FPKAWCPLHIF  E           K        DISK
      * RSQ : Buy Order Header          Co/KIllDt, N=Inter
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPKE7CPL1IF  E           K        DISK
      * RTV : MPR Prior Day Purchased   Retrieval index
      *
     FPKAXCPL7IF  E           K        DISK
      * RSQ : Buy Order Load            Co/DelvDte
      *
     FPKFHCPL1IF  E           K        DISK
      * RTV : MPR Prior Day Sched Dtl   Retrieval index
      *
     FPKE5CPL1IF  E           K        DISK
      * RTV : MPR Prior Day Scheduled   Retrieval index
      *
     FPKAXCPL2IF  E           K        DISK
      * RSQ : Buy Order Load           Co/KillDte/DlvDte/DlvTme
      *
     FPKE4CPL1IF  E           K        DISK
      * RTV : MPR Estimated Purchases   Retrieval index
      *
     FPKE6CPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Slaughtered Update index
      *
     FPKE7CPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Purchased   Update index
      *
     FPKAXCPL1UF  E           K        DISK
      * UPD : Buy Order Load            Update index
      *
     FPKFHCPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Sched Dtl   Update index
      *
     FPKE5CPL0UF  E           K        DISK                      A
      * UPD : MPR Prior Day Scheduled   Update index
      *
     FPKE4CPL0IF  E           K        DISK                      A
      * UPD : MPR Estimated Purchases   Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@C4REO7
      * Payment Processing Parms  Retrieval index
      * Renamed input format fields
     I              C4HONB                          WAHONB
     I              C4CKDT                          WACKDT
     I              C4M1NB                          WAM1NB
     I              C4KHST                          WAKHST
     I              C4KJST                          WAKJST
     I              C4PINB                          WAPINB
     I              C4KKST                          WAKKST
     I              C4AAVN                          WAAAVN
     I              C4AADT                          WAAADT
     I              C4AMTM                          WAAMTM
     I              C4AJST                          WAAJST
     I              C4AHVN                          WAAHVN
     I              C4AGVN                          WAAGVN
     I              C4ABVN                          WAABVN
     I              C4ABDT                          WAABDT
     I              C4ABTM                          WAABTM
      *
     I@A1CPCV
      * Tattoo Header             Co/KlDte/Prd/PayTp/Tatoo
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@E3CPF4
      * MPR Producer Purch Type   Retrieval index
      * Renamed input format fields
     I              E3ABCD                          WCABCD
     I              E3C0A1                          WCC0A1
     I              E3AAVN                          WCAAVN
     I              E3AADT                          WCAADT
     I              E3AMTM                          WCAMTM
     I              E3AJST                          WCAJST
     I              E3AHVN                          WCAHVN
     I              E3AGVN                          WCAGVN
     I              E3ABVN                          WCABVN
     I              E3ABDT                          WCABDT
     I              E3ABTM                          WCABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WDHMNB
     I              AWBNNB                          WDBNNB
     I              AWARDT                          WDARDT
     I              AWASDT                          WDASDT
     I              AWA4ST                          WDA4ST
     I              AWA5ST                          WDA5ST
     I              AWAAPR                          WDAAPR
     I              AWA6ST                          WDA6ST
     I              AWA7ST                          WDA7ST
     I              AWB3ST                          WDB3ST
     I              AWALPR                          WDALPR
     I              AWETCD                          WDETCD
     I              AWEUCD                          WDEUCD
     I              AWJ5TX                          WDJ5TX
     I              AWD5DT                          WDD5DT
     I              AWD6DT                          WDD6DT
     I              AWD7DT                          WDD7DT
     I              AWD8DT                          WDD8DT
     I              AWD9DT                          WDD9DT
     I              AWJOEJ                          WDJOEJ
     I              AWKOFF                          WDKOFF
     I              AWKWPE                          WDKWPE
     I              AWIMBF                          WDIMBF
     I              AWOPTR                          WDOPTR
     I              AWOEJD                          WDOEJD
     I              AWIRMF                          WDIRMF
     I              AWJIRM                          WDJIRM
     I              AWJRKF                          WDJRKF
     I              AWKFIR                          WDKFIR
     I              AWUZST                          WDUZST
     I              AWU0ST                          WDU0ST
     I              AWU1ST                          WDU1ST
     I              AWU2ST                          WDU2ST
     I              AWU3ST                          WDU3ST
     I              AWHXNB                          WDHXNB
     I              AWGANB                          WDGANB
     I              AWGBNB                          WDGBNB
     I              AWABCD                          WDABCD
     I              AWAECD                          WDAECD
     I              AWAKCD                          WDAKCD
     I              AWALCD                          WDALCD
     I              AWAGCD                          WDAGCD
     I              AWAICD                          WDAICD
     I              AWAMCD                          WDAMCD
     I              AWACCD                          WDACCD
     I              AWAAVN                          WDAAVN
     I              AWAADT                          WDAADT
     I              AWAMTM                          WDAMTM
     I              AWAJST                          WDAJST
     I              AWAHVN                          WDAHVN
     I              AWAGVN                          WDAGVN
     I              AWABVN                          WDABVN
     I              AWABDT                          WDABDT
     I              AWABTM                          WDABTM
      *
     I@ARREML
      * Carcass Merit Program     Active CMP only
      * Renamed input format fields
     I              ARAMCD                          WEAMCD
     I              ARA3TX                          WEA3TX
     I              ARDLST                          WEDLST
     I              ARDMST                          WEDMST
     I              ARDOST                          WEDOST
     I              ARDQST                          WEDQST
     I              ARAZPC                          WEAZPC
     I              ARA0PC                          WEA0PC
     I              ARDTST                          WEDTST
     I              ARF5ST                          WEF5ST
     I              ARI1PR                          WEI1PR
     I              ARVEPR                          WEVEPR
     I              ARVFPR                          WEVFPR
     I              ARVHPR                          WEVHPR
     I              ARVIPR                          WEVIPR
     I              ARVJPR                          WEVJPR
     I              ARZ2ST                          WEZ2ST
     I              ARZ3ST                          WEZ3ST
     I              ARZ4ST                          WEZ4ST
     I              ARAAVN                          WEAAVN
     I              ARAADT                          WEAADT
     I              ARAMTM                          WEAMTM
     I              ARAJST                          WEAJST
     I              ARAHVN                          WEAHVN
     I              ARAGVN                          WEAGVN
     I              ARABVN                          WEABVN
     I              ARABDT                          WEABDT
     I              ARABTM                          WEABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WFHMNB
     I              A1BNNB                          WFBNNB
     I              A1BONB                          WFBONB
     I              A1CVNB                          WFCVNB
     I              A1B0DT                          WFB0DT
     I              A1AWDT                          WFAWDT
     I              A1BICD                          WFBICD
     I              A1CPST                          WFCPST
     I              A1ACPR                          WFACPR
     I              A1B9PR                          WFB9PR
     I              A1CAPR                          WFCAPR
     I              A1C4ST                          WFC4ST
     I              A1AIPR                          WFAIPR
     I              A1A6DT                          WFA6DT
     I              A1C2ST                          WFC2ST
     I              A1CXNB                          WFCXNB
     I              A1CWNB                          WFCWNB
     I              A1FCNB                          WFFCNB
     I              A1H9NB                          WFH9NB
     I              A1FDNB                          WFFDNB
     I              A1FENB                          WFFENB
     I              A1HENB                          WFHENB
     I              A1HFNB                          WFHFNB
     I              A1CYNB                          WFCYNB
     I              A1LRNB                          WFLRNB
     I              A1E0NB                          WFE0NB
     I              A1A5PC                          WFA5PC
     I              A1FBNB                          WFFBNB
     I              A1A4PC                          WFA4PC
     I              A1F7NB                          WFF7NB
     I              A1HDNB                          WFHDNB
     I              A1F5NB                          WFF5NB
     I              A1F4NB                          WFF4NB
     I              A1F3NB                          WFF3NB
     I              A1F2NB                          WFF2NB
     I              A1AVPC                          WFAVPC
     I              A1AWPC                          WFAWPC
     I              A1CWPC                          WFCWPC
     I              A1A8PC                          WFA8PC
     I              A1A7PC                          WFA7PC
     I              A1B8PR                          WFB8PR
     I              A1AMPR                          WFAMPR
     I              A1ANPR                          WFANPR
     I              A1AYVA                          WFAYVA
     I              A1AWVA                          WFAWVA
     I              A1AOPR                          WFAOPR
     I              A1AXVA                          WFAXVA
     I              A1APPR                          WFAPPR
     I              A1ASPR                          WFASPR
     I              A1A4VA                          WFA4VA
     I              A1ATPR                          WFATPR
     I              A1A5VA                          WFA5VA
     I              A1CBPR                          WFCBPR
     I              A1CCPR                          WFCCPR
     I              A1LPNB                          WFLPNB
     I              A1CDPR                          WFCDPR
     I              A1A7VA                          WFA7VA
     I              A1A2PR                          WFA2PR
     I              A1JWST                          WFJWST
     I              A1CWST                          WFCWST
     I              A1D7ST                          WFD7ST
     I              A1D8ST                          WFD8ST
     I              A1DWST                          WFDWST
     I              A1D6ST                          WFD6ST
     I              A1GHNB                          WFGHNB
     I              A1BYDT                          WFBYDT
     I              A1E0ST                          WFE0ST
     I              A1E1ST                          WFE1ST
     I              A1E2ST                          WFE2ST
     I              A1BSDT                          WFBSDT
     I              A1BTDT                          WFBTDT
     I              A1BUDT                          WFBUDT
     I              A1HGNB                          WFHGNB
     I              A1HHNB                          WFHHNB
     I              A1HINB                          WFHINB
     I              A1A3PR                          WFA3PR
     I              A1A4PR                          WFA4PR
     I              A1A6PR                          WFA6PR
     I              A1J9NB                          WFJ9NB
     I              A1D6PR                          WFD6PR
     I              A1D7PR                          WFD7PR
     I              A1D8PR                          WFD8PR
     I              A1D9PR                          WFD9PR
     I              A1EAPR                          WFEAPR
     I              A1EBPR                          WFEBPR
     I              A1ECPR                          WFECPR
     I              A1EDPR                          WFEDPR
     I              A1EEPR                          WFEEPR
     I              A1EFPR                          WFEFPR
     I              A1EGPR                          WFEGPR
     I              A1EHPR                          WFEHPR
     I              A1KAST                          WFKAST
     I              A1J7ST                          WFJ7ST
     I              A1J9ST                          WFJ9ST
     I              A1OXNB                          WFOXNB
     I              A1LKST                          WFLKST
     I              A1LLST                          WFLLST
     I              A1J8ST                          WFJ8ST
     I              A1LIST                          WFLIST
     I              A1LJST                          WFLJST
     I              A1NZTX                          WFNZTX
     I              A1HJCD                          WFHJCD
     I              A1R4ST                          WFR4ST
     I              A1R5ST                          WFR5ST
     I              A1R6ST                          WFR6ST
     I              A1R7ST                          WFR7ST
     I              A1THWT                          WFTHWT
     I              A1T2WT                          WFT2WT
     I              A1THHD                          WFTHHD
     I              A1T2HD                          WFT2HD
     I              A1OBPR                          WFOBPR
     I              A1KOER                          WFKOER
     I              A1OPIR                          WFOPIR
     I              A1OPEM                          WFOPEM
     I              A1IORP                          WFIORP
     I              A1OWEO                          WFOWEO
     I              A1OQET                          WFOQET
     I              A1URST                          WFURST
     I              A1USST                          WFUSST
     I              A1HHPC                          WFHHPC
     I              A1S9PR                          WFS9PR
     I              A1TAPR                          WFTAPR
     I              A1TBPR                          WFTBPR
     I              A1JFUR                          WFJFUR
     I              A1KRIF                          WFKRIF
     I              A1KORF                          WFKORF
     I              A1KAPR                          WFKAPR
     I              A1KROT                          WFKROT
     I              A1OTJG                          WFOTJG
     I              A1IRJG                          WFIRJG
     I              A1IMJF                          WFIMJF
     I              A1IRGF                          WFIRGF
     I              A1KRJF                          WFKRJF
     I              A1OJRF                          WFOJRF
     I              A1KFOR                          WFKFOR
     I              A1ORJK                          WFORJK
     I              A1OMVJ                          WFOMVJ
     I              A1MVNF                          WFMVNF
     I              A1MCNF                          WFMCNF
     I              A1NCNF                          WFNCNF
     I              A1NCHF                          WFNCHF
     I              A1IGIR                          WFIGIR
     I              A1KFJR                          WFKFJR
     I              A1EADT                          WFEADT
     I              A1EBDT                          WFEBDT
     I              A1ECDT                          WFECDT
     I              A1EDDT                          WFEDDT
     I              A1EEDT                          WFEEDT
     I              A1U4ST                          WFU4ST
     I              A1U5ST                          WFU5ST
     I              A1U6ST                          WFU6ST
     I              A1U7ST                          WFU7ST
     I              A1U8ST                          WFU8ST
     I              A1U9ST                          WFU9ST
     I              A1VAST                          WFVAST
     I              A1VBST                          WFVBST
     I              A1BDCD                          WFBDCD
     I              A1CSCD                          WFCSCD
     I              A1ABCD                          WFABCD
     I              A1AECD                          WFAECD
     I              A1ACCD                          WFACCD
     I              A1AGCD                          WFAGCD
     I              A1BECD                          WFBECD
     I              A1AAVN                          WFAAVN
     I              A1AADT                          WFAADT
     I              A1AMTM                          WFAMTM
     I              A1AJST                          WFAJST
     I              A1AHVN                          WFAHVN
     I              A1AGVN                          WFAGVN
     I              A1ABVN                          WFABVN
     I              A1ABDT                          WFABDT
     I              A1ABTM                          WFABTM
      *
     I@DNCPUY
      * Tattoo Header EXT         Retrieval index
      * Renamed input format fields
     I              DNHMNB                          WGHMNB
     I              DNBNNB                          WGBNNB
     I              DNBONB                          WGBONB
     I              DNCVNB                          WGCVNB
     I              DNB0DT                          WGB0DT
     I              DNI5PR                          WGI5PR
     I              DNJBPR                          WGJBPR
     I              DNI6PR                          WGI6PR
     I              DNI7PR                          WGI7PR
     I              DNI8PR                          WGI8PR
     I              DNI9PR                          WGI9PR
     I              DNJAPR                          WGJAPR
     I              DNJCPR                          WGJCPR
     I              DNJDPR                          WGJDPR
     I              DNJEPR                          WGJEPR
     I              DNJFPR                          WGJFPR
     I              DNJGPR                          WGJGPR
     I              DNJHPR                          WGJHPR
     I              DNJIPR                          WGJIPR
     I              DNJJPR                          WGJJPR
     I              DNJKPR                          WGJKPR
     I              DNJLPR                          WGJLPR
     I              DNJMPR                          WGJMPR
     I              DNJNPR                          WGJNPR
     I              DNJOPR                          WGJOPR
     I              DNLTBF                          WGLTBF
     I              DNHZPC                          WGHZPC
     I              DNLTHW                          WGLTHW
     I              DNH0PC                          WGH0PC
     I              DNGTBF                          WGGTBF
     I              DNH1PC                          WGH1PC
     I              DNGTHW                          WGGTHW
     I              DNH2PC                          WGH2PC
     I              DNHLBF                          WGHLBF
     I              DNHLLE                          WGHLLE
     I              DNHLHW                          WGHLHW
     I              DNHLLP                          WGHLLP
     I              DNHGBF                          WGHGBF
     I              DNHGLE                          WGHGLE
     I              DNHGHW                          WGHGHW
     I              DNHFLP                          WGHFLP
     I              DNAAVN                          WGAAVN
     I              DNAADT                          WGAADT
     I              DNAMTM                          WGAMTM
     I              DNAJST                          WGAJST
     I              DNAHVN                          WGAHVN
     I              DNAGVN                          WGAGVN
     I              DNABVN                          WGABVN
     I              DNABDT                          WGABDT
     I              DNABTM                          WGABTM
      *
     I@CDCPWY
      * Tattoo Ded/Add            Rtv Index - Seab's
      * Renamed input format fields
     I              CDHMNB                          WHHMNB
     I              CDBNNB                          WHBNNB
     I              CDBONB                          WHBONB
     I              CDCVNB                          WHCVNB
     I              CDB0DT                          WHB0DT
     I              CDBQCD                          WHBQCD
     I              CDAZVA                          WHAZVA
     I              CDA0VA                          WHA0VA
     I              CDJBST                          WHJBST
     I              CDEIST                          WHEIST
     I              CDJDST                          WHJDST
     I              CDDPCD                          WHDPCD
     I              CDE3CD                          WHE3CD
     I              CDAQNB                          WHAQNB
     I              CDOCST                          WHOCST
     I              CDPEST                          WHPEST
     I              CDPFST                          WHPFST
     I              CDPGST                          WHPGST
     I              CDPIST                          WHPIST
     I              CDPJST                          WHPJST
     I              CDPKST                          WHPKST
     I              CDPLST                          WHPLST
     I              CDAAVN                          WHAAVN
     I              CDAADT                          WHAADT
     I              CDAMTM                          WHAMTM
     I              CDAJST                          WHAJST
     I              CDAHVN                          WHAHVN
     I              CDAGVN                          WHAGVN
     I              CDABVN                          WHABVN
     I              CDABDT                          WHABDT
     I              CDABTM                          WHABTM
      *
     I@E6CPGA
      * MPR Prior Day Slaughtered Retrieval index
      * Renamed input format fields
     I              E6H8CD                          WIH8CD
     I              E6ETDT                          WIETDT
     I              E6C2A1                          WIC2A1
     I              E6IBCD                          WIIBCD
     I              E6DOA1                          WIDOA1
     I              E6DPA1                          WIDPA1
     I              E6DQA1                          WIDQA1
     I              E6UUPR                          WIUUPR
     I              E6UVPR                          WIUVPR
     I              E6UWPR                          WIUWPR
     I              E6UXPR                          WIUXPR
     I              E6DRA1                          WIDRA1
     I              E6DSA1                          WIDSA1
     I              E6UYPR                          WIUYPR
     I              E6DTA1                          WIDTA1
     I              E6DUA1                          WIDUA1
     I              E6DVA1                          WIDVA1
     I              E6AAVN                          WIAAVN
     I              E6AADT                          WIAADT
     I              E6AMTM                          WIAMTM
     I              E6AJST                          WIAJST
     I              E6AHVN                          WIAHVN
     I              E6AGVN                          WIAGVN
     I              E6ABVN                          WIABVN
     I              E6ABDT                          WIABDT
     I              E6ABTM                          WIABTM
      *
     I@E6CPF9
      * MPR Prior Day Slaughtered Update index
      * Renamed input format fields
     I              E6H8CD                          WJH8CD
     I              E6ETDT                          WJETDT
     I              E6C2A1                          WJC2A1
     I              E6IBCD                          WJIBCD
     I              E6DOA1                          WJDOA1
     I              E6DPA1                          WJDPA1
     I              E6DQA1                          WJDQA1
     I              E6UUPR                          WJUUPR
     I              E6UVPR                          WJUVPR
     I              E6UWPR                          WJUWPR
     I              E6UXPR                          WJUXPR
     I              E6DRA1                          WJDRA1
     I              E6DSA1                          WJDSA1
     I              E6UYPR                          WJUYPR
     I              E6DTA1                          WJDTA1
     I              E6DUA1                          WJDUA1
     I              E6DVA1                          WJDVA1
     I              E6AAVN                          WJAAVN
     I              E6AADT                          WJAADT
     I              E6AMTM                          WJAMTM
     I              E6AJST                          WJAJST
     I              E6AHVN                          WJAHVN
     I              E6AGVN                          WJAGVN
     I              E6ABVN                          WJABVN
     I              E6ABDT                          WJABDT
     I              E6ABTM                          WJABTM
      *
     I@AWCPGR
      * Buy Order Header          Co/KIllDt, N=Inter
      * Renamed input format fields
     I              AWHMNB                          WKHMNB
     I              AWBNNB                          WKBNNB
     I              AWARDT                          WKARDT
     I              AWASDT                          WKASDT
     I              AWA4ST                          WKA4ST
     I              AWA5ST                          WKA5ST
     I              AWAAPR                          WKAAPR
     I              AWA6ST                          WKA6ST
     I              AWA7ST                          WKA7ST
     I              AWB3ST                          WKB3ST
     I              AWALPR                          WKALPR
     I              AWETCD                          WKETCD
     I              AWEUCD                          WKEUCD
     I              AWJ5TX                          WKJ5TX
     I              AWD5DT                          WKD5DT
     I              AWD6DT                          WKD6DT
     I              AWD7DT                          WKD7DT
     I              AWD8DT                          WKD8DT
     I              AWD9DT                          WKD9DT
     I              AWJOEJ                          WKJOEJ
     I              AWKOFF                          WKKOFF
     I              AWKWPE                          WKKWPE
     I              AWIMBF                          WKIMBF
     I              AWOPTR                          WKOPTR
     I              AWOEJD                          WKOEJD
     I              AWIRMF                          WKIRMF
     I              AWJIRM                          WKJIRM
     I              AWJRKF                          WKJRKF
     I              AWKFIR                          WKKFIR
     I              AWUZST                          WKUZST
     I              AWU0ST                          WKU0ST
     I              AWU1ST                          WKU1ST
     I              AWU2ST                          WKU2ST
     I              AWU3ST                          WKU3ST
     I              AWHXNB                          WKHXNB
     I              AWGANB                          WKGANB
     I              AWGBNB                          WKGBNB
     I              AWABCD                          WKABCD
     I              AWAECD                          WKAECD
     I              AWAKCD                          WKAKCD
     I              AWALCD                          WKALCD
     I              AWAGCD                          WKAGCD
     I              AWAICD                          WKAICD
     I              AWAMCD                          WKAMCD
     I              AWACCD                          WKACCD
     I              AWAAVN                          WKAAVN
     I              AWAADT                          WKAADT
     I              AWAMTM                          WKAMTM
     I              AWAJST                          WKAJST
     I              AWAHVN                          WKAHVN
     I              AWAGVN                          WKAGVN
     I              AWABVN                          WKABVN
     I              AWABDT                          WKABDT
     I              AWABTM                          WKABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WLHMNB
     I              AXBNNB                          WLBNNB
     I              AXBONB                          WLBONB
     I              AXCQDT                          WLCQDT
     I              AXABTH                          WLABTH
     I              AXACTH                          WLACTH
     I              AXBPNB                          WLBPNB
     I              AXCSNB                          WLCSNB
     I              AXAUDT                          WLAUDT
     I              AXCMST                          WLCMST
     I              AXAGPR                          WLAGPR
     I              AXATVA                          WLATVA
     I              AXI1ST                          WLI1ST
     I              AXDHNB                          WLDHNB
     I              AXDINB                          WLDINB
     I              AXCNST                          WLCNST
     I              AXGINB                          WLGINB
     I              AXBZDT                          WLBZDT
     I              AXLSNB                          WLLSNB
     I              AXF3TX                          WLF3TX
     I              AXO8ST                          WLO8ST
     I              AXO9ST                          WLO9ST
     I              AXPAST                          WLPAST
     I              AXLDSH                          WLLDSH
     I              AXPBST                          WLPBST
     I              AXPCST                          WLPCST
     I              AXPDST                          WLPDST
     I              AXUWST                          WLUWST
     I              AXUXST                          WLUXST
     I              AXUYST                          WLUYST
     I              AXJKRU                          WLJKRU
     I              AXKEOR                          WLKEOR
     I              AXIOEW                          WLIOEW
     I              AXKJIO                          WLKJIO
     I              AXIOJR                          WLIOJR
     I              AXEIRR                          WLEIRR
     I              AXITMF                          WLITMF
     I              AXODJE                          WLODJE
     I              AXRJIF                          WLRJIF
     I              AXOEJF                          WLOEJF
     I              AXD0DT                          WLD0DT
     I              AXD1DT                          WLD1DT
     I              AXD2DT                          WLD2DT
     I              AXD3DT                          WLD3DT
     I              AXD4DT                          WLD4DT
     I              AXBNCD                          WLBNCD
     I              AXABCD                          WLABCD
     I              AXAECD                          WLAECD
     I              AXAAVN                          WLAAVN
     I              AXAADT                          WLAADT
     I              AXAMTM                          WLAMTM
     I              AXAJST                          WLAJST
     I              AXAHVN                          WLAHVN
     I              AXAGVN                          WLAGVN
     I              AXABVN                          WLABVN
     I              AXABDT                          WLABDT
     I              AXABTM                          WLABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WMHMNB
     I              A1BNNB                          WMBNNB
     I              A1BONB                          WMBONB
     I              A1CVNB                          WMCVNB
     I              A1B0DT                          WMB0DT
     I              A1AWDT                          WMAWDT
     I              A1BICD                          WMBICD
     I              A1CPST                          WMCPST
     I              A1ACPR                          WMACPR
     I              A1B9PR                          WMB9PR
     I              A1CAPR                          WMCAPR
     I              A1C4ST                          WMC4ST
     I              A1AIPR                          WMAIPR
     I              A1A6DT                          WMA6DT
     I              A1C2ST                          WMC2ST
     I              A1CXNB                          WMCXNB
     I              A1CWNB                          WMCWNB
     I              A1FCNB                          WMFCNB
     I              A1H9NB                          WMH9NB
     I              A1FDNB                          WMFDNB
     I              A1FENB                          WMFENB
     I              A1HENB                          WMHENB
     I              A1HFNB                          WMHFNB
     I              A1CYNB                          WMCYNB
     I              A1LRNB                          WMLRNB
     I              A1E0NB                          WME0NB
     I              A1A5PC                          WMA5PC
     I              A1FBNB                          WMFBNB
     I              A1A4PC                          WMA4PC
     I              A1F7NB                          WMF7NB
     I              A1HDNB                          WMHDNB
     I              A1F5NB                          WMF5NB
     I              A1F4NB                          WMF4NB
     I              A1F3NB                          WMF3NB
     I              A1F2NB                          WMF2NB
     I              A1AVPC                          WMAVPC
     I              A1AWPC                          WMAWPC
     I              A1CWPC                          WMCWPC
     I              A1A8PC                          WMA8PC
     I              A1A7PC                          WMA7PC
     I              A1B8PR                          WMB8PR
     I              A1AMPR                          WMAMPR
     I              A1ANPR                          WMANPR
     I              A1AYVA                          WMAYVA
     I              A1AWVA                          WMAWVA
     I              A1AOPR                          WMAOPR
     I              A1AXVA                          WMAXVA
     I              A1APPR                          WMAPPR
     I              A1ASPR                          WMASPR
     I              A1A4VA                          WMA4VA
     I              A1ATPR                          WMATPR
     I              A1A5VA                          WMA5VA
     I              A1CBPR                          WMCBPR
     I              A1CCPR                          WMCCPR
     I              A1LPNB                          WMLPNB
     I              A1CDPR                          WMCDPR
     I              A1A7VA                          WMA7VA
     I              A1A2PR                          WMA2PR
     I              A1JWST                          WMJWST
     I              A1CWST                          WMCWST
     I              A1D7ST                          WMD7ST
     I              A1D8ST                          WMD8ST
     I              A1DWST                          WMDWST
     I              A1D6ST                          WMD6ST
     I              A1GHNB                          WMGHNB
     I              A1BYDT                          WMBYDT
     I              A1E0ST                          WME0ST
     I              A1E1ST                          WME1ST
     I              A1E2ST                          WME2ST
     I              A1BSDT                          WMBSDT
     I              A1BTDT                          WMBTDT
     I              A1BUDT                          WMBUDT
     I              A1HGNB                          WMHGNB
     I              A1HHNB                          WMHHNB
     I              A1HINB                          WMHINB
     I              A1A3PR                          WMA3PR
     I              A1A4PR                          WMA4PR
     I              A1A6PR                          WMA6PR
     I              A1J9NB                          WMJ9NB
     I              A1D6PR                          WMD6PR
     I              A1D7PR                          WMD7PR
     I              A1D8PR                          WMD8PR
     I              A1D9PR                          WMD9PR
     I              A1EAPR                          WMEAPR
     I              A1EBPR                          WMEBPR
     I              A1ECPR                          WMECPR
     I              A1EDPR                          WMEDPR
     I              A1EEPR                          WMEEPR
     I              A1EFPR                          WMEFPR
     I              A1EGPR                          WMEGPR
     I              A1EHPR                          WMEHPR
     I              A1KAST                          WMKAST
     I              A1J7ST                          WMJ7ST
     I              A1J9ST                          WMJ9ST
     I              A1OXNB                          WMOXNB
     I              A1LKST                          WMLKST
     I              A1LLST                          WMLLST
     I              A1J8ST                          WMJ8ST
     I              A1LIST                          WMLIST
     I              A1LJST                          WMLJST
     I              A1NZTX                          WMNZTX
     I              A1HJCD                          WMHJCD
     I              A1R4ST                          WMR4ST
     I              A1R5ST                          WMR5ST
     I              A1R6ST                          WMR6ST
     I              A1R7ST                          WMR7ST
     I              A1THWT                          WMTHWT
     I              A1T2WT                          WMT2WT
     I              A1THHD                          WMTHHD
     I              A1T2HD                          WMT2HD
     I              A1OBPR                          WMOBPR
     I              A1KOER                          WMKOER
     I              A1OPIR                          WMOPIR
     I              A1OPEM                          WMOPEM
     I              A1IORP                          WMIORP
     I              A1OWEO                          WMOWEO
     I              A1OQET                          WMOQET
     I              A1URST                          WMURST
     I              A1USST                          WMUSST
     I              A1HHPC                          WMHHPC
     I              A1S9PR                          WMS9PR
     I              A1TAPR                          WMTAPR
     I              A1TBPR                          WMTBPR
     I              A1JFUR                          WMJFUR
     I              A1KRIF                          WMKRIF
     I              A1KORF                          WMKORF
     I              A1KAPR                          WMKAPR
     I              A1KROT                          WMKROT
     I              A1OTJG                          WMOTJG
     I              A1IRJG                          WMIRJG
     I              A1IMJF                          WMIMJF
     I              A1IRGF                          WMIRGF
     I              A1KRJF                          WMKRJF
     I              A1OJRF                          WMOJRF
     I              A1KFOR                          WMKFOR
     I              A1ORJK                          WMORJK
     I              A1OMVJ                          WMOMVJ
     I              A1MVNF                          WMMVNF
     I              A1MCNF                          WMMCNF
     I              A1NCNF                          WMNCNF
     I              A1NCHF                          WMNCHF
     I              A1IGIR                          WMIGIR
     I              A1KFJR                          WMKFJR
     I              A1EADT                          WMEADT
     I              A1EBDT                          WMEBDT
     I              A1ECDT                          WMECDT
     I              A1EDDT                          WMEDDT
     I              A1EEDT                          WMEEDT
     I              A1U4ST                          WMU4ST
     I              A1U5ST                          WMU5ST
     I              A1U6ST                          WMU6ST
     I              A1U7ST                          WMU7ST
     I              A1U8ST                          WMU8ST
     I              A1U9ST                          WMU9ST
     I              A1VAST                          WMVAST
     I              A1VBST                          WMVBST
     I              A1BDCD                          WMBDCD
     I              A1CSCD                          WMCSCD
     I              A1ABCD                          WMABCD
     I              A1AECD                          WMAECD
     I              A1ACCD                          WMACCD
     I              A1AGCD                          WMAGCD
     I              A1BECD                          WMBECD
     I              A1AAVN                          WMAAVN
     I              A1AADT                          WMAADT
     I              A1AMTM                          WMAMTM
     I              A1AJST                          WMAJST
     I              A1AHVN                          WMAHVN
     I              A1AGVN                          WMAGVN
     I              A1ABVN                          WMABVN
     I              A1ABDT                          WMABDT
     I              A1ABTM                          WMABTM
      *
     I@E7CPGM
      * MPR Prior Day Purchased   Retrieval index
      * Renamed input format fields
     I              E7H8CD                          WOH8CD
     I              E7ETDT                          WOETDT
     I              E7C2A1                          WOC2A1
     I              E7IBCD                          WOIBCD
     I              E7DWA1                          WODWA1
     I              E7DXA1                          WODXA1
     I              E7DYA1                          WODYA1
     I              E7DZA1                          WODZA1
     I              E7D0A1                          WOD0A1
     I              E7UZPR                          WOUZPR
     I              E7AAVN                          WOAAVN
     I              E7AADT                          WOAADT
     I              E7AMTM                          WOAMTM
     I              E7AJST                          WOAJST
     I              E7AHVN                          WOAHVN
     I              E7AGVN                          WOAGVN
     I              E7ABVN                          WOABVN
     I              E7ABDT                          WOABDT
     I              E7ABTM                          WOABTM
      *
     I@E7CPGL
      * MPR Prior Day Purchased   Update index
      * Renamed input format fields
     I              E7H8CD                          WRH8CD
     I              E7ETDT                          WRETDT
     I              E7C2A1                          WRC2A1
     I              E7IBCD                          WRIBCD
     I              E7DWA1                          WRDWA1
     I              E7DXA1                          WRDXA1
     I              E7DYA1                          WRDYA1
     I              E7DZA1                          WRDZA1
     I              E7D0A1                          WRD0A1
     I              E7UZPR                          WRUZPR
     I              E7AAVN                          WRAAVN
     I              E7AADT                          WRAADT
     I              E7AMTM                          WRAMTM
     I              E7AJST                          WRAJST
     I              E7AHVN                          WRAHVN
     I              E7AGVN                          WRAGVN
     I              E7ABVN                          WRABVN
     I              E7ABDT                          WRABDT
     I              E7ABTM                          WRABTM
      *
     I@AXCPBY
      * Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WSHMNB
     I              AXBNNB                          WSBNNB
     I              AXBONB                          WSBONB
     I              AXCQDT                          WSCQDT
     I              AXABTH                          WSABTH
     I              AXACTH                          WSACTH
     I              AXBPNB                          WSBPNB
     I              AXCSNB                          WSCSNB
     I              AXAUDT                          WSAUDT
     I              AXCMST                          WSCMST
     I              AXAGPR                          WSAGPR
     I              AXATVA                          WSATVA
     I              AXI1ST                          WSI1ST
     I              AXDHNB                          WSDHNB
     I              AXDINB                          WSDINB
     I              AXCNST                          WSCNST
     I              AXGINB                          WSGINB
     I              AXBZDT                          WSBZDT
     I              AXLSNB                          WSLSNB
     I              AXF3TX                          WSF3TX
     I              AXO8ST                          WSO8ST
     I              AXO9ST                          WSO9ST
     I              AXPAST                          WSPAST
     I              AXLDSH                          WSLDSH
     I              AXPBST                          WSPBST
     I              AXPCST                          WSPCST
     I              AXPDST                          WSPDST
     I              AXUWST                          WSUWST
     I              AXUXST                          WSUXST
     I              AXUYST                          WSUYST
     I              AXJKRU                          WSJKRU
     I              AXKEOR                          WSKEOR
     I              AXIOEW                          WSIOEW
     I              AXKJIO                          WSKJIO
     I              AXIOJR                          WSIOJR
     I              AXEIRR                          WSEIRR
     I              AXITMF                          WSITMF
     I              AXODJE                          WSODJE
     I              AXRJIF                          WSRJIF
     I              AXOEJF                          WSOEJF
     I              AXD0DT                          WSD0DT
     I              AXD1DT                          WSD1DT
     I              AXD2DT                          WSD2DT
     I              AXD3DT                          WSD3DT
     I              AXD4DT                          WSD4DT
     I              AXBNCD                          WSBNCD
     I              AXABCD                          WSABCD
     I              AXAECD                          WSAECD
     I              AXAAVN                          WSAAVN
     I              AXAADT                          WSAADT
     I              AXAMTM                          WSAMTM
     I              AXAJST                          WSAJST
     I              AXAHVN                          WSAHVN
     I              AXAGVN                          WSAGVN
     I              AXABVN                          WSABVN
     I              AXABDT                          WSABDT
     I              AXABTM                          WSABTM
      *
     I@AXCPNQ
      * Buy Order Load            Co/DelvDte
      * Renamed input format fields
     I              AXHMNB                          WTHMNB
     I              AXBNNB                          WTBNNB
     I              AXBONB                          WTBONB
     I              AXCQDT                          WTCQDT
     I              AXABTH                          WTABTH
     I              AXACTH                          WTACTH
     I              AXBPNB                          WTBPNB
     I              AXCSNB                          WTCSNB
     I              AXAUDT                          WTAUDT
     I              AXCMST                          WTCMST
     I              AXAGPR                          WTAGPR
     I              AXATVA                          WTATVA
     I              AXI1ST                          WTI1ST
     I              AXDHNB                          WTDHNB
     I              AXDINB                          WTDINB
     I              AXCNST                          WTCNST
     I              AXGINB                          WTGINB
     I              AXBZDT                          WTBZDT
     I              AXLSNB                          WTLSNB
     I              AXF3TX                          WTF3TX
     I              AXO8ST                          WTO8ST
     I              AXO9ST                          WTO9ST
     I              AXPAST                          WTPAST
     I              AXLDSH                          WTLDSH
     I              AXPBST                          WTPBST
     I              AXPCST                          WTPCST
     I              AXPDST                          WTPDST
     I              AXUWST                          WTUWST
     I              AXUXST                          WTUXST
     I              AXUYST                          WTUYST
     I              AXJKRU                          WTJKRU
     I              AXKEOR                          WTKEOR
     I              AXIOEW                          WTIOEW
     I              AXKJIO                          WTKJIO
     I              AXIOJR                          WTIOJR
     I              AXEIRR                          WTEIRR
     I              AXITMF                          WTITMF
     I              AXODJE                          WTODJE
     I              AXRJIF                          WTRJIF
     I              AXOEJF                          WTOEJF
     I              AXD0DT                          WTD0DT
     I              AXD1DT                          WTD1DT
     I              AXD2DT                          WTD2DT
     I              AXD3DT                          WTD3DT
     I              AXD4DT                          WTD4DT
     I              AXBNCD                          WTBNCD
     I              AXABCD                          WTABCD
     I              AXAECD                          WTAECD
     I              AXAAVN                          WTAAVN
     I              AXAADT                          WTAADT
     I              AXAMTM                          WTAMTM
     I              AXAJST                          WTAJST
     I              AXAHVN                          WTAHVN
     I              AXAGVN                          WTAGVN
     I              AXABVN                          WTABVN
     I              AXABDT                          WTABDT
     I              AXABTM                          WTABTM
      *
     I@FHCPHN
      * MPR Prior Day Sched Dtl   Retrieval index
      * Renamed input format fields
     I              FHH8CD                          WVH8CD
     I              FHETDT                          WVETDT
     I              FHC2A1                          WVC2A1
     I              FHCQDT                          WVCQDT
     I              FHBNNB                          WVBNNB
     I              FHBONB                          WVBONB
     I              FHABCD                          WVABCD
     I              FHAECD                          WVAECD
     I              FHBPNB                          WVBPNB
     I              FHAAVN                          WVAAVN
     I              FHAADT                          WVAADT
     I              FHAMTM                          WVAMTM
     I              FHAJST                          WVAJST
     I              FHAHVN                          WVAHVN
     I              FHAGVN                          WVAGVN
     I              FHABVN                          WVABVN
     I              FHABDT                          WVABDT
     I              FHABTM                          WVABTM
      *
     I@FHCPHM
      * MPR Prior Day Sched Dtl   Update index
      * Renamed input format fields
     I              FHH8CD                          WWH8CD
     I              FHETDT                          WWETDT
     I              FHC2A1                          WWC2A1
     I              FHCQDT                          WWCQDT
     I              FHBNNB                          WWBNNB
     I              FHBONB                          WWBONB
     I              FHABCD                          WWABCD
     I              FHAECD                          WWAECD
     I              FHBPNB                          WWBPNB
     I              FHAAVN                          WWAAVN
     I              FHAADT                          WWAADT
     I              FHAMTM                          WWAMTM
     I              FHAJST                          WWAJST
     I              FHAHVN                          WWAHVN
     I              FHAGVN                          WWAGVN
     I              FHABVN                          WWABVN
     I              FHABDT                          WWABDT
     I              FHABTM                          WWABTM
      *
     I@E5CPGP
      * MPR Prior Day Scheduled   Retrieval index
      * Renamed input format fields
     I              E5H8CD                          WXH8CD
     I              E5ETDT                          WXETDT
     I              E5C2A1                          WXC2A1
     I              E5C4A1                          WXC4A1
     I              E5C5A1                          WXC5A1
     I              E5C6A1                          WXC6A1
     I              E5C7A1                          WXC7A1
     I              E5C8A1                          WXC8A1
     I              E5C9A1                          WXC9A1
     I              E5DAA1                          WXDAA1
     I              E5DBA1                          WXDBA1
     I              E5DCA1                          WXDCA1
     I              E5DDA1                          WXDDA1
     I              E5DEA1                          WXDEA1
     I              E5DFA1                          WXDFA1
     I              E5DGA1                          WXDGA1
     I              E5DHA1                          WXDHA1
     I              E5AAVN                          WXAAVN
     I              E5AADT                          WXAADT
     I              E5AMTM                          WXAMTM
     I              E5AJST                          WXAJST
     I              E5AHVN                          WXAHVN
     I              E5AGVN                          WXAGVN
     I              E5ABVN                          WXABVN
     I              E5ABDT                          WXABDT
     I              E5ABTM                          WXABTM
      *
     I@E5CPGO
      * MPR Prior Day Scheduled   Update index
      * Renamed input format fields
     I              E5H8CD                          WYH8CD
     I              E5ETDT                          WYETDT
     I              E5C2A1                          WYC2A1
     I              E5C4A1                          WYC4A1
     I              E5C5A1                          WYC5A1
     I              E5C6A1                          WYC6A1
     I              E5C7A1                          WYC7A1
     I              E5C8A1                          WYC8A1
     I              E5C9A1                          WYC9A1
     I              E5DAA1                          WYDAA1
     I              E5DBA1                          WYDBA1
     I              E5DCA1                          WYDCA1
     I              E5DDA1                          WYDDA1
     I              E5DEA1                          WYDEA1
     I              E5DFA1                          WYDFA1
     I              E5DGA1                          WYDGA1
     I              E5DHA1                          WYDHA1
     I              E5AAVN                          WYAAVN
     I              E5AADT                          WYAADT
     I              E5AMTM                          WYAMTM
     I              E5AJST                          WYAJST
     I              E5AHVN                          WYAHVN
     I              E5AGVN                          WYAGVN
     I              E5ABVN                          WYABVN
     I              E5ABDT                          WYABDT
     I              E5ABTM                          WYABTM
      *
     I@AXCPB8
      * Buy Order Load           Co/KillDte/DlvDte/DlvTme
      * Renamed input format fields
     I              AXHMNB                          TAHMNB
     I              AXBNNB                          TABNNB
     I              AXBONB                          TABONB
     I              AXCQDT                          TACQDT
     I              AXABTH                          TAABTH
     I              AXACTH                          TAACTH
     I              AXBPNB                          TABPNB
     I              AXCSNB                          TACSNB
     I              AXAUDT                          TAAUDT
     I              AXCMST                          TACMST
     I              AXAGPR                          TAAGPR
     I              AXATVA                          TAATVA
     I              AXI1ST                          TAI1ST
     I              AXDHNB                          TADHNB
     I              AXDINB                          TADINB
     I              AXCNST                          TACNST
     I              AXGINB                          TAGINB
     I              AXBZDT                          TABZDT
     I              AXLSNB                          TALSNB
     I              AXF3TX                          TAF3TX
     I              AXO8ST                          TAO8ST
     I              AXO9ST                          TAO9ST
     I              AXPAST                          TAPAST
     I              AXLDSH                          TALDSH
     I              AXPBST                          TAPBST
     I              AXPCST                          TAPCST
     I              AXPDST                          TAPDST
     I              AXUWST                          TAUWST
     I              AXUXST                          TAUXST
     I              AXUYST                          TAUYST
     I              AXJKRU                          TAJKRU
     I              AXKEOR                          TAKEOR
     I              AXIOEW                          TAIOEW
     I              AXKJIO                          TAKJIO
     I              AXIOJR                          TAIOJR
     I              AXEIRR                          TAEIRR
     I              AXITMF                          TAITMF
     I              AXODJE                          TAODJE
     I              AXRJIF                          TARJIF
     I              AXOEJF                          TAOEJF
     I              AXD0DT                          TAD0DT
     I              AXD1DT                          TAD1DT
     I              AXD2DT                          TAD2DT
     I              AXD3DT                          TAD3DT
     I              AXD4DT                          TAD4DT
     I              AXBNCD                          TABNCD
     I              AXABCD                          TAABCD
     I              AXAECD                          TAAECD
     I              AXAAVN                          TAAAVN
     I              AXAADT                          TAAADT
     I              AXAMTM                          TAAMTM
     I              AXAJST                          TAAJST
     I              AXAHVN                          TAAHVN
     I              AXAGVN                          TAAGVN
     I              AXABVN                          TAABVN
     I              AXABDT                          TAABDT
     I              AXABTM                          TAABTM
      *
     I@E4CPF7
      * MPR Estimated Purchases   Retrieval index
      * Renamed input format fields
     I              E4HONB                          TBHONB
     I              E4ETDT                          TBETDT
     I              E4C0A1                          TBC0A1
     I              E4C1A1                          TBC1A1
     I              E4AAVN                          TBAAVN
     I              E4AADT                          TBAADT
     I              E4AMTM                          TBAMTM
     I              E4AJST                          TBAJST
     I              E4AHVN                          TBAHVN
     I              E4AGVN                          TBAGVN
     I              E4ABVN                          TBABVN
     I              E4ABDT                          TBABDT
     I              E4ABTM                          TBABTM
      *
     I@E4CPF6
      * MPR Estimated Purchases   Update index
      * Renamed input format fields
     I              E4HONB                          TCHONB
     I              E4ETDT                          TCETDT
     I              E4C0A1                          TCC0A1
     I              E4C1A1                          TCC1A1
     I              E4AAVN                          TCAAVN
     I              E4AADT                          TCAADT
     I              E4AMTM                          TCAMTM
     I              E4AJST                          TCAJST
     I              E4AHVN                          TCAHVN
     I              E4AGVN                          TCAGVN
     I              E4ABVN                          TCABVN
     I              E4ABDT                          TCABDT
     I              E4ABTM                          TCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPKE61    E DSPKE6CPL0
      * UPD : MPR Prior Day Slaughtered Update index
      * Renamed input format fields
     I              E6H8CD                          WJH8CD
     I              E6ETDT                          WJETDT
     I              E6C2A1                          WJC2A1
     I              E6IBCD                          WJIBCD
     I              E6DOA1                          WJDOA1
     I              E6DPA1                          WJDPA1
     I              E6DQA1                          WJDQA1
     I              E6UUPR                          WJUUPR
     I              E6UVPR                          WJUVPR
     I              E6UWPR                          WJUWPR
     I              E6UXPR                          WJUXPR
     I              E6DRA1                          WJDRA1
     I              E6DSA1                          WJDSA1
     I              E6UYPR                          WJUYPR
     I              E6DTA1                          WJDTA1
     I              E6DUA1                          WJDUA1
     I              E6DVA1                          WJDVA1
     I              E6AAVN                          WJAAVN
     I              E6AADT                          WJAADT
     I              E6AMTM                          WJAMTM
     I              E6AJST                          WJAJST
     I              E6AHVN                          WJAHVN
     I              E6AGVN                          WJAGVN
     I              E6ABVN                          WJABVN
     I              E6ABDT                          WJABDT
     I              E6ABTM                          WJABTM
      *
     IYARDCS      DS                            128
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKE71    E DSPKE7CPL0
      * UPD : MPR Prior Day Purchased   Update index
      * Renamed input format fields
     I              E7H8CD                          WRH8CD
     I              E7ETDT                          WRETDT
     I              E7C2A1                          WRC2A1
     I              E7IBCD                          WRIBCD
     I              E7DWA1                          WRDWA1
     I              E7DXA1                          WRDXA1
     I              E7DYA1                          WRDYA1
     I              E7DZA1                          WRDZA1
     I              E7D0A1                          WRD0A1
     I              E7UZPR                          WRUZPR
     I              E7AAVN                          WRAAVN
     I              E7AADT                          WRAADT
     I              E7AMTM                          WRAMTM
     I              E7AJST                          WRAJST
     I              E7AHVN                          WRAHVN
     I              E7AGVN                          WRAGVN
     I              E7ABVN                          WRABVN
     I              E7ABDT                          WRABDT
     I              E7ABTM                          WRABTM
      *
     IYBRDCS      DS                            105
     IQPKAX1    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Renamed input format fields
     I              AXHMNB                          WSHMNB
     I              AXBNNB                          WSBNNB
     I              AXBONB                          WSBONB
     I              AXCQDT                          WSCQDT
     I              AXABTH                          WSABTH
     I              AXACTH                          WSACTH
     I              AXBPNB                          WSBPNB
     I              AXCSNB                          WSCSNB
     I              AXAUDT                          WSAUDT
     I              AXCMST                          WSCMST
     I              AXAGPR                          WSAGPR
     I              AXATVA                          WSATVA
     I              AXI1ST                          WSI1ST
     I              AXDHNB                          WSDHNB
     I              AXDINB                          WSDINB
     I              AXCNST                          WSCNST
     I              AXGINB                          WSGINB
     I              AXBZDT                          WSBZDT
     I              AXLSNB                          WSLSNB
     I              AXF3TX                          WSF3TX
     I              AXO8ST                          WSO8ST
     I              AXO9ST                          WSO9ST
     I              AXPAST                          WSPAST
     I              AXLDSH                          WSLDSH
     I              AXPBST                          WSPBST
     I              AXPCST                          WSPCST
     I              AXPDST                          WSPDST
     I              AXUWST                          WSUWST
     I              AXUXST                          WSUXST
     I              AXUYST                          WSUYST
     I              AXJKRU                          WSJKRU
     I              AXKEOR                          WSKEOR
     I              AXIOEW                          WSIOEW
     I              AXKJIO                          WSKJIO
     I              AXIOJR                          WSIOJR
     I              AXEIRR                          WSEIRR
     I              AXITMF                          WSITMF
     I              AXODJE                          WSODJE
     I              AXRJIF                          WSRJIF
     I              AXOEJF                          WSOEJF
     I              AXD0DT                          WSD0DT
     I              AXD1DT                          WSD1DT
     I              AXD2DT                          WSD2DT
     I              AXD3DT                          WSD3DT
     I              AXD4DT                          WSD4DT
     I              AXBNCD                          WSBNCD
     I              AXABCD                          WSABCD
     I              AXAECD                          WSAECD
     I              AXAAVN                          WSAAVN
     I              AXAADT                          WSAADT
     I              AXAMTM                          WSAMTM
     I              AXAJST                          WSAJST
     I              AXAHVN                          WSAHVN
     I              AXAGVN                          WSAGVN
     I              AXABVN                          WSABVN
     I              AXABDT                          WSABDT
     I              AXABTM                          WSABTM
      *
     IYCRDCS      DS                            236
     IQPKFH1    E DSPKFHCPL0
      * UPD : MPR Prior Day Sched Dtl   Update index
      * Renamed input format fields
     I              FHH8CD                          WWH8CD
     I              FHETDT                          WWETDT
     I              FHC2A1                          WWC2A1
     I              FHCQDT                          WWCQDT
     I              FHBNNB                          WWBNNB
     I              FHBONB                          WWBONB
     I              FHABCD                          WWABCD
     I              FHAECD                          WWAECD
     I              FHBPNB                          WWBPNB
     I              FHAAVN                          WWAAVN
     I              FHAADT                          WWAADT
     I              FHAMTM                          WWAMTM
     I              FHAJST                          WWAJST
     I              FHAHVN                          WWAHVN
     I              FHAGVN                          WWAGVN
     I              FHABVN                          WWABVN
     I              FHABDT                          WWABDT
     I              FHABTM                          WWABTM
      *
     IYDRDCS      DS                             92
     IQPKE51    E DSPKE5CPL0
      * UPD : MPR Prior Day Scheduled   Update index
      * Renamed input format fields
     I              E5H8CD                          WYH8CD
     I              E5ETDT                          WYETDT
     I              E5C2A1                          WYC2A1
     I              E5C4A1                          WYC4A1
     I              E5C5A1                          WYC5A1
     I              E5C6A1                          WYC6A1
     I              E5C7A1                          WYC7A1
     I              E5C8A1                          WYC8A1
     I              E5C9A1                          WYC9A1
     I              E5DAA1                          WYDAA1
     I              E5DBA1                          WYDBA1
     I              E5DCA1                          WYDCA1
     I              E5DDA1                          WYDDA1
     I              E5DEA1                          WYDEA1
     I              E5DFA1                          WYDFA1
     I              E5DGA1                          WYDGA1
     I              E5DHA1                          WYDHA1
     I              E5AAVN                          WYAAVN
     I              E5AADT                          WYAADT
     I              E5AMTM                          WYAMTM
     I              E5AJST                          WYAJST
     I              E5AHVN                          WYAHVN
     I              E5AGVN                          WYAGVN
     I              E5ABVN                          WYABVN
     I              E5ABDT                          WYABDT
     I              E5ABTM                          WYABTM
      *
     IYERDCS      DS                            123
     IYFRDCS      DS                             92
     IQPKE41    E DSPKE4CPL0
      * UPD : MPR Estimated Purchases   Update index
      * Renamed input format fields
     I              E4HONB                          TCHONB
     I              E4ETDT                          TCETDT
     I              E4C0A1                          TCC0A1
     I              E4C1A1                          TCC1A1
     I              E4AAVN                          TCAAVN
     I              E4AADT                          TCAADT
     I              E4AMTM                          TCAMTM
     I              E4AJST                          TCAJST
     I              E4AHVN                          TCAHVN
     I              E4AGVN                          TCAGVN
     I              E4ABVN                          TCABVN
     I              E4ABDT                          TCABDT
     I              E4ABTM                          TCABTM
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * N :  Company Number USR
     I                                    P   1   20P1GGNB
     IP2PARM      DS
      * N :  Last Kill Date Rptd USR
     I                                    P   1   40P2EUDT
     IP3PARM      DS
      * N :  Pmt Current Payment Date
     I                                    P   1   40P3CKDT
     IP4PARM      DS
      * N :  Kill Date Usr
     I                                    P   1   40P4CGDT
     IP5PARM      DS
      * B :  MPR Identification Num
     I                                        1   5 P5H8CD
     IP6PARM      DS
      * FLD: MPR Prior Day Scheduled
      * B :  MPR Reporting Date
     I                                    P   1   40P6ETDT
      * B :  MPR Reporting Time
     I                                    P   5   50P6C2A1
      * N :  MPR Sch Head Day 1
     I                                    P   6   90P6C4A1
      * N :  MPR Sch Head Day 2
     I                                    P  10  130P6C5A1
      * N :  MPR Sch Head Day 3
     I                                    P  14  170P6C6A1
      * N :  MPR Sch Head Day 4
     I                                    P  18  210P6C7A1
      * N :  MPR Sch Head Day 5
     I                                    P  22  250P6C8A1
      * N :  MPR Sch Head Day 6
     I                                    P  26  290P6C9A1
      * N :  MPR Sch Head Day 7
     I                                    P  30  330P6DAA1
      * N :  MPR Sch Head Day 8
     I                                    P  34  370P6DBA1
      * N :  MPR Sch Head Day 9
     I                                    P  38  410P6DCA1
      * N :  MPR Sch Head Day 10
     I                                    P  42  450P6DDA1
      * N :  MPR Sch Head Day 11
     I                                    P  46  490P6DEA1
      * N :  MPR Sch Head Day 12
     I                                    P  50  530P6DFA1
      * N :  MPR Sch Head Day 13
     I                                    P  54  570P6DGA1
      * N :  MPR Sch Head Day 14
     I                                    P  58  610P6DHA1
     IP7PARM      DS
      * O :  MPR Day Sts USR
     I                                        1   1 P7V8ST
     IP8PARM      DS
      * B :  MPR LS118C file created
     I                                        1   1 P8WAST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P5H8CD    PARM P5H8CD    WP0001  5        MPR Identificat
     C           P6ETDT    PARM P6ETDT    WP0002  70       MPR Reporting D
     C           P6C2A1    PARM P6C2A1    WP0003  10       MPR Reporting T
     C           P7V8ST    PARM P7V8ST    WP0004  1        MPR Day Sts USR
     C           P8WAST    PARM P8WAST    WP0005  1        MPR LS118C file
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Prior Day Report  XF
      * 4/16/01  Process kill dates until the Reporting date is reached,
      *          not the Curr Paym Date.
      * 4/19/01  Create Estimated Purchases for LS119A Dly Purch Summary
      * 8/16/02  Create new file with Prior day Sched Dtl  - PKFHCPP
      * 12/09/02  Bld Prior Day Sched with BOL access path keyed on Delv
      *           instead of Kill date.        (LS118A)
      *   On Build Estimated Fields for LS119A, create Detail rcd with rp
      * 02/26/04 RMC Prior Day Purch: MPR Head = SUM(TH Hd Rcvd for QM ho
      *              instead of the BOL Head Received.     (LS118C)
      * Rtv System Date       UP - STR User Source Functions  * 
     C                     CALL 'PKPSUPR'              90  Rtv System Date
     C           P6ETDT    PARM *ZERO     WQ0001  70       *DATE
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKPSUPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     Z-ADD3         P6C2A1           MPR Reporting T
      * * Retrieve the default Company Number for the User *
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           YL0001    PARM *BLANK    WQ0002  3        Oms Warehouse C
     C           P1GGNB    PARM *ZERO     WQ0003  30       CC Company Numb
     C                     PARM 'HPE'     WQ0004  6        Oms Application
     C           YL0002    PARM *BLANK    WQ0005  3        Oms SalesPerson
     C           YL0003    PARM *BLANK    WQ0006  1        Oms Allow Multi
     C           YL0004    PARM *BLANK    WQ0007 10        Oms Default Pri
     C           YL0005    PARM *BLANK    WQ0008 30        Oms Name
     C           YL0006    PARM *BLANK    WQ0009 40        Oms System Valu
     C           YL0007    PARM *BLANK    WQ0010  1        Oms Access Deni
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * * Validate if Kill Day Sts is Yes for the Current Date *
      * VAL Kill Day    2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDWBXFR'              90  VAL Kill Day
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0011  30       PPWS Company Nu
     C                     PARM P6ETDT    WQ0012  70       Kill Date Usr
     C           YL0008    PARM *BLANK    WQ0013  1        Invalid Y/N USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *    - If Invalid Y/N USR = Y, then Kill Day Sts = N.
      *    - If Invalid Y/N USR = N, then Kill Day Sts = Y.
      * Continue processing if Invalid Y/N is No.
      * CASE: LCL.Invalid Y/N USR is No
     C           YL0008    IFEQ 'N'                        *IF
      * * Set Reporting Day Status to Yes                              *
     C                     MOVEL'Y'       P7V8ST           MPR Day Sts USR
      * * Retrieve the Last Kill Date Reported from the Company Values *
      * Rtv Company Value Nbr XF - STR Order Management Sys  * 
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0014  30       BOH Company Num
     C                     PARM @CN,01    WQ0015 10        Company Value C
     C           YL0009    PARM *ZERO     WQ0016 155       System Value Nu
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PAR.Last Kill Date Rptd USR = LCL.System Value Numeric  USR
     C                     Z-ADDYL0009    P2EUDT           Last Kill Date
      * * Retrieve the Current Payment Date *
      * RTV Payment Prc        RT - Payment Processing Parms  * 
     C                     EXSR SARVGN
      * * Retrieve Plant Establishment Number from the Company Values *
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0017  30       BOH Company Num
     C                     PARM 'PLTESTNO'WQ0018 10        Company Value C
     C           YL0011    PARM *BLANK    WQ0019 40        System Value Al
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0011    P5H8CD           MPR Identificat
      * * Build Prior Day files for paid Kill Dates *
      * Process each day, starting with the day after the Last Kill Date
      * Reported, until the Reporting Date is reached.
      * PAR.Kill Date Usr = PAR.Last Kill Date Rptd USR + CON.1 *DAYS
     C           P2EUDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4CGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4CGDT
     C                     END
      * Process Kill Date while Kill Date < Reporting Date
      * DO WHILE: PAR.Kill Date Usr LT PAR.MPR Reporting Date
     C           P4CGDT    DOWLTP6ETDT                     *DOW
      * * Validate if Kill Day Sts for the Date in the Calendar is Yes *
      * VAL Kill Day    2 OMS XF - STR Order Management Sys  * 
     C                     CALL 'PDWBXFR'              90  VAL Kill Day
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0020  30       PPWS Company Nu
     C                     PARM P4CGDT    WQ0021  70       Kill Date Usr
     C           YL0008    PARM *BLANK    WQ0022  1        Invalid Y/N USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDWBXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *    - If Invalid Y/N USR = Y, then Kill Day Sts = N.
      *    - If Invalid Y/N USR = N, then Kill Day Sts = Y.
      * If Kill Day Sts = Y, then build the Prior Day Report files
      * CASE: LCL.Invalid Y/N USR is No
     C           YL0008    IFEQ 'N'                        *IF
      * ***** Build File B: MPR Prior Day Slaughtered *****
      * DOC:  Slaughter Swine  LS118B
     C                     EXSR UASUBR                     DOC:  Slaughter
      * MPR Bld Prior Day Slg RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * ***** Build File C: MPR Prior Day Purchased   *****
      * DOC:  Purchased Swine    LS118C
     C                     EXSR UBSUBR                     DOC:  Purchased
      * Rtv MPR Prior Day PrchRT - Buy Order Header  * 
     C                     EXSR SLRVGN
      * If Rerun -- records would have been created on 1st pass, so chg f
      * CASE: WRK.Record Added Usr is No
     C           WUIHST    IFEQ 'N'                        *IF
      * Rtv Record f/RptDay   RT - MPR Prior Day Purchased  * 
     C                     EXSR SURVGN
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Record Added Usr is No
      *   |- c2    : PAR.MPR LS118C file created is Not Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUIHST    IFEQ 'N'                        *IF
     C           P8WAST    IFEQ *BLANK                     *IF
     C           P8WAST    OREQ 'N'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       P8WAST           MPR LS118C file
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       P8WAST           MPR LS118C file
     C                     END                             *FI
      * * Update the Last Kill Date Reported in the Company Values *
      * LCL.System Value Numeric  USR = PAR.Kill Date Usr
     C                     Z-ADDP4CGDT    YL0009           System Value Nu
      * RTV/Chg Co Val Num    XF - STR Order Management Sys  * 
     C                     CALL 'PDHFXFR'              90  RTV/Chg Co Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1GGNB    WQ0081  30       BOH Company Num
     C                     PARM @CN,01    WQ0082 10        Company Value C
     C                     PARM YL0009    WQ0083 155       System Value Nu
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHFXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PAR.Last Kill Date Rptd USR = LCL.System Value Numeric  USR
     C                     Z-ADDYL0009    P2EUDT           Last Kill Date
     C                     END                             *FI
      * * Increment the Date by 1 *
      * PAR.Kill Date Usr = PAR.Kill Date Usr + CON.1 *DAYS
     C           P4CGDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4CGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4CGDT
     C                     END
     C                     END                             *ITR
      * ***** Build File A: MPR Prior Day Scheduled   *****
      * DOC:  Scheduled Swine   LS118A
     C                     EXSR UCSUBR                     DOC:  Scheduled
      * - Commented out 07/01/03 -
     C                     Z-ADDP6ETDT    P4CGDT           Kill Date Usr
      * --------------------------
     C                     Z-ADD1         YL0072           Count USR
      * DO WHILE: LCL.Count USR is LE 14
     C           YL0072    DOWLE14                         *DOW
      * MPR Bld Prior Day Sch RT - Buy Order Load  * 
     C                     EXSR SVRVGN
      * Move Planned Kill to appropriate Day
      * CASE: LCL.Count USR is One
     C           YL0072    IFEQ 1                          *IF
     C                     Z-ADDYL0073    P6C4A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Two
     C           YL0072    IFEQ 2                          *IF
     C                     Z-ADDYL0073    P6C5A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Three
     C           YL0072    IFEQ 3                          *IF
     C                     Z-ADDYL0073    P6C6A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Four
     C           YL0072    IFEQ 4                          *IF
     C                     Z-ADDYL0073    P6C7A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Five
     C           YL0072    IFEQ 5                          *IF
     C                     Z-ADDYL0073    P6C8A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Six
     C           YL0072    IFEQ 6                          *IF
     C                     Z-ADDYL0073    P6C9A1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Seven
     C           YL0072    IFEQ 7                          *IF
     C                     Z-ADDYL0073    P6DAA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Eight
     C           YL0072    IFEQ 8                          *IF
     C                     Z-ADDYL0073    P6DBA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Nine
     C           YL0072    IFEQ 9                          *IF
     C                     Z-ADDYL0073    P6DCA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Ten
     C           YL0072    IFEQ 10                         *IF
     C                     Z-ADDYL0073    P6DDA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Eleven
     C           YL0072    IFEQ 11                         *IF
     C                     Z-ADDYL0073    P6DEA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Twelve
     C           YL0072    IFEQ 12                         *IF
     C                     Z-ADDYL0073    P6DFA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Thirteen
     C           YL0072    IFEQ 13                         *IF
     C                     Z-ADDYL0073    P6DGA1           MPR Sch Head Da
     C                     ELSE
      * CASE: LCL.Count USR is Fourteen
     C           YL0072    IFEQ 14                         *IF
     C                     Z-ADDYL0073    P6DHA1           MPR Sch Head Da
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * PAR.Kill Date Usr = PAR.Kill Date Usr + CON.1 *DAYS
     C           P4CGDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P4CGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P4CGDT
     C                     END
     C                     ADD  1         YL0072           Count USR
     C                     END                             *ITR
      * Upd Prior Day Sched   RT - MPR Prior Day Scheduled  * 
     C                     EXSR SZRVGN
      * ***** Build File LS119A: MPR Daily Purchase Summary Estimated fie
      * This happens every morning. Jancie can maintain it throughout the
      * 12/09/02 Create detail here too, with reporting time=1
      * MPR Bld Estimtd f/Sch RT - Buy Order Load  * 
     C                     EXSR TCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * * Set Reporting Day Status to No                               *
     C                     MOVEL'N'       P7V8ST           MPR Day Sts USR
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Payment Prc        RT - Payment Processing Parms  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHONB           CC Company Numb
      * Setup key
     C                     Z-ADDP1GGNB    WAHONB           CC Company Numb
      * Establish starting position
     C           KRSSA     CHAIN@C4REO7              90    *
      * Data record not found
     C   90                MOVEL'PRK0434' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWACKDT    P3CKDT           Pmt Current Pay
     C                     Z-ADDWAM1NB    YL0010           Pmt Current Pay
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * MPR Bld Prior Day Slg RT - Tattoo Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0002  10       MPR Slg Class C
     C                     Z-ADD*ZERO     WN0003  10       MPR Slg Purchas
     C                     Z-ADD*ZERO     WN0004  60       MPR Slg Head
     C                     Z-ADD*ZERO     WN0005  52       MPR Slg Base Pr
     C                     Z-ADD*ZERO     WN0006  52       MPR Slg Avg Net
     C                     Z-ADD*ZERO     WN0007  52       MPR Slg Low Net
     C                     Z-ADD*ZERO     WN0008  52       MPR Slg High Ne
     C                     Z-ADD*ZERO     WN0009  51       MPR Slg Avg Liv
     C                     Z-ADD*ZERO     WN0010  51       MPR Slg Avg Car
     C                     Z-ADD*ZERO     WN0011  52       MPR Slg Avg Sor
     C                     Z-ADD*ZERO     WN0012  42       MPR Slg Avg Bac
     C                     Z-ADD*ZERO     WN0013  42       MPR Slg Avg Loi
     C                     Z-ADD*ZERO     WN0014  41       MPR Slg Avg Lea
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    YL0012           PD Producer Cod
      * 9/24/02 RMC Output 2 dec avg backfat and loin eye
      * 5/28/03 RMC Output for Sort Loss Calc
      * 2/25/04 RMC Only report price data for Non-Packer Producers (was
      * 2/26/04 RMC Lot = TattooLoad because SBD research hogs may have t
      * same Tattoo on multiple loads.  This makes the pke6cpp rcd unique
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQSB02           TH Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           TH Kill Date
      * Setup key
     C                     Z-ADDP1GGNB    WQSB01           BOH Company Num
     C                     Z-ADDP4CGDT    WQSB02           TH Kill Date
      * Establish starting position
     C           KRSSB     SETLL@A1CPCV                    *
     C           KRSSB     READE@A1CPCV                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * OMT: Resales
      * CASE: DB1.TH Hog Class Type is Resale
     C           WBLLST    IFEQ 'R'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Held Over Head > 0
      * CASE: DB1.TH Held Over is greater than 0
     C           WBH9NB    IFGT *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Held Over Record = Y & Held Over Completed = 0
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held/Ovr Completed Dte is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBE1ST    IFEQ 'Y'                        *IF
     C           WBBSDT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OMT: Balanced
      * CASE: DB1.TH Kill Balancing Sts is Not Balanced Carcass
     C           WBDWST    IFEQ 'E'                        *IF
     C           WBDWST    OREQ *BLANK
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Selected Tattoo
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Changed 02/26/04 because Research hogs for SBD have the same tatt
      * on multiple loads.  This makes the pke6cpp rcd unique
     C                     MOVEL*BLANK    WUDDCD           Tattoo Nbr Alph
     C                     MOVELWBCVNB    WUDDCD           Tattoo Nbr Alph
     C                     MOVEL*BLANK    WUP9TX           Buy Order Load
     C                     MOVELWBBONB    WUP9TX           Buy Order Load
     C                     Z-ADD*ZERO     ZQ      50
     C           WUDDCD    CAT  WUP9TX:ZQ WN0001    P      MPR Lot Identif
     C                     Z-ADD1         WN0002           MPR Slg Class C
      * MPR Purchase Type Code
      * CASE: LCL.PD Producer Code NE DB1.PD Producer Code
     C           YL0012    IFNE WBABCD                     *IF
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR SCRVGN
     C                     MOVELWBABCD    YL0012           PD Producer Cod
     C                     END                             *FI
     C                     Z-ADDWBFENB    WN0004           MPR Slg Head
     C                     Z-ADDWBD7PR    WN0005           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WN0007           MPR Slg Low Net
     C                     Z-ADD*ZERO     WN0008           MPR Slg High Ne
     C                     Z-ADDWBF7NB    WN0009           MPR Slg Avg Liv
     C                     Z-ADDWBHDNB    WN0010           MPR Slg Avg Car
      * *** New sort loss calc            5/27/03
      * Rtv CMP grading type  RT - Buy Order Header  * 
     C                     EXSR SDRVGN
      * Sort loss per grading type
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0013    IFEQ 'S'                        *IF
     C                     Z-ADDWBEFPR    WN0011           MPR Slg Avg Sor
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.TH Hot Wgt is Not Zero
     C           WBE0NB    IFGT *ZERO                      *IF
      * Comp:MPR Sort Loss
      * PAR.MPR Slg Avg Sort Loss =
      *    *COMPUTE (x1/(x2/x3))
      * x1    : DB1.TH MPR Sort Loss
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : DB1.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WBE0NB    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WBNCHF    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0011           MPR Slg Avg Sor
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0011           MPR Slg Avg Sor
     C                     END                             *FI
     C                     END                             *FI
      * ***
      * CASE: DB1.TH Avg Backfat - 2 Dec is Entered
     C           WBMCNF    IFGT 0                          *IF
     C                     Z-ADDWBMCNF    WN0012           MPR Slg Avg Bac
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBF2NB    WN0012           MPR Slg Avg Bac
     C                     END                             *FI
      * CASE: DB1.TH Avg Loin Eye - 2 dec is Entered
     C           WBMVNF    IFGT 0                          *IF
     C                     Z-ADDWBMVNF    WN0013           MPR Slg Avg Loi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWBF3NB    WN0013           MPR Slg Avg Loi
     C                     END                             *FI
     C                     Z-ADDWBF4NB    WN0014           MPR Slg Avg Lea
     C                     Z-ADDWBCBPR    YL0014           TH Payment Gros
     C                     Z-ADDWBE0NB    YL0015           TH Hot Wgt
      * If Held Over Record = Y, sum info for all days
      * CASE: DB1.TH Held Over Record is Yes
     C           WBE1ST    IFEQ 'Y'                        *IF
      *
     C                     Z-ADD*ZERO     WN0015 152       Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0016 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0017 152       Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0018 152       Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0019 152       Loin-Eye * Wgt
      *
      * Prt Crc Sum (Hld Ovr) IF
      * 9/24/02 RMC Calc 2 dec backfat and loin eye
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0016           TH Kill Date
     C                     Z-ADD*ZERO     YL0017           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0018           TH Head Receive
     C                     Z-ADD*ZERO     YL0019           TH Yard Deads
     C                     Z-ADD*ZERO     YL0020           TH Head Condemn
     C                     Z-ADD*ZERO     WN0004           TH Head Killed
     C                     Z-ADD*ZERO     YL0021           TH Head Adds
     C                     Z-ADD*ZERO     YL0022           TH Live Wgt
     C                     Z-ADD*ZERO     YL0023           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0015           TH Hot Wgt
     C                     Z-ADD*ZERO     WN0009           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0010           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0014           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0024           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0025           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0026           TH Actual Yield
     C                     Z-ADD*ZERO     YL0027           TH Adj Actual Y
     C                     Z-ADD*ZERO     YL0029           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0030           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0031           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0032           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0033           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0034           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0035           TH Deduction Am
     C                     Z-ADD*ZERO     YL0036           TH Carcass Net
     C                     Z-ADD*ZERO     YL0037           TH Additions Am
     C                     Z-ADD*ZERO     YL0014           TH Payment Gros
     C                     Z-ADD*ZERO     YL0038           Th Payment Net
     C                     Z-ADD*ZERO     YL0039           TH Shipped Weig
     C                     Z-ADD*ZERO     YL0040           TH FFLI
     C                     Z-ADD*ZERO     YL0041           TH Head Exclude
     C                     Z-ADD*ZERO     YL0042           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0005           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0043           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0044           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0045           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0046           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0047           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0048           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0049           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0050           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0051           TH CM Gross Liv
     C                     Z-ADD*ZERO     YL0052           TH CM Gross Car
     C                     Z-ADD*ZERO     YL0053           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0054           TH PHA Head Add
     C                     Z-ADD*ZERO     YL0055           TH Excluded Gro
     C                     Z-ADD*ZERO     YL0056           TH Excluded Car
     C                     Z-ADD*ZERO     YL0057           TH Excluded Pre
     C                     Z-ADD*ZERO     YL0058           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0059           TH Avg Backfat
     C                     Z-ADD*ZERO     WN0015           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0016           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0017           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0018           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0019           Loin-Eye * Wgt
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
     C                     EXSR SFRVGN
      * Calculate Live /CWT and Carc /CWT
      * CASE: WRK.#Sequence Block is NULL
     C           WUJ0ST    IFEQ *BLANK                     *IF
      * Calculate Carc/CWT if Par.Th Hot Wt is n= 0
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           YL0015    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Carc /CWT
      * PAR.TH CM Bse Mkt Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0029    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0005           TH CM Bse Mkt C
      * TH CM Srt Dsc Carc /CWT
      * PAR.TH CM Srt Dsc Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0030    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0044           TH CM Srt Dsc C
      * TH CM Crc Val Carc /CWT
      * WRK.TH CM Crc Val Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0032    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUEDPR           TH CM Crc Val C
     C                     Z-ADDWUEDPR    YL0048           TH CM Crc Val C
      * TH CM Lean Prem Carc /CWT
      * PAR.TH CM Lean Prem Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0033    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0050           TH CM Lean Prem
      * TH CM Gross Carc /CWT
      * PAR.TH CM Gross Carc /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0034    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0052           TH CM Gross Car
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0005           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     YL0044           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     YL0046           TH CM Yld G/L C
     C                     Z-ADD*ZERO     YL0048           TH CM Crc Val C
     C                     Z-ADD*ZERO     YL0050           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0052           TH CM Gross Car
     C                     END                             *FI
      * Calculate Live/CWT if Par.Th live wt is n= 0
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           YL0022    IFNE WUE9NB                     *IF
      * TH CM Bse Mkt Live /CWT
      * PAR.TH CM Bse Mkt Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Mkt Price Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0022    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0029    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0042           TH CM Bse Mkt L
      * TH CM Srt Dsc Live /CWT
      * PAR.TH CM Srt Dsc Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Sort Discount Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0022    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0030    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0043           TH CM Srt Dsc L
      * TH CM Yld G/L live /CWT
      * PAR.TH CM Yld G/L Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Yield Gain/Loss Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0022    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0031    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0045           TH CM Yld G/L L
      * TH CM Crc Val Live /CWT
      * PAR.TH CM Crc Val Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Base Carcass Value
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0022    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0032    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0047           TH CM Crc Val L
      * TH CM Lean Prem Live /CWT
      * PAR.TH CM Lean Prem Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM LN AddOn/Deduct Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0022    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0033    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0049           TH CM Lean Prem
      * TH CM Gross Live /CWT
      * PAR.TH CM Gross Live /CWT =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : PAR.TH CM Carcass Gross Amt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0022    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0034    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0051           TH CM Gross Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0042           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     YL0043           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     YL0045           TH CM Yld G/L L
     C                     Z-ADD*ZERO     YL0047           TH CM Crc Val L
     C                     Z-ADD*ZERO     YL0049           TH CM Lean Prem
     C                     Z-ADD*ZERO     YL0051           TH CM Gross Liv
     C                     END                             *FI
     C                     END                             *FI
      * Calc Avg Live Wt
      * CASE: PAR.TH Head Received is *Zeros
     C           YL0018    IFEQ *ZERO                      *IF
     C                     Z-ADD*ZERO     WUF7NB           TH Avg Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           YL0022    DIV  YL0018    WUF7NB           TH Avg Live Wgt
     C                     END                             *FI
      * Calc Adj Live Weight
      * CASE: PAR.TH Head Received EQ PAR.TH Head Killed
     C           YL0018    IFEQ WN0004                     *IF
     C                     Z-ADDYL0022    WULRNB           TH Adj Live Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0004    MULT WUF7NB    WULRNB           TH Adj Live Wgt
     C                     END                             *FI
     C                     Z-ADDWUF7NB    WN0009           TH Avg Live Wgt
     C                     Z-ADDWULRNB    YL0023           TH Adj Live Wgt
      * Calc Actual Yield %
      * CASE: PAR.TH Live Wgt NE WRK.Zero USR
     C           YL0022    IFNE WUE9NB                     *IF
      * TH Actual Yield %
      * PAR.TH Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  YL0022    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0026           TH Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0026           TH Actual Yield
     C                     END                             *FI
      * Calc Adj Actual Yield %
      * CASE: PAR.TH Adj Live Wgt NE WRK.Zero USR
     C           YL0023    IFNE WUE9NB                     *IF
      * TH Adj Actual Yield %
      * PAR.TH Adj Actual Yield % =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Adj Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0015    DIV  YL0023    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0027           TH Adj Actual Y
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0027           TH Adj Actual Y
     C                     END                             *FI
      * Calc Avg Hot Wt
      * CASE: PAR.TH Head Killed NE WRK.Zero USR
     C           WN0004    IFNE WUE9NB                     *IF
     C           YL0015    DIV  WN0004    WN0010    H      TH Avg Hot Wgt
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0010           TH Avg Hot Wgt
     C                     END                             *FI
      * Calc Avg Lean %, Loin eye, & Backfat
      * CASE: PAR.TH Hot Wgt NE WRK.Zero USR
     C           YL0015    IFNE WUE9NB                     *IF
     C           WN0015    DIV  YL0015    WN0014    H      TH Avg Lean Per
     C           WN0017    DIV  YL0015    YL0024    H      TH Avg Loin Eye
     C           WN0016    DIV  YL0015    YL0025    H      TH Avg Backfat
     C           WN0019    DIV  YL0015    YL0058    H      TH Avg Loin Eye
     C           WN0018    DIV  YL0015    YL0059    H      TH Avg Backfat
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0014           TH Avg Lean Per
     C                     Z-ADD*ZERO     YL0024           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0025           TH Avg Backfat
     C                     Z-ADD*ZERO     YL0058           TH Avg Loin Eye
     C                     Z-ADD*ZERO     YL0059           TH Avg Backfat
     C                     END                             *FI
      * TH FFLI
      * PAR.TH FFLI =
      *    *COMPUTE (x1 + (x2 * x3) - (x4 * x5))
      * x1    : CON.51.537
      * +     : PGM.*Synon (17,7) work field
      * x2    : CON..035
      * *     : PGM.*Synon (17,7) work field *
      * x3    : PAR.TH Hot Wgt
      * -     : PGM.*Synon (17,7) work field
      * x4    : CON.12.26
      * *     : PGM.*Synon (17,7) work field *
      * x5    : PAR.TH Avg Backfat
     C           .035      MULT YL0015    W0WD02           *Synon (17,7) w
     C           51.537    ADD  W0WD02    W0WD01           *Synon (17,7) w
     C           12.26     MULT YL0025    W0WD03           *Synon (17,7) w
     C           W0WD01    SUB  W0WD03    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0040           TH FFLI
     C                     Z-ADDYL0044    WN0011           MPR Slg Avg Sor
      * 5/29/03  Sort loss per grading type
      * CASE: LCL.CMP Grading Type is Sort Discount Factor
     C           YL0013    IFEQ 'S'                        *IF
     C                     Z-ADDYL0050    WN0011           MPR Slg Avg Sor
     C                     END                             *FI
      * CASE: LCL.TH Avg Backfat - 2 Dec is Entered
     C           YL0059    IFGT 0                          *IF
     C                     Z-ADDYL0059    WN0012           MPR Slg Avg Bac
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0025    WN0012           MPR Slg Avg Bac
     C                     END                             *FI
      * CASE: LCL.TH Avg Loin Eye - 2 dec is Entered
     C           YL0058    IFGT 0                          *IF
     C                     Z-ADDYL0058    WN0013           MPR Slg Avg Loi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDYL0024    WN0013           MPR Slg Avg Loi
     C                     END                             *FI
     C                     END                             *FI
      * * Include all Seaboard Expenses in the Avg Net Price *
      * Rtv MPR Seaboard Exp  RT - Tattoo Ded/Add  * 
     C                     EXSR SHRVGN
     C                     ADD  YL0060    YL0014           TH Payment Gros
      * MPR Slg Avg Net Price
      * CASE: LCL.TH Hot Wgt is Greater then Zero
     C           YL0015    IFGT *ZERO                      *IF
      * RMC 4/09/01  dont round, per Jancie
      * RMC 11/26/01 Round, per Jancie on x1/...
      * RMC 11/27/01 took out x4 which was a (hot wt * 1) before the /100
      * MPR Slg Avg Net Price
      * PAR.MPR Slg Avg Net Price =
      *    *COMPUTE (x1 / (x2 / x3))
      * x1    : LCL.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0015    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0014    DIV  W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0006           MPR Slg Avg Net
     C                     END                             *FI
      * Only report Avg Live Weight if purchased on a Live basis
      * CASE: DB1.TH Payment Type is Carcass Merit
     C           WBJ9ST    IFEQ 'C'                        *IF
     C                     Z-ADD*ZERO     WN0009           MPR Slg Avg Liv
     C                     END                             *FI
      * Only report price data for Non-Packer Producers
      * CASE: PAR.MPR Slg Purchase Type is Packer Owned
     C           WN0003    IFEQ 9                          *IF
     C                     Z-ADD*ZERO     WN0005           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WN0006           MPR Slg Avg Net
     C                     Z-ADD*ZERO     WN0007           MPR Slg Low Net
     C                     Z-ADD*ZERO     WN0008           MPR Slg High Ne
     C                     Z-ADD*ZERO     WN0011           MPR Slg Avg Sor
     C                     END                             *FI
      * Upd Prior Day Slg     RT - MPR Prior Day Slaughtered  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSB     READE@A1CPCV                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCABCD    WQSC01           PD Producer Cod
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           PD Producer Cod
      * Setup key
     C                     MOVELWBABCD    WQSC01           PD Producer Cod
      * Establish starting position
     C           KRSSC     SETLL@E3CPF4                    *
     C           KRSSC     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0003           MPR Purchase Ty
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCC0A1    WN0003           MPR Purchase Ty
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv CMP grading type  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDHMNB           BOH Company Num
     C                     KFLD           WDBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WDHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WDBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSD     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv CMP Grading type  RT - Carcass Merit Program  * 
     C                     EXSR SERVGN
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv CMP Grading type  RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAMCD    WQSE01           CMP Program Cod
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           CMP Program Cod
      * Setup key
     C                     MOVELWDAMCD    WQSE01           CMP Program Cod
      * Establish starting position
     C           KRSSE     SETLL@ARREML                    *
     C           KRSSE     READE@ARREML                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEDLST    YL0013           CMP Grading Typ
     C           KRSSE     READE@ARREML                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0020  72       TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0021  72       TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0022  72       TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0023  72       TH CA Base Carc
     C                     Z-ADD*ZERO     WN0024  72       TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0025  72       TH CA Carcass G
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WUHBST           First Time Flag
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0016           TH Kill Date
     C                     Z-ADD*ZERO     YL0017           TH Dead On Arri
     C                     Z-ADD*ZERO     YL0018           TH Head Receive
     C                     Z-ADD*ZERO     YL0019           TH Yard Deads
     C                     Z-ADD*ZERO     YL0020           TH Head Condemn
     C                     Z-ADD*ZERO     WN0004           TH Head Killed
     C                     Z-ADD*ZERO     YL0021           TH Head Adds
     C                     Z-ADD*ZERO     YL0022           TH Live Wgt
     C                     Z-ADD*ZERO     YL0023           TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0015           TH Hot Wgt
     C                     Z-ADD*ZERO     YL0029           TH CM Base Mkt
     C                     Z-ADD*ZERO     YL0030           TH CM Sort Disc
     C                     Z-ADD*ZERO     YL0031           TH CM Yield Gai
     C                     Z-ADD*ZERO     YL0032           TH CM Base Carc
     C                     Z-ADD*ZERO     YL0033           TH CM LN AddOn/
     C                     Z-ADD*ZERO     YL0034           TH CM Carcass G
     C                     Z-ADD*ZERO     YL0035           TH Deduction Am
     C                     Z-ADD*ZERO     YL0036           TH Carcass Net
     C                     Z-ADD*ZERO     YL0037           TH Additions Am
     C                     Z-ADD*ZERO     YL0014           TH Payment Gros
     C                     Z-ADD*ZERO     YL0038           Th Payment Net
     C                     Z-ADD*ZERO     YL0041           TH Head Exclude
     C                     Z-ADD*ZERO     YL0053           TH Head Adjuste
     C                     Z-ADD*ZERO     YL0054           TH PHA Head Add
     C                     Z-ADD*ZERO     YL0055           TH Excluded Gro
     C                     Z-ADD*ZERO     YL0056           TH Excluded Car
     C                     Z-ADD*ZERO     YL0057           TH Excluded Pre
     C                     Z-ADD*ZERO     WN0015           Lean % * Wgt US
     C                     Z-ADD*ZERO     WN0016           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0017           Loin-Eye * Wgt
     C                     Z-ADD*ZERO     WN0020           TH CA Base Mkt
     C                     Z-ADD*ZERO     WN0021           TH CA Sort Disc
     C                     Z-ADD*ZERO     WN0022           TH CA Yield Gai
     C                     Z-ADD*ZERO     WN0023           TH CA Base Carc
     C                     Z-ADD*ZERO     WN0024           TH CA Lean Prem
     C                     Z-ADD*ZERO     WN0025           TH CA Carcass G
     C                     Z-ADD*ZERO     WN0018           Backfat * Wgt U
     C                     Z-ADD*ZERO     WN0019           Loin-Eye * Wgt
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQSF04           TH Tattoo Numbe
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSF01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSF03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSF04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSF     SETLL@A1CPC4                    *
     C           KRSSF     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Kill Date
      * CASE: WRK.First Time Flag Usr is Yes
     C           WUHBST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       WUHBST           First Time Flag
     C                     END                             *FI
     C                     Z-ADDWFB0DT    YL0016           TH Kill Date
     C                     ADD  WFCXNB    YL0017           TH Dead On Arri
     C                     ADD  WFCWNB    YL0018           TH Head Receive
     C                     ADD  WFFCNB    YL0019           TH Yard Deads
     C                     ADD  WFFDNB    YL0020           TH Head Condemn
     C                     ADD  WFFENB    WN0004           TH Head Killed
     C                     ADD  WFHENB    YL0021           TH Head Adds
     C                     ADD  WFCYNB    YL0022           TH Live Wgt
     C                     ADD  WFLRNB    YL0023           TH Adj Live Wgt
     C                     ADD  WFE0NB    YL0015           TH Hot Wgt
     C                     ADD  WFANPR    YL0029           TH CM Base Mkt
      * 5/29/03 new for sort loss print
      * CASE: PAR.Status 3 is Yes
     C           'Y'       IFEQ 'Y'                        *IF
     C                     ADD  WFNCHF    YL0030           TH CM Sort Disc
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WFAYVA    YL0030           TH CM Sort Disc
     C                     END                             *FI
     C                     ADD  WFAWVA    YL0031           TH CM Yield Gai
     C                     ADD  WFAOPR    YL0032           TH CM Base Carc
     C                     ADD  WFAXVA    YL0033           TH CM LN AddOn/
     C                     ADD  WFAPPR    YL0034           TH CM Carcass G
     C                     ADD  WFATPR    YL0036           TH Carcass Net
     C                     ADD  WFCBPR    YL0014           TH Payment Gros
     C                     ADD  WFCCPR    YL0038           Th Payment Net
      * Lean % * Wgt USR
      * PAR.Lean % * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Lean % * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Lean Percent
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WFF4NB    MULT WFE0NB    W0WD01           *Synon (17,7) w
     C           WN0015    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0015           Lean % * Wgt US
      * Backfat * Wgt USR
      * PAR.Backfat * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WFF2NB    MULT WFE0NB    W0WD01           *Synon (17,7) w
     C           WN0016    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0016           Backfat * Wgt U
      * Loin-Eye * Wgt USR
      * PAR.Loin-Eye * Wgt USR =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye Depth
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WFF3NB    MULT WFE0NB    W0WD01           *Synon (17,7) w
     C           WN0017    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0017           Loin-Eye * Wgt
      * Backfat2 * Wgt USR
      * PAR.Backfat * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Backfat * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Backfat - 2 Dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WFMCNF    MULT WFE0NB    W0WD01           *Synon (17,7) w
     C           WN0018    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0018           Backfat * Wgt U
      * Loin-Eye2 * Wgt USR
      * PAR.Loin-Eye * Wgt USR 2 =
      *    *COMPUTE (x1 + (x2 * x3))
      * x1    : PAR.Loin-Eye * Wgt USR 2
      * +     : PGM.*Synon (17,7) work field
      * x2    : DB1.TH Avg Loin Eye - 2 dec
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : DB1.TH Hot Wgt
     C           WFMVNF    MULT WFE0NB    W0WD01           *Synon (17,7) w
     C           WN0019    ADD  W0WD01    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0019           Loin-Eye * Wgt
     C                     ADD  WFASPR    YL0035           TH Deduction Am
     C                     ADD  WFA5VA    YL0037           TH Additions Am
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
     C                     EXSR SGRVGN
     C                     ADD  WUI6PR    WN0020           TH CA Base Mkt
     C                     ADD  WUI7PR    WN0021           TH CA Sort Disc
     C                     ADD  WUI8PR    WN0022           TH CA Yield Gai
     C                     ADD  WUI9PR    WN0023           TH CA Base Carc
     C                     ADD  WUJAPR    WN0024           TH CA Lean Prem
     C                     ADD  WUJCPR    WN0025           TH CA Carcass G
     C                     END                             *FI
      * PK0166 - New fields
     C                     ADD  WFJ9NB    YL0041           TH Head Exclude
     C                     ADD  WFTBPR    YL0055           TH Excluded Gro
     C                     ADD  WFKROT    YL0056           TH Excluded Car
     C                     ADD  WFOTJG    YL0057           TH Excluded Pre
     C                     ADD  WFIORP    YL0053           TH Head Adjuste
     C                     ADD  WFOWEO    YL0054           TH PHA Head Add
     C           KRSSF     READE@A1CPC4                  90*
     C                     ENDDO
      * USER: Exit processing
      * Analysis to Payments
      * CASE: PAR.Print Carcass Analysis Us is Yes
     C           'N'       IFEQ 'Y'                        *IF
     C                     Z-ADDWN0020    YL0029           TH CM Base Mkt
     C                     Z-ADDWN0021    YL0030           TH CM Sort Disc
     C                     Z-ADDWN0022    YL0031           TH CM Yield Gai
     C                     Z-ADDWN0023    YL0032           TH CM Base Carc
     C                     Z-ADDWN0024    YL0033           TH CM LN AddOn/
     C                     Z-ADDWN0025    YL0034           TH CM Carcass G
     C                     END                             *FI
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Prt Crc Sum (Hld Ovr) RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGHMNB           BOH Company Num
     C                     KFLD           WGBNNB           BOH Buy Order N
     C                     KFLD           WGBONB           BOL Load Number
     C                     KFLD           WGCVNB           TH Tattoo Numbe
     C                     KFLD           WGB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWFHMNB    WGHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WGBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WGBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WGCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WGB0DT           TH Kill Date
      * Establish starting position
     C           KRSSG     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WUI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WUI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WUI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WUJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WUJCPR           TH CA Carcass G
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGI6PR    WUI6PR           TH CA Base Mkt
     C                     Z-ADDWGI7PR    WUI7PR           TH CA Sort Disc
     C                     Z-ADDWGI8PR    WUI8PR           TH CA Yield Gai
     C                     Z-ADDWGI9PR    WUI9PR           TH CA Base Carc
     C                     Z-ADDWGJAPR    WUJAPR           TH CA Lean Prem
     C                     Z-ADDWGJCPR    WUJCPR           TH CA Carcass G
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv MPR Seaboard Exp  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0060           Addt Cst Ttl Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WHBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WHBONB    WQSH03           BOL Load Number
     C           *LIKE     DEFN WHCVNB    WQSH04           TH Tattoo Numbe
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
     C                     KFLD           WQSH04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWBHMNB    WQSH01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSH03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSH04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSH     SETLL@CDCPWY                    *
     C           KRSSH     READE@CDCPWY                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WHA0VA    YL0060           Addt Cst Ttl Us
     C           KRSSH     READE@CDCPWY                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Upd Prior Day Slg     RT - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIH8CD           MPR Identificat
     C                     KFLD           WIETDT           MPR Reporting D
     C                     KFLD           WIC2A1           MPR Reporting T
     C                     KFLD           WIIBCD           MPR Lot Identif
      * Setup key
     C                     MOVELP5H8CD    WIH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WIETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WIC2A1           MPR Reporting T
     C                     MOVELWN0001    WIIBCD           MPR Lot Identif
      * Establish starting position
     C           KRSSI     CHAIN@E6CPGA              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0973' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prior Day Slg     CR - MPR Prior Day Slaughtered  * 
     C                     EXSR SJCRRC
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prior Day Slg     CH - MPR Prior Day Slaughtered  * 
     C                     EXSR SKCHRC
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt Prior Day Slg     CR - MPR Prior Day Slaughtered  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E6CPF9
     C                     MOVELP5H8CD    WJH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WJETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WJC2A1           MPR Reporting T
     C                     MOVELWN0001    WJIBCD           MPR Lot Identif
     C                     Z-ADDWN0002    WJDOA1           MPR Slg Class C
     C                     Z-ADDWN0003    WJDPA1           MPR Slg Purchas
     C                     Z-ADDWN0004    WJDQA1           MPR Slg Head
     C                     Z-ADDWN0005    WJUUPR           MPR Slg Base Pr
     C                     Z-ADDWN0006    WJUVPR           MPR Slg Avg Net
     C                     Z-ADDWN0007    WJUWPR           MPR Slg Low Net
     C                     Z-ADDWN0008    WJUXPR           MPR Slg High Ne
     C                     Z-ADDWN0009    WJDRA1           MPR Slg Avg Liv
     C                     Z-ADDWN0010    WJDSA1           MPR Slg Avg Car
     C                     Z-ADDWN0011    WJUYPR           MPR Slg Avg Sor
     C                     Z-ADDWN0012    WJDTA1           MPR Slg Avg Bac
     C                     Z-ADDWN0013    WJDUA1           MPR Slg Avg Loi
     C                     Z-ADDWN0014    WJDVA1           MPR Slg Avg Lea
     C                     MOVEL*BLANK    WJAAVN           RS User Changed
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL*BLANK    WJAHVN           RS Job
     C                     MOVEL*BLANK    WJAGVN           RS Program
     C                     MOVEL*BLANK    WJABVN           RS User Added
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WJAJST           RS Record Statu
     C                     MOVEL##USR     WJABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WJABDT    PARM *ZERO     WQ0023  70       *DATE
     C           WJABTM    PARM *ZERO     WQ0024  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WJAGVN           RS Program
     C                     MOVEL##JOB     WJAHVN           RS Job
     C           KLCRSJ    KLIST
     C                     KFLD           WJH8CD           MPR Identificat
     C                     KFLD           WJETDT           MPR Reporting D
     C                     KFLD           WJC2A1           MPR Reporting T
     C                     KFLD           WJIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@E6CPF9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0974' W0RTN   7
      * Send message 'MPR Prior Day Slaughte EX'
     C                     MOVEL'PRK0974' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@E6CPF9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCHRC    BEGSR
      *================================================================
      * Chg Prior Day Slg     CH - MPR Prior Day Slaughtered  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0026 10        RS User Changed
     C                     Z-ADD*ZERO     WN0027  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0028  60       RS Time Changed
     C                     MOVEL*BLANK    WN0029  1        RS Record Statu
     C                     MOVEL*BLANK    WN0030 10        RS Job
     C                     MOVEL*BLANK    WN0031 10        RS Program
     C                     MOVEL*BLANK    WN0032 10        RS User Added
     C                     Z-ADD*ZERO     WN0033  70       RS Date Added
     C                     Z-ADD*ZERO     WN0034  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @E6CPF9
     C                     MOVELWIH8CD    WJH8CD    P      MPR Identificat
     C                     Z-ADDWIETDT    WJETDT           MPR Reporting D
     C                     Z-ADDWIC2A1    WJC2A1           MPR Reporting T
     C                     MOVELWIIBCD    WJIBCD    P      MPR Lot Identif
      *
     C           KLCHSK    KLIST
     C                     KFLD           WJH8CD           MPR Identificat
     C                     KFLD           WJETDT           MPR Reporting D
     C                     KFLD           WJC2A1           MPR Reporting T
     C                     KFLD           WJIBCD           MPR Lot Identif
     C           KLCHSK    CHAIN@E6CPF9              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE6CPL0'MDACP
     C                     MOVEL'@E6CPF9' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE61    YARDCS
      * Move non-key fields to @E6CPF9
     C                     Z-ADDWN0002    WJDOA1           MPR Slg Class C
     C                     Z-ADDWN0003    WJDPA1           MPR Slg Purchas
     C                     Z-ADDWN0004    WJDQA1           MPR Slg Head
     C                     Z-ADDWN0005    WJUUPR           MPR Slg Base Pr
     C                     Z-ADDWN0006    WJUVPR           MPR Slg Avg Net
     C                     Z-ADDWN0007    WJUWPR           MPR Slg Low Net
     C                     Z-ADDWN0008    WJUXPR           MPR Slg High Ne
     C                     Z-ADDWN0009    WJDRA1           MPR Slg Avg Liv
     C                     Z-ADDWN0010    WJDSA1           MPR Slg Avg Car
     C                     Z-ADDWN0011    WJUYPR           MPR Slg Avg Sor
     C                     Z-ADDWN0012    WJDTA1           MPR Slg Avg Bac
     C                     Z-ADDWN0013    WJDUA1           MPR Slg Avg Loi
     C                     Z-ADDWN0014    WJDVA1           MPR Slg Avg Lea
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WJAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WJAADT    PARM *ZERO     WQ0025  70       *DATE
     C           WJAMTM    PARM *ZERO     WQ0026  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WJAHVN           RS Job
     C                     MOVEL##PGM     WJAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE61    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@E6CPF9                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE6CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv MPR Prior Day PrchRT - Buy Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0035 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0036  10       MPR Pur Ownersh
     C                     Z-ADD*ZERO     WN0037  10       MPR Pur Class C
     C                     Z-ADD*ZERO     WN0038  10       MPR Pur Purchas
     C                     Z-ADD*ZERO     WN0039  60       MPR Pur Head
     C                     Z-ADD*ZERO     WN0040  51       MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WN0041  52       MPR Pur Base Pr
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PK0254  Create MPR Prior Day Purchases
      *   Initialize constant fields
     C                     Z-ADD1         WN0037           MPR Pur Class C
     C                     Z-ADD*ZERO     WN0040           MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WN0041           MPR Pur Base Pr
     C                     MOVEL'N'       WUIHST           Record Added Us
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKHMNB    WQSL01           BOH Company Num
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
     C                     KFLD           WKASDT           BOH Kill Date
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           BOH Company Num
      * Setup key
     C                     Z-ADDP1GGNB    WQSL01           BOH Company Num
     C                     Z-ADDP4CGDT    WKASDT           BOH Kill Date
      * Establish starting position
     C           KPSSL     SETLL@AWCPGR                    *
     C           KRSSL     READE@AWCPGR                  90*
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR SMRVGN
     C                     Z-ADDWUC0A1    WN0038           MPR Pur Purchas
      * Purchase Ownership Code
      * CASE: DB1.BOH Buy Order Type is Internal
     C           WKA5ST    IFEQ 'I'                        *IF
     C                     Z-ADD1         WN0036           MPR Pur Ownersh
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.MPR Pur Purchase Type is Packer Sold
     C           WN0038    IFGE 5                          *IF
     C           WN0038    ANDLE8
     C                     Z-ADD2         WN0036           MPR Pur Ownersh
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD3         WN0036           MPR Pur Ownersh
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.BOH Quoted Base Mkt Price is Not Zeros
     C           WKALPR    IFNE *ZERO                      *IF
     C                     Z-ADD1         WN0038           MPR Pur Purchas
     C                     END                             *FI
      * Rtv Crt MPR PriorDyPrcRT - Buy Order Load  * 
     C                     EXSR SNRVGN
     C           KRSSL     READE@AWCPGR                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCABCD    WQSM01           PD Producer Cod
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           PD Producer Cod
      * Setup key
     C                     MOVELWKABCD    WQSM01           PD Producer Cod
      * Establish starting position
     C           KRSSM     SETLL@E3CPF4                    *
     C           KRSSM     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUC0A1           MPR Purchase Ty
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCC0A1    WUC0A1           MPR Purchase Ty
     C                     GOTO SMEXIT                     *QUIT
     C           KRSSM     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Crt MPR PriorDyPrcRT - Buy Order Load  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0042 25        MPR Lot Identif
     C                     Z-ADD*ZERO     WN0043  60       MPR Pur Head
     C                     Z-ADD*ZERO     WN0044  51       MPR Pur Avg Liv
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WLBNNB    WQSN02           BOH Buy Order N
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
      * Setup key
     C                     Z-ADDWKHMNB    WQSN01           BOH Company Num
     C                     Z-ADDWKBNNB    WQSN02           BOH Buy Order N
      * Establish starting position
     C           KRSSN     SETLL@AXCPBX                    *
     C           KRSSN     READE@AXCPBX                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOL MPR Prior Day Prch is Not Yes
     C           WLPCST    IFEQ *BLANK                     *IF
     C           WLPCST    OREQ 'N'
     C                     MOVEL*BLANK    WUP8TX           Buy Order Numbe
     C                     MOVELWLBNNB    WUP8TX           Buy Order Numbe
     C                     MOVEL*BLANK    WUP9TX           Buy Order Load
     C                     MOVELWLBONB    WUP9TX           Buy Order Load
     C                     Z-ADD0         ZQ      50
     C           WUP8TX    CAT  WUP9TX:ZQ WN0042    P      MPR Lot Identif
      * Rtv Tattoo Market Hd  RT - Tattoo Header  * 
     C                     EXSR SORVGN
      * 9/20/02 new MPR Compliance issue; 02/26/04 sum(th hd rcvd MARKET)
      * CASE: LCL.Head Total USR is Greater then Zero
     C           YL0061    IFGT *ZERO                      *IF
     C                     Z-ADDYL0061    WN0043           MPR Pur Head
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWLBPNB    WN0043           MPR Pur Head
     C                     END                             *FI
      * Rtv Base Price        RT - Tattoo Header  * 
     C                     EXSR SPRVGN
     C                     Z-ADDYL0063    WN0041           MPR Pur Base Pr
      * If Live, output Avg Live Wt
      * CASE: PAR.BOH Payment Type is Live
     C           WKA4ST    IFEQ 'L'                        *IF
     C                     Z-ADDYL0062    WN0044           MPR Pur Avg Liv
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0044           MPR Pur Avg Liv
     C                     END                             *FI
      * CASE: PAR.MPR Pur Base Price is Entered
     C           WN0041    IFNE 0                          *IF
      * Rtv Upd PriorDayPrch  RT - MPR Prior Day Purchased  * 
     C                     EXSR SQRVGN
      * Chg MPR PriorDayPurch CH - Buy Order Load  * 
     C                     EXSR STCHRC
      * CASE: PAR.Record Added Usr is No
     C           WUIHST    IFEQ 'N'                        *IF
     C                     MOVEL'Y'       WUIHST           Record Added Us
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@AXCPBX                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Tattoo Market Hd  RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0061           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQSO01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQSO02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQSO03           BOL Load Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           BOH Company Num
     C                     KFLD           WQSO02           BOH Buy Order N
     C                     KFLD           WQSO03           BOL Load Number
      * Setup key
     C                     Z-ADDWLHMNB    WQSO01           BOH Company Num
     C                     Z-ADDWLBNNB    WQSO02           BOH Buy Order N
     C                     Z-ADDWLBONB    WQSO03           BOL Load Number
      * Establish starting position
     C           KRSSO     SETLL@A1CPC4                    *
     C           KRSSO     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Hog Class Type is Market
     C           WFLLST    IFEQ 'M'                        *IF
     C                     ADD  WFCWNB    YL0061           Head Total USR
     C                     END                             *FI
     C           KRSSO     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Base Price        RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN WMBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN WMBONB    WQSP03           BOL Load Number
     C           *LIKE     DEFN WMB0DT    WQSP04           TH Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
     C                     KFLD           WQSP04           TH Kill Date
      * Setup key
     C                     Z-ADDWLHMNB    WQSP01           BOH Company Num
     C                     Z-ADDWLBNNB    WQSP02           BOH Buy Order N
     C                     Z-ADDWLBONB    WQSP03           BOL Load Number
     C                     Z-ADDWLCQDT    WQSP04           TH Kill Date
      * Establish starting position
     C           KRSSP     SETLL@A1CPOC                    *
     C           KRSSP     READE@A1CPOC                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0062           TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLBNNB    WQ0027  50       BOH Buy Order N
     C                     PARM WLBONB    WQ0028  50       BOL Load Number
     C                     PARM YL0064    WQ0029  50       TH Tattoo Numbe
     C                     PARM WLCQDT    WQ0030  70       TH Purchase Dat
     C                     PARM YL0065    WQ0031  71       TH Live Wgt
     C           YL0063    PARM *ZERO     WQ0032  52       TH CM Base Mkt
     C                     PARM WLCQDT    WQ0033  70       TH Kill Date
     C                     PARM WLHMNB    WQ0034  30       BOH Company Num
     C                     PARM YL0066    WQ0035  52       PSC Floor Price
     C                     PARM YL0067    WQ0036  52       PSC Ceiling Pri
     C                     PARM YL0068    WQ0037  30       PSC Market Perc
     C           YL0069    PARM YL0069    WQ0038  52       Market Price US
     C           YL0070    PARM *BLANK    WQ0039  2        Pricing UOM USR
     C           YL0071    PARM *ZERO     WQ0040  70       Pricing Date US
     C                     PARM WKAICD    WQ0041  3        PO Option Code
     C                     PARM WKAKCD    WQ0042  5        PC Contract Cod
     C                     PARM WKALCD    WQ0043  5        PSC Sub-Contrac
     C                     PARM WKAAPR    WQ0044  52       BOH Market Add/
     C                     PARM WKAMCD    WQ0045  3        CMP Program Cod
     C                     PARM WKB3ST    WQ0046  2        BOH Quote Price
     C                     PARM WKALPR    WQ0047  52       BOH Quoted Base
     C                     PARM WKETCD    WQ0048  3        BOH Commodity M
     C                     PARM WKEUCD    WQ0049  7        BOH Commodity P
     C                     PARM WKJ5TX    WQ0050  3        BOH Market Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.TH CM Base Mkt Price EQ PAR.BOH Market Add/Deduct
     C           YL0063    IFEQ WKAAPR                     *IF
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
     C                     END                             *FI
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Clc Base Mkt Price    XF - Pricing Option  * 
     C                     CALL 'PKJ7XFR'              90  Clc Base Mkt Pr
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WMBNNB    WQ0051  50       BOH Buy Order N
     C                     PARM WMBONB    WQ0052  50       BOL Load Number
     C                     PARM WMCVNB    WQ0053  50       TH Tattoo Numbe
     C                     PARM WMAWDT    WQ0054  70       TH Purchase Dat
     C                     PARM WMCYNB    WQ0055  71       TH Live Wgt
     C           YL0063    PARM *ZERO     WQ0056  52       TH CM Base Mkt
     C                     PARM WMB0DT    WQ0057  70       TH Kill Date
     C                     PARM WMHMNB    WQ0058  30       BOH Company Num
     C                     PARM YL0066    WQ0059  52       PSC Floor Price
     C                     PARM YL0067    WQ0060  52       PSC Ceiling Pri
     C                     PARM YL0068    WQ0061  30       PSC Market Perc
     C           YL0069    PARM YL0069    WQ0062  52       Market Price US
     C           YL0070    PARM *BLANK    WQ0063  2        Pricing UOM USR
     C           YL0071    PARM *ZERO     WQ0064  70       Pricing Date US
     C                     PARM WKAICD    WQ0065  3        PO Option Code
     C                     PARM WKAKCD    WQ0066  5        PC Contract Cod
     C                     PARM WKALCD    WQ0067  5        PSC Sub-Contrac
     C                     PARM WKAAPR    WQ0068  52       BOH Market Add/
     C                     PARM WKAMCD    WQ0069  3        CMP Program Cod
     C                     PARM WKB3ST    WQ0070  2        BOH Quote Price
     C                     PARM WKALPR    WQ0071  52       BOH Quoted Base
     C                     PARM WKETCD    WQ0072  3        BOH Commodity M
     C                     PARM WKEUCD    WQ0073  7        BOH Commodity P
     C                     PARM WKJ5TX    WQ0074  3        BOH Market Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKJ7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.TH CM Base Mkt Price EQ PAR.BOH Market Add/Deduct
     C           YL0063    IFEQ WKAAPR                     *IF
     C                     Z-ADD*ZERO     YL0063           TH CM Base Mkt
     C                     END                             *FI
     C                     Z-ADDWMF7NB    YL0062           TH Avg Live Wgt
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Upd PriorDayPrch  RT - MPR Prior Day Purchased  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0045 10        RS User Changed
     C                     Z-ADD*ZERO     WN0046  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0047  60       RS Time Changed
     C                     MOVEL*BLANK    WN0048  1        RS Record Statu
     C                     MOVEL*BLANK    WN0049 10        RS Job
     C                     MOVEL*BLANK    WN0050 10        RS Program
     C                     MOVEL*BLANK    WN0051 10        RS User Added
     C                     Z-ADD*ZERO     WN0052  70       RS Date Added
     C                     Z-ADD*ZERO     WN0053  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WOH8CD           MPR Identificat
     C                     KFLD           WOETDT           MPR Reporting D
     C                     KFLD           WOC2A1           MPR Reporting T
     C                     KFLD           WOIBCD           MPR Lot Identif
      * Setup key
     C                     MOVELP5H8CD    WOH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WOETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WOC2A1           MPR Reporting T
     C                     MOVELWN0042    WOIBCD           MPR Lot Identif
      * Establish starting position
     C           KRSSQ     CHAIN@E7CPGM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0975' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prior Day Purch   CR - MPR Prior Day Purchased  * 
     C                     EXSR SRCRRC
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prior Day Purch   CH - MPR Prior Day Purchased  * 
     C                     EXSR SSCHRC
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt Prior Day Purch   CR - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E7CPGL
     C                     MOVELP5H8CD    WRH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WRETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WRC2A1           MPR Reporting T
     C                     MOVELWN0042    WRIBCD           MPR Lot Identif
     C                     Z-ADDWN0036    WRDWA1           MPR Pur Ownersh
     C                     Z-ADDWN0037    WRDXA1           MPR Pur Class C
     C                     Z-ADDWN0038    WRDYA1           MPR Pur Purchas
     C                     Z-ADDWN0043    WRDZA1           MPR Pur Head
     C                     Z-ADDWN0044    WRD0A1           MPR Pur Avg Liv
     C                     Z-ADDWN0041    WRUZPR           MPR Pur Base Pr
     C                     MOVELWN0045    WRAAVN           RS User Changed
     C                     Z-ADDWN0046    WRAADT           RS Date Changed
     C                     Z-ADDWN0047    WRAMTM           RS Time Changed
     C                     MOVELWN0048    WRAJST           RS Record Statu
     C                     MOVELWN0049    WRAHVN           RS Job
     C                     MOVELWN0050    WRAGVN           RS Program
     C                     MOVELWN0051    WRABVN           RS User Added
     C                     Z-ADDWN0052    WRABDT           RS Date Added
     C                     Z-ADDWN0053    WRABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WRAJST           RS Record Statu
     C                     MOVEL##USR     WRABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WRABDT    PARM *ZERO     WQ0075  70       *DATE
     C           WRABTM    PARM *ZERO     WQ0076  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WRAGVN           RS Program
     C                     MOVEL##JOB     WRAHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           WRH8CD           MPR Identificat
     C                     KFLD           WRETDT           MPR Reporting D
     C                     KFLD           WRC2A1           MPR Reporting T
     C                     KFLD           WRIBCD           MPR Lot Identif
      * Check for duplicate primary key
     C           KLCRSR    SETLL@E7CPGL                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0976' W0RTN   7
      * Send message 'MPR Prior Day Purchase EX'
     C                     MOVEL'PRK0976' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@E7CPGL                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Chg Prior Day Purch   CH - MPR Prior Day Purchased  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0054 10        RS User Changed
     C                     Z-ADD*ZERO     WN0055  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0056  60       RS Time Changed
     C                     MOVEL*BLANK    WN0057  1        RS Record Statu
     C                     MOVEL*BLANK    WN0058 10        RS Job
     C                     MOVEL*BLANK    WN0059 10        RS Program
     C                     MOVEL*BLANK    WN0060 10        RS User Added
     C                     Z-ADD*ZERO     WN0061  70       RS Date Added
     C                     Z-ADD*ZERO     WN0062  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @E7CPGL
     C                     MOVELWOH8CD    WRH8CD    P      MPR Identificat
     C                     Z-ADDWOETDT    WRETDT           MPR Reporting D
     C                     Z-ADDWOC2A1    WRC2A1           MPR Reporting T
     C                     MOVELWOIBCD    WRIBCD    P      MPR Lot Identif
      *
     C           KLCHSS    KLIST
     C                     KFLD           WRH8CD           MPR Identificat
     C                     KFLD           WRETDT           MPR Reporting D
     C                     KFLD           WRC2A1           MPR Reporting T
     C                     KFLD           WRIBCD           MPR Lot Identif
     C           KLCHSS    CHAIN@E7CPGL              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE7CPL0'MDACP
     C                     MOVEL'@E7CPGL' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE71    YBRDCS
      * Move non-key fields to @E7CPGL
     C                     Z-ADDWN0036    WRDWA1           MPR Pur Ownersh
     C                     Z-ADDWN0037    WRDXA1           MPR Pur Class C
     C                     Z-ADDWN0038    WRDYA1           MPR Pur Purchas
     C                     Z-ADDWN0043    WRDZA1           MPR Pur Head
     C                     Z-ADDWN0044    WRD0A1           MPR Pur Avg Liv
     C                     Z-ADDWN0041    WRUZPR           MPR Pur Base Pr
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE71    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WRAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WRAADT    PARM *ZERO     WQ0077  70       *DATE
     C           WRAMTM    PARM *ZERO     WQ0078  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WRAHVN           RS Job
     C                     MOVEL##PGM     WRAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE71    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@E7CPGL                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg MPR PriorDayPurch CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0063  70       BOL Kill Date
     C                     Z-ADD*ZERO     WN0064  40       BOL Pln Delv St
     C                     Z-ADD*ZERO     WN0065  40       BOL Pln Delv En
     C                     Z-ADD*ZERO     WN0066  50       BOL Pln Head De
     C                     Z-ADD*ZERO     WN0067  71       BOL Shipped Wgt
     C                     Z-ADD*ZERO     WN0068  70       BOL Pln Delv Da
     C                     MOVEL*BLANK    WN0069  2        BOL Freight UOM
     C                     Z-ADD*ZERO     WN0070  72       BOL Freight Uni
     C                     Z-ADD*ZERO     WN0071  72       BOL Freight Amt
     C                     MOVEL*BLANK    WN0072  1        BOL Freight All
     C                     Z-ADD*ZERO     WN0073  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0074  71       BOL Live Wgt Re
     C                     MOVEL*BLANK    WN0075  2        BOL Trucker Pay
     C                     Z-ADD*ZERO     WN0076  80       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0077  70       BOL Trucker Che
     C                     Z-ADD*ZERO     WN0078  80       BOL AP Voucher
     C                     MOVEL*BLANK    WN0079 11        BOL Trailer
     C                     MOVEL*BLANK    WN0080  1        BOL Freight Exp
     C                     MOVEL*BLANK    WN0081  1        BOL Scheduled K
     C                     MOVEL*BLANK    WN0082  1        BOL Truck Scale
     C                     Z-ADD*ZERO     WN0083  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0084  1        Reported to USD
     C                     MOVEL*BLANK    WN0085  1        BOL Status 4
     C                     MOVEL*BLANK    WN0086  2        BOL Status 5
     C                     MOVEL*BLANK    WN0087  2        BOL Status 6
     C                     MOVEL*BLANK    WN0088  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0089  70       BOL HPS Movemen
     C                     Z-ADD*ZERO     WN0090  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0091  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0092  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0093  70       BOL Unused Nbr
     C                     Z-ADD*ZERO     WN0094 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0095 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0096 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0097 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0098 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0099  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0100  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0101  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0102  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0103  70       BOL Unused Date
     C                     MOVEL*BLANK    WN0104  3        TRK Trucker Cod
     C                     MOVEL*BLANK    WN0105  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0106  6        PL Location Cod
     C                     MOVEL*BLANK    WN0107 10        RS User Changed
     C                     Z-ADD*ZERO     WN0108  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0109  60       RS Time Changed
     C                     MOVEL*BLANK    WN0110  1        RS Record Statu
     C                     MOVEL*BLANK    WN0111 10        RS Job
     C                     MOVEL*BLANK    WN0112 10        RS Program
     C                     MOVEL*BLANK    WN0113 10        RS User Added
     C                     Z-ADD*ZERO     WN0114  70       RS Date Added
     C                     Z-ADD*ZERO     WN0115  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADDWLHMNB    WSHMNB           BOH Company Num
     C                     Z-ADDWLBNNB    WSBNNB           BOH Buy Order N
     C                     Z-ADDWLBONB    WSBONB           BOL Load Number
      *
     C           KLCHST    KLIST
     C                     KFLD           WSHMNB           BOH Company Num
     C                     KFLD           WSBNNB           BOH Buy Order N
     C                     KFLD           WSBONB           BOL Load Number
     C           KLCHST    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKAX1    YCRDCS
      * Move non-key fields to @AXCPBY
     C                     MOVEL'Y'       WSPCST    P      BOL MPR Prior D
      *
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WSAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WSAADT    PARM *ZERO     WQ0079  70       *DATE
     C           WSAMTM    PARM *ZERO     WQ0080  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WSAHVN           RS Job
     C                     MOVEL##PGM     WSAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKAX1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Record f/RptDay   RT - MPR Prior Day Purchased  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOH8CD    WQSU01           MPR Identificat
     C           *LIKE     DEFN WOETDT    WQSU02           MPR Reporting D
     C           *LIKE     DEFN WOC2A1    WQSU03           MPR Reporting T
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           MPR Identificat
     C                     KFLD           WQSU02           MPR Reporting D
     C                     KFLD           WQSU03           MPR Reporting T
      * Setup key
     C                     MOVELP5H8CD    WQSU01           MPR Identificat
     C                     Z-ADDP6ETDT    WQSU02           MPR Reporting D
     C                     Z-ADDP6C2A1    WQSU03           MPR Reporting T
      * Establish starting position
     C           KRSSU     SETLL@E7CPGM                    *
     C           KRSSU     READE@E7CPGM                  90*
      * Data record not found
     C   90                MOVEL'PRK0975' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUIHST           Record Added Us
     C                     GOTO SUEXIT                     *QUIT
     C           KRSSU     READE@E7CPGM                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * MPR Bld Prior Day Sch RT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0073           Planned Kill US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTHMNB    WQSV01           BOH Company Num
     C           *LIKE     DEFN WTAUDT    WQSV02           BOL Pln Delv Da
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           BOH Company Num
     C                     KFLD           WQSV02           BOL Pln Delv Da
      * Setup key
     C                     Z-ADDP1GGNB    WQSV01           BOH Company Num
     C                     Z-ADDP4CGDT    WQSV02           BOL Pln Delv Da
      * Establish starting position
     C           KRSSV     SETLL@AXCPNQ                    *
     C           KRSSV     READE@AXCPNQ                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WTBPNB    YL0073           Planned Kill US
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
     C                     EXSR SWRVGN
     C           KRSSV     READE@AXCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WVH8CD           MPR Identificat
     C                     KFLD           WVETDT           MPR Reporting D
     C                     KFLD           WVC2A1           MPR Reporting T
     C                     KFLD           WVCQDT           BOL Kill Date
     C                     KFLD           WVBNNB           BOH Buy Order N
     C                     KFLD           WVBONB           BOL Load Number
     C                     KFLD           WVABCD           PD Producer Cod
     C                     KFLD           WVAECD           PL Location Cod
      * Setup key
     C                     MOVELP5H8CD    WVH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WVETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WVC2A1           MPR Reporting T
     C                     Z-ADDWTAUDT    WVCQDT           BOL Kill Date
     C                     Z-ADDWTBNNB    WVBNNB           BOH Buy Order N
     C                     Z-ADDWTBONB    WVBONB           BOL Load Number
     C                     MOVELWTABCD    WVABCD           PD Producer Cod
     C                     MOVELWTAECD    WVAECD           PL Location Cod
      * Establish starting position
     C           KRSSW     CHAIN@FHCPHN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1008' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
     C                     EXSR SXCRRC
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
     C                     EXSR SYCHRC
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FHCPHM
     C                     MOVELP5H8CD    WWH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WWETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WWC2A1           MPR Reporting T
     C                     Z-ADDWTAUDT    WWCQDT           BOL Kill Date
     C                     Z-ADDWTBNNB    WWBNNB           BOH Buy Order N
     C                     Z-ADDWTBONB    WWBONB           BOL Load Number
     C                     MOVELWTABCD    WWABCD           PD Producer Cod
     C                     MOVELWTAECD    WWAECD           PL Location Cod
     C                     Z-ADDWTBPNB    WWBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    WWAAVN           RS User Changed
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     MOVEL'A'       WWAJST           RS Record Statu
     C                     MOVEL*BLANK    WWAHVN           RS Job
     C                     MOVEL*BLANK    WWAGVN           RS Program
     C                     MOVEL*BLANK    WWABVN           RS User Added
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WWAJST           RS Record Statu
     C                     MOVEL##USR     WWABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WWABDT    PARM *ZERO     WQ0084  70       *DATE
     C           WWABTM    PARM *ZERO     WQ0085  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WWAGVN           RS Program
     C                     MOVEL##JOB     WWAHVN           RS Job
     C           KLCRSX    KLIST
     C                     KFLD           WWH8CD           MPR Identificat
     C                     KFLD           WWETDT           MPR Reporting D
     C                     KFLD           WWC2A1           MPR Reporting T
     C                     KFLD           WWCQDT           BOL Kill Date
     C                     KFLD           WWBNNB           BOH Buy Order N
     C                     KFLD           WWBONB           BOL Load Number
     C                     KFLD           WWABCD           PD Producer Cod
     C                     KFLD           WWAECD           PL Location Cod
      * Check for duplicate primary key
     C           KLCRSX    SETLL@FHCPHM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1009' W0RTN   7
      * Send message 'MPR Prior Day Sched Dt EX'
     C                     MOVEL'PRK1009' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@FHCPHM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @FHCPHM
     C                     MOVELWVH8CD    WWH8CD    P      MPR Identificat
     C                     Z-ADDWVETDT    WWETDT           MPR Reporting D
     C                     Z-ADDWVC2A1    WWC2A1           MPR Reporting T
     C                     Z-ADDWVCQDT    WWCQDT           BOL Kill Date
     C                     Z-ADDWVBNNB    WWBNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    WWBONB           BOL Load Number
     C                     MOVELWVABCD    WWABCD    P      PD Producer Cod
     C                     MOVELWVAECD    WWAECD    P      PL Location Cod
      *
     C           KLCHSY    KLIST
     C                     KFLD           WWH8CD           MPR Identificat
     C                     KFLD           WWETDT           MPR Reporting D
     C                     KFLD           WWC2A1           MPR Reporting T
     C                     KFLD           WWCQDT           BOL Kill Date
     C                     KFLD           WWBNNB           BOH Buy Order N
     C                     KFLD           WWBONB           BOL Load Number
     C                     KFLD           WWABCD           PD Producer Cod
     C                     KFLD           WWAECD           PL Location Cod
     C           KLCHSY    CHAIN@FHCPHM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFHCPL0'MDACP
     C                     MOVEL'@FHCPHM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFH1    YDRDCS
      * Move non-key fields to @FHCPHM
     C                     Z-ADDWTBPNB    WWBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    WWAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     MOVEL'A'       WWAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WWAHVN    P      RS Job
     C                     MOVEL*BLANK    WWAGVN    P      RS Program
     C                     MOVEL*BLANK    WWABVN    P      RS User Added
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WWAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WWAADT    PARM *ZERO     WQ0086  70       *DATE
     C           WWAMTM    PARM *ZERO     WQ0087  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WWAHVN           RS Job
     C                     MOVEL##PGM     WWAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@FHCPHM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFHCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Upd Prior Day Sched   RT - MPR Prior Day Scheduled  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WXH8CD           MPR Identificat
     C                     KFLD           WXETDT           MPR Reporting D
     C                     KFLD           WXC2A1           MPR Reporting T
      * Setup key
     C                     MOVELP5H8CD    WXH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WXETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WXC2A1           MPR Reporting T
      * Establish starting position
     C           KRSSZ     CHAIN@E5CPGP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0971' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Prior Day Sched   CR - MPR Prior Day Scheduled  * 
     C                     EXSR TACRRC
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Prior Day Sched   CH - MPR Prior Day Scheduled  * 
     C                     EXSR TBCHRC
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TACRRC    BEGSR
      *================================================================
      * Crt Prior Day Sched   CR - MPR Prior Day Scheduled  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E5CPGO
     C                     MOVELP5H8CD    WYH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WYETDT           MPR Reporting D
     C                     Z-ADDP6C2A1    WYC2A1           MPR Reporting T
     C                     Z-ADDP6C4A1    WYC4A1           MPR Sch Head Da
     C                     Z-ADDP6C5A1    WYC5A1           MPR Sch Head Da
     C                     Z-ADDP6C6A1    WYC6A1           MPR Sch Head Da
     C                     Z-ADDP6C7A1    WYC7A1           MPR Sch Head Da
     C                     Z-ADDP6C8A1    WYC8A1           MPR Sch Head Da
     C                     Z-ADDP6C9A1    WYC9A1           MPR Sch Head Da
     C                     Z-ADDP6DAA1    WYDAA1           MPR Sch Head Da
     C                     Z-ADDP6DBA1    WYDBA1           MPR Sch Head Da
     C                     Z-ADDP6DCA1    WYDCA1           MPR Sch Head Da
     C                     Z-ADDP6DDA1    WYDDA1           MPR Sch Head Da
     C                     Z-ADDP6DEA1    WYDEA1           MPR Sch Head Da
     C                     Z-ADDP6DFA1    WYDFA1           MPR Sch Head Da
     C                     Z-ADDP6DGA1    WYDGA1           MPR Sch Head Da
     C                     Z-ADDP6DHA1    WYDHA1           MPR Sch Head Da
     C                     MOVEL*BLANK    WYAAVN           RS User Changed
     C                     Z-ADD*ZERO     WYAADT           RS Date Changed
     C                     Z-ADD*ZERO     WYAMTM           RS Time Changed
     C                     MOVEL'A'       WYAJST           RS Record Statu
     C                     MOVEL*BLANK    WYAHVN           RS Job
     C                     MOVEL*BLANK    WYAGVN           RS Program
     C                     MOVEL*BLANK    WYABVN           RS User Added
     C                     Z-ADD*ZERO     WYABDT           RS Date Added
     C                     Z-ADD*ZERO     WYABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WYAJST           RS Record Statu
     C                     MOVEL##USR     WYABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WYABDT    PARM *ZERO     WQ0088  70       *DATE
     C           WYABTM    PARM *ZERO     WQ0089  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WYAGVN           RS Program
     C                     MOVEL##JOB     WYAHVN           RS Job
     C           KLCRTA    KLIST
     C                     KFLD           WYH8CD           MPR Identificat
     C                     KFLD           WYETDT           MPR Reporting D
     C                     KFLD           WYC2A1           MPR Reporting T
      * Check for duplicate primary key
     C           KLCRTA    SETLL@E5CPGO                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0972' W0RTN   7
      * Send message 'MPR Prior Day Schedule EX'
     C                     MOVEL'PRK0972' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C                     WRITE@E5CPGO                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCHRC    BEGSR
      *================================================================
      * Chg Prior Day Sched   CH - MPR Prior Day Scheduled  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0116 10        RS User Changed
     C                     Z-ADD*ZERO     WN0117  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0118  60       RS Time Changed
     C                     MOVEL*BLANK    WN0119  1        RS Record Statu
     C                     MOVEL*BLANK    WN0120 10        RS Job
     C                     MOVEL*BLANK    WN0121 10        RS Program
     C                     MOVEL*BLANK    WN0122 10        RS User Added
     C                     Z-ADD*ZERO     WN0123  70       RS Date Added
     C                     Z-ADD*ZERO     WN0124  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @E5CPGO
     C                     MOVELWXH8CD    WYH8CD    P      MPR Identificat
     C                     Z-ADDWXETDT    WYETDT           MPR Reporting D
     C                     Z-ADDWXC2A1    WYC2A1           MPR Reporting T
      *
     C           KLCHTB    KLIST
     C                     KFLD           WYH8CD           MPR Identificat
     C                     KFLD           WYETDT           MPR Reporting D
     C                     KFLD           WYC2A1           MPR Reporting T
     C           KLCHTB    CHAIN@E5CPGO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKE5CPL0'MDACP
     C                     MOVEL'@E5CPGO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKE51    YERDCS
      * Move non-key fields to @E5CPGO
     C                     Z-ADDP6C4A1    WYC4A1           MPR Sch Head Da
     C                     Z-ADDP6C5A1    WYC5A1           MPR Sch Head Da
     C                     Z-ADDP6C6A1    WYC6A1           MPR Sch Head Da
     C                     Z-ADDP6C7A1    WYC7A1           MPR Sch Head Da
     C                     Z-ADDP6C8A1    WYC8A1           MPR Sch Head Da
     C                     Z-ADDP6C9A1    WYC9A1           MPR Sch Head Da
     C                     Z-ADDP6DAA1    WYDAA1           MPR Sch Head Da
     C                     Z-ADDP6DBA1    WYDBA1           MPR Sch Head Da
     C                     Z-ADDP6DCA1    WYDCA1           MPR Sch Head Da
     C                     Z-ADDP6DDA1    WYDDA1           MPR Sch Head Da
     C                     Z-ADDP6DEA1    WYDEA1           MPR Sch Head Da
     C                     Z-ADDP6DFA1    WYDFA1           MPR Sch Head Da
     C                     Z-ADDP6DGA1    WYDGA1           MPR Sch Head Da
     C                     Z-ADDP6DHA1    WYDHA1           MPR Sch Head Da
      *
      * Set PGM.*Record Data Changed flag
     C           QPKE51    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WYAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WYAADT    PARM *ZERO     WQ0090  70       *DATE
     C           WYAMTM    PARM *ZERO     WQ0091  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WYAHVN           RS Job
     C                     MOVEL##PGM     WYAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKE51    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@E5CPGO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKE5CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * MPR Bld Estimtd f/Sch RT - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0125  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0126  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0127  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0128  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0129  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0130  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0131  60       MPR Est Purch T
     C                     Z-ADD*ZERO     WN0132  60       MPR Est Purch T
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN TAHMNB    WQTC01           BOH Company Num
     C           *LIKE     DEFN TACQDT    WQTC02           BOL Kill Date
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WQTC01           BOH Company Num
     C                     KFLD           WQTC02           BOL Kill Date
      * Setup key
     C                     Z-ADDP1GGNB    WQTC01           BOH Company Num
     C                     Z-ADDP6ETDT    WQTC02           BOL Kill Date
      * Establish starting position
     C           KRSTC     SETLL@AXCPB8                    *
     C           KRSTC     READE@AXCPB8                  90*
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
     C                     EXSR TDRVGN
     C                     Z-ADDYL0074    WUEIA1           MPR Purchase Ty
      * CASE: WRK.MPR Purchase Type is Negotiated
     C           WUEIA1    IFEQ 1                          *IF
     C                     ADD  TABPNB    WN0125           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Mkt Formula
     C           WUEIA1    IFEQ 2                          *IF
     C                     ADD  TABPNB    WN0126           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Pork Mkt Formula
     C           WUEIA1    IFEQ 3                          *IF
     C                     ADD  TABPNB    WN0127           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is Oth Purchase Arng
     C           WUEIA1    IFEQ 4                          *IF
     C                     ADD  TABPNB    WN0128           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Negotiated
     C           WUEIA1    IFEQ 5                          *IF
     C                     ADD  TABPNB    WN0129           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Mkt Formula
     C           WUEIA1    IFEQ 6                          *IF
     C                     ADD  TABPNB    WN0130           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Pork Mkt Formula
     C           WUEIA1    IFEQ 7                          *IF
     C                     ADD  TABPNB    WN0131           MPR Est Purch T
     C                     ELSE
      * CASE: WRK.MPR Purchase Type is PckSld Oth Purchase Arng
     C           WUEIA1    IFEQ 8                          *IF
     C                     ADD  TABPNB    WN0132           MPR Est Purch T
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
     C                     EXSR TERVGN
     C           KRSTC     READE@AXCPB8                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.MPR Est Purch Type 1 Hd is ne Zero
     C           WN0125    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR THRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 2 Hd is ne Zero
     C           WN0126    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 3 Hd is ne Zero
     C           WN0127    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TLRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 4 Hd is ne Zero
     C           WN0128    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TNRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 5 Hd is ne Zero
     C           WN0129    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TPRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 6 Hd is ne Zero
     C           WN0130    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TRRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 7 Hd is ne Zero
     C           WN0131    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TTRVGN
     C                     END                             *FI
      * CASE: PAR.MPR Est Purch Type 8 Hd is ne Zero
     C           WN0132    IFNE 0                          *IF
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
     C                     EXSR TVRVGN
     C                     END                             *FI
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * RTV MPR Prdcr Purch TpRT - MPR Producer Purch Type  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCABCD    WQTD01           PD Producer Cod
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           PD Producer Cod
      * Setup key
     C                     MOVELTAABCD    WQTD01           PD Producer Cod
      * Establish starting position
     C           KRSTD     SETLL@E3CPF4                    *
     C           KRSTD     READE@E3CPF4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0967' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0074           MPR Purchase Ty
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCC0A1    YL0074           MPR Purchase Ty
     C                     GOTO TDEXIT                     *QUIT
     C           KRSTD     READE@E3CPF4                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Crt/Chg Prior Dtl RT - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WVH8CD           MPR Identificat
     C                     KFLD           WVETDT           MPR Reporting D
     C                     KFLD           WVC2A1           MPR Reporting T
     C                     KFLD           WVCQDT           BOL Kill Date
     C                     KFLD           WVBNNB           BOH Buy Order N
     C                     KFLD           WVBONB           BOL Load Number
     C                     KFLD           WVABCD           PD Producer Cod
     C                     KFLD           WVAECD           PL Location Cod
      * Setup key
     C                     MOVELP5H8CD    WVH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WVETDT           MPR Reporting D
     C                     Z-ADD1         WVC2A1           MPR Reporting T
     C                     Z-ADDTACQDT    WVCQDT           BOL Kill Date
     C                     Z-ADDTABNNB    WVBNNB           BOH Buy Order N
     C                     Z-ADDTABONB    WVBONB           BOL Load Number
     C                     MOVELTAABCD    WVABCD           PD Producer Cod
     C                     MOVELTAAECD    WVAECD           PL Location Cod
      * Establish starting position
     C           KRSTE     CHAIN@FHCPHN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1008' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
     C                     EXSR TFCRRC
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
     C                     EXSR TGCHRC
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Crt MPR Prior Day Sch CR - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FHCPHM
     C                     MOVELP5H8CD    WWH8CD           MPR Identificat
     C                     Z-ADDP6ETDT    WWETDT           MPR Reporting D
     C                     Z-ADD1         WWC2A1           MPR Reporting T
     C                     Z-ADDTACQDT    WWCQDT           BOL Kill Date
     C                     Z-ADDTABNNB    WWBNNB           BOH Buy Order N
     C                     Z-ADDTABONB    WWBONB           BOL Load Number
     C                     MOVELTAABCD    WWABCD           PD Producer Cod
     C                     MOVELTAAECD    WWAECD           PL Location Cod
     C                     Z-ADDTABPNB    WWBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    WWAAVN           RS User Changed
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     MOVEL'A'       WWAJST           RS Record Statu
     C                     MOVEL*BLANK    WWAHVN           RS Job
     C                     MOVEL*BLANK    WWAGVN           RS Program
     C                     MOVEL*BLANK    WWABVN           RS User Added
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WWAJST           RS Record Statu
     C                     MOVEL##USR     WWABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WWABDT    PARM *ZERO     WQ0092  70       *DATE
     C           WWABTM    PARM *ZERO     WQ0093  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WWAGVN           RS Program
     C                     MOVEL##JOB     WWAHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           WWH8CD           MPR Identificat
     C                     KFLD           WWETDT           MPR Reporting D
     C                     KFLD           WWC2A1           MPR Reporting T
     C                     KFLD           WWCQDT           BOL Kill Date
     C                     KFLD           WWBNNB           BOH Buy Order N
     C                     KFLD           WWBONB           BOL Load Number
     C                     KFLD           WWABCD           PD Producer Cod
     C                     KFLD           WWAECD           PL Location Cod
      * Check for duplicate primary key
     C           KLCRTF    SETLL@FHCPHM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1009' W0RTN   7
      * Send message 'MPR Prior Day Sched Dt EX'
     C                     MOVEL'PRK1009' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@FHCPHM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCHRC    BEGSR
      *================================================================
      * Change MPR Prior Day Sche - MPR Prior Day Sched Dtl  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @FHCPHM
     C                     MOVELWVH8CD    WWH8CD    P      MPR Identificat
     C                     Z-ADDWVETDT    WWETDT           MPR Reporting D
     C                     Z-ADDWVC2A1    WWC2A1           MPR Reporting T
     C                     Z-ADDWVCQDT    WWCQDT           BOL Kill Date
     C                     Z-ADDWVBNNB    WWBNNB           BOH Buy Order N
     C                     Z-ADDWVBONB    WWBONB           BOL Load Number
     C                     MOVELWVABCD    WWABCD    P      PD Producer Cod
     C                     MOVELWVAECD    WWAECD    P      PL Location Cod
      *
     C           KLCHTG    KLIST
     C                     KFLD           WWH8CD           MPR Identificat
     C                     KFLD           WWETDT           MPR Reporting D
     C                     KFLD           WWC2A1           MPR Reporting T
     C                     KFLD           WWCQDT           BOL Kill Date
     C                     KFLD           WWBNNB           BOH Buy Order N
     C                     KFLD           WWBONB           BOL Load Number
     C                     KFLD           WWABCD           PD Producer Cod
     C                     KFLD           WWAECD           PL Location Cod
     C           KLCHTG    CHAIN@FHCPHM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKFHCPL0'MDACP
     C                     MOVEL'@FHCPHM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKFH1    YFRDCS
      * Move non-key fields to @FHCPHM
     C                     Z-ADDTABPNB    WWBPNB           BOL Pln Head De
     C                     MOVEL*BLANK    WWAAVN    P      RS User Changed
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     MOVEL'A'       WWAJST    P      RS Record Statu
     C                     MOVEL*BLANK    WWAHVN    P      RS Job
     C                     MOVEL*BLANK    WWAGVN    P      RS Program
     C                     MOVEL*BLANK    WWABVN    P      RS User Added
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WWAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WWAADT    PARM *ZERO     WQ0094  70       *DATE
     C           WWAMTM    PARM *ZERO     WQ0095  60       *TIME
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WWAHVN           RS Job
     C                     MOVEL##PGM     WWAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKFH1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@FHCPHM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKFHCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD1         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTH     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TICRRC
     C                     GOTO THEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TICRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD1         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0125    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTI    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTI    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD2         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTJ     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TKCRRC
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD2         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0126    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTK    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTK    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD3         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTL     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TMCRRC
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD3         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0127    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTM    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTM    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTN     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD4         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTN     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TOCRRC
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD4         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0128    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTO    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTO    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD5         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTP     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TQCRRC
     C                     GOTO TPEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD5         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0129    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTQ    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD6         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTR     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TSCRRC
     C                     GOTO TREXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD6         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0130    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTS    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTS    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD7         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTT     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TUCRRC
     C                     GOTO TTEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD7         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0131    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTU    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTU    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv Upd Estmtd Purch  RT - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           TBHONB           CC Company Numb
     C                     KFLD           TBETDT           MPR Reporting D
     C                     KFLD           TBC0A1           MPR Purchase Ty
      * Setup key
     C                     Z-ADDTAHMNB    TBHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TBETDT           MPR Reporting D
     C                     Z-ADD8         TBC0A1           MPR Purchase Ty
      * Establish starting position
     C           KRSTV     CHAIN@E4CPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0969' W0RTN   7
      * USER: Processing if Data record not found
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
     C                     EXSR TWCRRC
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWCRRC    BEGSR
      *================================================================
      * Crt MPR Estmtd Purch  CR - MPR Estimated Purchases  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @E4CPF6
     C                     Z-ADDTAHMNB    TCHONB           CC Company Numb
     C                     Z-ADDP6ETDT    TCETDT           MPR Reporting D
     C                     Z-ADD8         TCC0A1           MPR Purchase Ty
     C                     Z-ADDWN0132    TCC1A1           MPR Estimated H
     C                     MOVEL*BLANK    TCAAVN           RS User Changed
     C                     Z-ADD*ZERO     TCAADT           RS Date Changed
     C                     Z-ADD*ZERO     TCAMTM           RS Time Changed
     C                     MOVELWUAJST    TCAJST           RS Record Statu
     C                     MOVEL*BLANK    TCAHVN           RS Job
     C                     MOVEL*BLANK    TCAGVN           RS Program
     C                     MOVEL*BLANK    TCABVN           RS User Added
     C                     Z-ADD*ZERO     TCABDT           RS Date Added
     C                     Z-ADD*ZERO     TCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       TCAJST           RS Record Statu
     C                     MOVEL##USR     TCABVN           RS User Added
     C                     Z-ADD##JDT     TCABDT           RS Date Added
     C                     Z-ADD##JTM     TCABTM           RS Time Added
     C                     MOVEL##PGM     TCAGVN           RS Program
     C                     MOVEL##JOB     TCAHVN           RS Job
     C           KLCRTW    KLIST
     C                     KFLD           TCHONB           CC Company Numb
     C                     KFLD           TCETDT           MPR Reporting D
     C                     KFLD           TCC0A1           MPR Purchase Ty
      * Check for duplicate primary key
     C           KLCRTW    SETLL@E4CPF6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0970' W0RTN   7
      * Send message 'MPR Estimated Purchase EX'
     C                     MOVEL'PRK0970' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C                     WRITE@E4CPF6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  Slaughter Swine  LS118B
      *================================================================
      * Process the Tattoo Header for each Kill Date between the
      * Last Kill Date Reported and the Current Payment Date.
      * 1)  Both Internal and External Producers are processed.
      * 2)  Do not process Resale Tattoo's.
      * 3)  Only process Hold Over Tattoo's when they are completed.
      *     When processing the Tattoo with Held Over Status = Y,
      *     combine both Kill Date for creating one record.
      * 4)  On Monday, create the data for both Friday and Saturday, if
      *     killed on Saturday.
      * 3/29/01 Prior Day Slg -- If Live Wgt is 0, then output NULL
      *         If Purch Type is 9, output NULL slg base price, slg avg n
      *          slg low net price, slg high net price, slg avg sort loss
      *   (these correlate to item nbrs 15,16,17,18,21)
      * Lot Identification:   Tattoo Number. As of 02/26/04 = TattooLoad
      * Class Code        :   The Class Code will = 1 (Barrows/Gilts)
      * Purchase Type Code:   The Purchase Type Code is identified for
      *                       the producer in the Producer file.
      * Head Count        :   TH Head Killed
      * Base Price        :   TH CM Bse Mkt Carc /CWT.  If the Source
      *                       is Internal, this value will be 0.
      * Average Net Price :   TH Payment Gross plus Additional Expense
      *                       incured by Seaboard.  Divide the total by
      *                       Hot Weight divided by 100.
      * Lowest Net Price  :   This value will be 0.
      * Highest Net Price :   This value will be 0.
      * Avg Live Weight   :   TH Avg Live Wgt.  If the Payment Type
      *                       is Carcass Merit, this value will be 0.
      * Avg Carcass Weight:   TH Avg Hot Wgt.  If the Payment Type
      *                       is Live, this value will be 0.
      * Average Sort Loss :   This value will be 0.
      * Avg Backfat-Inches:   TH Avg Backfat
      * Avg LoinEye-Inches:   TH Avg Loin Eye Depth
      * Avg Lean Percent  :   TH Avg Lean Percent
      * 5/27/03  Avg Sort Loss calc depends on the CMP Grading Type
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  Purchased Swine    LS118C
      *================================================================
      * Process the Buy Order Header with Buy Order Date equal to the
      * Kill Date being reported/processed.
      * 1)  Only process Buy Orders for External Producers.
      * 2)  For each Buy Order selected, the Buy Order Load is processed
      *     for creating a record in the MPR Prior Day Purchased file.
      * 3)  If the Base Price for the Load = Zero, then do not create a
      *     record in the MPR Prior Day Purchased file.
      * Lot Identification:   Concatenate Buy Order Num & Load Num
      * Ownership Code    :   The Ownership Code is based on the Purchase
      *                       Type Code identified for the Producer.
      *                       If Purchase Type Code = 1, 2, 3, 4
      *                            Ownership Code = 3
      *                       If Purchase Type Code = 5, 6, 7, 8
      *                            Ownership Code = 2
      *                       If Purchase Type Code = 9
      *                            Ownership Code = 1
      * Class Code        :   The Class Code will = 1 (Barrows/Gilts)
      * Purchase Type Code:   The Purchase Type Code is identified for
      *                       the producer in the Producer file.
      * Head Count        :   The Head Count is the Planned Delivery Head
      *                       for the Buy Order Load.
      * Avg Live Weight   :   The Average Live Weight will be Zero for
      *                       all loads processed.  We have not received
      *                       these loads yet.  Also, the Average Live
      *                       Weight only needs reporting, if the Payment
      *                       Type is Live.  If the Payment Type is
      *                       Carcass Merit, then the Average Live Weight
      *                       will be zero.
      * Base Price ($/CWT):   The Base Price will be Zero for all loads
      *                       processed.  We do not know the Base Price
      *                       until the Market Prices have been entered
      *                       into the system.
      * *------------------------------------------------------------*
      * 01/18/01 PKD
      * - Currently, for all of our purchases for the future, we do not
      *   know the Base Price.
      * - One record in the MPR Prior Day Purchased file will be created
      *   with zeros and blanks for sending to the USDA.
      * 03/29/01 RMC
      * - Do not send a blank record.
      * 04/17/01 RMC
      *   Report Purchases when we have the price, which is actually afte
      *   slaughtered.  Read the BO Hdr by Kill Date, and get the Base pr
      *   which includes the (Cutout * 88.7%) +- overage/underage.
      *  For example, hog slaughtered 4/17/01, are reported on 4/18
      *   as Prior Day Purchased.
      * 08/22/01 PKD T568
      *   Changed the Rtv for procesing the Buy Order Header to Position
      *   on the Kill Date instead of restrict.  This will process all
      *   Buy Order that have been created for future Kill Dates.  If
      *   a Buy Order Quote was entered, then the purchase would be
      *   reported the day after the Buy Order is created.  For Buy Order
      *   with Market Date Method of Day Prior Delivery, the purchase
      *   will be reported the day the hogs are killed instead of after
      *   hogs have been killed.
      * - Once the purchase has been reported, the BOL MPR Prior Day Purc
      *   field is changed to Y, so it does not get reported again.
      * *------------------------------------------------------------*
      * 10/09/01 RMC  If Rerun, the LS118 records have already been creat
      *  and the BOL have been flagged as prior-day-purch-reported = Y, s
      *   if no records were created on this run, check for records alrea
      *   existing in the file for this date, and change the Record Added
      *   to = Y so the records will be sent to the USDA in the CL.
      * *------------------------------------------------------------*
      * 9/20/02  Prior Day Purch from the BOL -- use BOL Head Received
      *   if > 0, else use the Plan Head Delv(which is what it did alread
      * *------------------------------------------------------------*
      * 02/26/04 RMC Prior Day Purch: MPR Head = SUM(TH Hd Rcvd for QM ho
      *              instead of the BOL Head Received.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * DOC:  Scheduled Swine   LS118A
      *================================================================
      * Process the Buy Order Load by Kill Date for each Calendar
      * day after the Last Kill Date Reported for 14 days.  After
      * processing the 14th day, create a record.
      * 1)  Both Internal and External Producers are included.
      * 2)  If the Reporting Date is Monday and the Last Kill Date
      *     Reported is Friday, then Day 1 will start with Saturday.
      * 3)  If the Reporting Date is Monday and the Last Kill Date
      *     Reported is Saturday, then Day 1 will start with Sunday.
      * Head Count (1-14 days):  SUM(BOL Pln Head Delv) for the day
      *                          being processed.
      * 3/18/02  If Sat/Fri last reported kill, start with Monday.
      *  So exclude Sat/Sunday when setting up 1st kill date here.
      * 12/09/02  Bld Prior Day Sched with BOL access path keyed on Delv
      *           instead of Kill date.        (LS118A)
      * 01/28/03 PKD Only add 1 to Last Kill Date Reported if it's Sat
      *              or Sunday.  The Last Kill Date Reported has already
      *              been updated in the Slaughter processing.
      * 03/18/03 PKD If Sat/Fri last reported kill, start with Monday.
      *              So exclude Sat/Sunday when setting up 1st kill date
      * 07/01/03 PKD Day 1 should be Reporting Date according to Jancie &
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1GGNB           Company Number
     C                     Z-ADD*ZERO     P2EUDT           Last Kill Date
     C                     Z-ADD*ZERO     P3CKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     P4CGDT           Kill Date Usr
     C                     Z-ADD*ZERO     P6C4A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C5A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C6A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C7A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C8A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6C9A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DAA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DBA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DCA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DDA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DEA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DFA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DGA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     P6DHA1           MPR Sch Head Da
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHONB           CC Company Numb
     C                     Z-ADD*ZERO     WACKDT           Pmt Current Pay
     C                     Z-ADD*ZERO     WAM1NB           Pmt Current Pay
     C                     Z-ADD*ZERO     WAPINB           PP Unused Nbr 1
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Actual Value
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Unsued Nbr 1
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Unused Date
     C                     Z-ADD*ZERO     WBEDDT           TH Unused Date
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    WUDDCD  5
      * Define work field Buy Order Load Alpha
     C                     MOVEL*BLANK    WUP9TX  5
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WDASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WDAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WDALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WDD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WDD6DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WDJOEJ           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDKOFF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDKWPE           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WDHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WDGANB           CW Year
     C                     Z-ADD*ZERO     WDGBNB           CW Week Number
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WEA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WEI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WEVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WEVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WEVHPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WEVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WEVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field TH CA Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUI6PR  72
      * Define work field TH CA Sort Discount Amt
     C                     Z-ADD*ZERO     WUI7PR  72
      * Define work field TH CA Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUI8PR  72
      * Define work field TH CA Base Carcass Value
     C                     Z-ADD*ZERO     WUI9PR  72
      * Define work field TH CA Lean Premium Amt
     C                     Z-ADD*ZERO     WUJAPR  72
      * Define work field TH CA Carcass Gross Amt
     C                     Z-ADD*ZERO     WUJCPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WGBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WGBONB           BOL Load Number
     C                     Z-ADD*ZERO     WGCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WGB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WGI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WGJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WGI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WGI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WGI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WGI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WGJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WGJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WGJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WGJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WGJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WGJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WGJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WGJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WGJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WGJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WGJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WGJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WGJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WGJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WGLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WGHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WGLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WGH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WGGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WGH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WGGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WGH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WGHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WGHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WGHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WGHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WGHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WGHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WGHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WGHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field #Sequence Block
     C                     MOVEL*BLANK    WUJ0ST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     WUEDPR  52
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     WULRNB  71
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WHBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WHBONB           BOL Load Number
     C                     Z-ADD*ZERO     WHCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WHB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WHAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WHA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WHAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WHAADT           RS Date Changed
     C                     Z-ADD*ZERO     WHAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WHABDT           RS Date Added
     C                     Z-ADD*ZERO     WHABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WIC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WIDOA1           MPR Slg Class C
     C                     Z-ADD*ZERO     WIDPA1           MPR Slg Purchas
     C                     Z-ADD*ZERO     WIDQA1           MPR Slg Head
     C                     Z-ADD*ZERO     WIUUPR           MPR Slg Base Pr
     C                     Z-ADD*ZERO     WIUVPR           MPR Slg Avg Net
     C                     Z-ADD*ZERO     WIUWPR           MPR Slg Low Net
     C                     Z-ADD*ZERO     WIUXPR           MPR Slg High Ne
     C                     Z-ADD*ZERO     WIDRA1           MPR Slg Avg Liv
     C                     Z-ADD*ZERO     WIDSA1           MPR Slg Avg Car
     C                     Z-ADD*ZERO     WIUYPR           MPR Slg Avg Sor
     C                     Z-ADD*ZERO     WIDTA1           MPR Slg Avg Bac
     C                     Z-ADD*ZERO     WIDUA1           MPR Slg Avg Loi
     C                     Z-ADD*ZERO     WIDVA1           MPR Slg Avg Lea
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Record Added Usr
     C                     MOVEL*BLANK    WUIHST  1
      * Define work field MPR Purchase Type Code
     C                     Z-ADD*ZERO     WUC0A1  20
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WLBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WLBONB           BOL Load Number
     C                     Z-ADD*ZERO     WLCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WLABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WLACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WLBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WLCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WLAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WLAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WLATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WLDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WLDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WLGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WLBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WLLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WLLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WLJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WLKEOR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WLIOEW           BOL Unused Nbr
     C                     Z-ADD*ZERO     WLKJIO           BOL Unused Nbr
     C                     Z-ADD*ZERO     WLIOJR           BOL Unused Nbr
     C                     Z-ADD*ZERO     WLEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WLITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WLODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WLRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WLOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WLD0DT           BOL Unused Date
     C                     Z-ADD*ZERO     WLD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WLD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WLD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WLD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WLAADT           RS Date Changed
     C                     Z-ADD*ZERO     WLAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WLABDT           RS Date Added
     C                     Z-ADD*ZERO     WLABTM           RS Time Added
      * Define work field Buy Order Number Alpha
     C                     MOVEL*BLANK    WUP8TX  5
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WOC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WODWA1           MPR Pur Ownersh
     C                     Z-ADD*ZERO     WODXA1           MPR Pur Class C
     C                     Z-ADD*ZERO     WODYA1           MPR Pur Purchas
     C                     Z-ADD*ZERO     WODZA1           MPR Pur Head
     C                     Z-ADD*ZERO     WOD0A1           MPR Pur Avg Liv
     C                     Z-ADD*ZERO     WOUZPR           MPR Pur Base Pr
     C                     Z-ADD*ZERO     WOAADT           RS Date Changed
     C                     Z-ADD*ZERO     WOAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WOABDT           RS Date Added
     C                     Z-ADD*ZERO     WOABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WVC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WVCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WVBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WVBONB           BOL Load Number
     C                     Z-ADD*ZERO     WVBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WVAADT           RS Date Changed
     C                     Z-ADD*ZERO     WVAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WVABDT           RS Date Added
     C                     Z-ADD*ZERO     WVABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXETDT           MPR Reporting D
     C                     Z-ADD*ZERO     WXC2A1           MPR Reporting T
     C                     Z-ADD*ZERO     WXC4A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXC5A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXC6A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXC7A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXC8A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXC9A1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDAA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDBA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDCA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDDA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDEA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDFA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDGA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXDHA1           MPR Sch Head Da
     C                     Z-ADD*ZERO     WXAADT           RS Date Changed
     C                     Z-ADD*ZERO     WXAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WXABDT           RS Date Added
     C                     Z-ADD*ZERO     WXABTM           RS Time Added
      * Define work field MPR Purchase Type
     C                     Z-ADD*ZERO     WUEIA1  10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     TBHONB           CC Company Numb
     C                     Z-ADD*ZERO     TBETDT           MPR Reporting D
     C                     Z-ADD*ZERO     TBC0A1           MPR Purchase Ty
     C                     Z-ADD*ZERO     TBC1A1           MPR Estimated H
     C                     Z-ADD*ZERO     TBAADT           RS Date Changed
     C                     Z-ADD*ZERO     TBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     TBABDT           RS Date Added
     C                     Z-ADD*ZERO     TBABTM           RS Time Added
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field Oms Warehouse Code
     C                     MOVEL*BLANK    YL0001  3
      * Define local work field Oms SalesPerson Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Oms Allow Multi-Company
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Oms Default Printer
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field Oms Name
     C                     MOVEL*BLANK    YL0005 30
      * Define local work field Oms System Value Alpha
     C                     MOVEL*BLANK    YL0006 40
      * Define local work field Oms Access Denied (Y/N)
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Invalid Y/N USR
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field System Value Numeric  USR
     C                     Z-ADD*ZERO     YL0009 155
      * Define local work field Pmt Current Payment Step
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field System Value Alpha    USR
     C                     MOVEL*BLANK    YL0011 40
      * Define local work field PD Producer Code
     C                     MOVEL*BLANK    YL0012  6
      * Define local work field CMP Grading Type
     C                     MOVEL*BLANK    YL0013  1
      * Define local work field TH Payment Gross
     C                     Z-ADD*ZERO     YL0014  72
      * Define local work field TH Hot Wgt
     C                     Z-ADD*ZERO     YL0015  71
      * Define local work field TH Kill Date
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field TH Dead On Arrival
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field TH Head Received
     C                     Z-ADD*ZERO     YL0018  50
      * Define local work field TH Yard Deads
     C                     Z-ADD*ZERO     YL0019  50
      * Define local work field TH Head Condemned
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field TH Head Adds
     C                     Z-ADD*ZERO     YL0021  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0022  71
      * Define local work field TH Adj Live Wgt
     C                     Z-ADD*ZERO     YL0023  71
      * Define local work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     YL0024  31
      * Define local work field TH Avg Backfat
     C                     Z-ADD*ZERO     YL0025  31
      * Define local work field TH Actual Yield %
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field TH Adj Actual Yield %
     C                     Z-ADD*ZERO     YL0027  52
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     YL0029  72
      * Define local work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     YL0030  72
      * Define local work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     YL0031  72
      * Define local work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     YL0032  72
      * Define local work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     YL0033  72
      * Define local work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     YL0034  72
      * Define local work field TH Deduction Amt
     C                     Z-ADD*ZERO     YL0035  72
      * Define local work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     YL0036  72
      * Define local work field TH Additions Amt
     C                     Z-ADD*ZERO     YL0037  72
      * Define local work field Th Payment Net Amt
     C                     Z-ADD*ZERO     YL0038  72
      * Define local work field TH Shipped Weight
     C                     Z-ADD*ZERO     YL0039  71
      * Define local work field TH FFLI
     C                     Z-ADD*ZERO     YL0040  31
      * Define local work field TH Head Excluded
     C                     Z-ADD*ZERO     YL0041  50
      * Define local work field TH CM Bse Mkt Live /CWT
     C                     Z-ADD*ZERO     YL0042  52
      * Define local work field TH CM Srt Dsc Live /CWT
     C                     Z-ADD*ZERO     YL0043  52
      * Define local work field TH CM Srt Dsc Carc /CWT
     C                     Z-ADD*ZERO     YL0044  52
      * Define local work field TH CM Yld G/L Live /CWT
     C                     Z-ADD*ZERO     YL0045  52
      * Define local work field TH CM Yld G/L Carc /CWT
     C                     Z-ADD*ZERO     YL0046  52
      * Define local work field TH CM Crc Val Live /CWT
     C                     Z-ADD*ZERO     YL0047  52
      * Define local work field TH CM Crc Val Carc /CWT
     C                     Z-ADD*ZERO     YL0048  52
      * Define local work field TH CM Lean Prem Live /CWT
     C                     Z-ADD*ZERO     YL0049  52
      * Define local work field TH CM Lean Prem Carc /CWT
     C                     Z-ADD*ZERO     YL0050  52
      * Define local work field TH CM Gross Live /CWT
     C                     Z-ADD*ZERO     YL0051  52
      * Define local work field TH CM Gross Carc /CWT
     C                     Z-ADD*ZERO     YL0052  52
      * Define local work field TH Head Adjusted-LN%
     C                     Z-ADD*ZERO     YL0053  50
      * Define local work field TH PHA Head Adds
     C                     Z-ADD*ZERO     YL0054  50
      * Define local work field TH Excluded Gross Value
     C                     Z-ADD*ZERO     YL0055  72
      * Define local work field TH Excluded Carc Val
     C                     Z-ADD*ZERO     YL0056  72
      * Define local work field TH Excluded Premium
     C                     Z-ADD*ZERO     YL0057  72
      * Define local work field TH Avg Loin Eye - 2 dec
     C                     Z-ADD*ZERO     YL0058  52
      * Define local work field TH Avg Backfat - 2 Dec
     C                     Z-ADD*ZERO     YL0059  52
      * Define local work field Addt Cst Ttl Usr
     C                     Z-ADD*ZERO     YL0060  72
      * Define local work field Head Total USR
     C                     Z-ADD*ZERO     YL0061  70
      * Define local work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     YL0062  51
      * Define local work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     YL0063  52
      * Define local work field TH Tattoo Number
     C                     Z-ADD*ZERO     YL0064  50
      * Define local work field TH Live Wgt
     C                     Z-ADD*ZERO     YL0065  71
      * Define local work field PSC Floor Price
     C                     Z-ADD*ZERO     YL0066  52
      * Define local work field PSC Ceiling Price
     C                     Z-ADD*ZERO     YL0067  52
      * Define local work field PSC Market Percent
     C                     Z-ADD*ZERO     YL0068  30
      * Define local work field Market Price USR
     C                     Z-ADD*ZERO     YL0069  52
      * Define local work field Pricing UOM USR
     C                     MOVEL*BLANK    YL0070  2
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0071  70
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0072  30
      * Define local work field Planned Kill USR
     C                     Z-ADD*ZERO     YL0073  70
      * Define local work field MPR Purchase Type Code
     C                     Z-ADD*ZERO     YL0074  20
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MPRLSTKDTE
