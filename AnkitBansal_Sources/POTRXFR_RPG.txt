     H/TITLE Bld Mex Sales         XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/30/04  Time  : 14:53:21
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOCFREL2IF  E           K        DISK
      * RSQ : MEX Item                  Item Mex=Y
      *
     FOMHSTPN5IF  E           K        DISK
      * RSQ : Sales History             Co/ExpCntry/Item/Inv
      *
     FPOCFREL1IF  E           K        DISK
      * RTV : MEX Item                  Retrieval index
      *
     FARBDCPL3IF  E           K        DISK
      * RTV : A/R Header                Retrieval index       NV
      *
     FOPBFCPLGIF  E           K        DISK
      * RSQ : Order Header TRG          Load Id/Order Num
      *
     FPOBCCPL1IF  E           K        DISK
      * RTV : Load Freight Charge       Retrieval index
      *
     FPOCIREL1IF  E           K        DISK
      * RTV : MEX Labor Cost            Retrieval index
      *
     FPDMRREL1IF  E           K        DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPOCGCPL2IF  E           K        DISK
      * RSQ : MEX Sales                 ExpCnt/Item/Inv/Seq(d)
      *
     FPOCGCPL1IF  E           K        DISK
      * RTV : MEX Sales                 Retrieval index
      *
     FPOCGCPL0IF  E           K        DISK                      A
      * UPD : MEX Sales                 Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@CFREPA
      * MEX Item                  Item Mex=Y
      * Renamed input format fields
     I              CFD9C7                          WAD9C7
     I              CFP2NA                          WAP2NA
     I              CFECAA                          WAECAA
     I              CFESPR                          WAESPR
     I              CFFEPR                          WAFEPR
     I              CFN0SX                          WAN0SX
     I              CFNXSX                          WANXSX
     I              CFNYSX                          WANYSX
     I              CFEAC7                          WAEAC7
     I              CFEBC7                          WAEBC7
     I              CFFGPR                          WAFGPR
     I              CFFHPR                          WAFHPR
      *
     I@HSTPO3
      * Sales History             Co/ExpCntry/Item/Inv
      * Renamed input format fields
     I              F4AIC3                          WBAIC3
     I              F4C4NB                          WBC4NB
     I              F4DPNB                          WBDPNB
     I              F4UENB                          WBUENB
     I              F4MONA                          WBMONA
     I              F4RJCD                          WBRJCD
     I              F4RKCD                          WBRKCD
     I              F4GPTX                          WBGPTX
     I              F4ABTX                          WBABTX
     I              F4KXCD                          WBKXCD
     I              F4BOCD                          WBBOCD
     I              F4BTC7                          WBBTC7
     I              F4ANC7                          WBANC7
     I              F4AQTX                          WBAQTX
     I              F4BKC7                          WBBKC7
     I              F4BRTX                          WBBRTX
     I              F4HNNA                          WBHNNA
     I              F4DBCD                          WBDBCD
     I              F4CKTX                          WBCKTX
     I              F4BCNA                          WBBCNA
     I              F4A0DT                          WBA0DT
     I              F4ACDT                          WBACDT
     I              F4R4CD                          WBR4CD
     I              F4R5CD                          WBR5CD
     I              F4BFCD                          WBBFCD
     I              F4Q4CD                          WBQ4CD
     I              F4AQCD                          WBAQCD
     I              F4TBNB                          WBTBNB
     I              F4BZNA                          WBBZNA
     I              F4RLCD                          WBRLCD
     I              F4JNCD                          WBJNCD
     I              F4Q2CD                          WBQ2CD
     I              F4U2ST                          WBU2ST
     I              F4ATIN                          WBATIN
     I              F4T3NB                          WBT3NB
     I              F4RSRN                          WBRSRN
     I              F4ORIT                          WBORIT
     I              F4AJCD                          WBAJCD
     I              F4AVQT                          WBAVQT
     I              F4D0WG                          WBD0WG
     I              F4CCQT                          WBCCQT
     I              F4AUWG                          WBAUWG
     I              F4AGCD                          WBAGCD
     I              F4AKPR                          WBAKPR
     I              F4AUPR                          WBAUPR
     I              F4CRCD                          WBCRCD
     I              F4A5DT                          WBA5DT
     I              F4AWDT                          WBAWDT
     I              F4HDDT                          WBHDDT
     I              F4AGCS                          WBAGCS
     I              F4AQCS                          WBAQCS
     I              F4AVWG                          WBAVWG
     I              F4AYVA                          WBAYVA
     I              F4AMST                          WBAMST
     I              F4ANST                          WBANST
     I              F4VAST                          WBVAST
     I              F4L6NB                          WBL6NB
     I              F4UMCD                          WBUMCD
     I              F4HCDT                          WBHCDT
     I              F4ESNB                          WBESNB
     I              F4ETNB                          WBETNB
     I              F4BZNB                          WBBZNB
     I              F4EXQT                          WBEXQT
     I              F4BYWG                          WBBYWG
     I              F4S5NB                          WBS5NB
     I              F4MAVA                          WBMAVA
     I              F4KDVA                          WBKDVA
     I              F4USVA                          WBUSVA
     I              F4UTVA                          WBUTVA
     I              F4A4WG                          WBA4WG
     I              F4CKNB                          WBCKNB
     I              F4BMST                          WBBMST
     I              F4R8NB                          WBR8NB
     I              F4RMCD                          WBRMCD
     I              F4BZPR                          WBBZPR
     I              F4RDCD                          WBRDCD
     I              F4Q7CD                          WBQ7CD
     I              F4EXDT                          WBEXDT
     I              F4LQCD                          WBLQCD
     I              F4HICD                          WBHICD
     I              F4RBCD                          WBRBCD
     I              F4RGNB                          WBRGNB
     I              F4RHNB                          WBRHNB
     I              F4RINB                          WBRINB
     I              F4R1NB                          WBR1NB
     I              F4CONB                          WBCONB
     I              F4CEST                          WBCEST
     I              F4GNDT                          WBGNDT
     I              F4RMNB                          WBRMNB
     I              F4AODT                          WBAODT
     I              F4LLCD                          WBLLCD
     I              F4LMCD                          WBLMCD
     I              F4SKNB                          WBSKNB
     I              F4SLNB                          WBSLNB
     I              F4SMNB                          WBSMNB
     I              F4G7NA                          WBG7NA
     I              F4ONVA                          WBONVA
     I              F4N0CD                          WBN0CD
     I              F4B4NB                          WBB4NB
     I              F4B5NB                          WBB5NB
     I              F4N1CD                          WBN1CD
     I              F4GIDT                          WBGIDT
     I              F4Z1ST                          WBZ1ST
     I              F4ULVA                          WBULVA
     I              F4UNVA                          WBUNVA
     I              F4UOVA                          WBUOVA
     I              F4UPVA                          WBUPVA
     I              F4UQVA                          WBUQVA
     I              F4SDCD                          WBSDCD
     I              F4QZCD                          WBQZCD
     I              F4XWST                          WBXWST
     I              F4T9CD                          WBT9CD
     I              F4UBCD                          WBUBCD
     I              F4CFC7                          WBCFC7
     I              F4X1CD                          WBX1CD
     I              F4GASX                          WBGASX
     I              F4DUPR                          WBDUPR
     I              F4B6VL                          WBB6VL
     I              F4IANX                          WBIANX
     I              F4IBNX                          WBIBNX
     I              F4RPCD                          WBRPCD
     I              F4NYDT                          WBNYDT
     I              F4BZTM                          WBBZTM
     I              F4Z4NB                          WBZ4NB
     I              F4XACD                          WBXACD
     I              F4OANA                          WBOANA
     I              F4OKTX                          WBOKTX
     I              F4K4TX                          WBK4TX
     I              F4NBBO                          WBNBBO
     I              F4OCFR                          WBOCFR
     I              F4C0C7                          WBC0C7
     I              F4A1AA                          WBA1AA
     I              F4VEST                          WBVEST
     I              F4A5PR                          WBA5PR
     I              F4CDPR                          WBCDPR
     I              F4D0PR                          WBD0PR
     I              F4D0VL                          WBD0VL
     I              F4IRSX                          WBIRSX
     I              F4CEVL                          WBCEVL
     I              F4ISSX                          WBISSX
     I              F4ITSX                          WBITSX
     I              F4IUSX                          WBIUSX
     I              F4OHDT                          WBOHDT
     I              F4D9PR                          WBD9PR
     I              F4CFVL                          WBCFVL
     I              F4UVST                          WBUVST
     I              F4UWST                          WBUWST
     I              F4UXST                          WBUXST
     I              F4AATM                          WBAATM
     I              F4AYNA                          WBAYNA
     I              F4A0NA                          WBA0NA
     I              F4AXDT                          WBAXDT
      *
     I@CFREOY
      * MEX Item                  Retrieval index
      * Renamed input format fields
     I              CFD9C7                          WCD9C7
     I              CFP2NA                          WCP2NA
     I              CFECAA                          WCECAA
     I              CFESPR                          WCESPR
     I              CFFEPR                          WCFEPR
     I              CFN0SX                          WCN0SX
     I              CFNXSX                          WCNXSX
     I              CFNYSX                          WCNYSX
     I              CFEAC7                          WCEAC7
     I              CFEBC7                          WCEBC7
     I              CFFGPR                          WCFGPR
     I              CFFHPR                          WCFHPR
      *
     I@BDCPF7
      * A/R Header                Retrieval index       NV
      * Renamed input format fields
     I              BDAIC3                          WDAIC3
     I              BDCONB                          WDCONB
     I              BDCEST                          WDCEST
     I              BDUHCD                          WDUHCD
     I              BDBSVA                          WDBSVA
     I              BDAIVA                          WDAIVA
     I              BDAOVA                          WDAOVA
     I              BDBGVA                          WDBGVA
     I              BDAJST                          WDAJST
     I              BDE3ST                          WDE3ST
     I              BDG4CD                          WDG4CD
     I              BDCKNB                          WDCKNB
     I              BDCAC7                          WDCAC7
     I              BDBKC7                          WDBKC7
     I              BDBCCD                          WDBCCD
     I              BDR4CD                          WDR4CD
     I              BDB4DT                          WDB4DT
     I              BDATDT                          WDATDT
     I              BDH0DT                          WDH0DT
     I              BDH3DT                          WDH3DT
     I              BDH4DT                          WDH4DT
     I              BDH5DT                          WDH5DT
     I              BDANC7                          WDANC7
     I              BDCPTX                          WDCPTX
     I              BDBSDY                          WDBSDY
     I              BDUVST                          WDUVST
     I              BDUWST                          WDUWST
     I              BDUXST                          WDUXST
     I              BDAATM                          WDAATM
     I              BDAYNA                          WDAYNA
     I              BDA0NA                          WDA0NA
     I              BDAXDT                          WDAXDT
      *
     I@BFCPRQ
      * Order Header TRG          Load Id/Order Num
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BCCPJ8
      * Load Freight Charge       Retrieval index
      * Renamed input format fields
     I              BCRMNB                          WFRMNB
     I              BCCDAA                          WFCDAA
     I              BCC5VL                          WFC5VL
     I              BCKBSX                          WFKBSX
     I              BCCFAA                          WFCFAA
     I              BCKDSX                          WFKDSX
     I              BCKESX                          WFKESX
     I              BCKFSX                          WFKFSX
     I              BCKGSX                          WFKGSX
     I              BCKSSX                          WFKSSX
     I              BCKTSX                          WFKTSX
     I              BCKHSX                          WFKHSX
     I              BCKISX                          WFKISX
     I              BCKJSX                          WFKJSX
     I              BCVSST                          WFVSST
     I              BCMJDT                          WFMJDT
     I              BCBETM                          WFBETM
     I              BCCCVN                          WFCCVN
     I              BCCDVN                          WFCDVN
     I              BCMKDT                          WFMKDT
     I              BCBFTM                          WFBFTM
     I              BCCEVN                          WFCEVN
     I              BCCFVN                          WFCFVN
      *
     I@CIREO9
      * MEX Labor Cost            Retrieval index
      * Renamed input format fields
     I              CIEMAA                          WGEMAA
     I              CIFDPR                          WGFDPR
      *
     I@MRREWT
      * Export Doc Order Hdr      Retrieval index
      * Renamed input format fields
     I              MRAIC3                          WHAIC3
     I              MRC4NB                          WHC4NB
     I              MRDGSX                          WHDGSX
     I              MRKXCD                          WHKXCD
     I              MRZMCD                          WHZMCD
     I              MRPSTX                          WHPSTX
     I              MRPUTX                          WHPUTX
     I              MRPVTX                          WHPVTX
     I              MRPWTX                          WHPWTX
     I              MRRVTX                          WHRVTX
     I              MRRHTX                          WHRHTX
     I              MRRITX                          WHRITX
     I              MRRJTX                          WHRJTX
     I              MRSCTX                          WHSCTX
     I              MRSDTX                          WHSDTX
     I              MRPXTX                          WHPXTX
     I              MRZOCD                          WHZOCD
     I              MRZNCD                          WHZNCD
     I              MRCSSX                          WHCSSX
     I              MRCTSX                          WHCTSX
     I              MRCUSX                          WHCUSX
     I              MRCVSX                          WHCVSX
     I              MRPTTX                          WHPTTX
     I              MRORNA                          WHORNA
     I              MRRKTX                          WHRKTX
     I              MRPZTX                          WHPZTX
     I              MRRLTX                          WHRLTX
     I              MRP0TX                          WHP0TX
     I              MRP1TX                          WHP1TX
     I              MRP2TX                          WHP2TX
     I              MRP3TX                          WHP3TX
     I              MRP4TX                          WHP4TX
     I              MRP5TX                          WHP5TX
     I              MRP6TX                          WHP6TX
     I              MRYHTX                          WHYHTX
     I              MRYITX                          WHYITX
     I              MRCWSX                          WHCWSX
     I              MROUNA                          WHOUNA
     I              MRP7TX                          WHP7TX
     I              MRP9TX                          WHP9TX
     I              MROVNA                          WHOVNA
     I              MRQATX                          WHQATX
     I              MRQBTX                          WHQBTX
     I              MRQCTX                          WHQCTX
     I              MROWNA                          WHOWNA
     I              MROXNA                          WHOXNA
     I              MRABNX                          WHABNX
     I              MRACNX                          WHACNX
     I              MRADNX                          WHADNX
     I              MRQDTX                          WHQDTX
     I              MRQETX                          WHQETX
     I              MROYNA                          WHOYNA
     I              MROZNA                          WHOZNA
     I              MRO0NA                          WHO0NA
     I              MRO1NA                          WHO1NA
     I              MRCXSX                          WHCXSX
     I              MRCYSX                          WHCYSX
     I              MRAGNX                          WHAGNX
     I              MRCZSX                          WHCZSX
     I              MRC0SX                          WHC0SX
     I              MRC1SX                          WHC1SX
     I              MRQFTX                          WHQFTX
     I              MRAHNX                          WHAHNX
     I              MRQGTX                          WHQGTX
     I              MRQHTX                          WHQHTX
     I              MRQITX                          WHQITX
     I              MRQJTX                          WHQJTX
     I              MRQKTX                          WHQKTX
     I              MRQMTX                          WHQMTX
     I              MRQNTX                          WHQNTX
     I              MRQOTX                          WHQOTX
     I              MRQPTX                          WHQPTX
     I              MRQQTX                          WHQQTX
     I              MRQRTX                          WHQRTX
     I              MRQSTX                          WHQSTX
     I              MRQTTX                          WHQTTX
     I              MRQUTX                          WHQUTX
     I              MRQVTX                          WHQVTX
     I              MRQYTX                          WHQYTX
     I              MRQWTX                          WHQWTX
     I              MRQZTX                          WHQZTX
     I              MRAINX                          WHAINX
     I              MRQ1TX                          WHQ1TX
     I              MRQ2TX                          WHQ2TX
     I              MRQ3TX                          WHQ3TX
     I              MRQ4TX                          WHQ4TX
     I              MRQ5TX                          WHQ5TX
     I              MRQ6TX                          WHQ6TX
     I              MRQ7TX                          WHQ7TX
     I              MRQ8TX                          WHQ8TX
     I              MRQ9TX                          WHQ9TX
     I              MRSMTX                          WHSMTX
     I              MRZQCD                          WHZQCD
     I              MRZRCD                          WHZRCD
     I              MRA7VL                          WHA7VL
     I              MRA8VL                          WHA8VL
     I              MRC2SX                          WHC2SX
     I              MRC8SX                          WHC8SX
     I              MRHRWG                          WHHRWG
     I              MRBIVL                          WHBIVL
     I              MRK2QT                          WHK2QT
     I              MRO5NA                          WHO5NA
     I              MRHSWG                          WHHSWG
     I              MRBJVL                          WHBJVL
     I              MRRATX                          WHRATX
     I              MRRBTX                          WHRBTX
     I              MRRCTX                          WHRCTX
     I              MRRDTX                          WHRDTX
     I              MRRETX                          WHRETX
     I              MRC3SX                          WHC3SX
     I              MRC4SX                          WHC4SX
     I              MRC5SX                          WHC5SX
     I              MRC6SX                          WHC6SX
     I              MRC7SX                          WHC7SX
     I              MRMQDT                          WHMQDT
     I              MRMRDT                          WHMRDT
     I              MRMSDT                          WHMSDT
     I              MRAJNX                          WHAJNX
     I              MRYFTX                          WHYFTX
     I              MRX9TX                          WHX9TX
     I              MRYATX                          WHYATX
     I              MRYBTX                          WHYBTX
     I              MRB5AA                          WHB5AA
     I              MRYCTX                          WHYCTX
     I              MRYDTX                          WHYDTX
     I              MRYETX                          WHYETX
     I              MRB6AA                          WHB6AA
     I              MRPADT                          WHPADT
     I              MRPBDT                          WHPBDT
     I              MRPCDT                          WHPCDT
     I              MRPDDT                          WHPDDT
     I              MRPEDT                          WHPEDT
     I              MRO4SX                          WHO4SX
     I              MRO5SX                          WHO5SX
     I              MRC1T1                          WHC1T1
     I              MRC2T1                          WHC2T1
     I              MRUVST                          WHUVST
     I              MRUWST                          WHUWST
     I              MRUXST                          WHUXST
     I              MRVSST                          WHVSST
     I              MRAATM                          WHAATM
     I              MRAYNA                          WHAYNA
     I              MRA0NA                          WHA0NA
     I              MRAXDT                          WHAXDT
      *
     I@CGCPPB
      * MEX Sales                 ExpCnt/Item/Inv/Seq(d)
      * Renamed input format fields
     I              CGEKAA                          WIEKAA
     I              CGECC7                          WIECC7
     I              CGTNNX                          WITNNX
     I              CGTONX                          WITONX
     I              CGEDAA                          WIEDAA
     I              CGP3NA                          WIP3NA
     I              CGEDC7                          WIEDC7
     I              CGO6DT                          WIO6DT
     I              CGO7DT                          WIO7DT
     I              CGNVSX                          WINVSX
     I              CGO8DT                          WIO8DT
     I              CGCNT1                          WICNT1
     I              CGCOT1                          WICOT1
     I              CGEEAA                          WIEEAA
     I              CGETPR                          WIETPR
     I              CGJRWG                          WIJRWG
     I              CGEFAA                          WIEFAA
     I              CGEGAA                          WIEGAA
     I              CGEUPR                          WIEUPR
     I              CGEVPR                          WIEVPR
     I              CGEWPR                          WIEWPR
     I              CGEXPR                          WIEXPR
     I              CGEYPR                          WIEYPR
     I              CGEZPR                          WIEZPR
     I              CGE0PR                          WIE0PR
     I              CGE1PR                          WIE1PR
     I              CGE2PR                          WIE2PR
     I              CGE3PR                          WIE3PR
     I              CGFFPR                          WIFFPR
     I              CGE4PR                          WIE4PR
     I              CGEHAA                          WIEHAA
     I              CGE9PR                          WIE9PR
     I              CGEIAA                          WIEIAA
     I              CGFAPR                          WIFAPR
     I              CGE5PR                          WIE5PR
     I              CGFBPR                          WIFBPR
     I              CGFCPR                          WIFCPR
     I              CGE6PR                          WIE6PR
     I              CGE7PR                          WIE7PR
     I              CGE8PR                          WIE8PR
     I              CGEJAA                          WIEJAA
     I              CGNZSX                          WINZSX
      *
     I@CGCPO0
      * MEX Sales                 Update index
      * Renamed input format fields
     I              CGEKAA                          WJEKAA
     I              CGECC7                          WJECC7
     I              CGTNNX                          WJTNNX
     I              CGTONX                          WJTONX
     I              CGEDAA                          WJEDAA
     I              CGP3NA                          WJP3NA
     I              CGEDC7                          WJEDC7
     I              CGO6DT                          WJO6DT
     I              CGO7DT                          WJO7DT
     I              CGNVSX                          WJNVSX
     I              CGO8DT                          WJO8DT
     I              CGCNT1                          WJCNT1
     I              CGCOT1                          WJCOT1
     I              CGEEAA                          WJEEAA
     I              CGETPR                          WJETPR
     I              CGJRWG                          WJJRWG
     I              CGEFAA                          WJEFAA
     I              CGEGAA                          WJEGAA
     I              CGEUPR                          WJEUPR
     I              CGEVPR                          WJEVPR
     I              CGEWPR                          WJEWPR
     I              CGEXPR                          WJEXPR
     I              CGEYPR                          WJEYPR
     I              CGEZPR                          WJEZPR
     I              CGE0PR                          WJE0PR
     I              CGE1PR                          WJE1PR
     I              CGE2PR                          WJE2PR
     I              CGE3PR                          WJE3PR
     I              CGFFPR                          WJFFPR
     I              CGE4PR                          WJE4PR
     I              CGEHAA                          WJEHAA
     I              CGE9PR                          WJE9PR
     I              CGEIAA                          WJEIAA
     I              CGFAPR                          WJFAPR
     I              CGE5PR                          WJE5PR
     I              CGFBPR                          WJFBPR
     I              CGFCPR                          WJFCPR
     I              CGE6PR                          WJE6PR
     I              CGE7PR                          WJE7PR
     I              CGE8PR                          WJE8PR
     I              CGEJAA                          WJEJAA
     I              CGNZSX                          WJNZSX
      *
     I@CGCPO1
      * MEX Sales                 Retrieval index
      * Renamed input format fields
     I              CGEKAA                          WKEKAA
     I              CGECC7                          WKECC7
     I              CGTNNX                          WKTNNX
     I              CGTONX                          WKTONX
     I              CGEDAA                          WKEDAA
     I              CGP3NA                          WKP3NA
     I              CGEDC7                          WKEDC7
     I              CGO6DT                          WKO6DT
     I              CGO7DT                          WKO7DT
     I              CGNVSX                          WKNVSX
     I              CGO8DT                          WKO8DT
     I              CGCNT1                          WKCNT1
     I              CGCOT1                          WKCOT1
     I              CGEEAA                          WKEEAA
     I              CGETPR                          WKETPR
     I              CGJRWG                          WKJRWG
     I              CGEFAA                          WKEFAA
     I              CGEGAA                          WKEGAA
     I              CGEUPR                          WKEUPR
     I              CGEVPR                          WKEVPR
     I              CGEWPR                          WKEWPR
     I              CGEXPR                          WKEXPR
     I              CGEYPR                          WKEYPR
     I              CGEZPR                          WKEZPR
     I              CGE0PR                          WKE0PR
     I              CGE1PR                          WKE1PR
     I              CGE2PR                          WKE2PR
     I              CGE3PR                          WKE3PR
     I              CGFFPR                          WKFFPR
     I              CGE4PR                          WKE4PR
     I              CGEHAA                          WKEHAA
     I              CGE9PR                          WKE9PR
     I              CGEIAA                          WKEIAA
     I              CGFAPR                          WKFAPR
     I              CGE5PR                          WKE5PR
     I              CGFBPR                          WKFBPR
     I              CGFCPR                          WKFCPR
     I              CGE6PR                          WKE6PR
     I              CGE7PR                          WKE7PR
     I              CGE8PR                          WKE8PR
     I              CGEJAA                          WKEJAA
     I              CGNZSX                          WKNZSX
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPOCG1    E DSPOCGCPL0
      * UPD : MEX Sales                 Update index
      * Renamed input format fields
     I              CGEKAA                          WJEKAA
     I              CGECC7                          WJECC7
     I              CGTNNX                          WJTNNX
     I              CGTONX                          WJTONX
     I              CGEDAA                          WJEDAA
     I              CGP3NA                          WJP3NA
     I              CGEDC7                          WJEDC7
     I              CGO6DT                          WJO6DT
     I              CGO7DT                          WJO7DT
     I              CGNVSX                          WJNVSX
     I              CGO8DT                          WJO8DT
     I              CGCNT1                          WJCNT1
     I              CGCOT1                          WJCOT1
     I              CGEEAA                          WJEEAA
     I              CGETPR                          WJETPR
     I              CGJRWG                          WJJRWG
     I              CGEFAA                          WJEFAA
     I              CGEGAA                          WJEGAA
     I              CGEUPR                          WJEUPR
     I              CGEVPR                          WJEVPR
     I              CGEWPR                          WJEWPR
     I              CGEXPR                          WJEXPR
     I              CGEYPR                          WJEYPR
     I              CGEZPR                          WJEZPR
     I              CGE0PR                          WJE0PR
     I              CGE1PR                          WJE1PR
     I              CGE2PR                          WJE2PR
     I              CGE3PR                          WJE3PR
     I              CGFFPR                          WJFFPR
     I              CGE4PR                          WJE4PR
     I              CGEHAA                          WJEHAA
     I              CGE9PR                          WJE9PR
     I              CGEIAA                          WJEIAA
     I              CGFAPR                          WJFAPR
     I              CGE5PR                          WJE5PR
     I              CGFBPR                          WJFBPR
     I              CGFCPR                          WJFCPR
     I              CGE6PR                          WJE6PR
     I              CGE7PR                          WJE7PR
     I              CGE8PR                          WJE8PR
     I              CGEJAA                          WJEJAA
     I              CGNZSX                          WJNZSX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Export Country Code
     I                                        1   6 P1UMCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1UMCD    PARM           WP0001  6        Export Country
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Bld Mex Sales         XF
      * 05/12/04 SLM PKTR01 Multi-Company - Order Header TRG Remove Co
      *                                     from Logical View
      * Bld Mex Sales         RT - MEX Item  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Bld Mex Sales         RT - MEX Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * DOC:  2003 PERIOD OF INVESTIGATION
     C                     EXSR UASUBR                     DOC:  2003 PERI
      * DOC:  2004 PERIOD OF INVESTIGATION
     C                     EXSR UBSUBR                     DOC:  2004 PERI
      * Establish starting position
     C           *LOVAL    SETLL@CFREPA                    *
     C                     READ @CFREPA                  90*
      * Data record not found
     C   90                MOVEL'USR3190' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * SEL:  Item Code
      * CASE: PAR.Export Country Code is Not Mexico
     C           P1UMCD    IFNE 'MEX'                      *IF
      * CASE: DB1.MI 6 Mo Sold to MEX is no
     C           WANXSX    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
     C                     Z-ADDWAD9C7    YL0001           MI Item Code
      * Export Country Code
      * CASE: PAR.Export Country Code is USA
     C           P1UMCD    IFEQ 'USA'                      *IF
     C                     MOVEL*BLANK    YL0002           Export Country
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELP1UMCD    YL0002           Export Country
     C                     END                             *FI
      * Bld MEX Sales         RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0001           Company Number
     C                     MOVELYL0002    WL0002    P      Export Country
     C                     Z-ADDYL0001    WL0003           Shipped Item Co
     C                     Z-ADD1010101   WL0004           Actual Shipped
     C                     Z-ADDYL0001    WL0006           MI Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0003    P      Record Found US
      * CASE: LCL.Record Found USR is Record Not Found
     C           YL0003    IFEQ 'N'                        *IF
      * CASE: PAR.Export Country Code is Japan
     C           P1UMCD    IFEQ 'JPN'                      *IF
      * Val Item Existance    RT - MEX Sales  * 
     C                     EXSR SKRVGN
      * CASE: LCL.Return Code Usr is *Blank
     C           YL0016    IFEQ *BLANK                     *IF
      * Bld MEX Sales         RT - Sales History  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0001           Company Number
     C                     MOVELYL0002    WL0002    P      Export Country
     C                     Z-ADDWAEBC7    WL0003           Shipped Item Co
     C                     Z-ADD1010101   WL0004           Actual Shipped
     C                     Z-ADDWAD9C7    WL0006           MI Item Code
     C                     EXSR SBRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0003    P      Record Found US
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @CFREPA                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Bld MEX Sales         RT - Sales History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  6        MS Country Code
     C                     Z-ADD*ZERO     WN0002  70       MS Item Code
     C                     Z-ADD*ZERO     WN0003  70       MS Invoice Numb
     C                     Z-ADD*ZERO     WN0004  30       MS Item Seq
     C                     MOVEL*BLANK    WN0005 10        MS Tariff Class
     C                     MOVEL*BLANK    WN0006 30        MS Item Descrip
     C                     Z-ADD*ZERO     WN0007  70       MS MEX Comparis
     C                     Z-ADD*ZERO     WN0008  70       MS Invoice Date
     C                     Z-ADD*ZERO     WN0009  70       MS Shipment Dat
     C                     MOVEL*BLANK    WN0010  2        MS Terms of Sal
     C                     Z-ADD*ZERO     WN0011  70       MS Payment Date
     C                     MOVEL*BLANK    WN0012 30        MS Destination
     C                     MOVEL*BLANK    WN0013 30        MS Bill To Name
     C                     MOVEL*BLANK    WN0014  1        MS Related Clie
     C                     Z-ADD*ZERO     WN0015 114       MS Invoice Amou
     C                     Z-ADD*ZERO     WN0016 112       MS Weight Bille
     C                     MOVEL*BLANK    WN0017  2        MS Exchange Rat
     C                     MOVEL*BLANK    WN0018  2        MS Conversion F
     C                     Z-ADD*ZERO     WN0019 114       MS Unit Price
     C                     Z-ADD*ZERO     WN0020 114       MS Rebates
     C                     Z-ADD*ZERO     WN0021 114       MS Packing Labo
     C                     Z-ADD*ZERO     WN0022 114       MS Packing Mate
     C                     Z-ADD*ZERO     WN0023 114       MS Credit Exp
     C                     MOVEL*BLANK    WN0024  2        MS Garranties E
     C                     Z-ADD*ZERO     WN0025 114       MS Commission E
     C                     Z-ADD*ZERO     WN0026 114       MS Handling Exp
     C                     Z-ADD*ZERO     WN0027 114       MS Export Handl
     C                     Z-ADD*ZERO     WN0028 114       MS USA Freight
     C                     Z-ADD*ZERO     WN0029 114       MS USA Ocean Fr
     C                     MOVEL*BLANK    WN0030  2        MS USA Insuranc
     C                     MOVEL*BLANK    WN0031  2        MS MEX Freight
     C                     Z-ADD*ZERO     WN0032 114       MS Quality Adj
     C                     MOVEL*BLANK    WN0033  2        MS MEX Insuranc
     C                     Z-ADD*ZERO     WN0034 114       MS Taxes Adj
     C                     Z-ADD*ZERO     WN0035 114       MS USDA Documen
     C                     Z-ADD*ZERO     WN0036 114       MS Physical Adj
     C                     Z-ADD*ZERO     WN0037 114       MS Other Adj
     C                     Z-ADD*ZERO     WN0038 114       MS Total Adj
     C                     Z-ADD*ZERO     WN0039 114       MS Total Adj US
     C                     Z-ADD*ZERO     WN0040 114       MS Net Price US
     C                     MOVEL*BLANK    WN0041  2        MS Exchange Rat
     C                     MOVEL*BLANK    WN0042  1        MS Direct/Indir
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1031231   YL0004           Actual Shipped
     C                     MOVEL'Y'       WL0005           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBUMCD    WQSB02           Export Country
     C           *LIKE     DEFN WBS5NB    WQSB03           Shipped Item Co
      * Define keylist
     C           KPSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Export Country
     C                     KFLD           WQSB03           Shipped Item Co
     C                     KFLD           WBGNDT           Actual Shipped
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Export Country
     C                     KFLD           WQSB03           Shipped Item Co
      * Setup key
     C                     Z-ADDWL0001    WQSB01           Company Number
     C                     MOVELWL0002    WQSB02           Export Country
     C                     Z-ADDWL0003    WQSB03           Shipped Item Co
     C                     Z-ADDWL0004    WBGNDT           Actual Shipped
      * Establish starting position
     C           KPSSB     SETLL@HSTPO3                    *
     C           KRSSB     READE@HSTPO3                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1241' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0005           Record Found US
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * QUIT:  Actual Shipped Date GT LCL.Actual Shipped Date
      * CASE: DB1.Actual Shipped Date GT LCL.Actual Shipped Date
     C           WBGNDT    IFGT YL0004                     *IF
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * OMT:  Orders
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Order Number is 201934
      *   |- c2    : DB1.Order Number is 209447
      *   '-
     C           WBC4NB    IFEQ 201934                     *IF
     C           WBC4NB    OREQ 209447                     *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Process Record
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * MS Country Code
      * CASE: PAR.Export Country Code is Blank
     C           WL0002    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WN0001           MS Country Code
     C                     MOVEL'USA'     WN0001           MS Country Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWBUMCD    WN0001           MS Country Code
     C                     END                             *FI
     C                     Z-ADDWBS5NB    WN0002           MS Item Code
      * MEX:  Replace 11410 and 11810 with 11610
      * CASE: PAR.Export Country Code is Mexico
     C           WL0002    IFEQ 'MEX'                      *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.Shipped Item Code is 11410
      *   |- c2    : DB1.Shipped Item Code is 11810
      *   '-
     C           WBS5NB    IFEQ 11410                      *IF
     C           WBS5NB    OREQ 11810                      *OR
     C                     Z-ADD11610     WN0002           MS Item Code
     C                     END                             *FI
     C                     END                             *FI
     C                     Z-ADDWBCONB    WN0003           MS Invoice Numb
      * Rtv Mex Item Info     RT - MEX Item  * 
     C                     EXSR SCRVGN
      * MS MEX Comparison Item Code
      * CASE: PAR.Shipped Item Code EQ PAR.MI Item Code
     C           WL0003    IFEQ WL0006                     *IF
     C                     Z-ADD*ZERO     WN0007           MS MEX Comparis
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWL0006    WN0007           MS MEX Comparis
     C                     END                             *FI
     C                     Z-ADDWBAWDT    WN0008           MS Invoice Date
     C                     Z-ADDWBGNDT    WN0009           MS Shipment Dat
     C                     MOVELWBQ2CD    WN0010           MS Terms of Sal
      * Rtv Days to Payment   RT - A/R Header  * 
     C                     EXSR SDRVGN
      * PAR.MS Payment Date = PAR.MS Invoice Date + LCL.Days to Pay *DAYS
     C           WN0008    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADDYL0008    XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     WN0011
     C                     ELSE
     C           XDINDT    SUB  1000000   WN0011
     C                     END
      * MS Destination
      * CASE: DB1.Shipping Method is Prepaid
     C           WBQ2CD    IFEQ 'PR'                       *IF
     C           WBQ2CD    OREQ 'PT'
     C                     Z-ADD1         ZQ      50
     C           WBHNNA    CAT  WBDBCD:ZQ WN0012    P      MS Destination
     C                     ELSE
      * CASE: DB1.Shipping Method is Collect
     C           WBQ2CD    IFEQ 'CR'                       *IF
     C           WBQ2CD    OREQ 'CT'
     C                     MOVEL*BLANK    WN0012           MS Destination
     C                     MOVEL@CN,01    WN0012           MS Destination
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWBAQTX    WN0013           MS Bill To Name
     C                     MOVEL'1'       WN0014           MS Related Clie
     C                     Z-ADDWBAYVA    WN0015           MS Invoice Amou
     C                     Z-ADDWBBYWG    WN0016           MS Weight Bille
     C                     MOVEL'NA'      WN0017           MS Exchange Rat
     C                     MOVEL'NA'      WN0018           MS Conversion F
     C                     Z-ADDWBAKPR    WN0019           MS Unit Price
      * Rtv Frt Charge MEX    RT - Order Header TRG  * INLAND
     C                     EXSR SERVGN
     C           WBONVA    ADD  YL0009    YL0012           Actual Freight
      * MS Rebates, Credits, etc. (Claim Adjustment)
      * CASE: PAR.MS Country Code is Mexico
     C           WN0001    IFEQ 'MEX'                      *IF
     C                     Z-ADDYL0007    WN0020           MS Rebates
     C                     ELSE
      * CASE: PAR.MS Country Code is USA
     C           WN0001    IFEQ 'USA'                      *IF
     C                     Z-ADDYL0006    WN0020           MS Rebates
     C                     END                             *FI
     C                     END                             *FI
      * MS USA Freight, MS Ocean Freight, MS Credit Exp
      * CASE: PAR.MS Weight Billed is Greater than zero
     C           WN0016    IFGT *ZERO                      *IF
     C           YL0012    DIV  WN0016    WN0028    H      MS USA Freight
      * LCL.Days = PAR.MS Payment Date - PAR.MS Invoice Date *DAYS
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           WN0008    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WN0011    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0013
     C                     ELSE
     C           XDURR     MULT -1        YL0013
     C                     END
      * CASE: LCL.Days is GT Zero
     C           YL0013    IFGT *ZERO                      *IF
      * Interest Rate = 3.42% for 2003
      * Interest Rate = 2.768% for 2004
      * MS Credit Exp (MEX2004)
      * PAR.MS Credit Exp =
      *    *COMPUTE ((((x1 * x2) / x3) * x4) / x5)
      * x1    : PAR.MS Invoice Amount
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON..02768
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON.365
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : LCL.Days
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x5    : PAR.MS Weight Billed
     C           WN0015    MULT .02768    W0WD03    H      *Synon (17,7) w
     C           W0WD03    DIV  365       W0WD02    H      *Synon (17,7) w
     C           W0WD02    MULT YL0013    W0WD01           *Synon (17,7) w
     C           W0WD01    DIV  WN0016    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0023           MS Credit Exp
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0023           MS Credit Exp
     C                     END                             *FI
      * MS Commission Exp
      * CASE: PAR.Export Country Code is Japan
     C           WL0002    IFEQ 'JPN'                      *IF
      * MS Commission Exp
      * PAR.MS Commission Exp =
      *    *COMPUTE ((x1 * x2) / x3)
      * x1    : CON..005
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : DB1.FOB Gross Amount
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : PAR.MS Weight Billed
     C           .005      MULT WBUSVA    W0WB01           *Synon (15,5) w
     C           W0WB01    DIV  WN0016    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0025           MS Commission E
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0025           MS Commission E
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL'NA'      WN0024           MS Garranties E
      * Rtv Labor Cost        RT - MEX Labor Cost  * 
     C                     EXSR SGRVGN
     C                     MOVEL'NA'      WN0030           MS USA Insuranc
     C                     MOVEL'NA'      WN0031           MS MEX Freight
     C                     MOVEL'NA'      WN0033           MS MEX Insuranc
      * CASE: PAR.Export Country Code is Mexico
     C           WL0002    IFEQ 'MEX'                      *IF
      * MS Total Adj
      * PAR.MS Total Adj =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6)
      * x1    : PAR.MS Rebates
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.MS Packing Labor Exp
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.MS Packing Material Exp
      * +     : PGM.*Synon (15,5) work field
      * x4    : PAR.MS Credit Exp
      * +     : PGM.*Synon (15,5) work field
      * x5    : PAR.MS Handling Exp
      * +     : PGM.*Synon (15,5) work field
      * x6    : PAR.MS USA Freight Exp
     C           WN0020    ADD  WN0021    W0WB04           *Synon (15,5) w
     C           W0WB04    ADD  WN0022    W0WB03           *Synon (15,5) w
     C           W0WB03    ADD  WN0023    W0WB02           *Synon (15,5) w
     C           W0WB02    ADD  WN0026    W0WB01           *Synon (15,5) w
     C           W0WB01    ADD  WN0028    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0038           MS Total Adj
     C                     ELSE
      * CASE: *OTHERWISE
      * MS Total Adj
      * PAR.MS Total Adj =
      *    *COMPUTE (x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9 + x10 +
      *    x11 + x12)
      * x1    : PAR.MS Rebates
      * +     : PGM.*Synon (15,5) work field
      * x2    : PAR.MS Packing Labor Exp
      * +     : PGM.*Synon (15,5) work field
      * x3    : PAR.MS Packing Material Exp
      * +     : PGM.*Synon (15,5) work field
      * x4    : PAR.MS Credit Exp
      * +     : PGM.*Synon (15,5) work field
      * x5    : PAR.MS Handling Exp
      * +     : PGM.*Synon (15,5) work field
      * x6    : PAR.MS USA Freight Exp
      * +     : PGM.*Synon (15,5) work field
      * x7    : PAR.MS Commission Exp
      * +     : PGM.*Synon (15,5) work field
      * x8    : PAR.MS Quality Adj
      * +     : PGM.*Synon (15,5) work field
      * x9    : PAR.MS Taxes Adj
      * +     : PGM.*Synon (15,5) work field
      * x10   : PAR.MS Physical Adj
      * +     : PGM.*Synon (15,5) work field
      * x11   : PAR.MS Other Adj
      * +     : PGM.*Synon (15,5) work field
      * x12   : PAR.MS USA Ocean Frt Exp
     C           WN0020    ADD  WN0021    W0WB10           *Synon (15,5) w
     C           W0WB10    ADD  WN0022    W0WB09           *Synon (15,5) w
     C           W0WB09    ADD  WN0023    W0WB08           *Synon (15,5) w
     C           W0WB08    ADD  WN0026    W0WB07           *Synon (15,5) w
     C           W0WB07    ADD  WN0028    W0WB06           *Synon (15,5) w
     C           W0WB06    ADD  WN0025    W0WB05           *Synon (15,5) w
     C           W0WB05    ADD  WN0032    W0WB04           *Synon (15,5) w
     C           W0WB04    ADD  WN0034    W0WB03           *Synon (15,5) w
     C           W0WB03    ADD  WN0036    W0WB02           *Synon (15,5) w
     C           W0WB02    ADD  WN0037    W0WB01           *Synon (15,5) w
     C           W0WB01    ADD  WN0029    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WN0038           MS Total Adj
     C                     END                             *FI
     C                     Z-ADDWN0038    WN0039           MS Total Adj US
     C           WN0019    SUB  WN0038    WN0040           MS Net Price US
     C                     MOVEL'NA'      WN0041           MS Exchange Rat
      * Rtv Consignee/Consgnr RT - Export Doc Order Hdr  * 
     C                     EXSR SHRVGN
     C                     Z-ADD8         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00040
     C           ZQ        ORGT 00040
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0014:ZQ YL0015    P  90  Text USR 8
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * Direct/Indirect
      * CASE: LCL.Text USR 8 is Seaboard
     C           YL0015    IFEQ 'Seaboard'                 *IF
     C                     MOVEL'1'       WN0042           MS Direct/Indir
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'2'       WN0042           MS Direct/Indir
     C                     END                             *FI
      * Rtv Next Seq          RT - MEX Sales  * 
     C                     EXSR SIRVGN
      * Crt MEX Sales         CR - MEX Sales  * 
     C                     EXSR SJCRRC
     C                     END                             *FI
     C           KRSSB     READE@HSTPO3                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Mex Item Info     RT - MEX Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCD9C7           MI Item Code
      * Setup key
     C                     Z-ADDWN0002    WCD9C7           MI Item Code
      * Establish starting position
     C           KRSSC     CHAIN@CFREOY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3190' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0006           MI Item Descrip
     C                     MOVEL*BLANK    WN0005           MI Tariff Class
     C                     Z-ADD*ZERO     WN0022           MI Pkg Mtrl Cos
     C                     Z-ADD*ZERO     WN0021           MI Pkg Labor Co
     C                     MOVEL*BLANK    YL0005           MI 6 Mo Sold to
     C                     Z-ADD*ZERO     YL0006           MI USA Claim Ad
     C                     Z-ADD*ZERO     YL0007           MI MEX Claim Ad
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCP2NA    WN0006           MI Item Descrip
     C                     MOVELWCECAA    WN0005           MI Tariff Class
     C                     Z-ADDWCESPR    WN0022           MI Pkg Mtrl Cos
     C                     Z-ADDWCFEPR    WN0021           MI Pkg Labor Co
     C                     MOVELWCNXSX    YL0005           MI 6 Mo Sold to
     C                     Z-ADDWCFGPR    YL0006           MI USA Claim Ad
     C                     Z-ADDWCFHPR    YL0007           MI MEX Claim Ad
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Days to Payment   RT - A/R Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDCONB           Invoice Number
     C                     KFLD           WDCEST           Invoice Suffix
      * Setup key
     C                     Z-ADDWBAIC3    WDAIC3           Company Number
     C                     Z-ADDWBCONB    WDCONB           Invoice Number
     C                     MOVELWBCEST    WDCEST           Invoice Suffix
      * Establish starting position
     C           KRSSD     CHAIN@BDCPF7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0174' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           Days to Pay
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDBSDY    YL0008           Days to Pay
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Frt Charge MEX    RT - Order Header TRG  * INLAND
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0043 112       Order Weight To
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0009           Amount Paid
     C                     Z-ADD*ZERO     WN0043           Order Weight To
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSE02           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE02           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WQSE02           Load ID
      * Establish starting position
     C           KRSSE     SETLL@BFCPRQ                    *
     C           KRSSE     READE@BFCPRQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WEA1WG    WN0043           Order Weight To
     C           KRSSE     READE@BFCPRQ                  90*
     C                     ENDDO
      * USER: Exit processing
      * Rtv Charge Amount     RT - Load Freight Charge  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Order Weight Total is Greater than zero
     C           WN0043    IFGT *ZERO                      *IF
     C           YL0010    DIV  WN0043    YL0011    H      Carrier Rate
     C           YL0011    MULT WBBYWG    YL0009    H      Amount Paid
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0009           Amount Paid
     C                     END                             *FI
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Charge Amount     RT - Load Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFRMNB           Load ID
     C                     KFLD           WFCDAA           FC Code
      * Setup key
     C                     Z-ADDWERMNB    WFRMNB           Load ID
     C                     MOVEL'INLAND'  WFCDAA           FC Code
      * Establish starting position
     C           KRSSF     CHAIN@BCCPJ8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3058' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0010           LFC Amount
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFC5VL    YL0010           LFC Amount
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Labor Cost        RT - MEX Labor Cost  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGEMAA           MLC Unit of Mea
      * Setup key
     C                     MOVELWBAGCD    WGEMAA           MLC Unit of Mea
      * Establish starting position
     C           KRSSG     CHAIN@CIREO9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3196' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0026           MLC Cost /LB
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGFDPR    WN0026           MLC Cost /LB
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Consignee/Consgnr RT - Export Doc Order Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSH02           Order Number
     C           *LIKE     DEFN WHDGSX    WQSH03           ED Export Docum
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Order Number
     C                     KFLD           WQSH03           ED Export Docum
      * Setup key
     C                     Z-ADDWBAIC3    WQSH01           Company Number
     C                     Z-ADDWBC4NB    WQSH02           Order Number
     C                     MOVEL'H'       WQSH03           ED Export Docum
      * Establish starting position
     C           KRSSH     SETLL@MRREWT                    *
     C           KRSSH     READE@MRREWT                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2743' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0014           ED Consignor Na
     C                     MOVEL*BLANK    WUPVTX           ED Consignor Ad
     C                     MOVEL*BLANK    WUPWTX           ED Consignor Ad
     C                     MOVEL*BLANK    WURVTX           ED Consignor Ad
     C                     MOVEL*BLANK    WURHTX           ED Consignee Na
     C                     MOVEL*BLANK    WURITX           ED Consignee Ad
     C                     MOVEL*BLANK    WURJTX           ED Consignee Ad
     C                     MOVEL*BLANK    WUSCTX           ED Consignee Ad
     C                     MOVEL*BLANK    WUSDTX           ED Consignee Ad
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHPUTX    YL0014           ED Consignor Na
     C                     MOVELWHPVTX    WUPVTX           ED Consignor Ad
     C                     MOVELWHPWTX    WUPWTX           ED Consignor Ad
     C                     MOVELWHRVTX    WURVTX           ED Consignor Ad
     C                     MOVELWHRHTX    WURHTX           ED Consignee Na
     C                     MOVELWHRITX    WURITX           ED Consignee Ad
     C                     MOVELWHRJTX    WURJTX           ED Consignee Ad
     C                     MOVELWHSCTX    WUSCTX           ED Consignee Ad
     C                     MOVELWHSDTX    WUSDTX           ED Consignee Ad
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@MRREWT                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Next Seq          RT - MEX Sales  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIEKAA    WQSI01           MS Country Code
     C           *LIKE     DEFN WIECC7    WQSI02           MS Item Code
     C           *LIKE     DEFN WITNNX    WQSI03           MS Invoice Numb
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           MS Country Code
     C                     KFLD           WQSI02           MS Item Code
     C                     KFLD           WQSI03           MS Invoice Numb
      * Setup key
     C                     MOVELWN0001    WQSI01           MS Country Code
     C                     Z-ADDWN0002    WQSI02           MS Item Code
     C                     Z-ADDWN0003    WQSI03           MS Invoice Numb
      * Establish starting position
     C           KRSSI     SETLL@CGCPPB                    *
     C           KRSSI     READE@CGCPPB                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3192' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0004           MS Item Seq
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WITONX    ADD  1         WN0004           MS Item Seq
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@CGCPPB                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJCRRC    BEGSR
      *================================================================
      * Crt MEX Sales         CR - MEX Sales  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CGCPO0
     C                     MOVELWN0001    WJEKAA           MS Country Code
     C                     Z-ADDWN0002    WJECC7           MS Item Code
     C                     Z-ADDWN0003    WJTNNX           MS Invoice Numb
     C                     Z-ADDWN0004    WJTONX           MS Item Seq
     C                     MOVELWN0005    WJEDAA           MS Tariff Class
     C                     MOVELWN0006    WJP3NA           MS Item Descrip
     C                     Z-ADDWN0007    WJEDC7           MS MEX Comparis
     C                     Z-ADDWN0008    WJO6DT           MS Invoice Date
     C                     Z-ADDWN0009    WJO7DT           MS Shipment Dat
     C                     MOVELWN0010    WJNVSX           MS Terms of Sal
     C                     Z-ADDWN0011    WJO8DT           MS Payment Date
     C                     MOVELWN0012    WJCNT1           MS Destination
     C                     MOVELWN0013    WJCOT1           MS Bill To Name
     C                     MOVELWN0014    WJEEAA           MS Related Clie
     C                     Z-ADDWN0015    WJETPR           MS Invoice Amou
     C                     Z-ADDWN0016    WJJRWG           MS Weight Bille
     C                     MOVELWN0017    WJEFAA           MS Exchange Rat
     C                     MOVELWN0018    WJEGAA           MS Conversion F
     C                     Z-ADDWN0019    WJEUPR           MS Unit Price
     C                     Z-ADDWN0020    WJEVPR           MS Rebates
     C                     Z-ADDWN0021    WJEWPR           MS Packing Labo
     C                     Z-ADDWN0022    WJEXPR           MS Packing Mate
     C                     Z-ADDWN0023    WJEYPR           MS Credit Exp
     C                     MOVELWN0024    WJEZPR           MS Garranties E
     C                     Z-ADDWN0025    WJE0PR           MS Commission E
     C                     Z-ADDWN0026    WJE1PR           MS Handling Exp
     C                     Z-ADDWN0027    WJE2PR           MS Export Handl
     C                     Z-ADDWN0028    WJE3PR           MS USA Freight
     C                     Z-ADDWN0029    WJFFPR           MS USA Ocean Fr
     C                     MOVELWN0030    WJE4PR           MS USA Insuranc
     C                     MOVELWN0031    WJEHAA           MS MEX Freight
     C                     Z-ADDWN0032    WJE9PR           MS Quality Adj
     C                     MOVELWN0033    WJEIAA           MS MEX Insuranc
     C                     Z-ADDWN0034    WJFAPR           MS Taxes Adj
     C                     Z-ADDWN0035    WJE5PR           MS USDA Documen
     C                     Z-ADDWN0036    WJFBPR           MS Physical Adj
     C                     Z-ADDWN0037    WJFCPR           MS Other Adj
     C                     Z-ADDWN0038    WJE6PR           MS Total Adj
     C                     Z-ADDWN0039    WJE7PR           MS Total Adj US
     C                     Z-ADDWN0040    WJE8PR           MS Net Price US
     C                     MOVELWN0041    WJEJAA           MS Exchange Rat
     C                     MOVELWN0042    WJNZSX           MS Direct/Indir
      *
     C           KLCRSJ    KLIST
     C                     KFLD           WJEKAA           MS Country Code
     C                     KFLD           WJECC7           MS Item Code
     C                     KFLD           WJTNNX           MS Invoice Numb
     C                     KFLD           WJTONX           MS Item Seq
      * Check for duplicate primary key
     C           KLCRSJ    SETLL@CGCPO0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3193' W0RTN   7
      * Send message 'MEX Sales              EX'
     C                     MOVEL'USR3193' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C                     WRITE@CGCPO0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Item Existance    RT - MEX Sales  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKEKAA    WQSK01           MS Country Code
     C           *LIKE     DEFN WKECC7    WQSK02           MS Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           MS Country Code
     C                     KFLD           WQSK02           MS Item Code
      * Setup key
     C                     MOVELP1UMCD    WQSK01           MS Country Code
     C                     Z-ADDWAEBC7    WQSK02           MS Item Code
      * Establish starting position
     C           KRSSK     SETLL@CGCPO1                    *
     C           KRSSK     READE@CGCPO1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3192' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    YL0016           Return Code Usr
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    YL0016           Return Code Usr
     C                     MOVEL'RCDFND'  YL0016           Return Code Usr
     C                     GOTO SKEXIT                     *QUIT
     C           KRSSK     READE@CGCPO1                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  2003 PERIOD OF INVESTIGATION
      *================================================================
      * FROM DATE = 1020401
      * TO DATE   = 1020930
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * DOC:  2004 PERIOD OF INVESTIGATION
      *================================================================
      * FROM DATE = 1010101
      * TO DATE   = 1031231
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAD9C7           MI Item Code
     C                     Z-ADD*ZERO     WAESPR           MI Pkg Mtrl Cos
     C                     Z-ADD*ZERO     WAFEPR           MI Pkg Labor Co
     C                     Z-ADD*ZERO     WAEAC7           MI USA-MEX Item
     C                     Z-ADD*ZERO     WAEBC7           MI JPN-MEX Item
     C                     Z-ADD*ZERO     WAFGPR           MI USA Claim Ad
     C                     Z-ADD*ZERO     WAFHPR           MI MEX Claim Ad
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBDPNB           Order Sequence
     C                     Z-ADD*ZERO     WBUENB           Order Secondary
     C                     Z-ADD*ZERO     WBBTC7           Parent Customer
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBORIT           Original Item
     C                     Z-ADD*ZERO     WBAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WBD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WBCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WBAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WBAKPR           Unit Price
     C                     Z-ADD*ZERO     WBAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WBAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WBAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WBAYVA           Extended Amount
     C                     Z-ADD*ZERO     WBL6NB           Contract Number
     C                     Z-ADD*ZERO     WBHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WBESNB           Accounting Year
     C                     Z-ADD*ZERO     WBETNB           Accounting Peri
     C                     Z-ADD*ZERO     WBBZNB           OM Week
     C                     Z-ADD*ZERO     WBEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WBBYWG           Weight Billed
     C                     Z-ADD*ZERO     WBS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WBMAVA           Billing Detail
     C                     Z-ADD*ZERO     WBKDVA           Billing Detail
     C                     Z-ADD*ZERO     WBUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WBUTVA           Standard Overag
     C                     Z-ADD*ZERO     WBA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WBCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WBR8NB           Original Order
     C                     Z-ADD*ZERO     WBBZPR           Price Overage O
     C                     Z-ADD*ZERO     WBEXDT           Market Pricing
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBONVA           Actual Freight
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WBULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WBUNVA           Automatic Accru
     C                     Z-ADD*ZERO     WBUOVA           Non Automatic A
     C                     Z-ADD*ZERO     WBUPVA           Financials Amou
     C                     Z-ADD*ZERO     WBUQVA           Financials Amou
     C                     Z-ADD*ZERO     WBCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WBDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WBB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WBIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WBIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WBNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WBBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WBA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WBCDPR           Market Value
     C                     Z-ADD*ZERO     WBD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WBD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WBCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WBOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WBD9PR           HST Unused Pric
     C                     Z-ADD*ZERO     WBCFVL           HST Item Target
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WDAIVA           Adjustment Amou
     C                     Z-ADD*ZERO     WDAOVA           Amount Paid
     C                     Z-ADD*ZERO     WDBGVA           Remaining Balan
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDCAC7           Order Number Re
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WDATDT           Due Date
     C                     Z-ADD*ZERO     WDH0DT           Last Payment Da
     C                     Z-ADD*ZERO     WDH3DT           Unused Date Cod
     C                     Z-ADD*ZERO     WDH4DT           Paid in Full Da
     C                     Z-ADD*ZERO     WDH5DT           Last G/L Post D
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBSDY           Days to Pay
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Unused Date
     C                     Z-ADD*ZERO     WENPDT           OH Unused Date
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBQTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           OH Unused Nbr 1
     C                     Z-ADD*ZERO     WEH1NX           OH Unused Nbr 2
     C                     Z-ADD*ZERO     WEH2NX           OH Unused Nbr 3
     C                     Z-ADD*ZERO     WEH3NX           OH Unused Nbr 4
     C                     Z-ADD*ZERO     WEH4NX           OH Unused Nbr 5
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFC5VL           LFC Amount
     C                     Z-ADD*ZERO     WFMJDT           Create Date
     C                     Z-ADD*ZERO     WFBETM           Create Time
     C                     Z-ADD*ZERO     WFMKDT           Change Date
     C                     Z-ADD*ZERO     WFBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGFDPR           MLC Cost /LB
      * Define work field ED Consignor Addr 1
     C                     MOVEL*BLANK    WUPVTX 40
      * Define work field ED Consignor Addr 2
     C                     MOVEL*BLANK    WUPWTX 40
      * Define work field ED Consignor Addr 3
     C                     MOVEL*BLANK    WURVTX 40
      * Define work field ED Consignee Name
     C                     MOVEL*BLANK    WURHTX 40
      * Define work field ED Consignee Addr 1
     C                     MOVEL*BLANK    WURITX 40
      * Define work field ED Consignee Addr 2
     C                     MOVEL*BLANK    WURJTX 40
      * Define work field ED Consignee Addr 3
     C                     MOVEL*BLANK    WUSCTX 40
      * Define work field ED Consignee Addr 4
     C                     MOVEL*BLANK    WUSDTX 40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHABNX           ED Can. Import
     C                     Z-ADD*ZERO     WHACNX           ED Can. Import
     C                     Z-ADD*ZERO     WHADNX           ED Seaboard Pla
     C                     Z-ADD*ZERO     WHAHNX           ED Plant Contac
     C                     Z-ADD*ZERO     WHAINX           ED Nbr of prods
     C                     Z-ADD*ZERO     WHA7VL           ED Total Unit P
     C                     Z-ADD*ZERO     WHA8VL           ED Invoice Tota
     C                     Z-ADD*ZERO     WHHRWG           ED Total Net We
     C                     Z-ADD*ZERO     WHBIVL           ED Total Net We
     C                     Z-ADD*ZERO     WHK2QT           ED Nbr of Packa
     C                     Z-ADD*ZERO     WHHSWG           ED Total Gross
     C                     Z-ADD*ZERO     WHBJVL           ED Total Gross
     C                     Z-ADD*ZERO     WHMQDT           ED Export Certi
     C                     Z-ADD*ZERO     WHMRDT           ED Sail Date
     C                     Z-ADD*ZERO     WHMSDT           ED Sworn on Dat
     C                     Z-ADD*ZERO     WHAJNX           ED Unused Nbr
     C                     Z-ADD*ZERO     WHPADT           ED Document Dat
     C                     Z-ADD*ZERO     WHPBDT           ED Packing Date
     C                     Z-ADD*ZERO     WHPCDT           ED Expiration D
     C                     Z-ADD*ZERO     WHPDDT           ED Unused Date
     C                     Z-ADD*ZERO     WHPEDT           ED Unused Date
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIECC7           MS Item Code
     C                     Z-ADD*ZERO     WITNNX           MS Invoice Numb
     C                     Z-ADD*ZERO     WITONX           MS Item Seq
     C                     Z-ADD*ZERO     WIEDC7           MS MEX Comparis
     C                     Z-ADD*ZERO     WIO6DT           MS Invoice Date
     C                     Z-ADD*ZERO     WIO7DT           MS Shipment Dat
     C                     Z-ADD*ZERO     WIO8DT           MS Payment Date
     C                     Z-ADD*ZERO     WIETPR           MS Invoice Amou
     C                     Z-ADD*ZERO     WIJRWG           MS Weight Bille
     C                     Z-ADD*ZERO     WIEUPR           MS Unit Price
     C                     Z-ADD*ZERO     WIEVPR           MS Rebates
     C                     Z-ADD*ZERO     WIEWPR           MS Packing Labo
     C                     Z-ADD*ZERO     WIEXPR           MS Packing Mate
     C                     Z-ADD*ZERO     WIEYPR           MS Credit Exp
     C                     Z-ADD*ZERO     WIE0PR           MS Commission E
     C                     Z-ADD*ZERO     WIE1PR           MS Handling Exp
     C                     Z-ADD*ZERO     WIE2PR           MS Export Handl
     C                     Z-ADD*ZERO     WIE3PR           MS USA Freight
     C                     Z-ADD*ZERO     WIFFPR           MS USA Ocean Fr
     C                     Z-ADD*ZERO     WIE9PR           MS Quality Adj
     C                     Z-ADD*ZERO     WIFAPR           MS Taxes Adj
     C                     Z-ADD*ZERO     WIE5PR           MS USDA Documen
     C                     Z-ADD*ZERO     WIFBPR           MS Physical Adj
     C                     Z-ADD*ZERO     WIFCPR           MS Other Adj
     C                     Z-ADD*ZERO     WIE6PR           MS Total Adj
     C                     Z-ADD*ZERO     WIE7PR           MS Total Adj US
     C                     Z-ADD*ZERO     WIE8PR           MS Net Price US
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB10 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB09 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB08 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB07 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB06 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB05 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  1
     C                     Z-ADD*ZERO     WL0006  70
      * Define local work field MI Item Code
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Export Country Code
     C                     MOVEL*BLANK    YL0002  6
      * Define local work field Record Found USR
     C                     MOVEL*BLANK    YL0003  1
      * Define local work field Actual Shipped Date
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field MI 6 Mo Sold to MEX
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field MI USA Claim Adj
     C                     Z-ADD*ZERO     YL0006 114
      * Define local work field MI MEX Claim Adj
     C                     Z-ADD*ZERO     YL0007 114
      * Define local work field Days to Pay
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0009  72
      * Define local work field LFC Amount
     C                     Z-ADD*ZERO     YL0010  72
      * Define local work field Carrier Rate
     C                     Z-ADD*ZERO     YL0011 114
      * Define local work field Actual Freight Amount
     C                     Z-ADD*ZERO     YL0012 112
      * Define local work field Days
     C                     Z-ADD*ZERO     YL0013  50
      * Define local work field ED Consignor Name
     C                     MOVEL*BLANK    YL0014 40
      * Define local work field Text USR 8
     C                     MOVEL*BLANK    YL0015  8
      * Define local work field Return Code Usr
     C                     MOVEL*BLANK    YL0016  7
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Guymon OK
