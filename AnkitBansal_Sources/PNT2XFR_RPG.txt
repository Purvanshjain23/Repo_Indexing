     H/TITLE Exc Gen RIN SEP Trans XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/06/19  Time  : 13:59:45
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPMDACPL7IF  E           K        DISK
      * RSQ : COA Batch Header RIN      TrnDt/TrnTm,SlU>
      *
     FPMDACPLEIF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/ULSD CMP/BATCH/S/Sc(D
      *
     FPMDACPL1IF  E           K        DISK
      * RTV : COA Batch Header RIN      Retrieval index
      *
     FPMDACPLNIF  E           K        DISK
      * RSQ : COA Batch Header RIN      Co/ULSD/TrnDt/TrnTm,SlU>
      *
     FPMDACPL0UF  E           K        DISK                      A
      * UPD : COA Batch Header RIN      Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@DACPP5
      * COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WAAIC3
     I              DAL6T1                          WAL6T1
     I              DAI3NY                          WAI3NY
     I              DAJYNY                          WAJYNY
     I              DAQ1NY                          WAQ1NY
     I              DAMUT1                          WAMUT1
     I              DAJZNY                          WAJZNY
     I              DAJ0NY                          WAJ0NY
     I              DAJ2NY                          WAJ2NY
     I              DARIDT                          WARIDT
     I              DAC5TM                          WAC5TM
     I              DAMVT1                          WAMVT1
     I              DAMWT1                          WAMWT1
     I              DARINT                          WARINT
     I              DARJDT                          WARJDT
     I              DAC6TM                          WAC6TM
     I              DAC4NB                          WAC4NB
     I              DADPNB                          WADPNB
     I              DAUENB                          WAUENB
     I              DARZNB                          WARZNB
     I              DANGT1                          WANGT1
     I              DARMNB                          WARMNB
     I              DARKDT                          WARKDT
     I              DAC7TM                          WAC7TM
     I              DARINS                          WARINS
     I              DAMXT1                          WAMXT1
     I              DAG3ST                          WAG3ST
     I              DAQWNY                          WAQWNY
     I              DAL0AA                          WAL0AA
     I              DAMAT1                          WAMAT1
     I              DATDNA                          WATDNA
     I              DACWC3                          WACWC3
     I              DAQXNY                          WAQXNY
     I              DAQZNY                          WAQZNY
     I              DAQ0NY                          WAQ0NY
     I              DALVTX                          WALVTX
     I              DANYT1                          WANYT1
     I              DAG5ST                          WAG5ST
     I              DAG7ST                          WAG7ST
     I              DATFDT                          WATFDT
     I              DATGDT                          WATGDT
     I              DAWIT1                          WAWIT1
     I              DAQYNY                          WAQYNY
     I              DAL7T1                          WAL7T1
     I              DAR8NY                          WAR8NY
     I              DAR0NY                          WAR0NY
     I              DAI7AA                          WAI7AA
     I              DAMXAA                          WAMXAA
     I              DAMSAA                          WAMSAA
     I              DAR7NY                          WAR7NY
     I              DAHEPR                          WAHEPR
     I              DAHFPR                          WAHFPR
     I              DAWVT1                          WAWVT1
     I              DAW0T1                          WAW0T1
     I              DAR5NY                          WAR5NY
     I              DAW1T1                          WAW1T1
     I              DAR6NY                          WAR6NY
     I              DAJ1ST                          WAJ1ST
     I              DAKHST                          WAKHST
     I              DATWDT                          WATWDT
     I              DADUTM                          WADUTM
     I              DAKGST                          WAKGST
     I              DATVDT                          WATVDT
     I              DADTTM                          WADTTM
     I              DAR9NY                          WAR9NY
     I              DASQNY                          WASQNY
     I              DABHR3                          WABHR3
     I              DASRNY                          WASRNY
     I              DAW7T1                          WAW7T1
     I              DAW8T1                          WAW8T1
     I              DAT2DT                          WAT2DT
     I              DASXNY                          WASXNY
     I              DASYNY                          WASYNY
     I              DASZNY                          WASZNY
     I              DAVSST                          WAVSST
     I              DAMJDT                          WAMJDT
     I              DABETM                          WABETM
     I              DACCVN                          WACCVN
     I              DACDVN                          WACDVN
     I              DAMKDT                          WAMKDT
     I              DABFTM                          WABFTM
     I              DACEVN                          WACEVN
     I              DACFVN                          WACFVN
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     I@DACPT1
      * COA Batch Header RIN      TrnDt/TrnTm,SlU>
      * Renamed input format fields
     I              DAAIC3                          WCAIC3
     I              DAL6T1                          WCL6T1
     I              DAI3NY                          WCI3NY
     I              DAJYNY                          WCJYNY
     I              DAQ1NY                          WCQ1NY
     I              DAMUT1                          WCMUT1
     I              DAJZNY                          WCJZNY
     I              DAJ0NY                          WCJ0NY
     I              DAJ2NY                          WCJ2NY
     I              DARIDT                          WCRIDT
     I              DAC5TM                          WCC5TM
     I              DAMVT1                          WCMVT1
     I              DAMWT1                          WCMWT1
     I              DARINT                          WCRINT
     I              DARJDT                          WCRJDT
     I              DAC6TM                          WCC6TM
     I              DAC4NB                          WCC4NB
     I              DADPNB                          WCDPNB
     I              DAUENB                          WCUENB
     I              DARZNB                          WCRZNB
     I              DANGT1                          WCNGT1
     I              DARMNB                          WCRMNB
     I              DARKDT                          WCRKDT
     I              DAC7TM                          WCC7TM
     I              DARINS                          WCRINS
     I              DAMXT1                          WCMXT1
     I              DAG3ST                          WCG3ST
     I              DAQWNY                          WCQWNY
     I              DAL0AA                          WCL0AA
     I              DAMAT1                          WCMAT1
     I              DATDNA                          WCTDNA
     I              DACWC3                          WCCWC3
     I              DAQXNY                          WCQXNY
     I              DAQZNY                          WCQZNY
     I              DAQ0NY                          WCQ0NY
     I              DALVTX                          WCLVTX
     I              DANYT1                          WCNYT1
     I              DAG5ST                          WCG5ST
     I              DAG7ST                          WCG7ST
     I              DATFDT                          WCTFDT
     I              DATGDT                          WCTGDT
     I              DAWIT1                          WCWIT1
     I              DAQYNY                          WCQYNY
     I              DAL7T1                          WCL7T1
     I              DAR8NY                          WCR8NY
     I              DAR0NY                          WCR0NY
     I              DAI7AA                          WCI7AA
     I              DAMXAA                          WCMXAA
     I              DAMSAA                          WCMSAA
     I              DAR7NY                          WCR7NY
     I              DAHEPR                          WCHEPR
     I              DAHFPR                          WCHFPR
     I              DAWVT1                          WCWVT1
     I              DAW0T1                          WCW0T1
     I              DAR5NY                          WCR5NY
     I              DAW1T1                          WCW1T1
     I              DAR6NY                          WCR6NY
     I              DAJ1ST                          WCJ1ST
     I              DAKHST                          WCKHST
     I              DATWDT                          WCTWDT
     I              DADUTM                          WCDUTM
     I              DAKGST                          WCKGST
     I              DATVDT                          WCTVDT
     I              DADTTM                          WCDTTM
     I              DAR9NY                          WCR9NY
     I              DASQNY                          WCSQNY
     I              DABHR3                          WCBHR3
     I              DASRNY                          WCSRNY
     I              DAW7T1                          WCW7T1
     I              DAW8T1                          WCW8T1
     I              DAT2DT                          WCT2DT
     I              DASXNY                          WCSXNY
     I              DASYNY                          WCSYNY
     I              DASZNY                          WCSZNY
     I              DAVSST                          WCVSST
     I              DAMJDT                          WCMJDT
     I              DABETM                          WCBETM
     I              DACCVN                          WCCCVN
     I              DACDVN                          WCCDVN
     I              DAMKDT                          WCMKDT
     I              DABFTM                          WCBFTM
     I              DACEVN                          WCCEVN
     I              DACFVN                          WCCFVN
      *
     I@DACPED
      * COA Batch Header RIN      Co/ULSD CMP/BATCH/S/Sc(D
      * Renamed input format fields
     I              DAAIC3                          WDAIC3
     I              DAL6T1                          WDL6T1
     I              DAI3NY                          WDI3NY
     I              DAJYNY                          WDJYNY
     I              DAQ1NY                          WDQ1NY
     I              DAMUT1                          WDMUT1
     I              DAJZNY                          WDJZNY
     I              DAJ0NY                          WDJ0NY
     I              DAJ2NY                          WDJ2NY
     I              DARIDT                          WDRIDT
     I              DAC5TM                          WDC5TM
     I              DAMVT1                          WDMVT1
     I              DAMWT1                          WDMWT1
     I              DARINT                          WDRINT
     I              DARJDT                          WDRJDT
     I              DAC6TM                          WDC6TM
     I              DAC4NB                          WDC4NB
     I              DADPNB                          WDDPNB
     I              DAUENB                          WDUENB
     I              DARZNB                          WDRZNB
     I              DANGT1                          WDNGT1
     I              DARMNB                          WDRMNB
     I              DARKDT                          WDRKDT
     I              DAC7TM                          WDC7TM
     I              DARINS                          WDRINS
     I              DAMXT1                          WDMXT1
     I              DAG3ST                          WDG3ST
     I              DAQWNY                          WDQWNY
     I              DAL0AA                          WDL0AA
     I              DAMAT1                          WDMAT1
     I              DATDNA                          WDTDNA
     I              DACWC3                          WDCWC3
     I              DAQXNY                          WDQXNY
     I              DAQZNY                          WDQZNY
     I              DAQ0NY                          WDQ0NY
     I              DALVTX                          WDLVTX
     I              DANYT1                          WDNYT1
     I              DAG5ST                          WDG5ST
     I              DAG7ST                          WDG7ST
     I              DATFDT                          WDTFDT
     I              DATGDT                          WDTGDT
     I              DAWIT1                          WDWIT1
     I              DAQYNY                          WDQYNY
     I              DAL7T1                          WDL7T1
     I              DAR8NY                          WDR8NY
     I              DAR0NY                          WDR0NY
     I              DAI7AA                          WDI7AA
     I              DAMXAA                          WDMXAA
     I              DAMSAA                          WDMSAA
     I              DAR7NY                          WDR7NY
     I              DAHEPR                          WDHEPR
     I              DAHFPR                          WDHFPR
     I              DAWVT1                          WDWVT1
     I              DAW0T1                          WDW0T1
     I              DAR5NY                          WDR5NY
     I              DAW1T1                          WDW1T1
     I              DAR6NY                          WDR6NY
     I              DAJ1ST                          WDJ1ST
     I              DAKHST                          WDKHST
     I              DATWDT                          WDTWDT
     I              DADUTM                          WDDUTM
     I              DAKGST                          WDKGST
     I              DATVDT                          WDTVDT
     I              DADTTM                          WDDTTM
     I              DAR9NY                          WDR9NY
     I              DASQNY                          WDSQNY
     I              DABHR3                          WDBHR3
     I              DASRNY                          WDSRNY
     I              DAW7T1                          WDW7T1
     I              DAW8T1                          WDW8T1
     I              DAT2DT                          WDT2DT
     I              DASXNY                          WDSXNY
     I              DASYNY                          WDSYNY
     I              DASZNY                          WDSZNY
     I              DAVSST                          WDVSST
     I              DAMJDT                          WDMJDT
     I              DABETM                          WDBETM
     I              DACCVN                          WDCCVN
     I              DACDVN                          WDCDVN
     I              DAMKDT                          WDMKDT
     I              DABFTM                          WDBFTM
     I              DACEVN                          WDCEVN
     I              DACFVN                          WDCFVN
      *
     I@DACPP6
      * COA Batch Header RIN      Retrieval index
      * Renamed input format fields
     I              DAAIC3                          WEAIC3
     I              DAL6T1                          WEL6T1
     I              DAI3NY                          WEI3NY
     I              DAJYNY                          WEJYNY
     I              DAQ1NY                          WEQ1NY
     I              DAMUT1                          WEMUT1
     I              DAJZNY                          WEJZNY
     I              DAJ0NY                          WEJ0NY
     I              DAJ2NY                          WEJ2NY
     I              DARIDT                          WERIDT
     I              DAC5TM                          WEC5TM
     I              DAMVT1                          WEMVT1
     I              DAMWT1                          WEMWT1
     I              DARINT                          WERINT
     I              DARJDT                          WERJDT
     I              DAC6TM                          WEC6TM
     I              DAC4NB                          WEC4NB
     I              DADPNB                          WEDPNB
     I              DAUENB                          WEUENB
     I              DARZNB                          WERZNB
     I              DANGT1                          WENGT1
     I              DARMNB                          WERMNB
     I              DARKDT                          WERKDT
     I              DAC7TM                          WEC7TM
     I              DARINS                          WERINS
     I              DAMXT1                          WEMXT1
     I              DAG3ST                          WEG3ST
     I              DAQWNY                          WEQWNY
     I              DAL0AA                          WEL0AA
     I              DAMAT1                          WEMAT1
     I              DATDNA                          WETDNA
     I              DACWC3                          WECWC3
     I              DAQXNY                          WEQXNY
     I              DAQZNY                          WEQZNY
     I              DAQ0NY                          WEQ0NY
     I              DALVTX                          WELVTX
     I              DANYT1                          WENYT1
     I              DAG5ST                          WEG5ST
     I              DAG7ST                          WEG7ST
     I              DATFDT                          WETFDT
     I              DATGDT                          WETGDT
     I              DAWIT1                          WEWIT1
     I              DAQYNY                          WEQYNY
     I              DAL7T1                          WEL7T1
     I              DAR8NY                          WER8NY
     I              DAR0NY                          WER0NY
     I              DAI7AA                          WEI7AA
     I              DAMXAA                          WEMXAA
     I              DAMSAA                          WEMSAA
     I              DAR7NY                          WER7NY
     I              DAHEPR                          WEHEPR
     I              DAHFPR                          WEHFPR
     I              DAWVT1                          WEWVT1
     I              DAW0T1                          WEW0T1
     I              DAR5NY                          WER5NY
     I              DAW1T1                          WEW1T1
     I              DAR6NY                          WER6NY
     I              DAJ1ST                          WEJ1ST
     I              DAKHST                          WEKHST
     I              DATWDT                          WETWDT
     I              DADUTM                          WEDUTM
     I              DAKGST                          WEKGST
     I              DATVDT                          WETVDT
     I              DADTTM                          WEDTTM
     I              DAR9NY                          WER9NY
     I              DASQNY                          WESQNY
     I              DABHR3                          WEBHR3
     I              DASRNY                          WESRNY
     I              DAW7T1                          WEW7T1
     I              DAW8T1                          WEW8T1
     I              DAT2DT                          WET2DT
     I              DASXNY                          WESXNY
     I              DASYNY                          WESYNY
     I              DASZNY                          WESZNY
     I              DAVSST                          WEVSST
     I              DAMJDT                          WEMJDT
     I              DABETM                          WEBETM
     I              DACCVN                          WECCVN
     I              DACDVN                          WECDVN
     I              DAMKDT                          WEMKDT
     I              DABFTM                          WEBFTM
     I              DACEVN                          WECEVN
     I              DACFVN                          WECFVN
      *
     I@DACPDI
      * COA Batch Header RIN      Co/ULSD/TrnDt/TrnTm,SlU>
      * Renamed input format fields
     I              DAAIC3                          WFAIC3
     I              DAL6T1                          WFL6T1
     I              DAI3NY                          WFI3NY
     I              DAJYNY                          WFJYNY
     I              DAQ1NY                          WFQ1NY
     I              DAMUT1                          WFMUT1
     I              DAJZNY                          WFJZNY
     I              DAJ0NY                          WFJ0NY
     I              DAJ2NY                          WFJ2NY
     I              DARIDT                          WFRIDT
     I              DAC5TM                          WFC5TM
     I              DAMVT1                          WFMVT1
     I              DAMWT1                          WFMWT1
     I              DARINT                          WFRINT
     I              DARJDT                          WFRJDT
     I              DAC6TM                          WFC6TM
     I              DAC4NB                          WFC4NB
     I              DADPNB                          WFDPNB
     I              DAUENB                          WFUENB
     I              DARZNB                          WFRZNB
     I              DANGT1                          WFNGT1
     I              DARMNB                          WFRMNB
     I              DARKDT                          WFRKDT
     I              DAC7TM                          WFC7TM
     I              DARINS                          WFRINS
     I              DAMXT1                          WFMXT1
     I              DAG3ST                          WFG3ST
     I              DAQWNY                          WFQWNY
     I              DAL0AA                          WFL0AA
     I              DAMAT1                          WFMAT1
     I              DATDNA                          WFTDNA
     I              DACWC3                          WFCWC3
     I              DAQXNY                          WFQXNY
     I              DAQZNY                          WFQZNY
     I              DAQ0NY                          WFQ0NY
     I              DALVTX                          WFLVTX
     I              DANYT1                          WFNYT1
     I              DAG5ST                          WFG5ST
     I              DAG7ST                          WFG7ST
     I              DATFDT                          WFTFDT
     I              DATGDT                          WFTGDT
     I              DAWIT1                          WFWIT1
     I              DAQYNY                          WFQYNY
     I              DAL7T1                          WFL7T1
     I              DAR8NY                          WFR8NY
     I              DAR0NY                          WFR0NY
     I              DAI7AA                          WFI7AA
     I              DAMXAA                          WFMXAA
     I              DAMSAA                          WFMSAA
     I              DAR7NY                          WFR7NY
     I              DAHEPR                          WFHEPR
     I              DAHFPR                          WFHFPR
     I              DAWVT1                          WFWVT1
     I              DAW0T1                          WFW0T1
     I              DAR5NY                          WFR5NY
     I              DAW1T1                          WFW1T1
     I              DAR6NY                          WFR6NY
     I              DAJ1ST                          WFJ1ST
     I              DAKHST                          WFKHST
     I              DATWDT                          WFTWDT
     I              DADUTM                          WFDUTM
     I              DAKGST                          WFKGST
     I              DATVDT                          WFTVDT
     I              DADTTM                          WFDTTM
     I              DAR9NY                          WFR9NY
     I              DASQNY                          WFSQNY
     I              DABHR3                          WFBHR3
     I              DASRNY                          WFSRNY
     I              DAW7T1                          WFW7T1
     I              DAW8T1                          WFW8T1
     I              DAT2DT                          WFT2DT
     I              DASXNY                          WFSXNY
     I              DASYNY                          WFSYNY
     I              DASZNY                          WFSZNY
     I              DAVSST                          WFVSST
     I              DAMJDT                          WFMJDT
     I              DABETM                          WFBETM
     I              DACCVN                          WFCCVN
     I              DACDVN                          WFCDVN
     I              DAMKDT                          WFMKDT
     I              DABFTM                          WFBFTM
     I              DACEVN                          WFCEVN
     I              DACFVN                          WFCFVN
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPMDA1    E DSPMDACPL0
      * UPD : COA Batch Header RIN      Update index
      * Renamed input format fields
     I              DAAIC3                          WAAIC3
     I              DAL6T1                          WAL6T1
     I              DAI3NY                          WAI3NY
     I              DAJYNY                          WAJYNY
     I              DAQ1NY                          WAQ1NY
     I              DAMUT1                          WAMUT1
     I              DAJZNY                          WAJZNY
     I              DAJ0NY                          WAJ0NY
     I              DAJ2NY                          WAJ2NY
     I              DARIDT                          WARIDT
     I              DAC5TM                          WAC5TM
     I              DAMVT1                          WAMVT1
     I              DAMWT1                          WAMWT1
     I              DARINT                          WARINT
     I              DARJDT                          WARJDT
     I              DAC6TM                          WAC6TM
     I              DAC4NB                          WAC4NB
     I              DADPNB                          WADPNB
     I              DAUENB                          WAUENB
     I              DARZNB                          WARZNB
     I              DANGT1                          WANGT1
     I              DARMNB                          WARMNB
     I              DARKDT                          WARKDT
     I              DAC7TM                          WAC7TM
     I              DARINS                          WARINS
     I              DAMXT1                          WAMXT1
     I              DAG3ST                          WAG3ST
     I              DAQWNY                          WAQWNY
     I              DAL0AA                          WAL0AA
     I              DAMAT1                          WAMAT1
     I              DATDNA                          WATDNA
     I              DACWC3                          WACWC3
     I              DAQXNY                          WAQXNY
     I              DAQZNY                          WAQZNY
     I              DAQ0NY                          WAQ0NY
     I              DALVTX                          WALVTX
     I              DANYT1                          WANYT1
     I              DAG5ST                          WAG5ST
     I              DAG7ST                          WAG7ST
     I              DATFDT                          WATFDT
     I              DATGDT                          WATGDT
     I              DAWIT1                          WAWIT1
     I              DAQYNY                          WAQYNY
     I              DAL7T1                          WAL7T1
     I              DAR8NY                          WAR8NY
     I              DAR0NY                          WAR0NY
     I              DAI7AA                          WAI7AA
     I              DAMXAA                          WAMXAA
     I              DAMSAA                          WAMSAA
     I              DAR7NY                          WAR7NY
     I              DAHEPR                          WAHEPR
     I              DAHFPR                          WAHFPR
     I              DAWVT1                          WAWVT1
     I              DAW0T1                          WAW0T1
     I              DAR5NY                          WAR5NY
     I              DAW1T1                          WAW1T1
     I              DAR6NY                          WAR6NY
     I              DAJ1ST                          WAJ1ST
     I              DAKHST                          WAKHST
     I              DATWDT                          WATWDT
     I              DADUTM                          WADUTM
     I              DAKGST                          WAKGST
     I              DATVDT                          WATVDT
     I              DADTTM                          WADTTM
     I              DAR9NY                          WAR9NY
     I              DASQNY                          WASQNY
     I              DABHR3                          WABHR3
     I              DASRNY                          WASRNY
     I              DAW7T1                          WAW7T1
     I              DAW8T1                          WAW8T1
     I              DAT2DT                          WAT2DT
     I              DASXNY                          WASXNY
     I              DASYNY                          WASYNY
     I              DASZNY                          WASZNY
     I              DAVSST                          WAVSST
     I              DAMJDT                          WAMJDT
     I              DABETM                          WABETM
     I              DACCVN                          WACCVN
     I              DACDVN                          WACDVN
     I              DAMKDT                          WAMKDT
     I              DABFTM                          WABFTM
     I              DACEVN                          WACEVN
     I              DACFVN                          WACFVN
      *
     IYARDCS      DS                            563
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            563
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: COA Batch Header RIN
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  COA ULSD Company #
     I                                        3   6 P1L6T1
      * I :  COA Batch Number
     I                                    P   7   90P1I3NY
      * I :  COA Batch Header RIN Seq
     I                                    P  10  120P1JYNY
      * I :  COA Batch Hdr RIN Seq Sec
     I                                    P  13  150P1Q1NY
      * I :  COA Batch Header RIN
     I                                       16  53 P1MUT1
      * I :  COA RIN SSSSSSSS
     I                                    P  54  580P1JZNY
      * I :  COA RIN EEEEEEEE
     I                                    P  59  630P1J0NY
      * I :  COA RIN Volume in Gallons
     I                                    P  64  680P1J2NY
      * I :  COA RIN Trans Partner Nm
     I                                       69  98 P1MVT1
      * I :  COA RIN Trans Partner Id
     I                                       99 102 P1MWT1
      * I :  Order Number
     I                                    P 103 1060P1C4NB
      * I :  Order Sequence Number
     I                                    P 107 1080P1DPNB
      * I :  Order Secondary Line Seq
     I                                    P 109 1100P1UENB
      * I :  Case Sequence Number
     I                                    P 111 1130P1RZNB
      * I :  COA Rail Car
     I                                      114 128 P1NGT1
      * I :  Load ID
     I                                    P 129 1320P1RMNB
      * I :  COA Date of 1st Load
     I                                    P 133 1360P1RKDT
      * I :  COA RIN Unused Time
     I                                    P 137 1400P1C7TM
      * I :  COA RIN Modified Sts
     I                                      141 141 P1RINS
      * I :  COA RIN Unused Text
     I                                      142 166 P1MXT1
      * I :  COA RIN SoldFull/Splt Sts
     I                                      167 167 P1G3ST
      * I :  COA RIN Gallons Sold
     I                                    P 168 1720P1QWNY
      * I :  COA Ship To Warehouse
     I                                      173 175 P1L0AA
      * I :  COA RIN Type Flag
     I                                      176 176 P1MAT1
      * I :  COA RIN Customer PO#
     I                                      177 191 P1TDNA
      * I :  COA Shipping Company
     I                                    P 192 1930P1CWC3
      * I :  COA Ref Load Id
     I                                    P 194 1970P1QXNY
      * I :  COA Reference Batch NbrNU
     I                                    P 198 2000P1QZNY
      * I :  COA Reference Btch Seq NU
     I                                    P 201 2030P1Q0NY
      * I :  RFS Compliance Period
     I                                      204 205 P1LVTX
      * I :  RFS Report Year
     I                                      206 209 P1NYT1
      * I :  COA RIN Int/Ext Company
     I                                      210 210 P1G5ST
      * I :  COA BHR Unused Sts 2
     I                                      211 212 P1G7ST
      * I :  COA BHR Net Galls to Sell
     I                                    P 213 2160P1TFDT
      * I :  COA BHR Unused Date 2
     I                                    P 217 2200P1TGDT
      * I :  COA BHR Unused Text
     I                                      221 245 P1WIT1
      * I :  COA BHR Loadout Temp
     I                                    P 246 2490P1QYNY
      * I :  COA ULSD Facility #
     I                                      250 254 P1L7T1
      * I :  COA Batch RIN Volume
     I                                    P 255 2580P1R8NY
      * I :  COA RIN Quantity
     I                                    P 259 2620P1R0NY
      * I :  RFS Transaction Type
     I                                      263 265 P1I7AA
      * I :  RFS Trans Reason Code
     I                                      266 268 P1MXAA
      * I :  RFS Fuel Code
     I                                      269 269 P1MSAA
      * I :  COA BHR RIN Gen Year
     I                                    P 270 2720P1R7NY
      * I :  COA BHR RIN Price
     I                                    P 273 2762P1HEPR
      * I :  COA BHR Gallon Price
     I                                    P 277 2802P1HFPR
      * I :  COA Transaction Comment
     I                                      281 330 P1WVT1
      * I :  COA RIN Supporting Text 1
     I                                      331 355 P1W0T1
      * I :  COA RIN Supporting Nbr 1
     I                                    P 356 3590P1R5NY
      * I :  COA RIN Supporting Text 2
     I                                      360 384 P1W1T1
      * I :  COA RIN Supporting Nbr 2
     I                                    P 385 3880P1R6NY
      * I :  COA BHR RFS Version Nbr
     I                                      389 389 P1J1ST
      * I :  COA GEN EMTS Sts
     I                                      390 390 P1KHST
      * I :  COA GEN EMTS Date Sent
     I                                    P 391 3940P1TWDT
      * I :  COA GEN EMTS Time Sent
     I                                    P 395 3980P1DUTM
      * I :  COA RIN EMTS Sts
     I                                      399 399 P1KGST
      * I :  COA RIN EMTS Date Sent
     I                                    P 400 4030P1TVDT
      * I :  COA RIN EMTS Time Sent
     I                                    P 404 4070P1DTTM
      * I :  COA EMTS PTD Nbr
     I                                    P 408 4110P1R9NY
      * I :  COA EMTS Batch Nbr
     I                                    P 412 4160P1SQNY
      * I :  COA BHR Unused Sts 3
     I                                      417 418 P1BHR3
      * I :  COA BHR Unused Nbr
     I                                    P 419 4230P1SRNY
      * I :  COA EMTS Trans Id
     I                                      424 463 P1W7T1
      * I :  COA EMTS Return Code
     I                                      464 473 P1W8T1
      * I :  COA BHR Unused Date 3
     I                                    P 474 4770P1T2DT
      * I :  COA BHR RINs to Sell Sep
     I                                    P 478 4810P1SYNY
      * I :  COA Unassgnd Txfrd RINS
     I                                    P 482 4850P1SZNY
     IP2PARM      DS
      * I :  COA RIN Equivalence Valu#
     I                                    P   1   51P2J3NY
     IP3PARM      DS
      * I :  Actual Ship Date Usr
     I                                    P   1   40P3T5DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1L6T1    PARM           WP0002  4        COA ULSD Compan
     C           P1I3NY    PARM           WP0003  50       COA Batch Numbe
     C           P1JYNY    PARM           WP0004  50       COA Batch Heade
     C           P1Q1NY    PARM           WP0005  50       COA Batch Hdr R
     C           P1MUT1    PARM           WP0006 38        COA Batch Heade
     C           P1JZNY    PARM           WP0007  80       COA RIN SSSSSSS
     C           P1J0NY    PARM           WP0008  80       COA RIN EEEEEEE
     C           P1J2NY    PARM           WP0009  80       COA RIN Volume
     C           P1MVT1    PARM           WP0010 30        COA RIN Trans P
     C           P1MWT1    PARM           WP0011  4        COA RIN Trans P
     C           P1C4NB    PARM           WP0012  70       Order Number
     C           P1DPNB    PARM           WP0013  30       Order Sequence
     C           P1UENB    PARM           WP0014  30       Order Secondary
     C           P1RZNB    PARM           WP0015  50       Case Sequence N
     C           P1NGT1    PARM           WP0016 15        COA Rail Car
     C           P1RMNB    PARM           WP0017  70       Load ID
     C           P1RKDT    PARM           WP0018  70       COA Date of 1st
     C           P1C7TM    PARM           WP0019  60       COA RIN Unused
     C           P1RINS    PARM           WP0020  1        COA RIN Modifie
     C           P1MXT1    PARM           WP0021 25        COA RIN Unused
     C           P1G3ST    PARM           WP0022  1        COA RIN SoldFul
     C           P1QWNY    PARM           WP0023  80       COA RIN Gallons
     C           P1L0AA    PARM           WP0024  3        COA Ship To War
     C           P1MAT1    PARM           WP0025  1        COA RIN Type Fl
     C           P1TDNA    PARM           WP0026 15        COA RIN Custome
     C           P1CWC3    PARM           WP0027  30       COA Shipping Co
     C           P1QXNY    PARM           WP0028  70       COA Ref Load Id
     C           P1QZNY    PARM           WP0029  50       COA Reference B
     C           P1Q0NY    PARM           WP0030  50       COA Reference B
     C           P1LVTX    PARM           WP0031  2        RFS Compliance
     C           P1NYT1    PARM           WP0032  4        RFS Report Year
     C           P1G5ST    PARM           WP0033  1        COA RIN Int/Ext
     C           P1G7ST    PARM           WP0034  2        COA BHR Unused
     C           P1TFDT    PARM           WP0035  70       COA BHR Net Gal
     C           P1TGDT    PARM           WP0036  70       COA BHR Unused
     C           P1WIT1    PARM           WP0037 25        COA BHR Unused
     C           P1QYNY    PARM           WP0038  70       COA BHR Loadout
     C           P1L7T1    PARM           WP0039  5        COA ULSD Facili
     C           P1R8NY    PARM           WP0040  70       COA Batch RIN V
     C           P1R0NY    PARM           WP0041  70       COA RIN Quantit
     C           P1I7AA    PARM           WP0042  3        RFS Transaction
     C           P1MXAA    PARM           WP0043  3        RFS Trans Reaso
     C           P1MSAA    PARM           WP0044  1        RFS Fuel Code
     C           P1R7NY    PARM           WP0045  40       COA BHR RIN Gen
     C           P1HEPR    PARM           WP0046  72       COA BHR RIN Pri
     C           P1HFPR    PARM           WP0047  72       COA BHR Gallon
     C           P1WVT1    PARM           WP0048 50        COA Transaction
     C           P1W0T1    PARM           WP0049 25        COA RIN Support
     C           P1R5NY    PARM           WP0050  70       COA RIN Support
     C           P1W1T1    PARM           WP0051 25        COA RIN Support
     C           P1R6NY    PARM           WP0052  70       COA RIN Support
     C           P1J1ST    PARM           WP0053  1        COA BHR RFS Ver
     C           P1KHST    PARM           WP0054  1        COA GEN EMTS St
     C           P1TWDT    PARM           WP0055  70       COA GEN EMTS Da
     C           P1DUTM    PARM           WP0056  60       COA GEN EMTS Ti
     C           P1KGST    PARM           WP0057  1        COA RIN EMTS St
     C           P1TVDT    PARM           WP0058  70       COA RIN EMTS Da
     C           P1DTTM    PARM           WP0059  60       COA RIN EMTS Ti
     C           P1R9NY    PARM           WP0060  70       COA EMTS PTD Nb
     C           P1SQNY    PARM           WP0061  80       COA EMTS Batch
     C           P1BHR3    PARM           WP0062  2        COA BHR Unused
     C           P1SRNY    PARM           WP0063  80       COA BHR Unused
     C           P1W7T1    PARM           WP0064 40        COA EMTS Trans
     C           P1W8T1    PARM           WP0065 10        COA EMTS Return
     C           P1T2DT    PARM           WP0066  70       COA BHR Unused
     C           P1SYNY    PARM           WP0067  70       COA BHR RINs to
     C           P1SZNY    PARM           WP0068  70       COA Unassgnd Tx
     C           P2J3NY    PARM           WP0069  81       COA RIN Equival
     C           P3T5DT    PARM           WP0070  70       Actual Ship Dat
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Gen RIN SEP Trans XF
      * S14912 RMC 5/25/19 on the below, when going after the other plant
      *   go with 374-6412 then 374-4846 -- sunsetting 6412 with SE name
      * S13119 RMC 5/30/18 put the below on a switch so they can go oldes
      *    or the order's company first-use new lf pmdacpln.
      *    company value: HPBFACOLD = FAC = facilty first, OLD = oldest f
      * S12497 RMC 2/28/18 drop shipp co/ulsd co from key, get oldest fir
      *    PMDACPL7
      * R8683 RMC 1/13/17 try to get excess rins from both marketing cos.
      * E2079 RMC 5/15/12 Pass temp to rtv when creating new rcd
      * E2013 RMC 3/21/12 output act ship date as rin trans dt
      * E1868 RMC 01/03/12 All FIFO proc in EMTS - dont chk dt<12/21/11
      * E1868 RMC 12/20/11 Control FIFO proc in EMTS with GEN date<12/21/
      * C01751 RMC 9/20/11 was using the wrong company when upd leftover
      * C01641 RMC 7/13/11 was using the wrong field for the left over vo
      * E0921 8/16/10 Create RIN SEP transactions(s) for a Blender Sel fo
      *  whom HPB has been 'upstream delegated' to manage their RINs.
      *  OR Create SEL transactions for when the Rin equiv value on the o
      * Calc new volume for 1st SEP or SEL from RIN quantity / 2.5
      *   Round any dec place to next whole nmbr - so add .5 then round
      * Comp: vol at 2.5 the rins
      * LCL.AMOUNT =
      *    *COMPUTE (x1/x2)
      * x1    : PAR.COA RIN Quantity
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.COA RIN Equivalence Valu#
     C           P1R0NY    DIV  P2J3NY    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0001           AMOUNT
     C                     Z-ADDYL0001    YL0002           Decimal Places
      * chk decimal places>0
      * CASE: LCL.Decimal Places    usr is GT .00
     C           YL0002    IFGT .00                        *IF
     C                     ADD  .5        YL0001           AMOUNT
     C                     END                             *FI
     C           YL0001    MULT 1         YL0003    H      COA Batch RIN V
      * Calc Volume needed =  Orig Volume - Volume at 2.5
     C           P1R8NY    SUB  YL0003    YL0004           COA RIN Volume
      * Create 1st SEP/SEL RIN Trans from 369 Order to Blender/Reg cust
      * with per gallon price
      * ************************
      * E2013 RMC 3/21/12 output act ship date as rin trans dt
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1CWC3    WL0001           Company Number
     C                     MOVELP1L6T1    WL0002    P      COA ULSD Compan
     C                     Z-ADDP1I3NY    WL0003           COA Batch Numbe
     C                     Z-ADDP1JYNY    WL0004           COA Batch Heade
     C                     Z-ADDP1Q1NY    WL0005           COA Batch Hdr R
     C                     MOVELP1MUT1    WL0006    P      COA Batch Heade
     C                     Z-ADDP1JZNY    WL0007           COA RIN SSSSSSS
     C                     Z-ADDP1J0NY    WL0008           COA RIN EEEEEEE
     C                     Z-ADDP1J2NY    WL0009           COA RIN Volume
     C                     Z-ADDP3T5DT    WL0010           COA RIN Transac
     C                     Z-ADD##JTM     WL0011           COA RIN Transac
     C                     MOVELP1MVT1    WL0012    P      COA RIN Trans P
     C                     MOVELP1MWT1    WL0013    P      COA RIN Trans P
     C                     MOVEL*BLANK    WL0014           COA Retired RIN
     C                     Z-ADD*ZERO     WL0015           COA Retired RIN
     C                     Z-ADD*ZERO     WL0016           COA Retired RIN
     C                     Z-ADDP1C4NB    WL0017           Order Number
     C                     Z-ADDP1DPNB    WL0018           Order Sequence
     C                     Z-ADDP1UENB    WL0019           Order Secondary
     C                     Z-ADDP1RZNB    WL0020           Case Sequence N
     C                     MOVEL*BLANK    WL0021           COA Rail Car
     C                     Z-ADDP1RMNB    WL0022           Load ID
     C                     Z-ADD*ZERO     WL0023           COA Date of 1st
     C                     Z-ADD*ZERO     WL0024           COA RIN Unused
     C                     MOVEL'N'       WL0025    P      COA RIN Modifie
     C                     MOVEL*BLANK    WL0026           COA RIN Unused
     C                     MOVELP1G3ST    WL0027    P      COA RIN SoldFul
     C                     Z-ADDP1QWNY    WL0028           COA RIN Gallons
     C                     MOVELP1L0AA    WL0029    P      COA Ship To War
     C                     MOVELP1MAT1    WL0030    P      COA RIN Type Fl
     C                     MOVELP1TDNA    WL0031    P      COA RIN Custome
     C                     Z-ADDP1CWC3    WL0032           COA Shipping Co
     C                     Z-ADD*ZERO     WL0033           COA Ref Load Id
     C                     Z-ADD*ZERO     WL0034           COA Reference B
     C                     Z-ADD*ZERO     WL0035           COA Reference B
     C                     MOVELP1LVTX    WL0036    P      RFS Compliance
     C                     MOVELP1NYT1    WL0037    P      RFS Report Year
     C                     MOVELP1G5ST    WL0038    P      COA RIN Int/Ext
     C                     MOVELP1G7ST    WL0039    P      COA BHR Unused
     C                     Z-ADDP1TFDT    WL0040           COA BHR Net Gal
     C                     Z-ADDP1TGDT    WL0041           COA BHR Unused
     C                     MOVELP1WIT1    WL0042    P      COA BHR Unused
     C                     Z-ADDP1QYNY    WL0043           COA BHR Loadout
     C                     MOVELP1L7T1    WL0044    P      COA ULSD Facili
     C                     Z-ADDYL0003    WL0045           COA Batch RIN V
     C                     Z-ADDP1R0NY    WL0046           COA RIN Quantit
     C                     MOVELP1I7AA    WL0047    P      RFS Transaction
     C                     MOVELP1MXAA    WL0048    P      RFS Trans Reaso
     C                     MOVELP1MSAA    WL0049    P      RFS Fuel Code
     C                     Z-ADDP1R7NY    WL0050           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WL0051           COA BHR RIN Pri
     C                     Z-ADDP1HFPR    WL0052           COA BHR Gallon
     C                     MOVELP1WVT1    WL0053    P      COA Transaction
     C                     MOVELP1W0T1    WL0054    P      COA RIN Support
     C                     Z-ADDP1R5NY    WL0055           COA RIN Support
     C                     MOVELP1W1T1    WL0056    P      COA RIN Support
     C                     Z-ADDP1R6NY    WL0057           COA RIN Support
     C                     MOVELP1J1ST    WL0058    P      COA BHR RFS Ver
     C                     MOVELP1KHST    WL0059    P      COA GEN EMTS St
     C                     Z-ADDP1TWDT    WL0060           COA GEN EMTS Da
     C                     Z-ADDP1DUTM    WL0061           COA GEN EMTS Ti
     C                     MOVELP1KGST    WL0062    P      COA RIN EMTS St
     C                     Z-ADDP1TVDT    WL0063           COA RIN EMTS Da
     C                     Z-ADDP1DTTM    WL0064           COA RIN EMTS Ti
     C                     Z-ADDP1RMNB    WL0065           COA EMTS PTD Nb
     C                     Z-ADDP1SQNY    WL0066           COA EMTS Batch
     C                     MOVELP1BHR3    WL0067    P      COA BHR Unused
     C                     Z-ADDP1SRNY    WL0068           COA BHR Unused
     C                     MOVEL*BLANK    WL0069           COA EMTS Trans
     C                     MOVEL*BLANK    WL0070           COA EMTS Return
     C                     Z-ADDP1T2DT    WL0071           COA BHR Unused
     C                     Z-ADDP2J3NY    WL0072           COA BHR Equiv V
     C                     Z-ADD*ZERO     WL0073           COA BHR RINs to
     C                     Z-ADDP1SZNY    WL0074           COA Unassgnd Tx
     C                     MOVEL'A'       WL0075    P      Record Status
     C                     Z-ADD##JDT     WL0076           Create Date
     C                     Z-ADD##JTM     WL0077           Create Time
     C                     MOVEL##USR     WL0078    P      Create User
     C                     MOVEL##PGM     WL0079    P      Create Program
     C                     Z-ADD##JDT     WL0080           Change Date
     C                     Z-ADD##JTM     WL0081           Change Time
     C                     MOVEL##USR     WL0082    P      Change User
     C                     MOVEL##PGM     WL0083    P      Change Program
     C                     EXSR SACRRC
      * ************
      * Create More SEP RINs Trans to cover the extra volume needed
      *   Read trans with unassigned rins to sell
      *    with per gallon price also  per tom
      * CASE: LCL.COA RIN Volume New usr is GT 00000000
     C           YL0004    IFGT 0                          *IF
      * RTV Alpha Value        RT - Company Values  * 
     C                     EXSR SBRVGN
     C                     Z-ADD*ZERO     YL0006           COA BHR RIN Pri
     C                     Z-ADDP1HFPR    YL0007           COA BHR Gallon
      * CASE: LCL.HPB Facilty or Oldest is Oldest first
     C           YL0005    IFEQ 'OLD'                      *IF
      * Rtv Gen RIN SEP Trans RT - COA Batch Header RIN  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * Get from order's prod facility first, then from the other facilit
      * Rtv Gen RIN SEP Trn-CoRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1CWC3    WL0108           Company Number
     C                     MOVELP1L6T1    WL0109    P      COA ULSD Compan
     C                     Z-ADDP1I3NY    WL0110           COA Batch Numbe
     C                     Z-ADDP1JYNY    WL0111           COA Batch Heade
     C                     MOVELP1MVT1    WL0112    P      COA RIN Trans P
     C                     MOVELP1MWT1    WL0113    P      COA RIN Trans P
     C                     Z-ADDP1C4NB    WL0114           Order Number
     C                     Z-ADDP1DPNB    WL0115           Order Sequence
     C                     Z-ADDP1UENB    WL0116           Order Secondary
     C                     MOVELP1MAT1    WL0117    P      COA RIN Type Fl
     C                     MOVELP1TDNA    WL0118    P      COA RIN Custome
     C                     Z-ADDP1CWC3    WL0119           COA Shipping Co
     C                     MOVELP1NYT1    WL0120    P      RFS Report Year
     C                     Z-ADDP1QYNY    WL0121           COA BHR Loadout
     C                     MOVELP1L7T1    WL0122    P      COA ULSD Facili
     C                     MOVELP1I7AA    WL0123    P      RFS Transaction
     C                     MOVELP1MXAA    WL0124    P      RFS Trans Reaso
     C                     MOVELP1MSAA    WL0125    P      RFS Fuel Code
     C                     Z-ADDP1R7NY    WL0126           COA BHR RIN Gen
     C                     Z-ADDYL0006    WL0127           COA BHR RIN Pri
     C                     Z-ADDYL0007    WL0128           COA BHR Gallon
     C                     MOVELP1W0T1    WL0129    P      COA RIN Support
     C                     Z-ADDP1R5NY    WL0130           COA RIN Support
     C                     MOVELP1W1T1    WL0131    P      COA RIN Support
     C                     Z-ADDP1R6NY    WL0132           COA RIN Support
     C                     MOVELP1J1ST    WL0133    P      COA BHR RFS Ver
     C                     Z-ADDP1R9NY    WL0134           COA EMTS PTD Nb
     C                     Z-ADDP2J3NY    WL0135           COA RIN Equival
     C                     Z-ADDYL0004    WL0136           COA RIN Volume
     C                     Z-ADDP3T5DT    WL0137           Actual Ship Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    YL0004           COA RIN Volume
      * Get from other facility after order's facility is exhausted
      * CASE: LCL.COA RIN Volume New usr is GT 00000000
     C           YL0004    IFGT 0                          *IF
      * R8683 RMC 1/13/17 try to get excess rins from both marketing cos.
      * CASE: PAR.COA Shipping Company is HPB Biodiesel
     C           P1CWC3    IFEQ 369                        *IF
      * Rtv Gen RIN SEP Trn-CoRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD374       WL0108           Company Number
     C                     MOVEL'6412'    WL0109    P      COA ULSD Compan
     C                     Z-ADDP1I3NY    WL0110           COA Batch Numbe
     C                     Z-ADDP1JYNY    WL0111           COA Batch Heade
     C                     MOVELP1MVT1    WL0112    P      COA RIN Trans P
     C                     MOVELP1MWT1    WL0113    P      COA RIN Trans P
     C                     Z-ADDP1C4NB    WL0114           Order Number
     C                     Z-ADDP1DPNB    WL0115           Order Sequence
     C                     Z-ADDP1UENB    WL0116           Order Secondary
     C                     MOVELP1MAT1    WL0117    P      COA RIN Type Fl
     C                     MOVELP1TDNA    WL0118    P      COA RIN Custome
     C                     Z-ADDP1CWC3    WL0119           COA Shipping Co
     C                     MOVELP1NYT1    WL0120    P      RFS Report Year
     C                     Z-ADDP1QYNY    WL0121           COA BHR Loadout
     C                     MOVEL'80059'   WL0122    P      COA ULSD Facili
     C                     MOVELP1I7AA    WL0123    P      RFS Transaction
     C                     MOVELP1MXAA    WL0124    P      RFS Trans Reaso
     C                     MOVELP1MSAA    WL0125    P      RFS Fuel Code
     C                     Z-ADDP1R7NY    WL0126           COA BHR RIN Gen
     C                     Z-ADDYL0006    WL0127           COA BHR RIN Pri
     C                     Z-ADDYL0007    WL0128           COA BHR Gallon
     C                     MOVELP1W0T1    WL0129    P      COA RIN Support
     C                     Z-ADDP1R5NY    WL0130           COA RIN Support
     C                     MOVELP1W1T1    WL0131    P      COA RIN Support
     C                     Z-ADDP1R6NY    WL0132           COA RIN Support
     C                     MOVELP1J1ST    WL0133    P      COA BHR RFS Ver
     C                     Z-ADDP1R9NY    WL0134           COA EMTS PTD Nb
     C                     Z-ADDP2J3NY    WL0135           COA RIN Equival
     C                     Z-ADDYL0004    WL0136           COA RIN Volume
     C                     Z-ADDP3T5DT    WL0137           Actual Ship Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    YL0004           COA RIN Volume
      * CASE: LCL.COA RIN Volume New usr is GT 00000000
     C           YL0004    IFGT 0                          *IF
      * 8/6/19  RMC chg to 4846 and new facility
      * Rtv Gen RIN SEP Trn-CoRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD374       WL0108           Company Number
     C                     MOVEL'4846'    WL0109    P      COA ULSD Compan
     C                     Z-ADDP1I3NY    WL0110           COA Batch Numbe
     C                     Z-ADDP1JYNY    WL0111           COA Batch Heade
     C                     MOVELP1MVT1    WL0112    P      COA RIN Trans P
     C                     MOVELP1MWT1    WL0113    P      COA RIN Trans P
     C                     Z-ADDP1C4NB    WL0114           Order Number
     C                     Z-ADDP1DPNB    WL0115           Order Sequence
     C                     Z-ADDP1UENB    WL0116           Order Secondary
     C                     MOVELP1MAT1    WL0117    P      COA RIN Type Fl
     C                     MOVELP1TDNA    WL0118    P      COA RIN Custome
     C                     Z-ADDP1CWC3    WL0119           COA Shipping Co
     C                     MOVELP1NYT1    WL0120    P      RFS Report Year
     C                     Z-ADDP1QYNY    WL0121           COA BHR Loadout
     C                     MOVEL'80441'   WL0122    P      COA ULSD Facili
     C                     MOVELP1I7AA    WL0123    P      RFS Transaction
     C                     MOVELP1MXAA    WL0124    P      RFS Trans Reaso
     C                     MOVELP1MSAA    WL0125    P      RFS Fuel Code
     C                     Z-ADDP1R7NY    WL0126           COA BHR RIN Gen
     C                     Z-ADDYL0006    WL0127           COA BHR RIN Pri
     C                     Z-ADDYL0007    WL0128           COA BHR Gallon
     C                     MOVELP1W0T1    WL0129    P      COA RIN Support
     C                     Z-ADDP1R5NY    WL0130           COA RIN Support
     C                     MOVELP1W1T1    WL0131    P      COA RIN Support
     C                     Z-ADDP1R6NY    WL0132           COA RIN Support
     C                     MOVELP1J1ST    WL0133    P      COA BHR RFS Ver
     C                     Z-ADDP1R9NY    WL0134           COA EMTS PTD Nb
     C                     Z-ADDP2J3NY    WL0135           COA RIN Equival
     C                     Z-ADDYL0004    WL0136           COA RIN Volume
     C                     Z-ADDP3T5DT    WL0137           Actual Ship Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    YL0004           COA RIN Volume
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.COA Shipping Company is St Joseph HPB Marketing
     C           P1CWC3    IFEQ 374                        *IF
      * Rtv Gen RIN SEP Trn-CoRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD369       WL0108           Company Number
     C                     MOVEL'4846'    WL0109    P      COA ULSD Compan
     C                     Z-ADDP1I3NY    WL0110           COA Batch Numbe
     C                     Z-ADDP1JYNY    WL0111           COA Batch Heade
     C                     MOVELP1MVT1    WL0112    P      COA RIN Trans P
     C                     MOVELP1MWT1    WL0113    P      COA RIN Trans P
     C                     Z-ADDP1C4NB    WL0114           Order Number
     C                     Z-ADDP1DPNB    WL0115           Order Sequence
     C                     Z-ADDP1UENB    WL0116           Order Secondary
     C                     MOVELP1MAT1    WL0117    P      COA RIN Type Fl
     C                     MOVELP1TDNA    WL0118    P      COA RIN Custome
     C                     Z-ADDP1CWC3    WL0119           COA Shipping Co
     C                     MOVELP1NYT1    WL0120    P      RFS Report Year
     C                     Z-ADDP1QYNY    WL0121           COA BHR Loadout
     C                     MOVEL'82883'   WL0122    P      COA ULSD Facili
     C                     MOVELP1I7AA    WL0123    P      RFS Transaction
     C                     MOVELP1MXAA    WL0124    P      RFS Trans Reaso
     C                     MOVELP1MSAA    WL0125    P      RFS Fuel Code
     C                     Z-ADDP1R7NY    WL0126           COA BHR RIN Gen
     C                     Z-ADDYL0006    WL0127           COA BHR RIN Pri
     C                     Z-ADDYL0007    WL0128           COA BHR Gallon
     C                     MOVELP1W0T1    WL0129    P      COA RIN Support
     C                     Z-ADDP1R5NY    WL0130           COA RIN Support
     C                     MOVELP1W1T1    WL0131    P      COA RIN Support
     C                     Z-ADDP1R6NY    WL0132           COA RIN Support
     C                     MOVELP1J1ST    WL0133    P      COA BHR RFS Ver
     C                     Z-ADDP1R9NY    WL0134           COA EMTS PTD Nb
     C                     Z-ADDP2J3NY    WL0135           COA RIN Equival
     C                     Z-ADDYL0004    WL0136           COA RIN Volume
     C                     Z-ADDP3T5DT    WL0137           Actual Ship Dat
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0136    YL0004           COA RIN Volume
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If there werent enough unassigned rins to sell, increase the volu
      * CASE: LCL.COA RIN Volume New usr is GT 00000000
     C           YL0004    IFGT 0                          *IF
      * In this case:  the 1st SEP volume wont = the rin qty/2.5
      * C01641 RMC 7/13/11 was using the wrong field
      * C01751 RMC 9/20/11 was using the wrong company when upd leftover
     C                     ADD  YL0004    YL0003           COA Batch RIN V
      * Chg Btch Rin Vol f/sep CH - COA Batch Header RIN  * 
     C                     EXSR SICHRC
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SACRRC    BEGSR
      *================================================================
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @DACPP5
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     MOVELWL0002    WAL6T1           COA ULSD Compan
     C                     Z-ADDWL0003    WAI3NY           COA Batch Numbe
     C                     Z-ADDWL0004    WAJYNY           COA Batch Heade
     C                     Z-ADDWL0005    WAQ1NY           COA Batch Hdr R
     C                     MOVELWL0006    WAMUT1           COA Batch Heade
     C                     Z-ADDWL0007    WAJZNY           COA RIN SSSSSSS
     C                     Z-ADDWL0008    WAJ0NY           COA RIN EEEEEEE
     C                     Z-ADDWL0009    WAJ2NY           COA RIN Volume
     C                     Z-ADDWL0010    WARIDT           COA RIN Transac
     C                     Z-ADDWL0011    WAC5TM           COA RIN Transac
     C                     MOVELWL0012    WAMVT1           COA RIN Trans P
     C                     MOVELWL0013    WAMWT1           COA RIN Trans P
     C                     MOVELWL0014    WARINT           COA Retired RIN
     C                     Z-ADDWL0015    WARJDT           COA Retired RIN
     C                     Z-ADDWL0016    WAC6TM           COA Retired RIN
     C                     Z-ADDWL0017    WAC4NB           Order Number
     C                     Z-ADDWL0018    WADPNB           Order Sequence
     C                     Z-ADDWL0019    WAUENB           Order Secondary
     C                     Z-ADDWL0020    WARZNB           Case Sequence N
     C                     MOVELWL0021    WANGT1           COA Rail Car
     C                     Z-ADDWL0022    WARMNB           Load ID
     C                     Z-ADDWL0023    WARKDT           COA Date of 1st
     C                     Z-ADDWL0024    WAC7TM           COA RIN Unused
     C                     MOVELWL0025    WARINS           COA RIN Modifie
     C                     MOVELWL0026    WAMXT1           COA RIN Unused
     C                     MOVELWL0027    WAG3ST           COA RIN SoldFul
     C                     Z-ADDWL0028    WAQWNY           COA RIN Gallons
     C                     MOVELWL0029    WAL0AA           COA Ship To War
     C                     MOVELWL0030    WAMAT1           COA RIN Type Fl
     C                     MOVELWL0031    WATDNA           COA RIN Custome
     C                     Z-ADDWL0032    WACWC3           COA Shipping Co
     C                     Z-ADDWL0033    WAQXNY           COA Ref Load Id
     C                     Z-ADDWL0034    WAQZNY           COA Reference B
     C                     Z-ADDWL0035    WAQ0NY           COA Reference B
     C                     MOVELWL0036    WALVTX           RFS Compliance
     C                     MOVELWL0037    WANYT1           RFS Report Year
     C                     MOVELWL0038    WAG5ST           COA RIN Int/Ext
     C                     MOVELWL0039    WAG7ST           COA BHR Unused
     C                     Z-ADDWL0040    WATFDT           COA BHR Net Gal
     C                     Z-ADDWL0041    WATGDT           COA BHR Unused
     C                     MOVELWL0042    WAWIT1           COA BHR Unused
     C                     Z-ADDWL0043    WAQYNY           COA BHR Loadout
     C                     MOVELWL0044    WAL7T1           COA ULSD Facili
     C                     Z-ADDWL0045    WAR8NY           COA Batch RIN V
     C                     Z-ADDWL0046    WAR0NY           COA RIN Quantit
     C                     MOVELWL0047    WAI7AA           RFS Transaction
     C                     MOVELWL0048    WAMXAA           RFS Trans Reaso
     C                     MOVELWL0049    WAMSAA           RFS Fuel Code
     C                     Z-ADDWL0050    WAR7NY           COA BHR RIN Gen
     C                     Z-ADDWL0051    WAHEPR           COA BHR RIN Pri
     C                     Z-ADDWL0052    WAHFPR           COA BHR Gallon
     C                     MOVELWL0053    WAWVT1           COA Transaction
     C                     MOVELWL0054    WAW0T1           COA RIN Support
     C                     Z-ADDWL0055    WAR5NY           COA RIN Support
     C                     MOVELWL0056    WAW1T1           COA RIN Support
     C                     Z-ADDWL0057    WAR6NY           COA RIN Support
     C                     MOVELWL0058    WAJ1ST           COA BHR RFS Ver
     C                     MOVELWL0059    WAKHST           COA GEN EMTS St
     C                     Z-ADDWL0060    WATWDT           COA GEN EMTS Da
     C                     Z-ADDWL0061    WADUTM           COA GEN EMTS Ti
     C                     MOVELWL0062    WAKGST           COA RIN EMTS St
     C                     Z-ADDWL0063    WATVDT           COA RIN EMTS Da
     C                     Z-ADDWL0064    WADTTM           COA RIN EMTS Ti
     C                     Z-ADDWL0065    WAR9NY           COA EMTS PTD Nb
     C                     Z-ADDWL0066    WASQNY           COA EMTS Batch
     C                     MOVELWL0067    WABHR3           COA BHR Unused
     C                     Z-ADDWL0068    WASRNY           COA BHR Unused
     C                     MOVELWL0069    WAW7T1           COA EMTS Trans
     C                     MOVELWL0070    WAW8T1           COA EMTS Return
     C                     Z-ADDWL0071    WAT2DT           COA BHR Unused
     C                     Z-ADDWL0072    WASXNY           COA BHR Equiv V
     C                     Z-ADDWL0073    WASYNY           COA BHR RINs to
     C                     Z-ADDWL0074    WASZNY           COA Unassgnd Tx
     C                     MOVELWL0075    WAVSST           Record Status
     C                     Z-ADDWL0076    WAMJDT           Create Date
     C                     Z-ADDWL0077    WABETM           Create Time
     C                     MOVELWL0078    WACCVN           Create User
     C                     MOVELWL0079    WACDVN           Create Program
     C                     Z-ADDWL0080    WAMKDT           Change Date
     C                     Z-ADDWL0081    WABFTM           Change Time
     C                     MOVELWL0082    WACEVN           Change User
     C                     MOVELWL0083    WACFVN           Change Program
      *
      * USER: Processing before Data update
      * Set Crt Date/Time      IF
      * *** Set RECORD STATUS field. ***
     C                     MOVEL'A'       WAVSST           Record Status
      * *** Set CREATE fields. ***
     C                     Z-ADD##JDT     WAMJDT           Create Date
     C                     Z-ADD##JTM     WABETM           Create Time
     C                     MOVEL##USR     WACCVN           Create User
     C                     MOVEL##PGM     WACDVN           Create Program
      * *** Set CHANGE fields. ***
     C                     Z-ADD0         WAMKDT           Change Date
     C                     Z-ADD0         WABFTM           Change Time
     C                     MOVEL*BLANK    WACEVN           Change User
     C                     MOVEL*BLANK    WACFVN           Change Program
     C           KLCRSA    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAL6T1           COA ULSD Compan
     C                     KFLD           WAI3NY           COA Batch Numbe
     C                     KFLD           WAJYNY           COA Batch Heade
     C                     KFLD           WAQ1NY           COA Batch Hdr R
      * Check for duplicate primary key
     C           KLCRSA    SETLL@DACPP5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3856' W0RTN   7
      * Send message 'COA Batch Header RIN   EX'
     C                     MOVEL'USR3856' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C                     WRITE@DACPP5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Alpha Value        RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1CWC3    WBAIC3           Company Number
     C                     MOVEL@CN,001   WBV8CD           Company Value C
      * Establish starting position
     C           KRSSB     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBBXTX    YL0005           System Value Al
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Gen RIN SEP Trans RT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S12497 RMC 2/28/18 drop shipp co/ulsd co from key, get oldest fir
      * E2079 5/15/12 Use temp passed in when creating new rcd
      * E0921 8/16/10 Create RIN SEP transactions(s) for a Blender Sel fo
      *  whom HPB has been 'upstream delegated' to manage their RINs.
      * Establish starting position
     C           *LOVAL    SETLL@DACPT1                    *
     C                     READ @DACPT1                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rounding Rule: When calculating Gallons(Volume), Round up (+.5*1
      *                When calculating RINs, dont round
      * Par.coa rin volume new usr = volume needed
      * Calc new volume available from (RINs to sell)/ 2.5
      *   Round any dec place to next whole nmbr - so add .5 then round
      * Comp: vol at 2.5 the rins
      * LCL.AMOUNT =
      *    *COMPUTE (x1/x2)
      * x1    : DB1.COA BHR RINs to Sell Sep
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.COA RIN Equivalence Valu#
     C           WCSYNY    DIV  P2J3NY    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0008           AMOUNT
     C                     Z-ADDYL0008    YL0009           Decimal Places
      * chk decimal places>0
      * CASE: LCL.Decimal Places    usr is GT .00
     C           YL0009    IFGT .00                        *IF
     C                     ADD  .5        YL0008           AMOUNT
     C                     END                             *FI
     C           YL0008    MULT 1         WUR8NY    H      COA Batch RIN V
      * CASE: WRK.COA Batch RIN Volume GE PAR.COA RIN Volume New usr
     C           WUR8NY    IFGE YL0004                     *IF
     C                     Z-ADDYL0004    YL0010           Volume to use
      * Calc RINs to use
     C           YL0010    MULT P2J3NY    YL0011           COA RIN EEEEEEE
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUR8NY    YL0010           Volume to use
      * Upd RINs to use
     C                     Z-ADDWCSYNY    YL0011           COA RIN EEEEEEE
     C                     END                             *FI
      * Reduce Unsassigned RINs to sell by RINS using for this new SEP Tr
     C           WCSYNY    SUB  YL0011    YL0012           COA BHR RINs to
      * Increase RINs sold  by RINS using for this new SEP Trans
     C           WCQWNY    ADD  YL0011    YL0013           COA RIN Gallons
      * chg RIN Crt SEL Trans CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0084           Company Number
     C                     MOVELWCL6T1    WL0085    P      COA ULSD Compan
     C                     Z-ADDWCI3NY    WL0086           COA Batch Numbe
     C                     Z-ADDWCJYNY    WL0087           COA Batch Heade
     C                     Z-ADDWCQ1NY    WL0088           COA Batch Hdr R
     C                     Z-ADDWCJ2NY    WL0089           COA RIN Volume
     C                     MOVELWCG3ST    WL0090    P      COA RIN SoldFul
     C                     Z-ADDYL0013    WL0091           COA RIN Gallons
     C                     Z-ADDWCTFDT    WL0092           COA BHR Net Gal
     C                     Z-ADDYL0012    WL0093           COA BHR RINs to
     C                     EXSR SDCHRC
      * Create SEP/SEL RIN Transaction with volume to use and rins @ 2.5
      * Rtv Last Sec f/Btch/SecRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0094           Company Number
     C                     MOVELWCL6T1    WL0095    P      COA ULSD Compan
     C                     Z-ADDWCI3NY    WL0096           COA Batch Numbe
     C                     Z-ADDWCJYNY    WL0097           COA Batch Heade
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    YL0014           COA Batch Hdr R
     C                     ADD  1         YL0014           COA Batch Hdr R
      * P00579 RMC 5/18/2010 If RFS2, then set RIN as ready to go to EMTS
      *   & dont output par.coa batch rin
      * RFS2 changes
      * CASE: PAR.COA BHR RFS Version Nbr is RFS 2
     C           P1J1ST    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    YL0015           COA GEN EMTS St
     C                     MOVEL'0'       YL0016           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0017           COA Batch RIN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0015           COA GEN EMTS St
     C                     MOVEL*BLANK    YL0016           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0017           COA Batch RIN
     C                     END                             *FI
      * **********************__
      * Dont output EMTS Batch -- all are fifo now    01/03/12    E1868
      *   So those will process FIFO in EMTS
     C                     Z-ADDWCSQNY    YL0018           COA EMTS Batch
      * R6965 RMC 8/16/16 new hpb plant
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0099           Company Number
     C                     MOVEL'HPBPLT'  WL0100    P      Company Value C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0101    YL0019           System Value Nu
      * Rtv GEN Dt for org SELRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0019    WL0102           Company Number
     C                     MOVELWCL6T1    WL0103    P      COA ULSD Compan
     C                     Z-ADDWCI3NY    WL0104           COA Batch Numbe
     C                     Z-ADDWCJYNY    WL0105           COA Batch Heade
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0106    WUR7NY           COA BHR RIN Gen
     C                     Z-ADDWL0107    YL0020           COA GEN EMTS Da
      * 1/03/2012 -- ALL SELs are to be FIFO NOW in EMTS
     C                     Z-ADD0         YL0018           COA EMTS Batch
      * 1/04/2012 -- output db1.bhr rin gen year instead of par.bhr rin g
      * E2013 Output actual ship date as rin trans date instead of jobdat
      * CASE: DB1.Company Number is HPB Biodiesel
     C           WCAIC3    IFEQ 369                        *IF
     C                     MOVEL'82883'   YL0021           COA ULSD Facili
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'80059'   YL0021           COA ULSD Facili
     C                     END                             *FI
      * **********************__
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWCAIC3    WL0001           Company Number
     C                     MOVELWCL6T1    WL0002    P      COA ULSD Compan
     C                     Z-ADDWCI3NY    WL0003           COA Batch Numbe
     C                     Z-ADDWCJYNY    WL0004           COA Batch Heade
     C                     Z-ADDYL0014    WL0005           COA Batch Hdr R
     C                     MOVELYL0022    WL0006    P      COA Batch Heade
     C                     Z-ADD0         WL0007           COA RIN SSSSSSS
     C                     Z-ADD0         WL0008           COA RIN EEEEEEE
     C                     Z-ADDYL0011    WL0009           COA RIN Volume
     C                     Z-ADDP3T5DT    WL0010           COA RIN Transac
     C                     Z-ADD##JTM     WL0011           COA RIN Transac
     C                     MOVELP1MVT1    WL0012    P      COA RIN Trans P
     C                     MOVELP1MWT1    WL0013    P      COA RIN Trans P
     C                     MOVEL*BLANK    WL0014           COA Retired RIN
     C                     Z-ADD0         WL0015           COA Retired RIN
     C                     Z-ADD0         WL0016           COA Retired RIN
     C                     Z-ADDP1C4NB    WL0017           Order Number
     C                     Z-ADDP1DPNB    WL0018           Order Sequence
     C                     Z-ADDP1UENB    WL0019           Order Secondary
     C                     Z-ADD0         WL0020           Case Sequence N
     C                     MOVEL*BLANK    WL0021           COA Rail Car
     C                     Z-ADD0         WL0022           Load ID
     C                     Z-ADD0         WL0023           COA Date of 1st
     C                     Z-ADD0         WL0024           COA RIN Unused
     C                     MOVEL*BLANK    WL0025           COA RIN Modifie
     C                     MOVEL*BLANK    WL0026           COA RIN Unused
     C                     MOVELWUOTTX    WL0027    P      COA RIN SoldFul
     C                     Z-ADD0         WL0028           COA RIN Gallons
     C                     MOVEL*BLANK    WL0029           COA Ship To War
     C                     MOVELP1MAT1    WL0030    P      COA RIN Type Fl
     C                     MOVELP1TDNA    WL0031    P      COA RIN Custome
     C                     Z-ADDP1CWC3    WL0032           COA Shipping Co
     C                     Z-ADD0         WL0033           COA Ref Load Id
     C                     Z-ADDP1I3NY    WL0034           COA Reference B
     C                     Z-ADDP1JYNY    WL0035           COA Reference B
     C                     MOVELWUOTTX    WL0036    P      RFS Compliance
     C                     MOVELP1NYT1    WL0037    P      RFS Report Year
     C                     MOVEL*BLANK    WL0038           COA RIN Int/Ext
     C                     MOVELWUOTTX    WL0039    P      COA BHR Unused
     C                     Z-ADD0         WL0040           COA BHR Net Gal
     C                     Z-ADD0         WL0041           COA BHR Unused
     C                     MOVEL*BLANK    WL0042           COA BHR Unused
     C                     Z-ADDP1QYNY    WL0043           COA BHR Loadout
     C                     MOVELYL0021    WL0044    P      COA ULSD Facili
     C                     Z-ADDYL0010    WL0045           COA Batch RIN V
     C                     Z-ADDYL0011    WL0046           COA RIN Quantit
     C                     MOVELP1I7AA    WL0047    P      RFS Transaction
     C                     MOVELP1MXAA    WL0048    P      RFS Trans Reaso
     C                     MOVELP1MSAA    WL0049    P      RFS Fuel Code
     C                     Z-ADDWCR7NY    WL0050           COA BHR RIN Gen
     C                     Z-ADDYL0006    WL0051           COA BHR RIN Pri
     C                     Z-ADDYL0007    WL0052           COA BHR Gallon
     C                     MOVELWCWVT1    WL0053    P      COA Transaction
     C                     MOVELP1W0T1    WL0054    P      COA RIN Support
     C                     Z-ADDP1R5NY    WL0055           COA RIN Support
     C                     MOVELP1W1T1    WL0056    P      COA RIN Support
     C                     Z-ADDP1R6NY    WL0057           COA RIN Support
     C                     MOVELP1J1ST    WL0058    P      COA BHR RFS Ver
     C                     MOVELYL0015    WL0059    P      COA GEN EMTS St
     C                     Z-ADD0         WL0060           COA GEN EMTS Da
     C                     Z-ADD0         WL0061           COA GEN EMTS Ti
     C                     MOVELYL0016    WL0062    P      COA RIN EMTS St
     C                     Z-ADD0         WL0063           COA RIN EMTS Da
     C                     Z-ADD0         WL0064           COA RIN EMTS Ti
     C                     Z-ADDP1R9NY    WL0065           COA EMTS PTD Nb
     C                     Z-ADDYL0018    WL0066           COA EMTS Batch
     C                     MOVELYL0023    WL0067    P      COA BHR Unused
     C                     Z-ADD0         WL0068           COA BHR Unused
     C                     MOVEL*BLANK    WL0069           COA EMTS Trans
     C                     MOVEL*BLANK    WL0070           COA EMTS Return
     C                     Z-ADD0         WL0071           COA BHR Unused
     C                     Z-ADDP2J3NY    WL0072           COA BHR Equiv V
     C                     Z-ADD0         WL0073           COA BHR RINs to
     C                     Z-ADD0         WL0074           COA Unassgnd Tx
     C                     MOVEL'A'       WL0075    P      Record Status
     C                     Z-ADD0         WL0076           Create Date
     C                     Z-ADD0         WL0077           Create Time
     C                     MOVEL*BLANK    WL0078           Create User
     C                     MOVEL*BLANK    WL0079           Create Program
     C                     Z-ADD0         WL0080           Change Date
     C                     Z-ADD0         WL0081           Change Time
     C                     MOVEL*BLANK    WL0082           Change User
     C                     MOVEL*BLANK    WL0083           Change Program
     C                     EXSR SACRRC
      *  Reduce Volume Needed by Volume Used
     C                     SUB  YL0010    YL0004           COA RIN Volume
      * CASE: PAR.COA RIN Volume New usr is eq 0
     C           YL0004    IFEQ 0                          *IF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     READ @DACPT1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCHRC    BEGSR
      *================================================================
      * chg RIN Crt SEL Trans CH - COA Batch Header RIN  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001 38        COA Batch Heade
     C                     Z-ADD*ZERO     WN0002  80       COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WN0003  80       COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WN0004  70       COA RIN Transac
     C                     Z-ADD*ZERO     WN0005  60       COA RIN Transac
     C                     MOVEL*BLANK    WN0006 30        COA RIN Trans P
     C                     MOVEL*BLANK    WN0007  4        COA RIN Trans P
     C                     MOVEL*BLANK    WN0008  3        COA Retired RIN
     C                     Z-ADD*ZERO     WN0009  70       COA Retired RIN
     C                     Z-ADD*ZERO     WN0010  60       COA Retired RIN
     C                     Z-ADD*ZERO     WN0011  70       Order Number
     C                     Z-ADD*ZERO     WN0012  30       Order Sequence
     C                     Z-ADD*ZERO     WN0013  30       Order Secondary
     C                     Z-ADD*ZERO     WN0014  50       Case Sequence N
     C                     MOVEL*BLANK    WN0015 15        COA Rail Car
     C                     Z-ADD*ZERO     WN0016  70       Load ID
     C                     Z-ADD*ZERO     WN0017  70       COA Date of 1st
     C                     Z-ADD*ZERO     WN0018  60       COA RIN Unused
     C                     MOVEL*BLANK    WN0019  1        COA RIN Modifie
     C                     MOVEL*BLANK    WN0020 25        COA RIN Unused
     C                     MOVEL*BLANK    WN0021  3        COA Ship To War
     C                     MOVEL*BLANK    WN0022  1        COA RIN Type Fl
     C                     MOVEL*BLANK    WN0023 15        COA RIN Custome
     C                     Z-ADD*ZERO     WN0024  30       COA Shipping Co
     C                     Z-ADD*ZERO     WN0025  70       COA Ref Load Id
     C                     Z-ADD*ZERO     WN0026  50       COA Reference B
     C                     Z-ADD*ZERO     WN0027  50       COA Reference B
     C                     MOVEL*BLANK    WN0028  2        RFS Compliance
     C                     MOVEL*BLANK    WN0029  4        RFS Report Year
     C                     MOVEL*BLANK    WN0030  1        COA RIN Int/Ext
     C                     MOVEL*BLANK    WN0031  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0032  70       COA BHR Unused
     C                     MOVEL*BLANK    WN0033 25        COA BHR Unused
     C                     Z-ADD*ZERO     WN0034  70       COA BHR Loadout
     C                     MOVEL*BLANK    WN0035  5        COA ULSD Facili
     C                     Z-ADD*ZERO     WN0036  70       COA Batch RIN V
     C                     Z-ADD*ZERO     WN0037  70       COA RIN Quantit
     C                     MOVEL*BLANK    WN0038  3        RFS Transaction
     C                     MOVEL*BLANK    WN0039  3        RFS Trans Reaso
     C                     MOVEL*BLANK    WN0040  1        RFS Fuel Code
     C                     Z-ADD*ZERO     WN0041  40       COA BHR RIN Gen
     C                     Z-ADD*ZERO     WN0042  72       COA BHR RIN Pri
     C                     Z-ADD*ZERO     WN0043  72       COA BHR Gallon
     C                     MOVEL*BLANK    WN0044 50        COA Transaction
     C                     MOVEL*BLANK    WN0045 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0046  70       COA RIN Support
     C                     MOVEL*BLANK    WN0047 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0048  70       COA RIN Support
     C                     MOVEL*BLANK    WN0049  1        COA BHR RFS Ver
     C                     MOVEL*BLANK    WN0050  1        COA GEN EMTS St
     C                     Z-ADD*ZERO     WN0051  70       COA GEN EMTS Da
     C                     Z-ADD*ZERO     WN0052  60       COA GEN EMTS Ti
     C                     MOVEL*BLANK    WN0053  1        COA RIN EMTS St
     C                     Z-ADD*ZERO     WN0054  70       COA RIN EMTS Da
     C                     Z-ADD*ZERO     WN0055  60       COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WN0056  70       COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WN0057  80       COA EMTS Batch
     C                     MOVEL*BLANK    WN0058  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0059  80       COA BHR Unused
     C                     MOVEL*BLANK    WN0060 40        COA EMTS Trans
     C                     MOVEL*BLANK    WN0061 10        COA EMTS Return
     C                     Z-ADD*ZERO     WN0062  70       COA BHR Unused
     C                     Z-ADD*ZERO     WN0063  21       COA BHR Equiv V
     C                     Z-ADD*ZERO     WN0064  70       COA Unassgnd Tx
     C                     MOVEL*BLANK    WN0065  1        Record Status
     C                     Z-ADD*ZERO     WN0066  70       Create Date
     C                     Z-ADD*ZERO     WN0067  60       Create Time
     C                     MOVEL*BLANK    WN0068 10        Create User
     C                     MOVEL*BLANK    WN0069 10        Create Program
     C                     Z-ADD*ZERO     WN0070  70       Change Date
     C                     Z-ADD*ZERO     WN0071  60       Change Time
     C                     MOVEL*BLANK    WN0072 10        Change User
     C                     MOVEL*BLANK    WN0073 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @DACPP5
     C                     Z-ADDWL0084    WAAIC3           Company Number
     C                     MOVELWL0085    WAL6T1    P      COA ULSD Compan
     C                     Z-ADDWL0086    WAI3NY           COA Batch Numbe
     C                     Z-ADDWL0087    WAJYNY           COA Batch Heade
     C                     Z-ADDWL0088    WAQ1NY           COA Batch Hdr R
      *
     C           KLCHSD    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAL6T1           COA ULSD Compan
     C                     KFLD           WAI3NY           COA Batch Numbe
     C                     KFLD           WAJYNY           COA Batch Heade
     C                     KFLD           WAQ1NY           COA Batch Hdr R
     C           KLCHSD    CHAIN@DACPP5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDACPL0'MDACP
     C                     MOVEL'@DACPP5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDA1    YARDCS
      * Move non-key fields to @DACPP5
     C                     Z-ADDWL0089    WAJ2NY           COA RIN Volume
     C                     MOVELWL0090    WAG3ST    P      COA RIN SoldFul
     C                     Z-ADDWL0091    WAQWNY           COA RIN Gallons
     C                     Z-ADDWL0092    WATFDT           COA BHR Net Gal
     C                     Z-ADDWL0093    WASYNY           COA BHR RINs to
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WAMKDT           Change Date
     C                     Z-ADD##JTM     WABFTM           Change Time
     C                     MOVEL##USR     WACEVN           Change User
     C                     MOVEL##PGM     WACFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@DACPP5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Last Sec f/Btch/SecRT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WDL6T1    WQSE02           COA ULSD Compan
     C           *LIKE     DEFN WDI3NY    WQSE03           COA Batch Numbe
     C           *LIKE     DEFN WDJYNY    WQSE04           COA Batch Heade
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           COA ULSD Compan
     C                     KFLD           WQSE03           COA Batch Numbe
     C                     KFLD           WQSE04           COA Batch Heade
      * Setup key
     C                     Z-ADDWL0094    WQSE01           Company Number
     C                     MOVELWL0095    WQSE02           COA ULSD Compan
     C                     Z-ADDWL0096    WQSE03           COA Batch Numbe
     C                     Z-ADDWL0097    WQSE04           COA Batch Heade
      * Establish starting position
     C           KRSSE     SETLL@DACPED                    *
     C           KRSSE     READE@DACPED                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3855' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD0         WL0098           COA Batch Hdr R
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDQ1NY    WL0098           COA Batch Hdr R
     C                     GOTO SEEXIT                     *QUIT
     C           KRSSE     READE@DACPED                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0099    WBAIC3           Company Number
     C                     MOVELWL0100    WBV8CD           Company Value C
      * Establish starting position
     C           KRSSF     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBM8NB    WL0101           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv GEN Dt for org SELRT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WEL6T1    WQSG02           COA ULSD Compan
     C           *LIKE     DEFN WEI3NY    WQSG03           COA Batch Numbe
     C           *LIKE     DEFN WEJYNY    WQSG04           COA Batch Heade
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           COA ULSD Compan
     C                     KFLD           WQSG03           COA Batch Numbe
     C                     KFLD           WQSG04           COA Batch Heade
      * Setup key
     C                     Z-ADDWL0102    WQSG01           Company Number
     C                     MOVELWL0103    WQSG02           COA ULSD Compan
     C                     Z-ADDWL0104    WQSG03           COA Batch Numbe
     C                     Z-ADDWL0105    WQSG04           COA Batch Heade
      * Establish starting position
     C           KRSSG     SETLL@DACPP6                    *
     C           KRSSG     READE@DACPP6                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Get GEN date... s/only be 1 order for this ulsd/batch/seq
      * PAR = DB1 By name
     C                     Z-ADDWER7NY    WL0106           COA BHR RIN Gen
     C                     Z-ADDWETWDT    WL0107           COA GEN EMTS Da
     C                     GOTO SGEXIT                     *QUIT
     C           KRSSG     READE@DACPP6                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Gen RIN SEP Trn-CoRT - COA Batch Header RIN  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * S12497 RMC 2/28/18 drop shipp co/ulsd co from key, get oldest fir
      * E2079 5/15/12 Use temp passed in when creating new rcd
      * E0921 8/16/10 Create RIN SEP transactions(s) for a Blender Sel fo
      *  whom HPB has been 'upstream delegated' to manage their RINs.
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WFL6T1    WQSH02           COA ULSD Compan
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           COA ULSD Compan
      * Setup key
     C                     Z-ADDWL0108    WQSH01           Company Number
     C                     MOVELWL0109    WQSH02           COA ULSD Compan
      * Establish starting position
     C           KRSSH     SETLL@DACPDI                    *
     C           KRSSH     READE@DACPDI                  90*
      * Data record not found
     C   90                MOVEL'USR3855' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rounding Rule: When calculating Gallons(Volume), Round up (+.5*1
      *                When calculating RINs, dont round
      * Par.coa rin volume new usr = volume needed
      * Calc new volume available from (RINs to sell)/ 2.5
      *   Round any dec place to next whole nmbr - so add .5 then round
      * Comp: vol at 2.5 the rins
      * LCL.AMOUNT =
      *    *COMPUTE (x1/x2)
      * x1    : DB1.COA BHR RINs to Sell Sep
      * /     : PGM.*Synon (15,2) work field *
      * x2    : PAR.COA RIN Equivalence Valu#
     C           WFSYNY    DIV  WL0135    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0024           AMOUNT
     C                     Z-ADDYL0024    YL0025           Decimal Places
      * chk decimal places>0
      * CASE: LCL.Decimal Places    usr is GT .00
     C           YL0025    IFGT .00                        *IF
     C                     ADD  .5        YL0024           AMOUNT
     C                     END                             *FI
     C           YL0024    MULT 1         WUR8NY    H      COA Batch RIN V
      * CASE: WRK.COA Batch RIN Volume GE PAR.COA RIN Volume New usr
     C           WUR8NY    IFGE WL0136                     *IF
     C                     Z-ADDWL0136    YL0026           Volume to use
      * Calc RINs to use
     C           YL0026    MULT WL0135    YL0027           COA RIN EEEEEEE
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWUR8NY    YL0026           Volume to use
      * Upd RINs to use
     C                     Z-ADDWFSYNY    YL0027           COA RIN EEEEEEE
     C                     END                             *FI
      * Reduce Unsassigned RINs to sell by RINS using for this new SEP Tr
     C           WFSYNY    SUB  YL0027    YL0028           COA BHR RINs to
      * Increase RINs sold  by RINS using for this new SEP Trans
     C           WFQWNY    ADD  YL0027    YL0029           COA RIN Gallons
      * chg RIN Crt SEL Trans CH - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0084           Company Number
     C                     MOVELWFL6T1    WL0085    P      COA ULSD Compan
     C                     Z-ADDWFI3NY    WL0086           COA Batch Numbe
     C                     Z-ADDWFJYNY    WL0087           COA Batch Heade
     C                     Z-ADDWFQ1NY    WL0088           COA Batch Hdr R
     C                     Z-ADDWFJ2NY    WL0089           COA RIN Volume
     C                     MOVELWFG3ST    WL0090    P      COA RIN SoldFul
     C                     Z-ADDYL0029    WL0091           COA RIN Gallons
     C                     Z-ADDWFTFDT    WL0092           COA BHR Net Gal
     C                     Z-ADDYL0028    WL0093           COA BHR RINs to
     C                     EXSR SDCHRC
      * Create SEP/SEL RIN Transaction with volume to use and rins @ 2.5
      * Rtv Last Sec f/Btch/SecRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0094           Company Number
     C                     MOVELWFL6T1    WL0095    P      COA ULSD Compan
     C                     Z-ADDWFI3NY    WL0096           COA Batch Numbe
     C                     Z-ADDWFJYNY    WL0097           COA Batch Heade
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0098    YL0030           COA Batch Hdr R
     C                     ADD  1         YL0030           COA Batch Hdr R
      * P00579 RMC 5/18/2010 If RFS2, then set RIN as ready to go to EMTS
      *   & dont output par.coa batch rin
      * RFS2 changes
      * CASE: PAR.COA BHR RFS Version Nbr is RFS 2
     C           WL0133    IFEQ '2'                        *IF
     C                     MOVEL*BLANK    YL0031           COA GEN EMTS St
     C                     MOVEL'0'       YL0032           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0033           COA Batch RIN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    YL0031           COA GEN EMTS St
     C                     MOVEL*BLANK    YL0032           COA RIN EMTS St
     C                     MOVEL*BLANK    YL0033           COA Batch RIN
     C                     END                             *FI
      * **********************__
      * Dont output EMTS Batch -- all are fifo now    01/03/12    E1868
      *   So those will process FIFO in EMTS
     C                     Z-ADDWFSQNY    YL0034           COA EMTS Batch
      * R6965 RMC 8/16/16 new hpb plant
      * RTV Numeric Value      RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0099           Company Number
     C                     MOVEL'HPBPLT'  WL0100    P      Company Value C
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0101    YL0035           System Value Nu
      * Rtv GEN Dt for org SELRT - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0035    WL0102           Company Number
     C                     MOVELWFL6T1    WL0103    P      COA ULSD Compan
     C                     Z-ADDWFI3NY    WL0104           COA Batch Numbe
     C                     Z-ADDWFJYNY    WL0105           COA Batch Heade
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0106    WUR7NY           COA BHR RIN Gen
     C                     Z-ADDWL0107    YL0036           COA GEN EMTS Da
      * 1/03/2012 -- ALL SELs are to be FIFO NOW in EMTS
     C                     Z-ADD0         YL0034           COA EMTS Batch
      * 1/04/2012 -- output db1.bhr rin gen year instead of par.bhr rin g
      * E2013 Output actual ship date as rin trans date instead of jobdat
      * CASE: DB1.Company Number is HPB Biodiesel
     C           WFAIC3    IFEQ 369                        *IF
     C                     MOVEL'82883'   YL0037           COA ULSD Facili
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'80441'   YL0037           COA ULSD Facili
     C                     END                             *FI
      * **********************__
      * Crt COA Batch Hdr RIN CR - COA Batch Header RIN  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWFAIC3    WL0001           Company Number
     C                     MOVELWFL6T1    WL0002    P      COA ULSD Compan
     C                     Z-ADDWFI3NY    WL0003           COA Batch Numbe
     C                     Z-ADDWFJYNY    WL0004           COA Batch Heade
     C                     Z-ADDYL0030    WL0005           COA Batch Hdr R
     C                     MOVELYL0038    WL0006    P      COA Batch Heade
     C                     Z-ADD0         WL0007           COA RIN SSSSSSS
     C                     Z-ADD0         WL0008           COA RIN EEEEEEE
     C                     Z-ADDYL0027    WL0009           COA RIN Volume
     C                     Z-ADDWL0137    WL0010           COA RIN Transac
     C                     Z-ADD##JTM     WL0011           COA RIN Transac
     C                     MOVELWL0112    WL0012    P      COA RIN Trans P
     C                     MOVELWL0113    WL0013    P      COA RIN Trans P
     C                     MOVEL*BLANK    WL0014           COA Retired RIN
     C                     Z-ADD0         WL0015           COA Retired RIN
     C                     Z-ADD0         WL0016           COA Retired RIN
     C                     Z-ADDWL0114    WL0017           Order Number
     C                     Z-ADDWL0115    WL0018           Order Sequence
     C                     Z-ADDWL0116    WL0019           Order Secondary
     C                     Z-ADD0         WL0020           Case Sequence N
     C                     MOVEL*BLANK    WL0021           COA Rail Car
     C                     Z-ADD0         WL0022           Load ID
     C                     Z-ADD0         WL0023           COA Date of 1st
     C                     Z-ADD0         WL0024           COA RIN Unused
     C                     MOVEL*BLANK    WL0025           COA RIN Modifie
     C                     MOVEL*BLANK    WL0026           COA RIN Unused
     C                     MOVELWUOTTX    WL0027    P      COA RIN SoldFul
     C                     Z-ADD0         WL0028           COA RIN Gallons
     C                     MOVEL*BLANK    WL0029           COA Ship To War
     C                     MOVELWL0117    WL0030    P      COA RIN Type Fl
     C                     MOVELWL0118    WL0031    P      COA RIN Custome
     C                     Z-ADDWL0119    WL0032           COA Shipping Co
     C                     Z-ADD0         WL0033           COA Ref Load Id
     C                     Z-ADDWL0110    WL0034           COA Reference B
     C                     Z-ADDWL0111    WL0035           COA Reference B
     C                     MOVELWUOTTX    WL0036    P      RFS Compliance
     C                     MOVELWL0120    WL0037    P      RFS Report Year
     C                     MOVEL*BLANK    WL0038           COA RIN Int/Ext
     C                     MOVELWUOTTX    WL0039    P      COA BHR Unused
     C                     Z-ADD0         WL0040           COA BHR Net Gal
     C                     Z-ADD0         WL0041           COA BHR Unused
     C                     MOVEL*BLANK    WL0042           COA BHR Unused
     C                     Z-ADDWL0121    WL0043           COA BHR Loadout
     C                     MOVELYL0037    WL0044    P      COA ULSD Facili
     C                     Z-ADDYL0026    WL0045           COA Batch RIN V
     C                     Z-ADDYL0027    WL0046           COA RIN Quantit
     C                     MOVELWL0123    WL0047    P      RFS Transaction
     C                     MOVELWL0124    WL0048    P      RFS Trans Reaso
     C                     MOVELWL0125    WL0049    P      RFS Fuel Code
     C                     Z-ADDWFR7NY    WL0050           COA BHR RIN Gen
     C                     Z-ADDWL0127    WL0051           COA BHR RIN Pri
     C                     Z-ADDWL0128    WL0052           COA BHR Gallon
     C                     MOVELWFWVT1    WL0053    P      COA Transaction
     C                     MOVELWL0129    WL0054    P      COA RIN Support
     C                     Z-ADDWL0130    WL0055           COA RIN Support
     C                     MOVELWL0131    WL0056    P      COA RIN Support
     C                     Z-ADDWL0132    WL0057           COA RIN Support
     C                     MOVELWL0133    WL0058    P      COA BHR RFS Ver
     C                     MOVELYL0031    WL0059    P      COA GEN EMTS St
     C                     Z-ADD0         WL0060           COA GEN EMTS Da
     C                     Z-ADD0         WL0061           COA GEN EMTS Ti
     C                     MOVELYL0032    WL0062    P      COA RIN EMTS St
     C                     Z-ADD0         WL0063           COA RIN EMTS Da
     C                     Z-ADD0         WL0064           COA RIN EMTS Ti
     C                     Z-ADDWL0134    WL0065           COA EMTS PTD Nb
     C                     Z-ADDYL0034    WL0066           COA EMTS Batch
     C                     MOVELYL0039    WL0067    P      COA BHR Unused
     C                     Z-ADD0         WL0068           COA BHR Unused
     C                     MOVEL*BLANK    WL0069           COA EMTS Trans
     C                     MOVEL*BLANK    WL0070           COA EMTS Return
     C                     Z-ADD0         WL0071           COA BHR Unused
     C                     Z-ADDWL0135    WL0072           COA BHR Equiv V
     C                     Z-ADD0         WL0073           COA BHR RINs to
     C                     Z-ADD0         WL0074           COA Unassgnd Tx
     C                     MOVEL'A'       WL0075    P      Record Status
     C                     Z-ADD0         WL0076           Create Date
     C                     Z-ADD0         WL0077           Create Time
     C                     MOVEL*BLANK    WL0078           Create User
     C                     MOVEL*BLANK    WL0079           Create Program
     C                     Z-ADD0         WL0080           Change Date
     C                     Z-ADD0         WL0081           Change Time
     C                     MOVEL*BLANK    WL0082           Change User
     C                     MOVEL*BLANK    WL0083           Change Program
     C                     EXSR SACRRC
      *  Reduce Volume Needed by Volume Used
     C                     SUB  YL0026    WL0136           COA RIN Volume
      * CASE: PAR.COA RIN Volume New usr is eq 0
     C           WL0136    IFEQ 0                          *IF
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSH     READE@DACPDI                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Btch Rin Vol f/sep CH - COA Batch Header RIN  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0074 38        COA Batch Heade
     C                     Z-ADD*ZERO     WN0075  80       COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WN0076  80       COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WN0077  80       COA RIN Volume
     C                     Z-ADD*ZERO     WN0078  70       COA RIN Transac
     C                     Z-ADD*ZERO     WN0079  60       COA RIN Transac
     C                     MOVEL*BLANK    WN0080 30        COA RIN Trans P
     C                     MOVEL*BLANK    WN0081  4        COA RIN Trans P
     C                     MOVEL*BLANK    WN0082  3        COA Retired RIN
     C                     Z-ADD*ZERO     WN0083  70       COA Retired RIN
     C                     Z-ADD*ZERO     WN0084  60       COA Retired RIN
     C                     Z-ADD*ZERO     WN0085  70       Order Number
     C                     Z-ADD*ZERO     WN0086  30       Order Sequence
     C                     Z-ADD*ZERO     WN0087  30       Order Secondary
     C                     Z-ADD*ZERO     WN0088  50       Case Sequence N
     C                     MOVEL*BLANK    WN0089 15        COA Rail Car
     C                     Z-ADD*ZERO     WN0090  70       Load ID
     C                     Z-ADD*ZERO     WN0091  70       COA Date of 1st
     C                     Z-ADD*ZERO     WN0092  60       COA RIN Unused
     C                     MOVEL*BLANK    WN0093  1        COA RIN Modifie
     C                     MOVEL*BLANK    WN0094 25        COA RIN Unused
     C                     MOVEL*BLANK    WN0095  1        COA RIN SoldFul
     C                     Z-ADD*ZERO     WN0096  80       COA RIN Gallons
     C                     MOVEL*BLANK    WN0097  3        COA Ship To War
     C                     MOVEL*BLANK    WN0098  1        COA RIN Type Fl
     C                     MOVEL*BLANK    WN0099 15        COA RIN Custome
     C                     Z-ADD*ZERO     WN0100  30       COA Shipping Co
     C                     Z-ADD*ZERO     WN0101  70       COA Ref Load Id
     C                     Z-ADD*ZERO     WN0102  50       COA Reference B
     C                     Z-ADD*ZERO     WN0103  50       COA Reference B
     C                     MOVEL*BLANK    WN0104  2        RFS Compliance
     C                     MOVEL*BLANK    WN0105  4        RFS Report Year
     C                     MOVEL*BLANK    WN0106  1        COA RIN Int/Ext
     C                     MOVEL*BLANK    WN0107  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0108  70       COA BHR Net Gal
     C                     Z-ADD*ZERO     WN0109  70       COA BHR Unused
     C                     MOVEL*BLANK    WN0110 25        COA BHR Unused
     C                     Z-ADD*ZERO     WN0111  70       COA BHR Loadout
     C                     MOVEL*BLANK    WN0112  5        COA ULSD Facili
     C                     Z-ADD*ZERO     WN0113  70       COA RIN Quantit
     C                     MOVEL*BLANK    WN0114  3        RFS Transaction
     C                     MOVEL*BLANK    WN0115  3        RFS Trans Reaso
     C                     MOVEL*BLANK    WN0116  1        RFS Fuel Code
     C                     Z-ADD*ZERO     WN0117  40       COA BHR RIN Gen
     C                     Z-ADD*ZERO     WN0118  72       COA BHR RIN Pri
     C                     Z-ADD*ZERO     WN0119  72       COA BHR Gallon
     C                     MOVEL*BLANK    WN0120 50        COA Transaction
     C                     MOVEL*BLANK    WN0121 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0122  70       COA RIN Support
     C                     MOVEL*BLANK    WN0123 25        COA RIN Support
     C                     Z-ADD*ZERO     WN0124  70       COA RIN Support
     C                     MOVEL*BLANK    WN0125  1        COA BHR RFS Ver
     C                     MOVEL*BLANK    WN0126  1        COA GEN EMTS St
     C                     Z-ADD*ZERO     WN0127  70       COA GEN EMTS Da
     C                     Z-ADD*ZERO     WN0128  60       COA GEN EMTS Ti
     C                     MOVEL*BLANK    WN0129  1        COA RIN EMTS St
     C                     Z-ADD*ZERO     WN0130  70       COA RIN EMTS Da
     C                     Z-ADD*ZERO     WN0131  60       COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WN0132  70       COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WN0133  80       COA EMTS Batch
     C                     MOVEL*BLANK    WN0134  2        COA BHR Unused
     C                     Z-ADD*ZERO     WN0135  80       COA BHR Unused
     C                     MOVEL*BLANK    WN0136 40        COA EMTS Trans
     C                     MOVEL*BLANK    WN0137 10        COA EMTS Return
     C                     Z-ADD*ZERO     WN0138  70       COA BHR Unused
     C                     Z-ADD*ZERO     WN0139  21       COA BHR Equiv V
     C                     Z-ADD*ZERO     WN0140  70       COA BHR RINs to
     C                     Z-ADD*ZERO     WN0141  70       COA Unassgnd Tx
     C                     MOVEL*BLANK    WN0142  1        Record Status
     C                     Z-ADD*ZERO     WN0143  70       Create Date
     C                     Z-ADD*ZERO     WN0144  60       Create Time
     C                     MOVEL*BLANK    WN0145 10        Create User
     C                     MOVEL*BLANK    WN0146 10        Create Program
     C                     Z-ADD*ZERO     WN0147  70       Change Date
     C                     Z-ADD*ZERO     WN0148  60       Change Time
     C                     MOVEL*BLANK    WN0149 10        Change User
     C                     MOVEL*BLANK    WN0150 10        Change Program
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @DACPP5
     C                     Z-ADDP1CWC3    WAAIC3           Company Number
     C                     MOVELP1L6T1    WAL6T1    P      COA ULSD Compan
     C                     Z-ADDP1I3NY    WAI3NY           COA Batch Numbe
     C                     Z-ADDP1JYNY    WAJYNY           COA Batch Heade
     C                     Z-ADDP1Q1NY    WAQ1NY           COA Batch Hdr R
      *
     C           KLCHSI    KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAL6T1           COA ULSD Compan
     C                     KFLD           WAI3NY           COA Batch Numbe
     C                     KFLD           WAJYNY           COA Batch Heade
     C                     KFLD           WAQ1NY           COA Batch Hdr R
     C           KLCHSI    CHAIN@DACPP5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMDACPL0'MDACP
     C                     MOVEL'@DACPP5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMDA1    YBRDCS
      * Move non-key fields to @DACPP5
     C                     Z-ADDYL0003    WAR8NY           COA Batch RIN V
      *
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Chg Date/Time      IF
     C                     Z-ADD##JDT     WAMKDT           Change Date
     C                     Z-ADD##JTM     WABFTM           Change Time
     C                     MOVEL##USR     WACEVN           Change User
     C                     MOVEL##PGM     WACFVN           Change Program
      * Set PGM.*Record Data Changed flag
     C           QPMDA1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@DACPP5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMDACPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WAJYNY           COA Batch Heade
     C                     Z-ADD*ZERO     WAQ1NY           COA Batch Hdr R
     C                     Z-ADD*ZERO     WAJZNY           COA RIN SSSSSSS
     C                     Z-ADD*ZERO     WAJ0NY           COA RIN EEEEEEE
     C                     Z-ADD*ZERO     WAJ2NY           COA RIN Volume
     C                     Z-ADD*ZERO     WARIDT           COA RIN Transac
     C                     Z-ADD*ZERO     WAC5TM           COA RIN Transac
     C                     Z-ADD*ZERO     WARJDT           COA Retired RIN
     C                     Z-ADD*ZERO     WAC6TM           COA Retired RIN
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WADPNB           Order Sequence
     C                     Z-ADD*ZERO     WAUENB           Order Secondary
     C                     Z-ADD*ZERO     WARZNB           Case Sequence N
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARKDT           COA Date of 1st
     C                     Z-ADD*ZERO     WAC7TM           COA RIN Unused
     C                     Z-ADD*ZERO     WAQWNY           COA RIN Gallons
     C                     Z-ADD*ZERO     WACWC3           COA Shipping Co
     C                     Z-ADD*ZERO     WAQXNY           COA Ref Load Id
     C                     Z-ADD*ZERO     WAQZNY           COA Reference B
     C                     Z-ADD*ZERO     WAQ0NY           COA Reference B
     C                     Z-ADD*ZERO     WATFDT           COA BHR Net Gal
     C                     Z-ADD*ZERO     WATGDT           COA BHR Unused
     C                     Z-ADD*ZERO     WAQYNY           COA BHR Loadout
     C                     Z-ADD*ZERO     WAR8NY           COA Batch RIN V
     C                     Z-ADD*ZERO     WAR0NY           COA RIN Quantit
     C                     Z-ADD*ZERO     WAR7NY           COA BHR RIN Gen
     C                     Z-ADD*ZERO     WAHEPR           COA BHR RIN Pri
     C                     Z-ADD*ZERO     WAHFPR           COA BHR Gallon
     C                     Z-ADD*ZERO     WAR5NY           COA RIN Support
     C                     Z-ADD*ZERO     WAR6NY           COA RIN Support
     C                     Z-ADD*ZERO     WATWDT           COA GEN EMTS Da
     C                     Z-ADD*ZERO     WADUTM           COA GEN EMTS Ti
     C                     Z-ADD*ZERO     WATVDT           COA RIN EMTS Da
     C                     Z-ADD*ZERO     WADTTM           COA RIN EMTS Ti
     C                     Z-ADD*ZERO     WAR9NY           COA EMTS PTD Nb
     C                     Z-ADD*ZERO     WASQNY           COA EMTS Batch
     C                     Z-ADD*ZERO     WASRNY           COA BHR Unused
     C                     Z-ADD*ZERO     WAT2DT           COA BHR Unused
     C                     Z-ADD*ZERO     WASXNY           COA BHR Equiv V
     C                     Z-ADD*ZERO     WASYNY           COA BHR RINs to
     C                     Z-ADD*ZERO     WASZNY           COA Unassgnd Tx
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBM8NB           System Value Nu
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field COA Batch RIN Volume
     C                     Z-ADD*ZERO     WUR8NY  70
      * Define work field COA BHR RIN Gen Year
     C                     Z-ADD*ZERO     WUR7NY  40
      * Define work field Blank for 4           USR
     C                     MOVEL*BLANK    WUOTTX  4
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SACRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  4
     C                     Z-ADD*ZERO     WL0003  50
     C                     Z-ADD*ZERO     WL0004  50
     C                     Z-ADD*ZERO     WL0005  50
     C                     MOVEL*BLANK    WL0006 38
     C                     Z-ADD*ZERO     WL0007  80
     C                     Z-ADD*ZERO     WL0008  80
     C                     Z-ADD*ZERO     WL0009  80
     C                     Z-ADD*ZERO     WL0010  70
     C                     Z-ADD*ZERO     WL0011  60
     C                     MOVEL*BLANK    WL0012 30
     C                     MOVEL*BLANK    WL0013  4
     C                     MOVEL*BLANK    WL0014  3
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  60
     C                     Z-ADD*ZERO     WL0017  70
     C                     Z-ADD*ZERO     WL0018  30
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  50
     C                     MOVEL*BLANK    WL0021 15
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023  70
     C                     Z-ADD*ZERO     WL0024  60
     C                     MOVEL*BLANK    WL0025  1
     C                     MOVEL*BLANK    WL0026 25
     C                     MOVEL*BLANK    WL0027  1
     C                     Z-ADD*ZERO     WL0028  80
     C                     MOVEL*BLANK    WL0029  3
     C                     MOVEL*BLANK    WL0030  1
     C                     MOVEL*BLANK    WL0031 15
     C                     Z-ADD*ZERO     WL0032  30
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034  50
     C                     Z-ADD*ZERO     WL0035  50
     C                     MOVEL*BLANK    WL0036  2
     C                     MOVEL*BLANK    WL0037  4
     C                     MOVEL*BLANK    WL0038  1
     C                     MOVEL*BLANK    WL0039  2
     C                     Z-ADD*ZERO     WL0040  70
     C                     Z-ADD*ZERO     WL0041  70
     C                     MOVEL*BLANK    WL0042 25
     C                     Z-ADD*ZERO     WL0043  70
     C                     MOVEL*BLANK    WL0044  5
     C                     Z-ADD*ZERO     WL0045  70
     C                     Z-ADD*ZERO     WL0046  70
     C                     MOVEL*BLANK    WL0047  3
     C                     MOVEL*BLANK    WL0048  3
     C                     MOVEL*BLANK    WL0049  1
     C                     Z-ADD*ZERO     WL0050  40
     C                     Z-ADD*ZERO     WL0051  72
     C                     Z-ADD*ZERO     WL0052  72
     C                     MOVEL*BLANK    WL0053 50
     C                     MOVEL*BLANK    WL0054 25
     C                     Z-ADD*ZERO     WL0055  70
     C                     MOVEL*BLANK    WL0056 25
     C                     Z-ADD*ZERO     WL0057  70
     C                     MOVEL*BLANK    WL0058  1
     C                     MOVEL*BLANK    WL0059  1
     C                     Z-ADD*ZERO     WL0060  70
     C                     Z-ADD*ZERO     WL0061  60
     C                     MOVEL*BLANK    WL0062  1
     C                     Z-ADD*ZERO     WL0063  70
     C                     Z-ADD*ZERO     WL0064  60
     C                     Z-ADD*ZERO     WL0065  70
     C                     Z-ADD*ZERO     WL0066  80
     C                     MOVEL*BLANK    WL0067  2
     C                     Z-ADD*ZERO     WL0068  80
     C                     MOVEL*BLANK    WL0069 40
     C                     MOVEL*BLANK    WL0070 10
     C                     Z-ADD*ZERO     WL0071  70
     C                     Z-ADD*ZERO     WL0072  21
     C                     Z-ADD*ZERO     WL0073  70
     C                     Z-ADD*ZERO     WL0074  70
     C                     MOVEL*BLANK    WL0075  1
     C                     Z-ADD*ZERO     WL0076  70
     C                     Z-ADD*ZERO     WL0077  60
     C                     MOVEL*BLANK    WL0078 10
     C                     MOVEL*BLANK    WL0079 10
     C                     Z-ADD*ZERO     WL0080  70
     C                     Z-ADD*ZERO     WL0081  60
     C                     MOVEL*BLANK    WL0082 10
     C                     MOVEL*BLANK    WL0083 10
      * Define local variables for subroutine SDCHRC.
     C                     Z-ADD*ZERO     WL0084  30
     C                     MOVEL*BLANK    WL0085  4
     C                     Z-ADD*ZERO     WL0086  50
     C                     Z-ADD*ZERO     WL0087  50
     C                     Z-ADD*ZERO     WL0088  50
     C                     Z-ADD*ZERO     WL0089  80
     C                     MOVEL*BLANK    WL0090  1
     C                     Z-ADD*ZERO     WL0091  80
     C                     Z-ADD*ZERO     WL0092  70
     C                     Z-ADD*ZERO     WL0093  70
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0094  30
     C                     MOVEL*BLANK    WL0095  4
     C                     Z-ADD*ZERO     WL0096  50
     C                     Z-ADD*ZERO     WL0097  50
     C                     Z-ADD*ZERO     WL0098  50
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0099  30
     C                     MOVEL*BLANK    WL0100 10
     C                     Z-ADD*ZERO     WL0101 155
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0102  30
     C                     MOVEL*BLANK    WL0103  4
     C                     Z-ADD*ZERO     WL0104  50
     C                     Z-ADD*ZERO     WL0105  50
     C                     Z-ADD*ZERO     WL0106  40
     C                     Z-ADD*ZERO     WL0107  70
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0108  30
     C                     MOVEL*BLANK    WL0109  4
     C                     Z-ADD*ZERO     WL0110  50
     C                     Z-ADD*ZERO     WL0111  50
     C                     MOVEL*BLANK    WL0112 30
     C                     MOVEL*BLANK    WL0113  4
     C                     Z-ADD*ZERO     WL0114  70
     C                     Z-ADD*ZERO     WL0115  30
     C                     Z-ADD*ZERO     WL0116  30
     C                     MOVEL*BLANK    WL0117  1
     C                     MOVEL*BLANK    WL0118 15
     C                     Z-ADD*ZERO     WL0119  30
     C                     MOVEL*BLANK    WL0120  4
     C                     Z-ADD*ZERO     WL0121  70
     C                     MOVEL*BLANK    WL0122  5
     C                     MOVEL*BLANK    WL0123  3
     C                     MOVEL*BLANK    WL0124  3
     C                     MOVEL*BLANK    WL0125  1
     C                     Z-ADD*ZERO     WL0126  40
     C                     Z-ADD*ZERO     WL0127  72
     C                     Z-ADD*ZERO     WL0128  72
     C                     MOVEL*BLANK    WL0129 25
     C                     Z-ADD*ZERO     WL0130  70
     C                     MOVEL*BLANK    WL0131 25
     C                     Z-ADD*ZERO     WL0132  70
     C                     MOVEL*BLANK    WL0133  1
     C                     Z-ADD*ZERO     WL0134  70
     C                     Z-ADD*ZERO     WL0135  81
     C                     Z-ADD*ZERO     WL0136  80
     C                     Z-ADD*ZERO     WL0137  70
      * Define local work field AMOUNT
     C                     Z-ADD*ZERO     YL0001  82
      * Define local work field Decimal Places    usr
     C                     Z-ADD*ZERO     YL0002  22
      * Define local work field COA Batch RIN Volume
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field COA RIN Volume New usr
     C                     Z-ADD*ZERO     YL0004  80
      * Define local work field HPB Facility or Oldest
     C                     MOVEL*BLANK    YL0005  3
      * Define local work field COA BHR RIN Price
     C                     Z-ADD*ZERO     YL0006  72
      * Define local work field COA BHR Gallon Price
     C                     Z-ADD*ZERO     YL0007  72
      * Define local work field AMOUNT
     C                     Z-ADD*ZERO     YL0008  82
      * Define local work field Decimal Places    usr
     C                     Z-ADD*ZERO     YL0009  22
      * Define local work field Volume to use
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field COA RIN EEEEEEEE  New usr
     C                     Z-ADD*ZERO     YL0011  80
      * Define local work field COA BHR RINs to Sell Sep
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field COA RIN Gallons Sold
     C                     Z-ADD*ZERO     YL0013  80
      * Define local work field COA Batch Hdr RIN Seq Sec
     C                     Z-ADD*ZERO     YL0014  50
      * Define local work field COA GEN EMTS Sts
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field COA RIN EMTS Sts
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field COA Batch RIN
     C                     MOVEL*BLANK    YL0017 38
      * Define local work field COA EMTS Batch Nbr
     C                     Z-ADD*ZERO     YL0018  80
      * Define local work field Company Number     041405
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field COA GEN EMTS Date Sent
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field COA ULSD Facility #
     C                     MOVEL*BLANK    YL0021  5
      * Define local work field COA Batch Header RIN
     C                     MOVEL*BLANK    YL0022 38
      * Define local work field COA BHR Unused Sts 3
     C                     MOVEL*BLANK    YL0023  2
      * Define local work field AMOUNT
     C                     Z-ADD*ZERO     YL0024  82
      * Define local work field Decimal Places    usr
     C                     Z-ADD*ZERO     YL0025  22
      * Define local work field Volume to use
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field COA RIN EEEEEEEE  New usr
     C                     Z-ADD*ZERO     YL0027  80
      * Define local work field COA BHR RINs to Sell Sep
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field COA RIN Gallons Sold
     C                     Z-ADD*ZERO     YL0029  80
      * Define local work field COA Batch Hdr RIN Seq Sec
     C                     Z-ADD*ZERO     YL0030  50
      * Define local work field COA GEN EMTS Sts
     C                     MOVEL*BLANK    YL0031  1
      * Define local work field COA RIN EMTS Sts
     C                     MOVEL*BLANK    YL0032  1
      * Define local work field COA Batch RIN
     C                     MOVEL*BLANK    YL0033 38
      * Define local work field COA EMTS Batch Nbr
     C                     Z-ADD*ZERO     YL0034  80
      * Define local work field Company Number     041405
     C                     Z-ADD*ZERO     YL0035  30
      * Define local work field COA GEN EMTS Date Sent
     C                     Z-ADD*ZERO     YL0036  70
      * Define local work field COA ULSD Facility #
     C                     MOVEL*BLANK    YL0037  5
      * Define local work field COA Batch Header RIN
     C                     MOVEL*BLANK    YL0038 38
      * Define local work field COA BHR Unused Sts 3
     C                     MOVEL*BLANK    YL0039  2
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 HPBFACOLD
