/********************************************************************/
/*                                                                   */
/*  SYNOPSIS -  SUBMIT PRINT ACCRUAL YTD SUMMARY FOR CUSTOMER        */
/*                                                                   */
/*  SYSTEM    - ORDER MANAGEMENT SYSTEM                              */
/*  DATE      - 06/25/2007                                           */
/*                                                                   */
/*      PARAMETERS:                                                  */
/*                                                                   */
/*     I    &ACCRTYPE   - ACCRUAL TYPE (REQUIERED)                   */
/*     I    &LDGRYN     - LEDGER ACCRUAL (REQUIRED)                  */
/*     I    &ACCRCODE   - ACCRUAL CODE ("BRK")                       */
/*     I    &CUSTN      - CUSTOMER    (OPTIONAL)                     */
/*     I    &APPLIC     - APPLICATION CODE                           */
/*     I    &OUTQ       - OUTPUT QUEUE                               */
/*     I    &HOLD       - HOLD STATUS                                */
/*     I    &SAVE       - SAVE STATUS                                */
/*     I    &NQSTS      - NIGHT QUEUE STATUS                         */
/*     I    &NQ         - NIGHT QUEUE                                */
/*     I    &FPERN      - FROM FISCAL PERIOD PASS                    */
/*     I    &TPERN      - THRU FISCAL PERIOD PASS                    */
/*     I    &FYEARN     - FISCAL YEAR - PASS                         */
/*     I    &COPYN      - NO. OF COPIES (PASSED)                     */
/*     I    &EMAIL      - EMAIL ADDRESS                              */
/*     I    &EMAILFMT   - EMAIL FORMAT                               */
/*                                                                   */
/*********************************************************************/
 PMITUPC:    PGM        PARM(&APPLIC &OUTQ &HOLD &SAVE &NQSYS &NQ +
                          &YEARN &FPERN &TPERN &COPYN &CUSTN +
                          &ACCRTYPE &ACCRCODE &LDGRYN &EMAIL &EMAILFMT)
/* PARMS                                                             */
        DCL    &APPLIC     *CHAR   (10)          /* APPLICATION CODE */
        DCL    &OUTQ       *CHAR   (10)          /* Output Queue     */
        DCL    &HOLD       *CHAR   (4)           /* Hold Status      */
        DCL    &SAVE       *CHAR   (4)           /* Save Status      */
        DCL    &NQSYS      *CHAR   (1)           /* NQ RUN STATUS    */
        DCL    &NQ         *CHAR   (7)           /* NIGHT QUEUE      */
        DCL    &FPERN      *DEC                  /* FROM PERD PASS   */
        DCL    &TPERN      *DEC                  /* TO PERIOD PASS   */
        DCL    &YEARN      *DEC                  /* FISCAL YEAR PASS */
        DCL    &COPYN      *DEC                  /* # COPIES PASS    */
        DCL    &ACCRTYPE   *CHAR   (2)           /* NQ RUN STATUS    */
        DCL    &ACCRCODE   *CHAR   (3)           /* NQ RUN STATUS    */
        DCL    &LDGRYN     *CHAR   (1)           /* NQ RUN STATUS    */
        DCL    &EMAILFMT   *CHAR   (5)           /* EMAIL FORMAT     */
        DCL    &EMAIL      *CHAR   (50)          /* EMAIL ADDRESS    */
        DCL    &CUSTN      *DEC                  /* CUSTOMER NUMBER  */

/* ERROR MESSAGE FIELDS                                              */
        DCL    &MSG        *CHAR   (512)         /* message          */
        DCL    &MSGID      *CHAR   (7)           /* message id       */
        DCL    &MSGL       *DEC    (5 0)

/*********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                       */
/*********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/* SUBMIT THE CL THAT WILL CALL THE REPORT PROGRAM                  */
/********************************************************************/
             SBMJOB     CMD(CALL PGM(PMI1UPC) PARM(&OUTQ &HOLD &SAVE +
                          &NQSYS &NQ &FPERN &TPERN &YEARN &COPYN +
                          &ACCRTYPE &ACCRCODE &LDGRYN &CUSTN +
                          &EMAILFMT &EMAIL)) JOB(ACRLBYCUST)

             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
