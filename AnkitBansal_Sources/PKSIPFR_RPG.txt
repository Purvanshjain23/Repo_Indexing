     H/TITLE Prt FOM Summary       PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 11/09/20  Time  : 01:38:01
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKBOREL1IF  E           K        DISK
      * RTV : Evaluation Validation     Retrieval index
      *
     FPKA1CPNCIF  E           K        DISK
      * RSQ : Tattoo Header             Co/KDte/Prd/BOL/Tto
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKCPCPLBIF  E           K        DISK
      * RSQ : Eval Trans UPL            Co/Tattoo/KDte
      *
     FPKBVCPL9IF  E           K        DISK
      * RSQ : Eval Trans                Co/Bol/KillDt/Tattoo
      *
     FPKB1CPLGIF  E           K        DISK
      * RSQ : Carcass Detail            Co/BOL/Tto/KDte/Grs$(d)
      *
     FPKA1CPNHIF  E           K        DISK
      * RSQ : Tattoo Header             Co/KDte/Src/Prd/BOL/Tto
      *
     FPKB1CPL0IF  E           K        DISK                      A
      * UPD : Carcass Detail            Update index
      *
     FPKEVCPL0IF  E           K        DISK                      A
      * UPD : FOM Summary OUTF          Update index
      *
     FPKSIPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt FOM Summary       PF  Print file
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@B1CPC3
      * Carcass Detail            Co/BOL/Tto/KDte/Grs$(d)
      * Renamed input format fields
     I              B1HMNB                          WAHMNB
     I              B1BNNB                          WABNNB
     I              B1BONB                          WABONB
     I              B1CVNB                          WACVNB
     I              B1B0DT                          WAB0DT
     I              B1LGNB                          WALGNB
     I              B1EUNB                          WAEUNB
     I              B1LHNB                          WALHNB
     I              B1INST                          WAINST
     I              B1BEPR                          WABEPR
     I              B1ASPC                          WAASPC
     I              B1EWNB                          WAEWNB
     I              B1B4PR                          WAB4PR
     I              B1EYNB                          WAEYNB
     I              B1B1PR                          WAB1PR
     I              B1AVPR                          WAAVPR
     I              B1AUPC                          WAAUPC
     I              B1AWPR                          WAAWPR
     I              B1AXPR                          WAAXPR
     I              B1EZNB                          WAEZNB
     I              B1AYPR                          WAAYPR
     I              B1BBDT                          WABBDT
     I              B1AKTM                          WAAKTM
     I              B1IQST                          WAIQST
     I              B1EFST                          WAEFST
     I              B1H6NB                          WAH6NB
     I              B1BEPC                          WABEPC
     I              B1GCST                          WAGCST
     I              B1GDST                          WAGDST
     I              B1GEST                          WAGEST
     I              B1BHPC                          WABHPC
     I              B1IOST                          WAIOST
     I              B1IPST                          WAIPST
     I              B1LTNB                          WALTNB
     I              B1JNST                          WAJNST
     I              B1X4NB                          WAX4NB
     I              B1FNPC                          WAFNPC
     I              B1FOPC                          WAFOPC
     I              B1FPPC                          WAFPPC
     I              B1K2ST                          WAK2ST
     I              B1K3ST                          WAK3ST
     I              B1JWPR                          WAJWPR
     I              B1F5PC                          WAF5PC
     I              B1JXPR                          WAJXPR
     I              B1JYPR                          WAJYPR
     I              B1JZPR                          WAJZPR
     I              B1J0PR                          WAJ0PR
     I              B1J1PR                          WAJ1PR
     I              B1J2PR                          WAJ2PR
     I              B1J3PR                          WAJ3PR
     I              B1J4PR                          WAJ4PR
     I              B1UTST                          WAUTST
     I              B1HVCD                          WAHVCD
     I              B1DKJR                          WADKJR
     I              B1ITJF                          WAITJF
     I              B1IJGR                          WAIJGR
     I              B1ORJE                          WAORJE
     I              B1OTJR                          WAOTJR
     I              B1PEIR                          WAPEIR
     I              B1IEUF                          WAIEUF
     I              B1ORUE                          WAORUE
     I              B1IUTR                          WAIUTR
     I              B1IJRR                          WAIJRR
     I              B1VCST                          WAVCST
     I              B1VDST                          WAVDST
     I              B1VEST                          WAVEST
     I              B1VFST                          WAVFST
     I              B1VGST                          WAVGST
     I              B1ABCD                          WAABCD
     I              B1AACD                          WAAACD
     I              B1AAVN                          WAAAVN
     I              B1AADT                          WAAADT
     I              B1AMTM                          WAAMTM
     I              B1AJST                          WAAJST
     I              B1AHVN                          WAAHVN
     I              B1AGVN                          WAAGVN
     I              B1ABVN                          WAABVN
     I              B1ABDT                          WAABDT
     I              B1ABTM                          WAABTM
      *
     I@A1CPDS
      * Tattoo Header             Co/KDte/Src/Prd/BOL/Tto
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
     IQPKB11    E DSPKB1CPL0
      * UPD : Carcass Detail            Update index
      *
     IQPKEV1    E DSPKEVCPL0
      * UPD : FOM Summary OUTF          Update index
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : POS TH Kill Date
     I                                    P   3   60P1B0DT
      * I :  PD Producer Code
     I                                        7  12 P1ABCD
     IP2PARM      DS
      * I :  Date To   USR
     I                                    P   1   40P2B4DT
     IP3PARM      DS
      * FLD: *Arrays
      * I :  TH Payment Type
     I                                        1   1 P3J9ST
      * I :  Variance Type USR
     I                                        2   2 P3TVST
      * N :  Analysis Type USR
     I                                        3   4 P3T6ST
      * I :  Include Market USR
     I                                        5   5 P3TXST
      * I :  Include Subject USR
     I                                        6   6 P3TYST
      * I :  Include Resale USR
     I                                        7   7 P3TWST
      * I :  Report Type Sum/Dtl USR
     I                                        8   8 P3M1ST
      * N :  Payment Data Type USR
     I                                        9  10 P3T5ST
      * N :  Head Received CNT USR
     I                                    P  11  140P3HRCT
      * N :  Head Received SBD USR
     I                                    P  15  180P3HRSB
      * N :  Head Received ODB USR
     I                                    P  19  220P3HROD
      * N :  Head Excep CNT USR
     I                                    P  23  260P3HESS
      * N :  Head Excep SBD USR
     I                                    P  27  300P3HSDL
      * N :  Head Excep OTH USR
     I                                    P  31  340P3HDSL
      * N :  Head Total CNT USR
     I                                    P  35  380P3KDSK
      * N :  Head Total SBD USR
     I                                    P  39  420P3KDKW
      * N :  Head Total OTH USR
     I                                    P  43  460P3KJOW
      * N :  Head Diff CNT USR
     I                                    P  47  500P3KOSF
      * N :  Head Diff SBD USR
     I                                    P  51  540P3IJMB
      * N :  Head Diff OTH USR
     I                                    P  55  580P3KOIW
      * N :  Head Killed CNT USR
     I                                    P  59  620P3HKCT
      * N :  Head Killed SBD USR
     I                                    P  63  660P3HKSB
      * N :  Head Killed ODB USR
     I                                    P  67  700P3HKOD
     IP4PARM      DS
      * I :  TH Tattoo Number
     I                                    P   1   30P4CVNB
     IP5PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P5EVTX
     IP6PARM      DS
      * N :  Difference +/-
     I                                    P   1   40P6IINB
     IP7PARM      DS
      * N :  Count USR
     I                                    P   1   20P7P0NB
     IP8PARM      DS
      * N :  TOT Head Kill Bk 1 Usr
     I                                    P   1   40P8O6NB
     IP9PARM      DS
      * N :  TOT Head Kill Bk 2 Usr
     I                                    P   1   40P9O7NB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1B0DT    PARM           WP0002  70       TH Kill Date
     C           P1ABCD    PARM           WP0003  6        PD Producer Cod
     C           P2B4DT    PARM           WP0004  70       Date To   USR
     C           P3J9ST    PARM           WP0005  1        TH Payment Type
     C           P3TVST    PARM           WP0006  1        Variance Type U
     C           P3TXST    PARM           WP0007  1        Include Market
     C           P3TYST    PARM           WP0008  1        Include Subject
     C           P3TWST    PARM           WP0009  1        Include Resale
     C           P3M1ST    PARM           WP0010  1        Report Type Sum
     C           P4CVNB    PARM           WP0011  50       TH Tattoo Numbe
     C           P5EVTX    PARM           WP0012 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt FOM Summary       PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$YENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt FOM Summary       PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQKA01           BOH Company Num
      * Define keylist
     C           KPSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
     C                     KFLD           A1B0DT           TH Kill Date
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           BOH Company Num
      * Setup key
     C                     Z-ADDP1HMNB    WQKA01           BOH Company Num
     C                     Z-ADDP1B0DT    A1B0DT           TH Kill Date
      * Establish starting position
     C           KPSA      SETLL@A1CPCH                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL03  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL04  1        BOL Load Number
     C                     MOVEL'Y'       W0AL05  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BHMNB           BOH Company Num
     C                     MOVEL*BLANK    $BEUTX           Oms Name
     C                     Z-ADD*ZERO     $BB3DT           Date From USR
     C                     Z-ADD*ZERO     $BB4DT           Date To   USR
     C                     MOVEL*BLANK    $BM1ST           Report Type Sum
     C                     MOVEL*BLANK    $BOFTX           Text 25 2 USR
     C                     MOVEL*BLANK    $BTXST           Include Market
     C                     MOVEL*BLANK    $BI2TX           Condition Name
     C                     MOVEL*BLANK    $BTYST           Include Subject
     C                     MOVEL*BLANK    $BI3TX           Condition Name
     C                     MOVEL*BLANK    $BTWST           Include Resale
     C                     MOVEL*BLANK    $BI4TX           Condition Name
     C                     MOVEL*BLANK    $BABCD           PD Producer Cod
     C                     MOVEL*BLANK    $BA4TX           Producer Name
     C                     MOVEL*BLANK    $BJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $BC4TX           Condition Name
     C                     MOVEL*BLANK    $BTVST           Variance Type U
     C                     MOVEL*BLANK    $BI1TX           Condition Name
     C                     MOVEL*BLANK    $BLIST           TH Schedule Kil
     C                     MOVEL*BLANK    $BFSTX           Shift Descripti
      * Load related totals format
     C                     Z-ADD*ZERO     $XHRCT           Head Received C
     C                     Z-ADD*ZERO     $XHESS           Head Excep CNT
     C                     Z-ADD*ZERO     $XKDSK           Head Total CNT
     C                     Z-ADD*ZERO     $XKOSF           Head Diff CNT U
     C                     Z-ADD*ZERO     $XHKCT           Head Killed CNT
     C                     Z-ADD*ZERO     $XHRSB           Head Received S
     C                     Z-ADD*ZERO     $XHSDL           Head Excep SBD
     C                     Z-ADD*ZERO     $XKDKW           Head Total SBD
     C                     Z-ADD*ZERO     $XIJMB           Head Diff SBD U
     C                     Z-ADD*ZERO     $XHKSB           Head Killed SBD
     C                     Z-ADD*ZERO     $XHROD           Head Received O
     C                     Z-ADD*ZERO     $XHDSL           Head Excep OTH
     C                     Z-ADD*ZERO     $XKJOW           Head Total OTH
     C                     Z-ADD*ZERO     $XKOIW           Head Diff OTH U
     C                     Z-ADD*ZERO     $XHKOD           Head Killed ODB
     C                     Z-ADD*ZERO     $XHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $XCDNB           Head held over
     C                     Z-ADD*ZERO     $XWWNB           Head Received 1
     C                     Z-ADD*ZERO     $XYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $XGONB           HEad Condemned
     C                     Z-ADD*ZERO     $XB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $XXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $XH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $XHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $XWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $XHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $XH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $XHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $XHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $XHDST           Display Field U
     C                     Z-ADD*ZERO     $XH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $XH2SM           Head 2 SUM
     C                     Z-ADD*ZERO     $XO6NB           TOT Head Kill B
     C                     Z-ADD*ZERO     $XO7NB           TOT Head Kill B
     C                     Z-ADD*ZERO     $XF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $XX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $XWTNB           Hot Weight 1 SU
     C                     Z-ADD*ZERO     $XHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     $XF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     $XF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     $XF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     $XAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $XHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $CHMNB           BOH Company Num
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDA1HMNB    $WHMNB           BOH Company Num
     C                     Z-ADDA1B0DT    $WB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $WHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $WCDNB           Head held over
     C                     Z-ADD*ZERO     $WWWNB           Head Received 1
     C                     Z-ADD*ZERO     $WYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $WGONB           HEad Condemned
     C                     Z-ADD*ZERO     $WB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $WXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $WH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $WHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $WWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $WHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $WH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $WHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $WHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $WHDST           Display Field U
     C                     Z-ADD*ZERO     $WH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $WH2SM           Head 2 SUM
     C                     Z-ADDA1F7NB    $WF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $WX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $WWTNB           Hot Weight 1 SU
     C                     Z-ADDA1HDNB    $WHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F4NB    $WF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $WF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $WF2NB           TH Avg Backfat
     C                     Z-ADDA1AWPC    $WAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $WHCSM           Head Count SUM
     C                     MOVELA1ABCD    $WABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDA1HMNB    $GHMNB           BOH Company Num
     C                     MOVELA1ABCD    $GABCD           PD Producer Cod
     C                     Z-ADD*ZERO     $GHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $GCDNB           Head held over
     C                     Z-ADD*ZERO     $GWWNB           Head Received 1
     C                     Z-ADD*ZERO     $GYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $GGONB           HEad Condemned
     C                     Z-ADD*ZERO     $GB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $GXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $GH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $GHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $GWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $GHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $GH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $GHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $GHD5S           Head 5 SUM
     C                     Z-ADD*ZERO     $GH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $GH2SM           Head 2 SUM
     C                     Z-ADDA1F7NB    $GF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $GX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $GWTNB           Hot Weight 1 SU
     C                     Z-ADDA1HDNB    $GHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F4NB    $GF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $GF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $GF2NB           TH Avg Backfat
     C                     Z-ADDA1AWPC    $GAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $GHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDA1HMNB    $DHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $DBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $DBONB           BOL Load Number
     C                     Z-ADDA1B0DT    $DB0DT           TH Kill Date
     C                     MOVELA1ABCD    $DABCD           PD Producer Cod
      * Load related totals format
     C                     Z-ADDA1HMNB    $FHMNB           BOH Company Num
     C                     Z-ADDA1BNNB    $FBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $FBONB           BOL Load Number
     C                     Z-ADD*ZERO     $FHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $FCDNB           Head held over
     C                     Z-ADD*ZERO     $FQENB           Head Received
     C                     Z-ADD*ZERO     $FYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $FGONB           HEad Condemned
     C                     Z-ADD*ZERO     $FB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $FXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $FH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $FHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $FNINB           Head Killed SUM
     C                     Z-ADD*ZERO     $FHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $FH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $FHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $FHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $FHDST           Display Field U
     C                     Z-ADD*ZERO     $FH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $FH2SM           Head 2 SUM
     C                     Z-ADDA1F7NB    $FF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $FX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $FWTNB           Hot Weight 1 SU
     C                     Z-ADDA1HDNB    $FHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F4NB    $FF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $FF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $FF2NB           TH Avg Backfat
     C                     Z-ADDA1AWPC    $FAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $FHCSM           Head Count SUM
     C                     MOVEL*BLANK    $FIXTX           Blank Usr 1 fld
     C                     Z-ADDA1B0DT    $FB0DT           TH Kill Date
     C                     MOVELA1ABCD    $FABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDA1HMNB    $EHMNB           BOH Company Num
     C                     MOVELA1ABCD    $EABCD           PD Producer Cod
     C                     Z-ADDA1B0DT    $EB0DT           TH Kill Date
     C                     Z-ADDA1BNNB    $EBNNB           BOH Buy Order N
     C                     Z-ADDA1BONB    $EBONB           BOL Load Number
     C                     Z-ADDA1CVNB    $ECVNB           TH Tattoo Numbe
     C                     MOVELA1J9ST    $EJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $EIYTX           Th Payment Type
     C                     MOVEL*BLANK    $EJPTX           Text 10 1 USR
     C                     Z-ADDA1AWDT    $EAWDT           TH Purchase Dat
     C                     MOVELA1BICD    $EBICD           TH Group Refere
     C                     MOVELA1CPST    $ECPST           TH Live Purchas
     C                     Z-ADDA1ACPR    $EACPR           TH Live Purchas
     C                     Z-ADDA1B9PR    $EB9PR           TH Live Gross A
     C                     Z-ADDA1CAPR    $ECAPR           TH LIve Net Amt
     C                     MOVELA1C4ST    $EC4ST           TH Resale UOM
     C                     Z-ADDA1AIPR    $EAIPR           TH Recalc Live
     C                     Z-ADDA1A6DT    $EA6DT           TH Pricing Date
     C                     MOVELA1C2ST    $EC2ST           TH Resale Sprea
     C                     Z-ADDA1CXNB    $ECXNB           TH Dead On Arri
     C                     Z-ADDA1H9NB    $EH9NB           TH Held Over
     C                     Z-ADDA1CWNB    $ECWNB           TH Head Receive
     C                     Z-ADDA1FCNB    $EFCNB           TH Yard Deads
     C                     Z-ADDA1FDNB    $EFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $ELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ELINB           Head 2
     C                     Z-ADD*ZERO     $ECRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $EIINB           Difference +/-
     C                     Z-ADDA1FENB    $EFENB           TH Head Killed
     C                     Z-ADD*ZERO     $EMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $EHD3C           Head 3
     C                     Z-ADD*ZERO     $EHD4C           Head 4
     C                     Z-ADD*ZERO     $EHD5C           Head 5
     C                     MOVEL*BLANK    $EHDST           Display Field U
     C                     Z-ADD*ZERO     $EH1US           Head 1 USR
     C                     Z-ADD*ZERO     $EH2US           Head 2 USR
     C                     Z-ADDA1HENB    $EHENB           TH Head Adds
     C                     Z-ADDA1HFNB    $EHFNB           TH Head Accepte
     C                     Z-ADDA1CYNB    $ECYNB           TH Live Wgt
     C                     Z-ADDA1LRNB    $ELRNB           TH Adj Live Wgt
     C                     Z-ADDA1E0NB    $EE0NB           TH Hot Wgt
     C                     Z-ADDA1A5PC    $EA5PC           TH Tot Loin Eye
     C                     Z-ADDA1FBNB    $EFBNB           TH Tot Backfat
     C                     Z-ADDA1A4PC    $EA4PC           TH Tot Light Re
     C                     Z-ADDA1F7NB    $EF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $EKGNB           Hot Weight Tot
     C                     Z-ADDA1HDNB    $EHDNB           TH Avg Hot Wgt
     C                     Z-ADDA1F5NB    $EF5NB           TH Avg Light Re
     C                     Z-ADDA1F4NB    $EF4NB           TH Avg Lean Per
     C                     Z-ADDA1F3NB    $EF3NB           TH Avg Loin Eye
     C                     Z-ADDA1F2NB    $EF2NB           TH Avg Backfat
     C                     Z-ADDA1AVPC    $EAVPC           TH Std Yield Pe
     C                     Z-ADDA1AWPC    $EAWPC           TH Actual Yield
     C                     Z-ADDA1CBPR    $ECBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $EB5NB           Head Total USR
     C                     Z-ADDA1CWPC    $ECWPC           TH Adj Actual Y
     C                     Z-ADDA1A8PC    $EA8PC           TH Yield Differ
     C                     Z-ADDA1A7PC    $EA7PC           TH Recalc Live
     C                     Z-ADDA1B8PR    $EB8PR           TH CM Market Pr
     C                     Z-ADDA1AMPR    $EAMPR           TH CM Base Mkt
     C                     Z-ADDA1ANPR    $EANPR           TH CM Base Mkt
     C                     Z-ADDA1AYVA    $EAYVA           TH CM Sort Disc
     C                     Z-ADDA1AWVA    $EAWVA           TH CM Yield Gai
     C                     Z-ADDA1AOPR    $EAOPR           TH CM Base Carc
     C                     Z-ADDA1AXVA    $EAXVA           TH CM LN AddOn/
     C                     Z-ADDA1APPR    $EAPPR           TH CM Carcass G
     C                     Z-ADDA1ASPR    $EASPR           TH Deduction Am
     C                     Z-ADDA1A4VA    $EA4VA           TH Total Net WO
     C                     Z-ADDA1ATPR    $EATPR           TH Carcass Net
     C                     Z-ADDA1A5VA    $EA5VA           TH Additions Am
     C                     Z-ADDA1CCPR    $ECCPR           Th Payment Net
     C                     Z-ADDA1LPNB    $ELPNB           TH AP Voucher/D
     C                     Z-ADDA1CDPR    $ECDPR           TH Freight Amou
     C                     Z-ADDA1A7VA    $EA7VA           TH Accrual Amou
     C                     Z-ADDA1A2PR    $EA2PR           TH Fixed Cost A
     C                     MOVELA1JWST    $EJWST           TH Calc Net Sts
     C                     MOVELA1CWST    $ECWST           TH Payment Sts
     C                     MOVELA1D7ST    $ED7ST           TH Header Error
     C                     MOVELA1D8ST    $ED8ST           TH Detail Error
     C                     MOVELA1DWST    $EDWST           TH Kill Balanci
     C                     MOVELA1D6ST    $ED6ST           TH Bal to Kill
     C                     Z-ADDA1GHNB    $EGHNB           TH Commission A
     C                     Z-ADDA1BYDT    $EBYDT           TH Voucher Paym
     C                     MOVELA1E0ST    $EE0ST           TH User Error O
     C                     MOVELA1E1ST    $EE1ST           TH Held Over Re
     C                     MOVELA1E2ST    $EE2ST           TH Sex
     C                     Z-ADDA1BSDT    $EBSDT           TH Held/Ovr Com
     C                     Z-ADDA1BTDT    $EBTDT           TH Commission P
     C                     Z-ADDA1BUDT    $EBUDT           TH Actual Check
     C                     Z-ADDA1HGNB    $EHGNB           TH Shipped Weig
     C                     Z-ADDA1HHNB    $EHHNB           TH Avg Hot Wgt
     C                     Z-ADDA1HINB    $EHINB           TH FFLI
     C                     Z-ADDA1A3PR    $EA3PR           TH Kill Product
     C                     Z-ADDA1A4PR    $EA4PR           TH Cut Product
     C                     Z-ADDA1A6PR    $EA6PR           TH Render Produ
     C                     Z-ADDA1J9NB    $EJ9NB           TH Head Exclude
     C                     Z-ADDA1D6PR    $ED6PR           TH CM Bse Mkt L
     C                     Z-ADDA1D7PR    $ED7PR           TH CM Bse Mkt C
     C                     Z-ADDA1D8PR    $ED8PR           TH CM Srt Dsc L
     C                     Z-ADDA1D9PR    $ED9PR           TH CM Srt Dsc C
     C                     Z-ADDA1EAPR    $EEAPR           TH CM Yld G/L L
     C                     Z-ADDA1EBPR    $EEBPR           TH CM Yld G/L C
     C                     Z-ADDA1ECPR    $EECPR           TH CM Crc Val L
     C                     Z-ADDA1EDPR    $EEDPR           TH CM Crc Val C
     C                     Z-ADDA1EEPR    $EEEPR           TH CM Lean Prem
     C                     Z-ADDA1EFPR    $EEFPR           TH CM Lean Prem
     C                     Z-ADDA1EGPR    $EEGPR           TH CM Gross Liv
     C                     Z-ADDA1EHPR    $EEHPR           TH CM Gross Car
     C                     MOVELA1KAST    $EKAST           TH Source Type
     C                     MOVELA1J7ST    $EJ7ST           TH Scale Ticket
     C                     Z-ADDA1OXNB    $EOXNB           TH HPS Movement
     C                     MOVELA1LKST    $ELKST           TH Source Code
     C                     MOVELA1LLST    $ELLST           TH Hog Class Ty
     C                     MOVELA1J8ST    $EJ8ST           TH Posted to HP
     C                     MOVELA1LIST    $ELIST           TH Schedule Kil
     C                     MOVELA1LJST    $ELJST           TH Shift Held O
     C                     MOVELA1NZTX    $ENZTX           TH State
     C                     MOVELA1HJCD    $EHJCD           TH Unused Code
     C                     MOVELA1R4ST    $ER4ST           TH Unused Sts 2
     C                     MOVELA1R5ST    $ER5ST           TH Commission S
     C                     MOVELA1R6ST    $ER6ST           TH Paid 2 Week
     C                     MOVELA1R7ST    $ER7ST           TH Unused Sts 1
     C                     Z-ADDA1THWT    $ETHWT           TH DOA Weight
     C                     Z-ADDA1T2WT    $ET2WT           TH Avg Lean % E
     C                     Z-ADDA1THHD    $ETHHD           TH HPS Farm Sit
     C                     Z-ADDA1T2HD    $ET2HD           TH Shift Held O
     C                     Z-ADDA1OBPR    $EOBPR           TH Sorting Amou
     C                     Z-ADDA1KOER    $EKOER           TH Head Identif
     C                     Z-ADDA1OPIR    $EOPIR           TH Percent Iden
     C                     Z-ADDA1OPEM    $EOPEM           TH Percent Acce
     C                     Z-ADDA1IORP    $EIORP           TH Head Adjuste
     C                     Z-ADDA1OWEO    $EOWEO           TH PHA Head Add
     C                     MOVELA1OQET    $EOQET           TH PHA Add Type
     C                     MOVELA1URST    $EURST           TH PHA Average
     C                     MOVELA1USST    $EUSST           TH PHA Add Reas
     C                     Z-ADDA1HHPC    $EHHPC           TH PHA Yield Pe
     C                     Z-ADDA1S9PR    $ES9PR           TH PHA Lean Prm
     C                     Z-ADDA1TAPR    $ETAPR           TH VC Gross Val
     C                     Z-ADDA1TBPR    $ETBPR           TH Excluded Gro
     C                     Z-ADDA1JFUR    $EJFUR           TH Avg Lean %
     C                     Z-ADDA1KRIF    $EKRIF           TH Broken Back
     C                     Z-ADDA1KORF    $EKORF           TH Hot Scl Uplo
     C                     Z-ADDA1KAPR    $EKAPR           TH Unused Nbr 4
     C                     Z-ADDA1KROT    $EKROT           TH Excluded Car
     C                     Z-ADDA1OTJG    $EOTJG           TH Excluded Pre
     C                     Z-ADDA1IRJG    $EIRJG           TH Unused Nbr 7
     C                     Z-ADDA1IMJF    $EIMJF           TH Unused Nbr 8
     C                     Z-ADDA1IRGF    $EIRGF           TH Unused Nbr 9
     C                     Z-ADDA1KRJF    $EKRJF           TH Unused Nbr 1
     C                     Z-ADDA1OJRF    $EOJRF           TH Break Even P
     C                     Z-ADDA1KFOR    $EKFOR           TH Meat Value F
     C                     Z-ADDA1ORJK    $EORJK           TH Yld Parm Adj
     C                     Z-ADDA1OMVJ    $EOMVJ           TH PHA Sort Dis
     C                     Z-ADDA1MVNF    $EMVNF           TH Avg Loin Eye
     C                     Z-ADDA1MCNF    $EMCNF           TH Avg Backfat
     C                     Z-ADDA1NCNF    $ENCNF           TH HITCH Old Pa
     C                     Z-ADDA1NCHF    $ENCHF           TH MPR Sort Los
     C                     Z-ADDA1IGIR    $EIGIR           TH Unused Nbr 1
     C                     Z-ADDA1KFJR    $EKFJR           TH Unused Nbr 2
     C                     Z-ADDA1EADT    $EEADT           TH Cold Scl Upl
     C                     Z-ADDA1EBDT    $EEBDT           TH Cold Scl Upl
     C                     Z-ADDA1ECDT    $EECDT           TH Head LFT
     C                     Z-ADDA1EDDT    $EEDDT           TH Head EUT/KOA
     C                     Z-ADDA1EEDT    $EEEDT           TH Unused Date
     C                     MOVELA1U4ST    $EU4ST           TH Unused Sts 1
     C                     MOVELA1U5ST    $EU5ST           TH Unused Sts 2
     C                     MOVELA1U6ST    $EU6ST           TH Unused Sts 3
     C                     MOVELA1U7ST    $EU7ST           TH Unused Sts 4
     C                     MOVELA1U8ST    $EU8ST           TH Unused Sts 5
     C                     MOVELA1U9ST    $EU9ST           TH Unused Sts 6
     C                     MOVELA1VAST    $EVAST           TH Unused Sts 7
     C                     MOVELA1VBST    $EVBST           TH Unused Sts 8
     C                     MOVELA1AGCD    $EAGCD           GN Genetic Code
     C                     MOVELA1BECD    $EBECD           HC Class Code
     C                     MOVELA1BDCD    $EBDCD           DF Defect Code
     C                     MOVELA1CSCD    $ECSCD           THP Process Cod
     C                     MOVELA1AECD    $EAECD           PL Location Cod
     C                     MOVELA1ACCD    $EACCD           HB Buyer Code
     C                     MOVELA1AAVN    $EAAVN           RS User Changed
     C                     Z-ADDA1AADT    $EAADT           RS Date Changed
     C                     Z-ADDA1AMTM    $EAMTM           RS Time Changed
     C                     MOVELA1AJST    $EAJST           RS Record Statu
     C                     MOVELA1AHVN    $EAHVN           RS Job
     C                     MOVELA1AGVN    $EAGVN           RS Program
     C                     MOVELA1ABVN    $EABVN           RS User Added
     C                     Z-ADDA1ABDT    $EABDT           RS Date Added
     C                     Z-ADDA1ABTM    $EABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * Only add if printing the detail.
      * CASE: LCL.*Record selected is *YES
     C           YL0010    IFEQ 'Y'                        *IF
     C                     ADD  1         P7P0NB           Count USR
     C                     ADD  $ECXNB    $FHD5U           DOA Head Total
     C                     ADD  $ECWNB    $FQENB           Head Received
     C                     ADD  $EFCNB    $FYDSM           Yard Dead SUM
     C                     ADD  $EFDNB    $FGONB           HEad Condemned
     C                     ADD  $EFENB    $FNINB           Head Killed SUM
     C                     ADD  $ELFNB    $FB4NB           Head Total SUM
     C                     ADD  $ELINB    $FXRNB           Head Total Sum2
     C                     ADD  $ECRNB    $FH5SM           Head Total Sum5
     C                     ADD  $EIINB    $FHTS3           Head Total Sum3
     C                     ADD  $EHD3C    $FH3SM           Head 3 SUM
     C                     ADD  $EHD4C    $FHD4S           Head 4 SUM
     C                     ADD  $EHD5C    $FHD5S           Head 5 SUM
     C                     ADD  $EMWNB    $FHTS4           Head Total Sum4
     C                     ADD  $EKGNB    $FWTNB           Hot Weight 1 SU
     C                     ADD  $ECYNB    $FX5NB           Live Weight SUM
     C                     ADD  $EH1US    $FH1SM           Head 1 SUM
     C                     ADD  $EH2US    $FH2SM           Head 2 SUM
     C                     ADD  $EB5NB    $FHCSM           Head Count SUM
     C                     END                             *FI
      * Short/Over
      * CASE: PAR.Difference +/- is GE ZERO
     C           P6IINB    IFGE *ZERO                      *IF
     C                     ADD  $EIINB    P8O6NB           TOT Head Kill B
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $EIINB    P9O7NB           TOT Head Kill B
     C                     END                             *FI
     C                     ADD  $EH9NB    $FCDNB           Head held over
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN A1HMNB    WZA001           BOH Company Num
     C                     Z-ADDA1HMNB    WZA001
     C           *LIKE     DEFN A1B0DT    WZA002           TH Kill Date
     C                     Z-ADDA1B0DT    WZA002
     C           *LIKE     DEFN A1ABCD    WZA003           PD Producer Cod
     C                     MOVELA1ABCD    WZA003
     C           *LIKE     DEFN A1BNNB    WZA004           BOH Buy Order N
     C                     Z-ADDA1BNNB    WZA004
     C           *LIKE     DEFN A1BONB    WZA005           BOL Load Number
     C                     Z-ADDA1BONB    WZA005
     C           *LIKE     DEFN A1CVNB    WZA006           TH Tattoo Numbe
     C                     Z-ADDA1CVNB    WZA006
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@A1CPCH                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * EOFSEL:  Kill Date
      * CASE: DB1.TH Kill Date GT PAR.Date To   USR
     C           A1B0DT    IFGT P2B4DT                     *IF
      * EOF File A            US - STR User Source Functions  * 
     C                     MOVEL'1'       W0EOFA           END OF FILE
     C                     END                             *FI
      * REQSEL:  Include Market
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Market USR is No
      *   |- c2    : DB1.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TXST    IFEQ 'N'                        *IF
     C           A1LLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Subject
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Subject USR is No
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TYST    IFEQ 'N'                        *IF
     C           A1LLST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Resale
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Resale USR is No
      *   |- c2    : DB1.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TWST    IFEQ 'N'                        *IF
     C           A1LLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OPTSEL:  Producer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.PD Producer Code is Entered
      *   |- c2    : PAR.PD Producer Code NE DB1.PD Producer Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1ABCD    IFNE *BLANK                     *IF
     C           P1ABCD    IFNE A1ABCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OPTSEL:  Payment Type
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Payment Type is Carcass/Live
      *   |- c2    : PAR.TH Payment Type NE DB1.TH Payment Type
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3J9ST    IFEQ 'C'                        *IF
     C           P3J9ST    OREQ 'L'
     C           P3J9ST    IFNE A1J9ST                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * OPTSEL:  Tattoo Number
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.TH Tattoo Number is NE Zero
      *   |- c2    : PAR.TH Tattoo Number NE DB1.TH Tattoo Number
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P4CVNB    IFNE *ZERO                      *IF
     C           P4CVNB    IFNE A1CVNB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * INTSEL:  Head Received
      * CASE: DB1.TH Head Received is *Zeros
     C           A1CWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0AL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0AL02  1        PD Producer Cod
     C                     MOVEL*BLANK    W0AL03  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0AL04  1        BOL Load Number
     C                     MOVEL*BLANK    W0AL05  1        TH Tattoo Numbe
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        BOH Company Num
     C                     MOVEL'Y'       W0AL01  1        TH Kill Date
     C                     MOVEL'Y'       W0AL02  1        PD Producer Cod
     C                     MOVEL'Y'       W0AL03  1        BOH Buy Order N
     C                     MOVEL'Y'       W0AL04  1        BOL Load Number
     C                     MOVEL'Y'       W0AL05  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           A1HMNB    IFNE WZA001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           A1B0DT    IFNE WZA002                     TH Kill Date
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           A1ABCD    IFNE WZA003                     PD Producer Cod
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           A1BNNB    IFNE WZA004                     BOH Buy Order N
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           A1BONB    IFNE WZA005                     BOL Load Number
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           A1CVNB    IFNE WZA006                     TH Tattoo Numbe
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * USER: On print of BOL Load Number format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $FHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * More then one Tattoo.
      * CASE: PAR.Count USR is Greater than 1
     C           P7P0NB    IFGT 1                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Report Type = Summary
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$FKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
      * USER: Process after print of BOL Load Number format
     C                     ADD  $FHD5U    $GHD5U           DOA Head Total
     C                     ADD  $FQENB    $GWWNB           Head Received 1
     C                     ADD  $FYDSM    $GYDSM           Yard Dead SUM
     C                     ADD  $FGONB    $GGONB           HEad Condemned
     C                     ADD  $FNINB    $GWUNB           Head Killed 1 S
     C                     ADD  $FB4NB    $GB4NB           Head Total SUM
     C                     ADD  $FXRNB    $GXRNB           Head Total Sum2
     C                     ADD  $FHTS3    $GHTS3           Head Total Sum3
     C                     ADD  $FHTS4    $GHTS4           Head Total Sum4
     C                     ADD  $FH1SM    $GH1SM           Head 1 SUM
     C                     ADD  $FH2SM    $GH2SM           Head 2 SUM
     C                     ADD  $FH3SM    $GH3SM           Head 3 SUM
     C                     ADD  $FHD4S    $GHD4S           Head 4 SUM
     C                     ADD  $FHD5S    $GHD5S           Head 5 SUM
     C                     ADD  $FWTNB    $GWTNB           Hot Weight 1 SU
     C                     ADD  $FX5NB    $GX5NB           Live Weight SUM
     C                     ADD  $FHCSM    $GHCSM           Head Count SUM
     C                     ADD  $FH5SM    $GH5SM           Head Total Sum5
     C                     ADD  $FCDNB    $GCDNB           Head held over
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * USER: On print of PD Producer Code format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $GHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.PD Producer Code is Entered
     C           P1ABCD    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$GKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
      * USER: Process after print of PD Producer Code format
     C                     ADD  $GHD5U    $WHD5U           DOA Head Total
     C                     ADD  $GYDSM    $WYDSM           Yard Dead SUM
     C                     ADD  $GWWNB    $WWWNB           Head Received 1
     C                     ADD  $GGONB    $WGONB           HEad Condemned
     C                     ADD  $GWUNB    $WWUNB           Head Killed 1 S
     C                     ADD  $GB4NB    $WB4NB           Head Total SUM
     C                     ADD  $GXRNB    $WXRNB           Head Total Sum2
     C                     ADD  $GHTS3    $WHTS3           Head Total Sum3
     C                     ADD  $GHTS4    $WHTS4           Head Total Sum4
     C                     ADD  $GH1SM    $WH1SM           Head 1 SUM
     C                     ADD  $GH2SM    $WH2SM           Head 2 SUM
     C                     ADD  $GH3SM    $WH3SM           Head 3 SUM
     C                     ADD  $GHD4S    $WHD4S           Head 4 SUM
     C                     ADD  $GHD5S    $WHD5S           Head 5 SUM
     C                     ADD  $GWTNB    $WWTNB           Hot Weight 1 SU
     C                     ADD  $GX5NB    $WX5NB           Live Weight SUM
     C                     ADD  $GHCSM    $WHCSM           Head Count SUM
     C                     ADD  $GH5SM    $WH5SM           Head Total Sum5
     C                     ADD  $GCDNB    $WCDNB           Head held over
      * CASE: CUR.PD Producer Code is AGP
     C           $GABCD    IFEQ 'AGP'                      *IF
     C                     ADD  $GB4NB    P3HRCT           Head Received C
     C                     ADD  $GXRNB    P3HESS           Head Excep CNT
     C                     ADD  $GH5SM    P3KDSK           Head Total CNT
     C                     ADD  $GHTS3    P3KOSF           Head Diff CNT U
     C                     ADD  $GWUNB    P3HKCT           Head Killed CNT
     C                     ELSE
      * CASE: CUR.PD Producer Code is SEABOA
     C           $GABCD    IFEQ @CN,001                    *IF
     C                     ADD  $GB4NB    P3HRSB           Head Received S
     C                     ADD  $GXRNB    P3HSDL           Head Excep SBD
     C                     ADD  $GH5SM    P3KDKW           Head Total SBD
     C                     ADD  $GHTS3    P3IJMB           Head Diff SBD U
     C                     ADD  $GWUNB    P3HKSB           Head Killed SBD
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $GB4NB    P3HROD           Head Received O
     C                     ADD  $GXRNB    P3HDSL           Head Excep OTH
     C                     ADD  $GH5SM    P3KJOW           Head Total OTH
     C                     ADD  $GHTS3    P3KOIW           Head Diff OTH U
     C                     ADD  $GWUNB    P3HKOD           Head Killed ODB
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * PRTOBJ calls before print of TH Kill Date format
      * Embedded PRTOBJ : Prt Hot Scale Upl 2   PO
     C                     EXSR UHSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Hot Scale Upl 2   PO
     C                     EXSR UOSUBR                     Embedded PRTOBJ
      * Embedded PRTOBJ : Prt Hot Scale Upl 2   PO
     C                     EXSR UVSUBR                     Embedded PRTOBJ
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Kill Date format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $WHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $WB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VWB0DT
      * Print format
     C                     WRITE$WKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
      * USER: Process after print of TH Kill Date format
     C                     ADD  $WHD5U    $XHD5U           DOA Head Total
     C                     ADD  $WYDSM    $XYDSM           Yard Dead SUM
     C                     ADD  $WGONB    $XGONB           HEad Condemned
     C                     ADD  $WB4NB    $XB4NB           Head Total SUM
     C                     ADD  $WXRNB    $XXRNB           Head Total Sum2
     C                     ADD  $WHTS3    $XHTS3           Head Total Sum3
     C                     ADD  $WHTS4    $XHTS4           Head Total Sum4
     C                     ADD  $WWWNB    $XWWNB           Head Received 1
     C                     ADD  $WWUNB    $XWUNB           Head Killed 1 S
     C                     ADD  $WH1SM    $XH1SM           Head 1 SUM
     C                     ADD  $WH2SM    $XH2SM           Head 2 SUM
     C                     ADD  $WH3SM    $XH3SM           Head 3 SUM
     C                     ADD  $WHD4S    $XHD4S           Head 4 SUM
     C                     ADD  $WHD5S    $XHD5S           Head 5 SUM
     C                     ADD  $WWTNB    $XWTNB           Hot Weight 1 SU
     C                     ADD  $WX5NB    $XX5NB           Live Weight SUM
     C                     ADD  $WHCSM    $XHCSM           Head Count SUM
     C                     ADD  $WH5SM    $XH5SM           Head Total Sum5
     C                     ADD  $WCDNB    $XCDNB           Head held over
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of final totals format
      * CUR = PAR By name
     C                     Z-ADDP3HRCT    $XHRCT           Head Received C
     C                     Z-ADDP3HESS    $XHESS           Head Excep CNT
     C                     Z-ADDP3KDSK    $XKDSK           Head Total CNT
     C                     Z-ADDP3KOSF    $XKOSF           Head Diff CNT U
     C                     Z-ADDP3HKCT    $XHKCT           Head Killed CNT
     C                     Z-ADDP3HRSB    $XHRSB           Head Received S
     C                     Z-ADDP3HSDL    $XHSDL           Head Excep SBD
     C                     Z-ADDP3KDKW    $XKDKW           Head Total SBD
     C                     Z-ADDP3IJMB    $XIJMB           Head Diff SBD U
     C                     Z-ADDP3HKSB    $XHKSB           Head Killed SBD
     C                     Z-ADDP3HROD    $XHROD           Head Received O
     C                     Z-ADDP3HDSL    $XHDSL           Head Excep OTH
     C                     Z-ADDP3KJOW    $XKJOW           Head Total OTH
     C                     Z-ADDP3KOIW    $XKOIW           Head Diff OTH U
     C                     Z-ADDP3HKOD    $XHKOD           Head Killed ODB
     C                     Z-ADDP8O6NB    $XO6NB           TOT Head Kill B
     C                     Z-ADDP9O7NB    $XO7NB           TOT Head Kill B
     C                     Z-ADDP8O6NB    $XO6NB           TOT Head Kill B
     C                     Z-ADDP9O7NB    $XO7NB           TOT Head Kill B
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $XHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 7
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$XFINTTL
     C                     END
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt FOM Summary       PO: Mainline
      *================================================================
      * Prt FOM Summary       PO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQKB01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQKB02           TH Kill Date
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           BOH Company Num
     C                     KFLD           WQKB02           TH Kill Date
      * Setup key
     C                     Z-ADD$WHMNB    WQKB01           BOH Company Num
     C                     Z-ADD$WB0DT    WQKB02           TH Kill Date
      * Establish starting position
     C           KRSB      SETLL@A1CPDS                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        TH Kill Date
     C                     MOVEL'Y'       W0BL02  1        TH Source Type
     C                     MOVEL'Y'       W0BL03  1        PD Producer Cod
     C                     MOVEL'Y'       W0BL04  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL05  1        BOL Load Number
     C                     MOVEL'Y'       W0BL06  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $LHMNB           BOH Company Num
     C                     MOVELWBABCD    $LABCD           PD Producer Cod
     C                     Z-ADDWBB0DT    $LB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $LHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $LCDNB           Head held over
     C                     Z-ADD*ZERO     $LWWNB           Head Received 1
     C                     Z-ADD*ZERO     $LYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $LGONB           HEad Condemned
     C                     Z-ADD*ZERO     $LB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $LXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $LH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $LHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $LWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $LHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $LH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $LHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $LHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $LHDST           Display Field U
     C                     Z-ADD*ZERO     $LH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $LH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $LF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $LX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $LWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $LHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $LF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $LF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $LF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $LAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $LHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $KHMNB           BOH Company Num
     C                     MOVELWBABCD    $KABCD           PD Producer Cod
     C                     Z-ADD*ZERO     $KHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $KCDNB           Head held over
     C                     Z-ADD*ZERO     $KWWNB           Head Received 1
     C                     Z-ADD*ZERO     $KYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $KGONB           HEad Condemned
     C                     Z-ADD*ZERO     $KB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $KXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $KH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $KHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $KWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $KHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $KH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $KHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $KHD5S           Head 5 SUM
     C                     Z-ADD*ZERO     $KH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $KH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $KF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $KX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $KWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $KHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $KF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $KF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $KF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $KAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $KHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP03  1
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP04  1
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBHMNB    $HHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $HBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $HBONB           BOL Load Number
     C                     Z-ADDWBB0DT    $HB0DT           TH Kill Date
     C                     MOVELWBABCD    $HABCD           PD Producer Cod
      * Load related totals format
     C                     Z-ADDWBHMNB    $JHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $JBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $JBONB           BOL Load Number
     C                     Z-ADD*ZERO     $JHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $JCDNB           Head held over
     C                     Z-ADD*ZERO     $JQENB           Head Received
     C                     Z-ADD*ZERO     $JYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $JGONB           HEad Condemned
     C                     Z-ADD*ZERO     $JB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $JXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $JH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $JHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $JNINB           Head Killed SUM
     C                     Z-ADD*ZERO     $JHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $JH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $JHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $JHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $JHDST           Display Field U
     C                     Z-ADD*ZERO     $JH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $JH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $JF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $JX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $JWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $JHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $JF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $JF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $JF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $JAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $JHCSM           Head Count SUM
     C                     Z-ADDWBB0DT    $JB0DT           TH Kill Date
     C                     MOVELWBABCD    $JABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP05  1
     C                     END
      *
     C           W0BL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP06  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHMNB    $IHMNB           BOH Company Num
     C                     MOVELWBABCD    $IABCD           PD Producer Cod
     C                     Z-ADDWBB0DT    $IB0DT           TH Kill Date
     C                     Z-ADDWBBNNB    $IBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $IBONB           BOL Load Number
     C                     Z-ADDWBCVNB    $ICVNB           TH Tattoo Numbe
     C                     MOVELWBJ9ST    $IJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $IIYTX           Th Payment Type
     C                     MOVEL*BLANK    $IJPTX           Text 10 1 USR
     C                     Z-ADDWBAWDT    $IAWDT           TH Purchase Dat
     C                     MOVELWBBICD    $IBICD           TH Group Refere
     C                     MOVELWBCPST    $ICPST           TH Live Purchas
     C                     Z-ADDWBACPR    $IACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    $IB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    $ICAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    $IC4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    $IAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    $IA6DT           TH Pricing Date
     C                     MOVELWBC2ST    $IC2ST           TH Resale Sprea
     C                     Z-ADDWBCXNB    $ICXNB           TH Dead On Arri
     C                     Z-ADDWBH9NB    $IH9NB           TH Held Over
     C                     Z-ADDWBCWNB    $ICWNB           TH Head Receive
     C                     Z-ADDWBFCNB    $IFCNB           TH Yard Deads
     C                     Z-ADDWBFDNB    $IFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $ILFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ILINB           Head 2
     C                     Z-ADD*ZERO     $ICRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $IIINB           Difference +/-
     C                     Z-ADDWBFENB    $IFENB           TH Head Killed
     C                     Z-ADD*ZERO     $IMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $IHD3C           Head 3
     C                     Z-ADD*ZERO     $IHD4C           Head 4
     C                     Z-ADD*ZERO     $IHD5C           Head 5
     C                     MOVEL*BLANK    $IHDST           Display Field U
     C                     Z-ADD*ZERO     $IH1US           Head 1 USR
     C                     Z-ADD*ZERO     $IH2US           Head 2 USR
     C                     Z-ADDWBHENB    $IHENB           TH Head Adds
     C                     Z-ADDWBHFNB    $IHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    $ICYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    $ILRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    $IE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    $IA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    $IFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    $IA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    $IF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $IKGNB           Hot Weight Tot
     C                     Z-ADDWBHDNB    $IHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    $IF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    $IF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $IF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $IF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    $IAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    $IAWPC           TH Actual Yield
     C                     Z-ADDWBCBPR    $ICBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $IB5NB           Head Total USR
     C                     Z-ADDWBCWPC    $ICWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    $IA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    $IA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    $IB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    $IAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    $IANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    $IAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    $IAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    $IAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    $IAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    $IAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    $IASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    $IA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    $IATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    $IA5VA           TH Additions Am
     C                     Z-ADDWBCCPR    $ICCPR           Th Payment Net
     C                     Z-ADDWBLPNB    $ILPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    $ICDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    $IA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    $IA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    $IJWST           TH Calc Net Sts
     C                     MOVELWBCWST    $ICWST           TH Payment Sts
     C                     MOVELWBD7ST    $ID7ST           TH Header Error
     C                     MOVELWBD8ST    $ID8ST           TH Detail Error
     C                     MOVELWBDWST    $IDWST           TH Kill Balanci
     C                     MOVELWBD6ST    $ID6ST           TH Bal to Kill
     C                     Z-ADDWBGHNB    $IGHNB           TH Commission A
     C                     Z-ADDWBBYDT    $IBYDT           TH Voucher Paym
     C                     MOVELWBE0ST    $IE0ST           TH User Error O
     C                     MOVELWBE1ST    $IE1ST           TH Held Over Re
     C                     MOVELWBE2ST    $IE2ST           TH Sex
     C                     Z-ADDWBBSDT    $IBSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    $IBTDT           TH Commission P
     C                     Z-ADDWBBUDT    $IBUDT           TH Actual Check
     C                     Z-ADDWBHGNB    $IHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    $IHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    $IHINB           TH FFLI
     C                     Z-ADDWBA3PR    $IA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    $IA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    $IA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    $IJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    $ID6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    $ID7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    $ID8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    $ID9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    $IEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    $IEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    $IECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    $IEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    $IEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    $IEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    $IEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    $IEHPR           TH CM Gross Car
     C                     MOVELWBKAST    $IKAST           TH Source Type
     C                     MOVELWBJ7ST    $IJ7ST           TH Scale Ticket
     C                     Z-ADDWBOXNB    $IOXNB           TH HPS Movement
     C                     MOVELWBLKST    $ILKST           TH Source Code
     C                     MOVELWBLLST    $ILLST           TH Hog Class Ty
     C                     MOVELWBJ8ST    $IJ8ST           TH Posted to HP
     C                     MOVELWBLIST    $ILIST           TH Schedule Kil
     C                     MOVELWBLJST    $ILJST           TH Shift Held O
     C                     MOVELWBNZTX    $INZTX           TH State
     C                     MOVELWBHJCD    $IHJCD           TH Unused Code
     C                     MOVELWBR4ST    $IR4ST           TH Unused Sts 2
     C                     MOVELWBR5ST    $IR5ST           TH Commission S
     C                     MOVELWBR6ST    $IR6ST           TH Paid 2 Week
     C                     MOVELWBR7ST    $IR7ST           TH Unused Sts 1
     C                     Z-ADDWBTHWT    $ITHWT           TH DOA Weight
     C                     Z-ADDWBT2WT    $IT2WT           TH Avg Lean % E
     C                     Z-ADDWBTHHD    $ITHHD           TH HPS Farm Sit
     C                     Z-ADDWBT2HD    $IT2HD           TH Shift Held O
     C                     Z-ADDWBOBPR    $IOBPR           TH Sorting Amou
     C                     Z-ADDWBKOER    $IKOER           TH Head Identif
     C                     Z-ADDWBOPIR    $IOPIR           TH Percent Iden
     C                     Z-ADDWBOPEM    $IOPEM           TH Percent Acce
     C                     Z-ADDWBIORP    $IIORP           TH Head Adjuste
     C                     Z-ADDWBOWEO    $IOWEO           TH PHA Head Add
     C                     MOVELWBOQET    $IOQET           TH PHA Add Type
     C                     MOVELWBURST    $IURST           TH PHA Average
     C                     MOVELWBUSST    $IUSST           TH PHA Add Reas
     C                     Z-ADDWBHHPC    $IHHPC           TH PHA Yield Pe
     C                     Z-ADDWBS9PR    $IS9PR           TH PHA Lean Prm
     C                     Z-ADDWBTAPR    $ITAPR           TH VC Gross Val
     C                     Z-ADDWBTBPR    $ITBPR           TH Excluded Gro
     C                     Z-ADDWBJFUR    $IJFUR           TH Avg Lean %
     C                     Z-ADDWBKRIF    $IKRIF           TH Broken Back
     C                     Z-ADDWBKORF    $IKORF           TH Hot Scl Uplo
     C                     Z-ADDWBKAPR    $IKAPR           TH Unused Nbr 4
     C                     Z-ADDWBKROT    $IKROT           TH Excluded Car
     C                     Z-ADDWBOTJG    $IOTJG           TH Excluded Pre
     C                     Z-ADDWBIRJG    $IIRJG           TH Unused Nbr 7
     C                     Z-ADDWBIMJF    $IIMJF           TH Unused Nbr 8
     C                     Z-ADDWBIRGF    $IIRGF           TH Unused Nbr 9
     C                     Z-ADDWBKRJF    $IKRJF           TH Unused Nbr 1
     C                     Z-ADDWBOJRF    $IOJRF           TH Break Even P
     C                     Z-ADDWBKFOR    $IKFOR           TH Meat Value F
     C                     Z-ADDWBORJK    $IORJK           TH Yld Parm Adj
     C                     Z-ADDWBOMVJ    $IOMVJ           TH PHA Sort Dis
     C                     Z-ADDWBMVNF    $IMVNF           TH Avg Loin Eye
     C                     Z-ADDWBMCNF    $IMCNF           TH Avg Backfat
     C                     Z-ADDWBNCNF    $INCNF           TH HITCH Old Pa
     C                     Z-ADDWBNCHF    $INCHF           TH MPR Sort Los
     C                     Z-ADDWBIGIR    $IIGIR           TH Unused Nbr 1
     C                     Z-ADDWBKFJR    $IKFJR           TH Unused Nbr 2
     C                     Z-ADDWBEADT    $IEADT           TH Cold Scl Upl
     C                     Z-ADDWBEBDT    $IEBDT           TH Cold Scl Upl
     C                     Z-ADDWBECDT    $IECDT           TH Head LFT
     C                     Z-ADDWBEDDT    $IEDDT           TH Head EUT/KOA
     C                     Z-ADDWBEEDT    $IEEDT           TH Unused Date
     C                     MOVELWBU4ST    $IU4ST           TH Unused Sts 1
     C                     MOVELWBU5ST    $IU5ST           TH Unused Sts 2
     C                     MOVELWBU6ST    $IU6ST           TH Unused Sts 3
     C                     MOVELWBU7ST    $IU7ST           TH Unused Sts 4
     C                     MOVELWBU8ST    $IU8ST           TH Unused Sts 5
     C                     MOVELWBU9ST    $IU9ST           TH Unused Sts 6
     C                     MOVELWBVAST    $IVAST           TH Unused Sts 7
     C                     MOVELWBVBST    $IVBST           TH Unused Sts 8
     C                     MOVELWBAGCD    $IAGCD           GN Genetic Code
     C                     MOVELWBBECD    $IBECD           HC Class Code
     C                     MOVELWBBDCD    $IBDCD           DF Defect Code
     C                     MOVELWBCSCD    $ICSCD           THP Process Cod
     C                     MOVELWBAECD    $IAECD           PL Location Cod
     C                     MOVELWBACCD    $IACCD           HB Buyer Code
     C                     MOVELWBAAVN    $IAAVN           RS User Changed
     C                     Z-ADDWBAADT    $IAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $IAMTM           RS Time Changed
     C                     MOVELWBAJST    $IAJST           RS Record Statu
     C                     MOVELWBAHVN    $IAHVN           RS Job
     C                     MOVELWBAGVN    $IAGVN           RS Program
     C                     MOVELWBABVN    $IABVN           RS User Added
     C                     Z-ADDWBABDT    $IABDT           RS Date Added
     C                     Z-ADDWBABTM    $IABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * Only add if printing the detail.
      * CASE: LCL.*Record selected is *YES
     C           YL0019    IFEQ 'Y'                        *IF
     C                     ADD  1         WN0322           Count USR
     C                     ADD  $ICXNB    $JHD5U           DOA Head Total
     C                     ADD  $ICWNB    $JQENB           Head Received
     C                     ADD  $IFCNB    $JYDSM           Yard Dead SUM
     C                     ADD  $IFDNB    $JGONB           HEad Condemned
     C                     ADD  $IFENB    $JNINB           Head Killed SUM
     C                     ADD  $ILFNB    $JB4NB           Head Total SUM
     C                     ADD  $ILINB    $JXRNB           Head Total Sum2
     C                     ADD  $ICRNB    $JH5SM           Head Total Sum5
     C                     ADD  $IIINB    $JHTS3           Head Total Sum3
     C                     ADD  $IHD3C    $JH3SM           Head 3 SUM
     C                     ADD  $IHD4C    $JHD4S           Head 4 SUM
     C                     ADD  $IHD5C    $JHD5S           Head 5 SUM
     C                     ADD  $IMWNB    $JHTS4           Head Total Sum4
     C                     ADD  $IKGNB    $JWTNB           Hot Weight 1 SU
     C                     ADD  $ICYNB    $JX5NB           Live Weight SUM
     C                     ADD  $IH1US    $JH1SM           Head 1 SUM
     C                     ADD  $IH2US    $JH2SM           Head 2 SUM
     C                     ADD  $IB5NB    $JHCSM           Head Count SUM
     C                     END                             *FI
      * Short/Over
      * CASE: PAR.Difference +/- is GE ZERO
     C           WN0321    IFGE *ZERO                      *IF
     C                     ADD  $IIINB    WN0323           TOT Head Kill B
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $IIINB    WN0324           TOT Head Kill B
     C                     END                             *FI
     C                     ADD  $IH9NB    $JCDNB           Head held over
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHMNB    WZB001           BOH Company Num
     C                     Z-ADDWBHMNB    WZB001
     C           *LIKE     DEFN WBB0DT    WZB002           TH Kill Date
     C                     Z-ADDWBB0DT    WZB002
     C           *LIKE     DEFN WBKAST    WZB003           TH Source Type
     C                     MOVELWBKAST    WZB003
     C           *LIKE     DEFN WBABCD    WZB004           PD Producer Cod
     C                     MOVELWBABCD    WZB004
     C           *LIKE     DEFN WBBNNB    WZB005           BOH Buy Order N
     C                     Z-ADDWBBNNB    WZB005
     C           *LIKE     DEFN WBBONB    WZB006           BOL Load Number
     C                     Z-ADDWBBONB    WZB006
     C           *LIKE     DEFN WBCVNB    WZB007           TH Tattoo Numbe
     C                     Z-ADDWBCVNB    WZB007
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@A1CPDS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * REQSEL:  Include Market
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Market USR is No
      *   |- c2    : DB1.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TXST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Subject
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Subject USR is No
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TYST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Resale
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Resale USR is No
      *   |- c2    : DB1.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TWST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PAR.Status 1 is Blank
     C           YL0011    IFEQ *BLANK                     *IF
      * CASE: DB1.PD Producer Code is AGP
     C           WBABCD    IFEQ 'AGP'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Status 1 is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: DB1.PD Producer Code is SEABOA
     C           WBABCD    IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Status 1 is No
     C           YL0011    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PD Producer Code is SEABOA
      *   |- c2    : DB1.PD Producer Code is AGP
      *   '-
     C           WBABCD    IFEQ @CN,001                    *IF
     C           WBABCD    OREQ 'AGP'                      *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * INTSEL:  Head Received
      * CASE: DB1.TH Head Received is *Zeros
     C           WBCWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0BL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0BL02  1        TH Source Type
     C                     MOVEL*BLANK    W0BL03  1        PD Producer Cod
     C                     MOVEL*BLANK    W0BL04  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0BL05  1        BOL Load Number
     C                     MOVEL*BLANK    W0BL06  1        TH Tattoo Numbe
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        BOH Company Num
     C                     MOVEL'Y'       W0BL01  1        TH Kill Date
     C                     MOVEL'Y'       W0BL02  1        TH Source Type
     C                     MOVEL'Y'       W0BL03  1        PD Producer Cod
     C                     MOVEL'Y'       W0BL04  1        BOH Buy Order N
     C                     MOVEL'Y'       W0BL05  1        BOL Load Number
     C                     MOVEL'Y'       W0BL06  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHMNB    IFNE WZB001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WBB0DT    IFNE WZB002                     TH Kill Date
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WBKAST    IFNE WZB003                     TH Source Type
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C           WBABCD    IFNE WZB004                     PD Producer Cod
     C           W0BL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL03
     C                     END
     C           WBBNNB    IFNE WZB005                     BOH Buy Order N
     C           W0BL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL04
     C                     END
     C           WBBONB    IFNE WZB006                     BOL Load Number
     C           W0BL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL05
     C                     END
     C           WBCVNB    IFNE WZB007                     TH Tattoo Numbe
     C           W0BL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL06
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP06
     C                     END
      *
     C           W0BL05    IFEQ 'Y'
      * USER: On print of BOL Load Number format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $JHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * More then one Tattoo.
      * CASE: PAR.Count USR is Greater than 1
     C           WN0322    IFGT 1                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Report Type = Summary
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$JKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP05
      * USER: Process after print of BOL Load Number format
     C                     ADD  $JHD5U    $KHD5U           DOA Head Total
     C                     ADD  $JQENB    $KWWNB           Head Received 1
     C                     ADD  $JYDSM    $KYDSM           Yard Dead SUM
     C                     ADD  $JGONB    $KGONB           HEad Condemned
     C                     ADD  $JB4NB    $KB4NB           Head Total SUM
     C                     ADD  $JXRNB    $KXRNB           Head Total Sum2
     C                     ADD  $JHTS3    $KHTS3           Head Total Sum3
     C                     ADD  $JHTS4    $KHTS4           Head Total Sum4
     C                     ADD  $JH1SM    $KH1SM           Head 1 SUM
     C                     ADD  $JH2SM    $KH2SM           Head 2 SUM
     C                     ADD  $JH3SM    $KH3SM           Head 3 SUM
     C                     ADD  $JHD4S    $KHD4S           Head 4 SUM
     C                     ADD  $JHD5S    $KHD5S           Head 5 SUM
     C                     ADD  $JWTNB    $KWTNB           Hot Weight 1 SU
     C                     ADD  $JX5NB    $KX5NB           Live Weight SUM
     C                     ADD  $JHCSM    $KHCSM           Head Count SUM
     C                     ADD  $JH5SM    $KH5SM           Head Total Sum5
     C                     ADD  $JCDNB    $KCDNB           Head held over
     C                     ADD  $JNINB    $KWUNB           Head Killed 1 S
     C                     END
      *
     C           W0BL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP04
     C                     END
      *
     C           W0BL03    IFEQ 'Y'
      * USER: On print of PD Producer Code format
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CUR.PD Producer Code is AGP
      *   |- c2    : CUR.PD Producer Code is SEABOA
      *   '-
     C           $KABCD    IFEQ 'AGP'                      *IF
     C           $KABCD    OREQ @CN,001                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Prt FOM Summary N     US - Tattoo Header  * 
     C                     MOVEL'N'       W0AL03           PRDCR BRK
     C                     END                             *FI
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $KHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.PD Producer Code is Entered
     C           $WABCD    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$KKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP03
      * USER: Process after print of PD Producer Code format
     C                     ADD  $KHD5U    $LHD5U           DOA Head Total
     C                     ADD  $KYDSM    $LYDSM           Yard Dead SUM
     C                     ADD  $KWWNB    $LWWNB           Head Received 1
     C                     ADD  $KGONB    $LGONB           HEad Condemned
     C                     ADD  $KWUNB    $LWUNB           Head Killed 1 S
     C                     ADD  $KB4NB    $LB4NB           Head Total SUM
     C                     ADD  $KXRNB    $LXRNB           Head Total Sum2
     C                     ADD  $KHTS3    $LHTS3           Head Total Sum3
     C                     ADD  $KHTS4    $LHTS4           Head Total Sum4
     C                     ADD  $KH1SM    $LH1SM           Head 1 SUM
     C                     ADD  $KH2SM    $LH2SM           Head 2 SUM
     C                     ADD  $KH3SM    $LH3SM           Head 3 SUM
     C                     ADD  $KHD4S    $LHD4S           Head 4 SUM
     C                     ADD  $KHD5S    $LHD5S           Head 5 SUM
     C                     ADD  $KWTNB    $LWTNB           Hot Weight 1 SU
     C                     ADD  $KX5NB    $LX5NB           Live Weight SUM
     C                     ADD  $KHCSM    $LHCSM           Head Count SUM
     C                     ADD  $KH5SM    $LH5SM           Head Total Sum5
     C                     ADD  $KCDNB    $LCDNB           Head held over
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * USER: On print of TH Source Type format
      * Prt Hot Scale Upl 2 Y US - Tattoo Header  * 
     C                     MOVEL'Y'       W0AL03           PRDCR BRK
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Kill Date format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $LHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.Status 1 is Blank
     C           YL0011    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $LABCD           PD Producer Cod
     C                     MOVEL'AGP'     $LABCD           PD Producer Cod
     C                     ELSE
      * CASE: PAR.Status 1 is Yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   $LABCD           PD Producer Cod
     C                     ELSE
      * CASE: PAR.Status 1 is No
     C           YL0011    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    $LABCD           PD Producer Cod
     C                     MOVEL'OTHER'   $LABCD           PD Producer Cod
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $LB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VLB0DT
      * Print format
     C                     WRITE$LKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
      * USER: Process after print of TH Kill Date format
      * Create FOM Summary OUTF - FOM Summary OUTF  * 
     C                     EXSR SVCRRC
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
      * USER: On print of final totals format
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         C0MAIN    BEGSR
      *================================================================
      * Prt FOM Summary       PO: Mainline
      *================================================================
      * Prt FOM Summary       PO: Initialise
     C                     EXSR ZCINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQKC01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQKC02           TH Kill Date
      * Define keylist
     C           KRSC      KLIST
     C                     KFLD           WQKC01           BOH Company Num
     C                     KFLD           WQKC02           TH Kill Date
      * Setup key
     C                     Z-ADD$WHMNB    WQKC01           BOH Company Num
     C                     Z-ADD$WB0DT    WQKC02           TH Kill Date
      * Establish starting position
     C           KRSC      SETLL@A1CPDS                    *
      * Read first record with user selection
     C                     EXSR C3READ
     C           W0EOFC    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0CL1P  1        First page
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        TH Kill Date
     C                     MOVEL'Y'       W0CL02  1        TH Source Type
     C                     MOVEL'Y'       W0CL03  1        PD Producer Cod
     C                     MOVEL'Y'       W0CL04  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL05  1        BOL Load Number
     C                     MOVEL'Y'       W0CL06  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0CCDT
      * Print report body
     C           W0EOFC    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR C1PHDR
      * Print report detail line
     C                     EXSR C2PDTL
      * Read next record with user selection
     C                     EXSR C3READ
      * Print totals
     C                     EXSR C4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         C0EXIT    ENDSR
      /EJECT
     CSR         C1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0CL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP1P  1
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP00  1
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $QHMNB           BOH Company Num
     C                     MOVELWBABCD    $QABCD           PD Producer Cod
     C                     Z-ADDWBB0DT    $QB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $QHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $QCDNB           Head held over
     C                     Z-ADD*ZERO     $QWWNB           Head Received 1
     C                     Z-ADD*ZERO     $QYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $QGONB           HEad Condemned
     C                     Z-ADD*ZERO     $QB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $QXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $QH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $QHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $QWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $QHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $QH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $QHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $QHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $QHDST           Display Field U
     C                     Z-ADD*ZERO     $QH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $QH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $QF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $QX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $QWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $QHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $QF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $QF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $QF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $QAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $QHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP01  1
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP02  1
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $PHMNB           BOH Company Num
     C                     MOVELWBABCD    $PABCD           PD Producer Cod
     C                     Z-ADD*ZERO     $PHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $PCDNB           Head held over
     C                     Z-ADD*ZERO     $PWWNB           Head Received 1
     C                     Z-ADD*ZERO     $PYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $PGONB           HEad Condemned
     C                     Z-ADD*ZERO     $PB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $PXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $PH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $PHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $PWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $PHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $PH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $PHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $PHD5S           Head 5 SUM
     C                     Z-ADD*ZERO     $PH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $PH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $PF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $PX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $PWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $PHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $PF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $PF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $PF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $PAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $PHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP03  1
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP04  1
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBHMNB    $MHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $MBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $MBONB           BOL Load Number
     C                     Z-ADDWBB0DT    $MB0DT           TH Kill Date
     C                     MOVELWBABCD    $MABCD           PD Producer Cod
      * Load related totals format
     C                     Z-ADDWBHMNB    $OHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $OBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $OBONB           BOL Load Number
     C                     Z-ADD*ZERO     $OHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $OCDNB           Head held over
     C                     Z-ADD*ZERO     $OQENB           Head Received
     C                     Z-ADD*ZERO     $OYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $OGONB           HEad Condemned
     C                     Z-ADD*ZERO     $OB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $OXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $OH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $OHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $ONINB           Head Killed SUM
     C                     Z-ADD*ZERO     $OHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $OH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $OHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $OHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $OHDST           Display Field U
     C                     Z-ADD*ZERO     $OH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $OH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $OF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $OX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $OWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $OHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $OF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $OF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $OF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $OAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $OHCSM           Head Count SUM
     C                     Z-ADDWBB0DT    $OB0DT           TH Kill Date
     C                     MOVELWBABCD    $OABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP05  1
     C                     END
      *
     C           W0CL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CP06  1
     C                     END
      *
      *================================================================
     CSR         C1EXIT    ENDSR
      /EJECT
     CSR         C2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHMNB    $NHMNB           BOH Company Num
     C                     MOVELWBABCD    $NABCD           PD Producer Cod
     C                     Z-ADDWBB0DT    $NB0DT           TH Kill Date
     C                     Z-ADDWBBNNB    $NBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $NBONB           BOL Load Number
     C                     Z-ADDWBCVNB    $NCVNB           TH Tattoo Numbe
     C                     MOVELWBJ9ST    $NJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $NIYTX           Th Payment Type
     C                     MOVEL*BLANK    $NJPTX           Text 10 1 USR
     C                     Z-ADDWBAWDT    $NAWDT           TH Purchase Dat
     C                     MOVELWBBICD    $NBICD           TH Group Refere
     C                     MOVELWBCPST    $NCPST           TH Live Purchas
     C                     Z-ADDWBACPR    $NACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    $NB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    $NCAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    $NC4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    $NAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    $NA6DT           TH Pricing Date
     C                     MOVELWBC2ST    $NC2ST           TH Resale Sprea
     C                     Z-ADDWBCXNB    $NCXNB           TH Dead On Arri
     C                     Z-ADDWBH9NB    $NH9NB           TH Held Over
     C                     Z-ADDWBCWNB    $NCWNB           TH Head Receive
     C                     Z-ADDWBFCNB    $NFCNB           TH Yard Deads
     C                     Z-ADDWBFDNB    $NFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $NLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $NLINB           Head 2
     C                     Z-ADD*ZERO     $NCRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $NIINB           Difference +/-
     C                     Z-ADDWBFENB    $NFENB           TH Head Killed
     C                     Z-ADD*ZERO     $NMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $NHD3C           Head 3
     C                     Z-ADD*ZERO     $NHD4C           Head 4
     C                     Z-ADD*ZERO     $NHD5C           Head 5
     C                     MOVEL*BLANK    $NHDST           Display Field U
     C                     Z-ADD*ZERO     $NH1US           Head 1 USR
     C                     Z-ADD*ZERO     $NH2US           Head 2 USR
     C                     Z-ADDWBHENB    $NHENB           TH Head Adds
     C                     Z-ADDWBHFNB    $NHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    $NCYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    $NLRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    $NE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    $NA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    $NFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    $NA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    $NF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $NKGNB           Hot Weight Tot
     C                     Z-ADDWBHDNB    $NHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    $NF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    $NF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $NF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $NF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    $NAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    $NAWPC           TH Actual Yield
     C                     Z-ADDWBCBPR    $NCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $NB5NB           Head Total USR
     C                     Z-ADDWBCWPC    $NCWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    $NA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    $NA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    $NB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    $NAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    $NANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    $NAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    $NAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    $NAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    $NAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    $NAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    $NASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    $NA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    $NATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    $NA5VA           TH Additions Am
     C                     Z-ADDWBCCPR    $NCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    $NLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    $NCDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    $NA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    $NA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    $NJWST           TH Calc Net Sts
     C                     MOVELWBCWST    $NCWST           TH Payment Sts
     C                     MOVELWBD7ST    $ND7ST           TH Header Error
     C                     MOVELWBD8ST    $ND8ST           TH Detail Error
     C                     MOVELWBDWST    $NDWST           TH Kill Balanci
     C                     MOVELWBD6ST    $ND6ST           TH Bal to Kill
     C                     Z-ADDWBGHNB    $NGHNB           TH Commission A
     C                     Z-ADDWBBYDT    $NBYDT           TH Voucher Paym
     C                     MOVELWBE0ST    $NE0ST           TH User Error O
     C                     MOVELWBE1ST    $NE1ST           TH Held Over Re
     C                     MOVELWBE2ST    $NE2ST           TH Sex
     C                     Z-ADDWBBSDT    $NBSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    $NBTDT           TH Commission P
     C                     Z-ADDWBBUDT    $NBUDT           TH Actual Check
     C                     Z-ADDWBHGNB    $NHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    $NHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    $NHINB           TH FFLI
     C                     Z-ADDWBA3PR    $NA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    $NA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    $NA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    $NJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    $ND6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    $ND7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    $ND8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    $ND9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    $NEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    $NEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    $NECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    $NEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    $NEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    $NEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    $NEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    $NEHPR           TH CM Gross Car
     C                     MOVELWBKAST    $NKAST           TH Source Type
     C                     MOVELWBJ7ST    $NJ7ST           TH Scale Ticket
     C                     Z-ADDWBOXNB    $NOXNB           TH HPS Movement
     C                     MOVELWBLKST    $NLKST           TH Source Code
     C                     MOVELWBLLST    $NLLST           TH Hog Class Ty
     C                     MOVELWBJ8ST    $NJ8ST           TH Posted to HP
     C                     MOVELWBLIST    $NLIST           TH Schedule Kil
     C                     MOVELWBLJST    $NLJST           TH Shift Held O
     C                     MOVELWBNZTX    $NNZTX           TH State
     C                     MOVELWBHJCD    $NHJCD           TH Unused Code
     C                     MOVELWBR4ST    $NR4ST           TH Unused Sts 2
     C                     MOVELWBR5ST    $NR5ST           TH Commission S
     C                     MOVELWBR6ST    $NR6ST           TH Paid 2 Week
     C                     MOVELWBR7ST    $NR7ST           TH Unused Sts 1
     C                     Z-ADDWBTHWT    $NTHWT           TH DOA Weight
     C                     Z-ADDWBT2WT    $NT2WT           TH Avg Lean % E
     C                     Z-ADDWBTHHD    $NTHHD           TH HPS Farm Sit
     C                     Z-ADDWBT2HD    $NT2HD           TH Shift Held O
     C                     Z-ADDWBOBPR    $NOBPR           TH Sorting Amou
     C                     Z-ADDWBKOER    $NKOER           TH Head Identif
     C                     Z-ADDWBOPIR    $NOPIR           TH Percent Iden
     C                     Z-ADDWBOPEM    $NOPEM           TH Percent Acce
     C                     Z-ADDWBIORP    $NIORP           TH Head Adjuste
     C                     Z-ADDWBOWEO    $NOWEO           TH PHA Head Add
     C                     MOVELWBOQET    $NOQET           TH PHA Add Type
     C                     MOVELWBURST    $NURST           TH PHA Average
     C                     MOVELWBUSST    $NUSST           TH PHA Add Reas
     C                     Z-ADDWBHHPC    $NHHPC           TH PHA Yield Pe
     C                     Z-ADDWBS9PR    $NS9PR           TH PHA Lean Prm
     C                     Z-ADDWBTAPR    $NTAPR           TH VC Gross Val
     C                     Z-ADDWBTBPR    $NTBPR           TH Excluded Gro
     C                     Z-ADDWBJFUR    $NJFUR           TH Avg Lean %
     C                     Z-ADDWBKRIF    $NKRIF           TH Broken Back
     C                     Z-ADDWBKORF    $NKORF           TH Hot Scl Uplo
     C                     Z-ADDWBKAPR    $NKAPR           TH Unused Nbr 4
     C                     Z-ADDWBKROT    $NKROT           TH Excluded Car
     C                     Z-ADDWBOTJG    $NOTJG           TH Excluded Pre
     C                     Z-ADDWBIRJG    $NIRJG           TH Unused Nbr 7
     C                     Z-ADDWBIMJF    $NIMJF           TH Unused Nbr 8
     C                     Z-ADDWBIRGF    $NIRGF           TH Unused Nbr 9
     C                     Z-ADDWBKRJF    $NKRJF           TH Unused Nbr 1
     C                     Z-ADDWBOJRF    $NOJRF           TH Break Even P
     C                     Z-ADDWBKFOR    $NKFOR           TH Meat Value F
     C                     Z-ADDWBORJK    $NORJK           TH Yld Parm Adj
     C                     Z-ADDWBOMVJ    $NOMVJ           TH PHA Sort Dis
     C                     Z-ADDWBMVNF    $NMVNF           TH Avg Loin Eye
     C                     Z-ADDWBMCNF    $NMCNF           TH Avg Backfat
     C                     Z-ADDWBNCNF    $NNCNF           TH HITCH Old Pa
     C                     Z-ADDWBNCHF    $NNCHF           TH MPR Sort Los
     C                     Z-ADDWBIGIR    $NIGIR           TH Unused Nbr 1
     C                     Z-ADDWBKFJR    $NKFJR           TH Unused Nbr 2
     C                     Z-ADDWBEADT    $NEADT           TH Cold Scl Upl
     C                     Z-ADDWBEBDT    $NEBDT           TH Cold Scl Upl
     C                     Z-ADDWBECDT    $NECDT           TH Head LFT
     C                     Z-ADDWBEDDT    $NEDDT           TH Head EUT/KOA
     C                     Z-ADDWBEEDT    $NEEDT           TH Unused Date
     C                     MOVELWBU4ST    $NU4ST           TH Unused Sts 1
     C                     MOVELWBU5ST    $NU5ST           TH Unused Sts 2
     C                     MOVELWBU6ST    $NU6ST           TH Unused Sts 3
     C                     MOVELWBU7ST    $NU7ST           TH Unused Sts 4
     C                     MOVELWBU8ST    $NU8ST           TH Unused Sts 5
     C                     MOVELWBU9ST    $NU9ST           TH Unused Sts 6
     C                     MOVELWBVAST    $NVAST           TH Unused Sts 7
     C                     MOVELWBVBST    $NVBST           TH Unused Sts 8
     C                     MOVELWBAGCD    $NAGCD           GN Genetic Code
     C                     MOVELWBBECD    $NBECD           HC Class Code
     C                     MOVELWBBDCD    $NBDCD           DF Defect Code
     C                     MOVELWBCSCD    $NCSCD           THP Process Cod
     C                     MOVELWBAECD    $NAECD           PL Location Cod
     C                     MOVELWBACCD    $NACCD           HB Buyer Code
     C                     MOVELWBAAVN    $NAAVN           RS User Changed
     C                     Z-ADDWBAADT    $NAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $NAMTM           RS Time Changed
     C                     MOVELWBAJST    $NAJST           RS Record Statu
     C                     MOVELWBAHVN    $NAHVN           RS Job
     C                     MOVELWBAGVN    $NAGVN           RS Program
     C                     MOVELWBABVN    $NABVN           RS User Added
     C                     Z-ADDWBABDT    $NABDT           RS Date Added
     C                     Z-ADDWBABTM    $NABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0CPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * Only add if printing the detail.
      * CASE: LCL.*Record selected is *YES
     C           YL0019    IFEQ 'Y'                        *IF
     C                     ADD  1         WN0646           Count USR
     C                     ADD  $NCXNB    $OHD5U           DOA Head Total
     C                     ADD  $NCWNB    $OQENB           Head Received
     C                     ADD  $NFCNB    $OYDSM           Yard Dead SUM
     C                     ADD  $NFDNB    $OGONB           HEad Condemned
     C                     ADD  $NFENB    $ONINB           Head Killed SUM
     C                     ADD  $NLFNB    $OB4NB           Head Total SUM
     C                     ADD  $NLINB    $OXRNB           Head Total Sum2
     C                     ADD  $NCRNB    $OH5SM           Head Total Sum5
     C                     ADD  $NIINB    $OHTS3           Head Total Sum3
     C                     ADD  $NHD3C    $OH3SM           Head 3 SUM
     C                     ADD  $NHD4C    $OHD4S           Head 4 SUM
     C                     ADD  $NHD5C    $OHD5S           Head 5 SUM
     C                     ADD  $NMWNB    $OHTS4           Head Total Sum4
     C                     ADD  $NKGNB    $OWTNB           Hot Weight 1 SU
     C                     ADD  $NCYNB    $OX5NB           Live Weight SUM
     C                     ADD  $NH1US    $OH1SM           Head 1 SUM
     C                     ADD  $NH2US    $OH2SM           Head 2 SUM
     C                     ADD  $NB5NB    $OHCSM           Head Count SUM
     C                     END                             *FI
      * Short/Over
      * CASE: PAR.Difference +/- is GE ZERO
     C           WN0645    IFGE *ZERO                      *IF
     C                     ADD  $NIINB    WN0647           TOT Head Kill B
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $NIINB    WN0648           TOT Head Kill B
     C                     END                             *FI
     C                     ADD  $NH9NB    $OCDNB           Head held over
      *
      *================================================================
     CSR         C2EXIT    ENDSR
      /EJECT
     CSR         C3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHMNB    WZC001           BOH Company Num
     C                     Z-ADDWBHMNB    WZC001
     C           *LIKE     DEFN WBB0DT    WZC002           TH Kill Date
     C                     Z-ADDWBB0DT    WZC002
     C           *LIKE     DEFN WBKAST    WZC003           TH Source Type
     C                     MOVELWBKAST    WZC003
     C           *LIKE     DEFN WBABCD    WZC004           PD Producer Cod
     C                     MOVELWBABCD    WZC004
     C           *LIKE     DEFN WBBNNB    WZC005           BOH Buy Order N
     C                     Z-ADDWBBNNB    WZC005
     C           *LIKE     DEFN WBBONB    WZC006           BOL Load Number
     C                     Z-ADDWBBONB    WZC006
     C           *LIKE     DEFN WBCVNB    WZC007           TH Tattoo Numbe
     C                     Z-ADDWBCVNB    WZC007
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFC    OREQ '1'
     C           KRSC      READE@A1CPDS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFC  1
      * Quit if no record read
     C           W0EOFC    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * REQSEL:  Include Market
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Market USR is No
      *   |- c2    : DB1.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TXST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Subject
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Subject USR is No
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TYST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Resale
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Resale USR is No
      *   |- c2    : DB1.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TWST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PAR.Status 1 is Blank
     C           YL0011    IFEQ *BLANK                     *IF
      * CASE: DB1.PD Producer Code is AGP
     C           WBABCD    IFEQ 'AGP'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Status 1 is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: DB1.PD Producer Code is SEABOA
     C           WBABCD    IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Status 1 is No
     C           YL0011    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PD Producer Code is SEABOA
      *   |- c2    : DB1.PD Producer Code is AGP
      *   '-
     C           WBABCD    IFEQ @CN,001                    *IF
     C           WBABCD    OREQ 'AGP'                      *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * INTSEL:  Head Received
      * CASE: DB1.TH Head Received is *Zeros
     C           WBCWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0CL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0CL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0CL02  1        TH Source Type
     C                     MOVEL*BLANK    W0CL03  1        PD Producer Cod
     C                     MOVEL*BLANK    W0CL04  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0CL05  1        BOL Load Number
     C                     MOVEL*BLANK    W0CL06  1        TH Tattoo Numbe
     C           W0EOFC    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0CL00  1        BOH Company Num
     C                     MOVEL'Y'       W0CL01  1        TH Kill Date
     C                     MOVEL'Y'       W0CL02  1        TH Source Type
     C                     MOVEL'Y'       W0CL03  1        PD Producer Cod
     C                     MOVEL'Y'       W0CL04  1        BOH Buy Order N
     C                     MOVEL'Y'       W0CL05  1        BOL Load Number
     C                     MOVEL'Y'       W0CL06  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHMNB    IFNE WZC001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL00
     C                     END
     C           WBB0DT    IFNE WZC002                     TH Kill Date
     C           W0CL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL01
     C                     END
     C           WBKAST    IFNE WZC003                     TH Source Type
     C           W0CL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL02
     C                     END
     C           WBABCD    IFNE WZC004                     PD Producer Cod
     C           W0CL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL03
     C                     END
     C           WBBNNB    IFNE WZC005                     BOH Buy Order N
     C           W0CL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL04
     C                     END
     C           WBBONB    IFNE WZC006                     BOL Load Number
     C           W0CL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL05
     C                     END
     C           WBCVNB    IFNE WZC007                     TH Tattoo Numbe
     C           W0CL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0CL06
     C                     END
     C                     END
      *================================================================
     CSR         C3EXIT    ENDSR
      /EJECT
     CSR         C4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0CL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP06
     C                     END
      *
     C           W0CL05    IFEQ 'Y'
      * USER: On print of BOL Load Number format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $OHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * More then one Tattoo.
      * CASE: PAR.Count USR is Greater than 1
     C           WN0646    IFGT 1                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Report Type = Summary
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$OKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP05
      * USER: Process after print of BOL Load Number format
     C                     ADD  $OHD5U    $PHD5U           DOA Head Total
     C                     ADD  $OQENB    $PWWNB           Head Received 1
     C                     ADD  $OYDSM    $PYDSM           Yard Dead SUM
     C                     ADD  $OGONB    $PGONB           HEad Condemned
     C                     ADD  $OB4NB    $PB4NB           Head Total SUM
     C                     ADD  $OXRNB    $PXRNB           Head Total Sum2
     C                     ADD  $OHTS3    $PHTS3           Head Total Sum3
     C                     ADD  $OHTS4    $PHTS4           Head Total Sum4
     C                     ADD  $OH1SM    $PH1SM           Head 1 SUM
     C                     ADD  $OH2SM    $PH2SM           Head 2 SUM
     C                     ADD  $OH3SM    $PH3SM           Head 3 SUM
     C                     ADD  $OHD4S    $PHD4S           Head 4 SUM
     C                     ADD  $OHD5S    $PHD5S           Head 5 SUM
     C                     ADD  $OWTNB    $PWTNB           Hot Weight 1 SU
     C                     ADD  $OX5NB    $PX5NB           Live Weight SUM
     C                     ADD  $OHCSM    $PHCSM           Head Count SUM
     C                     ADD  $OH5SM    $PH5SM           Head Total Sum5
     C                     ADD  $OCDNB    $PCDNB           Head held over
     C                     ADD  $ONINB    $PWUNB           Head Killed 1 S
     C                     END
      *
     C           W0CL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP04
     C                     END
      *
     C           W0CL03    IFEQ 'Y'
      * USER: On print of PD Producer Code format
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CUR.PD Producer Code is AGP
      *   |- c2    : CUR.PD Producer Code is SEABOA
      *   '-
     C           $PABCD    IFEQ 'AGP'                      *IF
     C           $PABCD    OREQ @CN,001                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Prt FOM Summary N     US - Tattoo Header  * 
     C                     MOVEL'N'       W0AL03           PRDCR BRK
     C                     END                             *FI
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $PHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.PD Producer Code is Entered
     C           $WABCD    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$PKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP03
      * USER: Process after print of PD Producer Code format
     C                     ADD  $PHD5U    $QHD5U           DOA Head Total
     C                     ADD  $PYDSM    $QYDSM           Yard Dead SUM
     C                     ADD  $PWWNB    $QWWNB           Head Received 1
     C                     ADD  $PGONB    $QGONB           HEad Condemned
     C                     ADD  $PWUNB    $QWUNB           Head Killed 1 S
     C                     ADD  $PB4NB    $QB4NB           Head Total SUM
     C                     ADD  $PXRNB    $QXRNB           Head Total Sum2
     C                     ADD  $PHTS3    $QHTS3           Head Total Sum3
     C                     ADD  $PHTS4    $QHTS4           Head Total Sum4
     C                     ADD  $PH1SM    $QH1SM           Head 1 SUM
     C                     ADD  $PH2SM    $QH2SM           Head 2 SUM
     C                     ADD  $PH3SM    $QH3SM           Head 3 SUM
     C                     ADD  $PHD4S    $QHD4S           Head 4 SUM
     C                     ADD  $PHD5S    $QHD5S           Head 5 SUM
     C                     ADD  $PWTNB    $QWTNB           Hot Weight 1 SU
     C                     ADD  $PX5NB    $QX5NB           Live Weight SUM
     C                     ADD  $PHCSM    $QHCSM           Head Count SUM
     C                     ADD  $PH5SM    $QH5SM           Head Total Sum5
     C                     ADD  $PCDNB    $QCDNB           Head held over
     C                     END
      *
     C           W0CL02    IFEQ 'Y'
      * USER: On print of TH Source Type format
      * Prt Hot Scale Upl 2 Y US - Tattoo Header  * 
     C                     MOVEL'Y'       W0AL03           PRDCR BRK
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP02
     C                     END
      *
     C           W0CL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Kill Date format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $QHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.Status 1 is Blank
     C           YL0011    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $QABCD           PD Producer Cod
     C                     MOVEL'AGP'     $QABCD           PD Producer Cod
     C                     ELSE
      * CASE: PAR.Status 1 is Yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   $QABCD           PD Producer Cod
     C                     ELSE
      * CASE: PAR.Status 1 is No
     C           YL0011    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    $QABCD           PD Producer Cod
     C                     MOVEL'OTHER'   $QABCD           PD Producer Cod
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $QB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VQB0DT
      * Print format
     C                     WRITE$QKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP01
      * USER: Process after print of TH Kill Date format
      * Create FOM Summary OUTF - FOM Summary OUTF  * 
     C                     EXSR TGCRRC
     C                     END
      *
     C           W0CL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0CP00
     C                     END
      *
     C           W0EOFC    IFEQ '1'
      * USER: On print of final totals format
     C                     END
      *
      *================================================================
     CSR         C4EXIT    ENDSR
      /EJECT
     CSR         D0MAIN    BEGSR
      *================================================================
      * Prt FOM Summary       PO: Mainline
      *================================================================
      * Prt FOM Summary       PO: Initialise
     C                     EXSR ZDINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQKD01           BOH Company Num
     C           *LIKE     DEFN WBB0DT    WQKD02           TH Kill Date
      * Define keylist
     C           KRSD      KLIST
     C                     KFLD           WQKD01           BOH Company Num
     C                     KFLD           WQKD02           TH Kill Date
      * Setup key
     C                     Z-ADD$WHMNB    WQKD01           BOH Company Num
     C                     Z-ADD$WB0DT    WQKD02           TH Kill Date
      * Establish starting position
     C           KRSD      SETLL@A1CPDS                    *
      * Read first record with user selection
     C                     EXSR D3READ
     C           W0EOFD    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0DL1P  1        First page
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        TH Kill Date
     C                     MOVEL'Y'       W0DL02  1        TH Source Type
     C                     MOVEL'Y'       W0DL03  1        PD Producer Cod
     C                     MOVEL'Y'       W0DL04  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL05  1        BOL Load Number
     C                     MOVEL'Y'       W0DL06  1        TH Tattoo Numbe
      * Set column headings flag
     C                     MOVE 'Y'       W0DCDT
      * Print report body
     C           W0EOFD    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR D1PHDR
      * Print report detail line
     C                     EXSR D2PDTL
      * Read next record with user selection
     C                     EXSR D3READ
      * Print totals
     C                     EXSR D4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         D0EXIT    ENDSR
      /EJECT
     CSR         D1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0DL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP1P  1
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP00  1
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $VHMNB           BOH Company Num
     C                     MOVELWBABCD    $VABCD           PD Producer Cod
     C                     Z-ADDWBB0DT    $VB0DT           TH Kill Date
     C                     Z-ADD*ZERO     $VHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $VCDNB           Head held over
     C                     Z-ADD*ZERO     $VWWNB           Head Received 1
     C                     Z-ADD*ZERO     $VYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $VGONB           HEad Condemned
     C                     Z-ADD*ZERO     $VB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $VXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $VH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $VHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $VWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $VHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $VH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $VHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $VHD5S           Head 5 SUM
     C                     MOVEL*BLANK    $VHDST           Display Field U
     C                     Z-ADD*ZERO     $VH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $VH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $VF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $VX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $VWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $VHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $VF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $VF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $VF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $VAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $VHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP01  1
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP02  1
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * Load related totals format
     C                     Z-ADDWBHMNB    $UHMNB           BOH Company Num
     C                     MOVELWBABCD    $UABCD           PD Producer Cod
     C                     Z-ADD*ZERO     $UHD5U           DOA Head Total
     C                     Z-ADD*ZERO     $UCDNB           Head held over
     C                     Z-ADD*ZERO     $UWWNB           Head Received 1
     C                     Z-ADD*ZERO     $UYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $UGONB           HEad Condemned
     C                     Z-ADD*ZERO     $UB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $UXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $UH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $UHTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $UWUNB           Head Killed 1 S
     C                     Z-ADD*ZERO     $UHTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $UH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $UHD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $UHD5S           Head 5 SUM
     C                     Z-ADD*ZERO     $UH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $UH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $UF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $UX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $UWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $UHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $UF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $UF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $UF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $UAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $UHCSM           Head Count SUM
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP03  1
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP04  1
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDWBHMNB    $RHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $RBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $RBONB           BOL Load Number
     C                     Z-ADDWBB0DT    $RB0DT           TH Kill Date
     C                     MOVELWBABCD    $RABCD           PD Producer Cod
      * Load related totals format
     C                     Z-ADDWBHMNB    $THMNB           BOH Company Num
     C                     Z-ADDWBBNNB    $TBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $TBONB           BOL Load Number
     C                     Z-ADD*ZERO     $THD5U           DOA Head Total
     C                     Z-ADD*ZERO     $TCDNB           Head held over
     C                     Z-ADD*ZERO     $TQENB           Head Received
     C                     Z-ADD*ZERO     $TYDSM           Yard Dead SUM
     C                     Z-ADD*ZERO     $TGONB           HEad Condemned
     C                     Z-ADD*ZERO     $TB4NB           Head Total SUM
     C                     Z-ADD*ZERO     $TXRNB           Head Total Sum2
     C                     Z-ADD*ZERO     $TH5SM           Head Total Sum5
     C                     Z-ADD*ZERO     $THTS3           Head Total Sum3
     C                     Z-ADD*ZERO     $TNINB           Head Killed SUM
     C                     Z-ADD*ZERO     $THTS4           Head Total Sum4
     C                     Z-ADD*ZERO     $TH3SM           Head 3 SUM
     C                     Z-ADD*ZERO     $THD4S           Head 4 SUM
     C                     Z-ADD*ZERO     $THD5S           Head 5 SUM
     C                     MOVEL*BLANK    $THDST           Display Field U
     C                     Z-ADD*ZERO     $TH1SM           Head 1 SUM
     C                     Z-ADD*ZERO     $TH2SM           Head 2 SUM
     C                     Z-ADDWBF7NB    $TF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $TX5NB           Live Weight SUM
     C                     Z-ADD*ZERO     $TWTNB           Hot Weight 1 SU
     C                     Z-ADDWBHDNB    $THDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF4NB    $TF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $TF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $TF2NB           TH Avg Backfat
     C                     Z-ADDWBAWPC    $TAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     $THCSM           Head Count SUM
     C                     Z-ADDWBB0DT    $TB0DT           TH Kill Date
     C                     MOVELWBABCD    $TABCD           PD Producer Cod
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP05  1
     C                     END
      *
     C           W0DL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DP06  1
     C                     END
      *
      *================================================================
     CSR         D1EXIT    ENDSR
      /EJECT
     CSR         D2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDWBHMNB    $SHMNB           BOH Company Num
     C                     MOVELWBABCD    $SABCD           PD Producer Cod
     C                     Z-ADDWBB0DT    $SB0DT           TH Kill Date
     C                     Z-ADDWBBNNB    $SBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    $SBONB           BOL Load Number
     C                     Z-ADDWBCVNB    $SCVNB           TH Tattoo Numbe
     C                     MOVELWBJ9ST    $SJ9ST           TH Payment Type
     C                     MOVEL*BLANK    $SIYTX           Th Payment Type
     C                     MOVEL*BLANK    $SJPTX           Text 10 1 USR
     C                     Z-ADDWBAWDT    $SAWDT           TH Purchase Dat
     C                     MOVELWBBICD    $SBICD           TH Group Refere
     C                     MOVELWBCPST    $SCPST           TH Live Purchas
     C                     Z-ADDWBACPR    $SACPR           TH Live Purchas
     C                     Z-ADDWBB9PR    $SB9PR           TH Live Gross A
     C                     Z-ADDWBCAPR    $SCAPR           TH LIve Net Amt
     C                     MOVELWBC4ST    $SC4ST           TH Resale UOM
     C                     Z-ADDWBAIPR    $SAIPR           TH Recalc Live
     C                     Z-ADDWBA6DT    $SA6DT           TH Pricing Date
     C                     MOVELWBC2ST    $SC2ST           TH Resale Sprea
     C                     Z-ADDWBCXNB    $SCXNB           TH Dead On Arri
     C                     Z-ADDWBH9NB    $SH9NB           TH Held Over
     C                     Z-ADDWBCWNB    $SCWNB           TH Head Receive
     C                     Z-ADDWBFCNB    $SFCNB           TH Yard Deads
     C                     Z-ADDWBFDNB    $SFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     $SLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $SLINB           Head 2
     C                     Z-ADD*ZERO     $SCRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $SIINB           Difference +/-
     C                     Z-ADDWBFENB    $SFENB           TH Head Killed
     C                     Z-ADD*ZERO     $SMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     $SHD3C           Head 3
     C                     Z-ADD*ZERO     $SHD4C           Head 4
     C                     Z-ADD*ZERO     $SHD5C           Head 5
     C                     MOVEL*BLANK    $SHDST           Display Field U
     C                     Z-ADD*ZERO     $SH1US           Head 1 USR
     C                     Z-ADD*ZERO     $SH2US           Head 2 USR
     C                     Z-ADDWBHENB    $SHENB           TH Head Adds
     C                     Z-ADDWBHFNB    $SHFNB           TH Head Accepte
     C                     Z-ADDWBCYNB    $SCYNB           TH Live Wgt
     C                     Z-ADDWBLRNB    $SLRNB           TH Adj Live Wgt
     C                     Z-ADDWBE0NB    $SE0NB           TH Hot Wgt
     C                     Z-ADDWBA5PC    $SA5PC           TH Tot Loin Eye
     C                     Z-ADDWBFBNB    $SFBNB           TH Tot Backfat
     C                     Z-ADDWBA4PC    $SA4PC           TH Tot Light Re
     C                     Z-ADDWBF7NB    $SF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     $SKGNB           Hot Weight Tot
     C                     Z-ADDWBHDNB    $SHDNB           TH Avg Hot Wgt
     C                     Z-ADDWBF5NB    $SF5NB           TH Avg Light Re
     C                     Z-ADDWBF4NB    $SF4NB           TH Avg Lean Per
     C                     Z-ADDWBF3NB    $SF3NB           TH Avg Loin Eye
     C                     Z-ADDWBF2NB    $SF2NB           TH Avg Backfat
     C                     Z-ADDWBAVPC    $SAVPC           TH Std Yield Pe
     C                     Z-ADDWBAWPC    $SAWPC           TH Actual Yield
     C                     Z-ADDWBCBPR    $SCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     $SB5NB           Head Total USR
     C                     Z-ADDWBCWPC    $SCWPC           TH Adj Actual Y
     C                     Z-ADDWBA8PC    $SA8PC           TH Yield Differ
     C                     Z-ADDWBA7PC    $SA7PC           TH Recalc Live
     C                     Z-ADDWBB8PR    $SB8PR           TH CM Market Pr
     C                     Z-ADDWBAMPR    $SAMPR           TH CM Base Mkt
     C                     Z-ADDWBANPR    $SANPR           TH CM Base Mkt
     C                     Z-ADDWBAYVA    $SAYVA           TH CM Sort Disc
     C                     Z-ADDWBAWVA    $SAWVA           TH CM Yield Gai
     C                     Z-ADDWBAOPR    $SAOPR           TH CM Base Carc
     C                     Z-ADDWBAXVA    $SAXVA           TH CM LN AddOn/
     C                     Z-ADDWBAPPR    $SAPPR           TH CM Carcass G
     C                     Z-ADDWBASPR    $SASPR           TH Deduction Am
     C                     Z-ADDWBA4VA    $SA4VA           TH Total Net WO
     C                     Z-ADDWBATPR    $SATPR           TH Carcass Net
     C                     Z-ADDWBA5VA    $SA5VA           TH Additions Am
     C                     Z-ADDWBCCPR    $SCCPR           Th Payment Net
     C                     Z-ADDWBLPNB    $SLPNB           TH AP Voucher/D
     C                     Z-ADDWBCDPR    $SCDPR           TH Freight Amou
     C                     Z-ADDWBA7VA    $SA7VA           TH Accrual Amou
     C                     Z-ADDWBA2PR    $SA2PR           TH Fixed Cost A
     C                     MOVELWBJWST    $SJWST           TH Calc Net Sts
     C                     MOVELWBCWST    $SCWST           TH Payment Sts
     C                     MOVELWBD7ST    $SD7ST           TH Header Error
     C                     MOVELWBD8ST    $SD8ST           TH Detail Error
     C                     MOVELWBDWST    $SDWST           TH Kill Balanci
     C                     MOVELWBD6ST    $SD6ST           TH Bal to Kill
     C                     Z-ADDWBGHNB    $SGHNB           TH Commission A
     C                     Z-ADDWBBYDT    $SBYDT           TH Voucher Paym
     C                     MOVELWBE0ST    $SE0ST           TH User Error O
     C                     MOVELWBE1ST    $SE1ST           TH Held Over Re
     C                     MOVELWBE2ST    $SE2ST           TH Sex
     C                     Z-ADDWBBSDT    $SBSDT           TH Held/Ovr Com
     C                     Z-ADDWBBTDT    $SBTDT           TH Commission P
     C                     Z-ADDWBBUDT    $SBUDT           TH Actual Check
     C                     Z-ADDWBHGNB    $SHGNB           TH Shipped Weig
     C                     Z-ADDWBHHNB    $SHHNB           TH Avg Hot Wgt
     C                     Z-ADDWBHINB    $SHINB           TH FFLI
     C                     Z-ADDWBA3PR    $SA3PR           TH Kill Product
     C                     Z-ADDWBA4PR    $SA4PR           TH Cut Product
     C                     Z-ADDWBA6PR    $SA6PR           TH Render Produ
     C                     Z-ADDWBJ9NB    $SJ9NB           TH Head Exclude
     C                     Z-ADDWBD6PR    $SD6PR           TH CM Bse Mkt L
     C                     Z-ADDWBD7PR    $SD7PR           TH CM Bse Mkt C
     C                     Z-ADDWBD8PR    $SD8PR           TH CM Srt Dsc L
     C                     Z-ADDWBD9PR    $SD9PR           TH CM Srt Dsc C
     C                     Z-ADDWBEAPR    $SEAPR           TH CM Yld G/L L
     C                     Z-ADDWBEBPR    $SEBPR           TH CM Yld G/L C
     C                     Z-ADDWBECPR    $SECPR           TH CM Crc Val L
     C                     Z-ADDWBEDPR    $SEDPR           TH CM Crc Val C
     C                     Z-ADDWBEEPR    $SEEPR           TH CM Lean Prem
     C                     Z-ADDWBEFPR    $SEFPR           TH CM Lean Prem
     C                     Z-ADDWBEGPR    $SEGPR           TH CM Gross Liv
     C                     Z-ADDWBEHPR    $SEHPR           TH CM Gross Car
     C                     MOVELWBKAST    $SKAST           TH Source Type
     C                     MOVELWBJ7ST    $SJ7ST           TH Scale Ticket
     C                     Z-ADDWBOXNB    $SOXNB           TH HPS Movement
     C                     MOVELWBLKST    $SLKST           TH Source Code
     C                     MOVELWBLLST    $SLLST           TH Hog Class Ty
     C                     MOVELWBJ8ST    $SJ8ST           TH Posted to HP
     C                     MOVELWBLIST    $SLIST           TH Schedule Kil
     C                     MOVELWBLJST    $SLJST           TH Shift Held O
     C                     MOVELWBNZTX    $SNZTX           TH State
     C                     MOVELWBHJCD    $SHJCD           TH Unused Code
     C                     MOVELWBR4ST    $SR4ST           TH Unused Sts 2
     C                     MOVELWBR5ST    $SR5ST           TH Commission S
     C                     MOVELWBR6ST    $SR6ST           TH Paid 2 Week
     C                     MOVELWBR7ST    $SR7ST           TH Unused Sts 1
     C                     Z-ADDWBTHWT    $STHWT           TH DOA Weight
     C                     Z-ADDWBT2WT    $ST2WT           TH Avg Lean % E
     C                     Z-ADDWBTHHD    $STHHD           TH HPS Farm Sit
     C                     Z-ADDWBT2HD    $ST2HD           TH Shift Held O
     C                     Z-ADDWBOBPR    $SOBPR           TH Sorting Amou
     C                     Z-ADDWBKOER    $SKOER           TH Head Identif
     C                     Z-ADDWBOPIR    $SOPIR           TH Percent Iden
     C                     Z-ADDWBOPEM    $SOPEM           TH Percent Acce
     C                     Z-ADDWBIORP    $SIORP           TH Head Adjuste
     C                     Z-ADDWBOWEO    $SOWEO           TH PHA Head Add
     C                     MOVELWBOQET    $SOQET           TH PHA Add Type
     C                     MOVELWBURST    $SURST           TH PHA Average
     C                     MOVELWBUSST    $SUSST           TH PHA Add Reas
     C                     Z-ADDWBHHPC    $SHHPC           TH PHA Yield Pe
     C                     Z-ADDWBS9PR    $SS9PR           TH PHA Lean Prm
     C                     Z-ADDWBTAPR    $STAPR           TH VC Gross Val
     C                     Z-ADDWBTBPR    $STBPR           TH Excluded Gro
     C                     Z-ADDWBJFUR    $SJFUR           TH Avg Lean %
     C                     Z-ADDWBKRIF    $SKRIF           TH Broken Back
     C                     Z-ADDWBKORF    $SKORF           TH Hot Scl Uplo
     C                     Z-ADDWBKAPR    $SKAPR           TH Unused Nbr 4
     C                     Z-ADDWBKROT    $SKROT           TH Excluded Car
     C                     Z-ADDWBOTJG    $SOTJG           TH Excluded Pre
     C                     Z-ADDWBIRJG    $SIRJG           TH Unused Nbr 7
     C                     Z-ADDWBIMJF    $SIMJF           TH Unused Nbr 8
     C                     Z-ADDWBIRGF    $SIRGF           TH Unused Nbr 9
     C                     Z-ADDWBKRJF    $SKRJF           TH Unused Nbr 1
     C                     Z-ADDWBOJRF    $SOJRF           TH Break Even P
     C                     Z-ADDWBKFOR    $SKFOR           TH Meat Value F
     C                     Z-ADDWBORJK    $SORJK           TH Yld Parm Adj
     C                     Z-ADDWBOMVJ    $SOMVJ           TH PHA Sort Dis
     C                     Z-ADDWBMVNF    $SMVNF           TH Avg Loin Eye
     C                     Z-ADDWBMCNF    $SMCNF           TH Avg Backfat
     C                     Z-ADDWBNCNF    $SNCNF           TH HITCH Old Pa
     C                     Z-ADDWBNCHF    $SNCHF           TH MPR Sort Los
     C                     Z-ADDWBIGIR    $SIGIR           TH Unused Nbr 1
     C                     Z-ADDWBKFJR    $SKFJR           TH Unused Nbr 2
     C                     Z-ADDWBEADT    $SEADT           TH Cold Scl Upl
     C                     Z-ADDWBEBDT    $SEBDT           TH Cold Scl Upl
     C                     Z-ADDWBECDT    $SECDT           TH Head LFT
     C                     Z-ADDWBEDDT    $SEDDT           TH Head EUT/KOA
     C                     Z-ADDWBEEDT    $SEEDT           TH Unused Date
     C                     MOVELWBU4ST    $SU4ST           TH Unused Sts 1
     C                     MOVELWBU5ST    $SU5ST           TH Unused Sts 2
     C                     MOVELWBU6ST    $SU6ST           TH Unused Sts 3
     C                     MOVELWBU7ST    $SU7ST           TH Unused Sts 4
     C                     MOVELWBU8ST    $SU8ST           TH Unused Sts 5
     C                     MOVELWBU9ST    $SU9ST           TH Unused Sts 6
     C                     MOVELWBVAST    $SVAST           TH Unused Sts 7
     C                     MOVELWBVBST    $SVBST           TH Unused Sts 8
     C                     MOVELWBAGCD    $SAGCD           GN Genetic Code
     C                     MOVELWBBECD    $SBECD           HC Class Code
     C                     MOVELWBBDCD    $SBDCD           DF Defect Code
     C                     MOVELWBCSCD    $SCSCD           THP Process Cod
     C                     MOVELWBAECD    $SAECD           PL Location Cod
     C                     MOVELWBACCD    $SACCD           HB Buyer Code
     C                     MOVELWBAAVN    $SAAVN           RS User Changed
     C                     Z-ADDWBAADT    $SAADT           RS Date Changed
     C                     Z-ADDWBAMTM    $SAMTM           RS Time Changed
     C                     MOVELWBAJST    $SAJST           RS Record Statu
     C                     MOVELWBAHVN    $SAHVN           RS Job
     C                     MOVELWBAGVN    $SAGVN           RS Program
     C                     MOVELWBABVN    $SABVN           RS User Added
     C                     Z-ADDWBABDT    $SABDT           RS Date Added
     C                     Z-ADDWBABTM    $SABTM           RS Time Added
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0DPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      * USER: Process after print of detail format
      * Only add if printing the detail.
      * CASE: LCL.*Record selected is *YES
     C           YL0019    IFEQ 'Y'                        *IF
     C                     ADD  1         WN0970           Count USR
     C                     ADD  $SCXNB    $THD5U           DOA Head Total
     C                     ADD  $SCWNB    $TQENB           Head Received
     C                     ADD  $SFCNB    $TYDSM           Yard Dead SUM
     C                     ADD  $SFDNB    $TGONB           HEad Condemned
     C                     ADD  $SFENB    $TNINB           Head Killed SUM
     C                     ADD  $SLFNB    $TB4NB           Head Total SUM
     C                     ADD  $SLINB    $TXRNB           Head Total Sum2
     C                     ADD  $SCRNB    $TH5SM           Head Total Sum5
     C                     ADD  $SIINB    $THTS3           Head Total Sum3
     C                     ADD  $SHD3C    $TH3SM           Head 3 SUM
     C                     ADD  $SHD4C    $THD4S           Head 4 SUM
     C                     ADD  $SHD5C    $THD5S           Head 5 SUM
     C                     ADD  $SMWNB    $THTS4           Head Total Sum4
     C                     ADD  $SKGNB    $TWTNB           Hot Weight 1 SU
     C                     ADD  $SCYNB    $TX5NB           Live Weight SUM
     C                     ADD  $SH1US    $TH1SM           Head 1 SUM
     C                     ADD  $SH2US    $TH2SM           Head 2 SUM
     C                     ADD  $SB5NB    $THCSM           Head Count SUM
     C                     END                             *FI
      * Short/Over
      * CASE: PAR.Difference +/- is GE ZERO
     C           WN0969    IFGE *ZERO                      *IF
     C                     ADD  $SIINB    WN0971           TOT Head Kill B
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $SIINB    WN0972           TOT Head Kill B
     C                     END                             *FI
     C                     ADD  $SH9NB    $TCDNB           Head held over
      *
      *================================================================
     CSR         D2EXIT    ENDSR
      /EJECT
     CSR         D3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WBHMNB    WZD001           BOH Company Num
     C                     Z-ADDWBHMNB    WZD001
     C           *LIKE     DEFN WBB0DT    WZD002           TH Kill Date
     C                     Z-ADDWBB0DT    WZD002
     C           *LIKE     DEFN WBKAST    WZD003           TH Source Type
     C                     MOVELWBKAST    WZD003
     C           *LIKE     DEFN WBABCD    WZD004           PD Producer Cod
     C                     MOVELWBABCD    WZD004
     C           *LIKE     DEFN WBBNNB    WZD005           BOH Buy Order N
     C                     Z-ADDWBBNNB    WZD005
     C           *LIKE     DEFN WBBONB    WZD006           BOL Load Number
     C                     Z-ADDWBBONB    WZD006
     C           *LIKE     DEFN WBCVNB    WZD007           TH Tattoo Numbe
     C                     Z-ADDWBCVNB    WZD007
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFD    OREQ '1'
     C           KRSD      READE@A1CPDS                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFD  1
      * Quit if no record read
     C           W0EOFD    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
      * USER: Record selection processing
      * REQSEL:  Include Market
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Market USR is No
      *   |- c2    : DB1.TH Hog Class Type is Market
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TXST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'M'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Subject
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Subject USR is No
      *   |- c2    : DB1.TH Hog Class Type is Subject
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TYST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'S'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * REQSEL:  Include Resale
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Include Resale USR is No
      *   |- c2    : DB1.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TWST    IFEQ 'N'                        *IF
     C           WBLLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * CASE: PAR.Status 1 is Blank
     C           YL0011    IFEQ *BLANK                     *IF
      * CASE: DB1.PD Producer Code is AGP
     C           WBABCD    IFEQ 'AGP'                      *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Status 1 is Yes
     C           YL0011    IFEQ 'Y'                        *IF
      * CASE: DB1.PD Producer Code is SEABOA
     C           WBABCD    IFEQ @CN,001                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Status 1 is No
     C           YL0011    IFEQ 'N'                        *IF
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PD Producer Code is SEABOA
      *   |- c2    : DB1.PD Producer Code is AGP
      *   '-
     C           WBABCD    IFEQ @CN,001                    *IF
     C           WBABCD    OREQ 'AGP'                      *OR
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * INTSEL:  Head Received
      * CASE: DB1.TH Head Received is *Zeros
     C           WBCWNB    IFEQ *ZERO                      *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0DL00  1        BOH Company Num
     C                     MOVEL*BLANK    W0DL01  1        TH Kill Date
     C                     MOVEL*BLANK    W0DL02  1        TH Source Type
     C                     MOVEL*BLANK    W0DL03  1        PD Producer Cod
     C                     MOVEL*BLANK    W0DL04  1        BOH Buy Order N
     C                     MOVEL*BLANK    W0DL05  1        BOL Load Number
     C                     MOVEL*BLANK    W0DL06  1        TH Tattoo Numbe
     C           W0EOFD    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0DL00  1        BOH Company Num
     C                     MOVEL'Y'       W0DL01  1        TH Kill Date
     C                     MOVEL'Y'       W0DL02  1        TH Source Type
     C                     MOVEL'Y'       W0DL03  1        PD Producer Cod
     C                     MOVEL'Y'       W0DL04  1        BOH Buy Order N
     C                     MOVEL'Y'       W0DL05  1        BOL Load Number
     C                     MOVEL'Y'       W0DL06  1        TH Tattoo Numbe
     C                     ELSE
      * Next record - Detect level breaks
     C           WBHMNB    IFNE WZD001                     BOH Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL00
     C                     END
     C           WBB0DT    IFNE WZD002                     TH Kill Date
     C           W0DL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL01
     C                     END
     C           WBKAST    IFNE WZD003                     TH Source Type
     C           W0DL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL02
     C                     END
     C           WBABCD    IFNE WZD004                     PD Producer Cod
     C           W0DL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL03
     C                     END
     C           WBBNNB    IFNE WZD005                     BOH Buy Order N
     C           W0DL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL04
     C                     END
     C           WBBONB    IFNE WZD006                     BOL Load Number
     C           W0DL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL05
     C                     END
     C           WBCVNB    IFNE WZD007                     TH Tattoo Numbe
     C           W0DL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0DL06
     C                     END
     C                     END
      *================================================================
     CSR         D3EXIT    ENDSR
      /EJECT
     CSR         D4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0DL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP06
     C                     END
      *
     C           W0DL05    IFEQ 'Y'
      * USER: On print of BOL Load Number format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $THTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * More then one Tattoo.
      * CASE: PAR.Count USR is Greater than 1
     C           WN0970    IFGT 1                          *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Report Type = Summary
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$TKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP05
      * USER: Process after print of BOL Load Number format
     C                     ADD  $THD5U    $UHD5U           DOA Head Total
     C                     ADD  $TQENB    $UWWNB           Head Received 1
     C                     ADD  $TYDSM    $UYDSM           Yard Dead SUM
     C                     ADD  $TGONB    $UGONB           HEad Condemned
     C                     ADD  $TB4NB    $UB4NB           Head Total SUM
     C                     ADD  $TXRNB    $UXRNB           Head Total Sum2
     C                     ADD  $THTS3    $UHTS3           Head Total Sum3
     C                     ADD  $THTS4    $UHTS4           Head Total Sum4
     C                     ADD  $TH1SM    $UH1SM           Head 1 SUM
     C                     ADD  $TH2SM    $UH2SM           Head 2 SUM
     C                     ADD  $TH3SM    $UH3SM           Head 3 SUM
     C                     ADD  $THD4S    $UHD4S           Head 4 SUM
     C                     ADD  $THD5S    $UHD5S           Head 5 SUM
     C                     ADD  $TWTNB    $UWTNB           Hot Weight 1 SU
     C                     ADD  $TX5NB    $UX5NB           Live Weight SUM
     C                     ADD  $THCSM    $UHCSM           Head Count SUM
     C                     ADD  $TH5SM    $UH5SM           Head Total Sum5
     C                     ADD  $TCDNB    $UCDNB           Head held over
     C                     ADD  $TNINB    $UWUNB           Head Killed 1 S
     C                     END
      *
     C           W0DL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP04
     C                     END
      *
     C           W0DL03    IFEQ 'Y'
      * USER: On print of PD Producer Code format
      * CASE:
      *  - c1 OR c2
      *   |- c1    : CUR.PD Producer Code is AGP
      *   |- c2    : CUR.PD Producer Code is SEABOA
      *   '-
     C           $UABCD    IFEQ 'AGP'                      *IF
     C           $UABCD    OREQ @CN,001                    *OR
     C                     ELSE
      * CASE: *OTHERWISE
      * Prt FOM Summary N     US - Tattoo Header  * 
     C                     MOVEL'N'       W0AL03           PRDCR BRK
     C                     END                             *FI
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $UHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.PD Producer Code is Entered
     C           $WABCD    IFNE *BLANK                     *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$UKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP03
      * USER: Process after print of PD Producer Code format
     C                     ADD  $UHD5U    $VHD5U           DOA Head Total
     C                     ADD  $UYDSM    $VYDSM           Yard Dead SUM
     C                     ADD  $UWWNB    $VWWNB           Head Received 1
     C                     ADD  $UGONB    $VGONB           HEad Condemned
     C                     ADD  $UWUNB    $VWUNB           Head Killed 1 S
     C                     ADD  $UB4NB    $VB4NB           Head Total SUM
     C                     ADD  $UXRNB    $VXRNB           Head Total Sum2
     C                     ADD  $UHTS3    $VHTS3           Head Total Sum3
     C                     ADD  $UHTS4    $VHTS4           Head Total Sum4
     C                     ADD  $UH1SM    $VH1SM           Head 1 SUM
     C                     ADD  $UH2SM    $VH2SM           Head 2 SUM
     C                     ADD  $UH3SM    $VH3SM           Head 3 SUM
     C                     ADD  $UHD4S    $VHD4S           Head 4 SUM
     C                     ADD  $UHD5S    $VHD5S           Head 5 SUM
     C                     ADD  $UWTNB    $VWTNB           Hot Weight 1 SU
     C                     ADD  $UX5NB    $VX5NB           Live Weight SUM
     C                     ADD  $UHCSM    $VHCSM           Head Count SUM
     C                     ADD  $UH5SM    $VH5SM           Head Total Sum5
     C                     ADD  $UCDNB    $VCDNB           Head held over
     C                     END
      *
     C           W0DL02    IFEQ 'Y'
      * USER: On print of TH Source Type format
      * Prt Hot Scale Upl 2 Y US - Tattoo Header  * 
     C                     MOVEL'Y'       W0AL03           PRDCR BRK
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP02
     C                     END
      *
     C           W0DL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of TH Kill Date format
      * < 0.00>
      * CASE: CUR.Head Total Sum3 is GE ZERO
     C           $VHTS3    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
      * CASE: PAR.Status 1 is Blank
     C           YL0011    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    $VABCD           PD Producer Cod
     C                     MOVEL'AGP'     $VABCD           PD Producer Cod
     C                     ELSE
      * CASE: PAR.Status 1 is Yes
     C           YL0011    IFEQ 'Y'                        *IF
     C                     MOVEL@CN,001   $VABCD           PD Producer Cod
     C                     ELSE
      * CASE: PAR.Status 1 is No
     C           YL0011    IFEQ 'N'                        *IF
     C                     MOVEL*BLANK    $VABCD           PD Producer Cod
     C                     MOVEL'OTHER'   $VABCD           PD Producer Cod
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 3
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert TH Kill Date to display format
      * Convert date
     C           1000000   ADD  $VB0DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VVB0DT
      * Print format
     C                     WRITE$VKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP01
      * USER: Process after print of TH Kill Date format
      * Create FOM Summary OUTF - FOM Summary OUTF  * 
     C                     EXSR TRCRRC
     C                     END
      *
     C           W0DL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0DP00
     C                     END
      *
     C           W0EOFD    IFEQ '1'
      * USER: On print of final totals format
     C                     END
      *
      *================================================================
     CSR         D4EXIT    ENDSR
      /EJECT
     CSR         NASUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $SKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $SKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt FOM Summary       PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1HMNB    $BHMNB           BOH Company Num
     C                     Z-ADDP2B4DT    $BB4DT           Date To   USR
     C                     MOVELP3M1ST    $BM1ST           Report Type Sum
     C                     MOVELP3TXST    $BTXST           Include Market
     C                     MOVELP3TYST    $BTYST           Include Subject
     C                     MOVELP3TWST    $BTWST           Include Resale
     C                     MOVELP1ABCD    $BABCD           PD Producer Cod
     C                     MOVELP3J9ST    $BJ9ST           TH Payment Type
     C                     MOVELP3TVST    $BTVST           Variance Type U
     C                     Z-ADDP1B0DT    $BB3DT           Date From USR
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0001  30       CC Company Numb
     C           $BEUTX    PARM *BLANK    WQ0002 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0003  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Producer Name
      * CASE: PAR.PD Producer Code is Entered
     C           P1ABCD    IFNE *BLANK                     *IF
     C                     MOVEL*BLANK    $BA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SBRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BA4TX           Producer Name
     C                     MOVEL'*All'    $BA4TX           Producer Name
     C                     END                             *FI
      * Payment Type
      * CASE: 1PG.TH Payment Type is Carcass/Live
     C           $BJ9ST    IFEQ 'C'                        *IF
     C           $BJ9ST    OREQ 'L'
      * 1PG.Condition Name USR = Condition name of 1PG.TH Payment Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $BJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BC4TX    PARM           W0CNNM 25        Condition Name
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BC4TX           Condition Name
     C                     MOVEL'*All'    $BC4TX           Condition Name
     C                     END                             *FI
      * Variance Type
      * CASE: 1PG.Variance Type USR is *ALL values
     C           $BTVST    IFEQ '+'                        *IF
     C           $BTVST    OREQ '-'
      * 1PG.Condition Name 1 USR = Condition name of 1PG.Variance Type US
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1219297   Y2LSNO  70       List number
     C                     PARM $BTVST    W0INVL 25        Variance Type U
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI1TX    PARM           W0CNNM 25        Condition Name
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    $BI1TX           Condition Name
     C                     MOVEL'*All'    $BI1TX           Condition Name
     C                     END                             *FI
      * 1PG.Condition Name 2 USR = Condition name of 1PG.Include Market U
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70       List number
     C                     PARM $BTXST    W0INVL 25        Include Market
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI2TX    PARM           W0CNNM 25        Condition Name
      *
      * 1PG.Condition Name 3 USR = Condition name of 1PG.Include Subject
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70       List number
     C                     PARM $BTYST    W0INVL 25        Include Subject
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI3TX    PARM           W0CNNM 25        Condition Name
      *
      * 1PG.Condition Name 4 USR = Condition name of 1PG.Include Resale U
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70       List number
     C                     PARM $BTWST    W0INVL 25        Include Resale
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BI4TX    PARM           W0CNNM 25        Condition Name
      *
      * 1PG.Text 25 2 USR = Condition name of 1PG.Report Type Sum/Dtl USR
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1174633   Y2LSNO  70       List number
     C                     PARM $BM1ST    W0INVL 25        Report Type Sum
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BOFTX    PARM           W0CNNM 25        Text 25 2 USR
      *
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Date From USR to display format
      * Convert date
     C           1000000   ADD  $BB3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB3DT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  $BB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBB4DT
      * Print format
     C                     WRITE$B1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print BOH Company Number of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print TH Kill Date of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print PD Producer Code of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print BOH Buy Order Number of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print BOL Load Number of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * USER: On print of BOL Load Number format
     C                     Z-ADD*ZERO     P7P0NB           Count USR
      * Mention hidden format
     C   99N99             WRITE$DKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print TH Tattoo Number of Prt FOM Summary       PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print Detail line of Prt FOM Summary       PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
      * USER: On print of detail format
      * CUR.Text 10 1 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $ELLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $EJPTX    PARM           W0CNNM 25        Text 10 1 USR
      *
      * CUR.Th Payment Type Desc Usr = Condition name of CUR.TH Payment T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $EJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $EIYTX    PARM           W0CNNM 25        Th Payment Type
      *
      * Valid/Invalid Carcasses
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           A1LLST    IFEQ 'M'                        *IF
     C           A1LLST    OREQ 'S'
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
     C                     EXSR SCRVGN
     C                     ADD  YL0006    $ELINB           Head 2
     C           $ELFNB    ADD  $ELINB    $ECRNB           Head Total (5.0
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $ELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ELINB           Head 2
     C                     Z-ADD*ZERO     $ECRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $EIINB           Difference +/-
     C                     END                             *FI
      * Difference +/-
      * PAR.Difference +/- =
      *    *COMPUTE (x1 - x2)
      * x1    : CUR.TH Head Killed
      * -     : PGM.*Synon (15,0) work field
      * x2    : CUR.Head Total (5.0) USR
     C           $EFENB    SUB  $ECRNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    P6IINB           Difference +/-
      * < 0.00>
      * CASE: PAR.Difference +/- is GE ZERO
     C           P6IINB    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C                     Z-ADDP6IINB    $EIINB           Difference +/-
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
     C                     EXSR SFRVGN
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
     C                     EXSR SJRVGN
     C                     MOVEL'Y'       YL0010           *Record selecte
      * Print Format/Record Selected
      * CASE: PAR.Variance Type USR is *ALL values
     C           P3TVST    IFEQ '+'                        *IF
     C           P3TVST    OREQ '-'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Negative
      *   |- c2    : CUR.Difference +/- is GE ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '-'                        *IF
     C           $EIINB    IFGE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0010           *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Positive
      *   |- c2    : CUR.Difference +/- is LT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '+'                        *IF
     C           $EIINB    IFLT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0010           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$EDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Print First Page Format of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * USER: On print of first page format
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print BOH Company Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0BP00
     C                     END                             FI
      * Print TH Kill Date of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print TH Source Type of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print PD Producer Code of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP03
     C                     END                             FI
      * Print BOH Buy Order Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP04
     C                     END                             FI
      * Print BOL Load Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP05    ANDEQ'P'
      * USER: On print of BOL Load Number format
     C                     Z-ADD*ZERO     WN0322           Count USR
      * Mention hidden format
     C   99N99             WRITE$HKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0BP05
     C                     END                             FI
      * Print TH Tattoo Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP06
     C                     END                             FI
      * Print Detail line of Prt FOM Summary       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * USER: On print of detail format
      * CUR.Text 10 1 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $ILLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $IJPTX    PARM           W0CNNM 25        Text 10 1 USR
      *
      * CUR.Th Payment Type Desc Usr = Condition name of CUR.TH Payment T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $IJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $IIYTX    PARM           W0CNNM 25        Th Payment Type
      *
      * Valid/Invalid Carcasses
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
     C                     EXSR SMRVGN
     C                     ADD  YL0017    $ILINB           Head 2
     C           $ILFNB    ADD  $ILINB    $ICRNB           Head Total (5.0
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $ILFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ILINB           Head 2
     C                     Z-ADD*ZERO     $ICRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $IIINB           Difference +/-
     C                     END                             *FI
      * Difference +/-
      * PAR.Difference +/- =
      *    *COMPUTE (x1 - x2)
      * x1    : CUR.TH Head Killed
      * -     : PGM.*Synon (15,0) work field
      * x2    : CUR.Head Total (5.0) USR
     C           $IFENB    SUB  $ICRNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0321           Difference +/-
      * < 0.00>
      * CASE: PAR.Difference +/- is GE ZERO
     C           WN0321    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C                     Z-ADDWN0321    $IIINB           Difference +/-
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
     C                     EXSR SPRVGN
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
     C                     EXSR STRVGN
     C                     MOVEL'Y'       YL0019           *Record selecte
      * Print Format/Record Selected
      * CASE: PAR.Variance Type USR is *ALL values
     C           P3TVST    IFEQ '+'                        *IF
     C           P3TVST    OREQ '-'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Negative
      *   |- c2    : CUR.Difference +/- is GE ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '-'                        *IF
     C           $IIINB    IFGE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0019           *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Positive
      *   |- c2    : CUR.Difference +/- is LT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '+'                        *IF
     C           $IIINB    IFLT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0019           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$IDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print First Page Format of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP1P    ANDEQ'P'
      * USER: On print of first page format
      * Reset format print flag
     C                     MOVE *BLANK    W0CP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0CL1P
     C                     END                             FI
      * Print BOH Company Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0CP00
     C                     END                             FI
      * Print TH Kill Date of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP01
     C                     END                             FI
      * Print TH Source Type of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP02
     C                     END                             FI
      * Print PD Producer Code of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP03
     C                     END                             FI
      * Print BOH Buy Order Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP04
     C                     END                             FI
      * Print BOL Load Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP05    ANDEQ'P'
      * USER: On print of BOL Load Number format
     C                     Z-ADD*ZERO     WN0646           Count USR
      * Mention hidden format
     C   99N99             WRITE$MKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0CP05
     C                     END                             FI
      * Print TH Tattoo Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0CP06
     C                     END                             FI
      * Print Detail line of Prt FOM Summary       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0CCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0CPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0CPDT    ANDEQ'P'
      * USER: On print of detail format
      * CUR.Text 10 1 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $NLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $NJPTX    PARM           W0CNNM 25        Text 10 1 USR
      *
      * CUR.Th Payment Type Desc Usr = Condition name of CUR.TH Payment T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $NJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $NIYTX    PARM           W0CNNM 25        Th Payment Type
      *
      * Valid/Invalid Carcasses
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
     C                     EXSR SXRVGN
     C                     ADD  YL0017    $NLINB           Head 2
     C           $NLFNB    ADD  $NLINB    $NCRNB           Head Total (5.0
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $NLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $NLINB           Head 2
     C                     Z-ADD*ZERO     $NCRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $NIINB           Difference +/-
     C                     END                             *FI
      * Difference +/-
      * PAR.Difference +/- =
      *    *COMPUTE (x1 - x2)
      * x1    : CUR.TH Head Killed
      * -     : PGM.*Synon (15,0) work field
      * x2    : CUR.Head Total (5.0) USR
     C           $NFENB    SUB  $NCRNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0645           Difference +/-
      * < 0.00>
      * CASE: PAR.Difference +/- is GE ZERO
     C           WN0645    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C                     Z-ADDWN0645    $NIINB           Difference +/-
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
     C                     EXSR TARVGN
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
     C                     EXSR TERVGN
     C                     MOVEL'Y'       YL0019           *Record selecte
      * Print Format/Record Selected
      * CASE: PAR.Variance Type USR is *ALL values
     C           P3TVST    IFEQ '+'                        *IF
     C           P3TVST    OREQ '-'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Negative
      *   |- c2    : CUR.Difference +/- is GE ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '-'                        *IF
     C           $NIINB    IFGE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0019           *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Positive
      *   |- c2    : CUR.Difference +/- is LT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '+'                        *IF
     C           $NIINB    IFLT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0019           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$NDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0CPDT
     C                     END                             FI
      * Print First Page Format of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP1P    ANDEQ'P'
      * USER: On print of first page format
      * Reset format print flag
     C                     MOVE *BLANK    W0DP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0DL1P
     C                     END                             FI
      * Print BOH Company Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE 'P'       W0DP00
     C                     END                             FI
      * Print TH Kill Date of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP01
     C                     END                             FI
      * Print TH Source Type of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP02
     C                     END                             FI
      * Print PD Producer Code of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP03
     C                     END                             FI
      * Print BOH Buy Order Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP04
     C                     END                             FI
      * Print BOL Load Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP05    ANDEQ'P'
      * USER: On print of BOL Load Number format
     C                     Z-ADD*ZERO     WN0970           Count USR
      * Mention hidden format
     C   99N99             WRITE$RKEYHDR
      * Reset format print flag
     C                     MOVE *BLANK    W0DP05
     C                     END                             FI
      * Print TH Tattoo Number of Prt FOM Summary       PO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0DP06
     C                     END                             FI
      * Print Detail line of Prt FOM Summary       PO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0DCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0DPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0DPDT    ANDEQ'P'
      * USER: On print of detail format
      * CUR.Text 10 1 USR = Condition name of CUR.TH Hog Class Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1110255   Y2LSNO  70       List number
     C                     PARM $SLLST    W0INVL 25        TH Hog Class Ty
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $SJPTX    PARM           W0CNNM 25        Text 10 1 USR
      *
      * CUR.Th Payment Type Desc Usr = Condition name of CUR.TH Payment T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM $SJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $SIYTX    PARM           W0CNNM 25        Th Payment Type
      *
      * Valid/Invalid Carcasses
      * CASE: DB1.TH Hog Class Type is Not Resale
     C           WBLLST    IFEQ 'M'                        *IF
     C           WBLLST    OREQ 'S'
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
     C                     EXSR TIRVGN
     C                     ADD  YL0017    $SLINB           Head 2
     C           $SLFNB    ADD  $SLINB    $SCRNB           Head Total (5.0
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $SLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $SLINB           Head 2
     C                     Z-ADD*ZERO     $SCRNB           Head Total (5.0
     C                     Z-ADD*ZERO     $SIINB           Difference +/-
     C                     END                             *FI
      * Difference +/-
      * PAR.Difference +/- =
      *    *COMPUTE (x1 - x2)
      * x1    : CUR.TH Head Killed
      * -     : PGM.*Synon (15,0) work field
      * x2    : CUR.Head Total (5.0) USR
     C           $SFENB    SUB  $SCRNB    W0WJ00           *Synon (15,0) w
     C                     Z-ADDW0WJ00    WN0969           Difference +/-
      * < 0.00>
      * CASE: PAR.Difference +/- is GE ZERO
     C           WN0969    IFGE *ZERO                      *IF
     C                     MOVEL*BLANK    WUHDST           Display Field U
     C                     MOVEL'*NO'     WUHDST           Display Field U
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'*YES'    WUHDST           Display Field U
     C                     END                             *FI
     C                     Z-ADDWN0969    $SIINB           Difference +/-
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
     C                     EXSR TLRVGN
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
     C                     EXSR TPRVGN
     C                     MOVEL'Y'       YL0019           *Record selecte
      * Print Format/Record Selected
      * CASE: PAR.Variance Type USR is *ALL values
     C           P3TVST    IFEQ '+'                        *IF
     C           P3TVST    OREQ '-'
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Negative
      *   |- c2    : CUR.Difference +/- is GE ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '-'                        *IF
     C           $SIINB    IFGE *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0019           *Record selecte
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Variance Type USR is Positive
      *   |- c2    : CUR.Difference +/- is LT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P3TVST    IFEQ '+'                        *IF
     C           $SIINB    IFLT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     MOVEL'N'       YL0019           *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Report Type Sum/Dtl USR is Summary
     C           P3M1ST    IFEQ 'S'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$SDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0DPDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt FOM Summary       PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  6         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt FOM Summary       PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  5         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt FOM Summary       PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt FOM Summary       PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt FOM Summary       PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt FOM Summary       PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt FOM Summary       PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line of Prt FOM Summary       PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt FOM Summary       PO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt FOM Summary       PO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt FOM Summary       PO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Source Type of Prt FOM Summary       PO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt FOM Summary       PO
     C           W0BP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt FOM Summary       PO
     C           W0BP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt FOM Summary       PO
     C           W0BP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt FOM Summary       PO
     C           W0BP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line of Prt FOM Summary       PO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt FOM Summary       PO
     C           W0CP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt FOM Summary       PO
     C           W0CP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt FOM Summary       PO
     C           W0CP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Source Type of Prt FOM Summary       PO
     C           W0CP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt FOM Summary       PO
     C           W0CP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt FOM Summary       PO
     C           W0CP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt FOM Summary       PO
     C           W0CP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt FOM Summary       PO
     C           W0CP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line of Prt FOM Summary       PO
     C           W0CPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0CCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt FOM Summary       PO
     C           W0DP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Company Number of Prt FOM Summary       PO
     C           W0DP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Kill Date of Prt FOM Summary       PO
     C           W0DP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Source Type of Prt FOM Summary       PO
     C           W0DP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * PD Producer Code of Prt FOM Summary       PO
     C           W0DP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOH Buy Order Number of Prt FOM Summary       PO
     C           W0DP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * BOL Load Number of Prt FOM Summary       PO
     C           W0DP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * TH Tattoo Number of Prt FOM Summary       PO
     C           W0DP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line of Prt FOM Summary       PO
     C           W0DPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0DCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     WUJANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJBNB           %Lean High Min
     C                     Z-ADD*ZERO     WUJLNB           %Lean High Max
     C                     Z-ADD*ZERO     WUJMNB           %Lean Low Min
     C                     Z-ADD*ZERO     WUJCNB           %Lean Low Max
     C                     Z-ADD*ZERO     WUJDNB           High Yield Min
     C                     Z-ADD*ZERO     WUJENB           High Yield Max
     C                     Z-ADD*ZERO     WUJFNB           Low Yield Min
     C                     Z-ADD*ZERO     WUJGNB           Low Yield Max
     C                     Z-ADD*ZERO     WUJHNB           Head < Percent
     C                     Z-ADD*ZERO     WUJINB           Head < Percent
     C                     Z-ADD*ZERO     WUJJNB           Head > Percent
     C                     Z-ADD*ZERO     WUJKNB           Head > Percent
     C                     Z-ADD*ZERO     WUK5NB           BackFat High Mi
     C                     Z-ADD*ZERO     WUK6NB           BackFat High Ma
     C                     Z-ADD*ZERO     WUK7NB           BackFat Low Min
     C                     Z-ADD*ZERO     WUK8NB           Backfat Low Max
     C                     Z-ADD*ZERO     WUK9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     WULANB           LoinEye High Ma
     C                     Z-ADD*ZERO     WULBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     WULCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    WUI7NB           Carcass Dbw Min
     C                     Z-ADDBOAGPC    WUI8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    WUI9NB           Carcass Lgt Min
     C                     Z-ADDBOAGPC    WUJANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    WUK5NB           BackFat High Mi
     C                     Z-ADDBOAGPC    WUK6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    WUK7NB           BackFat Low Min
     C                     Z-ADDBOAGPC    WUK8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    WUK9NB           LoinEye High Mi
     C                     Z-ADDBOAGPC    WULANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    WULBNB           LoinEye Low Min
     C                     Z-ADDBOAGPC    WULCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    WUJBNB           %Lean High Min
     C                     Z-ADDBOAGPC    WUJLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    WUJMNB           %Lean Low Min
     C                     Z-ADDBOAGPC    WUJCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    WUJHNB           Head < Percent
     C                     Z-ADDBOAGPC    WUJINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    WUJJNB           Head > Percent
     C                     Z-ADDBOAGPC    WUJKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    WUJDNB           High Yield Min
     C                     Z-ADDBOAGPC    WUJENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    WUJFNB           Low Yield Min
     C                     Z-ADDBOAGPC    WUJGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL$BABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSB     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    $BA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $ELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ELINB           Head 2
     C                     Z-ADD*ZERO     $EMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     YL0002           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     YL0003           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     YL0004           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0005           Hot Wgt/LghtR A
     C                     Z-ADD*ZERO     $EKGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     YL0006           Head No Probe U
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPHKST    WQSC01           EA Company Numb
     C           *LIKE     DEFN CPKHNB    WQSC02           EA Tattoo Numbe
     C           *LIKE     DEFN CPB7DT    WQSC03           EA Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           EA Company Numb
     C                     KFLD           WQSC02           EA Tattoo Numbe
     C                     KFLD           WQSC03           EA Kill Date
      * Setup key
     C                     Z-ADDA1HMNB    WQSC01           EA Company Numb
     C                     Z-ADDA1CVNB    WQSC02           EA Tattoo Numbe
     C                     Z-ADDA1B0DT    WQSC03           EA Kill Date
      * Establish starting position
     C           KRSSC     SETLL@CPCPCI                    *
     C           KRSSC     READE@CPCPCI                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUD2ST           ET Error Sts
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UBSUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.EA Hot Weight LE PAR.Carcass Lgt Max
     C           CPKJNB    IFLE WUJANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Hot Weight GE PAR.Carcass Dbw Min
     C           CPKJNB    IFGE WUI7NB                     *IF
     C                     MOVEL'CDB'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.EA Backfat Thickness Inch LE PAR.Backfat Low Max
     C           CPKKNB    IFLE WUK8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Backfat Thickness Inch GE PAR.BackFat High Min
     C           CPKKNB    IFGE WUK5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.EA Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           CPBQPC    IFLE WULCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           CPBQPC    IFGE WUK9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: WRK.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           WUAKPC    IFLE WUJCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: WRK.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           WUAKPC    IFGE WUJBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Trimmed Carcasses
      * CASE: DB1.EA Trim Area NE WRK.Blank USR
     C           CPHMST    IFNE WUCRTX                     *IF
     C                     ADD  1         $EMWNB           Trim Head 1 USR
     C                     END                             *FI
      * Valid/Exception Carcasses
      * CASE: WRK.ET Error Sts is Error
     C           WUD2ST    IFEQ 'E'                        *IF
      * Exception Carcasses
      * Positive FOM Reading
      * CASE: Hot Weight, Back Fat, Loin Eye > 0
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.EA Hot Weight is Not Zero
      *   |- c2    : DB1.EA Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.EA Loin-Eye Depth Inches is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CPKJNB    IFNE 0                          *IF
     C           CPKKNB    IFGT 0                          *IF
     C           CPBQPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         $ELINB           Head 2
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Excep
     C           P3T5ST    IFEQ 'UE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0001  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0002  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0003  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0004  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0005  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0006  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0007  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0008  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0009  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0010  72       CD Gross Value
     C                     MOVEL*BLANK    WN0011  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0012  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0013  31       CD FFLI
     C                     MOVEL*BLANK    WN0014  1        CD Record Creat
     C                     MOVEL*BLANK    WN0015  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0016  50       CD LOT
     C                     MOVEL*BLANK    WN0017  1        CD User Error O
     C                     Z-ADD*ZERO     WN0018  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0019  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0020  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0021  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0022  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0023  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0024  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0025  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0026  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0027  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0028  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0029  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0030  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0031  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0032  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0033  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0034  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0035  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0036  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0037  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0038  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0039  72       CD Gross Before
     C                     MOVEL*BLANK    WN0040  1        CD Broken Back
     C                     MOVEL*BLANK    WN0041  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0042  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0043  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0044  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0045 10        RS User Changed
     C                     Z-ADD*ZERO     WN0046  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0047  60       RS Time Changed
     C                     MOVEL*BLANK    WN0048  1        RS Record Statu
     C                     MOVEL*BLANK    WN0049 10        RS Job
     C                     MOVEL*BLANK    WN0050 10        RS Program
     C                     MOVEL*BLANK    WN0051 10        RS User Added
     C                     Z-ADD*ZERO     WN0052  70       RS Date Added
     C                     Z-ADD*ZERO     WN0053  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SDCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           P3T6ST    IFEQ 'UE'                       *IF
      * Accumulation
     C                     EXSR UCSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0006           Head No Probe U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Carcasses
     C                     ADD  1         $ELFNB           TDE Head Condem
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Valid
     C           P3T5ST    IFEQ 'UV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0054  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0055  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0056  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0057  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0058  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0059  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0060  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0061  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0062  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0063  72       CD Gross Value
     C                     MOVEL*BLANK    WN0064  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0065  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0066  31       CD FFLI
     C                     MOVEL*BLANK    WN0067  1        CD Record Creat
     C                     MOVEL*BLANK    WN0068  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0069  50       CD LOT
     C                     MOVEL*BLANK    WN0070  1        CD User Error O
     C                     Z-ADD*ZERO     WN0071  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0072  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0073  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0074  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0075  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0076  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0077  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0078  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0079  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0080  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0081  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0082  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0083  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0084  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0085  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0086  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0087  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0088  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0089  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0090  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0091  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0092  72       CD Gross Before
     C                     MOVEL*BLANK    WN0093  1        CD Broken Back
     C                     MOVEL*BLANK    WN0094  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0095  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0096  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0097  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0098 10        RS User Changed
     C                     Z-ADD*ZERO     WN0099  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0100  60       RS Time Changed
     C                     MOVEL*BLANK    WN0101  1        RS Record Statu
     C                     MOVEL*BLANK    WN0102 10        RS Job
     C                     MOVEL*BLANK    WN0103 10        RS Program
     C                     MOVEL*BLANK    WN0104 10        RS User Added
     C                     Z-ADD*ZERO     WN0105  70       RS Date Added
     C                     Z-ADD*ZERO     WN0106  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SECRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           P3T6ST    IFEQ 'UV'                       *IF
      * Accumulation
     C                     EXSR UDSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSC     READE@CPCPCI                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0001    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0002    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0003    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0004    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0005    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0006    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0007    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0008    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0009    B1EZNB           CD Gross Value
     C                     Z-ADDWN0010    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0011    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0012    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0013    B1BHPC           CD FFLI
     C                     MOVELWN0014    B1IOST           CD Record Creat
     C                     MOVELWN0015    B1IPST           CD Record Creat
     C                     Z-ADDWN0016    B1LTNB           CD LOT
     C                     MOVELWN0017    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0018    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0019    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0020    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0021    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0022    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0023    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0024    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0025    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0026    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0027    B1J4PR           CD CA Gross Val
     C                     MOVELWN0028    B1UTST           CD Adjust/Add T
     C                     MOVELWN0029    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0030    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0031    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0032    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0033    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0034    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0035    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0036    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0037    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0038    B1IUTR           CD Gross Before
     C                     Z-ADDWN0039    B1IJRR           CD Gross Before
     C                     MOVELWN0040    B1VCST           CD Broken Back
     C                     MOVELWN0041    B1VDST           CD Adjust/Add S
     C                     MOVELWN0042    B1VEST           CD Unused Sts 3
     C                     MOVELWN0043    B1VFST           CD Unused Sts 4
     C                     MOVELWN0044    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0045    B1AAVN           RS User Changed
     C                     Z-ADDWN0046    B1AADT           RS Date Changed
     C                     Z-ADDWN0047    B1AMTM           RS Time Changed
     C                     MOVELWN0048    B1AJST           RS Record Statu
     C                     MOVELWN0049    B1AHVN           RS Job
     C                     MOVELWN0050    B1AGVN           RS Program
     C                     MOVELWN0051    B1ABVN           RS User Added
     C                     Z-ADDWN0052    B1ABDT           RS Date Added
     C                     Z-ADDWN0053    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0004  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0005  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSD    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSD    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0054    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0055    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0056    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0057    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0058    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0059    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0060    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0061    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0062    B1EZNB           CD Gross Value
     C                     Z-ADDWN0063    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0064    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0065    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0066    B1BHPC           CD FFLI
     C                     MOVELWN0067    B1IOST           CD Record Creat
     C                     MOVELWN0068    B1IPST           CD Record Creat
     C                     Z-ADDWN0069    B1LTNB           CD LOT
     C                     MOVELWN0070    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0071    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0072    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0073    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0074    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0075    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0076    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0077    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0078    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0079    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0080    B1J4PR           CD CA Gross Val
     C                     MOVELWN0081    B1UTST           CD Adjust/Add T
     C                     MOVELWN0082    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0083    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0084    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0085    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0086    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0087    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0088    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0089    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0090    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0091    B1IUTR           CD Gross Before
     C                     Z-ADDWN0092    B1IJRR           CD Gross Before
     C                     MOVELWN0093    B1VCST           CD Broken Back
     C                     MOVELWN0094    B1VDST           CD Adjust/Add S
     C                     MOVELWN0095    B1VEST           CD Unused Sts 3
     C                     MOVELWN0096    B1VFST           CD Unused Sts 4
     C                     MOVELWN0097    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0098    B1AAVN           RS User Changed
     C                     Z-ADDWN0099    B1AADT           RS Date Changed
     C                     Z-ADDWN0100    B1AMTM           RS Time Changed
     C                     MOVELWN0101    B1AJST           RS Record Statu
     C                     MOVELWN0102    B1AHVN           RS Job
     C                     MOVELWN0103    B1AGVN           RS Program
     C                     MOVELWN0104    B1ABVN           RS User Added
     C                     Z-ADDWN0105    B1ABDT           RS Date Added
     C                     Z-ADDWN0106    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0006  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0007  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSE    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQSF03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQSF04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQSF05           TH Kill Date
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
     C                     KFLD           WQSF04           TH Tattoo Numbe
     C                     KFLD           WQSF05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQSF01           BOH Company Num
     C                     Z-ADD$EBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQSF03           BOL Load Number
     C                     Z-ADD$ECVNB    WQSF04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQSF05           TH Kill Date
      * Establish starting position
     C           KRSSF     SETLL@BVCPQ9                    *
     C           KRSSF     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Average Adds
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
     C                     ADD  1         WULKIR           Head 6
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           BVAJST    IFEQ 'A'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
      * Added Carcasses
     C                     ADD  1         $EHD3C           Head 3
      * CASE: PAR.Payment Data Type USR is Eval Trans Adds
     C           P3T5ST    IFEQ 'EA'                       *IF
      *
     C                     Z-ADD*ZERO     WN0107  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0108  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0109  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0110  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0111  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0112  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0113  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0114  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0115  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0116  72       CD Gross Value
     C                     MOVEL*BLANK    WN0117  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0118  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0119  31       CD FFLI
     C                     MOVEL*BLANK    WN0120  1        CD Record Creat
     C                     MOVEL*BLANK    WN0121  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0122  50       CD LOT
     C                     MOVEL*BLANK    WN0123  1        CD User Error O
     C                     Z-ADD*ZERO     WN0124  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0125  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0126  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0127  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0128  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0129  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0130  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0131  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0132  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0133  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0134  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0135  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0136  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0137  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0138  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0139  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0140  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0141  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0142  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0143  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0144  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0145  72       CD Gross Before
     C                     MOVEL*BLANK    WN0146  1        CD Broken Back
     C                     MOVEL*BLANK    WN0147  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0148  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0149  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0150  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0151 10        RS User Changed
     C                     Z-ADD*ZERO     WN0152  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0153  60       RS Time Changed
     C                     MOVEL*BLANK    WN0154  1        RS Record Statu
     C                     MOVEL*BLANK    WN0155 10        RS Job
     C                     MOVEL*BLANK    WN0156 10        RS Program
     C                     MOVEL*BLANK    WN0157 10        RS User Added
     C                     Z-ADD*ZERO     WN0158  70       RS Date Added
     C                     Z-ADD*ZERO     WN0159  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SGCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           P3T6ST    IFEQ 'EA'                       *IF
      * Accumulation
     C                     EXSR UESUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.ET Record Add/Del Sts is Delete
     C           BVEHST    IFEQ 'D'                        *IF
      * Flagged for Delete
     C                     ADD  1         $EHD4C           Head 4
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Deleted/Inactive
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Not Original Record
     C           BVEHST    IFEQ 'A'                        *IF
     C           BVEHST    OREQ *BLANK
     C           BVEHST    OREQ 'D'
      * CASE: DB1.ET Error Sts is Balance
     C           BVD2ST    IFEQ 'B'                        *IF
      * Valid Deleted
     C                     ADD  1         $EHD4C           Head 4
      * CASE: PAR.Payment Data Type USR is Eval Trans Valid Deletes
     C           P3T5ST    IFEQ 'EV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0160  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0161  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0162  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0163  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0164  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0165  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0166  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0167  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0168  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0169  72       CD Gross Value
     C                     MOVEL*BLANK    WN0170  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0171  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0172  31       CD FFLI
     C                     MOVEL*BLANK    WN0173  1        CD Record Creat
     C                     MOVEL*BLANK    WN0174  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0175  50       CD LOT
     C                     MOVEL*BLANK    WN0176  1        CD User Error O
     C                     Z-ADD*ZERO     WN0177  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0178  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0179  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0180  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0181  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0182  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0183  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0184  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0185  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0186  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0187  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0188  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0189  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0190  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0191  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0192  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0193  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0194  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0195  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0196  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0197  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0198  72       CD Gross Before
     C                     MOVEL*BLANK    WN0199  1        CD Broken Back
     C                     MOVEL*BLANK    WN0200  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0201  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0202  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0203  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0204 10        RS User Changed
     C                     Z-ADD*ZERO     WN0205  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0206  60       RS Time Changed
     C                     MOVEL*BLANK    WN0207  1        RS Record Statu
     C                     MOVEL*BLANK    WN0208 10        RS Job
     C                     MOVEL*BLANK    WN0209 10        RS Program
     C                     MOVEL*BLANK    WN0210 10        RS User Added
     C                     Z-ADD*ZERO     WN0211  70       RS Date Added
     C                     Z-ADD*ZERO     WN0212  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SHCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Valid Deletes
     C           P3T6ST    IFEQ 'EV'                       *IF
      * Accumulation
     C                     EXSR UFSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Exceptions Deleted
     C                     ADD  1         $EHD5C           Head 5
      * Positive FOM Reading
      * CASE: Hot Wgt, Backfat, Loin Eye, Lean% > 0
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.ET Hot Wgt is Not Zero
      *   |- c2    : DB1.ET Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.ET Loin-Eye Depth Inches is GT Zero
      *   |- c4    : DB1.ET Lean Percent NPPC is Greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BVAMPC    IFNE 0                          *IF
     C           BVAIPC    IFGT 0                          *IF
     C           BVAJPC    IFGT 0                          *IF
     C           BVAKPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Payment Data Type USR is Eval Trans Excep Deletes
     C           P3T5ST    IFEQ 'EE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0213  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0214  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0215  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0216  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0217  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0218  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0219  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0220  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0221  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0222  72       CD Gross Value
     C                     MOVEL*BLANK    WN0223  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0224  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0225  31       CD FFLI
     C                     MOVEL*BLANK    WN0226  1        CD Record Creat
     C                     MOVEL*BLANK    WN0227  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0228  50       CD LOT
     C                     MOVEL*BLANK    WN0229  1        CD User Error O
     C                     Z-ADD*ZERO     WN0230  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0231  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0232  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0233  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0234  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0235  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0236  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0237  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0238  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0239  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0240  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0241  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0242  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0243  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0244  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0245  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0246  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0247  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0248  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0249  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0250  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0251  72       CD Gross Before
     C                     MOVEL*BLANK    WN0252  1        CD Broken Back
     C                     MOVEL*BLANK    WN0253  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0254  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0255  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0256  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0257 10        RS User Changed
     C                     Z-ADD*ZERO     WN0258  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0259  60       RS Time Changed
     C                     MOVEL*BLANK    WN0260  1        RS Record Statu
     C                     MOVEL*BLANK    WN0261 10        RS Job
     C                     MOVEL*BLANK    WN0262 10        RS Program
     C                     MOVEL*BLANK    WN0263 10        RS User Added
     C                     Z-ADD*ZERO     WN0264  70       RS Date Added
     C                     Z-ADD*ZERO     WN0265  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SICRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Excep Deletes
     C           P3T6ST    IFEQ 'EE'                       *IF
      * Accumulation
     C                     EXSR UGSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0107    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0108    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0109    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0110    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0111    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0112    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0113    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0114    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0115    B1EZNB           CD Gross Value
     C                     Z-ADDWN0116    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0117    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0118    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0119    B1BHPC           CD FFLI
     C                     MOVELWN0120    B1IOST           CD Record Creat
     C                     MOVELWN0121    B1IPST           CD Record Creat
     C                     Z-ADDWN0122    B1LTNB           CD LOT
     C                     MOVELWN0123    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0124    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0125    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0126    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0127    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0128    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0129    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0130    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0131    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0132    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0133    B1J4PR           CD CA Gross Val
     C                     MOVELWN0134    B1UTST           CD Adjust/Add T
     C                     MOVELWN0135    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0136    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0137    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0138    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0139    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0140    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0141    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0142    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0143    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0144    B1IUTR           CD Gross Before
     C                     Z-ADDWN0145    B1IJRR           CD Gross Before
     C                     MOVELWN0146    B1VCST           CD Broken Back
     C                     MOVELWN0147    B1VDST           CD Adjust/Add S
     C                     MOVELWN0148    B1VEST           CD Unused Sts 3
     C                     MOVELWN0149    B1VFST           CD Unused Sts 4
     C                     MOVELWN0150    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0151    B1AAVN           RS User Changed
     C                     Z-ADDWN0152    B1AADT           RS Date Changed
     C                     Z-ADDWN0153    B1AMTM           RS Time Changed
     C                     MOVELWN0154    B1AJST           RS Record Statu
     C                     MOVELWN0155    B1AHVN           RS Job
     C                     MOVELWN0156    B1AGVN           RS Program
     C                     MOVELWN0157    B1ABVN           RS User Added
     C                     Z-ADDWN0158    B1ABDT           RS Date Added
     C                     Z-ADDWN0159    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0008  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0009  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSG    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSG    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0160    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0161    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0162    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0163    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0164    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0165    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0166    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0167    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0168    B1EZNB           CD Gross Value
     C                     Z-ADDWN0169    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0170    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0171    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0172    B1BHPC           CD FFLI
     C                     MOVELWN0173    B1IOST           CD Record Creat
     C                     MOVELWN0174    B1IPST           CD Record Creat
     C                     Z-ADDWN0175    B1LTNB           CD LOT
     C                     MOVELWN0176    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0177    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0178    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0179    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0180    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0181    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0182    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0183    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0184    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0185    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0186    B1J4PR           CD CA Gross Val
     C                     MOVELWN0187    B1UTST           CD Adjust/Add T
     C                     MOVELWN0188    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0189    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0190    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0191    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0192    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0193    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0194    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0195    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0196    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0197    B1IUTR           CD Gross Before
     C                     Z-ADDWN0198    B1IJRR           CD Gross Before
     C                     MOVELWN0199    B1VCST           CD Broken Back
     C                     MOVELWN0200    B1VDST           CD Adjust/Add S
     C                     MOVELWN0201    B1VEST           CD Unused Sts 3
     C                     MOVELWN0202    B1VFST           CD Unused Sts 4
     C                     MOVELWN0203    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0204    B1AAVN           RS User Changed
     C                     Z-ADDWN0205    B1AADT           RS Date Changed
     C                     Z-ADDWN0206    B1AMTM           RS Time Changed
     C                     MOVELWN0207    B1AJST           RS Record Statu
     C                     MOVELWN0208    B1AHVN           RS Job
     C                     MOVELWN0209    B1AGVN           RS Program
     C                     MOVELWN0210    B1ABVN           RS User Added
     C                     Z-ADDWN0211    B1ABDT           RS Date Added
     C                     Z-ADDWN0212    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0010  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0011  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSH    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSH    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$EHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$EBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$EBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ECVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0213    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0214    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0215    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0216    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0217    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0218    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0219    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0220    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0221    B1EZNB           CD Gross Value
     C                     Z-ADDWN0222    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0223    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0224    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0225    B1BHPC           CD FFLI
     C                     MOVELWN0226    B1IOST           CD Record Creat
     C                     MOVELWN0227    B1IPST           CD Record Creat
     C                     Z-ADDWN0228    B1LTNB           CD LOT
     C                     MOVELWN0229    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$EKAST    B1K2ST           CD Source Type
     C                     MOVEL$EJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0230    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0231    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0232    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0233    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0234    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0235    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0236    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0237    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0238    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0239    B1J4PR           CD CA Gross Val
     C                     MOVELWN0240    B1UTST           CD Adjust/Add T
     C                     MOVELWN0241    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0242    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0243    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0244    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0245    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0246    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0247    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0248    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0249    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0250    B1IUTR           CD Gross Before
     C                     Z-ADDWN0251    B1IJRR           CD Gross Before
     C                     MOVELWN0252    B1VCST           CD Broken Back
     C                     MOVELWN0253    B1VDST           CD Adjust/Add S
     C                     MOVELWN0254    B1VEST           CD Unused Sts 3
     C                     MOVELWN0255    B1VFST           CD Unused Sts 4
     C                     MOVELWN0256    B1VGST           CD Unused Sts 5
     C                     MOVEL$EABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ELKST    B1AACD           SR Source Code
     C                     MOVELWN0257    B1AAVN           RS User Changed
     C                     Z-ADDWN0258    B1AADT           RS Date Changed
     C                     Z-ADDWN0259    B1AMTM           RS Time Changed
     C                     MOVELWN0260    B1AJST           RS Record Statu
     C                     MOVELWN0261    B1AHVN           RS Job
     C                     MOVELWN0262    B1AGVN           RS Program
     C                     MOVELWN0263    B1ABVN           RS User Added
     C                     Z-ADDWN0264    B1ABDT           RS Date Added
     C                     Z-ADDWN0265    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0012  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0013  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSI    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $EH1US           Head 1 USR
     C                     Z-ADD*ZERO     $EH2US           Head 2 USR
     C                     Z-ADD*ZERO     YL0009           Gross Pay Amt T
     C                     Z-ADD*ZERO     $EB5NB           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSJ01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSJ02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSJ03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSJ04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQSJ05           TH Kill Date
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           BOH Company Num
     C                     KFLD           WQSJ02           BOH Buy Order N
     C                     KFLD           WQSJ03           BOL Load Number
     C                     KFLD           WQSJ04           TH Tattoo Numbe
     C                     KFLD           WQSJ05           TH Kill Date
      * Setup key
     C                     Z-ADD$EHMNB    WQSJ01           BOH Company Num
     C                     Z-ADD$EBNNB    WQSJ02           BOH Buy Order N
     C                     Z-ADD$EBONB    WQSJ03           BOL Load Number
     C                     Z-ADD$ECVNB    WQSJ04           TH Tattoo Numbe
     C                     Z-ADD$EB0DT    WQSJ05           TH Kill Date
      * Establish starting position
     C           KRSSJ     SETLL@B1CPC3                    *
     C           KRSSJ     READE@B1CPC3                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Add
     C           WAINST    IFEQ 'A'                        *IF
     C                     ADD  1         $EH2US           Head 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $EH1US           Head 1 USR
     C                     END                             *FI
      * CASE: PAR.Payment Data Type USR is Paid Carcasses
     C           P3T5ST    IFEQ 'PC'                       *IF
      *
     C                     Z-ADD*ZERO     WN0266  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0267  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0268  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0269  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0270  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0271  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0272  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0273  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0274  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0275  72       CD Gross Value
     C                     MOVEL*BLANK    WN0276  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0277  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0278  31       CD FFLI
     C                     MOVEL*BLANK    WN0279  1        CD Record Creat
     C                     MOVEL*BLANK    WN0280  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0281  50       CD LOT
     C                     MOVEL*BLANK    WN0282  1        CD User Error O
     C                     Z-ADD*ZERO     WN0283  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0284  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0285  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0286  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0287  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0288  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0289  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0290  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0291  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0292  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0293  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0294  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0295  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0296  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0297  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0298  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0299  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0300  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0301  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0302  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0303  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0304  72       CD Gross Before
     C                     MOVEL*BLANK    WN0305  1        CD Broken Back
     C                     MOVEL*BLANK    WN0306  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0307  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0308  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0309  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0310 10        RS User Changed
     C                     Z-ADD*ZERO     WN0311  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0312  60       RS Time Changed
     C                     MOVEL*BLANK    WN0313  1        RS Record Statu
     C                     MOVEL*BLANK    WN0314 10        RS Job
     C                     MOVEL*BLANK    WN0315 10        RS Program
     C                     MOVEL*BLANK    WN0316 10        RS User Added
     C                     Z-ADD*ZERO     WN0317  70       RS Date Added
     C                     Z-ADD*ZERO     WN0318  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
     C                     ADD  1         $EB5NB           Head Total USR
      * Accumulate Top Paid Carcasses
      * CASE: PAR.Head Total USR LE PAR.TH Head Killed
     C           $EB5NB    IFLE $EFENB                     *IF
     C                     ADD  WAAYPR    YL0009           Gross Pay Amt T
     C                     END                             *FI
     C           KRSSJ     READE@B1CPC3                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWAHMNB    B1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    B1BONB           BOL Load Number
     C                     Z-ADDWACVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDWALGNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    B1EUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    B1LHNB           CD Carcass Numb
     C                     MOVELWAINST    B1INST           CD Record Add/D
     C                     Z-ADDWN0266    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0267    B1ASPC           CD STD Yield
     C                     Z-ADDWAEWNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0268    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0269    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0270    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0271    B1AVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0272    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0273    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0274    B1EZNB           CD Gross Value
     C                     Z-ADDWN0275    B1AYPR           CD Gross Value
     C                     Z-ADDWABBDT    B1BBDT           CD Kill Date
     C                     Z-ADDWAAKTM    B1AKTM           CD Kill Time
     C                     MOVELWAIQST    B1IQST           CD Shift
     C                     MOVELWN0276    B1EFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    B1H6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    B1GCST           CD Light Reflec
     C                     MOVELWAGDST    B1GDST           CD Trim Area
     C                     MOVELWN0277    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0278    B1BHPC           CD FFLI
     C                     MOVELWN0279    B1IOST           CD Record Creat
     C                     MOVELWN0280    B1IPST           CD Record Creat
     C                     Z-ADDWN0281    B1LTNB           CD LOT
     C                     MOVELWN0282    B1JNST           CD User Error O
     C                     Z-ADDWAX4NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    B1FOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    B1FPPC           CD Lean Percent
     C                     MOVELWAK2ST    B1K2ST           CD Source Type
     C                     MOVELWAK3ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0283    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0284    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0285    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0286    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0287    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0288    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0289    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0290    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0291    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0292    B1J4PR           CD CA Gross Val
     C                     MOVELWN0293    B1UTST           CD Adjust/Add T
     C                     MOVELWN0294    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0295    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0296    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0297    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0298    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0299    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0300    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0301    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0302    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0303    B1IUTR           CD Gross Before
     C                     Z-ADDWN0304    B1IJRR           CD Gross Before
     C                     MOVELWN0305    B1VCST           CD Broken Back
     C                     MOVELWN0306    B1VDST           CD Adjust/Add S
     C                     MOVELWN0307    B1VEST           CD Unused Sts 3
     C                     MOVELWN0308    B1VFST           CD Unused Sts 4
     C                     MOVELWN0309    B1VGST           CD Unused Sts 5
     C                     MOVELWAABCD    B1ABCD           PD Producer Cod
     C                     MOVELWAAACD    B1AACD           SR Source Code
     C                     MOVELWN0310    B1AAVN           RS User Changed
     C                     Z-ADDWN0311    B1AADT           RS Date Changed
     C                     Z-ADDWN0312    B1AMTM           RS Time Changed
     C                     MOVELWN0313    B1AJST           RS Record Statu
     C                     MOVELWN0314    B1AHVN           RS Job
     C                     MOVELWN0315    B1AGVN           RS Program
     C                     MOVELWN0316    B1ABVN           RS User Added
     C                     Z-ADDWN0317    B1ABDT           RS Date Added
     C                     Z-ADDWN0318    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0014  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0015  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSK    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     WUJANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJBNB           %Lean High Min
     C                     Z-ADD*ZERO     WUJLNB           %Lean High Max
     C                     Z-ADD*ZERO     WUJMNB           %Lean Low Min
     C                     Z-ADD*ZERO     WUJCNB           %Lean Low Max
     C                     Z-ADD*ZERO     WUJDNB           High Yield Min
     C                     Z-ADD*ZERO     WUJENB           High Yield Max
     C                     Z-ADD*ZERO     WUJFNB           Low Yield Min
     C                     Z-ADD*ZERO     WUJGNB           Low Yield Max
     C                     Z-ADD*ZERO     WUJHNB           Head < Percent
     C                     Z-ADD*ZERO     WUJINB           Head < Percent
     C                     Z-ADD*ZERO     WUJJNB           Head > Percent
     C                     Z-ADD*ZERO     WUJKNB           Head > Percent
     C                     Z-ADD*ZERO     WUK5NB           BackFat High Mi
     C                     Z-ADD*ZERO     WUK6NB           BackFat High Ma
     C                     Z-ADD*ZERO     WUK7NB           BackFat Low Min
     C                     Z-ADD*ZERO     WUK8NB           Backfat Low Max
     C                     Z-ADD*ZERO     WUK9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     WULANB           LoinEye High Ma
     C                     Z-ADD*ZERO     WULBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     WULCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    WUI7NB           Carcass Dbw Min
     C                     Z-ADDBOAGPC    WUI8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    WUI9NB           Carcass Lgt Min
     C                     Z-ADDBOAGPC    WUJANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    WUK5NB           BackFat High Mi
     C                     Z-ADDBOAGPC    WUK6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    WUK7NB           BackFat Low Min
     C                     Z-ADDBOAGPC    WUK8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    WUK9NB           LoinEye High Mi
     C                     Z-ADDBOAGPC    WULANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    WULBNB           LoinEye Low Min
     C                     Z-ADDBOAGPC    WULCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    WUJBNB           %Lean High Min
     C                     Z-ADDBOAGPC    WUJLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    WUJMNB           %Lean Low Min
     C                     Z-ADDBOAGPC    WUJCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    WUJHNB           Head < Percent
     C                     Z-ADDBOAGPC    WUJINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    WUJJNB           Head > Percent
     C                     Z-ADDBOAGPC    WUJKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    WUJDNB           High Yield Min
     C                     Z-ADDBOAGPC    WUJENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    WUJFNB           Low Yield Min
     C                     Z-ADDBOAGPC    WUJGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $ILFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $ILINB           Head 2
     C                     Z-ADD*ZERO     $IMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     YL0013           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     YL0014           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     YL0015           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0016           Hot Wgt/LghtR A
     C                     Z-ADD*ZERO     $IKGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     YL0017           Head No Probe U
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPHKST    WQSM01           EA Company Numb
     C           *LIKE     DEFN CPKHNB    WQSM02           EA Tattoo Numbe
     C           *LIKE     DEFN CPB7DT    WQSM03           EA Kill Date
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           EA Company Numb
     C                     KFLD           WQSM02           EA Tattoo Numbe
     C                     KFLD           WQSM03           EA Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSM01           EA Company Numb
     C                     Z-ADDWBCVNB    WQSM02           EA Tattoo Numbe
     C                     Z-ADDWBB0DT    WQSM03           EA Kill Date
      * Establish starting position
     C           KRSSM     SETLL@CPCPCI                    *
     C           KRSSM     READE@CPCPCI                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUD2ST           ET Error Sts
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UISUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.EA Hot Weight LE PAR.Carcass Lgt Max
     C           CPKJNB    IFLE WUJANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Hot Weight GE PAR.Carcass Dbw Min
     C           CPKJNB    IFGE WUI7NB                     *IF
     C                     MOVEL'CDB'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.EA Backfat Thickness Inch LE PAR.Backfat Low Max
     C           CPKKNB    IFLE WUK8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Backfat Thickness Inch GE PAR.BackFat High Min
     C           CPKKNB    IFGE WUK5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.EA Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           CPBQPC    IFLE WULCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           CPBQPC    IFGE WUK9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: WRK.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           WUAKPC    IFLE WUJCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: WRK.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           WUAKPC    IFGE WUJBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Trimmed Carcasses
      * CASE: DB1.EA Trim Area NE WRK.Blank USR
     C           CPHMST    IFNE WUCRTX                     *IF
     C                     ADD  1         $IMWNB           Trim Head 1 USR
     C                     END                             *FI
      * Valid/Exception Carcasses
      * CASE: WRK.ET Error Sts is Error
     C           WUD2ST    IFEQ 'E'                        *IF
      * Exception Carcasses
      * Positive FOM Reading
      * CASE: Hot Weight, Back Fat, Loin Eye > 0
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.EA Hot Weight is Not Zero
      *   |- c2    : DB1.EA Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.EA Loin-Eye Depth Inches is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CPKJNB    IFNE 0                          *IF
     C           CPKKNB    IFGT 0                          *IF
     C           CPBQPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         $ILINB           Head 2
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Excep
     C           WN0320    IFEQ 'UE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0325  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0326  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0327  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0328  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0329  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0330  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0331  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0332  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0333  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0334  72       CD Gross Value
     C                     MOVEL*BLANK    WN0335  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0336  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0337  31       CD FFLI
     C                     MOVEL*BLANK    WN0338  1        CD Record Creat
     C                     MOVEL*BLANK    WN0339  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0340  50       CD LOT
     C                     MOVEL*BLANK    WN0341  1        CD User Error O
     C                     Z-ADD*ZERO     WN0342  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0343  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0344  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0345  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0346  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0347  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0348  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0349  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0350  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0351  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0352  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0353  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0354  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0355  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0356  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0357  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0358  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0359  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0360  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0361  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0362  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0363  72       CD Gross Before
     C                     MOVEL*BLANK    WN0364  1        CD Broken Back
     C                     MOVEL*BLANK    WN0365  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0366  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0367  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0368  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0369 10        RS User Changed
     C                     Z-ADD*ZERO     WN0370  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0371  60       RS Time Changed
     C                     MOVEL*BLANK    WN0372  1        RS Record Statu
     C                     MOVEL*BLANK    WN0373 10        RS Job
     C                     MOVEL*BLANK    WN0374 10        RS Program
     C                     MOVEL*BLANK    WN0375 10        RS User Added
     C                     Z-ADD*ZERO     WN0376  70       RS Date Added
     C                     Z-ADD*ZERO     WN0377  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SNCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           WN0319    IFEQ 'UE'                       *IF
      * Accumulation
     C                     EXSR UJSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0017           Head No Probe U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Carcasses
     C                     ADD  1         $ILFNB           TDE Head Condem
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Valid
     C           WN0320    IFEQ 'UV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0378  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0379  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0380  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0381  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0382  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0383  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0384  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0385  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0386  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0387  72       CD Gross Value
     C                     MOVEL*BLANK    WN0388  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0389  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0390  31       CD FFLI
     C                     MOVEL*BLANK    WN0391  1        CD Record Creat
     C                     MOVEL*BLANK    WN0392  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0393  50       CD LOT
     C                     MOVEL*BLANK    WN0394  1        CD User Error O
     C                     Z-ADD*ZERO     WN0395  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0396  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0397  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0398  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0399  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0400  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0401  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0402  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0403  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0404  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0405  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0406  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0407  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0408  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0409  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0410  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0411  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0412  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0413  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0414  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0415  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0416  72       CD Gross Before
     C                     MOVEL*BLANK    WN0417  1        CD Broken Back
     C                     MOVEL*BLANK    WN0418  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0419  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0420  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0421  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0422 10        RS User Changed
     C                     Z-ADD*ZERO     WN0423  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0424  60       RS Time Changed
     C                     MOVEL*BLANK    WN0425  1        RS Record Statu
     C                     MOVEL*BLANK    WN0426 10        RS Job
     C                     MOVEL*BLANK    WN0427 10        RS Program
     C                     MOVEL*BLANK    WN0428 10        RS User Added
     C                     Z-ADD*ZERO     WN0429  70       RS Date Added
     C                     Z-ADD*ZERO     WN0430  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SOCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           WN0319    IFEQ 'UV'                       *IF
      * Accumulation
     C                     EXSR UKSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@CPCPCI                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$IHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$IBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$IBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ICVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0325    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0326    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0327    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0328    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0329    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0330    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0331    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0332    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0333    B1EZNB           CD Gross Value
     C                     Z-ADDWN0334    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0335    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0336    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0337    B1BHPC           CD FFLI
     C                     MOVELWN0338    B1IOST           CD Record Creat
     C                     MOVELWN0339    B1IPST           CD Record Creat
     C                     Z-ADDWN0340    B1LTNB           CD LOT
     C                     MOVELWN0341    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$IKAST    B1K2ST           CD Source Type
     C                     MOVEL$IJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0342    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0343    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0344    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0345    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0346    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0347    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0348    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0349    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0350    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0351    B1J4PR           CD CA Gross Val
     C                     MOVELWN0352    B1UTST           CD Adjust/Add T
     C                     MOVELWN0353    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0354    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0355    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0356    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0357    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0358    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0359    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0360    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0361    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0362    B1IUTR           CD Gross Before
     C                     Z-ADDWN0363    B1IJRR           CD Gross Before
     C                     MOVELWN0364    B1VCST           CD Broken Back
     C                     MOVELWN0365    B1VDST           CD Adjust/Add S
     C                     MOVELWN0366    B1VEST           CD Unused Sts 3
     C                     MOVELWN0367    B1VFST           CD Unused Sts 4
     C                     MOVELWN0368    B1VGST           CD Unused Sts 5
     C                     MOVEL$IABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ILKST    B1AACD           SR Source Code
     C                     MOVELWN0369    B1AAVN           RS User Changed
     C                     Z-ADDWN0370    B1AADT           RS Date Changed
     C                     Z-ADDWN0371    B1AMTM           RS Time Changed
     C                     MOVELWN0372    B1AJST           RS Record Statu
     C                     MOVELWN0373    B1AHVN           RS Job
     C                     MOVELWN0374    B1AGVN           RS Program
     C                     MOVELWN0375    B1ABVN           RS User Added
     C                     Z-ADDWN0376    B1ABDT           RS Date Added
     C                     Z-ADDWN0377    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0016  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0017  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSN    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSN    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$IHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$IBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$IBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ICVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0378    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0379    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0380    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0381    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0382    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0383    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0384    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0385    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0386    B1EZNB           CD Gross Value
     C                     Z-ADDWN0387    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0388    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0389    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0390    B1BHPC           CD FFLI
     C                     MOVELWN0391    B1IOST           CD Record Creat
     C                     MOVELWN0392    B1IPST           CD Record Creat
     C                     Z-ADDWN0393    B1LTNB           CD LOT
     C                     MOVELWN0394    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$IKAST    B1K2ST           CD Source Type
     C                     MOVEL$IJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0395    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0396    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0397    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0398    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0399    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0400    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0401    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0402    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0403    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0404    B1J4PR           CD CA Gross Val
     C                     MOVELWN0405    B1UTST           CD Adjust/Add T
     C                     MOVELWN0406    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0407    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0408    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0409    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0410    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0411    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0412    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0413    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0414    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0415    B1IUTR           CD Gross Before
     C                     Z-ADDWN0416    B1IJRR           CD Gross Before
     C                     MOVELWN0417    B1VCST           CD Broken Back
     C                     MOVELWN0418    B1VDST           CD Adjust/Add S
     C                     MOVELWN0419    B1VEST           CD Unused Sts 3
     C                     MOVELWN0420    B1VFST           CD Unused Sts 4
     C                     MOVELWN0421    B1VGST           CD Unused Sts 5
     C                     MOVEL$IABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ILKST    B1AACD           SR Source Code
     C                     MOVELWN0422    B1AAVN           RS User Changed
     C                     Z-ADDWN0423    B1AADT           RS Date Changed
     C                     Z-ADDWN0424    B1AMTM           RS Time Changed
     C                     MOVELWN0425    B1AJST           RS Record Statu
     C                     MOVELWN0426    B1AHVN           RS Job
     C                     MOVELWN0427    B1AGVN           RS Program
     C                     MOVELWN0428    B1ABVN           RS User Added
     C                     Z-ADDWN0429    B1ABDT           RS Date Added
     C                     Z-ADDWN0430    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0018  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0019  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSO    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQSP03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQSP04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQSP05           TH Kill Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
     C                     KFLD           WQSP04           TH Tattoo Numbe
     C                     KFLD           WQSP05           TH Kill Date
      * Setup key
     C                     Z-ADD$IHMNB    WQSP01           BOH Company Num
     C                     Z-ADD$IBNNB    WQSP02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQSP03           BOL Load Number
     C                     Z-ADD$ICVNB    WQSP04           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    WQSP05           TH Kill Date
      * Establish starting position
     C           KRSSP     SETLL@BVCPQ9                    *
     C           KRSSP     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Average Adds
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
     C                     ADD  1         WULKIR           Head 6
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           BVAJST    IFEQ 'A'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
      * Added Carcasses
     C                     ADD  1         $IHD3C           Head 3
      * CASE: PAR.Payment Data Type USR is Eval Trans Adds
     C           WN0320    IFEQ 'EA'                       *IF
      *
     C                     Z-ADD*ZERO     WN0431  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0432  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0433  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0434  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0435  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0436  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0437  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0438  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0439  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0440  72       CD Gross Value
     C                     MOVEL*BLANK    WN0441  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0442  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0443  31       CD FFLI
     C                     MOVEL*BLANK    WN0444  1        CD Record Creat
     C                     MOVEL*BLANK    WN0445  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0446  50       CD LOT
     C                     MOVEL*BLANK    WN0447  1        CD User Error O
     C                     Z-ADD*ZERO     WN0448  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0449  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0450  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0451  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0452  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0453  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0454  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0455  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0456  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0457  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0458  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0459  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0460  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0461  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0462  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0463  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0464  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0465  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0466  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0467  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0468  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0469  72       CD Gross Before
     C                     MOVEL*BLANK    WN0470  1        CD Broken Back
     C                     MOVEL*BLANK    WN0471  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0472  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0473  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0474  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0475 10        RS User Changed
     C                     Z-ADD*ZERO     WN0476  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0477  60       RS Time Changed
     C                     MOVEL*BLANK    WN0478  1        RS Record Statu
     C                     MOVEL*BLANK    WN0479 10        RS Job
     C                     MOVEL*BLANK    WN0480 10        RS Program
     C                     MOVEL*BLANK    WN0481 10        RS User Added
     C                     Z-ADD*ZERO     WN0482  70       RS Date Added
     C                     Z-ADD*ZERO     WN0483  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SQCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           WN0319    IFEQ 'EA'                       *IF
      * Accumulation
     C                     EXSR ULSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.ET Record Add/Del Sts is Delete
     C           BVEHST    IFEQ 'D'                        *IF
      * Flagged for Delete
     C                     ADD  1         $IHD4C           Head 4
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Deleted/Inactive
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Not Original Record
     C           BVEHST    IFEQ 'A'                        *IF
     C           BVEHST    OREQ *BLANK
     C           BVEHST    OREQ 'D'
      * CASE: DB1.ET Error Sts is Balance
     C           BVD2ST    IFEQ 'B'                        *IF
      * Valid Deleted
     C                     ADD  1         $IHD4C           Head 4
      * CASE: PAR.Payment Data Type USR is Eval Trans Valid Deletes
     C           WN0320    IFEQ 'EV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0484  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0485  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0486  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0487  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0488  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0489  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0490  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0491  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0492  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0493  72       CD Gross Value
     C                     MOVEL*BLANK    WN0494  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0495  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0496  31       CD FFLI
     C                     MOVEL*BLANK    WN0497  1        CD Record Creat
     C                     MOVEL*BLANK    WN0498  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0499  50       CD LOT
     C                     MOVEL*BLANK    WN0500  1        CD User Error O
     C                     Z-ADD*ZERO     WN0501  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0502  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0503  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0504  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0505  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0506  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0507  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0508  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0509  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0510  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0511  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0512  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0513  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0514  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0515  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0516  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0517  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0518  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0519  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0520  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0521  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0522  72       CD Gross Before
     C                     MOVEL*BLANK    WN0523  1        CD Broken Back
     C                     MOVEL*BLANK    WN0524  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0525  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0526  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0527  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0528 10        RS User Changed
     C                     Z-ADD*ZERO     WN0529  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0530  60       RS Time Changed
     C                     MOVEL*BLANK    WN0531  1        RS Record Statu
     C                     MOVEL*BLANK    WN0532 10        RS Job
     C                     MOVEL*BLANK    WN0533 10        RS Program
     C                     MOVEL*BLANK    WN0534 10        RS User Added
     C                     Z-ADD*ZERO     WN0535  70       RS Date Added
     C                     Z-ADD*ZERO     WN0536  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SRCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Valid Deletes
     C           WN0319    IFEQ 'EV'                       *IF
      * Accumulation
     C                     EXSR UMSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Exceptions Deleted
     C                     ADD  1         $IHD5C           Head 5
      * Positive FOM Reading
      * CASE: Hot Wgt, Backfat, Loin Eye, Lean% > 0
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.ET Hot Wgt is Not Zero
      *   |- c2    : DB1.ET Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.ET Loin-Eye Depth Inches is GT Zero
      *   |- c4    : DB1.ET Lean Percent NPPC is Greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BVAMPC    IFNE 0                          *IF
     C           BVAIPC    IFGT 0                          *IF
     C           BVAJPC    IFGT 0                          *IF
     C           BVAKPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Payment Data Type USR is Eval Trans Excep Deletes
     C           WN0320    IFEQ 'EE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0537  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0538  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0539  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0540  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0541  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0542  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0543  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0544  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0545  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0546  72       CD Gross Value
     C                     MOVEL*BLANK    WN0547  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0548  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0549  31       CD FFLI
     C                     MOVEL*BLANK    WN0550  1        CD Record Creat
     C                     MOVEL*BLANK    WN0551  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0552  50       CD LOT
     C                     MOVEL*BLANK    WN0553  1        CD User Error O
     C                     Z-ADD*ZERO     WN0554  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0555  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0556  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0557  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0558  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0559  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0560  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0561  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0562  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0563  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0564  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0565  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0566  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0567  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0568  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0569  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0570  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0571  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0572  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0573  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0574  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0575  72       CD Gross Before
     C                     MOVEL*BLANK    WN0576  1        CD Broken Back
     C                     MOVEL*BLANK    WN0577  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0578  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0579  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0580  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0581 10        RS User Changed
     C                     Z-ADD*ZERO     WN0582  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0583  60       RS Time Changed
     C                     MOVEL*BLANK    WN0584  1        RS Record Statu
     C                     MOVEL*BLANK    WN0585 10        RS Job
     C                     MOVEL*BLANK    WN0586 10        RS Program
     C                     MOVEL*BLANK    WN0587 10        RS User Added
     C                     Z-ADD*ZERO     WN0588  70       RS Date Added
     C                     Z-ADD*ZERO     WN0589  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SSCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Excep Deletes
     C           WN0319    IFEQ 'EE'                       *IF
      * Accumulation
     C                     EXSR UNSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$IHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$IBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$IBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ICVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0431    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0432    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0433    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0434    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0435    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0436    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0437    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0438    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0439    B1EZNB           CD Gross Value
     C                     Z-ADDWN0440    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0441    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0442    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0443    B1BHPC           CD FFLI
     C                     MOVELWN0444    B1IOST           CD Record Creat
     C                     MOVELWN0445    B1IPST           CD Record Creat
     C                     Z-ADDWN0446    B1LTNB           CD LOT
     C                     MOVELWN0447    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$IKAST    B1K2ST           CD Source Type
     C                     MOVEL$IJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0448    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0449    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0450    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0451    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0452    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0453    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0454    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0455    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0456    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0457    B1J4PR           CD CA Gross Val
     C                     MOVELWN0458    B1UTST           CD Adjust/Add T
     C                     MOVELWN0459    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0460    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0461    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0462    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0463    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0464    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0465    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0466    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0467    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0468    B1IUTR           CD Gross Before
     C                     Z-ADDWN0469    B1IJRR           CD Gross Before
     C                     MOVELWN0470    B1VCST           CD Broken Back
     C                     MOVELWN0471    B1VDST           CD Adjust/Add S
     C                     MOVELWN0472    B1VEST           CD Unused Sts 3
     C                     MOVELWN0473    B1VFST           CD Unused Sts 4
     C                     MOVELWN0474    B1VGST           CD Unused Sts 5
     C                     MOVEL$IABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ILKST    B1AACD           SR Source Code
     C                     MOVELWN0475    B1AAVN           RS User Changed
     C                     Z-ADDWN0476    B1AADT           RS Date Changed
     C                     Z-ADDWN0477    B1AMTM           RS Time Changed
     C                     MOVELWN0478    B1AJST           RS Record Statu
     C                     MOVELWN0479    B1AHVN           RS Job
     C                     MOVELWN0480    B1AGVN           RS Program
     C                     MOVELWN0481    B1ABVN           RS User Added
     C                     Z-ADDWN0482    B1ABDT           RS Date Added
     C                     Z-ADDWN0483    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0020  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0021  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$IHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$IBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$IBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ICVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0484    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0485    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0486    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0487    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0488    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0489    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0490    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0491    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0492    B1EZNB           CD Gross Value
     C                     Z-ADDWN0493    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0494    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0495    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0496    B1BHPC           CD FFLI
     C                     MOVELWN0497    B1IOST           CD Record Creat
     C                     MOVELWN0498    B1IPST           CD Record Creat
     C                     Z-ADDWN0499    B1LTNB           CD LOT
     C                     MOVELWN0500    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$IKAST    B1K2ST           CD Source Type
     C                     MOVEL$IJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0501    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0502    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0503    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0504    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0505    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0506    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0507    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0508    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0509    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0510    B1J4PR           CD CA Gross Val
     C                     MOVELWN0511    B1UTST           CD Adjust/Add T
     C                     MOVELWN0512    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0513    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0514    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0515    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0516    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0517    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0518    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0519    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0520    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0521    B1IUTR           CD Gross Before
     C                     Z-ADDWN0522    B1IJRR           CD Gross Before
     C                     MOVELWN0523    B1VCST           CD Broken Back
     C                     MOVELWN0524    B1VDST           CD Adjust/Add S
     C                     MOVELWN0525    B1VEST           CD Unused Sts 3
     C                     MOVELWN0526    B1VFST           CD Unused Sts 4
     C                     MOVELWN0527    B1VGST           CD Unused Sts 5
     C                     MOVEL$IABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ILKST    B1AACD           SR Source Code
     C                     MOVELWN0528    B1AAVN           RS User Changed
     C                     Z-ADDWN0529    B1AADT           RS Date Changed
     C                     Z-ADDWN0530    B1AMTM           RS Time Changed
     C                     MOVELWN0531    B1AJST           RS Record Statu
     C                     MOVELWN0532    B1AHVN           RS Job
     C                     MOVELWN0533    B1AGVN           RS Program
     C                     MOVELWN0534    B1ABVN           RS User Added
     C                     Z-ADDWN0535    B1ABDT           RS Date Added
     C                     Z-ADDWN0536    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0022  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0023  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSR    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSR    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$IHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$IBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$IBONB    B1BONB           BOL Load Number
     C                     Z-ADD$ICVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0537    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0538    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0539    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0540    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0541    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0542    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0543    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0544    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0545    B1EZNB           CD Gross Value
     C                     Z-ADDWN0546    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0547    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0548    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0549    B1BHPC           CD FFLI
     C                     MOVELWN0550    B1IOST           CD Record Creat
     C                     MOVELWN0551    B1IPST           CD Record Creat
     C                     Z-ADDWN0552    B1LTNB           CD LOT
     C                     MOVELWN0553    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$IKAST    B1K2ST           CD Source Type
     C                     MOVEL$IJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0554    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0555    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0556    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0557    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0558    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0559    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0560    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0561    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0562    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0563    B1J4PR           CD CA Gross Val
     C                     MOVELWN0564    B1UTST           CD Adjust/Add T
     C                     MOVELWN0565    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0566    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0567    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0568    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0569    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0570    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0571    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0572    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0573    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0574    B1IUTR           CD Gross Before
     C                     Z-ADDWN0575    B1IJRR           CD Gross Before
     C                     MOVELWN0576    B1VCST           CD Broken Back
     C                     MOVELWN0577    B1VDST           CD Adjust/Add S
     C                     MOVELWN0578    B1VEST           CD Unused Sts 3
     C                     MOVELWN0579    B1VFST           CD Unused Sts 4
     C                     MOVELWN0580    B1VGST           CD Unused Sts 5
     C                     MOVEL$IABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$ILKST    B1AACD           SR Source Code
     C                     MOVELWN0581    B1AAVN           RS User Changed
     C                     Z-ADDWN0582    B1AADT           RS Date Changed
     C                     Z-ADDWN0583    B1AMTM           RS Time Changed
     C                     MOVELWN0584    B1AJST           RS Record Statu
     C                     MOVELWN0585    B1AHVN           RS Job
     C                     MOVELWN0586    B1AGVN           RS Program
     C                     MOVELWN0587    B1ABVN           RS User Added
     C                     Z-ADDWN0588    B1ABDT           RS Date Added
     C                     Z-ADDWN0589    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0024  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0025  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSS    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $IH1US           Head 1 USR
     C                     Z-ADD*ZERO     $IH2US           Head 2 USR
     C                     Z-ADD*ZERO     YL0018           Gross Pay Amt T
     C                     Z-ADD*ZERO     $IB5NB           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQST03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQST04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQST05           TH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           TH Tattoo Numbe
     C                     KFLD           WQST05           TH Kill Date
      * Setup key
     C                     Z-ADD$IHMNB    WQST01           BOH Company Num
     C                     Z-ADD$IBNNB    WQST02           BOH Buy Order N
     C                     Z-ADD$IBONB    WQST03           BOL Load Number
     C                     Z-ADD$ICVNB    WQST04           TH Tattoo Numbe
     C                     Z-ADD$IB0DT    WQST05           TH Kill Date
      * Establish starting position
     C           KRSST     SETLL@B1CPC3                    *
     C           KRSST     READE@B1CPC3                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Add
     C           WAINST    IFEQ 'A'                        *IF
     C                     ADD  1         $IH2US           Head 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $IH1US           Head 1 USR
     C                     END                             *FI
      * CASE: PAR.Payment Data Type USR is Paid Carcasses
     C           WN0320    IFEQ 'PC'                       *IF
      *
     C                     Z-ADD*ZERO     WN0590  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0591  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0592  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0593  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0594  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0595  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0596  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0597  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0598  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0599  72       CD Gross Value
     C                     MOVEL*BLANK    WN0600  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0601  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0602  31       CD FFLI
     C                     MOVEL*BLANK    WN0603  1        CD Record Creat
     C                     MOVEL*BLANK    WN0604  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0605  50       CD LOT
     C                     MOVEL*BLANK    WN0606  1        CD User Error O
     C                     Z-ADD*ZERO     WN0607  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0608  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0609  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0610  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0611  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0612  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0613  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0614  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0615  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0616  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0617  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0618  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0619  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0620  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0621  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0622  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0623  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0624  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0625  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0626  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0627  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0628  72       CD Gross Before
     C                     MOVEL*BLANK    WN0629  1        CD Broken Back
     C                     MOVEL*BLANK    WN0630  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0631  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0632  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0633  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0634 10        RS User Changed
     C                     Z-ADD*ZERO     WN0635  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0636  60       RS Time Changed
     C                     MOVEL*BLANK    WN0637  1        RS Record Statu
     C                     MOVEL*BLANK    WN0638 10        RS Job
     C                     MOVEL*BLANK    WN0639 10        RS Program
     C                     MOVEL*BLANK    WN0640 10        RS User Added
     C                     Z-ADD*ZERO     WN0641  70       RS Date Added
     C                     Z-ADD*ZERO     WN0642  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SUCRRC
     C                     END                             *FI
     C                     ADD  1         $IB5NB           Head Total USR
      * Accumulate Top Paid Carcasses
      * CASE: PAR.Head Total USR LE PAR.TH Head Killed
     C           $IB5NB    IFLE $IFENB                     *IF
     C                     ADD  WAAYPR    YL0018           Gross Pay Amt T
     C                     END                             *FI
     C           KRSST     READE@B1CPC3                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWAHMNB    B1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    B1BONB           BOL Load Number
     C                     Z-ADDWACVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDWALGNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    B1EUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    B1LHNB           CD Carcass Numb
     C                     MOVELWAINST    B1INST           CD Record Add/D
     C                     Z-ADDWN0590    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0591    B1ASPC           CD STD Yield
     C                     Z-ADDWAEWNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0592    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0593    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0594    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0595    B1AVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0596    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0597    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0598    B1EZNB           CD Gross Value
     C                     Z-ADDWN0599    B1AYPR           CD Gross Value
     C                     Z-ADDWABBDT    B1BBDT           CD Kill Date
     C                     Z-ADDWAAKTM    B1AKTM           CD Kill Time
     C                     MOVELWAIQST    B1IQST           CD Shift
     C                     MOVELWN0600    B1EFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    B1H6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    B1GCST           CD Light Reflec
     C                     MOVELWAGDST    B1GDST           CD Trim Area
     C                     MOVELWN0601    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0602    B1BHPC           CD FFLI
     C                     MOVELWN0603    B1IOST           CD Record Creat
     C                     MOVELWN0604    B1IPST           CD Record Creat
     C                     Z-ADDWN0605    B1LTNB           CD LOT
     C                     MOVELWN0606    B1JNST           CD User Error O
     C                     Z-ADDWAX4NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    B1FOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    B1FPPC           CD Lean Percent
     C                     MOVELWAK2ST    B1K2ST           CD Source Type
     C                     MOVELWAK3ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0607    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0608    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0609    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0610    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0611    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0612    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0613    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0614    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0615    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0616    B1J4PR           CD CA Gross Val
     C                     MOVELWN0617    B1UTST           CD Adjust/Add T
     C                     MOVELWN0618    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0619    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0620    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0621    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0622    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0623    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0624    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0625    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0626    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0627    B1IUTR           CD Gross Before
     C                     Z-ADDWN0628    B1IJRR           CD Gross Before
     C                     MOVELWN0629    B1VCST           CD Broken Back
     C                     MOVELWN0630    B1VDST           CD Adjust/Add S
     C                     MOVELWN0631    B1VEST           CD Unused Sts 3
     C                     MOVELWN0632    B1VFST           CD Unused Sts 4
     C                     MOVELWN0633    B1VGST           CD Unused Sts 5
     C                     MOVELWAABCD    B1ABCD           PD Producer Cod
     C                     MOVELWAAACD    B1AACD           SR Source Code
     C                     MOVELWN0634    B1AAVN           RS User Changed
     C                     Z-ADDWN0635    B1AADT           RS Date Changed
     C                     Z-ADDWN0636    B1AMTM           RS Time Changed
     C                     MOVELWN0637    B1AJST           RS Record Statu
     C                     MOVELWN0638    B1AHVN           RS Job
     C                     MOVELWN0639    B1AGVN           RS Program
     C                     MOVELWN0640    B1ABVN           RS User Added
     C                     Z-ADDWN0641    B1ABDT           RS Date Added
     C                     Z-ADDWN0642    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0026  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0027  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSU    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSU    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create FOM Summary OUTF - FOM Summary OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EVCPDU
     C                     MOVEL$LABCD    EVABCD           PD Producer Cod
     C                     Z-ADD$LB0DT    EVB0DT           TH Kill Date
     C                     Z-ADD$LB4NB    EVVLCR           HS Valid Carcs
     C                     Z-ADD$LXRNB    EVEXCR           HS Excep Carcs
     C                     Z-ADD$LH5SM    EVHDTC           HS Total Carcs
     C                     Z-ADD$LHTS3    EVVARC           HS Variance
     C                     Z-ADD$LWUNB    EVFENB           TH Head Killed
      *
     C           KLCRSV    KLIST
     C                     KFLD           EVABCD           PD Producer Cod
     C                     KFLD           EVB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRSV    SETLL@EVCPDU                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0908' W0RTN   7
      * Send message 'FOM Summary OUTF       EX'
     C                     MOVEL'PRK0908' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@EVCPDU                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     WUJANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJBNB           %Lean High Min
     C                     Z-ADD*ZERO     WUJLNB           %Lean High Max
     C                     Z-ADD*ZERO     WUJMNB           %Lean Low Min
     C                     Z-ADD*ZERO     WUJCNB           %Lean Low Max
     C                     Z-ADD*ZERO     WUJDNB           High Yield Min
     C                     Z-ADD*ZERO     WUJENB           High Yield Max
     C                     Z-ADD*ZERO     WUJFNB           Low Yield Min
     C                     Z-ADD*ZERO     WUJGNB           Low Yield Max
     C                     Z-ADD*ZERO     WUJHNB           Head < Percent
     C                     Z-ADD*ZERO     WUJINB           Head < Percent
     C                     Z-ADD*ZERO     WUJJNB           Head > Percent
     C                     Z-ADD*ZERO     WUJKNB           Head > Percent
     C                     Z-ADD*ZERO     WUK5NB           BackFat High Mi
     C                     Z-ADD*ZERO     WUK6NB           BackFat High Ma
     C                     Z-ADD*ZERO     WUK7NB           BackFat Low Min
     C                     Z-ADD*ZERO     WUK8NB           Backfat Low Max
     C                     Z-ADD*ZERO     WUK9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     WULANB           LoinEye High Ma
     C                     Z-ADD*ZERO     WULBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     WULCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    WUI7NB           Carcass Dbw Min
     C                     Z-ADDBOAGPC    WUI8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    WUI9NB           Carcass Lgt Min
     C                     Z-ADDBOAGPC    WUJANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    WUK5NB           BackFat High Mi
     C                     Z-ADDBOAGPC    WUK6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    WUK7NB           BackFat Low Min
     C                     Z-ADDBOAGPC    WUK8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    WUK9NB           LoinEye High Mi
     C                     Z-ADDBOAGPC    WULANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    WULBNB           LoinEye Low Min
     C                     Z-ADDBOAGPC    WULCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    WUJBNB           %Lean High Min
     C                     Z-ADDBOAGPC    WUJLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    WUJMNB           %Lean Low Min
     C                     Z-ADDBOAGPC    WUJCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    WUJHNB           Head < Percent
     C                     Z-ADDBOAGPC    WUJINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    WUJJNB           Head > Percent
     C                     Z-ADDBOAGPC    WUJKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    WUJDNB           High Yield Min
     C                     Z-ADDBOAGPC    WUJENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    WUJFNB           Low Yield Min
     C                     Z-ADDBOAGPC    WUJGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $NLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $NLINB           Head 2
     C                     Z-ADD*ZERO     $NMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     YL0013           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     YL0014           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     YL0015           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0016           Hot Wgt/LghtR A
     C                     Z-ADD*ZERO     $NKGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     YL0017           Head No Probe U
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPHKST    WQSX01           EA Company Numb
     C           *LIKE     DEFN CPKHNB    WQSX02           EA Tattoo Numbe
     C           *LIKE     DEFN CPB7DT    WQSX03           EA Kill Date
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           EA Company Numb
     C                     KFLD           WQSX02           EA Tattoo Numbe
     C                     KFLD           WQSX03           EA Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSX01           EA Company Numb
     C                     Z-ADDWBCVNB    WQSX02           EA Tattoo Numbe
     C                     Z-ADDWBB0DT    WQSX03           EA Kill Date
      * Establish starting position
     C           KRSSX     SETLL@CPCPCI                    *
     C           KRSSX     READE@CPCPCI                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUD2ST           ET Error Sts
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UPSUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.EA Hot Weight LE PAR.Carcass Lgt Max
     C           CPKJNB    IFLE WUJANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Hot Weight GE PAR.Carcass Dbw Min
     C           CPKJNB    IFGE WUI7NB                     *IF
     C                     MOVEL'CDB'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.EA Backfat Thickness Inch LE PAR.Backfat Low Max
     C           CPKKNB    IFLE WUK8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Backfat Thickness Inch GE PAR.BackFat High Min
     C           CPKKNB    IFGE WUK5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.EA Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           CPBQPC    IFLE WULCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           CPBQPC    IFGE WUK9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: WRK.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           WUAKPC    IFLE WUJCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: WRK.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           WUAKPC    IFGE WUJBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Trimmed Carcasses
      * CASE: DB1.EA Trim Area NE WRK.Blank USR
     C           CPHMST    IFNE WUCRTX                     *IF
     C                     ADD  1         $NMWNB           Trim Head 1 USR
     C                     END                             *FI
      * Valid/Exception Carcasses
      * CASE: WRK.ET Error Sts is Error
     C           WUD2ST    IFEQ 'E'                        *IF
      * Exception Carcasses
      * Positive FOM Reading
      * CASE: Hot Weight, Back Fat, Loin Eye > 0
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.EA Hot Weight is Not Zero
      *   |- c2    : DB1.EA Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.EA Loin-Eye Depth Inches is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CPKJNB    IFNE 0                          *IF
     C           CPKKNB    IFGT 0                          *IF
     C           CPBQPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         $NLINB           Head 2
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Excep
     C           WN0644    IFEQ 'UE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0649  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0650  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0651  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0652  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0653  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0654  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0655  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0656  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0657  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0658  72       CD Gross Value
     C                     MOVEL*BLANK    WN0659  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0660  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0661  31       CD FFLI
     C                     MOVEL*BLANK    WN0662  1        CD Record Creat
     C                     MOVEL*BLANK    WN0663  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0664  50       CD LOT
     C                     MOVEL*BLANK    WN0665  1        CD User Error O
     C                     Z-ADD*ZERO     WN0666  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0667  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0668  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0669  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0670  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0671  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0672  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0673  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0674  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0675  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0676  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0677  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0678  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0679  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0680  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0681  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0682  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0683  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0684  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0685  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0686  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0687  72       CD Gross Before
     C                     MOVEL*BLANK    WN0688  1        CD Broken Back
     C                     MOVEL*BLANK    WN0689  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0690  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0691  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0692  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0693 10        RS User Changed
     C                     Z-ADD*ZERO     WN0694  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0695  60       RS Time Changed
     C                     MOVEL*BLANK    WN0696  1        RS Record Statu
     C                     MOVEL*BLANK    WN0697 10        RS Job
     C                     MOVEL*BLANK    WN0698 10        RS Program
     C                     MOVEL*BLANK    WN0699 10        RS User Added
     C                     Z-ADD*ZERO     WN0700  70       RS Date Added
     C                     Z-ADD*ZERO     WN0701  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SYCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           WN0643    IFEQ 'UE'                       *IF
      * Accumulation
     C                     EXSR UQSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0017           Head No Probe U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Carcasses
     C                     ADD  1         $NLFNB           TDE Head Condem
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Valid
     C           WN0644    IFEQ 'UV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0702  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0703  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0704  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0705  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0706  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0707  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0708  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0709  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0710  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0711  72       CD Gross Value
     C                     MOVEL*BLANK    WN0712  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0713  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0714  31       CD FFLI
     C                     MOVEL*BLANK    WN0715  1        CD Record Creat
     C                     MOVEL*BLANK    WN0716  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0717  50       CD LOT
     C                     MOVEL*BLANK    WN0718  1        CD User Error O
     C                     Z-ADD*ZERO     WN0719  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0720  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0721  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0722  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0723  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0724  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0725  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0726  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0727  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0728  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0729  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0730  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0731  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0732  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0733  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0734  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0735  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0736  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0737  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0738  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0739  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0740  72       CD Gross Before
     C                     MOVEL*BLANK    WN0741  1        CD Broken Back
     C                     MOVEL*BLANK    WN0742  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0743  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0744  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0745  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0746 10        RS User Changed
     C                     Z-ADD*ZERO     WN0747  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0748  60       RS Time Changed
     C                     MOVEL*BLANK    WN0749  1        RS Record Statu
     C                     MOVEL*BLANK    WN0750 10        RS Job
     C                     MOVEL*BLANK    WN0751 10        RS Program
     C                     MOVEL*BLANK    WN0752 10        RS User Added
     C                     Z-ADD*ZERO     WN0753  70       RS Date Added
     C                     Z-ADD*ZERO     WN0754  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR SZCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           WN0643    IFEQ 'UV'                       *IF
      * Accumulation
     C                     EXSR URSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSX     READE@CPCPCI                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$NHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$NBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$NBONB    B1BONB           BOL Load Number
     C                     Z-ADD$NCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0649    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0650    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0651    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0652    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0653    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0654    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0655    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0656    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0657    B1EZNB           CD Gross Value
     C                     Z-ADDWN0658    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0659    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0660    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0661    B1BHPC           CD FFLI
     C                     MOVELWN0662    B1IOST           CD Record Creat
     C                     MOVELWN0663    B1IPST           CD Record Creat
     C                     Z-ADDWN0664    B1LTNB           CD LOT
     C                     MOVELWN0665    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$NKAST    B1K2ST           CD Source Type
     C                     MOVEL$NJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0666    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0667    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0668    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0669    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0670    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0671    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0672    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0673    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0674    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0675    B1J4PR           CD CA Gross Val
     C                     MOVELWN0676    B1UTST           CD Adjust/Add T
     C                     MOVELWN0677    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0678    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0679    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0680    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0681    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0682    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0683    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0684    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0685    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0686    B1IUTR           CD Gross Before
     C                     Z-ADDWN0687    B1IJRR           CD Gross Before
     C                     MOVELWN0688    B1VCST           CD Broken Back
     C                     MOVELWN0689    B1VDST           CD Adjust/Add S
     C                     MOVELWN0690    B1VEST           CD Unused Sts 3
     C                     MOVELWN0691    B1VFST           CD Unused Sts 4
     C                     MOVELWN0692    B1VGST           CD Unused Sts 5
     C                     MOVEL$NABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$NLKST    B1AACD           SR Source Code
     C                     MOVELWN0693    B1AAVN           RS User Changed
     C                     Z-ADDWN0694    B1AADT           RS Date Changed
     C                     Z-ADDWN0695    B1AMTM           RS Time Changed
     C                     MOVELWN0696    B1AJST           RS Record Statu
     C                     MOVELWN0697    B1AHVN           RS Job
     C                     MOVELWN0698    B1AGVN           RS Program
     C                     MOVELWN0699    B1ABVN           RS User Added
     C                     Z-ADDWN0700    B1ABDT           RS Date Added
     C                     Z-ADDWN0701    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0028  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0029  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSY    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSY    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$NHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$NBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$NBONB    B1BONB           BOL Load Number
     C                     Z-ADD$NCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0702    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0703    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0704    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0705    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0706    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0707    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0708    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0709    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0710    B1EZNB           CD Gross Value
     C                     Z-ADDWN0711    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0712    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0713    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0714    B1BHPC           CD FFLI
     C                     MOVELWN0715    B1IOST           CD Record Creat
     C                     MOVELWN0716    B1IPST           CD Record Creat
     C                     Z-ADDWN0717    B1LTNB           CD LOT
     C                     MOVELWN0718    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$NKAST    B1K2ST           CD Source Type
     C                     MOVEL$NJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0719    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0720    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0721    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0722    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0723    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0724    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0725    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0726    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0727    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0728    B1J4PR           CD CA Gross Val
     C                     MOVELWN0729    B1UTST           CD Adjust/Add T
     C                     MOVELWN0730    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0731    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0732    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0733    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0734    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0735    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0736    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0737    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0738    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0739    B1IUTR           CD Gross Before
     C                     Z-ADDWN0740    B1IJRR           CD Gross Before
     C                     MOVELWN0741    B1VCST           CD Broken Back
     C                     MOVELWN0742    B1VDST           CD Adjust/Add S
     C                     MOVELWN0743    B1VEST           CD Unused Sts 3
     C                     MOVELWN0744    B1VFST           CD Unused Sts 4
     C                     MOVELWN0745    B1VGST           CD Unused Sts 5
     C                     MOVEL$NABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$NLKST    B1AACD           SR Source Code
     C                     MOVELWN0746    B1AAVN           RS User Changed
     C                     Z-ADDWN0747    B1AADT           RS Date Changed
     C                     Z-ADDWN0748    B1AMTM           RS Time Changed
     C                     MOVELWN0749    B1AJST           RS Record Statu
     C                     MOVELWN0750    B1AHVN           RS Job
     C                     MOVELWN0751    B1AGVN           RS Program
     C                     MOVELWN0752    B1ABVN           RS User Added
     C                     Z-ADDWN0753    B1ABDT           RS Date Added
     C                     Z-ADDWN0754    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0030  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0031  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQTA01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQTA02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQTA03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQTA04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQTA05           TH Kill Date
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           BOH Company Num
     C                     KFLD           WQTA02           BOH Buy Order N
     C                     KFLD           WQTA03           BOL Load Number
     C                     KFLD           WQTA04           TH Tattoo Numbe
     C                     KFLD           WQTA05           TH Kill Date
      * Setup key
     C                     Z-ADD$NHMNB    WQTA01           BOH Company Num
     C                     Z-ADD$NBNNB    WQTA02           BOH Buy Order N
     C                     Z-ADD$NBONB    WQTA03           BOL Load Number
     C                     Z-ADD$NCVNB    WQTA04           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    WQTA05           TH Kill Date
      * Establish starting position
     C           KRSTA     SETLL@BVCPQ9                    *
     C           KRSTA     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Average Adds
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
     C                     ADD  1         WULKIR           Head 6
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           BVAJST    IFEQ 'A'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
      * Added Carcasses
     C                     ADD  1         $NHD3C           Head 3
      * CASE: PAR.Payment Data Type USR is Eval Trans Adds
     C           WN0644    IFEQ 'EA'                       *IF
      *
     C                     Z-ADD*ZERO     WN0755  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0756  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0757  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0758  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0759  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0760  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0761  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0762  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0763  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0764  72       CD Gross Value
     C                     MOVEL*BLANK    WN0765  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0766  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0767  31       CD FFLI
     C                     MOVEL*BLANK    WN0768  1        CD Record Creat
     C                     MOVEL*BLANK    WN0769  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0770  50       CD LOT
     C                     MOVEL*BLANK    WN0771  1        CD User Error O
     C                     Z-ADD*ZERO     WN0772  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0773  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0774  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0775  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0776  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0777  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0778  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0779  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0780  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0781  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0782  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0783  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0784  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0785  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0786  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0787  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0788  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0789  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0790  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0791  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0792  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0793  72       CD Gross Before
     C                     MOVEL*BLANK    WN0794  1        CD Broken Back
     C                     MOVEL*BLANK    WN0795  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0796  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0797  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0798  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0799 10        RS User Changed
     C                     Z-ADD*ZERO     WN0800  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0801  60       RS Time Changed
     C                     MOVEL*BLANK    WN0802  1        RS Record Statu
     C                     MOVEL*BLANK    WN0803 10        RS Job
     C                     MOVEL*BLANK    WN0804 10        RS Program
     C                     MOVEL*BLANK    WN0805 10        RS User Added
     C                     Z-ADD*ZERO     WN0806  70       RS Date Added
     C                     Z-ADD*ZERO     WN0807  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TBCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           WN0643    IFEQ 'EA'                       *IF
      * Accumulation
     C                     EXSR USSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.ET Record Add/Del Sts is Delete
     C           BVEHST    IFEQ 'D'                        *IF
      * Flagged for Delete
     C                     ADD  1         $NHD4C           Head 4
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Deleted/Inactive
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Not Original Record
     C           BVEHST    IFEQ 'A'                        *IF
     C           BVEHST    OREQ *BLANK
     C           BVEHST    OREQ 'D'
      * CASE: DB1.ET Error Sts is Balance
     C           BVD2ST    IFEQ 'B'                        *IF
      * Valid Deleted
     C                     ADD  1         $NHD4C           Head 4
      * CASE: PAR.Payment Data Type USR is Eval Trans Valid Deletes
     C           WN0644    IFEQ 'EV'                       *IF
      *
     C                     Z-ADD*ZERO     WN0808  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0809  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0810  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0811  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0812  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0813  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0814  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0815  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0816  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0817  72       CD Gross Value
     C                     MOVEL*BLANK    WN0818  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0819  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0820  31       CD FFLI
     C                     MOVEL*BLANK    WN0821  1        CD Record Creat
     C                     MOVEL*BLANK    WN0822  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0823  50       CD LOT
     C                     MOVEL*BLANK    WN0824  1        CD User Error O
     C                     Z-ADD*ZERO     WN0825  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0826  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0827  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0828  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0829  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0830  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0831  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0832  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0833  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0834  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0835  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0836  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0837  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0838  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0839  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0840  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0841  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0842  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0843  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0844  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0845  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0846  72       CD Gross Before
     C                     MOVEL*BLANK    WN0847  1        CD Broken Back
     C                     MOVEL*BLANK    WN0848  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0849  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0850  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0851  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0852 10        RS User Changed
     C                     Z-ADD*ZERO     WN0853  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0854  60       RS Time Changed
     C                     MOVEL*BLANK    WN0855  1        RS Record Statu
     C                     MOVEL*BLANK    WN0856 10        RS Job
     C                     MOVEL*BLANK    WN0857 10        RS Program
     C                     MOVEL*BLANK    WN0858 10        RS User Added
     C                     Z-ADD*ZERO     WN0859  70       RS Date Added
     C                     Z-ADD*ZERO     WN0860  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TCCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Valid Deletes
     C           WN0643    IFEQ 'EV'                       *IF
      * Accumulation
     C                     EXSR UTSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Exceptions Deleted
     C                     ADD  1         $NHD5C           Head 5
      * Positive FOM Reading
      * CASE: Hot Wgt, Backfat, Loin Eye, Lean% > 0
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.ET Hot Wgt is Not Zero
      *   |- c2    : DB1.ET Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.ET Loin-Eye Depth Inches is GT Zero
      *   |- c4    : DB1.ET Lean Percent NPPC is Greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BVAMPC    IFNE 0                          *IF
     C           BVAIPC    IFGT 0                          *IF
     C           BVAJPC    IFGT 0                          *IF
     C           BVAKPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Payment Data Type USR is Eval Trans Excep Deletes
     C           WN0644    IFEQ 'EE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0861  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0862  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0863  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0864  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0865  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0866  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0867  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0868  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0869  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0870  72       CD Gross Value
     C                     MOVEL*BLANK    WN0871  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0872  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0873  31       CD FFLI
     C                     MOVEL*BLANK    WN0874  1        CD Record Creat
     C                     MOVEL*BLANK    WN0875  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0876  50       CD LOT
     C                     MOVEL*BLANK    WN0877  1        CD User Error O
     C                     Z-ADD*ZERO     WN0878  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0879  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0880  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0881  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0882  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0883  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0884  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0885  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0886  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0887  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0888  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0889  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0890  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0891  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0892  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0893  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0894  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0895  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0896  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0897  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0898  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0899  72       CD Gross Before
     C                     MOVEL*BLANK    WN0900  1        CD Broken Back
     C                     MOVEL*BLANK    WN0901  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0902  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0903  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0904  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0905 10        RS User Changed
     C                     Z-ADD*ZERO     WN0906  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0907  60       RS Time Changed
     C                     MOVEL*BLANK    WN0908  1        RS Record Statu
     C                     MOVEL*BLANK    WN0909 10        RS Job
     C                     MOVEL*BLANK    WN0910 10        RS Program
     C                     MOVEL*BLANK    WN0911 10        RS User Added
     C                     Z-ADD*ZERO     WN0912  70       RS Date Added
     C                     Z-ADD*ZERO     WN0913  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TDCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Excep Deletes
     C           WN0643    IFEQ 'EE'                       *IF
      * Accumulation
     C                     EXSR UUSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$NHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$NBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$NBONB    B1BONB           BOL Load Number
     C                     Z-ADD$NCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0755    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0756    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0757    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0758    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0759    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0760    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0761    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0762    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0763    B1EZNB           CD Gross Value
     C                     Z-ADDWN0764    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0765    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0766    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0767    B1BHPC           CD FFLI
     C                     MOVELWN0768    B1IOST           CD Record Creat
     C                     MOVELWN0769    B1IPST           CD Record Creat
     C                     Z-ADDWN0770    B1LTNB           CD LOT
     C                     MOVELWN0771    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$NKAST    B1K2ST           CD Source Type
     C                     MOVEL$NJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0772    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0773    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0774    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0775    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0776    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0777    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0778    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0779    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0780    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0781    B1J4PR           CD CA Gross Val
     C                     MOVELWN0782    B1UTST           CD Adjust/Add T
     C                     MOVELWN0783    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0784    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0785    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0786    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0787    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0788    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0789    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0790    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0791    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0792    B1IUTR           CD Gross Before
     C                     Z-ADDWN0793    B1IJRR           CD Gross Before
     C                     MOVELWN0794    B1VCST           CD Broken Back
     C                     MOVELWN0795    B1VDST           CD Adjust/Add S
     C                     MOVELWN0796    B1VEST           CD Unused Sts 3
     C                     MOVELWN0797    B1VFST           CD Unused Sts 4
     C                     MOVELWN0798    B1VGST           CD Unused Sts 5
     C                     MOVEL$NABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$NLKST    B1AACD           SR Source Code
     C                     MOVELWN0799    B1AAVN           RS User Changed
     C                     Z-ADDWN0800    B1AADT           RS Date Changed
     C                     Z-ADDWN0801    B1AMTM           RS Time Changed
     C                     MOVELWN0802    B1AJST           RS Record Statu
     C                     MOVELWN0803    B1AHVN           RS Job
     C                     MOVELWN0804    B1AGVN           RS Program
     C                     MOVELWN0805    B1ABVN           RS User Added
     C                     Z-ADDWN0806    B1ABDT           RS Date Added
     C                     Z-ADDWN0807    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0032  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0033  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTB    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTB    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$NHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$NBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$NBONB    B1BONB           BOL Load Number
     C                     Z-ADD$NCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0808    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0809    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0810    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0811    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0812    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0813    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0814    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0815    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0816    B1EZNB           CD Gross Value
     C                     Z-ADDWN0817    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0818    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0819    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0820    B1BHPC           CD FFLI
     C                     MOVELWN0821    B1IOST           CD Record Creat
     C                     MOVELWN0822    B1IPST           CD Record Creat
     C                     Z-ADDWN0823    B1LTNB           CD LOT
     C                     MOVELWN0824    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$NKAST    B1K2ST           CD Source Type
     C                     MOVEL$NJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0825    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0826    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0827    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0828    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0829    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0830    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0831    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0832    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0833    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0834    B1J4PR           CD CA Gross Val
     C                     MOVELWN0835    B1UTST           CD Adjust/Add T
     C                     MOVELWN0836    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0837    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0838    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0839    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0840    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0841    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0842    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0843    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0844    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0845    B1IUTR           CD Gross Before
     C                     Z-ADDWN0846    B1IJRR           CD Gross Before
     C                     MOVELWN0847    B1VCST           CD Broken Back
     C                     MOVELWN0848    B1VDST           CD Adjust/Add S
     C                     MOVELWN0849    B1VEST           CD Unused Sts 3
     C                     MOVELWN0850    B1VFST           CD Unused Sts 4
     C                     MOVELWN0851    B1VGST           CD Unused Sts 5
     C                     MOVEL$NABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$NLKST    B1AACD           SR Source Code
     C                     MOVELWN0852    B1AAVN           RS User Changed
     C                     Z-ADDWN0853    B1AADT           RS Date Changed
     C                     Z-ADDWN0854    B1AMTM           RS Time Changed
     C                     MOVELWN0855    B1AJST           RS Record Statu
     C                     MOVELWN0856    B1AHVN           RS Job
     C                     MOVELWN0857    B1AGVN           RS Program
     C                     MOVELWN0858    B1ABVN           RS User Added
     C                     Z-ADDWN0859    B1ABDT           RS Date Added
     C                     Z-ADDWN0860    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0034  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0035  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTC    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTC    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$NHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$NBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$NBONB    B1BONB           BOL Load Number
     C                     Z-ADD$NCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0861    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0862    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0863    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0864    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0865    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0866    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0867    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0868    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0869    B1EZNB           CD Gross Value
     C                     Z-ADDWN0870    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN0871    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN0872    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0873    B1BHPC           CD FFLI
     C                     MOVELWN0874    B1IOST           CD Record Creat
     C                     MOVELWN0875    B1IPST           CD Record Creat
     C                     Z-ADDWN0876    B1LTNB           CD LOT
     C                     MOVELWN0877    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$NKAST    B1K2ST           CD Source Type
     C                     MOVEL$NJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0878    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0879    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0880    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0881    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0882    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0883    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0884    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0885    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0886    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0887    B1J4PR           CD CA Gross Val
     C                     MOVELWN0888    B1UTST           CD Adjust/Add T
     C                     MOVELWN0889    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0890    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0891    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0892    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0893    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0894    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0895    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0896    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0897    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0898    B1IUTR           CD Gross Before
     C                     Z-ADDWN0899    B1IJRR           CD Gross Before
     C                     MOVELWN0900    B1VCST           CD Broken Back
     C                     MOVELWN0901    B1VDST           CD Adjust/Add S
     C                     MOVELWN0902    B1VEST           CD Unused Sts 3
     C                     MOVELWN0903    B1VFST           CD Unused Sts 4
     C                     MOVELWN0904    B1VGST           CD Unused Sts 5
     C                     MOVEL$NABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$NLKST    B1AACD           SR Source Code
     C                     MOVELWN0905    B1AAVN           RS User Changed
     C                     Z-ADDWN0906    B1AADT           RS Date Changed
     C                     Z-ADDWN0907    B1AMTM           RS Time Changed
     C                     MOVELWN0908    B1AJST           RS Record Statu
     C                     MOVELWN0909    B1AHVN           RS Job
     C                     MOVELWN0910    B1AGVN           RS Program
     C                     MOVELWN0911    B1ABVN           RS User Added
     C                     Z-ADDWN0912    B1ABDT           RS Date Added
     C                     Z-ADDWN0913    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0036  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0037  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTD    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTD    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $NH1US           Head 1 USR
     C                     Z-ADD*ZERO     $NH2US           Head 2 USR
     C                     Z-ADD*ZERO     YL0018           Gross Pay Amt T
     C                     Z-ADD*ZERO     $NB5NB           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQTE01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQTE02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQTE03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQTE04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQTE05           TH Kill Date
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           BOH Company Num
     C                     KFLD           WQTE02           BOH Buy Order N
     C                     KFLD           WQTE03           BOL Load Number
     C                     KFLD           WQTE04           TH Tattoo Numbe
     C                     KFLD           WQTE05           TH Kill Date
      * Setup key
     C                     Z-ADD$NHMNB    WQTE01           BOH Company Num
     C                     Z-ADD$NBNNB    WQTE02           BOH Buy Order N
     C                     Z-ADD$NBONB    WQTE03           BOL Load Number
     C                     Z-ADD$NCVNB    WQTE04           TH Tattoo Numbe
     C                     Z-ADD$NB0DT    WQTE05           TH Kill Date
      * Establish starting position
     C           KRSTE     SETLL@B1CPC3                    *
     C           KRSTE     READE@B1CPC3                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Add
     C           WAINST    IFEQ 'A'                        *IF
     C                     ADD  1         $NH2US           Head 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $NH1US           Head 1 USR
     C                     END                             *FI
      * CASE: PAR.Payment Data Type USR is Paid Carcasses
     C           WN0644    IFEQ 'PC'                       *IF
      *
     C                     Z-ADD*ZERO     WN0914  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0915  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0916  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0917  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0918  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0919  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0920  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0921  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0922  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0923  72       CD Gross Value
     C                     MOVEL*BLANK    WN0924  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0925  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0926  31       CD FFLI
     C                     MOVEL*BLANK    WN0927  1        CD Record Creat
     C                     MOVEL*BLANK    WN0928  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0929  50       CD LOT
     C                     MOVEL*BLANK    WN0930  1        CD User Error O
     C                     Z-ADD*ZERO     WN0931  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0932  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0933  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0934  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0935  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0936  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0937  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0938  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0939  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0940  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN0941  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN0942  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN0943  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN0944  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN0945  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN0946  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN0947  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0948  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN0949  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN0950  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN0951  72       CD Gross Before
     C                     Z-ADD*ZERO     WN0952  72       CD Gross Before
     C                     MOVEL*BLANK    WN0953  1        CD Broken Back
     C                     MOVEL*BLANK    WN0954  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN0955  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN0956  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN0957  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN0958 10        RS User Changed
     C                     Z-ADD*ZERO     WN0959  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0960  60       RS Time Changed
     C                     MOVEL*BLANK    WN0961  1        RS Record Statu
     C                     MOVEL*BLANK    WN0962 10        RS Job
     C                     MOVEL*BLANK    WN0963 10        RS Program
     C                     MOVEL*BLANK    WN0964 10        RS User Added
     C                     Z-ADD*ZERO     WN0965  70       RS Date Added
     C                     Z-ADD*ZERO     WN0966  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TFCRRC
     C                     END                             *FI
     C                     ADD  1         $NB5NB           Head Total USR
      * Accumulate Top Paid Carcasses
      * CASE: PAR.Head Total USR LE PAR.TH Head Killed
     C           $NB5NB    IFLE $NFENB                     *IF
     C                     ADD  WAAYPR    YL0018           Gross Pay Amt T
     C                     END                             *FI
     C           KRSTE     READE@B1CPC3                  90*
     C                     ENDDO
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWAHMNB    B1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    B1BONB           BOL Load Number
     C                     Z-ADDWACVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDWALGNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    B1EUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    B1LHNB           CD Carcass Numb
     C                     MOVELWAINST    B1INST           CD Record Add/D
     C                     Z-ADDWN0914    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0915    B1ASPC           CD STD Yield
     C                     Z-ADDWAEWNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0916    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0917    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0918    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0919    B1AVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0920    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0921    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0922    B1EZNB           CD Gross Value
     C                     Z-ADDWN0923    B1AYPR           CD Gross Value
     C                     Z-ADDWABBDT    B1BBDT           CD Kill Date
     C                     Z-ADDWAAKTM    B1AKTM           CD Kill Time
     C                     MOVELWAIQST    B1IQST           CD Shift
     C                     MOVELWN0924    B1EFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    B1H6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    B1GCST           CD Light Reflec
     C                     MOVELWAGDST    B1GDST           CD Trim Area
     C                     MOVELWN0925    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0926    B1BHPC           CD FFLI
     C                     MOVELWN0927    B1IOST           CD Record Creat
     C                     MOVELWN0928    B1IPST           CD Record Creat
     C                     Z-ADDWN0929    B1LTNB           CD LOT
     C                     MOVELWN0930    B1JNST           CD User Error O
     C                     Z-ADDWAX4NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    B1FOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    B1FPPC           CD Lean Percent
     C                     MOVELWAK2ST    B1K2ST           CD Source Type
     C                     MOVELWAK3ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0931    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0932    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0933    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0934    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0935    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0936    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0937    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0938    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0939    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0940    B1J4PR           CD CA Gross Val
     C                     MOVELWN0941    B1UTST           CD Adjust/Add T
     C                     MOVELWN0942    B1HVCD           CD Producer Loc
     C                     Z-ADDWN0943    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN0944    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN0945    B1IJGR           CD Meat Value F
     C                     Z-ADDWN0946    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN0947    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN0948    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN0949    B1IEUF           CD Meat Value F
     C                     Z-ADDWN0950    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN0951    B1IUTR           CD Gross Before
     C                     Z-ADDWN0952    B1IJRR           CD Gross Before
     C                     MOVELWN0953    B1VCST           CD Broken Back
     C                     MOVELWN0954    B1VDST           CD Adjust/Add S
     C                     MOVELWN0955    B1VEST           CD Unused Sts 3
     C                     MOVELWN0956    B1VFST           CD Unused Sts 4
     C                     MOVELWN0957    B1VGST           CD Unused Sts 5
     C                     MOVELWAABCD    B1ABCD           PD Producer Cod
     C                     MOVELWAAACD    B1AACD           SR Source Code
     C                     MOVELWN0958    B1AAVN           RS User Changed
     C                     Z-ADDWN0959    B1AADT           RS Date Changed
     C                     Z-ADDWN0960    B1AMTM           RS Time Changed
     C                     MOVELWN0961    B1AJST           RS Record Statu
     C                     MOVELWN0962    B1AHVN           RS Job
     C                     MOVELWN0963    B1AGVN           RS Program
     C                     MOVELWN0964    B1ABVN           RS User Added
     C                     Z-ADDWN0965    B1ABDT           RS Date Added
     C                     Z-ADDWN0966    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0038  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0039  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTF    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGCRRC    BEGSR
      *================================================================
      * Create FOM Summary OUTF - FOM Summary OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EVCPDU
     C                     MOVEL$QABCD    EVABCD           PD Producer Cod
     C                     Z-ADD$QB0DT    EVB0DT           TH Kill Date
     C                     Z-ADD$QB4NB    EVVLCR           HS Valid Carcs
     C                     Z-ADD$QXRNB    EVEXCR           HS Excep Carcs
     C                     Z-ADD$QH5SM    EVHDTC           HS Total Carcs
     C                     Z-ADD$QHTS3    EVVARC           HS Variance
     C                     Z-ADD$QWUNB    EVFENB           TH Head Killed
      *
     C           KLCRTG    KLIST
     C                     KFLD           EVABCD           PD Producer Cod
     C                     KFLD           EVB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRTG    SETLL@EVCPDU                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0908' W0RTN   7
      * Send message 'FOM Summary OUTF       EX'
     C                     MOVEL'PRK0908' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C                     WRITE@EVCPDU                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Validation Rules  RT - Evaluation Validation  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUI7NB           Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI8NB           Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI9NB           Carcass Lgt Min
     C                     Z-ADD*ZERO     WUJANB           Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJBNB           %Lean High Min
     C                     Z-ADD*ZERO     WUJLNB           %Lean High Max
     C                     Z-ADD*ZERO     WUJMNB           %Lean Low Min
     C                     Z-ADD*ZERO     WUJCNB           %Lean Low Max
     C                     Z-ADD*ZERO     WUJDNB           High Yield Min
     C                     Z-ADD*ZERO     WUJENB           High Yield Max
     C                     Z-ADD*ZERO     WUJFNB           Low Yield Min
     C                     Z-ADD*ZERO     WUJGNB           Low Yield Max
     C                     Z-ADD*ZERO     WUJHNB           Head < Percent
     C                     Z-ADD*ZERO     WUJINB           Head < Percent
     C                     Z-ADD*ZERO     WUJJNB           Head > Percent
     C                     Z-ADD*ZERO     WUJKNB           Head > Percent
     C                     Z-ADD*ZERO     WUK5NB           BackFat High Mi
     C                     Z-ADD*ZERO     WUK6NB           BackFat High Ma
     C                     Z-ADD*ZERO     WUK7NB           BackFat Low Min
     C                     Z-ADD*ZERO     WUK8NB           Backfat Low Max
     C                     Z-ADD*ZERO     WUK9NB           LoinEye High Mi
     C                     Z-ADD*ZERO     WULANB           LoinEye High Ma
     C                     Z-ADD*ZERO     WULBNB           LoinEye Low Min
     C                     Z-ADD*ZERO     WULCNB           LoinEye Low Max
      * Establish starting position
     C           *LOVAL    SETLL@BOREFN                    *
     C                     READ @BOREFN                  90*
      * Data record not found
     C   90                MOVEL'PRK0107' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.EV Validation Code is Carcass has Double Weight
     C           BOBVCD    IFEQ 'CDB'                      *IF
      * Carcass double weight
     C                     Z-ADDBOAFPC    WUI7NB           Carcass Dbw Min
     C                     Z-ADDBOAGPC    WUI8NB           Carcass Dbw Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Carcass is Light Weight
     C           BOBVCD    IFEQ 'CLT'                      *IF
      * Carcass light weight
     C                     Z-ADDBOAFPC    WUI9NB           Carcass Lgt Min
     C                     Z-ADDBOAGPC    WUJANB           Carcass Lgt Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is high
     C           BOBVCD    IFEQ 'BHI'                      *IF
      * backfat is high
     C                     Z-ADDBOAFPC    WUK5NB           BackFat High Mi
     C                     Z-ADDBOAGPC    WUK6NB           BackFat High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Backfat is Low
     C           BOBVCD    IFEQ 'BLW'                      *IF
      * Backfat is low
     C                     Z-ADDBOAFPC    WUK7NB           BackFat Low Min
     C                     Z-ADDBOAGPC    WUK8NB           Backfat Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is High
     C           BOBVCD    IFEQ 'LHI'                      *IF
      * loineye is high
     C                     Z-ADDBOAFPC    WUK9NB           LoinEye High Mi
     C                     Z-ADDBOAGPC    WULANB           LoinEye High Ma
     C                     ELSE
      * CASE: DB1.EV Validation Code is Loineye is Low
     C           BOBVCD    IFEQ 'LLW'                      *IF
      * loineye is low
     C                     Z-ADDBOAFPC    WULBNB           LoinEye Low Min
     C                     Z-ADDBOAGPC    WULCNB           LoinEye Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is high
     C           BOBVCD    IFEQ 'PLH'                      *IF
      * % Lean High
     C                     Z-ADDBOAFPC    WUJBNB           %Lean High Min
     C                     Z-ADDBOAGPC    WUJLNB           %Lean High Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Percent Lean is Low
     C           BOBVCD    IFEQ 'PLL'                      *IF
      * % Lean Low
     C                     Z-ADDBOAFPC    WUJMNB           %Lean Low Min
     C                     Z-ADDBOAGPC    WUJCNB           %Lean Low Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is < % Allowed
     C           BOBVCD    IFEQ 'HLP'                      *IF
      * Head < Percent
     C                     Z-ADDBOAFPC    WUJHNB           Head < Percent
     C                     Z-ADDBOAGPC    WUJINB           Head < Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is #Head is > % Allowed
     C           BOBVCD    IFEQ 'HHP'                      *IF
      * Head > Percent
     C                     Z-ADDBOAFPC    WUJJNB           Head > Percent
     C                     Z-ADDBOAGPC    WUJKNB           Head > Percent
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is High
     C           BOBVCD    IFEQ 'YHI'                      *IF
      * Yield High
     C                     Z-ADDBOAFPC    WUJDNB           High Yield Min
     C                     Z-ADDBOAGPC    WUJENB           High Yield Max
     C                     ELSE
      * CASE: DB1.EV Validation Code is Yield Amount is Low
     C           BOBVCD    IFEQ 'YLW'                      *IF
      * Yield Low
     C                     Z-ADDBOAFPC    WUJFNB           Low Yield Min
     C                     Z-ADDBOAGPC    WUJGNB           Low Yield Max
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BOREFN                  90*
     C                     ENDDO
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $SLFNB           TDE Head Condem
     C                     Z-ADD*ZERO     $SLINB           Head 2
     C                     Z-ADD*ZERO     $SMWNB           Trim Head 1 USR
     C                     Z-ADD*ZERO     YL0013           Hot Wgt/Lean %
     C                     Z-ADD*ZERO     YL0014           Hot Wgt/Backf A
     C                     Z-ADD*ZERO     YL0015           Hot Wgt/Loine A
     C                     Z-ADD*ZERO     YL0016           Hot Wgt/LghtR A
     C                     Z-ADD*ZERO     $SKGNB           Hot Weight Tot
     C                     Z-ADD*ZERO     YL0017           Head No Probe U
      * Declare restrictor key work fields
     C           *LIKE     DEFN CPHKST    WQTI01           EA Company Numb
     C           *LIKE     DEFN CPKHNB    WQTI02           EA Tattoo Numbe
     C           *LIKE     DEFN CPB7DT    WQTI03           EA Kill Date
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           EA Company Numb
     C                     KFLD           WQTI02           EA Tattoo Numbe
     C                     KFLD           WQTI03           EA Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQTI01           EA Company Numb
     C                     Z-ADDWBCVNB    WQTI02           EA Tattoo Numbe
     C                     Z-ADDWBB0DT    WQTI03           EA Kill Date
      * Establish starting position
     C           KRSTI     SETLL@CPCPCI                    *
     C           KRSTI     READE@CPCPCI                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL*BLANK    WUD2ST           ET Error Sts
      * COMPUTE LEAN % Morrison Hot Scale
     C                     EXSR UWSUBR                     COMPUTE LEAN %
      * Validate Hot Weight
      * CASE: DB1.EA Hot Weight LE PAR.Carcass Lgt Max
     C           CPKJNB    IFLE WUJANB                     *IF
      * Carcass Light Weight Error
     C                     MOVEL'CLT'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Hot Weight GE PAR.Carcass Dbw Min
     C           CPKJNB    IFGE WUI7NB                     *IF
     C                     MOVEL'CDB'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Backfat
      * CASE: DB1.EA Backfat Thickness Inch LE PAR.Backfat Low Max
     C           CPKKNB    IFLE WUK8NB                     *IF
      * backfat to low  Error
     C                     MOVEL'BLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Backfat Thickness Inch GE PAR.BackFat High Min
     C           CPKKNB    IFGE WUK5NB                     *IF
      * backfat high error
     C                     MOVEL'BHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate Loineye
      * CASE: DB1.EA Loin-Eye Depth Inches LE PAR.LoinEye Low Max
     C           CPBQPC    IFLE WULCNB                     *IF
      * Loin eye  Light Error
     C                     MOVEL'LLW'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: DB1.EA Loin-Eye Depth Inches GE PAR.LoinEye High Min
     C           CPBQPC    IFGE WUK9NB                     *IF
      * Loin eye  High Error
     C                     MOVEL'LHI'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Validate  % Lean
      * CASE: WRK.ET Lean Percent NPPC LE PAR.%Lean Low Max
     C           WUAKPC    IFLE WUJCNB                     *IF
      * % Lean low  Error
     C                     MOVEL'PLL'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     ELSE
      * CASE: WRK.ET Lean Percent NPPC GE PAR.%Lean High Min
     C           WUAKPC    IFGE WUJBNB                     *IF
      * % Lean High Error
     C                     MOVEL'PLH'     WUDXST           KV Error Code
     C                     MOVEL'E'       WUD2ST           ET Error Sts
     C                     END                             *FI
     C                     END                             *FI
      * Trimmed Carcasses
      * CASE: DB1.EA Trim Area NE WRK.Blank USR
     C           CPHMST    IFNE WUCRTX                     *IF
     C                     ADD  1         $SMWNB           Trim Head 1 USR
     C                     END                             *FI
      * Valid/Exception Carcasses
      * CASE: WRK.ET Error Sts is Error
     C           WUD2ST    IFEQ 'E'                        *IF
      * Exception Carcasses
      * Positive FOM Reading
      * CASE: Hot Weight, Back Fat, Loin Eye > 0
      *  - c1 AND c2 AND c3
      *   |- c1    : DB1.EA Hot Weight is Not Zero
      *   |- c2    : DB1.EA Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.EA Loin-Eye Depth Inches is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           CPKJNB    IFNE 0                          *IF
     C           CPKKNB    IFGT 0                          *IF
     C           CPBQPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ADD  1         $SLINB           Head 2
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Excep
     C           WN0968    IFEQ 'UE'                       *IF
      *
     C                     Z-ADD*ZERO     WN0973  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN0974  52       CD STD Yield
     C                     Z-ADD*ZERO     WN0975  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN0976  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN0977  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN0978  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN0979  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0980  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN0981  52       CD Gross Value
     C                     Z-ADD*ZERO     WN0982  72       CD Gross Value
     C                     MOVEL*BLANK    WN0983  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN0984  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN0985  31       CD FFLI
     C                     MOVEL*BLANK    WN0986  1        CD Record Creat
     C                     MOVEL*BLANK    WN0987  1        CD Record Creat
     C                     Z-ADD*ZERO     WN0988  50       CD LOT
     C                     MOVEL*BLANK    WN0989  1        CD User Error O
     C                     Z-ADD*ZERO     WN0990  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN0991  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN0992  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0993  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0994  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN0995  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN0996  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0997  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN0998  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN0999  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN1000  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN1001  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN1002  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN1003  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN1004  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN1005  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN1006  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1007  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN1008  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN1009  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1010  72       CD Gross Before
     C                     Z-ADD*ZERO     WN1011  72       CD Gross Before
     C                     MOVEL*BLANK    WN1012  1        CD Broken Back
     C                     MOVEL*BLANK    WN1013  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN1014  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN1015  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN1016  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN1017 10        RS User Changed
     C                     Z-ADD*ZERO     WN1018  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1019  60       RS Time Changed
     C                     MOVEL*BLANK    WN1020  1        RS Record Statu
     C                     MOVEL*BLANK    WN1021 10        RS Job
     C                     MOVEL*BLANK    WN1022 10        RS Program
     C                     MOVEL*BLANK    WN1023 10        RS User Added
     C                     Z-ADD*ZERO     WN1024  70       RS Date Added
     C                     Z-ADD*ZERO     WN1025  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TJCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Excep
     C           WN0967    IFEQ 'UE'                       *IF
      * Accumulation
     C                     EXSR UXSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         YL0017           Head No Probe U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Valid Carcasses
     C                     ADD  1         $SLFNB           TDE Head Condem
      * CASE: PAR.Payment Data Type USR is Eval Trans UPL Valid
     C           WN0968    IFEQ 'UV'                       *IF
      *
     C                     Z-ADD*ZERO     WN1026  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN1027  52       CD STD Yield
     C                     Z-ADD*ZERO     WN1028  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN1029  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN1030  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN1031  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN1032  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1033  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1034  52       CD Gross Value
     C                     Z-ADD*ZERO     WN1035  72       CD Gross Value
     C                     MOVEL*BLANK    WN1036  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN1037  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN1038  31       CD FFLI
     C                     MOVEL*BLANK    WN1039  1        CD Record Creat
     C                     MOVEL*BLANK    WN1040  1        CD Record Creat
     C                     Z-ADD*ZERO     WN1041  50       CD LOT
     C                     MOVEL*BLANK    WN1042  1        CD User Error O
     C                     Z-ADD*ZERO     WN1043  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN1044  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN1045  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1046  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1047  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1048  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1049  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1050  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1051  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN1052  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN1053  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN1054  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN1055  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN1056  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN1057  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN1058  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN1059  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1060  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN1061  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN1062  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1063  72       CD Gross Before
     C                     Z-ADD*ZERO     WN1064  72       CD Gross Before
     C                     MOVEL*BLANK    WN1065  1        CD Broken Back
     C                     MOVEL*BLANK    WN1066  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN1067  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN1068  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN1069  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN1070 10        RS User Changed
     C                     Z-ADD*ZERO     WN1071  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1072  60       RS Time Changed
     C                     MOVEL*BLANK    WN1073  1        RS Record Statu
     C                     MOVEL*BLANK    WN1074 10        RS Job
     C                     MOVEL*BLANK    WN1075 10        RS Program
     C                     MOVEL*BLANK    WN1076 10        RS User Added
     C                     Z-ADD*ZERO     WN1077  70       RS Date Added
     C                     Z-ADD*ZERO     WN1078  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TKCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans UPL Valid
     C           WN0967    IFEQ 'UV'                       *IF
      * Accumulation
     C                     EXSR UYSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTI     READE@CPCPCI                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$SHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$SBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$SBONB    B1BONB           BOL Load Number
     C                     Z-ADD$SCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN0973    B1BEPR           CD Sort Loss
     C                     Z-ADDWN0974    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN0975    B1B4PR           CD Base Carcass
     C                     Z-ADDWN0976    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN0977    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN0978    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN0979    B1AWPR           CD Lean Premium
     C                     Z-ADDWN0980    B1AXPR           CD Lean Premium
     C                     Z-ADDWN0981    B1EZNB           CD Gross Value
     C                     Z-ADDWN0982    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN0983    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN0984    B1GEST           CD Carcass Sex
     C                     Z-ADDWN0985    B1BHPC           CD FFLI
     C                     MOVELWN0986    B1IOST           CD Record Creat
     C                     MOVELWN0987    B1IPST           CD Record Creat
     C                     Z-ADDWN0988    B1LTNB           CD LOT
     C                     MOVELWN0989    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$SKAST    B1K2ST           CD Source Type
     C                     MOVEL$SJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN0990    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN0991    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN0992    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN0993    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN0994    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN0995    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN0996    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN0997    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN0998    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN0999    B1J4PR           CD CA Gross Val
     C                     MOVELWN1000    B1UTST           CD Adjust/Add T
     C                     MOVELWN1001    B1HVCD           CD Producer Loc
     C                     Z-ADDWN1002    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN1003    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN1004    B1IJGR           CD Meat Value F
     C                     Z-ADDWN1005    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN1006    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN1007    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN1008    B1IEUF           CD Meat Value F
     C                     Z-ADDWN1009    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN1010    B1IUTR           CD Gross Before
     C                     Z-ADDWN1011    B1IJRR           CD Gross Before
     C                     MOVELWN1012    B1VCST           CD Broken Back
     C                     MOVELWN1013    B1VDST           CD Adjust/Add S
     C                     MOVELWN1014    B1VEST           CD Unused Sts 3
     C                     MOVELWN1015    B1VFST           CD Unused Sts 4
     C                     MOVELWN1016    B1VGST           CD Unused Sts 5
     C                     MOVEL$SABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$SLKST    B1AACD           SR Source Code
     C                     MOVELWN1017    B1AAVN           RS User Changed
     C                     Z-ADDWN1018    B1AADT           RS Date Changed
     C                     Z-ADDWN1019    B1AMTM           RS Time Changed
     C                     MOVELWN1020    B1AJST           RS Record Statu
     C                     MOVELWN1021    B1AHVN           RS Job
     C                     MOVELWN1022    B1AGVN           RS Program
     C                     MOVELWN1023    B1ABVN           RS User Added
     C                     Z-ADDWN1024    B1ABDT           RS Date Added
     C                     Z-ADDWN1025    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0040  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0041  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTJ    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTJ    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$SHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$SBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$SBONB    B1BONB           BOL Load Number
     C                     Z-ADD$SCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDCPKINB    B1LGNB           CD Scale Sequen
     C                     Z-ADDCPKINB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN1026    B1BEPR           CD Sort Loss
     C                     Z-ADDWN1027    B1ASPC           CD STD Yield
     C                     Z-ADDCPKJNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN1028    B1B4PR           CD Base Carcass
     C                     Z-ADDWN1029    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN1030    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN1031    B1AVPR           CD Crc Value $
     C                     Z-ADDWUAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN1032    B1AWPR           CD Lean Premium
     C                     Z-ADDWN1033    B1AXPR           CD Lean Premium
     C                     Z-ADDWN1034    B1EZNB           CD Gross Value
     C                     Z-ADDWN1035    B1AYPR           CD Gross Value
     C                     Z-ADDCPB7DT    B1BBDT           CD Kill Date
     C                     Z-ADDCPAOTM    B1AKTM           CD Kill Time
     C                     MOVELWUIQST    B1IQST           CD Shift
     C                     MOVELWN1036    B1EFST           CD Carcass Acti
     C                     Z-ADDCPKKNB    B1H6NB           CD Backfat Thic
     C                     Z-ADDCPBQPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDCPBRPC    B1GCST           CD Light Reflec
     C                     MOVELCPHMST    B1GDST           CD Trim Area
     C                     MOVELWN1037    B1GEST           CD Carcass Sex
     C                     Z-ADDWN1038    B1BHPC           CD FFLI
     C                     MOVELWN1039    B1IOST           CD Record Creat
     C                     MOVELWN1040    B1IPST           CD Record Creat
     C                     Z-ADDWN1041    B1LTNB           CD LOT
     C                     MOVELWN1042    B1JNST           CD User Error O
     C                     Z-ADDCPX6NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDCPFQPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDCPFRPC    B1FOPC           CD Light Reflec
     C                     Z-ADD*ZERO     B1FPPC           CD Lean Percent
     C                     MOVEL$SKAST    B1K2ST           CD Source Type
     C                     MOVEL$SJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN1043    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN1044    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN1045    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN1046    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN1047    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN1048    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN1049    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN1050    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN1051    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN1052    B1J4PR           CD CA Gross Val
     C                     MOVELWN1053    B1UTST           CD Adjust/Add T
     C                     MOVELWN1054    B1HVCD           CD Producer Loc
     C                     Z-ADDWN1055    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN1056    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN1057    B1IJGR           CD Meat Value F
     C                     Z-ADDWN1058    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN1059    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN1060    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN1061    B1IEUF           CD Meat Value F
     C                     Z-ADDWN1062    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN1063    B1IUTR           CD Gross Before
     C                     Z-ADDWN1064    B1IJRR           CD Gross Before
     C                     MOVELWN1065    B1VCST           CD Broken Back
     C                     MOVELWN1066    B1VDST           CD Adjust/Add S
     C                     MOVELWN1067    B1VEST           CD Unused Sts 3
     C                     MOVELWN1068    B1VFST           CD Unused Sts 4
     C                     MOVELWN1069    B1VGST           CD Unused Sts 5
     C                     MOVEL$SABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$SLKST    B1AACD           SR Source Code
     C                     MOVELWN1070    B1AAVN           RS User Changed
     C                     Z-ADDWN1071    B1AADT           RS Date Changed
     C                     Z-ADDWN1072    B1AMTM           RS Time Changed
     C                     MOVELWN1073    B1AJST           RS Record Statu
     C                     MOVELWN1074    B1AHVN           RS Job
     C                     MOVELWN1075    B1AGVN           RS Program
     C                     MOVELWN1076    B1ABVN           RS User Added
     C                     Z-ADDWN1077    B1ABDT           RS Date Added
     C                     Z-ADDWN1078    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0042  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0043  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTK    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTK    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN BVHMNB    WQTL01           BOH Company Num
     C           *LIKE     DEFN BVBNNB    WQTL02           BOH Buy Order N
     C           *LIKE     DEFN BVBONB    WQTL03           BOL Load Number
     C           *LIKE     DEFN BVCVNB    WQTL04           TH Tattoo Numbe
     C           *LIKE     DEFN BVB0DT    WQTL05           TH Kill Date
      * Define keylist
     C           KRSTL     KLIST
     C                     KFLD           WQTL01           BOH Company Num
     C                     KFLD           WQTL02           BOH Buy Order N
     C                     KFLD           WQTL03           BOL Load Number
     C                     KFLD           WQTL04           TH Tattoo Numbe
     C                     KFLD           WQTL05           TH Kill Date
      * Setup key
     C                     Z-ADD$SHMNB    WQTL01           BOH Company Num
     C                     Z-ADD$SBNNB    WQTL02           BOH Buy Order N
     C                     Z-ADD$SBONB    WQTL03           BOL Load Number
     C                     Z-ADD$SCVNB    WQTL04           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    WQTL05           TH Kill Date
      * Establish starting position
     C           KRSTL     SETLL@BVCPQ9                    *
     C           KRSTL     READE@BVCPQ9                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Add Average Adds
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
     C                     ADD  1         WULKIR           Head 6
     C                     END                             *FI
      * CASE: DB1.RS Record Status is Active
     C           BVAJST    IFEQ 'A'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Add
     C           BVEHST    IFEQ 'A'                        *IF
      * Added Carcasses
     C                     ADD  1         $SHD3C           Head 3
      * CASE: PAR.Payment Data Type USR is Eval Trans Adds
     C           WN0968    IFEQ 'EA'                       *IF
      *
     C                     Z-ADD*ZERO     WN1079  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN1080  52       CD STD Yield
     C                     Z-ADD*ZERO     WN1081  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN1082  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN1083  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN1084  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN1085  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1086  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1087  52       CD Gross Value
     C                     Z-ADD*ZERO     WN1088  72       CD Gross Value
     C                     MOVEL*BLANK    WN1089  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN1090  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN1091  31       CD FFLI
     C                     MOVEL*BLANK    WN1092  1        CD Record Creat
     C                     MOVEL*BLANK    WN1093  1        CD Record Creat
     C                     Z-ADD*ZERO     WN1094  50       CD LOT
     C                     MOVEL*BLANK    WN1095  1        CD User Error O
     C                     Z-ADD*ZERO     WN1096  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN1097  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN1098  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1099  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1100  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1101  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1102  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1103  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1104  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN1105  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN1106  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN1107  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN1108  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN1109  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN1110  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN1111  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN1112  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1113  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN1114  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN1115  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1116  72       CD Gross Before
     C                     Z-ADD*ZERO     WN1117  72       CD Gross Before
     C                     MOVEL*BLANK    WN1118  1        CD Broken Back
     C                     MOVEL*BLANK    WN1119  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN1120  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN1121  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN1122  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN1123 10        RS User Changed
     C                     Z-ADD*ZERO     WN1124  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1125  60       RS Time Changed
     C                     MOVEL*BLANK    WN1126  1        RS Record Statu
     C                     MOVEL*BLANK    WN1127 10        RS Job
     C                     MOVEL*BLANK    WN1128 10        RS Program
     C                     MOVEL*BLANK    WN1129 10        RS User Added
     C                     Z-ADD*ZERO     WN1130  70       RS Date Added
     C                     Z-ADD*ZERO     WN1131  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TMCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Adds
     C           WN0967    IFEQ 'EA'                       *IF
      * Accumulation
     C                     EXSR UZSUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.ET Record Add/Del Sts is Delete
     C           BVEHST    IFEQ 'D'                        *IF
      * Flagged for Delete
     C                     ADD  1         $SHD4C           Head 4
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Deleted/Inactive
      * CASE: DB1.RS Record Status is Flag for Purge
     C           BVAJST    IFEQ 'D'                        *IF
      * CASE: DB1.ET Record Add/Del Sts is Not Original Record
     C           BVEHST    IFEQ 'A'                        *IF
     C           BVEHST    OREQ *BLANK
     C           BVEHST    OREQ 'D'
      * CASE: DB1.ET Error Sts is Balance
     C           BVD2ST    IFEQ 'B'                        *IF
      * Valid Deleted
     C                     ADD  1         $SHD4C           Head 4
      * CASE: PAR.Payment Data Type USR is Eval Trans Valid Deletes
     C           WN0968    IFEQ 'EV'                       *IF
      *
     C                     Z-ADD*ZERO     WN1132  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN1133  52       CD STD Yield
     C                     Z-ADD*ZERO     WN1134  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN1135  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN1136  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN1137  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN1138  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1139  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1140  52       CD Gross Value
     C                     Z-ADD*ZERO     WN1141  72       CD Gross Value
     C                     MOVEL*BLANK    WN1142  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN1143  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN1144  31       CD FFLI
     C                     MOVEL*BLANK    WN1145  1        CD Record Creat
     C                     MOVEL*BLANK    WN1146  1        CD Record Creat
     C                     Z-ADD*ZERO     WN1147  50       CD LOT
     C                     MOVEL*BLANK    WN1148  1        CD User Error O
     C                     Z-ADD*ZERO     WN1149  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN1150  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN1151  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1152  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1153  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1154  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1155  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1156  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1157  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN1158  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN1159  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN1160  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN1161  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN1162  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN1163  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN1164  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN1165  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1166  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN1167  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN1168  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1169  72       CD Gross Before
     C                     Z-ADD*ZERO     WN1170  72       CD Gross Before
     C                     MOVEL*BLANK    WN1171  1        CD Broken Back
     C                     MOVEL*BLANK    WN1172  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN1173  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN1174  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN1175  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN1176 10        RS User Changed
     C                     Z-ADD*ZERO     WN1177  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1178  60       RS Time Changed
     C                     MOVEL*BLANK    WN1179  1        RS Record Statu
     C                     MOVEL*BLANK    WN1180 10        RS Job
     C                     MOVEL*BLANK    WN1181 10        RS Program
     C                     MOVEL*BLANK    WN1182 10        RS User Added
     C                     Z-ADD*ZERO     WN1183  70       RS Date Added
     C                     Z-ADD*ZERO     WN1184  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TNCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Valid Deletes
     C           WN0967    IFEQ 'EV'                       *IF
      * Accumulation
     C                     EXSR NASUBR                     Accumulation
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Exceptions Deleted
     C                     ADD  1         $SHD5C           Head 5
      * Positive FOM Reading
      * CASE: Hot Wgt, Backfat, Loin Eye, Lean% > 0
      *  - c1 AND c2 AND c3 AND c4
      *   |- c1    : DB1.ET Hot Wgt is Not Zero
      *   |- c2    : DB1.ET Backfat Thickness Inch is GT Zero
      *   |- c3    : DB1.ET Loin-Eye Depth Inches is GT Zero
      *   |- c4    : DB1.ET Lean Percent NPPC is Greater than 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           BVAMPC    IFNE 0                          *IF
     C           BVAIPC    IFGT 0                          *IF
     C           BVAJPC    IFGT 0                          *IF
     C           BVAKPC    IFGT 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Payment Data Type USR is Eval Trans Excep Deletes
     C           WN0968    IFEQ 'EE'                       *IF
      *
     C                     Z-ADD*ZERO     WN1185  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN1186  52       CD STD Yield
     C                     Z-ADD*ZERO     WN1187  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN1188  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN1189  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN1190  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN1191  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1192  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1193  52       CD Gross Value
     C                     Z-ADD*ZERO     WN1194  72       CD Gross Value
     C                     MOVEL*BLANK    WN1195  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN1196  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN1197  31       CD FFLI
     C                     MOVEL*BLANK    WN1198  1        CD Record Creat
     C                     MOVEL*BLANK    WN1199  1        CD Record Creat
     C                     Z-ADD*ZERO     WN1200  50       CD LOT
     C                     MOVEL*BLANK    WN1201  1        CD User Error O
     C                     Z-ADD*ZERO     WN1202  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN1203  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN1204  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1205  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1206  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1207  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1208  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1209  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1210  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN1211  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN1212  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN1213  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN1214  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN1215  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN1216  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN1217  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN1218  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1219  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN1220  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN1221  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1222  72       CD Gross Before
     C                     Z-ADD*ZERO     WN1223  72       CD Gross Before
     C                     MOVEL*BLANK    WN1224  1        CD Broken Back
     C                     MOVEL*BLANK    WN1225  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN1226  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN1227  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN1228  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN1229 10        RS User Changed
     C                     Z-ADD*ZERO     WN1230  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1231  60       RS Time Changed
     C                     MOVEL*BLANK    WN1232  1        RS Record Statu
     C                     MOVEL*BLANK    WN1233 10        RS Job
     C                     MOVEL*BLANK    WN1234 10        RS Program
     C                     MOVEL*BLANK    WN1235 10        RS User Added
     C                     Z-ADD*ZERO     WN1236  70       RS Date Added
     C                     Z-ADD*ZERO     WN1237  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TOCRRC
     C                     END                             *FI
      * CASE: PAR.Analysis Type USR is Eval Trans Excep Deletes
     C           WN0967    IFEQ 'EE'                       *IF
      * Accumulation
     C                     EXSR NBSUBR                     Accumulation
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTL     READE@BVCPQ9                  90*
     C                     ENDDO
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$SHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$SBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$SBONB    B1BONB           BOL Load Number
     C                     Z-ADD$SCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN1079    B1BEPR           CD Sort Loss
     C                     Z-ADDWN1080    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN1081    B1B4PR           CD Base Carcass
     C                     Z-ADDWN1082    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN1083    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN1084    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN1085    B1AWPR           CD Lean Premium
     C                     Z-ADDWN1086    B1AXPR           CD Lean Premium
     C                     Z-ADDWN1087    B1EZNB           CD Gross Value
     C                     Z-ADDWN1088    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN1089    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN1090    B1GEST           CD Carcass Sex
     C                     Z-ADDWN1091    B1BHPC           CD FFLI
     C                     MOVELWN1092    B1IOST           CD Record Creat
     C                     MOVELWN1093    B1IPST           CD Record Creat
     C                     Z-ADDWN1094    B1LTNB           CD LOT
     C                     MOVELWN1095    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$SKAST    B1K2ST           CD Source Type
     C                     MOVEL$SJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN1096    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN1097    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN1098    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN1099    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN1100    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN1101    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN1102    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN1103    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN1104    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN1105    B1J4PR           CD CA Gross Val
     C                     MOVELWN1106    B1UTST           CD Adjust/Add T
     C                     MOVELWN1107    B1HVCD           CD Producer Loc
     C                     Z-ADDWN1108    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN1109    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN1110    B1IJGR           CD Meat Value F
     C                     Z-ADDWN1111    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN1112    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN1113    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN1114    B1IEUF           CD Meat Value F
     C                     Z-ADDWN1115    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN1116    B1IUTR           CD Gross Before
     C                     Z-ADDWN1117    B1IJRR           CD Gross Before
     C                     MOVELWN1118    B1VCST           CD Broken Back
     C                     MOVELWN1119    B1VDST           CD Adjust/Add S
     C                     MOVELWN1120    B1VEST           CD Unused Sts 3
     C                     MOVELWN1121    B1VFST           CD Unused Sts 4
     C                     MOVELWN1122    B1VGST           CD Unused Sts 5
     C                     MOVEL$SABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$SLKST    B1AACD           SR Source Code
     C                     MOVELWN1123    B1AAVN           RS User Changed
     C                     Z-ADDWN1124    B1AADT           RS Date Changed
     C                     Z-ADDWN1125    B1AMTM           RS Time Changed
     C                     MOVELWN1126    B1AJST           RS Record Statu
     C                     MOVELWN1127    B1AHVN           RS Job
     C                     MOVELWN1128    B1AGVN           RS Program
     C                     MOVELWN1129    B1ABVN           RS User Added
     C                     Z-ADDWN1130    B1ABDT           RS Date Added
     C                     Z-ADDWN1131    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0044  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0045  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTM    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTM    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TMEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$SHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$SBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$SBONB    B1BONB           BOL Load Number
     C                     Z-ADD$SCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN1132    B1BEPR           CD Sort Loss
     C                     Z-ADDWN1133    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN1134    B1B4PR           CD Base Carcass
     C                     Z-ADDWN1135    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN1136    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN1137    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN1138    B1AWPR           CD Lean Premium
     C                     Z-ADDWN1139    B1AXPR           CD Lean Premium
     C                     Z-ADDWN1140    B1EZNB           CD Gross Value
     C                     Z-ADDWN1141    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN1142    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN1143    B1GEST           CD Carcass Sex
     C                     Z-ADDWN1144    B1BHPC           CD FFLI
     C                     MOVELWN1145    B1IOST           CD Record Creat
     C                     MOVELWN1146    B1IPST           CD Record Creat
     C                     Z-ADDWN1147    B1LTNB           CD LOT
     C                     MOVELWN1148    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$SKAST    B1K2ST           CD Source Type
     C                     MOVEL$SJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN1149    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN1150    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN1151    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN1152    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN1153    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN1154    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN1155    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN1156    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN1157    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN1158    B1J4PR           CD CA Gross Val
     C                     MOVELWN1159    B1UTST           CD Adjust/Add T
     C                     MOVELWN1160    B1HVCD           CD Producer Loc
     C                     Z-ADDWN1161    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN1162    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN1163    B1IJGR           CD Meat Value F
     C                     Z-ADDWN1164    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN1165    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN1166    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN1167    B1IEUF           CD Meat Value F
     C                     Z-ADDWN1168    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN1169    B1IUTR           CD Gross Before
     C                     Z-ADDWN1170    B1IJRR           CD Gross Before
     C                     MOVELWN1171    B1VCST           CD Broken Back
     C                     MOVELWN1172    B1VDST           CD Adjust/Add S
     C                     MOVELWN1173    B1VEST           CD Unused Sts 3
     C                     MOVELWN1174    B1VFST           CD Unused Sts 4
     C                     MOVELWN1175    B1VGST           CD Unused Sts 5
     C                     MOVEL$SABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$SLKST    B1AACD           SR Source Code
     C                     MOVELWN1176    B1AAVN           RS User Changed
     C                     Z-ADDWN1177    B1AADT           RS Date Changed
     C                     Z-ADDWN1178    B1AMTM           RS Time Changed
     C                     MOVELWN1179    B1AJST           RS Record Statu
     C                     MOVELWN1180    B1AHVN           RS Job
     C                     MOVELWN1181    B1AGVN           RS Program
     C                     MOVELWN1182    B1ABVN           RS User Added
     C                     Z-ADDWN1183    B1ABDT           RS Date Added
     C                     Z-ADDWN1184    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0046  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0047  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTN    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTN    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADD$SHMNB    B1HMNB           BOH Company Num
     C                     Z-ADD$SBNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADD$SBONB    B1BONB           BOL Load Number
     C                     Z-ADD$SCVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDBVFJNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDBVHCNB    B1EUNB           CD Carcass Numb
     C                     Z-ADD1         B1LHNB           CD Carcass Numb
     C                     MOVEL*BLANK    B1INST           CD Record Add/D
     C                     Z-ADDWN1185    B1BEPR           CD Sort Loss
     C                     Z-ADDWN1186    B1ASPC           CD STD Yield
     C                     Z-ADDBVAMPC    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN1187    B1B4PR           CD Base Carcass
     C                     Z-ADDWN1188    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN1189    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN1190    B1AVPR           CD Crc Value $
     C                     Z-ADDBVAKPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN1191    B1AWPR           CD Lean Premium
     C                     Z-ADDWN1192    B1AXPR           CD Lean Premium
     C                     Z-ADDWN1193    B1EZNB           CD Gross Value
     C                     Z-ADDWN1194    B1AYPR           CD Gross Value
     C                     Z-ADDBVA9DT    B1BBDT           CD Kill Date
     C                     Z-ADDBVAOTM    B1AKTM           CD Kill Time
     C                     MOVELBVEAST    B1IQST           CD Shift
     C                     MOVELWN1195    B1EFST           CD Carcass Acti
     C                     Z-ADDBVAIPC    B1H6NB           CD Backfat Thic
     C                     Z-ADDBVAJPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDBVALPC    B1GCST           CD Light Reflec
     C                     MOVELBVDIST    B1GDST           CD Trim Area
     C                     MOVELWN1196    B1GEST           CD Carcass Sex
     C                     Z-ADDWN1197    B1BHPC           CD FFLI
     C                     MOVELWN1198    B1IOST           CD Record Creat
     C                     MOVELWN1199    B1IPST           CD Record Creat
     C                     Z-ADDWN1200    B1LTNB           CD LOT
     C                     MOVELWN1201    B1JNST           CD User Error O
     C                     Z-ADDBVX8NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDBVFVPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDBVFWPC    B1FOPC           CD Light Reflec
     C                     Z-ADDBVFXPC    B1FPPC           CD Lean Percent
     C                     MOVEL$SKAST    B1K2ST           CD Source Type
     C                     MOVEL$SJ9ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN1202    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN1203    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN1204    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN1205    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN1206    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN1207    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN1208    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN1209    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN1210    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN1211    B1J4PR           CD CA Gross Val
     C                     MOVELWN1212    B1UTST           CD Adjust/Add T
     C                     MOVELWN1213    B1HVCD           CD Producer Loc
     C                     Z-ADDWN1214    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN1215    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN1216    B1IJGR           CD Meat Value F
     C                     Z-ADDWN1217    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN1218    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN1219    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN1220    B1IEUF           CD Meat Value F
     C                     Z-ADDWN1221    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN1222    B1IUTR           CD Gross Before
     C                     Z-ADDWN1223    B1IJRR           CD Gross Before
     C                     MOVELWN1224    B1VCST           CD Broken Back
     C                     MOVELWN1225    B1VDST           CD Adjust/Add S
     C                     MOVELWN1226    B1VEST           CD Unused Sts 3
     C                     MOVELWN1227    B1VFST           CD Unused Sts 4
     C                     MOVELWN1228    B1VGST           CD Unused Sts 5
     C                     MOVEL$SABCD    B1ABCD           PD Producer Cod
     C                     MOVEL$SLKST    B1AACD           SR Source Code
     C                     MOVELWN1229    B1AAVN           RS User Changed
     C                     Z-ADDWN1230    B1AADT           RS Date Changed
     C                     Z-ADDWN1231    B1AMTM           RS Time Changed
     C                     MOVELWN1232    B1AJST           RS Record Statu
     C                     MOVELWN1233    B1AHVN           RS Job
     C                     MOVELWN1234    B1AGVN           RS Program
     C                     MOVELWN1235    B1ABVN           RS User Added
     C                     Z-ADDWN1236    B1ABDT           RS Date Added
     C                     Z-ADDWN1237    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0048  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0049  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTO    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTO    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Prt Hot Scl Upl Summ  RT - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $SH1US           Head 1 USR
     C                     Z-ADD*ZERO     $SH2US           Head 2 USR
     C                     Z-ADD*ZERO     YL0018           Gross Pay Amt T
     C                     Z-ADD*ZERO     $SB5NB           Head Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQTP01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQTP02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQTP03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQTP04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQTP05           TH Kill Date
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WQTP01           BOH Company Num
     C                     KFLD           WQTP02           BOH Buy Order N
     C                     KFLD           WQTP03           BOL Load Number
     C                     KFLD           WQTP04           TH Tattoo Numbe
     C                     KFLD           WQTP05           TH Kill Date
      * Setup key
     C                     Z-ADD$SHMNB    WQTP01           BOH Company Num
     C                     Z-ADD$SBNNB    WQTP02           BOH Buy Order N
     C                     Z-ADD$SBONB    WQTP03           BOL Load Number
     C                     Z-ADD$SCVNB    WQTP04           TH Tattoo Numbe
     C                     Z-ADD$SB0DT    WQTP05           TH Kill Date
      * Establish starting position
     C           KRSTP     SETLL@B1CPC3                    *
     C           KRSTP     READE@B1CPC3                  90*
      * Data record not found
     C   90                MOVEL'PRK0138' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CD Record Add/Del Sts is Add
     C           WAINST    IFEQ 'A'                        *IF
     C                     ADD  1         $SH2US           Head 2 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  1         $SH1US           Head 1 USR
     C                     END                             *FI
      * CASE: PAR.Payment Data Type USR is Paid Carcasses
     C           WN0968    IFEQ 'PC'                       *IF
      *
     C                     Z-ADD*ZERO     WN1238  72       CD Sort Loss
     C                     Z-ADD*ZERO     WN1239  52       CD STD Yield
     C                     Z-ADD*ZERO     WN1240  72       CD Base Carcass
     C                     Z-ADD*ZERO     WN1241  52       CD Crc Value Pe
     C                     Z-ADD*ZERO     WN1242  72       CD Base Carc Va
     C                     Z-ADD*ZERO     WN1243  72       CD Crc Value $
     C                     Z-ADD*ZERO     WN1244  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1245  72       CD Lean Premium
     C                     Z-ADD*ZERO     WN1246  52       CD Gross Value
     C                     Z-ADD*ZERO     WN1247  72       CD Gross Value
     C                     MOVEL*BLANK    WN1248  1        CD Carcass Acti
     C                     MOVEL*BLANK    WN1249  1        CD Carcass Sex
     C                     Z-ADD*ZERO     WN1250  31       CD FFLI
     C                     MOVEL*BLANK    WN1251  1        CD Record Creat
     C                     MOVEL*BLANK    WN1252  1        CD Record Creat
     C                     Z-ADD*ZERO     WN1253  50       CD LOT
     C                     MOVEL*BLANK    WN1254  1        CD User Error O
     C                     Z-ADD*ZERO     WN1255  72       CD CA Sort Loss
     C                     Z-ADD*ZERO     WN1256  52       CD CA Std Yield
     C                     Z-ADD*ZERO     WN1257  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1258  52       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1259  72       CD CA Base Carc
     C                     Z-ADD*ZERO     WN1260  72       CD CA Crc Value
     C                     Z-ADD*ZERO     WN1261  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1262  72       CD CA Lean Prem
     C                     Z-ADD*ZERO     WN1263  52       CD CA Gross Val
     C                     Z-ADD*ZERO     WN1264  72       CD CA Gross Val
     C                     MOVEL*BLANK    WN1265  3        CD Adjust/Add T
     C                     MOVEL*BLANK    WN1266  6        CD Producer Loc
     C                     Z-ADD*ZERO     WN1267  52       CD Loin Eye Inc
     C                     Z-ADD*ZERO     WN1268  52       CD Backfat Inch
     C                     Z-ADD*ZERO     WN1269  52       CD Meat Value F
     C                     Z-ADD*ZERO     WN1270  52       CD Lean Prem/Di
     C                     Z-ADD*ZERO     WN1271  52       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1272  72       CD MPR Sort Los
     C                     Z-ADD*ZERO     WN1273  72       CD Meat Value F
     C                     Z-ADD*ZERO     WN1274  72       CD Fixed Cost F
     C                     Z-ADD*ZERO     WN1275  72       CD Gross Before
     C                     Z-ADD*ZERO     WN1276  72       CD Gross Before
     C                     MOVEL*BLANK    WN1277  1        CD Broken Back
     C                     MOVEL*BLANK    WN1278  2        CD Adjust/Add S
     C                     MOVEL*BLANK    WN1279  3        CD Unused Sts 3
     C                     MOVEL*BLANK    WN1280  3        CD Unused Sts 4
     C                     MOVEL*BLANK    WN1281  6        CD Unused Sts 5
     C                     MOVEL*BLANK    WN1282 10        RS User Changed
     C                     Z-ADD*ZERO     WN1283  70       RS Date Changed
     C                     Z-ADD*ZERO     WN1284  60       RS Time Changed
     C                     MOVEL*BLANK    WN1285  1        RS Record Statu
     C                     MOVEL*BLANK    WN1286 10        RS Job
     C                     MOVEL*BLANK    WN1287 10        RS Program
     C                     MOVEL*BLANK    WN1288 10        RS User Added
     C                     Z-ADD*ZERO     WN1289  70       RS Date Added
     C                     Z-ADD*ZERO     WN1290  60       RS Time Added
      *
      * Crt Crc HotSclUpl Sum IF
      * Crt Carcass Detail    CR - Carcass Detail  * 
     C                     EXSR TQCRRC
     C                     END                             *FI
     C                     ADD  1         $SB5NB           Head Total USR
      * Accumulate Top Paid Carcasses
      * CASE: PAR.Head Total USR LE PAR.TH Head Killed
     C           $SB5NB    IFLE $SFENB                     *IF
     C                     ADD  WAAYPR    YL0018           Gross Pay Amt T
     C                     END                             *FI
     C           KRSTP     READE@B1CPC3                  90*
     C                     ENDDO
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Crt Carcass Detail    CR - Carcass Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1CPG6
     C                     Z-ADDWAHMNB    B1HMNB           BOH Company Num
     C                     Z-ADDWABNNB    B1BNNB           BOH Buy Order N
     C                     Z-ADDWABONB    B1BONB           BOL Load Number
     C                     Z-ADDWACVNB    B1CVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    B1B0DT           TH Kill Date
     C                     Z-ADDWALGNB    B1LGNB           CD Scale Sequen
     C                     Z-ADDWAEUNB    B1EUNB           CD Carcass Numb
     C                     Z-ADDWALHNB    B1LHNB           CD Carcass Numb
     C                     MOVELWAINST    B1INST           CD Record Add/D
     C                     Z-ADDWN1238    B1BEPR           CD Sort Loss
     C                     Z-ADDWN1239    B1ASPC           CD STD Yield
     C                     Z-ADDWAEWNB    B1EWNB           CD Carcass/Hot
     C                     Z-ADDWN1240    B1B4PR           CD Base Carcass
     C                     Z-ADDWN1241    B1EYNB           CD Crc Value Pe
     C                     Z-ADDWN1242    B1B1PR           CD Base Carc Va
     C                     Z-ADDWN1243    B1AVPR           CD Crc Value $
     C                     Z-ADDWAAUPC    B1AUPC           CD Lean Percent
     C                     Z-ADDWN1244    B1AWPR           CD Lean Premium
     C                     Z-ADDWN1245    B1AXPR           CD Lean Premium
     C                     Z-ADDWN1246    B1EZNB           CD Gross Value
     C                     Z-ADDWN1247    B1AYPR           CD Gross Value
     C                     Z-ADDWABBDT    B1BBDT           CD Kill Date
     C                     Z-ADDWAAKTM    B1AKTM           CD Kill Time
     C                     MOVELWAIQST    B1IQST           CD Shift
     C                     MOVELWN1248    B1EFST           CD Carcass Acti
     C                     Z-ADDWAH6NB    B1H6NB           CD Backfat Thic
     C                     Z-ADDWABEPC    B1BEPC           CD Loin-Eye Dep
     C                     Z-ADDWAGCST    B1GCST           CD Light Reflec
     C                     MOVELWAGDST    B1GDST           CD Trim Area
     C                     MOVELWN1249    B1GEST           CD Carcass Sex
     C                     Z-ADDWN1250    B1BHPC           CD FFLI
     C                     MOVELWN1251    B1IOST           CD Record Creat
     C                     MOVELWN1252    B1IPST           CD Record Creat
     C                     Z-ADDWN1253    B1LTNB           CD LOT
     C                     MOVELWN1254    B1JNST           CD User Error O
     C                     Z-ADDWAX4NB    B1X4NB           CD Backfat Thic
     C                     Z-ADDWAFNPC    B1FNPC           CD Loin-Eye Dep
     C                     Z-ADDWAFOPC    B1FOPC           CD Light Reflec
     C                     Z-ADDWAFPPC    B1FPPC           CD Lean Percent
     C                     MOVELWAK2ST    B1K2ST           CD Source Type
     C                     MOVELWAK3ST    B1K3ST           CD Payment Type
     C                     Z-ADDWN1255    B1JWPR           CD CA Sort Loss
     C                     Z-ADDWN1256    B1F5PC           CD CA Std Yield
     C                     Z-ADDWN1257    B1JXPR           CD CA Base Carc
     C                     Z-ADDWN1258    B1JYPR           CD CA Crc Value
     C                     Z-ADDWN1259    B1JZPR           CD CA Base Carc
     C                     Z-ADDWN1260    B1J0PR           CD CA Crc Value
     C                     Z-ADDWN1261    B1J1PR           CD CA Lean Prem
     C                     Z-ADDWN1262    B1J2PR           CD CA Lean Prem
     C                     Z-ADDWN1263    B1J3PR           CD CA Gross Val
     C                     Z-ADDWN1264    B1J4PR           CD CA Gross Val
     C                     MOVELWN1265    B1UTST           CD Adjust/Add T
     C                     MOVELWN1266    B1HVCD           CD Producer Loc
     C                     Z-ADDWN1267    B1DKJR           CD Loin Eye Inc
     C                     Z-ADDWN1268    B1ITJF           CD Backfat Inch
     C                     Z-ADDWN1269    B1IJGR           CD Meat Value F
     C                     Z-ADDWN1270    B1ORJE           CD Lean Prem/Di
     C                     Z-ADDWN1271    B1OTJR           CD Fixed Cost F
     C                     Z-ADDWN1272    B1PEIR           CD MPR Sort Los
     C                     Z-ADDWN1273    B1IEUF           CD Meat Value F
     C                     Z-ADDWN1274    B1ORUE           CD Fixed Cost F
     C                     Z-ADDWN1275    B1IUTR           CD Gross Before
     C                     Z-ADDWN1276    B1IJRR           CD Gross Before
     C                     MOVELWN1277    B1VCST           CD Broken Back
     C                     MOVELWN1278    B1VDST           CD Adjust/Add S
     C                     MOVELWN1279    B1VEST           CD Unused Sts 3
     C                     MOVELWN1280    B1VFST           CD Unused Sts 4
     C                     MOVELWN1281    B1VGST           CD Unused Sts 5
     C                     MOVELWAABCD    B1ABCD           PD Producer Cod
     C                     MOVELWAAACD    B1AACD           SR Source Code
     C                     MOVELWN1282    B1AAVN           RS User Changed
     C                     Z-ADDWN1283    B1AADT           RS Date Changed
     C                     Z-ADDWN1284    B1AMTM           RS Time Changed
     C                     MOVELWN1285    B1AJST           RS Record Statu
     C                     MOVELWN1286    B1AHVN           RS Job
     C                     MOVELWN1287    B1AGVN           RS Program
     C                     MOVELWN1288    B1ABVN           RS User Added
     C                     Z-ADDWN1289    B1ABDT           RS Date Added
     C                     Z-ADDWN1290    B1ABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       B1AJST           RS Record Statu
     C                     MOVEL##USR     B1ABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           B1ABDT    PARM *ZERO     WQ0050  70       *DATE
     C           B1ABTM    PARM *ZERO     WQ0051  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     B1AGVN           RS Program
     C                     MOVEL##JOB     B1AHVN           RS Job
     C           KLCRTQ    KLIST
     C                     KFLD           B1HMNB           BOH Company Num
     C                     KFLD           B1BNNB           BOH Buy Order N
     C                     KFLD           B1BONB           BOL Load Number
     C                     KFLD           B1CVNB           TH Tattoo Numbe
     C                     KFLD           B1B0DT           TH Kill Date
     C                     KFLD           B1LGNB           CD Scale Sequen
     C                     KFLD           B1EUNB           CD Carcass Numb
     C                     KFLD           B1LHNB           CD Carcass Numb
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@B1CPG6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0139' W0RTN   7
      * Send message 'Carcass Detail         EX'
     C                     MOVEL'PRK0139' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@B1CPG6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCRRC    BEGSR
      *================================================================
      * Create FOM Summary OUTF - FOM Summary OUTF  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EVCPDU
     C                     MOVEL$VABCD    EVABCD           PD Producer Cod
     C                     Z-ADD$VB0DT    EVB0DT           TH Kill Date
     C                     Z-ADD$VB4NB    EVVLCR           HS Valid Carcs
     C                     Z-ADD$VXRNB    EVEXCR           HS Excep Carcs
     C                     Z-ADD$VH5SM    EVHDTC           HS Total Carcs
     C                     Z-ADD$VHTS3    EVVARC           HS Variance
     C                     Z-ADD$VWUNB    EVFENB           TH Head Killed
      *
     C           KLCRTR    KLIST
     C                     KFLD           EVABCD           PD Producer Cod
     C                     KFLD           EVB0DT           TH Kill Date
      * Check for duplicate primary key
     C           KLCRTR    SETLL@EVCPDU                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0908' W0RTN   7
      * Send message 'FOM Summary OUTF       EX'
     C                     MOVEL'PRK0908' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C                     WRITE@EVCPDU                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     WUJVNB           Lean % Fld 1 Us
     C           1         MULT 0.469     WUJYNB           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 WUJWNB           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 WUJXNB           Lean % Fld 4 Us
      * CASE: DB1.EA Hot Weight NE WRK.Zero USR
     C           CPKJNB    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * WRK.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : WRK.Lean % Fld 1 Usr
      * +     : WRK.Lean @ Ext 4 Usr
      * x2    : WRK.Lean % Fld 2 Usr
      * *     : WRK.Lean @ Ext 1 Usr *
      * x5    : DB1.EA Hot Weight
      * -     : WRK.Lean @ Ext 4 Usr
      * x3    : WRK.Lean % Fld 3 Usr
      * *     : WRK.Lean @ Ext 2 Usr *
      * x6    : DB1.EA Backfat MM
      * +     : WRK.Lean @ Ext 4 Usr
      * x4    : WRK.Lean % Fld 4 Usr
      * *     : WRK.Lean @ Ext 3 Usr *
      * x7    : DB1.EA LoinEye MM
      * /     : WRK.Lean % Fld 5 Usr *
      * x5    : DB1.EA Hot Weight
      * *     : WRK.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           WUJYNB    MULT CPKJNB    WUJ2NB           Lean @ Ext 1 Us
     C           WUJVNB    ADD  WUJ2NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJWNB    MULT CPX6NB    WUJ3NB           Lean @ Ext 2 Us
     C                     SUB  WUJ3NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJXNB    MULT CPFQPC    WUJ4NB           Lean @ Ext 3 Us
     C                     ADD  WUJ4NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJ5NB    DIV  CPKJNB    WUJZNB           Lean % Fld 5 Us
     C           WUJZNB    MULT 100       WUJ6NB           Lean @ Ext 5 Us
     C                     Z-ADDWUJ6NB    WUJZNB           Lean % Fld 5 Us
     C                     END                             *FI
     C           WUJZNB    MULT 1         WUAKPC    H      ET Lean Percent
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0002           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0003           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0004           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0005           Hot Wgt/LghtR A
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0002           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0003           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0004           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0005           Hot Wgt/LghtR A
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0002           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0003           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0004           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0005           Hot Wgt/LghtR A
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0002           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0003           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0004           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0005           Hot Wgt/LghtR A
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $EKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0002           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0003           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0004           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0005           Hot Wgt/LghtR A
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Hot Scale Upl 2   PO
      *================================================================
     C                     MOVEL*BLANK    YL0011           Status 1
      *
     C                     MOVEL*BLANK    WN0319  2        Analysis Type U
     C                     MOVEL*BLANK    WN0320  2        Payment Data Ty
     C                     Z-ADD*ZERO     WN0321  70       Difference +/-
     C                     Z-ADD*ZERO     WN0322  30       Count USR
     C                     Z-ADD*ZERO     WN0323  70       TOT Head Kill B
     C                     Z-ADD*ZERO     WN0324  70       TOT Head Kill B
      *
      * Prt FOM Summary       PO: Mainline
     C                     EXSR B0MAIN
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     WUJVNB           Lean % Fld 1 Us
     C           1         MULT 0.469     WUJYNB           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 WUJWNB           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 WUJXNB           Lean % Fld 4 Us
      * CASE: DB1.EA Hot Weight NE WRK.Zero USR
     C           CPKJNB    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * WRK.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : WRK.Lean % Fld 1 Usr
      * +     : WRK.Lean @ Ext 4 Usr
      * x2    : WRK.Lean % Fld 2 Usr
      * *     : WRK.Lean @ Ext 1 Usr *
      * x5    : DB1.EA Hot Weight
      * -     : WRK.Lean @ Ext 4 Usr
      * x3    : WRK.Lean % Fld 3 Usr
      * *     : WRK.Lean @ Ext 2 Usr *
      * x6    : DB1.EA Backfat MM
      * +     : WRK.Lean @ Ext 4 Usr
      * x4    : WRK.Lean % Fld 4 Usr
      * *     : WRK.Lean @ Ext 3 Usr *
      * x7    : DB1.EA LoinEye MM
      * /     : WRK.Lean % Fld 5 Usr *
      * x5    : DB1.EA Hot Weight
      * *     : WRK.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           WUJYNB    MULT CPKJNB    WUJ2NB           Lean @ Ext 1 Us
     C           WUJVNB    ADD  WUJ2NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJWNB    MULT CPX6NB    WUJ3NB           Lean @ Ext 2 Us
     C                     SUB  WUJ3NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJXNB    MULT CPFQPC    WUJ4NB           Lean @ Ext 3 Us
     C                     ADD  WUJ4NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJ5NB    DIV  CPKJNB    WUJZNB           Lean % Fld 5 Us
     C           WUJZNB    MULT 100       WUJ6NB           Lean @ Ext 5 Us
     C                     Z-ADDWUJ6NB    WUJZNB           Lean % Fld 5 Us
     C                     END                             *FI
     C           WUJZNB    MULT 1         WUAKPC    H      ET Lean Percent
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         UJSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $IKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UJEXIT    ENDSR
      /EJECT
     CSR         UKSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $IKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UKEXIT    ENDSR
      /EJECT
     CSR         ULSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $IKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         ULEXIT    ENDSR
      /EJECT
     CSR         UMSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $IKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UMEXIT    ENDSR
      /EJECT
     CSR         UNSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $IKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UNEXIT    ENDSR
      /EJECT
     CSR         UOSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Hot Scale Upl 2   PO
      *================================================================
     C                     MOVEL'Y'       YL0011           Status 1
      *
     C                     MOVEL*BLANK    WN0643  2        Analysis Type U
     C                     MOVEL*BLANK    WN0644  2        Payment Data Ty
     C                     Z-ADD*ZERO     WN0645  70       Difference +/-
     C                     Z-ADD*ZERO     WN0646  30       Count USR
     C                     Z-ADD*ZERO     WN0647  70       TOT Head Kill B
     C                     Z-ADD*ZERO     WN0648  70       TOT Head Kill B
      *
      * Prt FOM Summary       PO: Mainline
     C                     EXSR C0MAIN
      *================================================================
     CSR         UOEXIT    ENDSR
      /EJECT
     CSR         UPSUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     WUJVNB           Lean % Fld 1 Us
     C           1         MULT 0.469     WUJYNB           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 WUJWNB           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 WUJXNB           Lean % Fld 4 Us
      * CASE: DB1.EA Hot Weight NE WRK.Zero USR
     C           CPKJNB    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * WRK.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : WRK.Lean % Fld 1 Usr
      * +     : WRK.Lean @ Ext 4 Usr
      * x2    : WRK.Lean % Fld 2 Usr
      * *     : WRK.Lean @ Ext 1 Usr *
      * x5    : DB1.EA Hot Weight
      * -     : WRK.Lean @ Ext 4 Usr
      * x3    : WRK.Lean % Fld 3 Usr
      * *     : WRK.Lean @ Ext 2 Usr *
      * x6    : DB1.EA Backfat MM
      * +     : WRK.Lean @ Ext 4 Usr
      * x4    : WRK.Lean % Fld 4 Usr
      * *     : WRK.Lean @ Ext 3 Usr *
      * x7    : DB1.EA LoinEye MM
      * /     : WRK.Lean % Fld 5 Usr *
      * x5    : DB1.EA Hot Weight
      * *     : WRK.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           WUJYNB    MULT CPKJNB    WUJ2NB           Lean @ Ext 1 Us
     C           WUJVNB    ADD  WUJ2NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJWNB    MULT CPX6NB    WUJ3NB           Lean @ Ext 2 Us
     C                     SUB  WUJ3NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJXNB    MULT CPFQPC    WUJ4NB           Lean @ Ext 3 Us
     C                     ADD  WUJ4NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJ5NB    DIV  CPKJNB    WUJZNB           Lean % Fld 5 Us
     C           WUJZNB    MULT 100       WUJ6NB           Lean @ Ext 5 Us
     C                     Z-ADDWUJ6NB    WUJZNB           Lean % Fld 5 Us
     C                     END                             *FI
     C           WUJZNB    MULT 1         WUAKPC    H      ET Lean Percent
      *================================================================
     CSR         UPEXIT    ENDSR
      /EJECT
     CSR         UQSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $NKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UQEXIT    ENDSR
      /EJECT
     CSR         URSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $NKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UREXIT    ENDSR
      /EJECT
     CSR         USSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $NKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         USEXIT    ENDSR
      /EJECT
     CSR         UTSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $NKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UTEXIT    ENDSR
      /EJECT
     CSR         UUSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $NKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UUEXIT    ENDSR
      /EJECT
     CSR         UVSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Hot Scale Upl 2   PO
      *================================================================
     C                     MOVEL'N'       YL0011           Status 1
      *
     C                     MOVEL*BLANK    WN0967  2        Analysis Type U
     C                     MOVEL*BLANK    WN0968  2        Payment Data Ty
     C                     Z-ADD*ZERO     WN0969  70       Difference +/-
     C                     Z-ADD*ZERO     WN0970  30       Count USR
     C                     Z-ADD*ZERO     WN0971  70       TOT Head Kill B
     C                     Z-ADD*ZERO     WN0972  70       TOT Head Kill B
      *
      * Prt FOM Summary       PO: Mainline
     C                     EXSR D0MAIN
      *================================================================
     CSR         UVEXIT    ENDSR
      /EJECT
     CSR         UWSUBR    BEGSR
      *================================================================
      * COMPUTE LEAN % Morrison Hot Scale
      *================================================================
      * Calculate Lean % per Pork Rules
      * Backfat/loin are in inches
      * 2.827
      * + (0.469 * Carcass Weight)
      * - (0.7271657 * Backfat MM)
      * + (0.3867718 * Loin Eye MM)
      * -----------------------------
      * / Carcass Weight
      * * 100
     C           1         MULT 2.827     WUJVNB           Lean % Fld 1 Us
     C           1         MULT 0.469     WUJYNB           Lean % Fld 2 Us
     C                     Z-ADD0.7271657 WUJWNB           Lean % Fld 3 Us
     C                     Z-ADD0.3867718 WUJXNB           Lean % Fld 4 Us
      * CASE: DB1.EA Hot Weight NE WRK.Zero USR
     C           CPKJNB    IFNE WUE9NB                     *IF
      * LEAN % COMPUTE
      * WRK.Lean % Fld 5 Usr =
      *    *COMPUTE (((x1 + (x2 * x5) - (x3 * x6) + (x4 * x7)) / x5 * x8
      *    ))
      * x1    : WRK.Lean % Fld 1 Usr
      * +     : WRK.Lean @ Ext 4 Usr
      * x2    : WRK.Lean % Fld 2 Usr
      * *     : WRK.Lean @ Ext 1 Usr *
      * x5    : DB1.EA Hot Weight
      * -     : WRK.Lean @ Ext 4 Usr
      * x3    : WRK.Lean % Fld 3 Usr
      * *     : WRK.Lean @ Ext 2 Usr *
      * x6    : DB1.EA Backfat MM
      * +     : WRK.Lean @ Ext 4 Usr
      * x4    : WRK.Lean % Fld 4 Usr
      * *     : WRK.Lean @ Ext 3 Usr *
      * x7    : DB1.EA LoinEye MM
      * /     : WRK.Lean % Fld 5 Usr *
      * x5    : DB1.EA Hot Weight
      * *     : WRK.Lean @ Ext 5 Usr *
      * x8    : CON.100
     C           WUJYNB    MULT CPKJNB    WUJ2NB           Lean @ Ext 1 Us
     C           WUJVNB    ADD  WUJ2NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJWNB    MULT CPX6NB    WUJ3NB           Lean @ Ext 2 Us
     C                     SUB  WUJ3NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJXNB    MULT CPFQPC    WUJ4NB           Lean @ Ext 3 Us
     C                     ADD  WUJ4NB    WUJ5NB           Lean @ Ext 4 Us
     C           WUJ5NB    DIV  CPKJNB    WUJZNB           Lean % Fld 5 Us
     C           WUJZNB    MULT 100       WUJ6NB           Lean @ Ext 5 Us
     C                     Z-ADDWUJ6NB    WUJZNB           Lean % Fld 5 Us
     C                     END                             *FI
     C           WUJZNB    MULT 1         WUAKPC    H      ET Lean Percent
      *================================================================
     CSR         UWEXIT    ENDSR
      /EJECT
     CSR         UXSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $SKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UXEXIT    ENDSR
      /EJECT
     CSR         UYSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  CPKJNB    $SKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           WUAKPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           CPKKNB    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           CPBQPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           CPBRPC    MULT CPKJNB    YL0007           Hot Wgt/Weight
     C                     ADD  YL0007    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UYEXIT    ENDSR
      /EJECT
     CSR         UZSUBR    BEGSR
      *================================================================
      * Accumulation
      *================================================================
     C                     ADD  BVAMPC    $SKGNB           Hot Weight Tot
      * Weighted accumulated Lean%
     C           BVAKPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0013           Hot Wgt/Lean %
      * Weighted accumulated Backfat
     C           BVAIPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0014           Hot Wgt/Backf A
      * Weighted accumulated Loin Eye
     C           BVAJPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0015           Hot Wgt/Loine A
      * Weighted accumulated Light Refl
     C           BVALPC    MULT BVAMPC    YL0008           Hot Wgt/Weight
     C                     ADD  YL0008    YL0016           Hot Wgt/LghtR A
      *================================================================
     CSR         UZEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt FOM Summary       PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SLRVGN
     C                     MOVELWUCRTX    WN0319           Analysis Type U
     C                     MOVELWUCRTX    WN0320           Payment Data Ty
     C                     Z-ADD*ZERO     WN0323           TOT Head Kill B
     C                     Z-ADD*ZERO     WN0324           TOT Head Kill B
     C                     MOVEL'Y'       YL0012           First Time Flag
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZCINIT    BEGSR
      *================================================================
      * Prt FOM Summary       PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SWRVGN
     C                     MOVELWUCRTX    WN0643           Analysis Type U
     C                     MOVELWUCRTX    WN0644           Payment Data Ty
     C                     Z-ADD*ZERO     WN0647           TOT Head Kill B
     C                     Z-ADD*ZERO     WN0648           TOT Head Kill B
     C                     MOVEL'Y'       YL0012           First Time Flag
      *================================================================
     CSR         ZCEXIT    ENDSR
      /EJECT
     CSR         ZDINIT    BEGSR
      *================================================================
      * Prt FOM Summary       PO: Initialise
      *================================================================
      * USER: Initialize program
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR THRVGN
     C                     MOVELWUCRTX    WN0967           Analysis Type U
     C                     MOVELWUCRTX    WN0968           Payment Data Ty
     C                     Z-ADD*ZERO     WN0971           TOT Head Kill B
     C                     Z-ADD*ZERO     WN0972           TOT Head Kill B
     C                     MOVEL'Y'       YL0012           First Time Flag
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P3T6ST           Analysis Type U
     C                     MOVEL*BLANK    P3T5ST           Payment Data Ty
     C                     Z-ADD*ZERO     P3HRCT           Head Received C
     C                     Z-ADD*ZERO     P3HRSB           Head Received S
     C                     Z-ADD*ZERO     P3HROD           Head Received O
     C                     Z-ADD*ZERO     P3HESS           Head Excep CNT
     C                     Z-ADD*ZERO     P3HSDL           Head Excep SBD
     C                     Z-ADD*ZERO     P3HDSL           Head Excep OTH
     C                     Z-ADD*ZERO     P3KDSK           Head Total CNT
     C                     Z-ADD*ZERO     P3KDKW           Head Total SBD
     C                     Z-ADD*ZERO     P3KJOW           Head Total OTH
     C                     Z-ADD*ZERO     P3KOSF           Head Diff CNT U
     C                     Z-ADD*ZERO     P3IJMB           Head Diff SBD U
     C                     Z-ADD*ZERO     P3KOIW           Head Diff OTH U
     C                     Z-ADD*ZERO     P3HKCT           Head Killed CNT
     C                     Z-ADD*ZERO     P3HKSB           Head Killed SBD
     C                     Z-ADD*ZERO     P3HKOD           Head Killed ODB
     C                     Z-ADD*ZERO     P6IINB           Difference +/-
     C                     Z-ADD*ZERO     P7P0NB           Count USR
     C                     Z-ADD*ZERO     P8O6NB           TOT Head Kill B
     C                     Z-ADD*ZERO     P9O7NB           TOT Head Kill B
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Carcass Dbw Min
     C                     Z-ADD*ZERO     WUI7NB  71
      * Define work field Carcass Dbw Max
     C                     Z-ADD*ZERO     WUI8NB  71
      * Define work field Carcass Lgt Min
     C                     Z-ADD*ZERO     WUI9NB  71
      * Define work field Carcass Lgt Max
     C                     Z-ADD*ZERO     WUJANB  71
      * Define work field %Lean High Min
     C                     Z-ADD*ZERO     WUJBNB  71
      * Define work field %Lean High Max
     C                     Z-ADD*ZERO     WUJLNB  71
      * Define work field %Lean Low Min
     C                     Z-ADD*ZERO     WUJMNB  71
      * Define work field %Lean Low Max
     C                     Z-ADD*ZERO     WUJCNB  71
      * Define work field High Yield Min
     C                     Z-ADD*ZERO     WUJDNB  71
      * Define work field High Yield Max
     C                     Z-ADD*ZERO     WUJENB  71
      * Define work field Low Yield Min
     C                     Z-ADD*ZERO     WUJFNB  71
      * Define work field Low Yield Max
     C                     Z-ADD*ZERO     WUJGNB  71
      * Define work field Head < Percent Min
     C                     Z-ADD*ZERO     WUJHNB  71
      * Define work field Head < Percent Max
     C                     Z-ADD*ZERO     WUJINB  71
      * Define work field Head > Percent Min
     C                     Z-ADD*ZERO     WUJJNB  71
      * Define work field Head > Percent Max
     C                     Z-ADD*ZERO     WUJKNB  71
      * Define work field BackFat High Min
     C                     Z-ADD*ZERO     WUK5NB  71
      * Define work field BackFat High Max
     C                     Z-ADD*ZERO     WUK6NB  71
      * Define work field BackFat Low Min
     C                     Z-ADD*ZERO     WUK7NB  71
      * Define work field Backfat Low Max
     C                     Z-ADD*ZERO     WUK8NB  71
      * Define work field LoinEye High Min
     C                     Z-ADD*ZERO     WUK9NB  71
      * Define work field LoinEye High Max
     C                     Z-ADD*ZERO     WULANB  71
      * Define work field LoinEye Low Min
     C                     Z-ADD*ZERO     WULBNB  71
      * Define work field LoinEye Low Max
     C                     Z-ADD*ZERO     WULCNB  71
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    A1HMNB           BOH Company Num
     C                     MOVEL*LOVAL    A1B0DT           TH Kill Date
     C                     MOVEL*LOVAL    A1ABCD           PD Producer Cod
     C                     MOVEL*LOVAL    A1BNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    A1BONB           BOL Load Number
     C                     MOVEL*LOVAL    A1CVNB           TH Tattoo Numbe
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Define work field ET Error Sts
     C                     MOVEL*BLANK    WUD2ST  1
      * Define work field Lean % Fld 1 Usr
     C                     Z-ADD*ZERO     WUJVNB 177
      * Define work field Lean % Fld 2 Usr
     C                     Z-ADD*ZERO     WUJYNB 177
      * Define work field Lean % Fld 3 Usr
     C                     Z-ADD*ZERO     WUJWNB 177
      * Define work field Lean % Fld 4 Usr
     C                     Z-ADD*ZERO     WUJXNB 177
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Lean @ Ext 1 Usr
     C                     Z-ADD*ZERO     WUJ2NB 177
      * Define work field Lean @ Ext 4 Usr
     C                     Z-ADD*ZERO     WUJ5NB 177
      * Define work field Lean @ Ext 2 Usr
     C                     Z-ADD*ZERO     WUJ3NB 177
      * Define work field Lean @ Ext 3 Usr
     C                     Z-ADD*ZERO     WUJ4NB 177
      * Define work field Lean % Fld 5 Usr
     C                     Z-ADD*ZERO     WUJZNB 177
      * Define work field Lean @ Ext 5 Usr
     C                     Z-ADD*ZERO     WUJ6NB 177
      * Define work field ET Lean Percent NPPC
     C                     Z-ADD*ZERO     WUAKPC  31
      * Define work field KV Error Code
     C                     MOVEL*BLANK    WUDXST  3
      * Define work field CD Shift
     C                     MOVEL*BLANK    WUIQST  1
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Display Field Usr
     C                     MOVEL*BLANK    WUHDST  4
      * Define work field Head 6
     C                     Z-ADD*ZERO     WULKIR  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WALGNB           CD Scale Sequen
     C                     Z-ADD*ZERO     WAEUNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WALHNB           CD Carcass Numb
     C                     Z-ADD*ZERO     WABEPR           CD Sort Loss
     C                     Z-ADD*ZERO     WAASPC           CD STD Yield
     C                     Z-ADD*ZERO     WAEWNB           CD Carcass/Hot
     C                     Z-ADD*ZERO     WAB4PR           CD Base Carcass
     C                     Z-ADD*ZERO     WAEYNB           CD Crc Value Pe
     C                     Z-ADD*ZERO     WAB1PR           CD Base Carc Va
     C                     Z-ADD*ZERO     WAAVPR           CD Crc Value $
     C                     Z-ADD*ZERO     WAAUPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAAWPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAAXPR           CD Lean Premium
     C                     Z-ADD*ZERO     WAEZNB           CD Gross Value
     C                     Z-ADD*ZERO     WAAYPR           CD Gross Value
     C                     Z-ADD*ZERO     WABBDT           CD Kill Date
     C                     Z-ADD*ZERO     WAAKTM           CD Kill Time
     C                     Z-ADD*ZERO     WAH6NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WABEPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAGCST           CD Light Reflec
     C                     Z-ADD*ZERO     WABHPC           CD FFLI
     C                     Z-ADD*ZERO     WALTNB           CD LOT
     C                     Z-ADD*ZERO     WAX4NB           CD Backfat Thic
     C                     Z-ADD*ZERO     WAFNPC           CD Loin-Eye Dep
     C                     Z-ADD*ZERO     WAFOPC           CD Light Reflec
     C                     Z-ADD*ZERO     WAFPPC           CD Lean Percent
     C                     Z-ADD*ZERO     WAJWPR           CD CA Sort Loss
     C                     Z-ADD*ZERO     WAF5PC           CD CA Std Yield
     C                     Z-ADD*ZERO     WAJXPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJYPR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJZPR           CD CA Base Carc
     C                     Z-ADD*ZERO     WAJ0PR           CD CA Crc Value
     C                     Z-ADD*ZERO     WAJ1PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ2PR           CD CA Lean Prem
     C                     Z-ADD*ZERO     WAJ3PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WAJ4PR           CD CA Gross Val
     C                     Z-ADD*ZERO     WADKJR           CD Loin Eye Inc
     C                     Z-ADD*ZERO     WAITJF           CD Backfat Inch
     C                     Z-ADD*ZERO     WAIJGR           CD Meat Value F
     C                     Z-ADD*ZERO     WAORJE           CD Lean Prem/Di
     C                     Z-ADD*ZERO     WAOTJR           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAPEIR           CD MPR Sort Los
     C                     Z-ADD*ZERO     WAIEUF           CD Meat Value F
     C                     Z-ADD*ZERO     WAORUE           CD Fixed Cost F
     C                     Z-ADD*ZERO     WAIUTR           CD Gross Before
     C                     Z-ADD*ZERO     WAIJRR           CD Gross Before
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WBB0DT           TH Kill Date
     C                     MOVEL*LOVAL    WBKAST           TH Source Type
     C                     MOVEL*LOVAL    WBABCD           PD Producer Cod
     C                     MOVEL*LOVAL    WBBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WBBONB           BOL Load Number
     C                     MOVEL*LOVAL    WBCVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WBB0DT           TH Kill Date
     C                     MOVEL*LOVAL    WBKAST           TH Source Type
     C                     MOVEL*LOVAL    WBABCD           PD Producer Cod
     C                     MOVEL*LOVAL    WBBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WBBONB           BOL Load Number
     C                     MOVEL*LOVAL    WBCVNB           TH Tattoo Numbe
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WBHMNB           BOH Company Num
     C                     MOVEL*LOVAL    WBB0DT           TH Kill Date
     C                     MOVEL*LOVAL    WBKAST           TH Source Type
     C                     MOVEL*LOVAL    WBABCD           PD Producer Cod
     C                     MOVEL*LOVAL    WBBNNB           BOH Buy Order N
     C                     MOVEL*LOVAL    WBBONB           BOL Load Number
     C                     MOVEL*LOVAL    WBCVNB           TH Tattoo Numbe
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     YL0002  91
      * Define local work field Hot Wgt/Backf Accum Usr
     C                     Z-ADD*ZERO     YL0003  91
      * Define local work field Hot Wgt/Loine Accum Usr
     C                     Z-ADD*ZERO     YL0004  91
      * Define local work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     YL0005  91
      * Define local work field Head No Probe USR
     C                     Z-ADD*ZERO     YL0006  50
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0007  91
      * Define local work field Hot Wgt/Weight Ext Usr
     C                     Z-ADD*ZERO     YL0008  91
      * Define local work field Gross Pay Amt Tot USR
     C                     Z-ADD*ZERO     YL0009  72
      * Define local work field *Record selected
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field Status 1
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field First Time Flag Usr
     C                     MOVEL*BLANK    YL0012  1
      * Define local work field Hot Wgt/Lean % Accum Usr
     C                     Z-ADD*ZERO     YL0013  91
      * Define local work field Hot Wgt/Backf Accum Usr
     C                     Z-ADD*ZERO     YL0014  91
      * Define local work field Hot Wgt/Loine Accum Usr
     C                     Z-ADD*ZERO     YL0015  91
      * Define local work field Hot Wgt/LghtR Accum Usr
     C                     Z-ADD*ZERO     YL0016  91
      * Define local work field Head No Probe USR
     C                     Z-ADD*ZERO     YL0017  50
      * Define local work field Gross Pay Amt Tot USR
     C                     Z-ADD*ZERO     YL0018  72
      * Define local work field *Record selected
     C                     MOVEL*BLANK    YL0019  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Mov ApplN to Co-PRINT US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP5EVTX    $ACMP
      * Rtv Validation Rules  RT - Evaluation Validation  * 
     C                     EXSR SARVGN
     C                     MOVELWUCRTX    P3T6ST           Analysis Type U
     C                     MOVELWUCRTX    P3T5ST           Payment Data Ty
     C                     Z-ADD*ZERO     P8O6NB           TOT Head Kill B
     C                     Z-ADD*ZERO     P9O7NB           TOT Head Kill B
     C                     MOVEL'Y'       YL0001           First Time Flag
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 SEABOA
