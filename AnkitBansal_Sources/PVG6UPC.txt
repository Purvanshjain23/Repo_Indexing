/***************************************************************** */
/*  PROGRAM:       PVG6UPC                                         */
/*  PROGRAM DESC:  CNV DLT PUBVCPP RCDS   CL EXECUTE USER PROGRAM  */
/*  PROGRAMMER:    DANNY NGUYEN                                    */
/*  DATE:          08/28/2024                                      */
/*  SR #:          3018961 - DELETE RECORDS FROM PUBVCPP FILE.     */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/*******************************************************************/
             PGM


             DCL        VAR(&DTALIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&DATAH) TYPE(*CHAR) LEN(10)
             DCL        VAR(&FILENAME) TYPE(*CHAR) LEN(10) +
                          VALUE('PUBVCPP')
             DCL        VAR(&SQLSTMT) TYPE(*CHAR) LEN(150) VALUE(' ')


    /* GET DATA LIBRARY */
             CALL       PGM(CAQXXFR) PARM(' ' &DTALIB &DATAH)

    /* BUILD & EXECUTE SQL DELETE STATEMENT */

             CHGVAR     VAR(&SQLSTMT) VALUE(' ')

             CHGVAR     VAR(%SST(&SQLSTMT 1 12)) VALUE('DELETE FROM ')
             CHGVAR     VAR(%SST(&SQLSTMT 13 21)) VALUE(&DTALIB +
                          *TCAT '/' *TCAT &FILENAME)
             CHGVAR     VAR(%SST(&SQLSTMT 34 14)) VALUE('WHERE BVA4TS<=')
             CHGVAR     VAR(%SST(&SQLSTMT 48 28)) +
                          VALUE('''2024-08-11-00.00.00.000000''')

             RUNSQL     SQL(&SQLSTMT) COMMIT(*NONE)


 END:        ENDPGM
