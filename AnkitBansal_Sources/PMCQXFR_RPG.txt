     H/TITLE Rtv Picked to WF&LdP  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/23/10  Time  : 08:58:04
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPBGCPLCIF  E           K        DISK
      * RSQ : PFS Inventory Adjustment  WHS/Item/PDte ShpNotP
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDMJCPL5IF  E           K        DISK
      * RSQ : Load Schdlng Pstn Key     PCW/OCW/Item/Order
      *
     FPME0CPL1IF  E           K        DISK
      * RTV : WF Item Position Balance  Retrieval index
      *
     FPDMJCPL0UF  E           K        DISK
      * UPD : Load Schdlng Pstn Key     Update index
      *
     FPME0CPL0UF  E           K        DISK
      * UPD : WF Item Position Balance  Update index
      *
     IABGCPYZ
      * PFS Inventory Adjustment  WHS/Item/PDte ShpNotP
      * Renamed input format fields
     I              BGY1NX                          WAY1NX
     I              BGC0NY                          WAC0NY
     I              BGAID8                          WAAID8
     I              BGAFTS                          WAAFTS
     I              BGBCNY                          WABCNY
     I              BGVLSX                          WAVLSX
     I              BGVMSX                          WAVMSX
     I              BGY2NX                          WAY2NX
     I              BGU4SX                          WAU4SX
     I              BGADNY                          WAADNY
     I              BGU1SX                          WAU1SX
     I              BGP7DT                          WAP7DT
     I              BGZ4NX                          WAZ4NX
     I              BGACNY                          WAACNY
     I              BGVKSX                          WAVKSX
     I              BGZ2NX                          WAZ2NX
     I              BGZ6NX                          WAZ6NX
     I              BGBDNY                          WABDNY
     I              BGABNY                          WAABNY
     I              BGBENY                          WABENY
     I              BGZ9NX                          WAZ9NX
     I              BGGBAA                          WAGBAA
     I              BGANNY                          WAANNY
     I              BGZPNX                          WAZPNX
     I              BGZXNX                          WAZXNX
     I              BGZYNX                          WAZYNX
     I              BGALNY                          WAALNY
     I              BGAGNY                          WAAGNY
     I              BGUWSX                          WAUWSX
     I              BGUXSX                          WAUXSX
     I              BGV3SX                          WAV3SX
     I              BGAHNY                          WAAHNY
     I              BGAINY                          WAAINY
     I              BGAJNY                          WAAJNY
     I              BGAKNY                          WAAKNY
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WBAIC3
     I              BZHGCD                          WBHGCD
     I              BZAVNA                          WBAVNA
     I              BZAWNA                          WBAWNA
     I              BZL7NA                          WBL7NA
     I              BZL8NA                          WBL8NA
     I              BZL6NA                          WBL6NA
     I              BZMFNA                          WBMFNA
     I              BZADCD                          WBADCD
     I              BZAWPC                          WBAWPC
     I              BZLXST                          WBLXST
     I              BZAECD                          WBAECD
     I              BZAXPC                          WBAXPC
     I              BZLYST                          WBLYST
     I              BZAFCD                          WBAFCD
     I              BZAICD                          WBAICD
     I              BZAIWG                          WBAIWG
     I              BZHICD                          WBHICD
     I              BZRBCD                          WBRBCD
     I              BZFZST                          WBFZST
     I              BZAVST                          WBAVST
     I              BZCZWG                          WBCZWG
     I              BZC0WG                          WBC0WG
     I              BZURTN                          WBURTN
     I              BZAJC8                          WBAJC8
     I              BZRINB                          WBRINB
     I              BZRHNB                          WBRHNB
     I              BZRGNB                          WBRGNB
     I              BZLNCD                          WBLNCD
     I              BZTFNB                          WBTFNB
     I              BZN0CD                          WBN0CD
     I              BZX4ST                          WBX4ST
     I              BZTMVA                          WBTMVA
     I              BZTNVA                          WBTNVA
     I              BZBLPR                          WBBLPR
     I              BZBMPR                          WBBMPR
     I              BZLRCD                          WBLRCD
     I              BZU9ST                          WBU9ST
     I              BZCMCO                          WBCMCO
     I              BZQ1CD                          WBQ1CD
     I              BZQ8CD                          WBQ8CD
     I              BZCHTM                          WBCHTM
     I              BZQZCD                          WBQZCD
     I              BZXWST                          WBXWST
     I              BZXXST                          WBXXST
     I              BZVMST                          WBVMST
     I              BZSWGH                          WBSWGH
     I              BZPPHE                          WBPPHE
     I              BZR3CD                          WBR3CD
     I              BZSDCD                          WBSDCD
     I              BZICN1                          WBICN1
     I              BZSVCD                          WBSVCD
     I              BZICN2                          WBICN2
     I              BZSWCD                          WBSWCD
     I              BZV2NB                          WBV2NB
     I              BZSXCD                          WBSXCD
     I              BZITCN                          WBITCN
     I              BZSYCD                          WBSYCD
     I              BZITC5                          WBITC5
     I              BZSZCD                          WBSZCD
     I              BZICN6                          WBICN6
     I              BZS0CD                          WBS0CD
     I              BZICN7                          WBICN7
     I              BZS1CD                          WBS1CD
     I              BZICN8                          WBICN8
     I              BZS2CD                          WBS2CD
     I              BZICN9                          WBICN9
     I              BZS3CD                          WBS3CD
     I              BZICN0                          WBICN0
     I              BZS4CD                          WBS4CD
     I              BZSFNB                          WBSFNB
     I              BZA3WG                          WBA3WG
     I              BZSJNB                          WBSJNB
     I              BZLLCD                          WBLLCD
     I              BZLMCD                          WBLMCD
     I              BZP3ST                          WBP3ST
     I              BZSKNB                          WBSKNB
     I              BZSLNB                          WBSLNB
     I              BZSMNB                          WBSMNB
     I              BZP4ST                          WBP4ST
     I              BZCFNB                          WBCFNB
     I              BZCGNB                          WBCGNB
     I              BZILNB                          WBILNB
     I              BZCHNB                          WBCHNB
     I              BZCINB                          WBCINB
     I              BZCJNB                          WBCJNB
     I              BZCMNB                          WBCMNB
     I              BZCNNB                          WBCNNB
     I              BZCRNB                          WBCRNB
     I              BZCSNB                          WBCSNB
     I              BZCVNB                          WBCVNB
     I              BZCWNB                          WBCWNB
     I              BZCXNB                          WBCXNB
     I              BZCZNB                          WBCZNB
     I              BZC0NB                          WBC0NB
     I              BZN1CD                          WBN1CD
     I              BZB4NB                          WBB4NB
     I              BZB5NB                          WBB5NB
     I              BZX5ST                          WBX5ST
     I              BZX6ST                          WBX6ST
     I              BZX7ST                          WBX7ST
     I              BZPCCT                          WBPCCT
     I              BZBDNB                          WBBDNB
     I              BZBJNB                          WBBJNB
     I              BZSUST                          WBSUST
     I              BZSVST                          WBSVST
     I              BZSYST                          WBSYST
     I              BZSZST                          WBSZST
     I              BZS1ST                          WBS1ST
     I              BZXRCD                          WBXRCD
     I              BZXTCD                          WBXTCD
     I              BZXUCD                          WBXUCD
     I              BZF5WG                          WBF5WG
     I              BZF6WG                          WBF6WG
     I              BZF7WG                          WBF7WG
     I              BZBLNB                          WBBLNB
     I              BZBNNB                          WBBNNB
     I              BZS2ST                          WBS2ST
     I              BZS4ST                          WBS4ST
     I              BZS5ST                          WBS5ST
     I              BZS6ST                          WBS6ST
     I              BZS8ST                          WBS8ST
     I              BZS9ST                          WBS9ST
     I              BZTCST                          WBTCST
     I              BZTDST                          WBTDST
     I              BZUVST                          WBUVST
     I              BZUWST                          WBUWST
     I              BZUXST                          WBUXST
     I              BZVSST                          WBVSST
     I              BZAATM                          WBAATM
     I              BZAYNA                          WBAYNA
     I              BZA0NA                          WBA0NA
     I              BZAXDT                          WBAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WCAJCD
     I              ADF8NA                          WCF8NA
     I              ADACNA                          WCACNA
     I              ADADNA                          WCADNA
     I              ADAENA                          WCAENA
     I              ADAJNA                          WCAJNA
     I              ADBTTX                          WCBTTX
     I              ADAOCD                          WCAOCD
     I              ADBGCD                          WCBGCD
     I              ADVHST                          WCVHST
     I              ADMPNA                          WCMPNA
     I              ADWPST                          WCWPST
     I              ADXUST                          WCXUST
     I              ADT0ST                          WCT0ST
     I              ADT1ST                          WCT1ST
     I              ADDBNB                          WCDBNB
     I              ADT2ST                          WCT2ST
     I              ADT3ST                          WCT3ST
     I              ADT4ST                          WCT4ST
     I              ADT6ST                          WCT6ST
     I              ADBWC3                          WCBWC3
     I              ADBTC3                          WCBTC3
     I              ADBUC3                          WCBUC3
     I              ADBVC3                          WCBVC3
     I              ADFCAA                          WCFCAA
     I              ADRQSX                          WCRQSX
     I              ADRRSX                          WCRRSX
     I              ADRSSX                          WCRSSX
     I              ADRTSX                          WCRTSX
     I              ADT7ST                          WCT7ST
     I              ADT8ST                          WCT8ST
     I              ADRNSX                          WCRNSX
     I              ADROSX                          WCROSX
     I              ADRPSX                          WCRPSX
     I              ADUVST                          WCUVST
     I              ADUWST                          WCUWST
     I              ADUXST                          WCUXST
     I              ADVSST                          WCVSST
     I              ADAATM                          WCAATM
     I              ADAYNA                          WCAYNA
     I              ADA0NA                          WCA0NA
     I              ADAXDT                          WCAXDT
      *
     I@MJCPY5
      * Load Schdlng Pstn Key     PCW/OCW/Item/Order
      * Renamed input format fields
     I              MJHGCD                          WDHGCD
     I              MJCRC3                          WDCRC3
     I              MJLRAA                          WDLRAA
     I              MJCVC3                          WDCVC3
     I              MJLVAA                          WDLVAA
     I              MJSPSQ                          WDSPSQ
     I              MJT4NB                          WDT4NB
     I              MJN5NY                          WDN5NY
     I              MJAODT                          WDAODT
     I              MJKZDT                          WDKZDT
     I              MJAXTM                          WDAXTM
     I              MJJPCD                          WDJPCD
     I              MJC4NB                          WDC4NB
     I              MJRMNB                          WDRMNB
     I              MJH1QT                          WDH1QT
     I              MJN2NY                          WDN2NY
     I              MJBZST                          WDBZST
     I              MJSUDT                          WDSUDT
     I              MJRINY                          WDRINY
     I              MJTIDT                          WDTIDT
     I              MJTJDT                          WDTJDT
     I              MJTNDT                          WDTNDT
     I              MJTODT                          WDTODT
     I              MJBMSX                          WDBMSX
     I              MJUVST                          WDUVST
     I              MJUWST                          WDUWST
     I              MJUXST                          WDUXST
     I              MJVSST                          WDVSST
     I              MJAATM                          WDAATM
     I              MJAYNA                          WDAYNA
     I              MJA0NA                          WDA0NA
     I              MJAXDT                          WDAXDT
      *
     I@MJCPVG
      * Load Schdlng Pstn Key     Update index
      * Renamed input format fields
     I              MJHGCD                          WEHGCD
     I              MJCRC3                          WECRC3
     I              MJLRAA                          WELRAA
     I              MJCVC3                          WECVC3
     I              MJLVAA                          WELVAA
     I              MJSPSQ                          WESPSQ
     I              MJT4NB                          WET4NB
     I              MJN5NY                          WEN5NY
     I              MJAODT                          WEAODT
     I              MJKZDT                          WEKZDT
     I              MJAXTM                          WEAXTM
     I              MJJPCD                          WEJPCD
     I              MJC4NB                          WEC4NB
     I              MJRMNB                          WERMNB
     I              MJH1QT                          WEH1QT
     I              MJN2NY                          WEN2NY
     I              MJBZST                          WEBZST
     I              MJSUDT                          WESUDT
     I              MJRINY                          WERINY
     I              MJTIDT                          WETIDT
     I              MJTJDT                          WETJDT
     I              MJTNDT                          WETNDT
     I              MJTODT                          WETODT
     I              MJBMSX                          WEBMSX
     I              MJUVST                          WEUVST
     I              MJUWST                          WEUWST
     I              MJUXST                          WEUXST
     I              MJVSST                          WEVSST
     I              MJAATM                          WEAATM
     I              MJAYNA                          WEAYNA
     I              MJA0NA                          WEA0NA
     I              MJAXDT                          WEAXDT
      *
     I@E0CPYX
      * WF Item Position Balance  Retrieval index
      * Renamed input format fields
     I              E0HGCD                          WFHGCD
     I              E0CSC3                          WFCSC3
     I              E0LSAA                          WFLSAA
     I              E0CTC3                          WFCTC3
     I              E0LTAA                          WFLTAA
     I              E0ELDT                          WFELDT
     I              E0PNQT                          WFPNQT
     I              E0POQT                          WFPOQT
     I              E0PPQT                          WFPPQT
     I              E0PQQT                          WFPQQT
     I              E0PRQT                          WFPRQT
     I              E0PSQT                          WFPSQT
     I              E0P3QT                          WFP3QT
     I              E0B1ST                          WFB1ST
     I              E0B2ST                          WFB2ST
     I              E0B3ST                          WFB3ST
      *
     I@E0CPYW
      * WF Item Position Balance  Update index
      * Renamed input format fields
     I              E0HGCD                          WGHGCD
     I              E0CSC3                          WGCSC3
     I              E0LSAA                          WGLSAA
     I              E0CTC3                          WGCTC3
     I              E0LTAA                          WGLTAA
     I              E0ELDT                          WGELDT
     I              E0PNQT                          WGPNQT
     I              E0POQT                          WGPOQT
     I              E0PPQT                          WGPPQT
     I              E0PQQT                          WGPQQT
     I              E0PRQT                          WGPRQT
     I              E0PSQT                          WGPSQT
     I              E0P3QT                          WGP3QT
     I              E0B1ST                          WGB1ST
     I              E0B2ST                          WGB2ST
     I              E0B3ST                          WGB3ST
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDMJ1    E DSPDMJCPL0
      * UPD : Load Schdlng Pstn Key     Update index
      * Renamed input format fields
     I              MJHGCD                          WEHGCD
     I              MJCRC3                          WECRC3
     I              MJLRAA                          WELRAA
     I              MJCVC3                          WECVC3
     I              MJLVAA                          WELVAA
     I              MJSPSQ                          WESPSQ
     I              MJT4NB                          WET4NB
     I              MJN5NY                          WEN5NY
     I              MJAODT                          WEAODT
     I              MJKZDT                          WEKZDT
     I              MJAXTM                          WEAXTM
     I              MJJPCD                          WEJPCD
     I              MJC4NB                          WEC4NB
     I              MJRMNB                          WERMNB
     I              MJH1QT                          WEH1QT
     I              MJN2NY                          WEN2NY
     I              MJBZST                          WEBZST
     I              MJSUDT                          WESUDT
     I              MJRINY                          WERINY
     I              MJTIDT                          WETIDT
     I              MJTJDT                          WETJDT
     I              MJTNDT                          WETNDT
     I              MJTODT                          WETODT
     I              MJBMSX                          WEBMSX
     I              MJUVST                          WEUVST
     I              MJUWST                          WEUWST
     I              MJUXST                          WEUXST
     I              MJVSST                          WEVSST
     I              MJAATM                          WEAATM
     I              MJAYNA                          WEAYNA
     I              MJA0NA                          WEA0NA
     I              MJAXDT                          WEAXDT
      *
     IYARDCS      DS                            110
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPME01    E DSPME0CPL0
      * UPD : WF Item Position Balance  Update index
      * Renamed input format fields
     I              E0HGCD                          WGHGCD
     I              E0CSC3                          WGCSC3
     I              E0LSAA                          WGLSAA
     I              E0CTC3                          WGCTC3
     I              E0LTAA                          WGLTAA
     I              E0ELDT                          WGELDT
     I              E0PNQT                          WGPNQT
     I              E0POQT                          WGPOQT
     I              E0PPQT                          WGPPQT
     I              E0PQQT                          WGPQQT
     I              E0PRQT                          WGPRQT
     I              E0PSQT                          WGPSQT
     I              E0P3QT                          WGP3QT
     I              E0B1ST                          WGB1ST
     I              E0B2ST                          WGB2ST
     I              E0B3ST                          WGB3ST
      *
     IYBRDCS      DS                             49
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Process Request Parms
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  PRP Warehouse Code
     I                                        3   5 P1LOAA
      * I :  PRP From Date
     I                                    P   6   90P1SVDT
      * I :  PRP To Date
     I                                    P  10  130P1SWDT
     IP2PARM      DS
      * FLD: *Arrays
      * I :  LSP Prodution Warehouse
     I                                        1   3 P2LQAA
      * I :  LSP Accounting Co
     I                                    P   4   50P2CQC3
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1LOAA    PARM           WP0002  3        PRP Warehouse C
     C           P1SVDT    PARM           WP0003  70       PRP From Date
     C           P1SWDT    PARM           WP0004  70       PRP To Date
     C           P2LQAA    PARM           WP0005  3        LSP Prodution W
     C           P2CQC3    PARM           WP0006  30       LSP Accounting
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Rtv Picked to WF&LdP  XF
     C                     MOVE P1AIC3    YL0001           PFS Company Num
      * Rtv Picked To WF&LdP  RT - PFS Inventory Adjustment  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Picked To WF&LdP  RT - PFS Inventory Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAU4SX    WQSA01           PFS Warehouse C
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Warehouse C
      * Setup key
     C                     MOVELP1LOAA    WQSA01           PFS Warehouse C
      * Establish starting position
     C           KRSSA     SETLLABGCPYZ                    *
     C           KRSSA     READEABGCPYZ                  90*
      * Data record not found
     C   90                MOVEL'USR3496' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Pass in the selection, if selection but not equal then set to no
      * selection
      * Company Item
     C                     EXSR UASUBR                     Company Item
      * If record was selected
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Calculate IPB picked, update the Load Schdlng Pstn & WF Item Post
     C                     EXSR UBSUBR                     Calculate IPB p
     C                     END                             *FI
     C           KRSSA     READEABGCPYZ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Sched Pstn Grd sts RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBHGCD           Item Code
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDWUHGCD    WBHGCD           Item Code
      * Establish starting position
     C           KRSSB     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUS2ST           Scheduling Posi
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBS2ST    WUS2ST           Scheduling Posi
     C                     GOTO SBEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WCAJCD           Warehouse Code
      * Establish starting position
     C           KRSSC     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Production Ware
     C                     Z-ADD*ZERO     WL0003           Accounting Comp
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAOCD    WL0002           Production Ware
     C                     Z-ADDWCBTC3    WL0003           Accounting Comp
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Chg LdSchdPstnPickRT - Load Schdlng Pstn Key  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0010  50       Sequence
     C                     Z-ADD*ZERO     WN0011  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0012  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0013  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0014  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0015  70       Load ID
     C                     MOVEL*BLANK    WN0016  2        Record Type
     C                     MOVEL*BLANK    WN0017  1        Record Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDCRC3    WQSD01           LSPK Accounting
     C           *LIKE     DEFN WDLRAA    WQSD02           LSPK Production
     C           *LIKE     DEFN WDCVC3    WQSD03           LSPK Order Comp
     C           *LIKE     DEFN WDLVAA    WQSD04           LSPK Order Ware
     C           *LIKE     DEFN WDHGCD    WQSD05           Item Code
     C           *LIKE     DEFN WDC4NB    WQSD06           Order Number
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           LSPK Accounting
     C                     KFLD           WQSD02           LSPK Production
     C                     KFLD           WQSD03           LSPK Order Comp
     C                     KFLD           WQSD04           LSPK Order Ware
     C                     KFLD           WQSD05           Item Code
     C                     KFLD           WQSD06           Order Number
      * Setup key
     C                     Z-ADDYL0005    WQSD01           LSPK Accounting
     C                     MOVELYL0004    WQSD02           LSPK Production
     C                     Z-ADDWAY1NX    WQSD03           LSPK Order Comp
     C                     MOVELWAU4SX    WQSD04           LSPK Order Ware
     C                     Z-ADDWAY2NX    WQSD05           Item Code
     C                     Z-ADDWAZPNX    WQSD06           Order Number
      * Establish starting position
     C           KRSSD     SETLL@MJCPY5                    *
     C           KRSSD     READE@MJCPY5                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2713' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * If a record exists in the Carisle file that does not
      * exists in the Load Sch Pos Key - From Orders then we
      * do not want these records
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WDN2NY    ADD  YL0002    YL0006           Picked to Order
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDRINY' defaulted for 'Delv Ageing Days'.
      * Field '(DB1) WDTIDT' defaulted for 'Production Ovr AgeDte Fr'.
      * Field '(DB1) WDTJDT' defaulted for 'Production Ovr AgeDte To'.
      * Field '(DB1) WDTNDT' defaulted for 'Production AgeDte Fr'.
      * Field '(DB1) WDTODT' defaulted for 'Production AgeDte To'.
      * Chg LdSchPstn - Pick  CO - Load Schdlng Pstn Key  * 
     C                     EXSR SECHRC
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@MJCPY5                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg LdSchPstn - Pick  CO - Load Schdlng Pstn Key  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0018  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0019  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0020  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0021  60       Deadline Depart
     C                     MOVEL*BLANK    WN0022  2        Event Code
     C                     Z-ADD*ZERO     WN0023  70       Order Number
     C                     Z-ADD*ZERO     WN0024  70       Load ID
     C                     Z-ADD*ZERO     WN0025  70       Scheduled Quant
     C                     MOVEL*BLANK    WN0026  1        LSPK Order Aged
     C                     Z-ADD*ZERO     WN0027  70       LSPK Production
     C                     MOVEL*BLANK    WN0028  2        Record Type
     C                     MOVEL*BLANK    WN0029  1        EDI Status 1
     C                     MOVEL*BLANK    WN0030  1        EDI Status 2
     C                     MOVEL*BLANK    WN0031  1        EDI Status 3
     C                     MOVEL*BLANK    WN0032  1        Record Status
     C                     Z-ADD*ZERO     WN0033  60       Job Time
     C                     MOVEL*BLANK    WN0034 10        User Id
     C                     MOVEL*BLANK    WN0035 10        Job Name
     C                     Z-ADD*ZERO     WN0036  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @MJCPVG
     C                     Z-ADDWDHGCD    WEHGCD           Item Code
     C                     Z-ADDWDCRC3    WECRC3           LSPK Accounting
     C                     MOVELWDLRAA    WELRAA    P      LSPK Production
     C                     Z-ADDWDCVC3    WECVC3           LSPK Order Comp
     C                     MOVELWDLVAA    WELVAA    P      LSPK Order Ware
     C                     Z-ADDWDSPSQ    WESPSQ           Sequence
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEHGCD           Item Code
     C                     KFLD           WECRC3           LSPK Accounting
     C                     KFLD           WELRAA           LSPK Production
     C                     KFLD           WECVC3           LSPK Order Comp
     C                     KFLD           WELVAA           LSPK Order Ware
     C                     KFLD           WESPSQ           Sequence
     C           KLCHSE    CHAIN@MJCPVG              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDMJCPL0'MDACP
     C                     MOVEL'@MJCPVG' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDMJ1    YARDCS
      * USER: Processing after Data read
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WEVSST           Record Status
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Move non-key fields to @MJCPVG
     C                     Z-ADDWDN5NY    WEN5NY           Process Sequenc
     C                     Z-ADDYL0006    WEN2NY           Picked to Order
     C                     Z-ADDWDRINY    WERINY           Delv Ageing Day
     C                     Z-ADDWDTIDT    WETIDT           Production Ovr
     C                     Z-ADDWDTJDT    WETJDT           Production Ovr
     C                     Z-ADDWDTNDT    WETNDT           Production AgeD
     C                     Z-ADDWDTODT    WETODT           Production AgeD
      *
      * Set PGM.*Record Data Changed flag
     C           QPDMJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@MJCPVG                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDMJCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv/Chg WF - Picked   RT - WF Item Position Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFHGCD           Item Code
     C                     KFLD           WFCSC3           IPB Accounting
     C                     KFLD           WFLSAA           IPB Production
     C                     KFLD           WFCTC3           IPB Order Compa
     C                     KFLD           WFLTAA           IPB Order Wareh
     C                     KFLD           WFELDT           Production Date
      * Setup key
     C                     Z-ADDWAY2NX    WFHGCD           Item Code
     C                     Z-ADDP2CQC3    WFCSC3           IPB Accounting
     C                     MOVELP2LQAA    WFLSAA           IPB Production
     C                     Z-ADDWAY1NX    WFCTC3           IPB Order Compa
     C                     MOVELWAU4SX    WFLTAA           IPB Order Wareh
     C                     Z-ADDYL0003    WFELDT           Production Date
      * Establish starting position
     C           KRSSF     CHAIN@E0CPYX              90    *
      * Data record not found
     C   90                MOVEL'USR4090' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C           WFPOQT    ADD  YL0002    YL0007           Picked Inventor
      * Chg WF ItmPos - PickedCO - WF Item Position Balance  * 
     C                     EXSR SGCHRC
     C                     GOTO SFEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Chg WF ItmPos - PickedCO - WF Item Position Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0037  70       IPB Quantity On
     C                     Z-ADD*ZERO     WN0038  70       IPB Start Posit
     C                     Z-ADD*ZERO     WN0039  70       IPB New Current
     C                     MOVEL*BLANK    WN0040  1        IPB UnUsed Stat
     C                     MOVEL*BLANK    WN0041  1        IPB UnUsed Stat
     C                     MOVEL*BLANK    WN0042  1        IPB UnUsed Stat
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @E0CPYW
     C                     Z-ADDWFHGCD    WGHGCD           Item Code
     C                     Z-ADDWFCSC3    WGCSC3           IPB Accounting
     C                     MOVELWFLSAA    WGLSAA    P      IPB Production
     C                     Z-ADDWFCTC3    WGCTC3           IPB Order Compa
     C                     MOVELWFLTAA    WGLTAA    P      IPB Order Wareh
     C                     Z-ADDWFELDT    WGELDT           Production Date
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGCSC3           IPB Accounting
     C                     KFLD           WGLSAA           IPB Production
     C                     KFLD           WGCTC3           IPB Order Compa
     C                     KFLD           WGLTAA           IPB Order Wareh
     C                     KFLD           WGELDT           Production Date
     C           KLCHSG    CHAIN@E0CPYW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PME0CPL0'MDACP
     C                     MOVEL'@E0CPYW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPME01    YBRDCS
      * Move non-key fields to @E0CPYW
     C                     Z-ADDYL0007    WGPOQT           IPB Picked
     C                     Z-ADD*ZERO     WGPQQT           IPB Allocated S
     C                     Z-ADD*ZERO     WGPRQT           IPB Allocated P
     C                     Z-ADD*ZERO     WGPSQT           IPB Total Used
      *
      * Set PGM.*Record Data Changed flag
     C           QPME01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C           WGPNQT    SUB  WGPOQT    WGPPQT           IPB Start Posit
     C                     Z-ADDWGPPQT    WGP3QT           IPB New Current
      * Set PGM.*Record Data Changed flag
     C           QPME01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@E0CPYW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPME0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Company Item
      *================================================================
      * Item Code or Warehouse break: Rtv Scheduling Position Grade Sts
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.PFS Item Code NE WRK.Item Code
      *   |- c2    : DB1.PFS Warehouse Code NE WRK.Warehouse Code
      *   '-
     C           WAY2NX    IFNE WUHGCD                     *IF
     C           WAU4SX    ORNE WUAJCD                     *OR
     C                     MOVE WAY2NX    WUHGCD           Item Code
     C                     MOVELWAU4SX    WUAJCD           Warehouse Code
      * Rtv Sched Pstn Grd sts RT - Company Item  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * Scheduling Position Grade From the company item must = Y
      * CASE: WRK.Scheduling Position Grade is Yes
     C           WUS2ST    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Calculate IPB picked, update the Load Schdlng Pstn & WF Item Pos
      *================================================================
     C                     Z-ADD*ZERO     YL0002           IPB Picked
      * Ipb picked
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.PFS Transaction Type is SM: Ship Regular Order
      *   |- c2    : DB1.PFS Transaction Type is SM: Transfer Order
      *   '-
     C           WAVLSX    IFEQ 'S01'                      *IF
     C           WAVLSX    OREQ 'S02'                      *OR
     C                     ADD  WABDNY    YL0002           IPB Picked
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WABDNY    YL0002           IPB Picked
     C                     END                             *FI
      * CONVERT DATE FROM 20081012 WHICH IS THE sample goin to 1081012
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0001  40       Year Code
     C                     Z-ADD*ZERO     WN0002  20       Month
     C                     Z-ADD*ZERO     WN0003  20       Day of Month US
     C                     MOVEL*BLANK    WN0004  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0005  2        Month (Char) US
     C                     MOVEL*BLANK    WN0006  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0007  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0008  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0009  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAP7DT    DIV  10000     WN0001           Year Code
     C                     Z-ADDWN0001    WN0007           Year  NBR USR
     C                     MOVELWN0007    WN0008           Year  (Char) US
      * ** MONTH **
     C           WAP7DT    DIV  100       WN0002           Month
     C                     MOVELWN0002    WN0005           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAP7DT    WN0003           Day of Month US
     C                     MOVELWN0003    WN0006           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0001    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0008:ZQ WN0009    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0008:ZQ WN0009    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0009    CAT  WN0005:ZQ WN0009    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0009    CAT  WN0006:ZQ WN0009    P      Date (Alpha) US
     C                     MOVE WN0009    YL0003           Date
      * DUE to the fact that the orders and balance have already
      * created the LOAD SCHDLNG PSTN KEY, these are the only
      * records that will be updated.
      * This next step is to change the Load Sch Psn Key with the
      * pick information, IF A RECORD WAS NOT FOUND THEN
      * Do not create the pick record  -- these records will not be used
      * Rtv Productin Whs     RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELWAU4SX    WL0001    P      Warehouse Code
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0004    P      Production Ware
     C                     Z-ADDWL0003    YL0005           Accounting Comp
      * Rtv/Chg LdSchdPstnPickRT - Load Schdlng Pstn Key  * 
     C                     EXSR SDRVGN
      * If no records from the orders in the LOAS SCHDLNG PSTN KEY
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Rtv/Chg WF - Picked   RT - WF Item Position Balance  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAC0NY           PFS Inv Adj Seq
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WAADNY           PFS Location Co
     C                     Z-ADD*ZERO     WAP7DT           PFS Production
     C                     Z-ADD*ZERO     WAZ4NX           PFS Label Date
     C                     Z-ADD*ZERO     WAACNY           PFS Receive/Loc
     C                     Z-ADD*ZERO     WAZ2NX           PFS Serial Numb
     C                     Z-ADD*ZERO     WAZ6NX           PFS Tracking Ty
     C                     Z-ADD*ZERO     WABDNY           PFS Transaction
     C                     Z-ADD*ZERO     WAABNY           PFS Transaction
     C                     Z-ADD*ZERO     WABENY           PFS Transaction
     C                     Z-ADD*ZERO     WAZ9NX           PFS Total Tare
     C                     Z-ADD*ZERO     WAANNY           PFS To Location
     C                     Z-ADD*ZERO     WAZPNX           PFS Order Numbe
     C                     Z-ADD*ZERO     WAZXNX           PFS Order Line
     C                     Z-ADD*ZERO     WAZYNX           PFS Substitutio
     C                     Z-ADD*ZERO     WAALNY           PFS Co-Pack Lot
     C                     Z-ADD*ZERO     WAAGNY           PFS Pallet Numb
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
      * Define work field Item Code
     C                     Z-ADD*ZERO     WUHGCD  70
      * Define work field Warehouse Code
     C                     MOVEL*BLANK    WUAJCD  3
      * Define work field Scheduling Position Grade
     C                     MOVEL*BLANK    WUS2ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WBAIWG           Unit Weight
     C                     Z-ADD*ZERO     WBCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WBC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WBURTN           Number Cases On
     C                     Z-ADD*ZERO     WBAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBTFNB           Transportation
     C                     Z-ADD*ZERO     WBTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WBTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WBBLPR           Market Overage
     C                     Z-ADD*ZERO     WBBMPR           Standard Overag
     C                     Z-ADD*ZERO     WBCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WBCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WBSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WBPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WBICN1           Item Category N
     C                     Z-ADD*ZERO     WBICN2           Item Category N
     C                     Z-ADD*ZERO     WBV2NB           Item Category N
     C                     Z-ADD*ZERO     WBITCN           Item Category N
     C                     Z-ADD*ZERO     WBITC5           Item Category N
     C                     Z-ADD*ZERO     WBICN6           Item Category N
     C                     Z-ADD*ZERO     WBICN7           Item Category N
     C                     Z-ADD*ZERO     WBICN8           Item Category N
     C                     Z-ADD*ZERO     WBICN9           Item Category N
     C                     Z-ADD*ZERO     WBICN0           Item Category N
     C                     Z-ADD*ZERO     WBSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WBA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WBSJNB           Production Lead
     C                     Z-ADD*ZERO     WBSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WBSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WBSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WBCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WBCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WBILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WBCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WBCINB           PM Batch Size
     C                     Z-ADD*ZERO     WBCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WBCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WBCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WBCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WBCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WBCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WBCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WBCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WBCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WBC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WBB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WBB5NB           PM Line Number
     C                     Z-ADD*ZERO     WBBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WBBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WBF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WBF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WBF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WBBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WBBNNB           Production Qty
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WCBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WCBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WCBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHGCD           Item Code
     C                     Z-ADD*ZERO     WDCRC3           LSPK Accounting
     C                     Z-ADD*ZERO     WDCVC3           LSPK Order Comp
     C                     Z-ADD*ZERO     WDSPSQ           Sequence
     C                     Z-ADD*ZERO     WDT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WDN5NY           Process Sequenc
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDH1QT           Scheduled Quant
     C                     Z-ADD*ZERO     WDN2NY           Picked to Order
     C                     Z-ADD*ZERO     WDSUDT           LSPK Production
     C                     Z-ADD*ZERO     WDRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WDTIDT           Production Ovr
     C                     Z-ADD*ZERO     WDTJDT           Production Ovr
     C                     Z-ADD*ZERO     WDTNDT           Production AgeD
     C                     Z-ADD*ZERO     WDTODT           Production AgeD
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFCSC3           IPB Accounting
     C                     Z-ADD*ZERO     WFCTC3           IPB Order Compa
     C                     Z-ADD*ZERO     WFELDT           Production Date
     C                     Z-ADD*ZERO     WFPNQT           IPB Quantity On
     C                     Z-ADD*ZERO     WFPOQT           IPB Picked
     C                     Z-ADD*ZERO     WFPPQT           IPB Start Posit
     C                     Z-ADD*ZERO     WFPQQT           IPB Allocated S
     C                     Z-ADD*ZERO     WFPRQT           IPB Allocated P
     C                     Z-ADD*ZERO     WFPSQT           IPB Total Used
     C                     Z-ADD*ZERO     WFP3QT           IPB New Current
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  30
      * Define local work field PFS Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field IPB Picked
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Production Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Production Warehouse Code
     C                     MOVEL*BLANK    YL0004  3
      * Define local work field Accounting Company
     C                     Z-ADD*ZERO     YL0005  30
      * Define local work field Picked to Order
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Picked Inventory
     C                     Z-ADD*ZERO     YL0007  70
      *================================================================
     CSR         ZZEXIT    ENDSR
