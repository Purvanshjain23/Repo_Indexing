     H/TITLE Pmt Prt Crc Sum,Dtlts2PV  Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Prompt & validate record
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 01:30:45
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPLKBPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Pmt Prt Crc Sum,Dtlts2PV  Prompt & validate record
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKA1CPLSIF  E           K        DISK
      * RSQ : Tattoo Header             Co/VchrDt/Sr type/Vchr/T
      *
      * Days in month for date validation
     E                    @XD    12  12  2 0
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 022  5 0A
     E                    W0END   7 022  5 0A
     E                    W0NAM   7 022 10
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@ACREAI
      * Producer                  Retrieval index
      * Renamed input format fields
     I              ACABCD                          WAABCD
     I              ACAGTX                          WAAGTX
     I              ACALNB                          WAALNB
     I              ACAATH                          WAAATH
     I              ACAMNB                          WAAMNB
     I              ACIWST                          WAIWST
     I              ACAPST                          WAAPST
     I              ACGCNB                          WAGCNB
     I              ACGJNB                          WAGJNB
     I              ACC2TX                          WAC2TX
     I              ACAACD                          WAAACD
     I              ACACCD                          WAACCD
     I              ACADCD                          WAADCD
     I              ACAAVN                          WAAAVN
     I              ACAADT                          WAAADT
     I              ACAMTM                          WAAMTM
     I              ACAJST                          WAAJST
     I              ACAHVN                          WAAHVN
     I              ACAGVN                          WAAGVN
     I              ACABVN                          WAABVN
     I              ACABDT                          WAABDT
     I              ACABTM                          WAABTM
      *
     I@AAREAC
      * Source                    Retrieval index
      * Renamed input format fields
     I              AAAACD                          WBAACD
     I              AAAFTX                          WBAFTX
     I              AAIXST                          WBIXST
     I              AACYSS                          WBCYSS
     I              AACZSS                          WBCZSS
     I              AAC0SS                          WBC0SS
     I              AAC1SS                          WBC1SS
     I              AAAAVN                          WBAAVN
     I              AAAADT                          WBAADT
     I              AAAMTM                          WBAMTM
     I              AAAJST                          WBAJST
     I              AAAHVN                          WBAHVN
     I              AAAGVN                          WBAGVN
     I              AAABVN                          WBABVN
     I              AAABDT                          WBABDT
     I              AAABTM                          WBABTM
      *
     I@A1CPQE
      * Tattoo Header             Co/VchrDt/Sr type/Vchr/T
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXTCK        DS
      * Time: hours, minutes, seconds
     I                                        1   60XTTIM
     I                                        1   20XTHH
     I                                        3   40XTNN
     I                                        5   60XTSS
      /EJECT
     IXDOFF       DS
      * Cut-off year
     I                                        1   40XOFF
     I                                        3   40XOFFYY
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  SR Type
     I                                        1   1 P1IXST
     IP2PARM      DS
      * FLD: *Arrays
      * N : MAP Oms Warehouse Code
     I                                        1   3 P2J8NB
      * N : MAP CC Company Number
     I                                    P   4   50P2HONB
      * N : MAP Oms SalesPerson Code
     I                                        6   8 P2C8CD
      * N : MAP Oms Allow Multi-Company
     I                                        9   9 P2G8ST
      * N : MAP Oms Default Printer
     I                                       10  19 P2G9ST
      * N : MAP Oms Name
     I                                       20  49 P2EUTX
      * N : MAP Oms System Value Alpha
     I                                       50  89 P2EVTX
      * N : MAP Oms Access Denied (Y/N)
     I                                       90  90 P2HAST
     IP3PARM      DS
      * FLD: *Arrays
      * N : MAP PRT Description
     I                                        1  25 P3ETTX
      * N : MAP PRT Printer Device
     I                                       26  35 P3ACVN
      * N : MAP PRT Hold Output Sts
     I                                       36  39 P3AKST
      * N : MAP PRT Save Output Sts
     I                                       40  43 P3AMST
      * N : MAP PRT Copies
     I                                       44  450P3AKNB
      * N : MAP PRT Night Queue Run Sts
     I                                       46  46 P3ALST
      * N : MAP PRT Night Queue
     I                                       47  56 P3AIVN
      * N : MAP Oms Application Code
     I                                       57  62 P3C7CD
     IP4PARM      DS
      * N :  Display Field Usr
     I                                        1   4 P4HDST
     IP5PARM      DS
      * N :  Date From USR
     I                                    P   1   40P5B3DT
     IP6PARM      DS
      * N :  Date To   USR
     I                                    P   1   40P6B4DT
     IP7PARM      DS
      * N :  Job Name
     I                                        1  10 P7ANVN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'SBM Prt Sel Crc Sum,Dtl'
      * Company Number Alpha Usr
     I                                        1   3 ZA0001
      * Tattoo Nbr Alpha Usr
     I                                        4   8 ZA0002
      * Date Alpha USR
     I                                        9  15 ZA0003
      * PD Producer Code
     I                                       16  21 ZA0004
      * SR Type
     I                                       22  22 ZA0005
      * @Status Detail/Summary
     I                                       23  23 ZA0006
      * TH Payment Type
     I                                       24  24 ZA0007
      * Form Type             USR
     I                                       25  27 ZA0008
      * Print Carcass Analysis Us
     I                                       28  28 ZA0009
      * Ignore Fax Y/N
     I                                       29  29 ZA0010
      * Status 3
     I                                       30  30 ZA0011
      * Ignore Email Y/N User
     I                                       31  31 ZA0012
      * Oms System Value Alpha
     I                                       32  71 ZA0013
      * PRT Printer Device
     I                                       72  81 ZA0014
      * PRT Hold Output Sts
     I                                       82  85 ZA0015
      * PRT Save Output Sts
     I                                       86  89 ZA0016
      * PRT Copies
     I                                    P  90  910ZA0017
      * PRT Night Queue
     I                                       92 101 ZA0018
      * Job Name
     I                                      102 111 ZA0019
      * Message data for 'TST Prt Sel Crc Sum,Dtl'
      * Company Number Alpha Usr
     I                                        1   3 ZA0020
      * Tattoo Nbr Alpha Usr
     I                                        4   8 ZA0021
      * Date Alpha USR
     I                                        9  15 ZA0022
      * PD Producer Code
     I                                       16  21 ZA0023
      * SR Type
     I                                       22  22 ZA0024
      * @Status Detail/Summary
     I                                       23  23 ZA0025
      * TH Payment Type
     I                                       24  24 ZA0026
      * Form Type             USR
     I                                       25  27 ZA0027
      * Print Carcass Analysis Us
     I                                       28  28 ZA0028
      * Ignore Fax Y/N
     I                                       29  29 ZA0029
      * Status 3
     I                                       30  30 ZA0030
      * Ignore Email Y/N User
     I                                       31  31 ZA0031
      * Oms System Value Alpha
     I                                       32  71 ZA0032
      * PRT Printer Device
     I                                       72  81 ZA0033
      * PRT Hold Output Sts
     I                                       82  85 ZA0034
      * PRT Save Output Sts
     I                                       86  89 ZA0035
      * PRT Copies
     I                                    P  90  910ZA0036
      * PRT Night Queue
     I                                       92 101 ZA0037
      * Job Name
     I                                      102 111 ZA0038
      * Message data for 'Invalid Company Number'
      * CC Company Number
     I                                    P   1   20ZA0039
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1IXST    PARM           WP0001  1        SR Type
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Enable PUTOVR
     C                     SETON                     86
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
     C           YPMTFD    IFEQ *BLANKS
      * USER: Process command keys
      * Select Producer
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.*CMD key is *Prompt
      *   |- c2    : PGM.*Cursor field <IS> DTL.PD Producer Code
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           *IN04     IFEQ '1'                        *IF
     C           W0CFL     IFEQ '#DABCD'                   *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Sel Producer          SR - Producer  * 
     C                     CALL 'PKA1SRR'              90  Sel Producer
     C                     PARM *BLANK    W0RTN   7
     C           #DABCD    PARM #DABCD    WQ0001  6        PD Producer Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKA1SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9941  *
     C                     END
     C                     END                             *FI
      * Display Date To
      * CASE: DTL.*CMD key is CF08
     C           *IN08     IFEQ '1'                        *IF
      * CASE: PAR.Display Field Usr is *Yes
     C           P4HDST    IFEQ '*YES'                     *IF
     C                     MOVEL*BLANK    P4HDST           Display Field U
     C                     MOVEL'*NO'     P4HDST           Display Field U
     C                     ELSE
      * CASE: PAR.Display Field Usr is *No
     C           P4HDST    IFEQ '*NO'                      *IF
     C                     MOVEL'*YES'    P4HDST           Display Field U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * USER: User defined action
     C                     MOVEL'N'       P3ALST           PRT Night Queue
      * Pmt Print Options     XF - STR Order Management Sys  * 
     C                     CALL 'PDG0PVR'              90  Pmt Print Optio
     C                     PARM *BLANK    W0RTN   7
     C                     PARM @CN,001   WQ0002 25        PRT Description
     C           P3ACVN    PARM P3ACVN    WQ0003 10        PRT Printer Dev
     C           P3AKST    PARM P3AKST    WQ0004  4        PRT Hold Output
     C           P3AMST    PARM P3AMST    WQ0005  4        PRT Save Output
     C           P3AKNB    PARM P3AKNB    WQ0006  20       PRT Copies
     C           P3ALST    PARM P3ALST    WQ0007  1        PRT Night Queue
     C           P3AIVN    PARM P3AIVN    WQ0008 10        PRT Night Queue
     C                     PARM 'P/S'     WQ0009  6        Oms Application
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDG0PVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    WUC3CD           Company Number
     C                     MOVEL#1HONB    WUC3CD           Company Number
     C                     MOVEL*BLANK    WUDDCD           Tattoo Nbr Alph
     C                     MOVEL#DCVNB    WUDDCD           Tattoo Nbr Alph
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVEL#DBYDT    WUCZCD           Date Alpha USR
     C                     MOVEL'Y'       WUPQST           Ignore Fax Y/N
     C                     MOVEL'Y'       WUBSSS           Ignore Email Y/
      * Disregard the fax request on this submit.  Print only.
     C                     EXSR UASUBR                     Disregard the f
      * Submit again to FAX if ignore is NO or email if ignore is no
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.Ignore Fax Y/N is No
      *   |- c2    : DTL.Ignore Email Y/N User is No
      *   '-
     C           #DPQST    IFEQ 'N'                        *IF
     C           #DBSSS    OREQ 'N'                        *OR
      * Setup message data for message
     C                     MOVELWUC3CD    ZA0020           Company Number
     C                     MOVELWUDDCD    ZA0021           Tattoo Nbr Alph
     C                     MOVELWUCZCD    ZA0022           Date Alpha USR
     C                     MOVEL#DABCD    ZA0023           PD Producer Cod
     C                     MOVEL#DIXST    ZA0024           SR Type
     C                     MOVEL#DKMST    ZA0025           @Status Detail/
     C                     MOVEL#DJ9ST    ZA0026           TH Payment Type
     C                     MOVEL#DMDST    ZA0027           Form Type
     C                     MOVEL#DMVST    ZA0028           Print Carcass A
     C                     MOVEL#DPQST    ZA0029           Ignore Fax Y/N
     C                     MOVEL#DSVST    ZA0030           Status 3
     C                     MOVEL#DBSSS    ZA0031           Ignore Email Y/
     C                     MOVEL#PEVTX    ZA0032           Oms System Valu
     C                     MOVELP3ACVN    ZA0033           PRT Printer Dev
     C                     MOVELP3AKST    ZA0034           PRT Hold Output
     C                     MOVELP3AMST    ZA0035           PRT Save Output
     C                     Z-ADDP3AKNB    ZA0036           PRT Copies
     C                     MOVELP3AIVN    ZA0037           PRT Night Queue
     C                     MOVEL@CN,002   ZA0038           Job Name
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK1177' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     994140*
     C                     SETON                     344335*
     C                     SETON                     363739*
     C                     SETON                     38    *
     C                     END
      *
     C                     END                             *FI
      * Initialize for Repeat Prompt.
      * CASE: PAR.SR Type is Internal
     C           P1IXST    IFEQ 'I'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCRTX    #DIXST           SR Type
     C                     MOVELWUCRTX    #DEETX           Int/External De
     C                     END                             *FI
     C                     MOVELWUCRTX    #DABCD           PD Producer Cod
     C                     MOVELWUCRTX    #DAGTX           PD Name
     C                     Z-ADD*ZERO     #DCVNB           TH Tattoo Numbe
     C                     MOVELWUIXTX    #DJ9ST           TH Payment Type
     C                     Z-ADD*ZERO     #DB4DT           Date To   USR
     C                     END                             *FI
      * Request new transaction
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Validate TH Voucher Payment Date
      * External date
     C                     Z-ADDVDBYDT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     Z-ADDXDINDT    #DBYDT
      * Validate Date To   USR
      * External date
     C                     Z-ADDVDB4DT    XDEXDT
      * Check date
     C                     EXSR XDCK2
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9933  *
     C                     END
     C                     Z-ADDXDINDT    #DB4DT
      * Validate @Status Detail/Summary
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DKMST'  IFEQ YPMTFD
      * @Status Detail/Summary
     C                     MOVEL#DKMST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHKMST
     C                     SELEC
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD1         ZHKMST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHKMST
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD3         ZHKMST
     C                     ENDSL
     C                     EXFMTZGKMST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHKMST    WHEQ 1
     C                     MOVEL'D'       W0INVL           D
     C           ZHKMST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C           ZHKMST    WHEQ 3
     C                     MOVEL'B'       W0INVL           B
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DKMST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Form Type             USR
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DMDST'  IFEQ YPMTFD
      * Form Type             USR
     C                     MOVEL#DMDST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHMDST
     C                     SELEC
     C           W0INVL    WHEQ 'PRD'                      PRD
     C                     Z-ADD1         ZHMDST
     C                     ENDSL
     C                     EXFMTZGMDST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHMDST    WHEQ 1
     C                     MOVEL'PRD'     W0INVL           PRD
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DMDST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Print Carcass Analysis Us
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DMVST'  IFEQ YPMTFD
      * Print Carcass Analysis Us
     C                     MOVEL#DMVST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHMVST
     C                     SELEC
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD1         ZHMVST
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD2         ZHMVST
     C           W0INVL    WHEQ 'B'                        B
     C                     Z-ADD3         ZHMVST
     C                     ENDSL
     C                     EXFMTZGMVST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHMVST    WHEQ 1
     C                     MOVEL'Y'       W0INVL           Y
     C           ZHMVST    WHEQ 2
     C                     MOVEL'N'       W0INVL           N
     C           ZHMVST    WHEQ 3
     C                     MOVEL'B'       W0INVL           B
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DMVST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Ignore Fax Y/N
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DPQST'  IFEQ YPMTFD
      * Ignore Fax Y/N
     C                     MOVEL#DPQST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHPQST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHPQST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHPQST
     C                     ENDSL
     C                     EXFMTZGPQST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHPQST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHPQST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DPQST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate Ignore Email Y/N User
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DBSSS    W0NSRQ  1        Ignore Email Y/
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#DBSSS'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100042   Y2LSNO  70
     C           #DBSSS    PARM #DBSSS    W0EXVL 25        Ignore Email Y/
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
      * Validate Status 3
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSVST'  IFEQ YPMTFD
      * Status 3
     C                     MOVEL#DSVST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHSVST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHSVST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHSVST
     C                     ENDSL
     C                     EXFMTZGSVST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHSVST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHSVST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSVST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate SR Type
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DIXST'  IFEQ YPMTFD
      * SR Type
     C                     MOVEL#DIXST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHIXST
     C                     SELEC
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD1         ZHIXST
     C           W0INVL    WHEQ 'I'                        I
     C                     Z-ADD2         ZHIXST
     C                     ENDSL
     C                     EXFMTZGIXST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHIXST    WHEQ 1
     C                     MOVEL'E'       W0INVL           E
     C           ZHIXST    WHEQ 2
     C                     MOVEL'I'       W0INVL           I
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DIXST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate TH Payment Type
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL#DJ9ST    W0NSRQ  1        TH Payment Type
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           '#DJ9ST'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70
     C           #DJ9ST    PARM #DJ9ST    W0EXVL 25        TH Payment Type
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * CASE: DTL.TH Voucher Payment Date is Zero
     C           #DBYDT    IFEQ *ZERO                      *IF
      * Send message 'Voucher payment date req.'
     C                     MOVEL'PRK0488' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
      * DTL.Payment type Desc Usr 16 = Condition name of DTL.TH Payment T
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100717   Y2LSNO  70       List number
     C                     PARM #DJ9ST    W0INVL 25        TH Payment Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DITTX    PARM           W0CNNM 25        Payment type De
      *
      * Producer
      * CASE: DTL.PD Producer Code is Blank
     C           #DABCD    IFEQ *BLANK                     *IF
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Producer Nm, Srce RT - Producer  * 
     C                     EXSR SARVGN
      * CASE: DTL.PD Name EQ WRK.Blank USR
     C           #DAGTX    IFEQ WUCRTX                     *IF
      * Send message 'Producer               NF'
     C                     MOVEL'PRK0009' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * If user restricted to Internal producers only
      * CASE: PAR.SR Type is Internal
     C           P1IXST    IFEQ 'I'                        *IF
      * Rtv Source Type       RT - Source  * 
     C                     EXSR SBRVGN
      * CASE: WRK.SR Type is Internal
     C           WUIXST    IFEQ 'I'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Send message 'Not authorized to prdcr'
     C                     MOVEL'PRK0541' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Validate Formtype - for Summary report only
      * CASE: DTL.@Status Detail/Summary is Summary or both
     C           #DKMST    IFEQ 'B'                        *IF
     C           #DKMST    OREQ 'S'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWUCRTX    #DMDST           Form Type
     C                     MOVELWUCRTX    #DJ7TX           Form Type Desc
     C                     END                             *FI
      * Verify user selections against the tattoo header.
     C                     MOVEL*BLANK    WUK4ST           @Status Carc NF
     C                     MOVEL'N'       WUK7ST           @Status Srce NF
     C                     MOVEL'N'       WUK6ST           @Status Prod NF
     C                     MOVEL'N'       WUK5ST           @Status Ttt  NF
     C                     MOVEL'N'       WUL5ST           @status Tt/S  N
      * Rtv Pmt Prt Crc Dt,Sm RT - Tattoo Header  * 
     C                     EXSR SCRVGN
      * CASE: WRK.@Status Srce NF Y/N   USR is Yes
     C           WUK7ST    IFEQ 'Y'                        *IF
      * Send message 'Carcass Detail NF f/srce'
     C                     MOVEL'PRK0485' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: WRK.@Status Prod NF Y/N   USR is Yes
     C           WUK6ST    IFEQ 'Y'                        *IF
      * Send message 'Carcass Detail NF f/prod'
     C                     MOVEL'PRK0486' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: WRK.@Status Ttt  NF Y/N   USR is Yes
     C           WUK5ST    IFEQ 'Y'                        *IF
      * Send message 'Carcass Detail NF f/Ttt'
     C                     MOVEL'PRK0487' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.@status Tt/S  NF      USR is Yes
     C           WUL5ST    IFEQ 'Y'                        *IF
      * Send message 'Not authorized to tattoo'
     C                     MOVEL'PRK0542' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.@Status Carc NF Y/N   USR is Yes
     C           WUK4ST    IFEQ 'Y'                        *IF
      * Send message 'Carcass Detail NF f/date'
     C                     MOVEL'PRK0484' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Screen function fields
      * DTL.Int/External Desc Usr = Condition name of DTL.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM #DIXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEETX    PARM           W0CNNM 25        Int/External De
      *
      * DTL.Status Desc USR = Condition name of DTL.@Status Detail/Summar
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1151395   Y2LSNO  70       List number
     C                     PARM #DKMST    W0INVL 25        @Status Detail/
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DIWTX    PARM           W0CNNM 25        Status Desc USR
      *
      * DTL.Form Type Desc        USR = Condition name of DTL.Form Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1165566   Y2LSNO  70       List number
     C                     PARM #DMDST    W0INVL 25        Form Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJ7TX    PARM           W0CNNM 25        Form Type Desc
      *
      * DTL.Status Desc 2 USR = Condition name of DTL.Print Carcass Analy
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1171992   Y2LSNO  70       List number
     C                     PARM #DMVST    W0INVL 25        Print Carcass A
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKITX    PARM           W0CNNM 25        Status Desc 2 U
      *
     C                     END
      * CC Company Number required
     C           #1HONB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * TH Voucher Payment Date required
     C           #DBYDT    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * @Status Detail/Summary required
     C           #DKMST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9934  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Print Carcass Analysis Us required
     C           #DMVST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9936  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ignore Fax Y/N required
     C           #DPQST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9937  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Ignore Email Y/N User required
     C           #DBSSS    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9938  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Status 3 required
     C           #DSVST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9939  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           P4HDST    IFEQ '*NO'                      *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           P1IXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     MOVELP2J8NB    #PJ8NB           Oms Warehouse C
     C                     MOVELP2C8CD    #PC8CD           Oms SalesPerson
     C                     MOVELP2G8ST    #PG8ST           Oms Allow Multi
     C                     MOVELP2G9ST    #PG9ST           Oms Default Pri
     C                     MOVELP2EVTX    #PEVTX           Oms System Valu
     C                     MOVELP2HAST    #PHAST           Oms Access Deni
     C                     MOVELP3ETTX    #PETTX           PRT Description
     C                     MOVELP3ACVN    #PACVN           PRT Printer Dev
     C                     MOVELP3AKST    #PAKST           PRT Hold Output
     C                     MOVELP3AMST    #PAMST           PRT Save Output
     C                     Z-ADDP3AKNB    #PAKNB           PRT Copies
     C                     MOVELP3ALST    #PALST           PRT Night Queue
     C                     MOVELP3AIVN    #PAIVN           PRT Night Queue
     C                     MOVELP3C7CD    #PC7CD           Oms Application
     C                     Z-ADD*ZERO     #1BSNB           Next Buy Order
     C                     Z-ADD*ZERO     #1B1DT           Current Kill Da
     C                     Z-ADD*ZERO     #1B2DT           Next Kill Date
     C                     Z-ADD*ZERO     #1H4NB           Last Drive Card
     C                     Z-ADD*ZERO     #1K3NB           Last Tattoo Nbr
     C                     Z-ADD*ZERO     #1CDDT           Current Product
     C                     Z-ADD*ZERO     #1CEDT           Next Production
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     Z-ADDP2HONB    #1HONB           CC Company Numb
     C                     MOVELP2EUTX    #PEUTX           Oms Name
     C                     Z-ADD*ZERO     #DBYDT           TH Voucher Paym
      * Clear external version also
     C                     Z-ADD*ZERO     VDBYDT
     C                     Z-ADD*ZERO     #DB4DT           Date To   USR
      * Clear external version also
     C                     Z-ADD*ZERO     VDB4DT
     C                     MOVEL*BLANK    #DKMST           @Status Detail/
     C                     MOVEL*BLANK    #DIWTX           Status Desc USR
     C                     MOVEL*BLANK    #DMDST           Form Type
     C                     MOVEL*BLANK    #DJ7TX           Form Type Desc
     C                     MOVEL*BLANK    #DMVST           Print Carcass A
     C                     MOVEL*BLANK    #DKITX           Status Desc 2 U
     C                     MOVEL*BLANK    #DPQST           Ignore Fax Y/N
     C                     MOVEL*BLANK    #DKKTX           Description 30
     C                     MOVEL*BLANK    #DBSSS           Ignore Email Y/
     C                     MOVEL*BLANK    #DUPTX           Text of 35 size
     C                     MOVEL*BLANK    #DSVST           Status 3
     C                     MOVEL*BLANK    #DIXST           SR Type
     C                     MOVEL*BLANK    #DEETX           Int/External De
     C                     MOVEL*BLANK    #DABCD           PD Producer Cod
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     Z-ADD*ZERO     #DCVNB           TH Tattoo Numbe
     C                     MOVEL*BLANK    #DJ9ST           TH Payment Type
     C                     MOVEL*BLANK    #DITTX           Payment type De
      * CALC: Screen function fields
      * DTL.Int/External Desc Usr = Condition name of DTL.SR Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1121482   Y2LSNO  70       List number
     C                     PARM #DIXST    W0INVL 25        SR Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEETX    PARM           W0CNNM 25        Int/External De
      *
      * DTL.Status Desc USR = Condition name of DTL.@Status Detail/Summar
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1151395   Y2LSNO  70       List number
     C                     PARM #DKMST    W0INVL 25        @Status Detail/
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DIWTX    PARM           W0CNNM 25        Status Desc USR
      *
      * DTL.Form Type Desc        USR = Condition name of DTL.Form Type
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1165566   Y2LSNO  70       List number
     C                     PARM #DMDST    W0INVL 25        Form Type
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DJ7TX    PARM           W0CNNM 25        Form Type Desc
      *
      * DTL.Status Desc 2 USR = Condition name of DTL.Print Carcass Analy
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1171992   Y2LSNO  70       List number
     C                     PARM #DMVST    W0INVL 25        Print Carcass A
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKITX    PARM           W0CNNM 25        Status Desc 2 U
      *
      * USER: Load screen
      * CASE: WRK.First Time Flag Usr EQ WRK.Blank USR
     C           WUHBST    IFEQ WUCRTX                     *IF
     C                     Z-ADDWUHONB    #1HONB           CC Company Numb
     C                     MOVEL'Y'       WUHJST           Display Print P
     C                     MOVEL'Y'       WUHBST           First Time Flag
     C                     MOVEL'N'       #DMVST           Print Carcass A
      * DTL.Status Desc 2 USR = Condition name of DTL.Print Carcass Analy
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1171992   Y2LSNO  70       List number
     C                     PARM #DMVST    W0INVL 25        Print Carcass A
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DKITX    PARM           W0CNNM 25        Status Desc 2 U
      *
     C                     MOVEL'Y'       #DPQST           Ignore Fax Y/N
     C                     MOVEL'Y'       #DBSSS           Ignore Email Y/
     C                     MOVEL'N'       #DSVST           Status 3
     C                     END                             *FI
      * Val Company Number    IF
      * Val Company Number    XF - STR Order Management Sys  * 
     C                     CALL 'PDGZXFR'              90  Val Company Num
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HONB    WQ0015  30       CC Company Numb
     C           P2EUTX    PARM *BLANK    WQ0016 30        Oms Name
     C           WUG3ST    PARM *BLANK    WQ0017  1        Invalid Y/N USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGZXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9931  *
     C                     END
      * CASE: WRK.Invalid Y/N USR is Yes
     C           WUG3ST    IFEQ 'Y'                        *IF
      * Setup message data for message
     C                     Z-ADD#1HONB    ZA0039           CC Company Numb
      * Send message 'Invalid Company Number'
     C                     MOVEL'PRK0299' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     MOVELWUG3ST    WUG3ST           Invalid Y/N USR
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert TH Voucher Payment Date to display format
      * Convert date
     C           1000000   ADD  #DBYDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDBYDT
      * Convert Date To   USR to display format
      * Convert date
     C           1000000   ADD  #DB4DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VDB4DT
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Producer Nm, Srce RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#DABCD    WAABCD           PD Producer Cod
      * Establish starting position
     C           KRSSA     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAGTX           PD Name
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAAGTX    #DAGTX           PD Name
     C                     MOVELWAAACD    WUAACD           SR Source Code
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    WBAACD           SR Source Code
      * Establish starting position
     C           KRSSB     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBIXST    WUIXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Pmt Prt Crc Dt,Sm RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Set fields that need a match to Yes.  They'll be set to No if fou
     C                     MOVEL'Y'       WUK4ST           @Status Carc NF
      * CASE: PAR.PD Producer Code NE WRK.Blank USR
     C           #DABCD    IFNE WUCRTX                     *IF
     C                     MOVEL'Y'       WUK6ST           @Status Prod NF
     C                     END                             *FI
      * CASE: PAR.TH Source Type NE WRK.Blank USR
     C           #DIXST    IFNE WUCRTX                     *IF
     C                     MOVEL'Y'       WUK7ST           @Status Srce NF
     C                     END                             *FI
      * CASE: PAR.TH Tattoo Number NE WRK.Zero USR
     C           #DCVNB    IFNE WUE9NB                     *IF
     C                     MOVEL'Y'       WUK5ST           @Status Ttt  NF
      * CASE: PAR.SR Type NE WRK.Blank USR
     C           P1IXST    IFNE WUCRTX                     *IF
     C                     MOVEL'Y'       WUL5ST           @status Tt/S  N
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCHMNB    WQSC01           BOH Company Num
     C           *LIKE     DEFN WCBYDT    WQSC02           TH Voucher Paym
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           BOH Company Num
     C                     KFLD           WQSC02           TH Voucher Paym
      * Setup key
     C                     Z-ADD#1HONB    WQSC01           BOH Company Num
     C                     Z-ADD#DBYDT    WQSC02           TH Voucher Paym
      * Establish starting position
     C           KRSSC     SETLL@A1CPQE                    *
     C           KRSSC     READE@A1CPQE                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0061' W0RTN   7
      * USER: Processing if Data record not found
     C                     GOTO SCEXIT                     *QUIT
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.TH Source Type NE WRK.Blank USR
     C           #DIXST    IFNE WUCRTX                     *IF
      * CASE: PAR.TH Source Type EQ DB1.TH Source Type
     C           #DIXST    IFEQ WCKAST                     *IF
     C                     MOVEL'N'       WUK7ST           @Status Srce NF
     C                     MOVEL*BLANK    WUK4ST           @Status Carc NF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.PD Producer Code NE WRK.Blank USR
     C           #DABCD    IFNE WUCRTX                     *IF
      * CASE: PAR.PD Producer Code EQ DB1.PD Producer Code
     C           #DABCD    IFEQ WCABCD                     *IF
     C                     MOVEL'N'       WUK6ST           @Status Prod NF
     C                     MOVEL*BLANK    WUK4ST           @Status Carc NF
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.TH Tattoo Number NE WRK.Zero USR
     C           #DCVNB    IFNE WUE9NB                     *IF
      * CASE: PAR.TH Tattoo Number EQ DB1.TH Tattoo Number
     C           #DCVNB    IFEQ WCCVNB                     *IF
     C                     MOVEL'N'       WUK5ST           @Status Ttt  NF
     C                     MOVEL*BLANK    WUK4ST           @Status Carc NF
      * CASE: PAR.SR Type is Internal
     C           P1IXST    IFEQ 'I'                        *IF
      * CASE: DB1.TH Source Type is Internal
     C           WCKAST    IFEQ 'I'                        *IF
     C                     MOVEL'N'       WUL5ST           @status Tt/S  N
     C                     END                             *FI
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    WUK4ST           @Status Carc NF
     C           KRSSC     READE@A1CPQE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Disregard the fax request on this submit.  Print only.
      *================================================================
     C                     Z-ADD#DBYDT    P5B3DT           Date From USR
      * Date To   USR
      * CASE: DTL.Date To   USR EQ WRK.Zero USR
     C           #DB4DT    IFEQ WUE9NB                     *IF
     C                     Z-ADD#DBYDT    P6B4DT           Date To   USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD#DB4DT    P6B4DT           Date To   USR
     C                     END                             *FI
      * DO WHILE: PAR.Date From USR LE PAR.Date To   USR
     C           P5B3DT    DOWLEP6B4DT                     *DOW
     C                     MOVEL*BLANK    WUCZCD           Date Alpha USR
     C                     MOVELP5B3DT    WUCZCD           Date Alpha USR
     C                     Z-ADD*ZERO     ZQ      50
     C           'CRC'     CAT  WUCZCD:ZQ P7ANVN    P      Job Name
      * Setup message data for message
     C                     MOVELWUC3CD    ZA0001           Company Number
     C                     MOVELWUDDCD    ZA0002           Tattoo Nbr Alph
     C                     MOVELWUCZCD    ZA0003           Date Alpha USR
     C                     MOVEL#DABCD    ZA0004           PD Producer Cod
     C                     MOVEL#DIXST    ZA0005           SR Type
     C                     MOVEL#DKMST    ZA0006           @Status Detail/
     C                     MOVEL#DJ9ST    ZA0007           TH Payment Type
     C                     MOVEL#DMDST    ZA0008           Form Type
     C                     MOVEL#DMVST    ZA0009           Print Carcass A
     C                     MOVELWUPQST    ZA0010           Ignore Fax Y/N
     C                     MOVEL#DSVST    ZA0011           Status 3
     C                     MOVELWUBSSS    ZA0012           Ignore Email Y/
     C                     MOVEL#PEVTX    ZA0013           Oms System Valu
     C                     MOVELP3ACVN    ZA0014           PRT Printer Dev
     C                     MOVELP3AKST    ZA0015           PRT Hold Output
     C                     MOVELP3AMST    ZA0016           PRT Save Output
     C                     Z-ADDP3AKNB    ZA0017           PRT Copies
     C                     MOVELP3AIVN    ZA0018           PRT Night Queue
     C                     MOVELP7ANVN    ZA0019           Job Name
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'PRK0563' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     994140*
     C                     SETON                     344335*
     C                     SETON                     3639  *
     C                     END
      *
      * PAR.Date From USR = PAR.Date From USR + CON.1 *DAYS
     C           P5B3DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P5B3DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P5B3DT
     C                     END
     C                     END                             *ITR
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HONB' defaulted for 'CC Company Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BSNB' defaulted for 'Next Buy Order Number'.
      * Field '(DTL) #1B1DT' defaulted for 'Current Kill Date'.
      * Field '(DTL) #1B2DT' defaulted for 'Next Kill Date'.
      * Field '(DTL) #1H4NB' defaulted for 'Last Drive Card Number'.
     C                     CALL 'PKLFSRR'              90  Sel Company Con
     C                     PARM *BLANK    W0RTN   7
     C           #1HONB    PARM #1HONB    WQ0010  30       CC Company Numb
     C           #1BSNB    PARM *ZERO     WQ0011  70       Next Buy Order
     C           #1B1DT    PARM *ZERO     WQ0012  70       Current Kill Da
     C           #1B2DT    PARM *ZERO     WQ0013  70       Next Kill Date
     C           #1H4NB    PARM *ZERO     WQ0014  30       Last Drive Card
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1HONB    IFNE *ZERO                      CC Company Numb
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDCK2     BEGSR
      *================================================================
      * Validate external date format
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
     C                     Z-ADD*ZERO     XDINDT
      * If external date is zero, do not check
     C           XDEXDT    CABEQ*ZERO     XDCK2E
      *................................................................
      * Map external to internal according to date format
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDEX02    XDINDD           DD
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDEX02    XDINMM           MM
     C                     Z-ADDXDEX03    XDINDD           DD
     C                     Z-ADDXDEX04    XDINYY           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDEX02    XDINYY           YY
     C                     Z-ADDXDEX03    XDINMM           MM
     C                     Z-ADDXDEX04    XDINDD           DD
     C                     END
     C                     END
      * If YY prior to the 'cut-off' year treat as 20YY.
     C           XDINYY    IFLT XOFFYY
     C                     ADD  100       XDINYY
     C                     END
     C           YPMTFD    CABNE*BLANK    XDCK2E
      *................................................................
      * Check months in range 1 to 12
     C           XDINMM    CABLT1         XDCK2M
     C           XDINMM    CABGT12        XDCK2M
      *................................................................
      * Check days in range 1 to maximum for month
     C           XDINDD    CABLT1         XDCK2M
     C           XDINDD    CABGT@XD,XDINMMXDCK2M
      *................................................................
      * Special case: leap year
     C           XDINMM    IFEQ 2
     C           XDINYY    IFNE *ZERO
     C           XDINYY    ANDNE200
     C           XDINYY    DIV  4         XDWK1   80
     C                     MVR            XDWK1
     C                     ELSE
     C                     Z-ADD1         XDWK1
     C                     END
      * Year is not leap
     C           XDWK1     IFNE *ZERO
     C           XDINDD    CABGT28        XDCK2M
     C                     END
     C                     END
     C                     GOTO XDCK2E
      *................................................................
      * Send error message
     C           XDCK2M    TAG
      * Send message '*Invalid date'
     C                     MOVEL'Y2U0006' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     MOVEL'Y2U0006' W0RTN
      * Disable time portion if timestamp is validated
     C                     Z-ADD*ZERO     XTTIM
      *================================================================
     CSR         XDCK2E    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE035
     C           ZHCSCL    ANDLE037
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1HONB'  YPMTFD           CC Company Numb
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DKMST'  YPMTFD           @Status Detail/
     C                     END
      *
     C           ZHCSRW    IFEQ 007
     C           ZHCSCL    ANDGE035
     C           ZHCSCL    ANDLE037
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DMDST'  YPMTFD           Form Type
     C                     END
      *
     C           ZHCSRW    IFEQ 008
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DMVST'  YPMTFD           Print Carcass A
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DPQST'  YPMTFD           Ignore Fax Y/N
     C                     END
      *
     C           ZHCSRW    IFEQ 010
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DBSSS'  YPMTFD           Ignore Email Y/
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DSVST'  YPMTFD           Status 3
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN78     ANDEQ'0'
     C                     MOVEL'#DIXST'  YPMTFD           SR Type
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDEQ035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#DJ9ST'  YPMTFD           TH Payment Type
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2J8NB           Oms Warehouse C
     C                     Z-ADD*ZERO     P2HONB           CC Company Numb
     C                     MOVEL*BLANK    P2C8CD           Oms SalesPerson
     C                     MOVEL*BLANK    P2G8ST           Oms Allow Multi
     C                     MOVEL*BLANK    P2G9ST           Oms Default Pri
     C                     MOVEL*BLANK    P2EUTX           Oms Name
     C                     MOVEL*BLANK    P2EVTX           Oms System Valu
     C                     MOVEL*BLANK    P2HAST           Oms Access Deni
     C                     MOVEL*BLANK    P3ETTX           PRT Description
     C                     MOVEL*BLANK    P3ACVN           PRT Printer Dev
     C                     MOVEL*BLANK    P3AKST           PRT Hold Output
     C                     MOVEL*BLANK    P3AMST           PRT Save Output
     C                     Z-ADD*ZERO     P3AKNB           PRT Copies
     C                     MOVEL*BLANK    P3ALST           PRT Night Queue
     C                     MOVEL*BLANK    P3AIVN           PRT Night Queue
     C                     MOVEL*BLANK    P3C7CD           Oms Application
     C                     MOVEL*BLANK    P4HDST           Display Field U
     C                     Z-ADD*ZERO     P5B3DT           Date From USR
     C                     Z-ADD*ZERO     P6B4DT           Date To   USR
     C                     MOVEL*BLANK    P7ANVN           Job Name
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Company Number Alpha Usr
     C                     MOVEL*BLANK    WUC3CD  3
      * Define work field Tattoo Nbr Alpha Usr
     C                     MOVEL*BLANK    WUDDCD  5
      * Define work field Date Alpha USR
     C                     MOVEL*BLANK    WUCZCD  7
      * Define work field Ignore Fax Y/N
     C                     MOVEL*BLANK    WUPQST  1
      * Define work field Ignore Email Y/N User
     C                     MOVEL*BLANK    WUBSSS  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Blank Usr 1 fld Usr
     C                     MOVEL*BLANK    WUIXTX  1
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAALNB           PD Production C
     C                     Z-ADD*ZERO     WAAATH           PD Std Delv Tim
     C                     Z-ADD*ZERO     WAAMNB           PD Std Truck Si
     C                     Z-ADD*ZERO     WAGCNB           PD VND Address
     C                     Z-ADD*ZERO     WAGJNB           PD EDI Trading
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field @Status Carc NF Y/N   USR
     C                     MOVEL*BLANK    WUK4ST  1
      * Define work field @Status Srce NF Y/N   USR
     C                     MOVEL*BLANK    WUK7ST  1
      * Define work field @Status Prod NF Y/N   USR
     C                     MOVEL*BLANK    WUK6ST  1
      * Define work field @Status Ttt  NF Y/N   USR
     C                     MOVEL*BLANK    WUK5ST  1
      * Define work field @status Tt/S  NF      USR
     C                     MOVEL*BLANK    WUL5ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WCACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WCB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WCCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WCAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WCA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WCCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WCCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WCFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WCH9NB           TH Held Over
     C                     Z-ADD*ZERO     WCFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WCFENB           TH Head Killed
     C                     Z-ADD*ZERO     WCHENB           TH Head Adds
     C                     Z-ADD*ZERO     WCHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WCCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WCLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WCE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WCA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WCFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WCA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WCF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WCHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WCF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WCF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WCAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WCAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WCCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WCA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WCA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WCB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WCAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WCAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WCAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WCAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WCAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WCAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WCASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WCA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WCATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WCA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WCCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WCCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WCLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WCCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WCA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WCA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WCBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     Z-ADD*ZERO     WCBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WCHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WCHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WCHINB           TH FFLI
     C                     Z-ADD*ZERO     WCA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WCA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WCA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WCJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WCD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WCD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WCD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WCD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WCEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WCEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WCECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WCEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WCEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WCEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WCEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WCOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WCTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WCT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WCTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WCT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WCOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WCKOER           TH Head Identif
     C                     Z-ADD*ZERO     WCOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WCOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WCIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WCOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WCHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WCS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WCTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WCTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WCJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WCKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WCKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WCKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WCKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WCOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WCIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WCIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WCIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WCKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WCKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WCORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WCOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WCMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WCMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WCNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WCNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WCIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WCKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WCEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WCECDT           TH Head LFT
     C                     Z-ADD*ZERO     WCEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WCEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field First Time Flag Usr
     C                     MOVEL*BLANK    WUHBST  1
      * Define work field CC Company Number
     C                     Z-ADD*ZERO     WUHONB  30
      * Define work field Display Print Prompt  Usr
     C                     MOVEL*BLANK    WUHJST  1
      * Define work field Invalid Y/N USR
     C                     MOVEL*BLANK    WUG3ST  1
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'Y'       W0PMT   1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      * Retrieve the 'cut-off' year YY: 19YY-1999,2000-20(YY-1).
     C           *NAMVAR   DEFN Y2CTOFF   XOFF
     C                     IN   XOFF
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * Modifications
      * H16853 ISE 11/05/2020 - Recompiled due to change in Buy Order Num
      * Val Application/User  IF
      * Val Application/User  XF - STR Order Management Sys  * 
     C                     CALL 'PDGXXFR'              90  Val Application
     C                     PARM *BLANK    W0RTN   7
     C           P2J8NB    PARM *BLANK    WQ0018  3        Oms Warehouse C
     C           WUHONB    PARM *ZERO     WQ0019  30       CC Company Numb
     C                     PARM 'HPE'     WQ0020  6        Oms Application
     C           P2C8CD    PARM *BLANK    WQ0021  3        Oms SalesPerson
     C           P2G8ST    PARM *BLANK    WQ0022  1        Oms Allow Multi
     C           P2G9ST    PARM *BLANK    WQ0023 10        Oms Default Pri
     C           P2EUTX    PARM *BLANK    WQ0024 30        Oms Name
     C           P2EVTX    PARM *BLANK    WQ0025 40        Oms System Valu
     C           P2HAST    PARM *BLANK    WQ0026  1        Oms Access Deni
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
      * Send message 'Access Denied for User'
     C                     MOVEL'PRK0298' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP2EVTX    ##CMP
     C                     END                             *FI
      * CASE: PAR.Oms Access Denied (Y/N) is Yes
     C           P2HAST    IFEQ 'Y'                        *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C                     MOVEL*BLANK    P4HDST           Display Field U
     C                     MOVEL'*NO'     P4HDST           Display Field U
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** @XD
312931303130313130313031
** W0BEG
01059010690131501323015710158101827
01837020830209302339023490259502605
02851038750388504131041410438704643
04653
** W0END
01061010980132001328015710160001829
01861020830211702339023780259502629
02851038750390904136041650439104643
04668
** W0NAM
#1HONB    #PEUTX    VDBYDT    VDB4DT    #DKMST    #DIWTX    #DMDST
#DJ7TX    #DMVST    #DKITX    #DPQST    #DKKTX    #DBSSS    #DUPTX
#DSVST    #DIXST    #DEETX    #DABCD    #DAGTX    #DCVNB    #DJ9ST
#DITTX
** @CN
00001 Print Carcass Summ,Detail
00002 FAXCRSDTL
