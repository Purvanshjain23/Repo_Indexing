// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDQ0XFR
// ?Date: 14.08.2025 Time: 03:29:29
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(DEL AS Order Header/LD RT) TYPE(RTVOBJ) FILE(OMFLCPP)          AC1323592;
PARAMETER(PAR.Load_ID);
{
 //?USER: Process Data record

 // PAR.Trans Contol AS400/Plant = CND.AS400
 PAR.Trans_Contol_AS400_Plant = 'A';

 EXECUTE FUNCTION(RTV Carr,1st Whse,Cntl RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1481959;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(NLL.Carrier_Code);
 PARAMETER(PAR.Trans_Contol_AS400_Plant);
 PARAMETER(PAR.Warehouse_Code);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  EXECUTE FUNCTION(RTV 1st Warehouse/Ctl  RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1360958;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(*ZERO);
  PARAMETER(*ZERO);
  PARAMETER(PAR.Warehouse_Code);
  PARAMETER(PAR.Trans_Contol_AS400_Plant);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   EXECUTE FUNCTION(RTV Warehouse Control  RT) TYPE(RTVOBJ) FILE(CAADREP)          AC1304300;
   PARAMETER(DB1.Warehouse_Code);
   PARAMETER(PAR.Trans_Contol_AS400_Plant);
   {
    //?USER: Processing if Data record not found

    MOVE *ALL (To: PAR From: CON);

    // PGM.*Return code = CND.*Record does not exist
    PGM.*Return_code = 'Y2U0005';

    //?USER: Process Data record

    MOVE *ALL (To: PAR From: DB1);

   }

   MOVE *ALL (To: PAR From: DB1);

   QUIT;

  }

 }

 //?If ord plant floor controlled then check for Accu-sort or GAF
 CASE;

 // IF PAR.Trans Contol AS400/Plant is Plant
 IF PAR.Trans_Contol_AS400_Plant = 'P';

 EXECUTE FUNCTION(Rtv Cust/Func          RT) TYPE(RTVOBJ) FILE(POAEREP)          AC1579918;
 PARAMETER(DB1.Company_Number);
 PARAMETER(PAR.Warehouse_Code);
 PARAMETER(PAR.GAF_Customer_Number);
 PARAMETER(PAR.GAF_Function);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?If no record found then send to accusort else send to Function
 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 EXECUTE FUNCTION(DLT AS Order Header    RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1323593;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Header Status is Cancelled
  IF DB1.Header_Status = 'X';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.Calc 7 = DB1.Order Number * CON.1 *
  WRK.Calc_7 = DB1.Order_Number * 1;

  // WRK.AS Order Number = CVTVAR(WRK.Calc 7)
  WRK.AS_Order_Number = CVTVAR(WRK.Calc_7);

  EXECUTE FUNCTION(DLT AS Order Header    DL) TYPE(DLTOBJ) FILE(PDJQCPP)          AC1322820;
  PARAMETER('H');
  PARAMETER(WRK.AS_Order_Number);
  CASE;

  // IF PGM.*Return code is *Normal
  IF PGM.*Return_code = *BLANK;

  EXECUTE FUNCTION(Del SNDACC Entry/Ord   RT) TYPE(RTVOBJ) FILE(PDLHCPP)          AC1481967;
  PARAMETER(DB1.Load_ID);
  PARAMETER('SNDACC');
  PARAMETER(DB1.Order_Number);
  {
   //?USER: Processing if Data record not found

   // PGM.*Return code = CND.*Record does not exist
   PGM.*Return_code = 'Y2U0005';

   //?USER: Process Data record

   CASE;

   // IF DB1.Order Number EQ PAR.Order Number
   IF DB1.Order_Number = PAR.Order_Number;

   EXECUTE FUNCTION(DEL Load/Order Chg Log DR) TYPE(DLTOBJ) FILE(PDLHCPP)          AC1465746;
   PARAMETER(DB1.Created_Date);
   PARAMETER(DB1.Created_Time);
   PARAMETER(DB1.Sequence_Number);
   ENDIF;

  }

  ENDIF;

  ENDIF;

 }

 EXECUTE FUNCTION(DLT AS Order Detail    RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428519;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Detail Line Status is Cancelled
  IF DB1.Detail_Line_Status = 'X';

  // IF *OTHERWISE
  IF *OTHERWISE;

  // WRK.Calc 7 = DB1.Order Number * CON.1 *
  WRK.Calc_7 = DB1.Order_Number * 1;

  // WRK.AS Order Number = CVTVAR(WRK.Calc 7)
  WRK.AS_Order_Number = CVTVAR(WRK.Calc_7);

  // WRK.Calc 5 = DB1.Item Code * CON.1 *
  WRK.Calc_5 = DB1.Item_Code * 1;

  // WRK.AS Product Code = CVTVAR(WRK.Calc 5)
  WRK.AS_Product_Code = CVTVAR(WRK.Calc_5);

  EXECUTE FUNCTION(DLT AS Order Detail    DL) TYPE(DLTOBJ) FILE(PDJRCPP)          AC1320102;
  PARAMETER('D');
  PARAMETER(WRK.AS_Order_Number);
  PARAMETER(WRK.AS_Product_Code);
  ENDIF;

 }

 //?If no record found then send to accusort else send to Function
 // IF PAR.GAF Function is Georgia Freezer-Pendegras
 IF PAR.GAF_Function = 'GFP';

 // Call program zDlt GAF Order Hdr/Dtl XF.
 CALL PROGRAM(zDlt GAF Order Hdr/Dtl XF) ('POAYXFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Load_ID);
 PARAMETER(PAR.GAF_Customer_Number);

 ENDIF;

 ENDIF;

}


