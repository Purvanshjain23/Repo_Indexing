// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKI7XFR
// ?Date: 14.08.2025 Time: 02:49:39
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?10/23/2007 ADDED CMP Grade Type Adj &
//?           CMP CLC Premium First  THIS was not being passed
EXECUTE FUNCTION(Rtv CMP Info Record   RT) TYPE(RTVOBJ) FILE(PKARREP)           AB1263852;
PARAMETER(PAR.CMP_Program_Code);
PARAMETER(WRK.CMP_Description);
PARAMETER(WRK.CMP_Grading_Type);
PARAMETER(WRK.CMP_Sort_Basis);
PARAMETER(WRK.CMP_Sts);
PARAMETER(WRK.CMP_Carc_Wgt_Type);
PARAMETER(WRK.CMP_Std_Lean_Percent);
PARAMETER(WRK.CMP_Lean_Factor);
PARAMETER(WRK.CMP_Optimal_Row_Nbr_f_srt);
PARAMETER(WRK.CMP_Type);
PARAMETER(WRK.CMP_Market_Add_Deduct);
PARAMETER(WRK.CMP_of_Carcass_Cutout);
PARAMETER(WRK.CMP_Fixed_Cost_Per_Head);
PARAMETER(WRK.CMP_Grade_Type_Adj);
PARAMETER(WRK.CMP_CLC_Premium_First);
PARAMETER(WRK.RS_Record_Status);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


//?Read org record and copy to new carcass merit pgm
//?10/23/2007 ADDED CMP Grade Type Adj &
//?           CMP CLC Premium First  THIS was not being passed
EXECUTE FUNCTION(Crt Carcass Merit Pgm CR) TYPE(CRTOBJ) FILE(PKARREP)           AB1101849;
PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
PARAMETER(PAR.CMP_Description);
PARAMETER(WRK.CMP_Grading_Type);
PARAMETER(WRK.CMP_Sort_Basis);
PARAMETER(WRK.CMP_Sts);
PARAMETER(WRK.CMP_Carc_Wgt_Type);
PARAMETER(WRK.CMP_Std_Lean_Percent);
PARAMETER(WRK.CMP_Lean_Factor);
PARAMETER(WRK.CMP_Optimal_Row_Nbr_f_srt);
PARAMETER(WRK.CMP_Type);
PARAMETER(WRK.CMP_Market_Add_Deduct);
PARAMETER(WRK.CMP_of_Carcass_Cutout);
PARAMETER(WRK.CMP_Fixed_Cost_Per_Head);
PARAMETER(WRK.CMP_Grade_Type_Adj);
PARAMETER(LCL.CMP_Unused_Price_2);
PARAMETER(LCL.CMP_Unused_Price_3);
PARAMETER(WRK.CMP_CLC_Premium_First);
PARAMETER(LCL.CMP_Unused_Sts_2);
PARAMETER(LCL.CMP_Unused_Sts_3);
PARAMETER(*BLANK);
PARAMETER(*ZERO);
PARAMETER(*ZERO);
PARAMETER(WRK.RS_Record_Status);
PARAMETER(WRK.RS_Job);
PARAMETER(WRK.RS_Program);
PARAMETER(WRK.RS_User_Added);
PARAMETER(WRK.RS_Date_Added);
PARAMETER(WRK.RS_Time_Added);
{
 //?USER: Processing before Data update

 EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(*MISSING);
 PARAMETER(*MISSING);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?Execute internal function

  // PAR.RS Record Status = CND.Active
  PAR.RS_Record_Status = 'A';

  // PAR.RS User Added = JOB.*USER
  PAR.RS_User_Added = JOB.*USER;

  // PAR.RS Date Added = JOB.*Job date
  PAR.RS_Date_Added = JOB.*Job_date;

  // PAR.RS Time Added = JOB.*Job time
  PAR.RS_Time_Added = JOB.*Job_time;

  // PAR.RS Program = JOB.*PROGRAM
  PAR.RS_Program = JOB.*PROGRAM;

  // PAR.RS Job = JOB.*JOB
  PAR.RS_Job = JOB.*JOB;

 }

}


CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

//?If no error found
EXECUTE FUNCTION(Cpy Carc Merit Pgm Com Rt) TYPE(RTVOBJ) FILE(PKB0REP)          AB1117541;
PARAMETER(PAR.CMP_Program_Code);
PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
{
 //?USER: Process Data record

 //?Create New cpy records
 EXECUTE FUNCTION(Create Carcass Merit Prog) TYPE(CRTOBJ) FILE(PKB0REP)          AB1103758;
 PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
 PARAMETER(DB1.CMPC_Comment_Line);
 PARAMETER(DB1.CMPC_Comment);
 PARAMETER(DB1.CMPC_Comment_Type);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(*MISSING);
  PARAMETER(*MISSING);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


EXECUTE FUNCTION(Cpy Carc Merit Mtx Row RT) TYPE(RTVOBJ) FILE(PKBYREP)          AB1117547;
PARAMETER(PAR.CMP_Program_Code);
PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Create Carcass Merit Matr) TYPE(CRTOBJ) FILE(PKBYREP)          AB1103385;
 PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
 PARAMETER(DB1.CMMR_Row_Number);
 PARAMETER(DB1.CMMR_Carc_Wgt_Min);
 PARAMETER(DB1.CMMR_Carc_Wgt_Max);
 PARAMETER(DB1.CMMR_Carc_Wgt_Mid);
 PARAMETER(DB1.CMMR_Live_Wgt_Min);
 PARAMETER(DB1.CMMR_Live_Wgt_Max);
 PARAMETER(DB1.CMMR_Std_Dressing_Yield);
 PARAMETER(DB1.CMMR_Sort_Discount);
 PARAMETER(DB1.CMMR_Unused_Field_1);
 PARAMETER(DB1.CMMR_Midpoint);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(*MISSING);
  PARAMETER(*MISSING);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


EXECUTE FUNCTION(Cpy Carc Merit Mtx Col RT) TYPE(RTVOBJ) FILE(PKBZREP)          AB1117558;
PARAMETER(PAR.CMP_Program_Code);
PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
{
 //?USER: Process Data record

 EXECUTE FUNCTION(Crt CMM Col           CR) TYPE(CRTOBJ) FILE(PKBZREP)           AB1103404;
 PARAMETER(PAR.Carc_Merit_Pgm_Code_USR);
 PARAMETER(DB1.CMMR_Row_Number);
 PARAMETER(DB1.CMMC_Column_Number);
 PARAMETER(DB1.CMMC_Lean_Percent);
 PARAMETER(DB1.CMMC_Backfat_Inches);
 PARAMETER(DB1.CMMC_Grade);
 PARAMETER(DB1.CMMC_Premium_Value);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.RS_Record_Status);
 PARAMETER(DB1.RS_Job);
 PARAMETER(DB1.RS_Program);
 PARAMETER(DB1.RS_User_Added);
 PARAMETER(DB1.RS_Date_Added);
 PARAMETER(DB1.RS_Time_Added);
 {
  //?USER: Processing before Data update

  EXECUTE FUNCTION(Rtv Add Stamp         IF) TYPE(EXCINTFUN)                      AB1100935;
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?Execute internal function

   // PAR.RS Record Status = CND.Active
   PAR.RS_Record_Status = 'A';

   // PAR.RS User Added = JOB.*USER
   PAR.RS_User_Added = JOB.*USER;

   // PAR.RS Date Added = JOB.*Job date
   PAR.RS_Date_Added = JOB.*Job_date;

   // PAR.RS Time Added = JOB.*Job time
   PAR.RS_Time_Added = JOB.*Job_time;

   // PAR.RS Program = JOB.*PROGRAM
   PAR.RS_Program = JOB.*PROGRAM;

   // PAR.RS Job = JOB.*JOB
   PAR.RS_Job = JOB.*JOB;

  }

 }

}


ENDIF;

