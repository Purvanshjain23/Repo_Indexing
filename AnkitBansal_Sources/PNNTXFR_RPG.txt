     H/TITLE Exc HPB Crt Ord f/Inv XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 08/17/16  Time  : 08:51:52
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FOPBFCPLOIF  E           K        DISK
      * RSQ : Order Header TRG          Ord-D/Co
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FCAEOREL1IF  E           K        DISK
      * RTV : Company Customer          Retrieval index
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FOPBFCPL0IF  E           K        DISK                      A
      * UPD : Order Header TRG          Update index
      *
     FOPEYCPL6IF  E           K        DISK                      A
      * UPD : Order Events              Update index to purge
      *
     FOPBGWKLZIF  E           K        DISK                      A
      * UPD : Order Detail              Update index to Purge
      *
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@BFCPY2
      * Order Header TRG          Ord-D/Co
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WCBKC7
     I              BBAYTX                          WCAYTX
     I              BBACNA                          WCACNA
     I              BBADNA                          WCADNA
     I              BBAENA                          WCAENA
     I              BBAJNA                          WCAJNA
     I              BBBGCD                          WCBGCD
     I              BBG5CD                          WCG5CD
     I              BBBTTX                          WCBTTX
     I              BBBVTX                          WCBVTX
     I              BBBWTX                          WCBWTX
     I              BBABTX                          WCABTX
     I              BBA2NA                          WCA2NA
     I              BBCBST                          WCCBST
     I              BBB0NA                          WCB0NA
     I              BBP3NB                          WCP3NB
     I              BBAXNA                          WCAXNA
     I              BBI6DT                          WCI6DT
     I              BBAYDT                          WCAYDT
     I              BBANC7                          WCANC7
     I              BBBTC7                          WCBTC7
     I              BBK6ST                          WCK6ST
     I              BBUZST                          WCUZST
     I              BBKXCD                          WCKXCD
     I              BBLTCD                          WCLTCD
     I              BBQNST                          WCQNST
     I              BBS2NB                          WCS2NB
     I              BBVHVA                          WCVHVA
     I              BBI7DT                          WCI7DT
     I              BBRJST                          WCRJST
     I              BBRKST                          WCRKST
     I              BBQWST                          WCQWST
     I              BBQXST                          WCQXST
     I              BBQYST                          WCQYST
     I              BBUNCS                          WCUNCS
     I              BBUVST                          WCUVST
     I              BBUWST                          WCUWST
     I              BBUXST                          WCUXST
     I              BBVSST                          WCVSST
     I              BBAATM                          WCAATM
     I              BBAYNA                          WCAYNA
     I              BBA0NA                          WCA0NA
     I              BBAXDT                          WCAXDT
      *
     I@EOREXM
      * Company Customer          Retrieval index
      * Renamed input format fields
     I              EOAIC3                          WDAIC3
     I              EOBKC7                          WDBKC7
     I              EOAQCD                          WDAQCD
     I              EOR4CD                          WDR4CD
     I              EOBYNA                          WDBYNA
     I              EOB6NA                          WDB6NA
     I              EOBZNA                          WDBZNA
     I              EOLLST                          WDLLST
     I              EOPPST                          WDPPST
     I              EOR5NB                          WDR5NB
     I              EOR6NB                          WDR6NB
     I              EOQGST                          WDQGST
     I              EOBOCD                          WDBOCD
     I              EOTBNB                          WDTBNB
     I              EOMTCU                          WDMTCU
     I              EOW2NB                          WDW2NB
     I              EORPCD                          WDRPCD
     I              EOAJCD                          WDAJCD
     I              EOX9ST                          WDX9ST
     I              EOT9CD                          WDT9CD
     I              EOUBCD                          WDUBCD
     I              EOISTX                          WDISTX
     I              EOLQCD                          WDLQCD
     I              EONJNA                          WDNJNA
     I              EOI0TX                          WDI0TX
     I              EONKNA                          WDNKNA
     I              EOI1TX                          WDI1TX
     I              EOVLST                          WDVLST
     I              EORLST                          WDRLST
     I              EOMMTX                          WDMMTX
     I              EOOHNA                          WDOHNA
     I              EOQ6ST                          WDQ6ST
     I              EOQ8ST                          WDQ8ST
     I              EORBST                          WDRBST
     I              EOREST                          WDREST
     I              EOUVST                          WDUVST
     I              EOUWST                          WDUWST
     I              EOUXST                          WDUXST
     I              EOVSST                          WDVSST
     I              EOAATM                          WDAATM
     I              EOAYNA                          WDAYNA
     I              EOA0NA                          WDA0NA
     I              EOAXDT                          WDAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WFAIC3
     I              EYC4NB                          WFC4NB
     I              EYQ2NB                          WFQ2NB
     I              EYJPCD                          WFJPCD
     I              EYAUC3                          WFAUC3
     I              EYQ7NB                          WFQ7NB
     I              EYOMST                          WFOMST
     I              EYD2DT                          WFD2DT
     I              EYONST                          WFONST
     I              EYOOST                          WFOOST
     I              EYOPST                          WFOPST
     I              EYAWC3                          WFAWC3
     I              EYQ8NB                          WFQ8NB
     I              EYQ9NB                          WFQ9NB
     I              EYBKC7                          WFBKC7
     I              EYUVST                          WFUVST
     I              EYUWST                          WFUWST
     I              EYUXST                          WFUXST
     I              EYAATM                          WFAATM
     I              EYAYNA                          WFAYNA
     I              EYA0NA                          WFA0NA
     I              EYAXDT                          WFAXDT
      *
     I@EYCPD5
      * Order Events              Update index to purge
      * Renamed input format fields
     I              EYAIC3                          WGAIC3
     I              EYC4NB                          WGC4NB
     I              EYQ2NB                          WGQ2NB
     I              EYJPCD                          WGJPCD
     I              EYAUC3                          WGAUC3
     I              EYQ7NB                          WGQ7NB
     I              EYOMST                          WGOMST
     I              EYD2DT                          WGD2DT
     I              EYONST                          WGONST
     I              EYOOST                          WGOOST
     I              EYOPST                          WGOPST
     I              EYAWC3                          WGAWC3
     I              EYQ8NB                          WGQ8NB
     I              EYQ9NB                          WGQ9NB
     I              EYBKC7                          WGBKC7
     I              EYUVST                          WGUVST
     I              EYUWST                          WGUWST
     I              EYUXST                          WGUXST
     I              EYAATM                          WGAATM
     I              EYAYNA                          WGAYNA
     I              EYA0NA                          WGA0NA
     I              EYAXDT                          WGAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WHAIC3
     I              OMC4NB                          WHC4NB
     I              OMDPNB                          WHDPNB
     I              OMUENB                          WHUENB
     I              OMHGCD                          WHHGCD
     I              OMAJCD                          WHAJCD
     I              OMBKC7                          WHBKC7
     I              OMCFC7                          WHCFC7
     I              OMGMST                          WHGMST
     I              OMGNST                          WHGNST
     I              OMMAVA                          WHMAVA
     I              OMKDVA                          WHKDVA
     I              OML8VA                          WHL8VA
     I              OML9VA                          WHL9VA
     I              OMGTST                          WHGTST
     I              OMGVST                          WHGVST
     I              OMGUST                          WHGUST
     I              OMQFST                          WHQFST
     I              OMAYVA                          WHAYVA
     I              OMEXDT                          WHEXDT
     I              OMLQCD                          WHLQCD
     I              OMRDCD                          WHRDCD
     I              OMQ7CD                          WHQ7CD
     I              OMBZPR                          WHBZPR
     I              OML6NB                          WHL6NB
     I              OMU1ST                          WHU1ST
     I              OMGIDT                          WHGIDT
     I              OMCRCD                          WHCRCD
     I              OMAGCD                          WHAGCD
     I              OMRZST                          WHRZST
     I              OMR0ST                          WHR0ST
     I              OMR1ST                          WHR1ST
     I              OMG7NA                          WHG7NA
     I              OMG8NA                          WHG8NA
     I              OMRPCD                          WHRPCD
     I              OMVEST                          WHVEST
     I              OMVGST                          WHVGST
     I              OMAVST                          WHAVST
     I              OMU0ST                          WHU0ST
     I              OMRFCD                          WHRFCD
     I              OMFZST                          WHFZST
     I              OMR1NB                          WHR1NB
     I              OMAVQT                          WHAVQT
     I              OMD0WG                          WHD0WG
     I              OMCCQT                          WHCCQT
     I              OMAUWG                          WHAUWG
     I              OMCBQT                          WHCBQT
     I              OMATWG                          WHATWG
     I              OMAQCS                          WHAQCS
     I              OMAGCS                          WHAGCS
     I              OMAKPR                          WHAKPR
     I              OMALPR                          WHALPR
     I              OMAUPR                          WHAUPR
     I              OMAVWG                          WHAVWG
     I              OMA4WG                          WHA4WG
     I              OMA5DT                          WHA5DT
     I              OMAODT                          WHAODT
     I              OMGNDT                          WHGNDT
     I              OMAMST                          WHAMST
     I              OMANST                          WHANST
     I              OMVAST                          WHVAST
     I              OMRGNB                          WHRGNB
     I              OMRHNB                          WHRHNB
     I              OMRINB                          WHRINB
     I              OMRBCD                          WHRBCD
     I              OMHICD                          WHHICD
     I              OMRNCD                          WHRNCD
     I              OMROCD                          WHROCD
     I              OMCXDT                          WHCXDT
     I              OMAJVN                          WHAJVN
     I              OMKXCD                          WHKXCD
     I              OMJPCD                          WHJPCD
     I              OMCQCD                          WHCQCD
     I              OMR4CD                          WHR4CD
     I              OMZ1ST                          WHZ1ST
     I              OMZ3ST                          WHZ3ST
     I              OMZ4ST                          WHZ4ST
     I              OMDUPR                          WHDUPR
     I              OMB6VL                          WHB6VL
     I              OMA1AA                          WHA1AA
     I              OMFZSX                          WHFZSX
     I              OMF0SX                          WHF0SX
     I              OMF1SX                          WHF1SX
     I              OMF2SX                          WHF2SX
     I              OMF3SX                          WHF3SX
     I              OMF4SX                          WHF4SX
     I              OMF5SX                          WHF5SX
     I              OMF6SX                          WHF6SX
     I              OMF7SX                          WHF7SX
     I              OMNTDT                          WHNTDT
     I              OMNUDT                          WHNUDT
     I              OMNVDT                          WHNVDT
     I              OMNWDT                          WHNWDT
     I              OMNXDT                          WHNXDT
     I              OMBUTM                          WHBUTM
     I              OMBVTM                          WHBVTM
     I              OMBWTM                          WHBWTM
     I              OMBXTM                          WHBXTM
     I              OMBYTM                          WHBYTM
     I              OMH5NX                          WHH5NX
     I              OMH6NX                          WHH6NX
     I              OMH7NX                          WHH7NX
     I              OMH8NX                          WHH8NX
     I              OMH9NX                          WHH9NX
     I              OMDVPR                          WHDVPR
     I              OMDWPR                          WHDWPR
     I              OMDXPR                          WHDXPR
     I              OMDYPR                          WHDYPR
     I              OMDZPR                          WHDZPR
     I              OMGSPR                          WHGSPR
     I              OMGTPR                          WHGTPR
     I              OMGUPR                          WHGUPR
     I              OMHOST                          WHHOST
     I              OMHPST                          WHHPST
     I              OMIOST                          WHIOST
     I              OMPEWG                          WHPEWG
     I              OMRINY                          WHRINY
     I              OMTIDT                          WHTIDT
     I              OMTJDT                          WHTJDT
     I              OMH2ST                          WHH2ST
     I              OMH0ST                          WHH0ST
     I              OMH1ST                          WHH1ST
     I              OMTKDT                          WHTKDT
     I              OMTLDT                          WHTLDT
     I              OMTMDT                          WHTMDT
     I              OMUVST                          WHUVST
     I              OMUWST                          WHUWST
     I              OMUXST                          WHUXST
     I              OMAATM                          WHAATM
     I              OMAYNA                          WHAYNA
     I              OMA0NA                          WHA0NA
     I              OMAXDT                          WHAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     I@BGWKEC
      * Order Detail              Update index to Purge
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     IQOPEY1    E DSOPEYCPL6
      * UPD : Order Events              Update index to purge
      * Renamed input format fields
     I              EYAIC3                          WGAIC3
     I              EYC4NB                          WGC4NB
     I              EYQ2NB                          WGQ2NB
     I              EYJPCD                          WGJPCD
     I              EYAUC3                          WGAUC3
     I              EYQ7NB                          WGQ7NB
     I              EYOMST                          WGOMST
     I              EYD2DT                          WGD2DT
     I              EYONST                          WGONST
     I              EYOOST                          WGOOST
     I              EYOPST                          WGOPST
     I              EYAWC3                          WGAWC3
     I              EYQ8NB                          WGQ8NB
     I              EYQ9NB                          WGQ9NB
     I              EYBKC7                          WGBKC7
     I              EYUVST                          WGUVST
     I              EYUWST                          WGUWST
     I              EYUXST                          WGUXST
     I              EYAATM                          WGAATM
     I              EYAYNA                          WGAYNA
     I              EYA0NA                          WGA0NA
     I              EYAXDT                          WGAXDT
      *
     IQOPBG1    E DSOPBGWKLZ
      * UPD : Order Detail              Update index to Purge
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMGSPR                          WJGSPR
     I              OMGTPR                          WJGTPR
     I              OMGUPR                          WJGUPR
     I              OMHOST                          WJHOST
     I              OMHPST                          WJHPST
     I              OMIOST                          WJIOST
     I              OMPEWG                          WJPEWG
     I              OMRINY                          WJRINY
     I              OMTIDT                          WJTIDT
     I              OMTJDT                          WJTJDT
     I              OMH2ST                          WJH2ST
     I              OMH0ST                          WJH0ST
     I              OMH1ST                          WJH1ST
     I              OMTKDT                          WJTKDT
     I              OMTLDT                          WJTLDT
     I              OMTMDT                          WJTMDT
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  Company Number
     I                                    P   1   20P1AIC3
     IP2PARM      DS
      * I :  Order Number
     I                                    P   1   40P2C4NB
     IP3PARM      DS
      * I :  Sold To Customer-hpb biod
     I                                    P   1   40P3I1NY
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P2C4NB    PARM           WP0002  70       Order Number
     C           P3I1NY    PARM           WP0003  70       Sold To Custome
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc HPB Crt Ord f/Inv XF
      * DOC:  Create order with company 361 and ship to data as biodiesel
     C                     EXSR UASUBR                     DOC:  Create or
      * R6965  RMC new hpb plant
      * Get biodiesel company for the marketing co (for 369->361,for 374-
      * RTV Numeric Value      RT - Company Values  * 
     C                     EXSR SARVGN
      * RTV Crt HPB Order     RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * Do this to extend with the transfer price
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0006  30       Company Number
     C                     PARM P2C4NB    WQ0007  70       Order Number
     C                     PARM P3I1NY    WQ0008  70       Ship To Custome
     C           YL0023    PARM YL0023    WQ0009 112       Order Value Tot
     C           YL0024    PARM *ZERO     WQ0010 112       Order Weight To
     C                     PARM 'OE'      WQ0011  3        Pricing Event C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Numeric Value      RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV8CD           Company Value C
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVE *BLANK    WAV8CD           Company Value C
     C                     MOVEL'HPBPLT'  WAV8CD           Company Value C
      * Establish starting position
     C           KRSSA     CHAIN@KMREHC              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2221' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAM8NB    YL0001           System Value Nu
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Crt HPB Order     RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  3        Transfer Wareho
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBC4NB    WQSB01           Order Number
     C           *LIKE     DEFN WBAIC3    WQSB02           Company Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Order Number
     C                     KFLD           WQSB02           Company Number
      * Setup key
     C                     Z-ADDP2C4NB    WQSB01           Order Number
     C                     Z-ADDP1AIC3    WQSB02           Company Number
      * Establish starting position
     C           KRSSB     SETLL@BFCPY2                    *
     C           KRSSB     READE@BFCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP3I1NY    WL0001           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0002    P      Customer Name
     C                     MOVELWL0003    YL0003    P      Address Line 1
     C                     MOVELWL0004    YL0004    P      Address Line 2
     C                     MOVELWL0005    YL0005    P      Address Line 3
     C                     MOVELWL0006    YL0006    P      City
     C                     MOVELWL0007    YL0007    P      State Code
     C                     MOVELWL0008    YL0008    P      Zip/Postal Code
      * RTV Customer A/R Cust  RT - Customer  * 
     C                     EXSR SDRVGN
      * RTV Cust Name/Addr     RT - Customer  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0010    WL0001           Ship To Custome
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0011    P      Customer Name
     C                     MOVELWL0003    YL0012    P      Address Line 1
     C                     MOVELWL0004    YL0013    P      Address Line 2
     C                     MOVELWL0005    YL0014    P      Address Line 3
     C                     MOVELWL0006    YL0015    P      City
     C                     MOVELWL0007    YL0016    P      State Code
     C                     MOVELWL0008    YL0017    P      Zip/Postal Code
      * Rtv absorbed rate for new company cust        RMC 6/7/6
      * RTV Abs Freight Rate   RT - Company Customer  * 
     C                     EXSR SERVGN
      * CRT Order Header       CR - Order Header TRG  * 
     C                     EXSR SFCRRC
      * Rtv & Crt HPB Order   RT - Order Events  * 
     C                     EXSR SGRVGN
      * R6965 rmc 8/16/16 new hpb plant
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0001    WQ0003  30       Company Number
     C                     PARM 'INTWHS'  WQ0004 10        Company Value C
     C           WN0001    PARM *BLANK    WQ0005 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv & Crt HPB Ord f/I RT - Order Detail  * 
     C                     EXSR SIRVGN
     C           KRSSB     READE@BFCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Cust Name/Addr     RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWL0001    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSC     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCAYTX    WL0002           Customer Name
     C                     MOVELWCACNA    WL0003           Address Line 1
     C                     MOVELWCADNA    WL0004           Address Line 2
     C                     MOVELWCAENA    WL0005           Address Line 3
     C                     MOVELWCAJNA    WL0006           City
     C                     MOVELWCBGCD    WL0007           State Code
     C                     MOVELWCBTTX    WL0008           Zip/Postal Code
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Customer A/R Cust  RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP3I1NY    WCBKC7           Ship To Custome
      * Establish starting position
     C           KRSSD     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCANC7    YL0009           A/R Customer Nu
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Abs Freight Rate   RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDYL0001    WDAIC3           Company Number
     C                     Z-ADDYL0018    WDBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@EOREXM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUTBNB           Absorbed Freigh
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDTBNB    WUTBNB           Absorbed Freigh
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCRRC    BEGSR
      *================================================================
      * CRT Order Header       CR - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0002  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0003 12        Accounts Receiv
     C                     MOVEL*BLANK    WN0004  1        EDI Status 1
     C                     MOVEL*BLANK    WN0005  1        EDI Status 2
     C                     MOVEL*BLANK    WN0006  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0007  60       Job Time
     C                     MOVEL*BLANK    WN0008 10        User Id
     C                     MOVEL*BLANK    WN0009 10        Job Name
     C                     Z-ADD*ZERO     WN0010  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BECPFJ
     C                     Z-ADDYL0001    WEAIC3           Company Number
     C                     Z-ADDWBC4NB    WEC4NB           Order Number
     C                     MOVELWBJNCD    WEJNCD           Order Type - Sa
     C                     Z-ADDYL0009    WEANC7           A/R Customer Nu
     C                     Z-ADDP3I1NY    WEBKC7           Ship To Custome
     C                     MOVELYL0002    WEBRTX           Ship To Name
     C                     MOVELYL0003    WEHMNA           Ship To Address
     C                     MOVELYL0004    WEHONA           Ship To Address
     C                     MOVELYL0005    WEHPNA           Ship To Address
     C                     MOVELYL0006    WEHNNA           Ship To City
     C                     MOVELYL0007    WEDBCD           Ship To State C
     C                     MOVELYL0008    WECKTX           Ship To Zip/Pos
     C                     Z-ADDYL0009    WEB0C7           Bill to Custome
     C                     MOVELYL0011    WEAETX           Bill to Name
     C                     MOVELYL0012    WEB1NA           Bill to Address
     C                     MOVELYL0013    WEB3NA           Bill to Address
     C                     MOVELYL0014    WEB4NA           Bill to Address
     C                     MOVELYL0015    WEB2NA           Bill to City
     C                     MOVELYL0016    WEBHCD           Bill to State C
     C                     MOVELYL0017    WEC8TX           Bill to Zip/Pos
     C                     MOVELWBBCNA    WEBCNA           Customer Purcha
     C                     Z-ADDWBA0DT    WEA0DT           Order Date
     C                     Z-ADDWBA5DT    WEA5DT           Requested Ship
     C                     Z-ADDWBGNDT    WEGNDT           Actual Shipped
     C                     Z-ADDWBACDT    WEACDT           Cancel Date
     C                     MOVELWBAQCD    WEAQCD           Terms Code
     C                     MOVELWBB6NA    WEB6NA           Special Instruc
     C                     MOVELWBBYNA    WEBYNA           Special Instruc
     C                     MOVELWBBZNA    WEBZNA           Carrier Code
     C                     MOVELWBGTST    WEGTST           Comment Print A
     C                     MOVELWBGVST    WEGVST           Comment Print I
     C                     MOVELWBGUST    WEGUST           Comment Print P
     C                     MOVELWBQFST    WEQFST           Comment Print S
     C                     MOVELWBCQCD    WECQCD           Reason Code
     C                     MOVELWBGJST    WEGJST           Order in Use
     C                     MOVELWBGWST    WEGWST           Header Status
     C                     MOVELWBGXST    WEGXST           Header Status L
     C                     MOVELWBGYST    WEGYST           Order Type Prin
     C                     Z-ADDWBAODT    WEAODT           Scheduled Ship
     C                     MOVELWBAIVN    WEAIVN           User Original E
     C                     Z-ADDWBCXDT    WECXDT           Date of Origina
     C                     Z-ADDWBJZVA    WEJZVA           Order Value Tot
     C                     Z-ADDWBA1WG    WEA1WG           Order Weight To
     C                     MOVELWBXIST    WEXIST           Credit Hold
     C                     MOVELWBXJST    WEXJST           Production Hold
     C                     MOVELWBXKST    WEXKST           New Customer Ho
     C                     Z-ADDWBEIDT    WEEIDT           Requested Deliv
     C                     Z-ADDWBAFTM    WEAFTM           Requested Deliv
     C                     Z-ADDWBRMNB    WERMNB           Load ID
     C                     Z-ADDWUTBNB    WETBNB           Absorbed Freigh
     C                     Z-ADDWBR1NB    WER1NB           Rated Freight
     C                     MOVELWBPJST    WEPJST           LTL Flag
     C                     MOVELWBU0ST    WEU0ST           Price Audit
     C                     MOVELWBU1ST    WEU1ST           Price Status
     C                     MOVELWBQ2CD    WEQ2CD           Shipping Method
     C                     MOVELWBU2ST    WEU2ST           Export Status
     C                     MOVELWBVEST    WEVEST           Palletize
     C                     MOVELWBVFST    WEVFST           Shrink Wrap
     C                     MOVELWBVGST    WEVGST           Slip Sheet
     C                     MOVELWBRPCD    WERPCD           Age Code
     C                     Z-ADDWBRNNB    WERNNB           Reefer Temperat
     C                     MOVELWBVDST    WEVDST           Load Type
     C                     Z-ADDWBATIN    WEATIN           Attach to Invoi
     C                     MOVEL'N'       WEU4ST           Load Plan Order
     C                     MOVELWBU5ST    WEU5ST           Print Pick Slip
     C                     Z-ADDWBRSRN    WERSRN           Resell Referenc
     C                     MOVELWBMHNA    WEMHNA           Special Comment
     C                     MOVELWBMINA    WEMINA           Special Comment
     C                     MOVELWBWBST    WEWBST           Affect Auto Acc
     C                     MOVELWBR4CD    WER4CD           Sales Route Cod
     C                     MOVELWBBFCD    WEBFCD           Manager Level C
     C                     MOVELWBQ4CD    WEQ4CD           VP Level Code
     C                     Z-ADDWBT3NB    WET3NB           Attach to Order
     C                     MOVELWBSICD    WESICD           Reason for Pric
     C                     Z-ADDWBCONB    WECONB           Invoice Number
     C                     MOVELWBCEST    WECEST           Invoice Suffix
     C                     Z-ADDWBAWDT    WEAWDT           Invoice Date
     C                     MOVELWBJPCD    WEJPCD           Event Code
     C                     MOVELWBXUST    WEXUST           Trans Contol AS
     C                     MOVELWBZ1ST    WEZ1ST           Modified Flag
     C                     Z-ADDWBVRVA    WEVRVA           A/R order Value
     C                     MOVELWBOBST    WEOBST           Billing Activit
     C                     MOVELWBBCST    WEBCST           Block Order Fla
     C                     MOVELWBBDST    WEBDST           Order Certifica
     C                     Z-ADDWBB7VL    WEB7VL           Invoice Order V
     C                     MOVELWBGASX    WEGASX           Process Sts for
     C                     MOVELWBGBSX    WEGBSX           Order Conf Fax
     C                     MOVELWBGCSX    WEGCSX           Manifest Fax St
     C                     MOVELWBGDSX    WEGDSX           Invoice Fax Sts
     C                     MOVELWBFNSX    WEFNSX           Transfer in Sto
     C                     MOVELWBFOSX    WEFOSX           Email Cust On O
     C                     MOVELWBFPSX    WEFPSX           Order Emailed
     C                     MOVELWBFQSX    WEFQSX           Export Docs Go
     C                     MOVELWBFRSX    WEFRSX           Shipping Temp C
     C                     MOVELWBFSSX    WEFSSX           Broker Order St
     C                     MOVELWBFTSX    WEFTSX           Air Freight Ord
     C                     MOVELWBFUSX    WEFUSX           Order Requires
     C                     MOVELWBFVSX    WEFVSX           OH Load Plan Re
     C                     MOVELWBFWSX    WEFWSX           Export USDA App
     C                     MOVELWBFXSX    WEFXSX           HPB Ship to War
     C                     MOVELWBFYSX    WEFYSX           OH TF Exempt Co
     C                     Z-ADDWBNODT    WENODT           OH Appt Confirm
     C                     Z-ADDWBNPDT    WENPDT           JPN Invoice Iss
     C                     Z-ADDWBNQDT    WENQDT           Load Actual Shi
     C                     Z-ADDWBNRDT    WENRDT           Load BOL Comple
     C                     Z-ADDWBNSDT    WENSDT           Load Truck Depa
     C                     Z-ADDWBBPTM    WEBPTM           Maximum Gross W
     C                     Z-ADDWBBQTM    WEBQTM           Time of Origina
     C                     Z-ADDWBBRTM    WEBRTM           OH Appt Confirm
     C                     Z-ADDWBBSTM    WEBSTM           Load BOL Comple
     C                     Z-ADDWBBTTM    WEBTTM           Load Truck Depa
     C                     Z-ADDWBH0NX    WEH0NX           Act Frt Referen
     C                     Z-ADDWBH1NX    WEH1NX           Act Non-Ref Frt
     C                     Z-ADDWBH2NX    WEH2NX           OH Fuel Surchar
     C                     Z-ADDWBH3NX    WEH3NX           OH Total Non-Re
     C                     Z-ADDWBH4NX    WEH4NX           OH Total Ref Fr
     C                     Z-ADDWBC0C7    WEC0C7           Claim Number
      *
      * USER: Processing before Data update
     C                     MOVEL*BLANK    WERPCD           Age Code
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##JOB     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WECXDT    PARM *ZERO     WQ0001 155       Current System
     C           WEBQTM    PARM *ZERO     WQ0002 155       Current System
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSF    SETLL@BECPFJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0177' W0RTN   7
      * USER: Processing if Data record already exists
      * ** Set flag so it can be tested on the return    T075 03/28/2006
     C                     MOVEL'Y2U0003' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C                     WRITE@BECPFJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv & Crt HPB Order   RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSG01           Company Number
     C                     Z-ADDWBC4NB    WQSG02           Order Number
      * Establish starting position
     C           KRSSG     SETLL@EYCPY2                    *
     C           KRSSG     READE@EYCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT OP Order Event PRG CR - Order Events  * 
     C                     EXSR SHCRRC
     C           KRSSG     READE@EYCPY2                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT OP Order Event PRG CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0011  1        EDI Status 1
     C                     MOVEL*BLANK    WN0012  1        EDI Status 2
     C                     MOVEL*BLANK    WN0013  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0014  60       Job Time
     C                     MOVEL*BLANK    WN0015 10        User Id
     C                     MOVEL*BLANK    WN0016 10        Job Name
     C                     Z-ADD*ZERO     WN0017  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPD5
     C                     Z-ADDYL0001    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFQ2NB    WGQ2NB           Event Number
     C                     MOVELWFJPCD    WGJPCD           Event Code
     C                     Z-ADDWFAUC3    WGAUC3           Invoice/Memo Co
     C                     Z-ADDWFQ7NB    WGQ7NB           Invoice/Memo Nu
     C                     MOVELWFOMST    WGOMST           Invoice/Memo Su
     C                     Z-ADDWFD2DT    WGD2DT           Event Date
     C                     MOVELWFONST    WGONST           Activity Comple
     C                     MOVELWFOOST    WGOOST           Activity Hold
     C                     MOVELWFOPST    WGOPST           Post Cash Compl
     C                     Z-ADDWFAWC3    WGAWC3           Cross Event Ref
     C                     Z-ADDWFQ8NB    WGQ8NB           Cross Event Ref
     C                     Z-ADDWFQ9NB    WGQ9NB           Cross Event Ref
     C                     Z-ADDWFBKC7    WGBKC7           Ship To Custome
      *
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@EYCPD5                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPD5                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv & Crt HPB Ord f/I RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * FP1322 RMC new routine
      * Rtv Productin Whs     RT - Warehouse  * 
     C                     EXSR SJRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSI02           Order Number
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSI01           Company Number
     C                     Z-ADDP2C4NB    WQSI02           Order Number
      * Establish starting position
     C           KRSSI     SETLL@BGWKL1                    *
     C           KRSSI     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WHGMST    IFEQ 'X'                        *IF
      * dont xfr cancelled items - physically delete them instead 3/26/08
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWHLQCD    YL0020           Commodity Marke
     C                     MOVELWHQ7CD    YL0021           Price Method Co
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Item Code is B100
      *   |- c2    : DB1.Item Code is D100
      *   '-
     C           WHHGCD    IFEQ 11000                      *IF
     C           WHHGCD    OREQ 15000                      *OR
     C                     MOVEL'B10'     YL0020           Commodity Marke
     C                     MOVEL'TRF'     YL0021           Price Method Co
     C                     ELSE
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Item Code is B99.9
      *   |- c2    : DB1.Item Code is D99.9
      *   '-
     C           WHHGCD    IFEQ 10999                      *IF
     C           WHHGCD    OREQ 14999                      *OR
     C                     MOVEL'B99'     YL0020           Commodity Marke
     C                     MOVEL'TRF'     YL0021           Price Method Co
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.Date Method Code is Entered
     C           WHRDCD    IFNE *BLANK                     *IF
     C                     MOVELWHRDCD    YL0022           Date Method Cod
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'DOS'     YL0022           Date Method Cod
     C                     END                             *FI
      * CRT PD Order Detl PRG  CR - Order Detail  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
     C           KRSSI     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Productin Whs     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0001    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0019           Production Ware
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIAOCD    YL0019           Production Ware
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT PD Order Detl PRG  CR - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BGWKEC
     C                     Z-ADDYL0001    WJAIC3           Company Number
     C                     Z-ADDWHC4NB    WJC4NB           Order Number
     C                     Z-ADDWHDPNB    WJDPNB           Order Sequence
     C                     Z-ADDWHUENB    WJUENB           Order Secondary
     C                     Z-ADDWHHGCD    WJHGCD           Item Code
     C                     MOVELWN0001    WJAJCD           Warehouse Code
     C                     Z-ADDP3I1NY    WJBKC7           Ship To Custome
     C                     Z-ADDWHCFC7    WJCFC7           Order Group Cod
     C                     MOVELWHGMST    WJGMST           Detail Line Sta
     C                     MOVELWHGNST    WJGNST           Detail Line Sta
     C                     Z-ADDWHMAVA    WJMAVA           Billing Detail
     C                     Z-ADDWHKDVA    WJKDVA           Billing Detail
     C                     Z-ADDWHL8VA    WJL8VA           Billing Detail
     C                     Z-ADDWHL9VA    WJL9VA           Quantity to Sub
     C                     MOVELWHGTST    WJGTST           Comment Print A
     C                     MOVELWHGVST    WJGVST           Comment Print I
     C                     MOVELWHGUST    WJGUST           Comment Print P
     C                     MOVELWHQFST    WJQFST           Comment Print S
     C                     Z-ADDWHAYVA    WJAYVA           Extended Amount
     C                     Z-ADDWHEXDT    WJEXDT           Market Pricing
     C                     MOVELYL0020    WJLQCD           Commodity Marke
     C                     MOVELYL0022    WJRDCD           Date Method Cod
     C                     MOVELYL0021    WJQ7CD           Price Method Co
     C                     Z-ADD0         WJBZPR           Price Overage O
     C                     Z-ADDWHL6NB    WJL6NB           Contract Number
     C                     MOVELWHU1ST    WJU1ST           Price Status
     C                     Z-ADDWHGIDT    WJGIDT           Pricing Date Us
     C                     MOVELWHCRCD    WJCRCD           U/M - Base Pric
     C                     MOVELWHAGCD    WJAGCD           U/M - Ordered
     C                     MOVELWHRZST    WJRZST           Work Confirm St
     C                     MOVELWHR0ST    WJR0ST           Work Over/Short
     C                     MOVELWHR1ST    WJR1ST           OD Production P
     C                     MOVELWHG7NA    WJG7NA           Order Desc. Lin
     C                     MOVELWHG8NA    WJG8NA           Order Desc. Lin
     C                     MOVELWHRPCD    WJRPCD           Age Code
     C                     MOVELWHVEST    WJVEST           Palletize
     C                     MOVELWHVGST    WJVGST           Slip Sheet
     C                     MOVELWHAVST    WJAVST           Catch Weight St
     C                     MOVEL'A'       WJU0ST           Price Audit
     C                     MOVEL*BLANK    WJRFCD           Price Audit Rea
     C                     MOVELWHFZST    WJFZST           Production Date
     C                     Z-ADDWHR1NB    WJR1NB           Rated Freight
     C                     Z-ADDWHAVQT    WJAVQT           Quantity Ordere
     C                     Z-ADDWHD0WG    WJD0WG           Weight Ordered
     C                     Z-ADDWHCCQT    WJCCQT           Quantity Schedu
     C                     Z-ADDWHAUWG    WJAUWG           Weight Schedule
     C                     Z-ADDWHCBQT    WJCBQT           Quantity Shippe
     C                     Z-ADDWHATWG    WJATWG           Weight Shipped
     C                     Z-ADDWHAQCS    WJAQCS           Unit Cost Prici
     C                     Z-ADDWHAGCS    WJAGCS           Unit Cost Per P
     C                     Z-ADDWHAKPR    WJAKPR           Unit Price
     C                     Z-ADDWHALPR    WJALPR           Unit Price - Cr
     C                     Z-ADDWHAUPR    WJAUPR           Unit Price Orde
     C                     Z-ADDWHAVWG    WJAVWG           Unit Weight Ord
     C                     Z-ADDWHA4WG    WJA4WG           Tare Weight Tot
     C                     Z-ADDWHA5DT    WJA5DT           Requested Ship
     C                     Z-ADDWHAODT    WJAODT           Scheduled Ship
     C                     Z-ADDWHGNDT    WJGNDT           Actual Shipped
     C                     MOVELWHAMST    WJAMST           Affect Inventor
     C                     MOVELWHANST    WJANST           Affect Sales Do
     C                     MOVELWHVAST    WJVAST           Affect Sales Pn
     C                     Z-ADDWHRGNB    WJRGNB           Item Structure
     C                     Z-ADDWHRHNB    WJRHNB           Item Structure
     C                     Z-ADDWHRINB    WJRINB           Item Structure
     C                     MOVELWHRBCD    WJRBCD           Item Level
     C                     MOVELWHHICD    WJHICD           Quality Level
     C                     MOVELWHRNCD    WJRNCD           Pricing Product
     C                     MOVELWHROCD    WJROCD           Season Product
     C                     Z-ADDWHCXDT    WJCXDT           Date of Origina
     C                     MOVELWHAJVN    WJAJVN           User Profile Na
     C                     MOVELWHKXCD    WJKXCD           Country Code
     C                     MOVELWHJPCD    WJJPCD           Event Code
     C                     MOVELWHCQCD    WJCQCD           Reason Code
     C                     MOVELWHR4CD    WJR4CD           Sales Route Cod
     C                     MOVELWHZ1ST    WJZ1ST           Modified Flag
     C                     MOVELWHZ3ST    WJZ3ST           Substituted Fla
     C                     MOVELWHZ4ST    WJZ4ST           OD Schedule Ove
     C                     Z-ADDWHDUPR    WJDUPR           Invoice Unit Pr
     C                     Z-ADDWHB6VL    WJB6VL           Invoice Extende
     C                     Z-ADDWHA1AA    WJA1AA           Ham Group Numbe
     C                     MOVELWHFZSX    WJFZSX           OD Adj Type Ove
     C                     MOVELWHF0SX    WJF0SX           Affect Trade Fu
     C                     MOVELWHF1SX    WJF1SX           Affect Commissi
     C                     MOVELWHF2SX    WJF2SX           Affect Pricing
     C                     MOVELWHF3SX    WJF3SX           Released by Use
     C                     MOVELWHF4SX    WJF4SX           Ord TF Exempt C
     C                     MOVELWHF5SX    WJF5SX           OD Pallet Type
     C                     MOVELYL0019    WJF6SX           Production Ware
     C                     MOVELWHF7SX    WJF7SX           OD Price Type
     C                     Z-ADDWHNTDT    WJNTDT           Warehouse Palle
     C                     Z-ADDWHNUDT    WJNUDT           Consumed Item C
     C                     Z-ADDWHNVDT    WJNVDT           Deadline Depart
     C                     Z-ADDWHNWDT    WJNWDT           OD Price Type R
     C                     Z-ADDWHNXDT    WJNXDT           OD Unused Date
     C                     Z-ADDWHBUTM    WJBUTM           Deadline Depart
     C                     Z-ADDWHBVTM    WJBVTM           Price Code
     C                     Z-ADDWHBWTM    WJBWTM           Maximum Net Wei
     C                     Z-ADDWHBXTM    WJBXTM           Substitution Li
     C                     Z-ADDWHBYTM    WJBYTM           Max Qty to sche
     C                     Z-ADDWHH5NX    WJH5NX           Warehouse Palle
     C                     Z-ADDWHH6NX    WJH6NX           Warehouse Avg P
     C                     Z-ADDWHH7NX    WJH7NX           OD Item Target
     C                     Z-ADDWHH8NX    WJH8NX           OD Estimated Gr
     C                     Z-ADDWHH9NX    WJH9NX           OD Maximum Unit
     C                     Z-ADDWHDVPR    WJDVPR           Order Gate/Fina
     C                     Z-ADDWHDWPR    WJDWPR           OD Ceiling Pric
     C                     Z-ADDWHDXPR    WJDXPR           OD Gate/Final P
     C                     Z-ADDWHDYPR    WJDYPR           OD Weighted Avg
     C                     Z-ADDWHDZPR    WJDZPR           OD Unused Prc 5
     C                     Z-ADDWHGSPR    WJGSPR           OD Unused Prc 6
     C                     Z-ADDWHGTPR    WJGTPR           OD Unused Prc 7
     C                     Z-ADDWHGUPR    WJGUPR           OD Unused Prc 8
     C                     MOVELWHHOST    WJHOST           OD MPR Sent to
     C                     MOVELWHHPST    WJHPST           OD MPR Prc Read
     C                     MOVELWHIOST    WJIOST           OD UnUsed Price
     C                     Z-ADDWHPEWG    WJPEWG           Weight Amount E
     C                     Z-ADDWHRINY    WJRINY           Item Age Days
     C                     Z-ADDWHTIDT    WJTIDT           Production Ovr
     C                     Z-ADDWHTJDT    WJTJDT           Production Ovr
     C                     MOVELWHH2ST    WJH2ST           OD UnUsed Statu
     C                     MOVELWHH0ST    WJH0ST           OD Clm Full Ret
     C                     MOVELWHH1ST    WJH1ST           Order Line Erro
     C                     Z-ADDWHTKDT    WJTKDT           OD Market Begin
     C                     Z-ADDWHTLDT    WJTLDT           OD Market Endin
     C                     Z-ADDWHTMDT    WJTMDT           OD Atch to Ord
     C                     MOVELWHUVST    WJUVST           EDI Status 1
     C                     MOVELWHUWST    WJUWST           EDI Status 2
     C                     MOVELWHUXST    WJUXST           EDI Status 3
     C                     Z-ADDWHAATM    WJAATM           Job Time
     C                     MOVELWHAYNA    WJAYNA           User Id
     C                     MOVELWHA0NA    WJA0NA           Job Name
     C                     Z-ADDWHAXDT    WJAXDT           Job Date
      *
      * USER: Processing before Data update
      * ** Do not change the dates when purging       C001078
     C           KLCRSK    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJC4NB           Order Number
     C                     KFLD           WJDPNB           Order Sequence
     C                     KFLD           WJUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRSK    SETLL@BGWKEC                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1310' W0RTN   7
      * Send message 'Order Detail           EX'
     C                     MOVEL'USR1310' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@BGWKEC                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * DOC:  Create order with company 361 and ship to data as biodiese
      *================================================================
      * Create order with accounting company
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WBNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WBNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WBNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WBNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WBBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WBBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCP3NB           D & B Number
     C                     Z-ADD*ZERO     WCI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WCAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBTC7           Parent Customer
     C                     Z-ADD*ZERO     WCS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WCVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WCI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Define work field Absorbed Freight Rate CWT
     C                     Z-ADD*ZERO     WUTBNB  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDR5NB           Deliver after t
     C                     Z-ADD*ZERO     WDR6NB           Deliver before
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WDW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Clear all neither parameters
      * CRT Order Header       CR - Order Header TRG  * 
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFQ2NB           Event Number
     C                     Z-ADD*ZERO     WFAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WFQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WFD2DT           Event Date
     C                     Z-ADD*ZERO     WFAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WFQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WFQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Clear all neither parameters
      * CRT OP Order Event PRG CR - Order Events  * 
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WHMAVA           Billing Detail
     C                     Z-ADD*ZERO     WHKDVA           Billing Detail
     C                     Z-ADD*ZERO     WHL8VA           Billing Detail
     C                     Z-ADD*ZERO     WHL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WHAYVA           Extended Amount
     C                     Z-ADD*ZERO     WHEXDT           Market Pricing
     C                     Z-ADD*ZERO     WHBZPR           Price Overage O
     C                     Z-ADD*ZERO     WHL6NB           Contract Number
     C                     Z-ADD*ZERO     WHGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WHR1NB           Rated Freight
     C                     Z-ADD*ZERO     WHAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WHD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WHCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WHAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WHCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WHATWG           Weight Shipped
     C                     Z-ADD*ZERO     WHAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAKPR           Unit Price
     C                     Z-ADD*ZERO     WHALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WHAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WHAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WHA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WHA5DT           Requested Ship
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHCXDT           Date of Origina
     C                     Z-ADD*ZERO     WHDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WHB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WHA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WHNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WHNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WHNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WHNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WHNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WHBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WHBVTM           Price Code
     C                     Z-ADD*ZERO     WHBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WHBXTM           Substitution Li
     C                     Z-ADD*ZERO     WHBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WHH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WHH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WHH7NX           OD Item Target
     C                     Z-ADD*ZERO     WHH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WHH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WHDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WHDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WHDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WHDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WHDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WHGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WHGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WHGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WHPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WHRINY           Item Age Days
     C                     Z-ADD*ZERO     WHTIDT           Production Ovr
     C                     Z-ADD*ZERO     WHTJDT           Production Ovr
     C                     Z-ADD*ZERO     WHTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WHTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WHTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WIBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WIBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WIBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WIBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002 30
     C                     MOVEL*BLANK    WL0003 30
     C                     MOVEL*BLANK    WL0004 30
     C                     MOVEL*BLANK    WL0005 30
     C                     MOVEL*BLANK    WL0006 20
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008 11
      * Define local work field USR Hold Company Number
     C                     Z-ADD*ZERO     YL0001  30
      * Define local work field Customer Name
     C                     MOVEL*BLANK    YL0002 30
      * Define local work field Address Line 1
     C                     MOVEL*BLANK    YL0003 30
      * Define local work field Address Line 2
     C                     MOVEL*BLANK    YL0004 30
      * Define local work field Address Line 3
     C                     MOVEL*BLANK    YL0005 30
      * Define local work field City
     C                     MOVEL*BLANK    YL0006 20
      * Define local work field State Code
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Zip/Postal Code
     C                     MOVEL*BLANK    YL0008 11
      * Define local work field A/R Customer Number
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field A/R Customer
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Bill to Name
     C                     MOVEL*BLANK    YL0011 30
      * Define local work field Bill to Address Line 1
     C                     MOVEL*BLANK    YL0012 30
      * Define local work field Bill to Address Line 2
     C                     MOVEL*BLANK    YL0013 30
      * Define local work field Bill to Address Line 3
     C                     MOVEL*BLANK    YL0014 30
      * Define local work field Bill to City
     C                     MOVEL*BLANK    YL0015 20
      * Define local work field Bill to State Code
     C                     MOVEL*BLANK    YL0016  2
      * Define local work field Bill to Zip/Postal Code
     C                     MOVEL*BLANK    YL0017 11
      * Define local work field Sold To Customer-hpb biod
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Production Warehouse
     C                     MOVEL*BLANK    YL0019  3
      * Define null work field Accounting Company
     C                     Z-ADD*ZERO     YN0001  30
      * Define local work field Commodity Market Code
     C                     MOVEL*BLANK    YL0020  3
      * Define local work field Price Method Code
     C                     MOVEL*BLANK    YL0021  3
      * Define local work field Date Method Code
     C                     MOVEL*BLANK    YL0022  3
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field Order Weight Total
     C                     Z-ADD*ZERO     YL0024 112
      *================================================================
     CSR         ZZEXIT    ENDSR
