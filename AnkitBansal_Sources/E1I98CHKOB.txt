/*********************************************************************/
/*                                                                   */
/*  Program. . . . . . . E1I98CHKOB copied from J98CHKOB             */
/*                                                                   */
/*  Description. . . . . Check Object Existence, Member, Authoriz.   */
/*                                                                   */
/*  Program Revision Log                                             */
/*  --------------------                                             */
/*                                                                   */
/*       Date        Programmer        Description                   */
/*     --------      ----------     -------------------------------- */
/*     02/03/95       Kreutz        SAR #  867923                    */
/*      5/06/20       Baden         SAR #  SDN465                    */
/*                                                                   */
/*********************************************************************/
             PGM        PARM(&PSOBJ &PSLIBO &PSTYPE &PSMID &PSAUT +
                          &PSERR)
             DCL        VAR(&PSOBJ  ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PSLIBO ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PSTYPE ) TYPE(*CHAR) LEN(8 )
             DCL        VAR(&PSMID  ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PSAUT  ) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PSERR  ) TYPE(*CHAR) LEN(1 )
             DCL        VAR(&RMTCMD ) TYPE(*CHAR) LEN(500)
             DCL        VAR(&LANGMSGF)    TYPE(*CHAR)  LEN(10)
/*                                                                   */
/* --------- Global CPF error intercept ---------------------------- */
/*                                                                   */
             MONMSG     MSGID(CPF0000 CPC0000 CPD0000) EXEC(GOTO +
                          CMDLBL(ABEND))
/*                                                                   */
/* --------- Load default values in parameters --------------------- */
/*                                                                   */
             IF         COND((&PSOBJ *EQ ' ') *OR (&PSOBJ *EQ '&')) +
                          THEN(DO)
                 CHGVAR     VAR(&PSERR) VALUE('1')
                 GOTO       CMDLBL(EOJ)
             ENDDO
             IF         COND((&PSTYPE *EQ ' ') *OR (&PSTYPE *EQ '&')) +
                              THEN(DO)
                 CHGVAR     VAR(&PSERR) VALUE('1')
                 GOTO       CMDLBL(EOJ)
             ENDDO
             CHGVAR     VAR(&PSERR ) VALUE(' ')
             IF         COND((&PSLIBO *EQ ' ') *OR (&PSLIBO *EQ '&')) +
                          THEN(DO)
                 CHGVAR     VAR(&PSLIBO) VALUE('*LIBL')
             ENDDO
             IF         COND((&PSMID *EQ ' ') *OR (&PSMID *EQ '&')) +
                          THEN(DO)
                 CHGVAR     VAR(&PSMID) VALUE('*NONE')
             ENDDO
             IF         COND((&PSAUT *EQ ' ') *OR (&PSAUT *EQ '&')) +
                          THEN(DO)
                 CHGVAR     VAR(&PSAUT) VALUE('*NONE')
             ENDDO
/*                                                                   */
/* --------- Check object command ---------------------------------- */
/*                                                                   */
             CHKOBJ OBJ(&PSLIBO/&PSOBJ) OBJTYPE(&PSTYPE) MBR(&PSMID) +
                    AUT(&PSAUT)
/*---------- Syntax error on command (e.g. invalid name) ------------*/
             MONMSG     MSGID(CPF0001) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('7')
                 GOTO       EOJ
             ENDDO
/*---------- Object not found ---------------------------------------*/
             MONMSG     MSGID(CPF9801) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('1')
                 GOTO       EOJ
             ENDDO
/*---------- Not authorized to object -------------------------------*/
             MONMSG     MSGID(CPF9802) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('2')
                 GOTO       EOJ
             ENDDO
/*---------- Library not found --------------------------------------*/
             MONMSG     MSGID(CPF9810) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('3')
                 GOTO       EOJ
             ENDDO
/*---------- Member not found ---------------------------------------*/
             MONMSG     MSGID(CPF9815) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('4')
                 GOTO       EOJ
             ENDDO
/*---------- Not authorized to library ------------------------------*/
             MONMSG     MSGID(CPF9820) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('5')
                 GOTO       EOJ
             ENDDO
/*---------- Unable to allocate library -----------------------------*/
             MONMSG     MSGID(CPF9830) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('6')
                 GOTO       EOJ
             ENDDO
             MONMSG     MSGID(CPF9899)  EXEC(DO)
/*                                                                   */
/* --------- Check object command ---------------------------------- */
/*                                                                   */
         CHGVAR    &RMTCMD ('CHKOBJ OBJ(' || &PSLIBO |< '/' || &PSOBJ +
                      |< ') OBJTYPE(' || &PSTYPE |< ') MBR(' || +
                      &PSMID |< ') AUT(' || &PSAUT |< ')')
             SBMRMTCMD  CMD(&RMTCMD) DDMFILE(&PSLIBO/&PSOBJ)
/*---------- Syntax error on command (e.g. invalid name) ------------*/
             MONMSG     MSGID(CPF0001) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('7')
                 GOTO       EOJ
             ENDDO
/*---------- Object not found ---------------------------------------*/
             MONMSG     MSGID(CPF9801) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('1')
                 GOTO       EOJ
             ENDDO
/*---------- Not authorized to object -------------------------------*/
             MONMSG     MSGID(CPF9802) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('2')
                 GOTO       EOJ
             ENDDO
/*---------- Library not found --------------------------------------*/
             MONMSG     MSGID(CPF9810) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('3')
                 GOTO       EOJ
             ENDDO
/*---------- Member not found ---------------------------------------*/
             MONMSG     MSGID(CPF9815) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('4')
                 GOTO       EOJ
             ENDDO
/*---------- Not authorized to library ------------------------------*/
             MONMSG     MSGID(CPF9820) EXEC(DO)
              RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
              CHGVAR     VAR(&PSERR) VALUE('5')
              GOTO       EOJ
             ENDDO
/*---------- Unable to allocate library -----------------------------*/
             MONMSG     MSGID(CPF9830) EXEC(DO)
                 RCVMSG     PGMQ(*SAME) MSGQ(*PGMQ) RMV(*YES)
                 CHGVAR     VAR(&PSERR) VALUE('6')
                 GOTO       EOJ
             ENDDO
         ENDDO
/*                                                                   */
/* --------- Branch to normal EOJ ---------------------------------- */
/*                                                                   */
             RMVMSG     CLEAR(*ALL)
GOTO  EOJ
/* --------- Abnormal end of job processing ------------------------ */
/* --------- Override JDE Message File for Language Preference ----- */
ABEND:
/*           CALL PGM(J98850) PARM(&LANGMSGF)                        */
             CALL PGM(E1I98850) PARM(&LANGMSGF)
                  MONMSG MSGID(CPF0000 CPD0000 CPC0000)
             OVRMSGF MSGF(QJDEMSG)  TOMSGF(&LANGMSGF)
                  MONMSG MSGID(CPF0000 CPD0000 CPC0000)

/*          SNDPGMMSG MSGID(JDE9999) MSGF(QJDEMSG) MSGDTA('J98CHKOB') +
                  TOPGMQ(*EXT)                                       */
             SNDPGMMSG  MSGID(JDE9999) MSGF(QJDEMSG) +
                          MSGDTA('E1I98CHKOB') TOPGMQ(*EXT)
             MONMSG     MSGID(CPF0000 CPC0000 CPD0000)
             CHGJOB     LOG(4 00 *SECLVL) SWS(1XXXXXXX)
             MONMSG     MSGID(CPF0000 CPC0000 CPD0000)
             CHGVAR     VAR(&PSERR) VALUE('0')
/*                                                                   */
/* --------- End of Job -------------------------------------------- */
/*                                                                   */
EOJ:
             ENDPGM
