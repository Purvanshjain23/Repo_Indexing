     H/TITLE PFS Inv Physical FRSH XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 06/15/21  Time  : 14:52:31
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPPB0CPL3IF  E           K        DISK
      * RSQ : PFS Inventory Restoration Co/Whs/Dte/Tme/Seq
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FOMHCCPL1IF  E           K        DISK
      * RTV : Physical Count Control    Retrieval index
      *
     FOMHCCPL4IF  E           K        DISK
      * RSQ : Physical Count Control    RSQ Co, Whse, Code, Sts
      *
     FCAB0REL3IF  E           K        DISK
      * RSQ : Item Balance              RSQ by Cycle Count    V
      *
     FCAB1RELAIF  E           K        DISK
      * RSQ : Item Balance Detail       Co/Item/Whse/Prod Date(D
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCABZRELXIF  E           K        DISK
      * RSQ : Company Item              Active FinishGood/Wp
      *
     FCAB0RELJIF  E           K        DISK
      * RTV : Item Balance              Acitve records only
      *
     FPNG0REL1IF  E           K        DISK
      * RTV : EDI WHS Interchange       Retrieval index
      *
     FCAB1REL3IF  E           K        DISK
      * RSQ : Item Balance Detail      o/Whse Slct Phys Count
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FOMHCCPL0UF  E           K        DISK                      A
      * UPD : Physical Count Control    Update index
      *
     FCAB1REL1UF  E           K        DISK                      A
      * UPD : Item Balance Detail       Update index
      *
     FCAB0REL0IF  E           K        DISK                      A
      * UPD : Item Balance              Update index
      *
     FPPB0CPL0UF  E           K        DISK
      * UPD : PFS Inventory Restoration Update index
      *
      * Long constants
     E                    @CN#    1  08  6   @CN    25
     I@B0CPEP
      * PFS Inventory Restoration Co/Whs/Dte/Tme/Seq
      * Renamed input format fields
     I              B0Y1NX                          WAY1NX
     I              B0AID8                          WAAID8
     I              B0AFTS                          WAAFTS
     I              B0BCNY                          WABCNY
     I              B0XKSX                          WAXKSX
     I              B0Y2NX                          WAY2NX
     I              B0U4SX                          WAU4SX
     I              B0ADNY                          WAADNY
     I              B0P7DT                          WAP7DT
     I              B0Z4NX                          WAZ4NX
     I              B0ACNY                          WAACNY
     I              B0CUNY                          WACUNY
     I              B0CVNY                          WACVNY
     I              B0UWSX                          WAUWSX
     I              B0UXSX                          WAUXSX
     I              B0V3SX                          WAV3SX
     I              B0AHNY                          WAAHNY
     I              B0AINY                          WAAINY
     I              B0AJNY                          WAAJNY
     I              B0AKNY                          WAAKNY
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WBAJCD
     I              ADF8NA                          WBF8NA
     I              ADACNA                          WBACNA
     I              ADADNA                          WBADNA
     I              ADAENA                          WBAENA
     I              ADAJNA                          WBAJNA
     I              ADBTTX                          WBBTTX
     I              ADAOCD                          WBAOCD
     I              ADBGCD                          WBBGCD
     I              ADVHST                          WBVHST
     I              ADMPNA                          WBMPNA
     I              ADWPST                          WBWPST
     I              ADXUST                          WBXUST
     I              ADT0ST                          WBT0ST
     I              ADT1ST                          WBT1ST
     I              ADDBNB                          WBDBNB
     I              ADT2ST                          WBT2ST
     I              ADT3ST                          WBT3ST
     I              ADT4ST                          WBT4ST
     I              ADT6ST                          WBT6ST
     I              ADBWC3                          WBBWC3
     I              ADBTC3                          WBBTC3
     I              ADBUC3                          WBBUC3
     I              ADBVC3                          WBBVC3
     I              ADFCAA                          WBFCAA
     I              ADRQSX                          WBRQSX
     I              ADRRSX                          WBRRSX
     I              ADRSSX                          WBRSSX
     I              ADRTSX                          WBRTSX
     I              ADT7ST                          WBT7ST
     I              ADT8ST                          WBT8ST
     I              ADRNSX                          WBRNSX
     I              ADROSX                          WBROSX
     I              ADRPSX                          WBRPSX
     I              ADUVST                          WBUVST
     I              ADUWST                          WBUWST
     I              ADUXST                          WBUXST
     I              ADVSST                          WBVSST
     I              ADAATM                          WBAATM
     I              ADAYNA                          WBAYNA
     I              ADA0NA                          WBA0NA
     I              ADAXDT                          WBAXDT
      *
     I@HCCPJ0
      * Physical Count Control    Retrieval index
      * Renamed input format fields
     I              HCAIC3                          WCAIC3
     I              HCAJCD                          WCAJCD
     I              HCDHDT                          WCDHDT
     I              HCOFCD                          WCOFCD
     I              HCTGST                          WCTGST
     I              HCUVST                          WCUVST
     I              HCUWST                          WCUWST
     I              HCUXST                          WCUXST
     I              HCAATM                          WCAATM
     I              HCAYNA                          WCAYNA
     I              HCA0NA                          WCA0NA
     I              HCAXDT                          WCAXDT
      *
     I@HCCPJZ
      * Physical Count Control    Update index
      * Renamed input format fields
     I              HCAIC3                          WDAIC3
     I              HCAJCD                          WDAJCD
     I              HCDHDT                          WDDHDT
     I              HCOFCD                          WDOFCD
     I              HCTGST                          WDTGST
     I              HCUVST                          WDUVST
     I              HCUWST                          WDUWST
     I              HCUXST                          WDUXST
     I              HCAATM                          WDAATM
     I              HCAYNA                          WDAYNA
     I              HCA0NA                          WDA0NA
     I              HCAXDT                          WDAXDT
      *
     I@HCCPJ7
      * Physical Count Control    RSQ Co, Whse, Code, Sts
      * Renamed input format fields
     I              HCAIC3                          WEAIC3
     I              HCAJCD                          WEAJCD
     I              HCDHDT                          WEDHDT
     I              HCOFCD                          WEOFCD
     I              HCTGST                          WETGST
     I              HCUVST                          WEUVST
     I              HCUWST                          WEUWST
     I              HCUXST                          WEUXST
     I              HCAATM                          WEAATM
     I              HCAYNA                          WEAYNA
     I              HCA0NA                          WEA0NA
     I              HCAXDT                          WEAXDT
      *
     I@B0REK7
      * Item Balance              RSQ by Cycle Count    V
      * Renamed input format fields
     I              B0AIC3                          WFAIC3
     I              B0HGCD                          WFHGCD
     I              B0AJCD                          WFAJCD
     I              B0AGCS                          WFAGCS
     I              B0AECS                          WFAECS
     I              B0BACS                          WFBACS
     I              B0BBCS                          WFBBCS
     I              B0CBPR                          WFCBPR
     I              B0GUDT                          WFGUDT
     I              B0XYST                          WFXYST
     I              B0CTPR                          WFCTPR
     I              B0G4DT                          WFG4DT
     I              B0BOWG                          WFBOWG
     I              B0DDQT                          WFDDQT
     I              B0DEQT                          WFDEQT
     I              B0DFQT                          WFDFQT
     I              B0HDQT                          WFHDQT
     I              B0HEQT                          WFHEQT
     I              B0AJQT                          WFAJQT
     I              B0AQQT                          WFAQQT
     I              B0AUQT                          WFAUQT
     I              B0EMQT                          WFEMQT
     I              B0DOQT                          WFDOQT
     I              B0ATNA                          WFATNA
     I              B0AKDT                          WFAKDT
     I              B0ANDT                          WFANDT
     I              B0IDVA                          WFIDVA
     I              B0JVST                          WFJVST
     I              B0BZPC                          WFBZPC
     I              B0DGQT                          WFDGQT
     I              B0DIDT                          WFDIDT
     I              B0ALCD                          WFALCD
     I              B0BFDY                          WFBFDY
     I              B0DJDT                          WFDJDT
     I              B0BGDY                          WFBGDY
     I              B0DKDT                          WFDKDT
     I              B0J2ST                          WFJ2ST
     I              B0DJQT                          WFDJQT
     I              B0BNWG                          WFBNWG
     I              B0DLDT                          WFDLDT
     I              B0DPQT                          WFDPQT
     I              B0DQQT                          WFDQQT
     I              B0DMDT                          WFDMDT
     I              B0M0ST                          WFM0ST
     I              B0J9ST                          WFJ9ST
     I              B0KBST                          WFKBST
     I              B0AKC8                          WFAKC8
     I              B0RINB                          WFRINB
     I              B0RHNB                          WFRHNB
     I              B0RGNB                          WFRGNB
     I              B0UVST                          WFUVST
     I              B0UWST                          WFUWST
     I              B0UXST                          WFUXST
     I              B0VSST                          WFVSST
     I              B0AATM                          WFAATM
     I              B0AYNA                          WFAYNA
     I              B0A0NA                          WFA0NA
     I              B0AXDT                          WFAXDT
      *
     I@B1REIW
      * Item Balance Detail       Co/Item/Whse/Prod Date(D
      * Renamed input format fields
     I              B1AIC3                          WGAIC3
     I              B1HGCD                          WGHGCD
     I              B1AJCD                          WGAJCD
     I              B1ELDT                          WGELDT
     I              B1ABWG                          WGABWG
     I              B1AGQT                          WGAGQT
     I              B1AHQT                          WGAHQT
     I              B1AIQT                          WGAIQT
     I              B1CTST                          WGCTST
     I              B1ACWG                          WGACWG
     I              B1ARQT                          WGARQT
     I              B1ASQT                          WGASQT
     I              B1ATQT                          WGATQT
     I              B1HDQT                          WGHDQT
     I              B1HEQT                          WGHEQT
     I              B1F6ST                          WGF6ST
     I              B1BMWG                          WGBMWG
     I              B1DSQT                          WGDSQT
     I              B1DTQT                          WGDTQT
     I              B1DUQT                          WGDUQT
     I              B1DHDT                          WGDHDT
     I              B1AGCS                          WGAGCS
     I              B1AECS                          WGAECS
     I              B1IDVA                          WGIDVA
     I              B1K7DT                          WGK7DT
     I              B1RINB                          WGRINB
     I              B1RHNB                          WGRHNB
     I              B1RGNB                          WGRGNB
     I              B1UVST                          WGUVST
     I              B1UWST                          WGUWST
     I              B1UXST                          WGUXST
     I              B1VSST                          WGVSST
     I              B1AATM                          WGAATM
     I              B1AYNA                          WGAYNA
     I              B1A0NA                          WGA0NA
     I              B1AXDT                          WGAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WIAJCD
     I              ADF8NA                          WIF8NA
     I              ADACNA                          WIACNA
     I              ADADNA                          WIADNA
     I              ADAENA                          WIAENA
     I              ADAJNA                          WIAJNA
     I              ADBTTX                          WIBTTX
     I              ADAOCD                          WIAOCD
     I              ADBGCD                          WIBGCD
     I              ADVHST                          WIVHST
     I              ADMPNA                          WIMPNA
     I              ADWPST                          WIWPST
     I              ADXUST                          WIXUST
     I              ADT0ST                          WIT0ST
     I              ADT1ST                          WIT1ST
     I              ADDBNB                          WIDBNB
     I              ADT2ST                          WIT2ST
     I              ADT3ST                          WIT3ST
     I              ADT4ST                          WIT4ST
     I              ADT6ST                          WIT6ST
     I              ADBWC3                          WIBWC3
     I              ADBTC3                          WIBTC3
     I              ADBUC3                          WIBUC3
     I              ADBVC3                          WIBVC3
     I              ADFCAA                          WIFCAA
     I              ADRQSX                          WIRQSX
     I              ADRRSX                          WIRRSX
     I              ADRSSX                          WIRSSX
     I              ADRTSX                          WIRTSX
     I              ADT7ST                          WIT7ST
     I              ADT8ST                          WIT8ST
     I              ADRNSX                          WIRNSX
     I              ADROSX                          WIROSX
     I              ADRPSX                          WIRPSX
     I              ADUVST                          WIUVST
     I              ADUWST                          WIUWST
     I              ADUXST                          WIUXST
     I              ADVSST                          WIVSST
     I              ADAATM                          WIAATM
     I              ADAYNA                          WIAYNA
     I              ADA0NA                          WIA0NA
     I              ADAXDT                          WIAXDT
      *
     I@BZREJR
      * Company Item              Active FinishGood/Wp
      * Renamed input format fields
     I              BZAIC3                          WJAIC3
     I              BZHGCD                          WJHGCD
     I              BZAVNA                          WJAVNA
     I              BZAWNA                          WJAWNA
     I              BZL7NA                          WJL7NA
     I              BZL8NA                          WJL8NA
     I              BZL6NA                          WJL6NA
     I              BZMFNA                          WJMFNA
     I              BZADCD                          WJADCD
     I              BZAWPC                          WJAWPC
     I              BZLXST                          WJLXST
     I              BZAECD                          WJAECD
     I              BZAXPC                          WJAXPC
     I              BZLYST                          WJLYST
     I              BZAFCD                          WJAFCD
     I              BZAICD                          WJAICD
     I              BZAIWG                          WJAIWG
     I              BZHICD                          WJHICD
     I              BZRBCD                          WJRBCD
     I              BZFZST                          WJFZST
     I              BZAVST                          WJAVST
     I              BZCZWG                          WJCZWG
     I              BZC0WG                          WJC0WG
     I              BZURTN                          WJURTN
     I              BZAJC8                          WJAJC8
     I              BZRINB                          WJRINB
     I              BZRHNB                          WJRHNB
     I              BZRGNB                          WJRGNB
     I              BZLNCD                          WJLNCD
     I              BZTFNB                          WJTFNB
     I              BZN0CD                          WJN0CD
     I              BZX4ST                          WJX4ST
     I              BZTMVA                          WJTMVA
     I              BZTNVA                          WJTNVA
     I              BZBLPR                          WJBLPR
     I              BZBMPR                          WJBMPR
     I              BZLRCD                          WJLRCD
     I              BZU9ST                          WJU9ST
     I              BZCMCO                          WJCMCO
     I              BZQ1CD                          WJQ1CD
     I              BZQ8CD                          WJQ8CD
     I              BZCHTM                          WJCHTM
     I              BZQZCD                          WJQZCD
     I              BZXWST                          WJXWST
     I              BZXXST                          WJXXST
     I              BZVMST                          WJVMST
     I              BZSWGH                          WJSWGH
     I              BZPPHE                          WJPPHE
     I              BZR3CD                          WJR3CD
     I              BZSDCD                          WJSDCD
     I              BZICN1                          WJICN1
     I              BZSVCD                          WJSVCD
     I              BZICN2                          WJICN2
     I              BZSWCD                          WJSWCD
     I              BZV2NB                          WJV2NB
     I              BZSXCD                          WJSXCD
     I              BZITCN                          WJITCN
     I              BZSYCD                          WJSYCD
     I              BZITC5                          WJITC5
     I              BZSZCD                          WJSZCD
     I              BZICN6                          WJICN6
     I              BZS0CD                          WJS0CD
     I              BZICN7                          WJICN7
     I              BZS1CD                          WJS1CD
     I              BZICN8                          WJICN8
     I              BZS2CD                          WJS2CD
     I              BZICN9                          WJICN9
     I              BZS3CD                          WJS3CD
     I              BZICN0                          WJICN0
     I              BZS4CD                          WJS4CD
     I              BZSFNB                          WJSFNB
     I              BZA3WG                          WJA3WG
     I              BZSJNB                          WJSJNB
     I              BZLLCD                          WJLLCD
     I              BZLMCD                          WJLMCD
     I              BZP3ST                          WJP3ST
     I              BZSKNB                          WJSKNB
     I              BZSLNB                          WJSLNB
     I              BZSMNB                          WJSMNB
     I              BZP4ST                          WJP4ST
     I              BZCFNB                          WJCFNB
     I              BZCGNB                          WJCGNB
     I              BZILNB                          WJILNB
     I              BZCHNB                          WJCHNB
     I              BZCINB                          WJCINB
     I              BZCJNB                          WJCJNB
     I              BZCMNB                          WJCMNB
     I              BZCNNB                          WJCNNB
     I              BZCRNB                          WJCRNB
     I              BZCSNB                          WJCSNB
     I              BZCVNB                          WJCVNB
     I              BZCWNB                          WJCWNB
     I              BZCXNB                          WJCXNB
     I              BZCZNB                          WJCZNB
     I              BZC0NB                          WJC0NB
     I              BZN1CD                          WJN1CD
     I              BZB4NB                          WJB4NB
     I              BZB5NB                          WJB5NB
     I              BZX5ST                          WJX5ST
     I              BZX6ST                          WJX6ST
     I              BZX7ST                          WJX7ST
     I              BZPCCT                          WJPCCT
     I              BZBDNB                          WJBDNB
     I              BZBJNB                          WJBJNB
     I              BZSUST                          WJSUST
     I              BZSVST                          WJSVST
     I              BZSYST                          WJSYST
     I              BZSZST                          WJSZST
     I              BZS1ST                          WJS1ST
     I              BZXRCD                          WJXRCD
     I              BZXTCD                          WJXTCD
     I              BZXUCD                          WJXUCD
     I              BZF5WG                          WJF5WG
     I              BZF6WG                          WJF6WG
     I              BZF7WG                          WJF7WG
     I              BZBLNB                          WJBLNB
     I              BZBNNB                          WJBNNB
     I              BZS2ST                          WJS2ST
     I              BZS4ST                          WJS4ST
     I              BZS5ST                          WJS5ST
     I              BZS6ST                          WJS6ST
     I              BZS8ST                          WJS8ST
     I              BZS9ST                          WJS9ST
     I              BZTCST                          WJTCST
     I              BZTDST                          WJTDST
     I              BZUVST                          WJUVST
     I              BZUWST                          WJUWST
     I              BZUXST                          WJUXST
     I              BZVSST                          WJVSST
     I              BZAATM                          WJAATM
     I              BZAYNA                          WJAYNA
     I              BZA0NA                          WJA0NA
     I              BZAXDT                          WJAXDT
      *
     I@B0REYY
      * Item Balance              Acitve records only
      * Renamed input format fields
     I              B0AIC3                          WKAIC3
     I              B0HGCD                          WKHGCD
     I              B0AJCD                          WKAJCD
     I              B0AGCS                          WKAGCS
     I              B0AECS                          WKAECS
     I              B0BACS                          WKBACS
     I              B0BBCS                          WKBBCS
     I              B0CBPR                          WKCBPR
     I              B0GUDT                          WKGUDT
     I              B0XYST                          WKXYST
     I              B0CTPR                          WKCTPR
     I              B0G4DT                          WKG4DT
     I              B0BOWG                          WKBOWG
     I              B0DDQT                          WKDDQT
     I              B0DEQT                          WKDEQT
     I              B0DFQT                          WKDFQT
     I              B0HDQT                          WKHDQT
     I              B0HEQT                          WKHEQT
     I              B0AJQT                          WKAJQT
     I              B0AQQT                          WKAQQT
     I              B0AUQT                          WKAUQT
     I              B0EMQT                          WKEMQT
     I              B0DOQT                          WKDOQT
     I              B0ATNA                          WKATNA
     I              B0AKDT                          WKAKDT
     I              B0ANDT                          WKANDT
     I              B0IDVA                          WKIDVA
     I              B0JVST                          WKJVST
     I              B0BZPC                          WKBZPC
     I              B0DGQT                          WKDGQT
     I              B0DIDT                          WKDIDT
     I              B0ALCD                          WKALCD
     I              B0BFDY                          WKBFDY
     I              B0DJDT                          WKDJDT
     I              B0BGDY                          WKBGDY
     I              B0DKDT                          WKDKDT
     I              B0J2ST                          WKJ2ST
     I              B0DJQT                          WKDJQT
     I              B0BNWG                          WKBNWG
     I              B0DLDT                          WKDLDT
     I              B0DPQT                          WKDPQT
     I              B0DQQT                          WKDQQT
     I              B0DMDT                          WKDMDT
     I              B0M0ST                          WKM0ST
     I              B0J9ST                          WKJ9ST
     I              B0KBST                          WKKBST
     I              B0AKC8                          WKAKC8
     I              B0RINB                          WKRINB
     I              B0RHNB                          WKRHNB
     I              B0RGNB                          WKRGNB
     I              B0UVST                          WKUVST
     I              B0UWST                          WKUWST
     I              B0UXST                          WKUXST
     I              B0VSST                          WKVSST
     I              B0AATM                          WKAATM
     I              B0AYNA                          WKAYNA
     I              B0A0NA                          WKA0NA
     I              B0AXDT                          WKAXDT
      *
     I@G0REJZ
      * EDI WHS Interchange       Retrieval index
      * Renamed input format fields
     I              G0AJCD                          WLAJCD
     I              G0M4AA                          WLM4AA
     I              G0M7AA                          WLM7AA
     I              G0J5NX                          WLJ5NX
     I              G0X2T1                          WLX2T1
     I              G0JBSC                          WLJBSC
     I              G0JCSC                          WLJCSC
     I              G0JDSC                          WLJDSC
     I              G0JESC                          WLJESC
     I              G0QGU1                          WLQGU1
     I              G0F5NZ                          WLF5NZ
     I              G0LSSC                          WLLSSC
     I              G0LTSC                          WLLTSC
     I              G0AHAB                          WLAHAB
     I              G0F6NZ                          WLF6NZ
     I              G0VSST                          WLVSST
     I              G0MJDT                          WLMJDT
     I              G0BETM                          WLBETM
     I              G0CCVN                          WLCCVN
     I              G0CDVN                          WLCDVN
     I              G0MKDT                          WLMKDT
     I              G0BFTM                          WLBFTM
     I              G0CEVN                          WLCEVN
     I              G0CFVN                          WLCFVN
      *
     I@B1RELK
      * Item Balance Detail      o/Whse Slct Phys Count
      * Renamed input format fields
     I              B1AIC3                          WMAIC3
     I              B1HGCD                          WMHGCD
     I              B1AJCD                          WMAJCD
     I              B1ELDT                          WMELDT
     I              B1ABWG                          WMABWG
     I              B1AGQT                          WMAGQT
     I              B1AHQT                          WMAHQT
     I              B1AIQT                          WMAIQT
     I              B1CTST                          WMCTST
     I              B1ACWG                          WMACWG
     I              B1ARQT                          WMARQT
     I              B1ASQT                          WMASQT
     I              B1ATQT                          WMATQT
     I              B1HDQT                          WMHDQT
     I              B1HEQT                          WMHEQT
     I              B1F6ST                          WMF6ST
     I              B1BMWG                          WMBMWG
     I              B1DSQT                          WMDSQT
     I              B1DTQT                          WMDTQT
     I              B1DUQT                          WMDUQT
     I              B1DHDT                          WMDHDT
     I              B1AGCS                          WMAGCS
     I              B1AECS                          WMAECS
     I              B1IDVA                          WMIDVA
     I              B1K7DT                          WMK7DT
     I              B1RINB                          WMRINB
     I              B1RHNB                          WMRHNB
     I              B1RGNB                          WMRGNB
     I              B1UVST                          WMUVST
     I              B1UWST                          WMUWST
     I              B1UXST                          WMUXST
     I              B1VSST                          WMVSST
     I              B1AATM                          WMAATM
     I              B1AYNA                          WMAYNA
     I              B1A0NA                          WMA0NA
     I              B1AXDT                          WMAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WOAIC3
     I              BZHGCD                          WOHGCD
     I              BZAVNA                          WOAVNA
     I              BZAWNA                          WOAWNA
     I              BZL7NA                          WOL7NA
     I              BZL8NA                          WOL8NA
     I              BZL6NA                          WOL6NA
     I              BZMFNA                          WOMFNA
     I              BZADCD                          WOADCD
     I              BZAWPC                          WOAWPC
     I              BZLXST                          WOLXST
     I              BZAECD                          WOAECD
     I              BZAXPC                          WOAXPC
     I              BZLYST                          WOLYST
     I              BZAFCD                          WOAFCD
     I              BZAICD                          WOAICD
     I              BZAIWG                          WOAIWG
     I              BZHICD                          WOHICD
     I              BZRBCD                          WORBCD
     I              BZFZST                          WOFZST
     I              BZAVST                          WOAVST
     I              BZCZWG                          WOCZWG
     I              BZC0WG                          WOC0WG
     I              BZURTN                          WOURTN
     I              BZAJC8                          WOAJC8
     I              BZRINB                          WORINB
     I              BZRHNB                          WORHNB
     I              BZRGNB                          WORGNB
     I              BZLNCD                          WOLNCD
     I              BZTFNB                          WOTFNB
     I              BZN0CD                          WON0CD
     I              BZX4ST                          WOX4ST
     I              BZTMVA                          WOTMVA
     I              BZTNVA                          WOTNVA
     I              BZBLPR                          WOBLPR
     I              BZBMPR                          WOBMPR
     I              BZLRCD                          WOLRCD
     I              BZU9ST                          WOU9ST
     I              BZCMCO                          WOCMCO
     I              BZQ1CD                          WOQ1CD
     I              BZQ8CD                          WOQ8CD
     I              BZCHTM                          WOCHTM
     I              BZQZCD                          WOQZCD
     I              BZXWST                          WOXWST
     I              BZXXST                          WOXXST
     I              BZVMST                          WOVMST
     I              BZSWGH                          WOSWGH
     I              BZPPHE                          WOPPHE
     I              BZR3CD                          WOR3CD
     I              BZSDCD                          WOSDCD
     I              BZICN1                          WOICN1
     I              BZSVCD                          WOSVCD
     I              BZICN2                          WOICN2
     I              BZSWCD                          WOSWCD
     I              BZV2NB                          WOV2NB
     I              BZSXCD                          WOSXCD
     I              BZITCN                          WOITCN
     I              BZSYCD                          WOSYCD
     I              BZITC5                          WOITC5
     I              BZSZCD                          WOSZCD
     I              BZICN6                          WOICN6
     I              BZS0CD                          WOS0CD
     I              BZICN7                          WOICN7
     I              BZS1CD                          WOS1CD
     I              BZICN8                          WOICN8
     I              BZS2CD                          WOS2CD
     I              BZICN9                          WOICN9
     I              BZS3CD                          WOS3CD
     I              BZICN0                          WOICN0
     I              BZS4CD                          WOS4CD
     I              BZSFNB                          WOSFNB
     I              BZA3WG                          WOA3WG
     I              BZSJNB                          WOSJNB
     I              BZLLCD                          WOLLCD
     I              BZLMCD                          WOLMCD
     I              BZP3ST                          WOP3ST
     I              BZSKNB                          WOSKNB
     I              BZSLNB                          WOSLNB
     I              BZSMNB                          WOSMNB
     I              BZP4ST                          WOP4ST
     I              BZCFNB                          WOCFNB
     I              BZCGNB                          WOCGNB
     I              BZILNB                          WOILNB
     I              BZCHNB                          WOCHNB
     I              BZCINB                          WOCINB
     I              BZCJNB                          WOCJNB
     I              BZCMNB                          WOCMNB
     I              BZCNNB                          WOCNNB
     I              BZCRNB                          WOCRNB
     I              BZCSNB                          WOCSNB
     I              BZCVNB                          WOCVNB
     I              BZCWNB                          WOCWNB
     I              BZCXNB                          WOCXNB
     I              BZCZNB                          WOCZNB
     I              BZC0NB                          WOC0NB
     I              BZN1CD                          WON1CD
     I              BZB4NB                          WOB4NB
     I              BZB5NB                          WOB5NB
     I              BZX5ST                          WOX5ST
     I              BZX6ST                          WOX6ST
     I              BZX7ST                          WOX7ST
     I              BZPCCT                          WOPCCT
     I              BZBDNB                          WOBDNB
     I              BZBJNB                          WOBJNB
     I              BZSUST                          WOSUST
     I              BZSVST                          WOSVST
     I              BZSYST                          WOSYST
     I              BZSZST                          WOSZST
     I              BZS1ST                          WOS1ST
     I              BZXRCD                          WOXRCD
     I              BZXTCD                          WOXTCD
     I              BZXUCD                          WOXUCD
     I              BZF5WG                          WOF5WG
     I              BZF6WG                          WOF6WG
     I              BZF7WG                          WOF7WG
     I              BZBLNB                          WOBLNB
     I              BZBNNB                          WOBNNB
     I              BZS2ST                          WOS2ST
     I              BZS4ST                          WOS4ST
     I              BZS5ST                          WOS5ST
     I              BZS6ST                          WOS6ST
     I              BZS8ST                          WOS8ST
     I              BZS9ST                          WOS9ST
     I              BZTCST                          WOTCST
     I              BZTDST                          WOTDST
     I              BZUVST                          WOUVST
     I              BZUWST                          WOUWST
     I              BZUXST                          WOUXST
     I              BZVSST                          WOVSST
     I              BZAATM                          WOAATM
     I              BZAYNA                          WOAYNA
     I              BZA0NA                          WOA0NA
     I              BZAXDT                          WOAXDT
      *
     I@B0REHD
      * Item Balance              Co/Whse/Item
      * Renamed input format fields
     I              B0AIC3                          WRAIC3
     I              B0HGCD                          WRHGCD
     I              B0AJCD                          WRAJCD
     I              B0AGCS                          WRAGCS
     I              B0AECS                          WRAECS
     I              B0BACS                          WRBACS
     I              B0BBCS                          WRBBCS
     I              B0CBPR                          WRCBPR
     I              B0GUDT                          WRGUDT
     I              B0XYST                          WRXYST
     I              B0CTPR                          WRCTPR
     I              B0G4DT                          WRG4DT
     I              B0BOWG                          WRBOWG
     I              B0DDQT                          WRDDQT
     I              B0DEQT                          WRDEQT
     I              B0DFQT                          WRDFQT
     I              B0HDQT                          WRHDQT
     I              B0HEQT                          WRHEQT
     I              B0AJQT                          WRAJQT
     I              B0AQQT                          WRAQQT
     I              B0AUQT                          WRAUQT
     I              B0EMQT                          WREMQT
     I              B0DOQT                          WRDOQT
     I              B0ATNA                          WRATNA
     I              B0AKDT                          WRAKDT
     I              B0ANDT                          WRANDT
     I              B0IDVA                          WRIDVA
     I              B0JVST                          WRJVST
     I              B0BZPC                          WRBZPC
     I              B0DGQT                          WRDGQT
     I              B0DIDT                          WRDIDT
     I              B0ALCD                          WRALCD
     I              B0BFDY                          WRBFDY
     I              B0DJDT                          WRDJDT
     I              B0BGDY                          WRBGDY
     I              B0DKDT                          WRDKDT
     I              B0J2ST                          WRJ2ST
     I              B0DJQT                          WRDJQT
     I              B0BNWG                          WRBNWG
     I              B0DLDT                          WRDLDT
     I              B0DPQT                          WRDPQT
     I              B0DQQT                          WRDQQT
     I              B0DMDT                          WRDMDT
     I              B0M0ST                          WRM0ST
     I              B0J9ST                          WRJ9ST
     I              B0KBST                          WRKBST
     I              B0AKC8                          WRAKC8
     I              B0RINB                          WRRINB
     I              B0RHNB                          WRRHNB
     I              B0RGNB                          WRRGNB
     I              B0UVST                          WRUVST
     I              B0UWST                          WRUWST
     I              B0UXST                          WRUXST
     I              B0VSST                          WRVSST
     I              B0AATM                          WRAATM
     I              B0AYNA                          WRAYNA
     I              B0A0NA                          WRA0NA
     I              B0AXDT                          WRAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WSAIC3
     I              B0HGCD                          WSHGCD
     I              B0AJCD                          WSAJCD
     I              B0AGCS                          WSAGCS
     I              B0AECS                          WSAECS
     I              B0BACS                          WSBACS
     I              B0BBCS                          WSBBCS
     I              B0CBPR                          WSCBPR
     I              B0GUDT                          WSGUDT
     I              B0XYST                          WSXYST
     I              B0CTPR                          WSCTPR
     I              B0G4DT                          WSG4DT
     I              B0BOWG                          WSBOWG
     I              B0DDQT                          WSDDQT
     I              B0DEQT                          WSDEQT
     I              B0DFQT                          WSDFQT
     I              B0HDQT                          WSHDQT
     I              B0HEQT                          WSHEQT
     I              B0AJQT                          WSAJQT
     I              B0AQQT                          WSAQQT
     I              B0AUQT                          WSAUQT
     I              B0EMQT                          WSEMQT
     I              B0DOQT                          WSDOQT
     I              B0ATNA                          WSATNA
     I              B0AKDT                          WSAKDT
     I              B0ANDT                          WSANDT
     I              B0IDVA                          WSIDVA
     I              B0JVST                          WSJVST
     I              B0BZPC                          WSBZPC
     I              B0DGQT                          WSDGQT
     I              B0DIDT                          WSDIDT
     I              B0ALCD                          WSALCD
     I              B0BFDY                          WSBFDY
     I              B0DJDT                          WSDJDT
     I              B0BGDY                          WSBGDY
     I              B0DKDT                          WSDKDT
     I              B0J2ST                          WSJ2ST
     I              B0DJQT                          WSDJQT
     I              B0BNWG                          WSBNWG
     I              B0DLDT                          WSDLDT
     I              B0DPQT                          WSDPQT
     I              B0DQQT                          WSDQQT
     I              B0DMDT                          WSDMDT
     I              B0M0ST                          WSM0ST
     I              B0J9ST                          WSJ9ST
     I              B0KBST                          WSKBST
     I              B0AKC8                          WSAKC8
     I              B0RINB                          WSRINB
     I              B0RHNB                          WSRHNB
     I              B0RGNB                          WSRGNB
     I              B0UVST                          WSUVST
     I              B0UWST                          WSUWST
     I              B0UXST                          WSUXST
     I              B0VSST                          WSVSST
     I              B0AATM                          WSAATM
     I              B0AYNA                          WSAYNA
     I              B0A0NA                          WSA0NA
     I              B0AXDT                          WSAXDT
      *
     I@B0CPD1
      * PFS Inventory Restoration Update index
      * Renamed input format fields
     I              B0Y1NX                          WTY1NX
     I              B0AID8                          WTAID8
     I              B0AFTS                          WTAFTS
     I              B0BCNY                          WTBCNY
     I              B0XKSX                          WTXKSX
     I              B0Y2NX                          WTY2NX
     I              B0U4SX                          WTU4SX
     I              B0ADNY                          WTADNY
     I              B0P7DT                          WTP7DT
     I              B0Z4NX                          WTZ4NX
     I              B0ACNY                          WTACNY
     I              B0CUNY                          WTCUNY
     I              B0CVNY                          WTCVNY
     I              B0UWSX                          WTUWSX
     I              B0UXSX                          WTUXSX
     I              B0V3SX                          WTV3SX
     I              B0AHNY                          WTAHNY
     I              B0AINY                          WTAINY
     I              B0AJNY                          WTAJNY
     I              B0AKNY                          WTAKNY
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMHC1    E DSOMHCCPL0
      * UPD : Physical Count Control    Update index
      * Renamed input format fields
     I              HCAIC3                          WDAIC3
     I              HCAJCD                          WDAJCD
     I              HCDHDT                          WDDHDT
     I              HCOFCD                          WDOFCD
     I              HCTGST                          WDTGST
     I              HCUVST                          WDUVST
     I              HCUWST                          WDUWST
     I              HCUXST                          WDUXST
     I              HCAATM                          WDAATM
     I              HCAYNA                          WDAYNA
     I              HCA0NA                          WDA0NA
     I              HCAXDT                          WDAXDT
      *
     IYARDCS      DS                             44
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     IYBRDCS      DS                            163
     IYCRDCS      DS                            163
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WSAIC3
     I              B0HGCD                          WSHGCD
     I              B0AJCD                          WSAJCD
     I              B0AGCS                          WSAGCS
     I              B0AECS                          WSAECS
     I              B0BACS                          WSBACS
     I              B0BBCS                          WSBBCS
     I              B0CBPR                          WSCBPR
     I              B0GUDT                          WSGUDT
     I              B0XYST                          WSXYST
     I              B0CTPR                          WSCTPR
     I              B0G4DT                          WSG4DT
     I              B0BOWG                          WSBOWG
     I              B0DDQT                          WSDDQT
     I              B0DEQT                          WSDEQT
     I              B0DFQT                          WSDFQT
     I              B0HDQT                          WSHDQT
     I              B0HEQT                          WSHEQT
     I              B0AJQT                          WSAJQT
     I              B0AQQT                          WSAQQT
     I              B0AUQT                          WSAUQT
     I              B0EMQT                          WSEMQT
     I              B0DOQT                          WSDOQT
     I              B0ATNA                          WSATNA
     I              B0AKDT                          WSAKDT
     I              B0ANDT                          WSANDT
     I              B0IDVA                          WSIDVA
     I              B0JVST                          WSJVST
     I              B0BZPC                          WSBZPC
     I              B0DGQT                          WSDGQT
     I              B0DIDT                          WSDIDT
     I              B0ALCD                          WSALCD
     I              B0BFDY                          WSBFDY
     I              B0DJDT                          WSDJDT
     I              B0BGDY                          WSBGDY
     I              B0DKDT                          WSDKDT
     I              B0J2ST                          WSJ2ST
     I              B0DJQT                          WSDJQT
     I              B0BNWG                          WSBNWG
     I              B0DLDT                          WSDLDT
     I              B0DPQT                          WSDPQT
     I              B0DQQT                          WSDQQT
     I              B0DMDT                          WSDMDT
     I              B0M0ST                          WSM0ST
     I              B0J9ST                          WSJ9ST
     I              B0KBST                          WSKBST
     I              B0AKC8                          WSAKC8
     I              B0RINB                          WSRINB
     I              B0RHNB                          WSRHNB
     I              B0RGNB                          WSRGNB
     I              B0UVST                          WSUVST
     I              B0UWST                          WSUWST
     I              B0UXST                          WSUXST
     I              B0VSST                          WSVSST
     I              B0AATM                          WSAATM
     I              B0AYNA                          WSAYNA
     I              B0A0NA                          WSA0NA
     I              B0AXDT                          WSAXDT
      *
     IQPPB01    E DSPPB0CPL0
      * UPD : PFS Inventory Restoration Update index
      * Renamed input format fields
     I              B0Y1NX                          WTY1NX
     I              B0AID8                          WTAID8
     I              B0AFTS                          WTAFTS
     I              B0BCNY                          WTBCNY
     I              B0XKSX                          WTXKSX
     I              B0Y2NX                          WTY2NX
     I              B0U4SX                          WTU4SX
     I              B0ADNY                          WTADNY
     I              B0P7DT                          WTP7DT
     I              B0Z4NX                          WTZ4NX
     I              B0ACNY                          WTACNY
     I              B0CUNY                          WTCUNY
     I              B0CVNY                          WTCVNY
     I              B0UWSX                          WTUWSX
     I              B0UXSX                          WTUXSX
     I              B0V3SX                          WTV3SX
     I              B0AHNY                          WTAHNY
     I              B0AINY                          WTAINY
     I              B0AJNY                          WTAJNY
     I              B0AKNY                          WTAKNY
      *
     IYDRDCS      DS                            111
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: PFS Inventory Restoration
      * I :  PFS Company Number
     I                                        1   30P1Y1NX
      * I :  PFS Warehouse Code
     I                                        4   6 P1U4SX
     IP2PARM      DS
      * I :  Program name USR
     I                                        1  10 P2BMVN
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'ESNDMAIL-RESTORATION'
      * Email Address
     I                                        1  50 ZA0001
      * Office Message USR
     I                                       51 182 ZA0002
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1Y1NX    PARM           WP0001  30       PFS Company Num
     C           P1U4SX    PARM           WP0002  3        PFS Warehouse C
     C           P2BMVN    PARM           WP0003 10        Program name US
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * PFS Inv Physical FRSH XF
      * PFS Inv Physical FRSH RT - PFS Inventory Restoration  * 
     C                     EXSR SARVGN
      * E3191 JJH 08/07/14 Do not send email if Automated Inv Restoration
      * CASE: PAR.Program name USR is WW PFS Restoration    DF
     C           P2BMVN    IFEQ @CN,005                    *IF
      * Rtv Alpha Value       XF - Company Values  * 
     C                     CALL 'POMTXFR'              90  Rtv Alpha Value
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1Y1NX    WQ0001  30       Company Number
     C                     PARM @CN,006   WQ0002 10        Company Value C
     C           YL0024    PARM *BLANK    WQ0003 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POMTXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.Email Address is Entered
     C           YL0024    IFNE *BLANK                     *IF
      * E3191 JJH 08/06/14 Chg msg to indicate this is Carlisle Upload
     C                     Z-ADD1         ZQ      50
     C           @CN,007   CAT  @CN,008:ZQYL0025    P      Text USR 43
     C                     Z-ADD2         ZQ      50
     C           YL0025    CAT  P1U4SX:ZQ YL0026    P      Office Message
      * Setup message data for message
     C                     MOVELYL0024    ZA0001           Email Address
     C                     MOVELYL0026    ZA0002           Office Message
      *
      * Execute message
     C                     MOVELZADFMF    ZAMSGF
     C                     CALL 'Y2EXMCC'              90  *
     C                     PARM *BLANK    W0RTN   7        Return code
     C                     PARM 'USR4703' ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSGF
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN   7
     C                     END
      *
     C           W0RTN     IFNE *BLANK
      * Error detected during execution
     C                     SETON                     99    *
     C                     END
      *
     C                     END                             *FI
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * PFS Inv Physical FRSH RT - PFS Inventory Restoration  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  1        Production Date
     C                     Z-ADD*ZERO     WN0002  30       Company Number
     C                     Z-ADD*ZERO     WN0003  30       Item Structure
     C                     MOVEL*BLANK    WN0004  3        Item Type Code
     C                     Z-ADD*ZERO     WN0005  52       Fresh Chilling
     C                     MOVEL*BLANK    WN0006  3        Default Warehou
     C                     MOVEL*BLANK    WN0007  6        Primal Group Co
     C                     Z-ADD*ZERO     WN0008  10       PFS Process Sta
     C                     MOVEL*BLANK    WN0009  6        PFS Error Reaso
     C                     Z-ADD*ZERO     WN0010 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0011  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0012 112       Transaction Qua
     C                     Z-ADD*ZERO     WN0013 112       Transaction Wei
     C                     Z-ADD*ZERO     WN0014  70       Transaction Dat
     C                     Z-ADD*ZERO     WN0015  70       Item Code
     C                     Z-ADD*ZERO     WN0016  70       Production Date
     C                     Z-ADD*ZERO     WN0017  70       Label Date
     C                     MOVEL*BLANK    WN0018  1        Lot Tracking Fl
     C                     MOVEL*BLANK    WN0019  4        Location Code
     C                     MOVEL*BLANK    WN0020  1        ILL Status
     C                     MOVEL*BLANK    WN0021  3        Inv Hold Reason
     C                     Z-ADD*ZERO     WN0022  50       ILL Item Qty On
     C                     Z-ADD*ZERO     WN0023 112       ILl Item Wgt On
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/30/18 RMC R12773 if Program is EDI 846, check warehouse for 84
      *    Active instead of Carlisle
      * 09/09/09 PKD E00475 Use System Date instead of Job Date
      * Rtv System Date *CYMD IF
      * LCL.*System timestamp = JOB.*System timestamp
     C                     EXSR XSTMS
     C                     MOVEL##TMS     YL0002           *System timesta
     C                     Z-ADD4         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0002:ZQ YL0003    P  90  Year USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0002:ZQ YL0004    P  90  Month USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD9         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00026
     C           ZQ        ORGT 00026
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTYL0002:ZQ YL0005    P  90  Day USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0003    CAT  YL0004:ZQ YL0006    P      Date (Char-8) U
     C                     Z-ADD*ZERO     ZQ      50
     C           YL0006    CAT  YL0005:ZQ YL0006    P      Date (Char-8) U
     C                     MOVE YL0006    YL0007           DATE
      *
     C                     Z-ADD*ZERO     WN0024  40       Year Code
     C                     Z-ADD*ZERO     WN0025  20       Month
     C                     Z-ADD*ZERO     WN0026  20       Day of Month US
     C                     MOVEL*BLANK    WN0027  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0028  2        Month (Char) US
     C                     MOVEL*BLANK    WN0029  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0030  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0031  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0032  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           YL0007    DIV  10000     WN0024           Year Code
     C                     Z-ADDWN0024    WN0030           Year  NBR USR
     C                     MOVELWN0030    WN0031           Year  (Char) US
      * ** MONTH **
     C           YL0007    DIV  100       WN0025           Month
     C                     MOVELWN0025    WN0028           Month (Char) US
      * ** DAY **
     C                     Z-ADDYL0007    WN0026           Day of Month US
     C                     MOVELWN0026    WN0029           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0024    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0031:ZQ WN0032    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0031:ZQ WN0032    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0032    CAT  WN0028:ZQ WN0032    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0032    CAT  WN0029:ZQ WN0032    P      Date (Alpha) US
     C                     MOVE WN0032    YL0001           Date
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SBRVGN
      * CASE: LCL.Company Number is greater than zero
     C           YL0008    IFGT 0                          *IF
      * Val Co/Whse/Code/Date  RT - Physical Count Control  * 
     C                     EXSR SCRVGN
      * If record does not exists create else change sts to open
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
      * Crt Physical Count     CR - Physical Count Control  * 
     C                     EXSR SDCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * CHG Physical Count Sts CH - Physical Count Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDYL0008    WL0001           Company Number
     C                     MOVELP1U4SX    WL0002    P      Warehouse Code
     C                     Z-ADDYL0001    WL0003           Physical Start
     C                     MOVEL*BLANK    WL0004           Cycle Count Cod
     C                     MOVEL'O'       WL0005    P      Cycle Status
     C                     EXSR SECHRC
     C                     END                             *FI
      * Rtv Cncl Old Physical  RT - Physical Count Control  * 
     C                     EXSR SFRVGN
      *  Update all Item Balance Detail records with Physical count date
      *  and save start qty on hand
      * Upd Physical Start Dt  RT - Item Balance  * 
     C                     EXSR SGRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAY1NX    WQSA01           PFS Company Num
     C           *LIKE     DEFN WAU4SX    WQSA02           PFS Warehouse C
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           PFS Company Num
     C                     KFLD           WQSA02           PFS Warehouse C
      * Setup key
     C                     Z-ADDP1Y1NX    WQSA01           PFS Company Num
     C                     MOVELP1U4SX    WQSA02           PFS Warehouse C
      * Establish starting position
     C           KRSSA     SETLL@B0CPEP                    *
     C           KRSSA     READE@B0CPEP                  90*
      * Data record not found
     C   90                MOVEL'USR3580' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0001           Production Date
     C                     Z-ADD*ZERO     WN0002           Company Number
     C                     Z-ADD*ZERO     WN0003           Item Structure
     C                     MOVEL*BLANK    WN0004           Item Type Code
     C                     Z-ADD*ZERO     WN0005           Fresh Chilling
     C                     MOVEL*BLANK    WN0006           Default Warehou
     C                     MOVEL*BLANK    WN0007           Primal Group Co
     C                     Z-ADD*ZERO     WN0008           PFS Process Sta
     C                     MOVEL*BLANK    WN0009           PFS Error Reaso
     C                     Z-ADD*ZERO     WN0010           Unit Cost Per P
     C                     MOVEL*BLANK    WN0011           Warehouse Code
     C                     Z-ADD*ZERO     WN0012           Transaction Qua
     C                     Z-ADD*ZERO     WN0013           Transaction Wei
     C                     Z-ADD*ZERO     WN0014           Transaction Dat
     C                     Z-ADD*ZERO     WN0015           Item Code
     C                     Z-ADD*ZERO     WN0016           Production Date
     C                     Z-ADD*ZERO     WN0017           Label Date
     C                     MOVEL*BLANK    WN0018           Lot Tracking Fl
     C                     MOVEL*BLANK    WN0019           Location Code
     C                     MOVEL*BLANK    WN0020           ILL Status
     C                     MOVEL*BLANK    WN0021           Inv Hold Reason
     C                     Z-ADD*ZERO     WN0022           ILL Item Qty On
     C                     Z-ADD*ZERO     WN0023           ILl Item Wgt On
     C                     MOVEL'Y'       W0RSL            *Record selecte
     C                     Z-ADD*ZERO     WN0008           PFS Process Sta
     C                     MOVEL*BLANK    WN0009           PFS Error Reaso
      * ***** VALIDATION *****
     C                     EXSR UASUBR                     ***** VALIDATIO
      * ***** PROCESS RECORD *****
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Initialize
     C                     EXSR UBSUBR                     Initialize
      * Rtv Phys. Start Date   RT - Item Balance Detail  * 
     C                     EXSR SORVGN
      * *** this will change the label date, if the old one was in error
      * Chg AS Physical Count  CH - Item Balance Detail  * 
     C                     EXSR SPCHRC
      * CASE: PAR.Program name USR is PRC Edi 846 Inventory Inq
     C           P2BMVN    IFEQ @CN,003                    *IF
      * RTV Crt in 846 if n/f  RT - Item Balance  * 
     C                     EXSR SSRVGN
     C                     END                             *FI
     C                     Z-ADD1         WN0008           PFS Process Sta
     C                     END                             *FI
      * CASE: PAR.PFS Error Reason is Inactive Transaction
     C           WN0009    IFEQ @CN,004                    *IF
     C                     Z-ADD1         WN0008           PFS Process Sta
     C                     END                             *FI
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Restoration  * 
     C                     EXSR SUCHRC
     C           KRSSA     READE@B0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1U4SX    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSB     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0008           Shipping Compan
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBBWC3    YL0008           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Val Co/Whse/Code/Date  RT - Physical Count Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCAJCD           Warehouse Code
     C                     KFLD           WCDHDT           Physical Start
     C                     KFLD           WCOFCD           Cycle Count Cod
      * Setup key
     C                     Z-ADDYL0008    WCAIC3           Company Number
     C                     MOVELP1U4SX    WCAJCD           Warehouse Code
     C                     Z-ADDYL0001    WCDHDT           Physical Start
     C                     MOVEL*BLANK    WCOFCD           Cycle Count Cod
      * Establish starting position
     C           KRSSC     CHAIN@HCCPJ0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1487' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDCRRC    BEGSR
      *================================================================
      * Crt Physical Count     CR - Physical Count Control  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0033  1        EDI Status 1
     C                     MOVEL*BLANK    WN0034  1        EDI Status 2
     C                     MOVEL*BLANK    WN0035  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0036  60       Job Time
     C                     MOVEL*BLANK    WN0037 10        User Id
     C                     MOVEL*BLANK    WN0038 10        Job Name
     C                     Z-ADD*ZERO     WN0039  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @HCCPJZ
     C                     Z-ADDYL0008    WDAIC3           Company Number
     C                     MOVELP1U4SX    WDAJCD           Warehouse Code
     C                     Z-ADDYL0001    WDDHDT           Physical Start
     C                     MOVEL*BLANK    WDOFCD           Cycle Count Cod
     C                     MOVEL'O'       WDTGST           Cycle Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
     C           KLCRSD    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDDHDT           Physical Start
     C                     KFLD           WDOFCD           Cycle Count Cod
      * Check for duplicate primary key
     C           KLCRSD    SETLL@HCCPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1488' W0RTN   7
      * Send message 'Physical Count Control EX'
     C                     MOVEL'USR1488' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C                     WRITE@HCCPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * CHG Physical Count Sts CH - Physical Count Control  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0040  1        EDI Status 1
     C                     MOVEL*BLANK    WN0041  1        EDI Status 2
     C                     MOVEL*BLANK    WN0042  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0043  60       Job Time
     C                     MOVEL*BLANK    WN0044 10        User Id
     C                     MOVEL*BLANK    WN0045 10        Job Name
     C                     Z-ADD*ZERO     WN0046  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @HCCPJZ
     C                     Z-ADDWL0001    WDAIC3           Company Number
     C                     MOVELWL0002    WDAJCD    P      Warehouse Code
     C                     Z-ADDWL0003    WDDHDT           Physical Start
     C                     MOVELWL0004    WDOFCD    P      Cycle Count Cod
      *
     C           KLCHSE    KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDAJCD           Warehouse Code
     C                     KFLD           WDDHDT           Physical Start
     C                     KFLD           WDOFCD           Cycle Count Cod
     C           KLCHSE    CHAIN@HCCPJZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMHCCPL0'MDACP
     C                     MOVEL'@HCCPJZ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMHC1    YARDCS
      * Move non-key fields to @HCCPJZ
     C                     MOVELWL0005    WDTGST    P      Cycle Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMHC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WDAATM' defaulted for 'Job Time'.
      * Field '(DB1) WDAYNA' defaulted for 'User Id'.
      * Field '(DB1) WDA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WDAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WDAATM           Job Time
     C                     MOVEL##USR     WDAYNA           User Id
     C                     MOVEL##JOB     WDA0NA           Job Name
     C                     Z-ADD##JDT     WDAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMHC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@HCCPJZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMHCCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Cncl Old Physical  RT - Physical Count Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WEAJCD    WQSF02           Warehouse Code
     C           *LIKE     DEFN WEOFCD    WQSF03           Cycle Count Cod
     C           *LIKE     DEFN WETGST    WQSF04           Cycle Status
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Warehouse Code
     C                     KFLD           WQSF03           Cycle Count Cod
     C                     KFLD           WQSF04           Cycle Status
      * Setup key
     C                     Z-ADDYL0008    WQSF01           Company Number
     C                     MOVELP1U4SX    WQSF02           Warehouse Code
     C                     MOVEL*BLANK    WQSF03           Cycle Count Cod
     C                     MOVEL'O'       WQSF04           Cycle Status
      * Establish starting position
     C           KRSSF     SETLL@HCCPJ7                    *
     C           KRSSF     READE@HCCPJ7                  90*
      * Data record not found
     C   90                MOVEL'USR1487' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Physical Start Date NE PAR.Physical Start Date
     C           WEDHDT    IFNE YL0001                     *IF
      * CHG Physical Count Sts CH - Physical Count Control  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWEAIC3    WL0001           Company Number
     C                     MOVELWEAJCD    WL0002    P      Warehouse Code
     C                     Z-ADDWEDHDT    WL0003           Physical Start
     C                     MOVELWEOFCD    WL0004    P      Cycle Count Cod
     C                     MOVEL'C'       WL0005    P      Cycle Status
     C                     EXSR SECHRC
     C                     END                             *FI
     C           KRSSF     READE@HCCPJ7                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Upd Physical Start Dt  RT - Item Balance  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0047  1        Record Selected
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFAJCD    WQSG02           Warehouse Code
     C           *LIKE     DEFN WFATNA    WQSG03           Cycle Count Cod
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Warehouse Code
     C                     KFLD           WQSG03           Cycle Count Cod
      * Setup key
     C                     Z-ADDYL0008    WQSG01           Company Number
     C                     MOVELP1U4SX    WQSG02           Warehouse Code
     C                     MOVEL*BLANK    WQSG03           Cycle Count Cod
      * Establish starting position
     C           KRSSG     SETLL@B0REK7                    *
     C           KRSSG     READE@B0REK7                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       WN0047           Record Selected
      * Upd Phys. Start Dt/Qty RT - Item Balance Detail  * 
     C                     EXSR SHRVGN
     C           KRSSG     READE@B0REK7                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Phys. Start Dt/Qty RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WGHGCD    WQSH02           Item Code
     C           *LIKE     DEFN WGAJCD    WQSH03           Warehouse Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
      * Setup key
     C                     Z-ADDWFAIC3    WQSH01           Company Number
     C                     Z-ADDWFHGCD    WQSH02           Item Code
     C                     MOVELWFAJCD    WQSH03           Warehouse Code
      * Establish starting position
     C           KRSSH     SETLL@B1REIW                    *
     C           KRSSH     READE@B1REIW                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Phys. Start Qty.   CH - Item Balance Detail  * 
     C                     EXSR SICHRC
     C           KRSSH     READE@B1REIW                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Phys. Start Qty.   CH - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0048 112       Physical Count
     C                     Z-ADD*ZERO     WN0049 112       Physical Count
     C                     Z-ADD*ZERO     WN0050 112       Physical Count
     C                     Z-ADD*ZERO     WN0051 112       Physical Count
     C                     Z-ADD*ZERO     WN0052 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0053 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0054 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0055 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0056 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0057 112       Weight In Chill
     C                     MOVEL*BLANK    WN0058  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0059 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0060 114       Last Cost
     C                     Z-ADD*ZERO     WN0061 112       Value of On Han
     C                     Z-ADD*ZERO     WN0062  70       Label Date
     C                     Z-ADD*ZERO     WN0063  30       Item Structure
     C                     Z-ADD*ZERO     WN0064  30       Item Structure
     C                     Z-ADD*ZERO     WN0065  30       Item Structure
     C                     MOVEL*BLANK    WN0066  1        EDI Status 1
     C                     MOVEL*BLANK    WN0067  1        EDI Status 2
     C                     MOVEL*BLANK    WN0068  1        EDI Status 3
     C                     MOVEL*BLANK    WN0069  1        Record Status
     C                     Z-ADD*ZERO     WN0070  60       Job Time
     C                     MOVEL*BLANK    WN0071 10        User Id
     C                     MOVEL*BLANK    WN0072 10        Job Name
     C                     Z-ADD*ZERO     WN0073  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWGAIC3    WHAIC3           Company Number
     C                     Z-ADDWGHGCD    WHHGCD           Item Code
     C                     MOVELWGAJCD    WHAJCD    P      Warehouse Code
     C                     Z-ADDWGELDT    WHELDT           Production Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSI    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     MOVEL'P'       WHCTST    P      Physical Count
     C                     Z-ADDWGACWG    WHBMWG           Physical Start
     C                     Z-ADDWGARQT    WHDSQT           Physical Start
     C                     Z-ADDWGASQT    WHDTQT           Physical Start
     C                     Z-ADDWGATQT    WHDUQT           Physical Start
     C                     Z-ADDYL0001    WHDHDT           Physical Start
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD*ZERO     WHABWG           Physical Count
     C                     Z-ADD*ZERO     WHAGQT           Physical Count
     C                     Z-ADD*ZERO     WHAHQT           Physical Count
     C                     Z-ADD*ZERO     WHAIQT           Physical Count
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Val Warehouse PFS     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WIAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0011    WIAJCD           Warehouse Code
      * Establish starting position
     C           KRSSJ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIVHST    WN0018           Lot Tracking Fl
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSK02           Item Code
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Item Code
      * Setup key
     C                     Z-ADDWL0006    WQSK01           Company Number
     C                     Z-ADDWL0007    WQSK02           Item Code
      * Establish starting position
     C           KRSSK     SETLL@BZREJR                    *
     C           KRSSK     READE@BZREJR                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0008           Production Date
     C                     Z-ADD*ZERO     WL0009           Item Structure
     C                     MOVEL*BLANK    WL0010           Item Type Code
     C                     MOVEL*BLANK    WL0011           Default Warehou
     C                     Z-ADD*ZERO     WL0012           Fresh Chilling
     C                     MOVEL*BLANK    WL0013           Primal Group Co
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJFZST    WL0008           Production Date
     C                     Z-ADDWJRGNB    WL0009           Item Structure
     C                     MOVELWJN0CD    WL0010           Item Type Code
     C                     MOVELWJQ1CD    WL0011           Default Warehou
     C                     Z-ADDWJCHTM    WL0012           Fresh Chilling
     C                     MOVELWJXRCD    WL0013           Primal Group Co
     C           KRSSK     READE@BZREJR                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Unit Cost Active   RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWAY1NX    WKAIC3           Company Number
     C                     Z-ADDWAY2NX    WKHGCD           Item Code
     C                     MOVELWAU4SX    WKAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@B0REYY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0010           Unit Cost Per P
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKAGCS    WN0010           Unit Cost Per P
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Whs Interchg Actv RT - EDI WHS Interchange  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLAJCD           Warehouse Code
     C                     KFLD           WLM4AA           Interchange Cod
      * Setup key
     C                     MOVELWN0011    WLAJCD           Warehouse Code
     C                     MOVEL'WHSRST'  WLM4AA           Interchange Cod
      * Establish starting position
     C           KRSSM     CHAIN@G0REJZ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4409' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0009           Record Status
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLVSST    YL0009           Record Status
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WBAJCD           Warehouse Code
      * Setup key
     C                     MOVELWN0011    WBAJCD           Warehouse Code
      * Establish starting position
     C           KRSSN     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0010           WHS Live w/Carl
     C                     MOVEL*BLANK    YL0011           WHS PFS Interfa
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBRRSX    YL0010           WHS Live w/Carl
     C                     MOVELWBRSSX    YL0011           WHS PFS Interfa
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Phys. Start Date   RT - Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0012           Physical Start
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WMAJCD    WQSO02           Warehouse Code
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Warehouse Code
      * Setup key
     C                     Z-ADDWN0002    WQSO01           Company Number
     C                     MOVELWN0011    WQSO02           Warehouse Code
      * Establish starting position
     C           KRSSO     SETLL@B1RELK                    *
     C           KRSSO     READE@B1RELK                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Physical Start Date is entered
     C           WMDHDT    IFNE 0                          *IF
      * PAR = DB1 By name
     C                     Z-ADDWMDHDT    YL0012           Physical Start
     C                     GOTO SOEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSO     READE@B1RELK                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * Chg AS Physical Count  CH - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0101 112       Physical Count
     C                     Z-ADD*ZERO     WN0102 112       Physical Count
     C                     Z-ADD*ZERO     WN0103 112       Physical Count
     C                     Z-ADD*ZERO     WN0104 112       Physical Count
     C                     MOVEL*BLANK    WN0105  1        Physical Count
     C                     Z-ADD*ZERO     WN0106 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0107 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0108 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0109 112       Quantity on Han
     C                     Z-ADD*ZERO     WN0110 112       Quantity In Chi
     C                     Z-ADD*ZERO     WN0111 112       Weight In Chill
     C                     MOVEL*BLANK    WN0112  1        Update Exceptio
     C                     Z-ADD*ZERO     WN0113 112       Physical Start
     C                     Z-ADD*ZERO     WN0114 112       Physical Start
     C                     Z-ADD*ZERO     WN0115 112       Physical Start
     C                     Z-ADD*ZERO     WN0116 112       Physical Start
     C                     Z-ADD*ZERO     WN0117  70       Physical Start
     C                     Z-ADD*ZERO     WN0118 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0119 114       Last Cost
     C                     Z-ADD*ZERO     WN0120 112       Value of On Han
     C                     Z-ADD*ZERO     WN0121  30       Item Structure
     C                     Z-ADD*ZERO     WN0122  30       Item Structure
     C                     Z-ADD*ZERO     WN0123  30       Item Structure
     C                     MOVEL*BLANK    WN0124  1        EDI Status 1
     C                     MOVEL*BLANK    WN0125  1        EDI Status 2
     C                     MOVEL*BLANK    WN0126  1        EDI Status 3
     C                     MOVEL*BLANK    WN0127  1        Record Status
     C                     Z-ADD*ZERO     WN0128  60       Job Time
     C                     MOVEL*BLANK    WN0129 10        User Id
     C                     MOVEL*BLANK    WN0130 10        Job Name
     C                     Z-ADD*ZERO     WN0131  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWN0002    WHAIC3           Company Number
     C                     Z-ADDWN0015    WHHGCD           Item Code
     C                     MOVELWN0011    WHAJCD    P      Warehouse Code
     C                     Z-ADDWN0016    WHELDT           Production Date
      *
     C           KLCHSP    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
     C           KLCHSP    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0014           Company Number
     C                     Z-ADDWN0015    WL0015           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    WN0121           Item Structure
     C                     Z-ADDWL0017    WN0122           Item Structure
     C                     Z-ADDWL0018    WN0123           Item Structure
      * Crt AS Physical Count  CR - Item Balance Detail  * 
     C                     EXSR SRCRRC
     C           W0RTN     IFNE *BLANK                     IF
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     ENDIF
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YCRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWN0017    WHK7DT           Label Date
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'Y'       YCRDC            *Record Data Ch
      * CASE: DB1.Physical Start Date is not entered
     C           WHDHDT    IFEQ 0                          *IF
     C                     Z-ADDYL0012    WHDHDT           Physical Start
     C                     END                             *FI
     C                     ADD  WN0013    WHABWG           Physical Count
     C                     ADD  WN0012    WHAGQT           Physical Count
     C                     MOVEL'P'       WHCTST           Physical Count
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Item Typ/Grp/Cls  RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
      * Setup key
     C                     Z-ADDWL0014    WOAIC3           Company Number
     C                     Z-ADDWL0015    WOHGCD           Item Code
      * Establish starting position
     C           KRSSQ     CHAIN@BZREJU              90    *
      * Data record not found
     C   90                MOVEL'USR0326' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWORINB    WL0016           Item Structure
     C                     Z-ADDWORHNB    WL0017           Item Structure
     C                     Z-ADDWORGNB    WL0018           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * Crt AS Physical Count  CR - Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0132  60       Job Time
     C                     MOVEL*BLANK    WN0133 10        User Id
     C                     MOVEL*BLANK    WN0134 10        Job Name
     C                     Z-ADD*ZERO     WN0135  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B1REJ1
     C                     Z-ADDWN0002    WHAIC3           Company Number
     C                     Z-ADDWN0015    WHHGCD           Item Code
     C                     MOVELWN0011    WHAJCD           Warehouse Code
     C                     Z-ADDWN0016    WHELDT           Production Date
     C                     Z-ADDWN0013    WHABWG           Physical Count
     C                     Z-ADDWN0012    WHAGQT           Physical Count
     C                     Z-ADD*ZERO     WHAHQT           Physical Count
     C                     Z-ADD*ZERO     WHAIQT           Physical Count
     C                     MOVEL'P'       WHCTST           Physical Count
     C                     Z-ADD*ZERO     WHACWG           Quantity on Han
     C                     Z-ADD*ZERO     WHARQT           Quantity on Han
     C                     Z-ADD*ZERO     WHASQT           Quantity on Han
     C                     Z-ADD*ZERO     WHATQT           Quantity on Han
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     MOVEL'N'       WHF6ST           Update Exceptio
     C                     Z-ADD*ZERO     WHBMWG           Physical Start
     C                     Z-ADD*ZERO     WHDSQT           Physical Start
     C                     Z-ADD*ZERO     WHDTQT           Physical Start
     C                     Z-ADD*ZERO     WHDUQT           Physical Start
     C                     Z-ADDYL0012    WHDHDT           Physical Start
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     Z-ADDWN0017    WHK7DT           Label Date
     C                     Z-ADDWN0121    WHRINB           Item Structure
     C                     Z-ADDWN0122    WHRHNB           Item Structure
     C                     Z-ADDWN0123    WHRGNB           Item Structure
     C                     MOVEL*BLANK    WHUVST           EDI Status 1
     C                     MOVEL*BLANK    WHUWST           EDI Status 2
     C                     MOVEL*BLANK    WHUXST           EDI Status 3
     C                     MOVEL'A'       WHVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
     C           KLCRSR    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSR    SETLL@B1REJ1                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0331' W0RTN   7
      * Send message 'Item Balance Detail    EX'
     C                     MOVEL'USR0331' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@B1REJ1                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Crt in 846 if n/f  RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WRAJCD    WQSS02           Warehouse Code
     C           *LIKE     DEFN WRHGCD    WQSS03           Item Code
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Warehouse Code
     C                     KFLD           WQSS03           Item Code
      * Setup key
     C                     Z-ADDWN0002    WQSS01           Company Number
     C                     MOVELWN0011    WQSS02           Warehouse Code
     C                     Z-ADDWN0015    WQSS03           Item Code
      * Establish starting position
     C           KRSSS     SETLL@B0REHD                    *
     C           KRSSS     READE@B0REHD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0328' W0RTN   7
      * USER: Processing if Data record not found
      * Rtv Item Typ/Grp/Cls  RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0014           Company Number
     C                     Z-ADDWN0015    WL0015           Item Code
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    YL0013           Item Structure
     C                     Z-ADDWL0017    YL0014           Item Structure
     C                     Z-ADDWL0018    YL0015           Item Structure
      * Crt Item Balance       CR - Item Balance  * 
     C                     EXSR STCRRC
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Crt Item Balance       CR - Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0136  60       Job Time
     C                     MOVEL*BLANK    WN0137 10        User Id
     C                     MOVEL*BLANK    WN0138 10        Job Name
     C                     Z-ADD*ZERO     WN0139  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B0REJT
     C                     Z-ADDWN0002    WSAIC3           Company Number
     C                     Z-ADDWN0015    WSHGCD           Item Code
     C                     MOVELWN0011    WSAJCD           Warehouse Code
     C                     Z-ADD.01       WSAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WSAECS           Last Cost
     C                     Z-ADD*ZERO     WSBACS           Cost per Primar
     C                     Z-ADD*ZERO     WSBBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WSCBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WSGUDT           Revaluation Eff
     C                     MOVELYL0016    WSXYST           Revaluation Cos
     C                     Z-ADD*ZERO     WSCTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WSG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WSBOWG           On Hand Weight
     C                     Z-ADD*ZERO     WSDDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WSDEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WSDFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WSHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WSHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WSAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WSAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WSAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WSEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WSDOQT           Quantity Avail.
     C                     MOVEL*BLANK    WSATNA           Cycle Count Cod
     C                     Z-ADD*ZERO     WSAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WSANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WSIDVA           Value of On Han
     C                     MOVELYL0017    WSJVST           Inventory Plann
     C                     Z-ADD*ZERO     WSBZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WSDGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WSDIDT           Stock Out Date
     C                     MOVEL*BLANK    WSALCD           Buyer Code
     C                     Z-ADD*ZERO     WSBFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WSDJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WSBGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WSDKDT           Lead Time - Dat
     C                     MOVELYL0018    WSJ2ST           Lead Time - Exc
     C                     Z-ADD*ZERO     WSDJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WSBNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WSDLDT           Inventory Manag
     C                     Z-ADD*ZERO     WSDPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WSDQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WSDMDT           Last Physical C
     C                     MOVELWUUAT1    WSM0ST           Requisition Mod
     C                     MOVELYL0019    WSJ9ST           Cost Update Pen
     C                     MOVELYL0020    WSKBST           Post G/L Status
     C                     Z-ADD*ZERO     WSAKC8           Vendor - Item/W
     C                     Z-ADDYL0013    WSRINB           Item Structure
     C                     Z-ADDYL0014    WSRHNB           Item Structure
     C                     Z-ADDYL0015    WSRGNB           Item Structure
     C                     MOVELYL0021    WSUVST           EDI Status 1
     C                     MOVELYL0022    WSUWST           EDI Status 2
     C                     MOVELYL0023    WSUXST           EDI Status 3
     C                     MOVEL'A'       WSVSST           Record Status
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WSAATM' defaulted for 'Job Time'.
      * Field '(DB1) WSAYNA' defaulted for 'User Id'.
      * Field '(DB1) WSA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WSAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WSAATM           Job Time
     C                     MOVEL##USR     WSAYNA           User Id
     C                     MOVEL##JOB     WSA0NA           Job Name
     C                     Z-ADD##JDT     WSAXDT           Job Date
     C           KLCRST    KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSHGCD           Item Code
     C                     KFLD           WSAJCD           Warehouse Code
      * Check for duplicate primary key
     C           KLCRST    SETLL@B0REJT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0329' W0RTN   7
      * Send message 'Item Balance           EX'
     C                     MOVEL'USR0329' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@B0REJT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg PrcSts/ErrRsn     CH - PFS Inventory Restoration  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @B0CPD1
     C                     Z-ADDWAY1NX    WTY1NX           PFS Company Num
     C                     Z-ADDWAAID8    WTAID8           PFS Transaction
     C                     Z-ADDWAAFTS    WTAFTS           PFS Transaction
     C                     Z-ADDWABCNY    WTBCNY           PFS Transaction
      *
     C           KLCHSU    KLIST
     C                     KFLD           WTY1NX           PFS Company Num
     C                     KFLD           WTAID8           PFS Transaction
     C                     KFLD           WTAFTS           PFS Transaction
     C                     KFLD           WTBCNY           PFS Transaction
     C           KLCHSU    CHAIN@B0CPD1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PPB0CPL0'MDACP
     C                     MOVEL'@B0CPD1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPPB01    YDRDCS
      * Move non-key fields to @B0CPD1
     C                     MOVELWAXKSX    WTXKSX    P      PFS Inv Hold Re
     C                     Z-ADDWAY2NX    WTY2NX           PFS Item Code
     C                     MOVELWAU4SX    WTU4SX    P      PFS Warehouse C
     C                     Z-ADDWAADNY    WTADNY           PFS Location Co
     C                     Z-ADDWAP7DT    WTP7DT           PFS Production
     C                     Z-ADDWAZ4NX    WTZ4NX           PFS Label Date
     C                     Z-ADDWAACNY    WTACNY           PFS Receive/Loc
     C                     Z-ADDWACUNY    WTCUNY           PFS On Hand Qua
     C                     Z-ADDWACVNY    WTCVNY           PFS On Hand Wei
     C                     MOVELWAUWSX    WTUWSX    P      PFS Record Stat
     C                     Z-ADDWN0008    WTUXSX           PFS Process Sta
     C                     MOVELWN0009    WTV3SX    P      PFS Error Reaso
     C                     Z-ADDWAAHNY    WTAHNY           PFS Create Date
     C                     Z-ADDWAAINY    WTAINY           PFS Create Time
     C                     Z-ADDWAAJNY    WTAJNY           PFS Change Date
     C                     Z-ADDWAAKNY    WTAKNY           PFS Change time
      *
      * Set PGM.*Record Data Changed flag
     C           QPPB01    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@B0CPD1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPPB0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** VALIDATION *****
      *================================================================
     C                     Z-ADDWAY1NX    WN0002           Company Number
     C                     Z-ADDWAY2NX    WN0015           Item Code
     C                     MOVELWAU4SX    WN0011           Warehouse Code
      * CASE: LCL.Company Number NE DB1.PFS Company Number
     C           YL0008    IFNE WAY1NX                     *IF
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL*BLANK    WN0009           PFS Error Reaso
     C                     MOVEL'WHSCO'   WN0009           PFS Error Reaso
     C                     END                             *FI
      * Val Warehouse PFS     RT - Warehouse  * 
     C                     EXSR SJRVGN
      * Warehouse Not Found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,002                    *IF
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'WHSCDE'  WN0009           PFS Error Reaso
     C                     END                             *FI
      * Lot Tracking is Yes: Location Code & Receive/Located Date
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
     C                     END                             *FI
      * Val Itm/Whs,FG/WP PFS RT - Company Item  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0002    WL0006           Company Number
     C                     Z-ADDWN0015    WL0007           Item Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0008    WN0001    P      Production Date
     C                     Z-ADDWL0009    WN0003           Item Structure
     C                     MOVELWL0010    WN0004    P      Item Type Code
     C                     MOVELWL0011    WN0006    P      Default Warehou
     C                     Z-ADDWL0012    WN0005           Fresh Chilling
     C                     MOVELWL0013    WN0007    P      Primal Group Co
      * Item Code Not Found
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PGM.*Return code is *Record does not exist
      *   |- c2    : PAR.Primal Group Code is Scale Check
      *   '-
     C           W0RTN     IFEQ @CN,002                    *IF
     C           WN0007    OREQ 'SCALE'                    *OR
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'ITMCDE'  WN0009           PFS Error Reaso
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * RTV Unit Cost Active   RT - Item Balance  * 
     C                     EXSR SLRVGN
      * Label Date Not Entered
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.PFS Label Date is Not Entered
     C           WAZ4NX    IFEQ 0                          *IF
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'LBLDTE'  WN0009           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.Program name USR is PRC Edi 846 Inventory Inq
     C           P2BMVN    IFEQ @CN,003                    *IF
      * Rtv Whs Interchg Actv RT - EDI WHS Interchange  * 
     C                     EXSR SMRVGN
      * VAL:  ACTIVE WAREHOUSE with EDI 846
      * CASE: LCL.Record Status is Active
     C           YL0009    IFEQ 'A'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'INACTV'  WN0009           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Live w/CT PFS Int RT - Warehouse  * 
     C                     EXSR SNRVGN
      * VAL:  ACTIVE WAREHOUSE
      * CASE: LCL.WHS Live w/Carlisle is Yes
     C           YL0010    IFEQ 'Y'                        *IF
      * CASE: LCL.WHS PFS Interface is Upload/Both
     C           YL0011    IFEQ 'U'                        *IF
     C           YL0011    OREQ 'B'
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'INACTV'  WN0009           PFS Error Reaso
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD2         WN0008           PFS Process Sta
     C                     MOVEL'INACTV'  WN0009           PFS Error Reaso
     C                     END                             *FI
     C                     END                             *FI
      * ERROR:  DO NOT SELECT RECORD
      * CASE: PAR.PFS Process Status is Error
     C           WN0008    IFEQ 2                          *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      * Warehouse Not Matching Par              9.20.05
      * CASE: DB1.PFS Warehouse Code NE PAR.PFS Warehouse Code
     C           WAU4SX    IFNE P1U4SX                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Initialize
      *================================================================
      * --- Transaction Date ---
     C                     Z-ADDYL0001    WN0014           Transaction Dat
      * ------------------------
      * Production & Label Date
      * CASE: PAR.Production Date Control is yes
     C           WN0001    IFEQ 'Y'                        *IF
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     WN0016           Production Date
     C                     Z-ADD*ZERO     WN0017           Label Date
      * --- Receive date = Lot Loc Production Date ---
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0074  40       Year Code
     C                     Z-ADD*ZERO     WN0075  20       Month
     C                     Z-ADD*ZERO     WN0076  20       Day of Month US
     C                     MOVEL*BLANK    WN0077  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0078  2        Month (Char) US
     C                     MOVEL*BLANK    WN0079  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0080  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0081  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0082  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAP7DT    DIV  10000     WN0074           Year Code
     C                     Z-ADDWN0074    WN0080           Year  NBR USR
     C                     MOVELWN0080    WN0081           Year  (Char) US
      * ** MONTH **
     C           WAP7DT    DIV  100       WN0075           Month
     C                     MOVELWN0075    WN0078           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAP7DT    WN0076           Day of Month US
     C                     MOVELWN0076    WN0079           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0074    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0081:ZQ WN0082    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0081:ZQ WN0082    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0082    CAT  WN0078:ZQ WN0082    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0082    CAT  WN0079:ZQ WN0082    P      Date (Alpha) US
     C                     MOVE WN0082    WN0016           Date
     C                     Z-ADDWN0016    WN0017           Label Date
     C                     ELSE
      * CASE: *OTHERWISE
      * --- Production Date ---
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0083  40       Year Code
     C                     Z-ADD*ZERO     WN0084  20       Month
     C                     Z-ADD*ZERO     WN0085  20       Day of Month US
     C                     MOVEL*BLANK    WN0086  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0087  2        Month (Char) US
     C                     MOVEL*BLANK    WN0088  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0089  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0090  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0091  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAP7DT    DIV  10000     WN0083           Year Code
     C                     Z-ADDWN0083    WN0089           Year  NBR USR
     C                     MOVELWN0089    WN0090           Year  (Char) US
      * ** MONTH **
     C           WAP7DT    DIV  100       WN0084           Month
     C                     MOVELWN0084    WN0087           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAP7DT    WN0085           Day of Month US
     C                     MOVELWN0085    WN0088           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0083    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0090:ZQ WN0091    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0090:ZQ WN0091    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0091    CAT  WN0087:ZQ WN0091    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0091    CAT  WN0088:ZQ WN0091    P      Date (Alpha) US
     C                     MOVE WN0091    WN0016           Date
      * --- Label Date ---
      * 04/02/09 PKD Use IF instead of CL to convert date.
      *
     C                     Z-ADD*ZERO     WN0092  40       Year Code
     C                     Z-ADD*ZERO     WN0093  20       Month
     C                     Z-ADD*ZERO     WN0094  20       Day of Month US
     C                     MOVEL*BLANK    WN0095  4        Year Alpha (YYY
     C                     MOVEL*BLANK    WN0096  2        Month (Char) US
     C                     MOVEL*BLANK    WN0097  2        Day   (Char) US
     C                     Z-ADD*ZERO     WN0098  20       Year  NBR USR
     C                     MOVEL*BLANK    WN0099  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0100  7        Date (Alpha) US
      *
      * CVT *YYMD to *CYMD    IF
      * ** YEAR **
     C           WAZ4NX    DIV  10000     WN0092           Year Code
     C                     Z-ADDWN0092    WN0098           Year  NBR USR
     C                     MOVELWN0098    WN0099           Year  (Char) US
      * ** MONTH **
     C           WAZ4NX    DIV  100       WN0093           Month
     C                     MOVELWN0093    WN0096           Month (Char) US
      * ** DAY **
     C                     Z-ADDWAZ4NX    WN0094           Day of Month US
     C                     MOVELWN0094    WN0097           Day   (Char) US
      * CENTURY+YEAR
      * CASE: PAR.Year Code is Twentieth Century
     C           WN0092    IFLE 1999                       *IF
     C                     Z-ADD*ZERO     ZQ      50
     C           '0'       CAT  WN0099:ZQ WN0100    P      Date (Alpha) US
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     ZQ      50
     C           '1'       CAT  WN0099:ZQ WN0100    P      Date (Alpha) US
     C                     END                             *FI
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0100    CAT  WN0096:ZQ WN0100    P      Date (Alpha) US
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0100    CAT  WN0097:ZQ WN0100    P      Date (Alpha) US
     C                     MOVE WN0100    WN0017           Date
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Date is not entered
      *   |- c2    : PAR.Production Date Control is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0016    IFEQ 0                          *IF
     C           WN0001    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWN0017    WN0016           Production Date
     C                     END                             *FI
      * Rtv Prod date with label date. carlisle is not to be trusted.
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0016           Production Date
     C                     Z-ADD*ZERO     WN0017           Label Date
     C                     END                             *FI
     C                     Z-ADDWACUNY    WN0012           Transaction Qua
     C                     Z-ADDWACVNY    WN0013           Transaction Wei
      * LOT TRACKING WAREHOUSE
      * CASE: PAR.Lot Tracking Flag is yes
     C           WN0018    IFEQ 'Y'                        *IF
      * 12/16/08 PKD A decision was made to use Production Date instead
      *              of Receive/Locate Date.  This Date is not valid in
      *              Carlisle sometimes.
      * ----- Receive/Located Date -----
      * ----- Location Code -----
     C                     MOVELWAADNY    WN0019           Location Code
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANKS   WN0019           Location Code
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         XSTMS     BEGSR
      *================================================================
      * Refresh System timestamp
      *================================================================
     C                     CALL 'Y2RTTSK'
     C                     PARM           ##TMS  26        System timestam
      *================================================================
     CSR         XSTMSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAY1NX           PFS Company Num
     C                     Z-ADD*ZERO     WAAID8           PFS Transaction
     C                     Z-ADD*ZERO     WAAFTS           PFS Transaction
     C                     Z-ADD*ZERO     WABCNY           PFS Transaction
     C                     Z-ADD*ZERO     WAY2NX           PFS Item Code
     C                     Z-ADD*ZERO     WAADNY           PFS Location Co
     C                     Z-ADD*ZERO     WAP7DT           PFS Production
     C                     Z-ADD*ZERO     WAZ4NX           PFS Label Date
     C                     Z-ADD*ZERO     WAACNY           PFS Receive/Loc
     C                     Z-ADD*ZERO     WACUNY           PFS On Hand Qua
     C                     Z-ADD*ZERO     WACVNY           PFS On Hand Wei
     C                     Z-ADD*ZERO     WAUXSX           PFS Process Sta
     C                     Z-ADD*ZERO     WAAHNY           PFS Create Date
     C                     Z-ADD*ZERO     WAAINY           PFS Create Time
     C                     Z-ADD*ZERO     WAAJNY           PFS Change Date
     C                     Z-ADD*ZERO     WAAKNY           PFS Change time
     C                     MOVE '0'       XDTSDL 26 P
     C                     MOVEL@CN,001   XDTSDL
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WBBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WBBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WBBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WBBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCDHDT           Physical Start
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Clear all neither parameters
      * Crt Physical Count     CR - Physical Count Control  * 
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGHGCD           Item Code
     C                     Z-ADD*ZERO     WGELDT           Production Date
     C                     Z-ADD*ZERO     WGABWG           Physical Count
     C                     Z-ADD*ZERO     WGAGQT           Physical Count
     C                     Z-ADD*ZERO     WGAHQT           Physical Count
     C                     Z-ADD*ZERO     WGAIQT           Physical Count
     C                     Z-ADD*ZERO     WGACWG           Quantity on Han
     C                     Z-ADD*ZERO     WGARQT           Quantity on Han
     C                     Z-ADD*ZERO     WGASQT           Quantity on Han
     C                     Z-ADD*ZERO     WGATQT           Quantity on Han
     C                     Z-ADD*ZERO     WGHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WGHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WGBMWG           Physical Start
     C                     Z-ADD*ZERO     WGDSQT           Physical Start
     C                     Z-ADD*ZERO     WGDTQT           Physical Start
     C                     Z-ADD*ZERO     WGDUQT           Physical Start
     C                     Z-ADD*ZERO     WGDHDT           Physical Start
     C                     Z-ADD*ZERO     WGAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WGAECS           Last Cost
     C                     Z-ADD*ZERO     WGIDVA           Value of On Han
     C                     Z-ADD*ZERO     WGK7DT           Label Date
     C                     Z-ADD*ZERO     WGRINB           Item Structure
     C                     Z-ADD*ZERO     WGRHNB           Item Structure
     C                     Z-ADD*ZERO     WGRGNB           Item Structure
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WJAIWG           Unit Weight
     C                     Z-ADD*ZERO     WJCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WJC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WJURTN           Number Cases On
     C                     Z-ADD*ZERO     WJAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJTFNB           Transportation
     C                     Z-ADD*ZERO     WJTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WJTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WJBLPR           Market Overage
     C                     Z-ADD*ZERO     WJBMPR           Standard Overag
     C                     Z-ADD*ZERO     WJCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WJCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WJSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WJPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WJICN1           Item Category N
     C                     Z-ADD*ZERO     WJICN2           Item Category N
     C                     Z-ADD*ZERO     WJV2NB           Item Category N
     C                     Z-ADD*ZERO     WJITCN           Item Category N
     C                     Z-ADD*ZERO     WJITC5           Item Category N
     C                     Z-ADD*ZERO     WJICN6           Item Category N
     C                     Z-ADD*ZERO     WJICN7           Item Category N
     C                     Z-ADD*ZERO     WJICN8           Item Category N
     C                     Z-ADD*ZERO     WJICN9           Item Category N
     C                     Z-ADD*ZERO     WJICN0           Item Category N
     C                     Z-ADD*ZERO     WJSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WJA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WJSJNB           Production Lead
     C                     Z-ADD*ZERO     WJSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WJSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WJSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WJCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WJCGNB           Item Frt Overag
     C                     Z-ADD*ZERO     WJILNB           Packages per ca
     C                     Z-ADD*ZERO     WJCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WJCINB           PM Batch Size
     C                     Z-ADD*ZERO     WJCJNB           Package Level s
     C                     Z-ADD*ZERO     WJCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WJCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WJCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WJCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WJCVNB           FP Std Green We
     C                     Z-ADD*ZERO     WJCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WJCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WJCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WJC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WJB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WJB5NB           PM Line Number
     C                     Z-ADD*ZERO     WJBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WJBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WJF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WJF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WJF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WJBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WJBNNB           Production Qty
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLF5NZ           EDI Company # 9
     C                     Z-ADD*ZERO     WLF6NZ           Hold til ship w
     C                     Z-ADD*ZERO     WLMJDT           Create Date
     C                     Z-ADD*ZERO     WLBETM           Create Time
     C                     Z-ADD*ZERO     WLMKDT           Change Date
     C                     Z-ADD*ZERO     WLBFTM           Change Time
      * Clear all neither parameters
      * Crt AS Physical Count  CR - Item Balance Detail  * 
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Blank for 3          USR
     C                     MOVEL*BLANK    WUUAT1  3
      * Clear all neither parameters
      * Crt Item Balance       CR - Item Balance  * 
     C                     Z-ADD*ZERO     WSAATM           Job Time
     C                     Z-ADD*ZERO     WSAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SECHRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  70
     C                     MOVEL*BLANK    WL0004  3
     C                     MOVEL*BLANK    WL0005  1
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  1
     C                     Z-ADD*ZERO     WL0009  30
     C                     MOVEL*BLANK    WL0010  3
     C                     MOVEL*BLANK    WL0011  3
     C                     Z-ADD*ZERO     WL0012  52
     C                     MOVEL*BLANK    WL0013  6
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0014  30
     C                     Z-ADD*ZERO     WL0015  70
     C                     Z-ADD*ZERO     WL0016  30
     C                     Z-ADD*ZERO     WL0017  30
     C                     Z-ADD*ZERO     WL0018  30
      * Define local work field System Date USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field *System timestamp
     C                     MOVELXDTSDL    YL0002 26
      * Define local work field Year USR
     C                     MOVEL*BLANK    YL0003  4
      * Define local work field Month USR
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Day USR
     C                     MOVEL*BLANK    YL0005  2
      * Define local work field Date (Char-8) USR
     C                     MOVEL*BLANK    YL0006  8
      * Define local work field DATE
     C                     Z-ADD*ZERO     YL0007  80
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0008  30
      * Define local work field Record Status
     C                     MOVEL*BLANK    YL0009  1
      * Define local work field WHS Live w/Carlisle
     C                     MOVEL*BLANK    YL0010  1
      * Define local work field WHS PFS Interface
     C                     MOVEL*BLANK    YL0011  1
      * Define local work field USR Start Date
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Item Structure Class Code
     C                     Z-ADD*ZERO     YL0013  30
      * Define local work field Item Structure Group Code
     C                     Z-ADD*ZERO     YL0014  30
      * Define local work field Item Structure Type Code
     C                     Z-ADD*ZERO     YL0015  30
      * Define local work field Revaluation Cost Type
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Inventory Planning Type
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Lead Time - Exception
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Cost Update Pending
     C                     MOVEL*BLANK    YL0019  1
      * Define local work field Post G/L Status
     C                     MOVEL*BLANK    YL0020  1
      * Define local work field EDI Status 1
     C                     MOVEL*BLANK    YL0021  1
      * Define local work field EDI Status 2
     C                     MOVEL*BLANK    YL0022  1
      * Define local work field EDI Status 3
     C                     MOVEL*BLANK    YL0023  1
      * Define local work field Email Address
     C                     MOVEL*BLANK    YL0024 50
      * Define local work field Text USR 43
     C                     MOVEL*BLANK    YL0025 43
      * Define local work field Office Message USR
     C                     MOVEL*BLANK    YL0026132
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 0001-01-01-00.00.00.00000
00002 Y2U0005
00003 EDI846
00004 INACTV
00005 PPT1DFR
00006 INVRST
00007 Carlisle Upload
00008 Completed for:
