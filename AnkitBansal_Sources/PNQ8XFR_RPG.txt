     H/TITLE RTV Pricing: PSITPR   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 12/09/10  Time  : 15:42:47
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPNF5CPL2IF  E           K        DISK
      * RSQ : IP Cust Item Price        ShpTo/Mkt/Itm/PDte(d)
      *
     FPNGBREL1IF  E           K        DISK
      * RTV : IP Item Market Details    Retrieval index
      *
     FOMF0CPL2IF  E           K        DISK
      * RSQ : Commodity Mrkt Price      Market Date Descending
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@F5CPFV
      * IP Cust Item Price        ShpTo/Mkt/Itm/PDte(d)
      * Renamed input format fields
     I              F5BKC7                          WABKC7
     I              F5LQCD                          WALQCD
     I              F5HGCD                          WAHGCD
     I              F5TPDT                          WATPDT
     I              F5GXPR                          WAGXPR
     I              F5HCPR                          WAHCPR
     I              F5K2ST                          WAK2ST
     I              F5KZCD                          WAKZCD
     I              F5R4CD                          WAR4CD
     I              F5HHAA                          WAHHAA
     I              F5ALCD                          WAALCD
     I              F5LRCD                          WALRCD
     I              F5I9ST                          WAI9ST
     I              F5JBST                          WAJBST
     I              F5VSST                          WAVSST
     I              F5MJDT                          WAMJDT
     I              F5BETM                          WABETM
     I              F5CCVN                          WACCVN
     I              F5CDVN                          WACDVN
     I              F5MKDT                          WAMKDT
     I              F5BFTM                          WABFTM
     I              F5CEVN                          WACEVN
     I              F5CFVN                          WACFVN
      *
     I@GBREGM
      * IP Item Market Details    Retrieval index
      * Renamed input format fields
     I              GBHGCD                          WBHGCD
     I              GBLQCD                          WBLQCD
     I              GBLRCD                          WBLRCD
     I              GBG2PC                          WBG2PC
     I              GBG8PR                          WBG8PR
     I              GBVSST                          WBVSST
     I              GBMJDT                          WBMJDT
     I              GBBETM                          WBBETM
     I              GBCCVN                          WBCCVN
     I              GBCDVN                          WBCDVN
     I              GBMKDT                          WBMKDT
     I              GBBFTM                          WBBFTM
     I              GBCEVN                          WBCEVN
     I              GBCFVN                          WBCFVN
      *
     I@F0CPEP
      * Commodity Mrkt Price      Market Date Descending
      * Renamed input format fields
     I              F0LQCD                          WCLQCD
     I              F0LRCD                          WCLRCD
     I              F0EQDT                          WCEQDT
     I              F0A5PR                          WCA5PR
     I              F0B8PR                          WCB8PR
     I              F0UVST                          WCUVST
     I              F0UWST                          WCUWST
     I              F0UXST                          WCUXST
     I              F0VSST                          WCVSST
     I              F0AATM                          WCAATM
     I              F0AYNA                          WCAYNA
     I              F0A0NA                          WCA0NA
     I              F0AXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Ship To Customer
     I                                    P   3   60P1BKC7
      * I :  Actual Shipped Date
     I                                    P   7  100P1GNDT
      * I :  Requested Delivery Date
     I                                    P  11  140P1EIDT
      * I :  Requested Ship Date
     I                                    P  15  180P1A5DT
      * I :  Item Code
     I                                    P  19  220P1HGCD
      * I :  Date of Orig. Entry Det.
     I                                    P  23  260P1D3DT
      * I :  Commodity Market Code
     I                                       27  29 P1LQCD
      * I :  Market Pricing Date
     I                                    P  30  330P1EXDT
      * B :  Price Status
     I                                       34  34 P1U1ST
      * I :  Date Method Code
     I                                       35  37 P1RDCD
      * B :  Pricing Date Used
     I                                    P  38  410P1GIDT
      * B :  Pricing Retrieved Amount
     I                                    P  42  474P1TPVA
      * I :  Event Called From
     I                                       48  49 P1SJCD
      * I :  Commodity Price Group
     I                                       50  56 P1LRCD
      * I :  OD Market Begin Date
     I                                    P  57  600P1TKDT
      * I :  OD Market Ending Date
     I                                    P  61  640P1TLDT
     IP2PARM      DS
      * N :  Date Used for Calculation
     I                                    P   1   40P2GTDT
     IP3PARM      DS
      * O :  Error Return
     I                                        1   5 P3WZST
     IP4PARM      DS
      * FLD: Company Item
      * N :  U/M - Primary
     I                                        1   2 P4ADCD
      * N :  Conversion Factor 1
     I                                    P   3   74P4AWPC
      * N :  Operation Factor 1
     I                                        8   8 P4LXST
      * N :  U/M - Second
     I                                        9  10 P4AECD
      * N :  Conversion Factor 2
     I                                    P  11  154P4AXPC
      * N :  Operation Factor 2
     I                                       16  16 P4LYST
      * N :  U/M - Third
     I                                       17  18 P4AFCD
      * N :  U/M - Pricing
     I                                       19  20 P4AICD
      * N :  Default Commod Mark basis
     I                                       21  23 P4LNCD
     IP5PARM      DS
      * N :  Price Adjustment Amount
     I                                    P   1   64P5LOVA
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1BKC7    PARM           WP0002  70       Ship To Custome
     C           P1GNDT    PARM           WP0003  70       Actual Shipped
     C           P1EIDT    PARM           WP0004  70       Requested Deliv
     C           P1A5DT    PARM           WP0005  70       Requested Ship
     C           P1HGCD    PARM           WP0006  70       Item Code
     C           P1D3DT    PARM           WP0007  70       Date of Orig. E
     C           P1LQCD    PARM           WP0008  3        Commodity Marke
     C           P1EXDT    PARM           WP0009  70       Market Pricing
     C           P1U1ST    PARM P1U1ST    WP0010  1        Price Status
     C           P1RDCD    PARM           WP0011  3        Date Method Cod
     C           P1GIDT    PARM P1GIDT    WP0012  70       Pricing Date Us
     C           P1TPVA    PARM P1TPVA    WP0013 114       Pricing Retriev
     C           P1SJCD    PARM           WP0014  2        Event Called Fr
     C           P1LRCD    PARM           WP0015  7        Commodity Price
     C           P1TKDT    PARM           WP0016  70       OD Market Begin
     C           P1TLDT    PARM           WP0017  70       OD Market Endin
     C           P3WZST    PARM P3WZST    WP0018  5        Error Return
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * RTV Pricing: PSITPR   XF
      * Conversion Documentation
     C                     EXSR UASUBR                     Conversion Docu
      * *** Price Routine was call on or after Shipping, Calculate Price
      * CASE: PAR.Event Called From is All Values
     C           P1SJCD    IFEQ '02'                       *IF
     C           P1SJCD    OREQ '99'
     C           P1SJCD    OREQ '**'
     C           P1SJCD    OREQ 'AO'
     C           P1SJCD    OREQ 'AI'
      * *** Load Date used for calculation (to retrieve Market date)
      * CASE: PAR.Market Pricing Date is NE Zero
     C           P1EXDT    IFNE *ZERO                      *IF
     C                     Z-ADDP1EXDT    P2GTDT           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Date Used for Calculation is not entered
     C           P2GTDT    IFEQ *ZERO                      *IF
      * CASE: PAR.Actual Shipped Date is entered
     C           P1GNDT    IFNE *ZERO                      *IF
     C                     Z-ADDP1GNDT    P2GTDT           Date Used for C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1A5DT    P2GTDT           Date Used for C
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Cust Item Price   RT - IP Cust Item Price  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1BKC7    WL0001           Ship To Custome
     C                     MOVELP1LQCD    WL0002    P      Commodity Marke
     C                     Z-ADDP1HGCD    WL0003           Item Code
     C                     Z-ADDP2GTDT    WL0004           CIP Price Date
     C                     EXSR SARVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    P1TPVA           CIP Item Price
     C                     Z-ADDWL0006    P1GIDT           USR Date Priced
      * Flag as Unpriced if Price Date doesn't match Market date entered
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Pricing Date Used NE PAR.Date Used for Calculati
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           P1GIDT    IFNE P2GTDT                     *IF
     C           W0RTN     OREQ @CN,001                    *OR
     C                     MOVEL'U'       P1U1ST           Price Status
      * If no pricing record was found then flag as pricing error.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    P3WZST           Error Return
     C                     MOVEL'MKT'     P3WZST           Error Return
     C                     END                             *FI
     C                     END                             *FI
      * If record not found use default commodity market from company/ite
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
      * RTV Dflt Comm Mrkt     XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDMNXFR'              90  RTV Dflt Comm M
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0001  30       Company Number
     C                     PARM P1HGCD    WQ0002  70       Item Code
     C           P4LNCD    PARM *BLANK    WQ0003  3        Default Commod
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Market Details    RT - IP Item Market Details  * 
     C                     EXSR SBRVGN
      * CASE: PAR.Commodity Market Code NE PAR.Default Commod Mark basis
     C           P1LQCD    IFNE P4LNCD                     *IF
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP4LNCD    WL0007    P      Commodity Marke
     C                     MOVELYL0001    WL0008    P      Commodity Price
     C                     Z-ADDP2GTDT    WL0009           Market Price Da
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    P1TPVA           Commodity Marke
     C                     Z-ADDWL0011    P1GIDT           USR Date Priced
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Convert Price to CWT
      * CASE: PAR.Pricing Retrieved Amount is Not Zeros
     C           P1TPVA    IFNE *ZERO                      *IF
      * CLC Convert Price - CW XF - /UT Inv. Interface Funcs  * 
     C                     CALL 'PDKUXFR'              90  CLC Convert Pri
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0004  30       Company Number
     C                     PARM P1HGCD    WQ0005  70       Item Code
     C                     PARM P1TPVA    WQ0006 114       Unit Price
     C           P5LOVA    PARM *ZERO     WQ0007 114       Price Adjustmen
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDKUXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDP5LOVA    P1TPVA           Pricing Retriev
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Cust Item Price   RT - IP Cust Item Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSA01           Ship To Custome
     C           *LIKE     DEFN WALQCD    WQSA02           Commodity Marke
     C           *LIKE     DEFN WAHGCD    WQSA03           Item Code
      * Define keylist
     C           KPSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Commodity Marke
     C                     KFLD           WQSA03           Item Code
     C                     KFLD           WATPDT           CIP Price Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
     C                     KFLD           WQSA02           Commodity Marke
     C                     KFLD           WQSA03           Item Code
      * Setup key
     C                     Z-ADDWL0001    WQSA01           Ship To Custome
     C                     MOVELWL0002    WQSA02           Commodity Marke
     C                     Z-ADDWL0003    WQSA03           Item Code
     C                     Z-ADDWL0004    WATPDT           CIP Price Date
      * Establish starting position
     C           KPSSA     SETLL@F5CPFV                    *
     C           KRSSA     READE@F5CPFV                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4285' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           CIP Item Price
     C                     Z-ADD*ZERO     WL0006           USR Date Priced
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.CIP Item Price Override is Not Zeros
     C           WAHCPR    IFNE *ZERO                      *IF
     C                     Z-ADDWAHCPR    WL0005           CIP Item Price
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAGXPR    WL0005           CIP Item Price
     C                     END                             *FI
     C                     Z-ADDWATPDT    WL0006           USR Date Priced
     C                     GOTO SAEXIT                     *QUIT
     C           KRSSA     READE@F5CPFV                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Market Details    RT - IP Item Market Details  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBLQCD           Commodity Marke
      * Setup key
     C                     Z-ADDP1HGCD    WBHGCD           Item Code
     C                     MOVELP4LNCD    WBLQCD           Commodity Marke
      * Establish starting position
     C           KRSSB     CHAIN@GBREGM              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4314' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           Commodity Price
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBLRCD    YL0001           Commodity Price
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Market Price       RT - Commodity Mrkt Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCLQCD    WQSC01           Commodity Marke
     C           *LIKE     DEFN WCLRCD    WQSC02           Commodity Price
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Commodity Marke
     C                     KFLD           WQSC02           Commodity Price
     C                     KFLD           WCEQDT           Market Price Da
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Commodity Marke
     C                     KFLD           WQSC02           Commodity Price
      * Setup key
     C                     MOVELWL0007    WQSC01           Commodity Marke
     C                     MOVELWL0008    WQSC02           Commodity Price
     C                     Z-ADDWL0009    WCEQDT           Market Price Da
      * Establish starting position
     C           KPSSC     SETLL@F0CPEP                    *
     C           KRSSC     READE@F0CPEP                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1222' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL@CN,001   W0RTN            *Return code
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0010           Commodity Marke
     C                     Z-ADD*ZERO     WL0011           USR Date Priced
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWCA5PR    WL0010           Commodity Marke
     C                     Z-ADDWCEQDT    WL0011           USR Date Priced
     C                     GOTO SCEXIT                     *QUIT
     C           KRSSC     READE@F0CPEP                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Conversion Documentation
      *================================================================
      * Market Price will be converted to CWT because Overages will be
      * by CWT if it is Customer Overage, and Market Price may not be.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2GTDT           Date Used for C
     C                     MOVEL*BLANK    P4ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P4AWPC           Conversion Fact
     C                     MOVEL*BLANK    P4LXST           Operation Facto
     C                     MOVEL*BLANK    P4AECD           U/M - Second
     C                     Z-ADD*ZERO     P4AXPC           Conversion Fact
     C                     MOVEL*BLANK    P4LYST           Operation Facto
     C                     MOVEL*BLANK    P4AFCD           U/M - Third
     C                     MOVEL*BLANK    P4AICD           U/M - Pricing
     C                     MOVEL*BLANK    P4LNCD           Default Commod
     C                     Z-ADD*ZERO     P5LOVA           Price Adjustmen
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WATPDT           CIP Price Date
     C                     Z-ADD*ZERO     WAGXPR           CIP Item Price
     C                     Z-ADD*ZERO     WAHCPR           CIP Item Price
     C                     Z-ADD*ZERO     WAMJDT           Create Date
     C                     Z-ADD*ZERO     WABETM           Create Time
     C                     Z-ADD*ZERO     WAMKDT           Change Date
     C                     Z-ADD*ZERO     WABFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBG2PC           Market Percent
     C                     Z-ADD*ZERO     WBG8PR           Market Prem/Ded
     C                     Z-ADD*ZERO     WBMJDT           Create Date
     C                     Z-ADD*ZERO     WBBETM           Create Time
     C                     Z-ADD*ZERO     WBMKDT           Change Date
     C                     Z-ADD*ZERO     WBBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCEQDT           Market Price Da
     C                     Z-ADD*ZERO     WCA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WCB8PR           Projected Marke
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  70
     C                     MOVEL*BLANK    WL0002  3
     C                     Z-ADD*ZERO     WL0003  70
     C                     Z-ADD*ZERO     WL0004  70
     C                     Z-ADD*ZERO     WL0005 114
     C                     Z-ADD*ZERO     WL0006  70
      * Define local variables for subroutine SCRVGN.
     C                     MOVEL*BLANK    WL0007  3
     C                     MOVEL*BLANK    WL0008  7
     C                     Z-ADD*ZERO     WL0009  70
     C                     Z-ADD*ZERO     WL0010 114
     C                     Z-ADD*ZERO     WL0011  70
      * Define local work field Commodity Price Group
     C                     MOVEL*BLANK    YL0001  7
      * Define null work field Market Percent
     C                     Z-ADD*ZERO     YN0001  52
      * Define null work field Market Prem/Ded
     C                     Z-ADD*ZERO     YN0002  94
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
