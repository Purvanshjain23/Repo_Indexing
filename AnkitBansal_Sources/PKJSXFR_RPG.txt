     H/TITLE TEST DATA 01              Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:36:32
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKCPCPL1IF  E           K        DISK
      * RTV : Eval Trans UPL            Retrieval index
      *
     FPKBVCPLAIF  E           K        DISK
      * RSQ : Eval Trans                Kill Dte (D)
      *
     FPKDYCPL1IF  E           K        DISK
      * RTV : Tattoo Detail Ext         Retrieval index
      *
     FPKCPCPL0UF  E           K        DISK
      * UPD : Eval Trans UPL            Update index
      *
     FPKBVCPL0UF  E           K        DISK
      * UPD : Eval Trans                Update index
      *
     FPKDYCPL0UF  E           K        DISK
      * UPD : Tattoo Detail Ext         Update index
      *
     I@CPCPMX
      * Eval Trans UPL            Retrieval index
      * Renamed input format fields
     I              CPHKST                          WAHKST
     I              CPB7DT                          WAB7DT
     I              CPKINB                          WAKINB
     I              CPKHNB                          WAKHNB
     I              CPLNNB                          WALNNB
     I              CPHLST                          WAHLST
     I              CPKJNB                          WAKJNB
     I              CPKKNB                          WAKKNB
     I              CPBQPC                          WABQPC
     I              CPBRPC                          WABRPC
     I              CPHMST                          WAHMST
     I              CPHNST                          WAHNST
     I              CPHTST                          WAHTST
     I              CPHUST                          WAHUST
     I              CPX6NB                          WAX6NB
     I              CPFQPC                          WAFQPC
     I              CPFRPC                          WAFRPC
     I              CPM7CD                          WAM7CD
     I              CPX7ST                          WAX7ST
     I              CPX8ST                          WAX8ST
     I              CPX9ST                          WAX9ST
     I              CPYAST                          WAYAST
     I              CPYBST                          WAYBST
     I              CPYCST                          WAYCST
     I              CPZJST                          WAZJST
     I              CPZKST                          WAZKST
     I              CPZLST                          WAZLST
     I              CPB8DT                          WAB8DT
     I              CPAOTM                          WAAOTM
      *
     I@CPCPMW
      * Eval Trans UPL            Update index
      * Renamed input format fields
     I              CPHKST                          WBHKST
     I              CPB7DT                          WBB7DT
     I              CPKINB                          WBKINB
     I              CPKHNB                          WBKHNB
     I              CPLNNB                          WBLNNB
     I              CPHLST                          WBHLST
     I              CPKJNB                          WBKJNB
     I              CPKKNB                          WBKKNB
     I              CPBQPC                          WBBQPC
     I              CPBRPC                          WBBRPC
     I              CPHMST                          WBHMST
     I              CPHNST                          WBHNST
     I              CPHTST                          WBHTST
     I              CPHUST                          WBHUST
     I              CPX6NB                          WBX6NB
     I              CPFQPC                          WBFQPC
     I              CPFRPC                          WBFRPC
     I              CPM7CD                          WBM7CD
     I              CPX7ST                          WBX7ST
     I              CPX8ST                          WBX8ST
     I              CPX9ST                          WBX9ST
     I              CPYAST                          WBYAST
     I              CPYBST                          WBYBST
     I              CPYCST                          WBYCST
     I              CPZJST                          WBZJST
     I              CPZKST                          WBZKST
     I              CPZLST                          WBZLST
     I              CPB8DT                          WBB8DT
     I              CPAOTM                          WBAOTM
      *
     I@BVCPSW
      * Eval Trans                Kill Dte (D)
      * Renamed input format fields
     I              BVHSNB                          WCHSNB
     I              BVA9DT                          WCA9DT
     I              BVFJNB                          WCFJNB
     I              BVHCNB                          WCHCNB
     I              BVGDNB                          WCGDNB
     I              BVFINB                          WCFINB
     I              BVLKNB                          WCLKNB
     I              BVEAST                          WCEAST
     I              BVAMPC                          WCAMPC
     I              BVAIPC                          WCAIPC
     I              BVAJPC                          WCAJPC
     I              BVAKPC                          WCAKPC
     I              BVX8NB                          WCX8NB
     I              BVFVPC                          WCFVPC
     I              BVFWPC                          WCFWPC
     I              BVFXPC                          WCFXPC
     I              BVALPC                          WCALPC
     I              BVDIST                          WCDIST
     I              BVFYST                          WCFYST
     I              BVD2ST                          WCD2ST
     I              BVEHST                          WCEHST
     I              BVG1ST                          WCG1ST
     I              BVH4ST                          WCH4ST
     I              BVJLST                          WCJLST
     I              BVUUST                          WCUUST
     I              BVVHST                          WCVHST
     I              BVVIST                          WCVIST
     I              BVVJST                          WCVJST
     I              BVVKST                          WCVKST
     I              BVVLST                          WCVLST
     I              BVHMNB                          WCHMNB
     I              BVBNNB                          WCBNNB
     I              BVBONB                          WCBONB
     I              BVCVNB                          WCCVNB
     I              BVB0DT                          WCB0DT
     I              BVAAVN                          WCAAVN
     I              BVAADT                          WCAADT
     I              BVAMTM                          WCAMTM
     I              BVAJST                          WCAJST
     I              BVAHVN                          WCAHVN
     I              BVAGVN                          WCAGVN
     I              BVABVN                          WCABVN
     I              BVABDT                          WCABDT
     I              BVABTM                          WCABTM
     I              BVB8DT                          WCB8DT
     I              BVAOTM                          WCAOTM
      *
     I@BVCPF0
      * Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     I@DYCPXX
      * Tattoo Detail Ext         Retrieval index
      * Renamed input format fields
     I              DYHMNB                          WEHMNB
     I              DYBNNB                          WEBNNB
     I              DYBONB                          WEBONB
     I              DYCVNB                          WECVNB
     I              DYB0DT                          WEB0DT
     I              DYC2NB                          WEC2NB
     I              DYP3ST                          WEP3ST
     I              DYLENB                          WELENB
     I              DYLFNB                          WELFNB
     I              DYLINB                          WELINB
     I              DYP4ST                          WEP4ST
     I              DYP5ST                          WEP5ST
     I              DYAAVN                          WEAAVN
     I              DYAADT                          WEAADT
     I              DYAMTM                          WEAMTM
     I              DYAJST                          WEAJST
     I              DYAHVN                          WEAHVN
     I              DYAGVN                          WEAGVN
     I              DYABVN                          WEABVN
     I              DYABDT                          WEABDT
     I              DYABTM                          WEABTM
      *
     I@DYCPXW
      * Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WFHMNB
     I              DYBNNB                          WFBNNB
     I              DYBONB                          WFBONB
     I              DYCVNB                          WFCVNB
     I              DYB0DT                          WFB0DT
     I              DYC2NB                          WFC2NB
     I              DYP3ST                          WFP3ST
     I              DYLENB                          WFLENB
     I              DYLFNB                          WFLFNB
     I              DYLINB                          WFLINB
     I              DYP4ST                          WFP4ST
     I              DYP5ST                          WFP5ST
     I              DYAAVN                          WFAAVN
     I              DYAADT                          WFAADT
     I              DYAMTM                          WFAMTM
     I              DYAJST                          WFAJST
     I              DYAHVN                          WFAHVN
     I              DYAGVN                          WFAGVN
     I              DYABVN                          WFABVN
     I              DYABDT                          WFABDT
     I              DYABTM                          WFABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKCP1    E DSPKCPCPL0
      * UPD : Eval Trans UPL            Update index
      * Renamed input format fields
     I              CPHKST                          WBHKST
     I              CPB7DT                          WBB7DT
     I              CPKINB                          WBKINB
     I              CPKHNB                          WBKHNB
     I              CPLNNB                          WBLNNB
     I              CPHLST                          WBHLST
     I              CPKJNB                          WBKJNB
     I              CPKKNB                          WBKKNB
     I              CPBQPC                          WBBQPC
     I              CPBRPC                          WBBRPC
     I              CPHMST                          WBHMST
     I              CPHNST                          WBHNST
     I              CPHTST                          WBHTST
     I              CPHUST                          WBHUST
     I              CPX6NB                          WBX6NB
     I              CPFQPC                          WBFQPC
     I              CPFRPC                          WBFRPC
     I              CPM7CD                          WBM7CD
     I              CPX7ST                          WBX7ST
     I              CPX8ST                          WBX8ST
     I              CPX9ST                          WBX9ST
     I              CPYAST                          WBYAST
     I              CPYBST                          WBYBST
     I              CPYCST                          WBYCST
     I              CPZJST                          WBZJST
     I              CPZKST                          WBZKST
     I              CPZLST                          WBZLST
     I              CPB8DT                          WBB8DT
     I              CPAOTM                          WBAOTM
      *
     IYARDCS      DS                             59
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKBV1    E DSPKBVCPL0
      * UPD : Eval Trans                Update index
      * Renamed input format fields
     I              BVHSNB                          WDHSNB
     I              BVA9DT                          WDA9DT
     I              BVFJNB                          WDFJNB
     I              BVHCNB                          WDHCNB
     I              BVGDNB                          WDGDNB
     I              BVFINB                          WDFINB
     I              BVLKNB                          WDLKNB
     I              BVEAST                          WDEAST
     I              BVAMPC                          WDAMPC
     I              BVAIPC                          WDAIPC
     I              BVAJPC                          WDAJPC
     I              BVAKPC                          WDAKPC
     I              BVX8NB                          WDX8NB
     I              BVFVPC                          WDFVPC
     I              BVFWPC                          WDFWPC
     I              BVFXPC                          WDFXPC
     I              BVALPC                          WDALPC
     I              BVDIST                          WDDIST
     I              BVFYST                          WDFYST
     I              BVD2ST                          WDD2ST
     I              BVEHST                          WDEHST
     I              BVG1ST                          WDG1ST
     I              BVH4ST                          WDH4ST
     I              BVJLST                          WDJLST
     I              BVUUST                          WDUUST
     I              BVVHST                          WDVHST
     I              BVVIST                          WDVIST
     I              BVVJST                          WDVJST
     I              BVVKST                          WDVKST
     I              BVVLST                          WDVLST
     I              BVHMNB                          WDHMNB
     I              BVBNNB                          WDBNNB
     I              BVBONB                          WDBONB
     I              BVCVNB                          WDCVNB
     I              BVB0DT                          WDB0DT
     I              BVAAVN                          WDAAVN
     I              BVAADT                          WDAADT
     I              BVAMTM                          WDAMTM
     I              BVAJST                          WDAJST
     I              BVAHVN                          WDAHVN
     I              BVAGVN                          WDAGVN
     I              BVABVN                          WDABVN
     I              BVABDT                          WDABDT
     I              BVABTM                          WDABTM
     I              BVB8DT                          WDB8DT
     I              BVAOTM                          WDAOTM
      *
     IQPKDY1    E DSPKDYCPL0
      * UPD : Tattoo Detail Ext         Update index
      * Renamed input format fields
     I              DYHMNB                          WFHMNB
     I              DYBNNB                          WFBNNB
     I              DYBONB                          WFBONB
     I              DYCVNB                          WFCVNB
     I              DYB0DT                          WFB0DT
     I              DYC2NB                          WFC2NB
     I              DYP3ST                          WFP3ST
     I              DYLENB                          WFLENB
     I              DYLFNB                          WFLFNB
     I              DYLINB                          WFLINB
     I              DYP4ST                          WFP4ST
     I              DYP5ST                          WFP5ST
     I              DYAAVN                          WFAAVN
     I              DYAADT                          WFAADT
     I              DYAMTM                          WFAMTM
     I              DYAJST                          WFAJST
     I              DYAHVN                          WFAHVN
     I              DYAGVN                          WFAGVN
     I              DYABVN                          WFABVN
     I              DYABDT                          WFABDT
     I              DYABTM                          WFABTM
      *
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * TEST DATA 01
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * RTV TEST DATA 01 - Eval Trans UPL  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV TEST DATA 01 - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHKST    WQSA01           EA Company Numb
     C           *LIKE     DEFN WAB7DT    WQSA02           EA Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           EA Company Numb
     C                     KFLD           WQSA02           EA Kill Date
      * Setup key
     C                     Z-ADD360       WQSA01           EA Company Numb
     C                     Z-ADD970315    WQSA02           EA Kill Date
      * Establish starting position
     C           KRSSA     SETLL@CPCPMX                    *
     C           KRSSA     READE@CPCPMX                  90*
      * Data record not found
     C   90                MOVEL'PRK0341' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'N'       WUHUST           EA Record Proce
      * CASE: DB1.EA Tattoo Number is Seaboard Int Hogs
     C           WAKHNB    IFGE 7000                       *IF
     C           WAKHNB    ANDLE7999
     C                     Z-ADD9999      WUKHNB           EA Tattoo Numbe
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAKHNB    WUKHNB           EA Tattoo Numbe
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAM7CD' defaulted for 'EA Trolley Id'.
      * Field '(DB1) WAX7ST' defaulted for 'EA Broken Back Sts'.
      * Field '(DB1) WAX8ST' defaulted for 'EA Unused Sts 1'.
      * Field '(DB1) WAX9ST' defaulted for 'EA Unused Sts 2'.
      * Field '(DB1) WAYAST' defaulted for 'EA Unused Sts 3'.
      * Field '(DB1) WAYBST' defaulted for 'EA Unused Sts 4'.
      * Field '(DB1) WAYCST' defaulted for 'EA Unused Sts 5'.
      * Field '(DB1) WAZJST' defaulted for 'EA Unused Sts 6'.
      * Field '(DB1) WAZKST' defaulted for 'EA Unused Sts 7'.
      * Field '(DB1) WAZLST' defaulted for 'EA Unused Sts 8'.
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
     C                     EXSR SBCHRC
      * DLT TEST DATA 01 - Eval Trans  * 
     C                     EXSR SCRVGN
      * DLT TEST DATA 01       RT - Tattoo Detail Ext  * 
     C                     EXSR SERVGN
     C           KRSSA     READE@CPCPMX                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * Chg Eval Trans UPL    CH - Eval Trans UPL  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CPCPMW
     C                     Z-ADDWAHKST    WBHKST           EA Company Numb
     C                     Z-ADDWAB7DT    WBB7DT           EA Kill Date
     C                     Z-ADDWAKINB    WBKINB           EA Scale Sequen
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBHKST           EA Company Numb
     C                     KFLD           WBB7DT           EA Kill Date
     C                     KFLD           WBKINB           EA Scale Sequen
     C           KLCHSB    CHAIN@CPCPMW              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCPCPL0'MDACP
     C                     MOVEL'@CPCPMW' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCP1    YARDCS
      * Move non-key fields to @CPCPMW
     C                     Z-ADDWUKHNB    WBKHNB           EA Tattoo Numbe
     C                     Z-ADDWUKHNB    WBLNNB           EA Lot
     C                     MOVELWAHLST    WBHLST    P      EA Shift
     C                     Z-ADDWAKJNB    WBKJNB           EA Hot Weight
     C                     Z-ADDWAKKNB    WBKKNB           EA Backfat Thic
     C                     Z-ADDWABQPC    WBBQPC           EA Loin-Eye Dep
     C                     Z-ADDWABRPC    WBBRPC           EA Light Reflec
     C                     MOVELWAHMST    WBHMST    P      EA Trim Area
     C                     MOVELWAHNST    WBHNST    P      EA Carcass Sex
     C                     MOVEL'P'       WBHTST    P      EA Record Creat
     C                     MOVELWUHUST    WBHUST    P      EA Record Proce
     C                     Z-ADDWAX6NB    WBX6NB           EA Backfat MM
     C                     Z-ADDWAFQPC    WBFQPC           EA LoinEye MM
     C                     Z-ADDWAFRPC    WBFRPC           EA Light Refl M
     C                     MOVELWAM7CD    WBM7CD    P      EA Trolley Id
     C                     MOVELWAX7ST    WBX7ST    P      EA Broken Back
     C                     MOVELWAX8ST    WBX8ST    P      EA Unused Sts 1
     C                     MOVELWAX9ST    WBX9ST    P      EA Unused Sts 2
     C                     MOVELWAYAST    WBYAST    P      EA Unused Sts 3
     C                     MOVELWAYBST    WBYBST    P      EA Unused Sts 4
     C                     MOVELWAYCST    WBYCST    P      EA Unused Sts 5
     C                     MOVELWAZJST    WBZJST    P      EA Unused Sts 6
     C                     MOVELWAZKST    WBZKST    P      EA Unused Sts 7
     C                     MOVELWAZLST    WBZLST    P      EA Unused Sts 8
     C                     Z-ADDWAB8DT    WBB8DT           RU Date
     C                     Z-ADDWAAOTM    WBAOTM           RU Time
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCP1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CPCPMW                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCPCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * DLT TEST DATA 01 - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCA9DT    WQSC01           ET Kill Date
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           ET Kill Date
      * Setup key
     C                     Z-ADD970315    WQSC01           ET Kill Date
      * Establish starting position
     C           KRSSC     SETLL@BVCPSW                    *
     C           KRSSC     READE@BVCPSW                  90*
      * Data record not found
     C   90                MOVEL'PRK0121' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Eval Trans        DL - Eval Trans  * 
     C                     EXSR SDDLRC
     C           KRSSC     READE@BVCPSW                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDDLRC    BEGSR
      *================================================================
      * Dlt Eval Trans        DL - Eval Trans  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @BVCPF0
     C                     Z-ADDWCHSNB    WDHSNB           ET Company Numb
     C                     Z-ADDWCA9DT    WDA9DT           ET Kill Date
     C                     Z-ADDWCFJNB    WDFJNB           ET Scale Sequen
     C                     Z-ADDWCHCNB    WDHCNB           ET Carcass Numb
     C                     Z-ADDWCGDNB    WDGDNB           ET Carcass Numb
      *
     C           KLDLSD    KLIST
     C                     KFLD           WDHSNB           ET Company Numb
     C                     KFLD           WDA9DT           ET Kill Date
     C                     KFLD           WDFJNB           ET Scale Sequen
     C                     KFLD           WDHCNB           ET Carcass Numb
     C                     KFLD           WDGDNB           ET Carcass Numb
     C           KLDLSD    CHAIN@BVCPF0              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKBVCPL0'MDACP
     C                     MOVEL'@BVCPF0' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@BVCPF0                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * DLT TEST DATA 01       RT - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEHMNB    WQSE01           BOH Company Num
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           BOH Company Num
      * Setup key
     C                     Z-ADD360       WQSE01           BOH Company Num
      * Establish starting position
     C           KRSSE     SETLL@DYCPXX                    *
     C           KRSSE     READE@DYCPXX                  90*
      * Data record not found
     C   90                MOVEL'PRK0733' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Tattoo Detail Ext  DO - Tattoo Detail Ext  * 
     C                     EXSR SFDLRC
     C           KRSSE     READE@DYCPXX                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * Dlt Tattoo Detail Ext  DO - Tattoo Detail Ext  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DYCPXW
     C                     Z-ADDWEHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWEBNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWEBONB    WFBONB           BOL Load Number
     C                     Z-ADDWECVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWEB0DT    WFB0DT           TH Kill Date
     C                     Z-ADDWEC2NB    WFC2NB           TD Sequence Num
      *
     C           KLDLSF    KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFC2NB           TD Sequence Num
     C           KLDLSF    CHAIN@DYCPXW              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDYCPL0'MDACP
     C                     MOVEL'@DYCPXW' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DYCPXW                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/09/2020 - Recompiled due to change in Buy Order Num
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHKST           EA Company Numb
     C                     Z-ADD*ZERO     WAB7DT           EA Kill Date
     C                     Z-ADD*ZERO     WAKINB           EA Scale Sequen
     C                     Z-ADD*ZERO     WAKHNB           EA Tattoo Numbe
     C                     Z-ADD*ZERO     WALNNB           EA Lot
     C                     Z-ADD*ZERO     WAKJNB           EA Hot Weight
     C                     Z-ADD*ZERO     WAKKNB           EA Backfat Thic
     C                     Z-ADD*ZERO     WABQPC           EA Loin-Eye Dep
     C                     Z-ADD*ZERO     WABRPC           EA Light Reflec
     C                     Z-ADD*ZERO     WAX6NB           EA Backfat MM
     C                     Z-ADD*ZERO     WAFQPC           EA LoinEye MM
     C                     Z-ADD*ZERO     WAFRPC           EA Light Refl M
     C                     Z-ADD*ZERO     WAB8DT           RU Date
     C                     Z-ADD*ZERO     WAAOTM           RU Time
      * Define work field EA Record Processed
     C                     MOVEL*BLANK    WUHUST  1
      * Define work field EA Tattoo Number
     C                     Z-ADD*ZERO     WUKHNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCHSNB           ET Company Numb
     C                     Z-ADD*ZERO     WCA9DT           ET Kill Date
     C                     Z-ADD*ZERO     WCFJNB           ET Scale Sequen
     C                     Z-ADD*ZERO     WCHCNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCGDNB           ET Carcass Numb
     C                     Z-ADD*ZERO     WCFINB           ET Tattoo Numbe
     C                     Z-ADD*ZERO     WCLKNB           ET Lot
     C                     Z-ADD*ZERO     WCAMPC           ET Hot Wgt
     C                     Z-ADD*ZERO     WCAIPC           ET Backfat Thic
     C                     Z-ADD*ZERO     WCAJPC           ET Loin-Eye Dep
     C                     Z-ADD*ZERO     WCAKPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCX8NB           ET Backfat Thic
     C                     Z-ADD*ZERO     WCFVPC           ET Loineye Dept
     C                     Z-ADD*ZERO     WCFWPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCFXPC           ET Lean Percent
     C                     Z-ADD*ZERO     WCALPC           ET Light Reflec
     C                     Z-ADD*ZERO     WCHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WCBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WCBONB           BOL Load Number
     C                     Z-ADD*ZERO     WCCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WCB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
     C                     Z-ADD*ZERO     WCB8DT           RU Date
     C                     Z-ADD*ZERO     WCAOTM           RU Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEC2NB           TD Sequence Num
     C                     Z-ADD*ZERO     WELENB           Hot Head
     C                     Z-ADD*ZERO     WELFNB           TDE Head Condem
     C                     Z-ADD*ZERO     WELINB           Head 2
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
