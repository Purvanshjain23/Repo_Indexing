/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  POKAUPR                                       */
/*  PROGRAM NAME:    EXECUTE SNDUSRMSG-(C,G) OPTIONAL              */
/*  PROGRAMMER:      LARA BUSER                                    */
/*  CREATE DATE:     04/24/2009                                    */
/*                                                                 */
/*  FUNCTION:        SENDS THE PASSED IN MESSAGE TO THE            */
/*                   OPERATOR.                                     */
/*                   IF IT IS A *INQ MSG THEN A REPLY IS REQUIRED  */
/*                   IF IT IS A *INFO MSG THEN NO REPLY            */
/*                      IS REQUIRED                                */
/*                                                                 */
/*  NOTE    :        THIS IS CALLED FROM PMOQXFR WHICH IS CALLED   */
/*                   FROM THE JOB SCHEDULER. IF THIS PROGRAM IS    */
/*                   CHANGED, MAKE THE CORRESPONDING CHANGE TO     */
/*                   THAT PROGRAM AS WELL.                         */
/*-----------------------------------------------------------------*/
/* MAINTENANCE LOG:                                                */
/*******************************************************************/
             PGM        PARM(&RTNCDE &MESSAGE &MSGTYPE)

             DCL        VAR(&MESSAGE) TYPE(*CHAR) LEN(100)
             DCL        VAR(&MSGTYPE) TYPE(*CHAR) LEN(5)
             DCL        VAR(&RTNCDE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&REPLY) TYPE(*CHAR) LEN(1)

/*-----------------------------------------------------------------*/
/* INITIALIZE RETURN CODE TO BLANKS                                */
/*-----------------------------------------------------------------*/
/* IF MESSAGE TYPE = *INQ, THEN RECEIVE A REPLY:                   */
/* SEND THE MESSAGE TO THE OPERATOR. IF "C" IS RECEIVED, RETURN    */
/* "CANCELED" TO THE CALLING PROGRAM IN THE RETURN CODE            */
/*-----------------------------------------------------------------*/
             CHGVAR     VAR(&RTNCDE) VALUE('       ')
             IF         COND(&MSGTYPE *EQ '*INQ ') THEN(DO)
             SNDUSRMSG  MSGID(CPF9898) MSGF(QCPFMSG) +
                          MSGDTA(&MESSAGE) VALUES(C G) +
                          MSGTYPE(*INQ) MSGRPY(&REPLY)
             IF         COND(&REPLY *EQ 'C') THEN(CHGVAR +
                          VAR(&RTNCDE) VALUE('CANCELD')) /* ERROR */
             GOTO       CMDLBL(END)
             ENDDO

/*-----------------------------------------------------------------*/
/* IF MESSAGE TYPE = *INFO THEN NO REPLY IS REQUIRED, JUST         */
/* SEND THE MESSAGE TO THE OPERATOR.                               */
/*-----------------------------------------------------------------*/
             IF         COND(&MSGTYPE *EQ '*INFO') THEN(DO)
             SNDUSRMSG  MSGID(CPF9898) MSGF(QCPFMSG) +
                          MSGDTA(&MESSAGE) MSGTYPE(*INFO)
             GOTO       CMDLBL(END)
             ENDDO

 END:        ENDPGM
