     H/TITLE Cnv Upd Hex 41 to BlankXF Execute external functio
     H DATFMT(*YMD) DATEDIT(*YMD) DEBUG(*YES)
     Z* CRTBNDRPG
     Z* DFTACTGRP(*NO) BNDDIR(YBNDDIR) DBGVIEW(*SOURCE)
     Z* CVTOPT(*DATETIME) ACTGRP(*CALLER) OPTIMIZE(*BASIC)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
     H* Object type   : *PGM
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 06/06/23  Time  : 17:32:01
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOPBFCPL6  IF   E           K DISK
      * RSQ : Order Header TRG          Load Exports
      *
     FPDMRREL1  IF   E           K DISK
      * RTV : Export Doc Order Hdr      Retrieval index
      *
     FPDMRREL0  UF   E           K DISK
      * UPD : Export Doc Order Hdr      Update index
      *
      * Long constants
     D @CN#            S              6    DIM(02)CTDATA PERRCD(1)
     D @CN             S             25    DIM(02) ALT(@CN#)
      /EJECT
      * Data structures:
     D PGMDS         ESDS                  EXTNAME(Y2PGDSP)
      * Modified Program data structure
     D JBDTTM          DS
      * Job date/time
     D  ##JDT                  1      7  0
     D  ##JCC                  1      1  0
     D  ##JYY                  2      3  0
     D  ##JMM                  4      5  0
     D  ##JDD                  6      7  0
     D  ##JTM                  8     13  0
     D  ##JHH                  8      9  0
     D  ##JNN                 10     11  0
     D  ##JSS                 12     13  0
     D QPDMR1        E DS                  EXTNAME(PDMRREL0)
      * UPD : Export Doc Order Hdr      Update index
      * Renamed input format fields
     D  WCAIC3       E                     EXTFLD(MRAIC3)
     D  WCC4NB       E                     EXTFLD(MRC4NB)
     D  WCDGSX       E                     EXTFLD(MRDGSX)
     D  WCKXCD       E                     EXTFLD(MRKXCD)
     D  WCZMCD       E                     EXTFLD(MRZMCD)
     D  WCPSTX       E                     EXTFLD(MRPSTX)
     D  WCPUTX       E                     EXTFLD(MRPUTX)
     D  WCPVTX       E                     EXTFLD(MRPVTX)
     D  WCPWTX       E                     EXTFLD(MRPWTX)
     D  WCRVTX       E                     EXTFLD(MRRVTX)
     D  WCPPU1       E                     EXTFLD(MRPPU1)
     D  WCZ7AA       E                     EXTFLD(MRZ7AA)
     D  WCPDU1       E                     EXTFLD(MRPDU1)
     D  WCZ8AA       E                     EXTFLD(MRZ8AA)
     D  WCRHTX       E                     EXTFLD(MRRHTX)
     D  WCRITX       E                     EXTFLD(MRRITX)
     D  WCRJTX       E                     EXTFLD(MRRJTX)
     D  WCSCTX       E                     EXTFLD(MRSCTX)
     D  WCSDTX       E                     EXTFLD(MRSDTX)
     D  WCAAAB       E                     EXTFLD(MRAAAB)
     D  WCPHU1       E                     EXTFLD(MRPHU1)
     D  WCABAB       E                     EXTFLD(MRABAB)
     D  WCPXTX       E                     EXTFLD(MRPXTX)
     D  WCZOCD       E                     EXTFLD(MRZOCD)
     D  WCZNCD       E                     EXTFLD(MRZNCD)
     D  WCCSSX       E                     EXTFLD(MRCSSX)
     D  WCCTSX       E                     EXTFLD(MRCTSX)
     D  WCCUSX       E                     EXTFLD(MRCUSX)
     D  WCCVSX       E                     EXTFLD(MRCVSX)
     D  WCPTTX       E                     EXTFLD(MRPTTX)
     D  WCORNA       E                     EXTFLD(MRORNA)
     D  WCRKTX       E                     EXTFLD(MRRKTX)
     D  WCPZTX       E                     EXTFLD(MRPZTX)
     D  WCRLTX       E                     EXTFLD(MRRLTX)
     D  WCP0TX       E                     EXTFLD(MRP0TX)
     D  WCP1TX       E                     EXTFLD(MRP1TX)
     D  WCP2TX       E                     EXTFLD(MRP2TX)
     D  WCP3TX       E                     EXTFLD(MRP3TX)
     D  WCP4TX       E                     EXTFLD(MRP4TX)
     D  WCP5TX       E                     EXTFLD(MRP5TX)
     D  WCP6TX       E                     EXTFLD(MRP6TX)
     D  WCYHTX       E                     EXTFLD(MRYHTX)
     D  WCYITX       E                     EXTFLD(MRYITX)
     D  WCCWSX       E                     EXTFLD(MRCWSX)
     D  WCOUNA       E                     EXTFLD(MROUNA)
     D  WCP7TX       E                     EXTFLD(MRP7TX)
     D  WCP9TX       E                     EXTFLD(MRP9TX)
     D  WCOVNA       E                     EXTFLD(MROVNA)
     D  WCQATX       E                     EXTFLD(MRQATX)
     D  WCQBTX       E                     EXTFLD(MRQBTX)
     D  WCQCTX       E                     EXTFLD(MRQCTX)
     D  WCOWNA       E                     EXTFLD(MROWNA)
     D  WCOXNA       E                     EXTFLD(MROXNA)
     D  WCABNX       E                     EXTFLD(MRABNX)
     D  WCACNX       E                     EXTFLD(MRACNX)
     D  WCADNX       E                     EXTFLD(MRADNX)
     D  WCQDTX       E                     EXTFLD(MRQDTX)
     D  WCQETX       E                     EXTFLD(MRQETX)
     D  WCOYNA       E                     EXTFLD(MROYNA)
     D  WCOZNA       E                     EXTFLD(MROZNA)
     D  WCO0NA       E                     EXTFLD(MRO0NA)
     D  WCO1NA       E                     EXTFLD(MRO1NA)
     D  WCCXSX       E                     EXTFLD(MRCXSX)
     D  WCCYSX       E                     EXTFLD(MRCYSX)
     D  WCAGNX       E                     EXTFLD(MRAGNX)
     D  WCCZSX       E                     EXTFLD(MRCZSX)
     D  WCC0SX       E                     EXTFLD(MRC0SX)
     D  WCC1SX       E                     EXTFLD(MRC1SX)
     D  WCQFTX       E                     EXTFLD(MRQFTX)
     D  WCAHNX       E                     EXTFLD(MRAHNX)
     D  WCQGTX       E                     EXTFLD(MRQGTX)
     D  WCQHTX       E                     EXTFLD(MRQHTX)
     D  WCQITX       E                     EXTFLD(MRQITX)
     D  WCQJTX       E                     EXTFLD(MRQJTX)
     D  WCQKTX       E                     EXTFLD(MRQKTX)
     D  WCQMTX       E                     EXTFLD(MRQMTX)
     D  WCQNTX       E                     EXTFLD(MRQNTX)
     D  WCQOTX       E                     EXTFLD(MRQOTX)
     D  WCQPTX       E                     EXTFLD(MRQPTX)
     D  WCQQTX       E                     EXTFLD(MRQQTX)
     D  WCQRTX       E                     EXTFLD(MRQRTX)
     D  WCQSTX       E                     EXTFLD(MRQSTX)
     D  WCQTTX       E                     EXTFLD(MRQTTX)
     D  WCQUTX       E                     EXTFLD(MRQUTX)
     D  WCQVTX       E                     EXTFLD(MRQVTX)
     D  WCQYTX       E                     EXTFLD(MRQYTX)
     D  WCQWTX       E                     EXTFLD(MRQWTX)
     D  WCQZTX       E                     EXTFLD(MRQZTX)
     D  WCAINX       E                     EXTFLD(MRAINX)
     D  WCQ1TX       E                     EXTFLD(MRQ1TX)
     D  WCQ2TX       E                     EXTFLD(MRQ2TX)
     D  WCQ3TX       E                     EXTFLD(MRQ3TX)
     D  WCQ4TX       E                     EXTFLD(MRQ4TX)
     D  WCQ5TX       E                     EXTFLD(MRQ5TX)
     D  WCQ6TX       E                     EXTFLD(MRQ6TX)
     D  WCQ7TX       E                     EXTFLD(MRQ7TX)
     D  WCQ8TX       E                     EXTFLD(MRQ8TX)
     D  WCQ9TX       E                     EXTFLD(MRQ9TX)
     D  WCSMTX       E                     EXTFLD(MRSMTX)
     D  WCZQCD       E                     EXTFLD(MRZQCD)
     D  WCZRCD       E                     EXTFLD(MRZRCD)
     D  WCA7VL       E                     EXTFLD(MRA7VL)
     D  WCA8VL       E                     EXTFLD(MRA8VL)
     D  WCC2SX       E                     EXTFLD(MRC2SX)
     D  WCC8SX       E                     EXTFLD(MRC8SX)
     D  WCHRWG       E                     EXTFLD(MRHRWG)
     D  WCBIVL       E                     EXTFLD(MRBIVL)
     D  WCK2QT       E                     EXTFLD(MRK2QT)
     D  WCO5NA       E                     EXTFLD(MRO5NA)
     D  WCHSWG       E                     EXTFLD(MRHSWG)
     D  WCBJVL       E                     EXTFLD(MRBJVL)
     D  WCRATX       E                     EXTFLD(MRRATX)
     D  WCRBTX       E                     EXTFLD(MRRBTX)
     D  WCRCTX       E                     EXTFLD(MRRCTX)
     D  WCRDTX       E                     EXTFLD(MRRDTX)
     D  WCRETX       E                     EXTFLD(MRRETX)
     D  WCC3SX       E                     EXTFLD(MRC3SX)
     D  WCC4SX       E                     EXTFLD(MRC4SX)
     D  WCC5SX       E                     EXTFLD(MRC5SX)
     D  WCC6SX       E                     EXTFLD(MRC6SX)
     D  WCC7SX       E                     EXTFLD(MRC7SX)
     D  WCMQDT       E                     EXTFLD(MRMQDT)
     D  WCMRDT       E                     EXTFLD(MRMRDT)
     D  WCMSDT       E                     EXTFLD(MRMSDT)
     D  WCAJNX       E                     EXTFLD(MRAJNX)
     D  WCYFTX       E                     EXTFLD(MRYFTX)
     D  WCX9TX       E                     EXTFLD(MRX9TX)
     D  WCYATX       E                     EXTFLD(MRYATX)
     D  WCYBTX       E                     EXTFLD(MRYBTX)
     D  WCB5AA       E                     EXTFLD(MRB5AA)
     D  WCYCTX       E                     EXTFLD(MRYCTX)
     D  WCYDTX       E                     EXTFLD(MRYDTX)
     D  WCYETX       E                     EXTFLD(MRYETX)
     D  WCB6AA       E                     EXTFLD(MRB6AA)
     D  WCPADT       E                     EXTFLD(MRPADT)
     D  WCPBDT       E                     EXTFLD(MRPBDT)
     D  WCPCDT       E                     EXTFLD(MRPCDT)
     D  WCPDDT       E                     EXTFLD(MRPDDT)
     D  WCPEDT       E                     EXTFLD(MRPEDT)
     D  WCO4SX       E                     EXTFLD(MRO4SX)
     D  WCO5SX       E                     EXTFLD(MRO5SX)
     D  WCC1T1       E                     EXTFLD(MRC1T1)
     D  WCC2T1       E                     EXTFLD(MRC2T1)
     D  WCLKSC       E                     EXTFLD(MRLKSC)
     D  WCLLSC       E                     EXTFLD(MRLLSC)
     D  WCPIU1       E                     EXTFLD(MRPIU1)
     D  WCPJU1       E                     EXTFLD(MRPJU1)
     D  WCFFNZ       E                     EXTFLD(MRFFNZ)
     D  WCBUDX       E                     EXTFLD(MRBUDX)
     D  WCUVST       E                     EXTFLD(MRUVST)
     D  WCUWST       E                     EXTFLD(MRUWST)
     D  WCUXST       E                     EXTFLD(MRUXST)
     D  WCVSST       E                     EXTFLD(MRVSST)
     D  WCAATM       E                     EXTFLD(MRAATM)
     D  WCAYNA       E                     EXTFLD(MRAYNA)
     D  WCA0NA       E                     EXTFLD(MRA0NA)
     D  WCAXDT       E                     EXTFLD(MRAXDT)
      *
     D YARDCS          DS          3848
      * Message data for message Y2U0009.
     D MD0009          DS
     D  MDPGM                  1     10
     D  MDACP                 11     20
     D  MDFMT                 21     30
     D  MDACT                 31     34
     D  MDLBL                 35     40
      *
      * Declared stand-alone variables
     D  P0RTN          S              7
     D  W0ICL          S              1
     D  W0RTN          S              7
     D  W0RSL          S              1
     D  W0RSF          S              1
     D  W0RTW          S              9  0
     D  W0ENV          S              3
     D  ##TME          S              6  0
     D  YL0001         S             18
     D  ZQ             S              5  0
     D  WQSB01         S                   LIKE(WBAIC3)
     D  WQSB02         S                   LIKE(WBC4NB)
     D  WQSB03         S                   LIKE(WBDGSX)
     D  YL0002         S             18
     D  YL0003         S             63
     D  YL0004         S             63
     D  WN0001         S             15
     D  WN0002         S             20
     D  WN0003         S             63
     D  WN0004         S             63
     D  WN0005         S             63
     D  WN0006         S             63
     D  WN0007         S             63
     D  WN0008         S              2
     D  WN0009         S             20
     D  WN0010         S              6
     D  WN0011         S             63
     D  WN0012         S             63
     D  WN0013         S             63
     D  WN0014         S              2
     D  WN0015         S             20
     D  WN0016         S              6
     D  WN0017         S             30
     D  WN0018         S              2
     D  WN0019         S             10
     D  WN0020         S              1
     D  WN0021         S              1
     D  WN0022         S              1
     D  WN0023         S              1
     D  WN0024         S             10
     D  WN0025         S             15
     D  WN0026         S             70
     D  WN0027         S             70
     D  WN0028         S             70
     D  WN0029         S             70
     D  WN0030         S             70
     D  WN0031         S             70
     D  WN0032         S             70
     D  WN0033         S             70
     D  WN0034         S             70
     D  WN0035         S             70
     D  WN0036         S             70
     D  WN0037         S             70
     D  WN0038         S              1
     D  WN0039         S             40
     D  WN0040         S             10
     D  WN0041         S             18
     D  WN0042         S             15
     D  WN0043         S             10
     D  WN0044         S             10
     D  WN0045         S             30
     D  WN0046         S             30
     D  WN0047         S             30
     D  WN0048         S             10  0
     D  WN0049         S             10  0
     D  WN0050         S             10  0
     D  WN0051         S              3
     D  WN0052         S              8
     D  WN0053         S             30
     D  WN0054         S             30
     D  WN0055         S             30
     D  WN0056         S             30
     D  WN0057         S              1
     D  WN0058         S              1
     D  WN0059         S             20
     D  WN0060         S              1
     D  WN0061         S              1
     D  WN0062         S              1
     D  WN0063         S             30
     D  WN0064         S             10  0
     D  WN0065         S             10
     D  WN0066         S             50
     D  WN0067         S             25
     D  WN0068         S             40
     D  WN0069         S             40
     D  WN0070         S             40
     D  WN0071         S             40
     D  WN0072         S             40
     D  WN0073         S             40
     D  WN0074         S             40
     D  WN0075         S             40
     D  WN0076         S             40
     D  WN0077         S             40
     D  WN0078         S             40
     D  WN0079         S             40
     D  WN0080         S             20
     D  WN0081         S             10
     D  WN0082         S             20
     D  WN0083         S              2  0
     D  WN0084         S             30
     D  WN0085         S             30
     D  WN0086         S             30
     D  WN0087         S             30
     D  WN0088         S             30
     D  WN0089         S             30
     D  WN0090         S             63
     D  WN0091         S             63
     D  WN0092         S             63
     D  WN0093         S             63
     D  WN0094         S              5
     D  WN0095         S              5
     D  WN0096         S              6  2
     D  WN0097         S              9  2
     D  WN0098         S              1
     D  WN0099         S              1
     D  WN0100         S              9  1
     D  WN0101         S              7  4
     D  WN0102         S              5  0
     D  WN0103         S             15
     D  WN0104         S              9  1
     D  WN0105         S              7  4
     D  WN0106         S             10
     D  WN0107         S             25
     D  WN0108         S             25
     D  WN0109         S             30
     D  WN0110         S             70
     D  WN0111         S              1
     D  WN0112         S              1
     D  WN0113         S              1
     D  WN0114         S              2
     D  WN0115         S              2
     D  WN0116         S              7  0
     D  WN0117         S              7  0
     D  WN0118         S              7  0
     D  WN0119         S              9  2
     D  WN0120         S             65
     D  WN0121         S             40
     D  WN0122         S             40
     D  WN0123         S             40
     D  WN0124         S             10
     D  WN0125         S             40
     D  WN0126         S             40
     D  WN0127         S             40
     D  WN0128         S             10
     D  WN0129         S              7  0
     D  WN0130         S              7  0
     D  WN0131         S              7  0
     D  WN0132         S              7  0
     D  WN0133         S              7  0
     D  WN0134         S              1
     D  WN0135         S              2
     D  WN0136         S             25
     D  WN0137         S             25
     D  WN0138         S              1
     D  WN0139         S              3
     D  WN0140         S             25
     D  WN0141         S             40
     D  WN0142         S              9  0
     D  WN0143         S              8  0
     D  WN0144         S              1
     D  WN0145         S              1
     D  WN0146         S              1
     D  WN0147         S              1
     D  WN0148         S              6  0
     D  WN0149         S             10
     D  WN0150         S             10
     D  WN0151         S              7  0
     D  YARDC          S              1
     D  ZAPGMQ         S             10
     D  ZAPGRL         S              5
     D  ZAMSID         S              7
     D  ZAMSGF         S             10
     D  ZAMSTP         S              7
     D  YILE           S              1
     D  YRSW00         S              5  0
     D  YRSW01         S              5  0
     D  W0PMT          S              1
     D wkrhtx          s             63A                                        Consignee Name
     D wkritx          s             63A                                        Consignee Addr 1
     D                 DS
     D  ZAMSDA                 1    132
     I@BFCPMC
      * Order Header TRG          Load Exports
      * Renamed input format fields
     I              BEAIC3                      WAAIC3
     I              BEC4NB                      WAC4NB
     I              BEJNCD                      WAJNCD
     I              BEANC7                      WAANC7
     I              BEBKC7                      WABKC7
     I              BEBRTX                      WABRTX
     I              BEHMNA                      WAHMNA
     I              BEHONA                      WAHONA
     I              BEHPNA                      WAHPNA
     I              BEHNNA                      WAHNNA
     I              BEDBCD                      WADBCD
     I              BECKTX                      WACKTX
     I              BEB0C7                      WAB0C7
     I              BEAETX                      WAAETX
     I              BEB1NA                      WAB1NA
     I              BEB3NA                      WAB3NA
     I              BEB4NA                      WAB4NA
     I              BEB2NA                      WAB2NA
     I              BEBHCD                      WABHCD
     I              BEC8TX                      WAC8TX
     I              BEBCNA                      WABCNA
     I              BEA0DT                      WAA0DT
     I              BEA5DT                      WAA5DT
     I              BEGNDT                      WAGNDT
     I              BEACDT                      WAACDT
     I              BEAQCD                      WAAQCD
     I              BEB6NA                      WAB6NA
     I              BEBYNA                      WABYNA
     I              BEBZNA                      WABZNA
     I              BEGTST                      WAGTST
     I              BEGVST                      WAGVST
     I              BEGUST                      WAGUST
     I              BEQFST                      WAQFST
     I              BECQCD                      WACQCD
     I              BEGJST                      WAGJST
     I              BEGWST                      WAGWST
     I              BEGXST                      WAGXST
     I              BEGYST                      WAGYST
     I              BEAODT                      WAAODT
     I              BEAIVN                      WAAIVN
     I              BECXDT                      WACXDT
     I              BEJZVA                      WAJZVA
     I              BEA1WG                      WAA1WG
     I              BEXIST                      WAXIST
     I              BEXJST                      WAXJST
     I              BEXKST                      WAXKST
     I              BEEIDT                      WAEIDT
     I              BEAFTM                      WAAFTM
     I              BEE8CD                      WAE8CD
     I              BEE9CD                      WAE9CD
     I              BERMNB                      WARMNB
     I              BETBNB                      WATBNB
     I              BER1NB                      WAR1NB
     I              BEPJST                      WAPJST
     I              BEU0ST                      WAU0ST
     I              BEU1ST                      WAU1ST
     I              BEQ2CD                      WAQ2CD
     I              BEU2ST                      WAU2ST
     I              BEVEST                      WAVEST
     I              BEVFST                      WAVFST
     I              BEVGST                      WAVGST
     I              BERPCD                      WARPCD
     I              BERNNB                      WARNNB
     I              BEVDST                      WAVDST
     I              BEATIN                      WAATIN
     I              BEU4ST                      WAU4ST
     I              BEU5ST                      WAU5ST
     I              BERSRN                      WARSRN
     I              BEMHNA                      WAMHNA
     I              BEMINA                      WAMINA
     I              BEWBST                      WAWBST
     I              BER4CD                      WAR4CD
     I              BEBFCD                      WABFCD
     I              BEQ4CD                      WAQ4CD
     I              BET3NB                      WAT3NB
     I              BESICD                      WASICD
     I              BECONB                      WACONB
     I              BECEST                      WACEST
     I              BEAWDT                      WAAWDT
     I              BEJPCD                      WAJPCD
     I              BEXUST                      WAXUST
     I              BEZ1ST                      WAZ1ST
     I              BEVRVA                      WAVRVA
     I              BEOBST                      WAOBST
     I              BEBCST                      WABCST
     I              BEBDST                      WABDST
     I              BEB7VL                      WAB7VL
     I              BEGASX                      WAGASX
     I              BEGBSX                      WAGBSX
     I              BEGCSX                      WAGCSX
     I              BEGDSX                      WAGDSX
     I              BEFNSX                      WAFNSX
     I              BEFOSX                      WAFOSX
     I              BEFPSX                      WAFPSX
     I              BEFQSX                      WAFQSX
     I              BEFRSX                      WAFRSX
     I              BEFSSX                      WAFSSX
     I              BEFTSX                      WAFTSX
     I              BEFUSX                      WAFUSX
     I              BEFVSX                      WAFVSX
     I              BEFWSX                      WAFWSX
     I              BEFXSX                      WAFXSX
     I              BEFYSX                      WAFYSX
     I              BENODT                      WANODT
     I              BENPDT                      WANPDT
     I              BENQDT                      WANQDT
     I              BENRDT                      WANRDT
     I              BENSDT                      WANSDT
     I              BEBPTM                      WABPTM
     I              BEBQTM                      WABQTM
     I              BEBRTM                      WABRTM
     I              BEBSTM                      WABSTM
     I              BEBTTM                      WABTTM
     I              BEH0NX                      WAH0NX
     I              BEH1NX                      WAH1NX
     I              BEH2NX                      WAH2NX
     I              BEH3NX                      WAH3NX
     I              BEH4NX                      WAH4NX
     I              BEC0C7                      WAC0C7
     I              BEUVST                      WAUVST
     I              BEUWST                      WAUWST
     I              BEUXST                      WAUXST
     I              BEAATM                      WAAATM
     I              BEAYNA                      WAAYNA
     I              BEA0NA                      WAA0NA
     I              BEAXDT                      WAAXDT
      *
     I@MRREWT
      * Export Doc Order Hdr      Retrieval index
      * Renamed input format fields
     I              MRAIC3                      WBAIC3
     I              MRC4NB                      WBC4NB
     I              MRDGSX                      WBDGSX
     I              MRKXCD                      WBKXCD
     I              MRZMCD                      WBZMCD
     I              MRPSTX                      WBPSTX
     I              MRPUTX                      WBPUTX
     I              MRPVTX                      WBPVTX
     I              MRPWTX                      WBPWTX
     I              MRRVTX                      WBRVTX
     I              MRPPU1                      WBPPU1
     I              MRZ7AA                      WBZ7AA
     I              MRPDU1                      WBPDU1
     I              MRZ8AA                      WBZ8AA
     I              MRRHTX                      WBRHTX
     I              MRRITX                      WBRITX
     I              MRRJTX                      WBRJTX
     I              MRSCTX                      WBSCTX
     I              MRSDTX                      WBSDTX
     I              MRAAAB                      WBAAAB
     I              MRPHU1                      WBPHU1
     I              MRABAB                      WBABAB
     I              MRPXTX                      WBPXTX
     I              MRZOCD                      WBZOCD
     I              MRZNCD                      WBZNCD
     I              MRCSSX                      WBCSSX
     I              MRCTSX                      WBCTSX
     I              MRCUSX                      WBCUSX
     I              MRCVSX                      WBCVSX
     I              MRPTTX                      WBPTTX
     I              MRORNA                      WBORNA
     I              MRRKTX                      WBRKTX
     I              MRPZTX                      WBPZTX
     I              MRRLTX                      WBRLTX
     I              MRP0TX                      WBP0TX
     I              MRP1TX                      WBP1TX
     I              MRP2TX                      WBP2TX
     I              MRP3TX                      WBP3TX
     I              MRP4TX                      WBP4TX
     I              MRP5TX                      WBP5TX
     I              MRP6TX                      WBP6TX
     I              MRYHTX                      WBYHTX
     I              MRYITX                      WBYITX
     I              MRCWSX                      WBCWSX
     I              MROUNA                      WBOUNA
     I              MRP7TX                      WBP7TX
     I              MRP9TX                      WBP9TX
     I              MROVNA                      WBOVNA
     I              MRQATX                      WBQATX
     I              MRQBTX                      WBQBTX
     I              MRQCTX                      WBQCTX
     I              MROWNA                      WBOWNA
     I              MROXNA                      WBOXNA
     I              MRABNX                      WBABNX
     I              MRACNX                      WBACNX
     I              MRADNX                      WBADNX
     I              MRQDTX                      WBQDTX
     I              MRQETX                      WBQETX
     I              MROYNA                      WBOYNA
     I              MROZNA                      WBOZNA
     I              MRO0NA                      WBO0NA
     I              MRO1NA                      WBO1NA
     I              MRCXSX                      WBCXSX
     I              MRCYSX                      WBCYSX
     I              MRAGNX                      WBAGNX
     I              MRCZSX                      WBCZSX
     I              MRC0SX                      WBC0SX
     I              MRC1SX                      WBC1SX
     I              MRQFTX                      WBQFTX
     I              MRAHNX                      WBAHNX
     I              MRQGTX                      WBQGTX
     I              MRQHTX                      WBQHTX
     I              MRQITX                      WBQITX
     I              MRQJTX                      WBQJTX
     I              MRQKTX                      WBQKTX
     I              MRQMTX                      WBQMTX
     I              MRQNTX                      WBQNTX
     I              MRQOTX                      WBQOTX
     I              MRQPTX                      WBQPTX
     I              MRQQTX                      WBQQTX
     I              MRQRTX                      WBQRTX
     I              MRQSTX                      WBQSTX
     I              MRQTTX                      WBQTTX
     I              MRQUTX                      WBQUTX
     I              MRQVTX                      WBQVTX
     I              MRQYTX                      WBQYTX
     I              MRQWTX                      WBQWTX
     I              MRQZTX                      WBQZTX
     I              MRAINX                      WBAINX
     I              MRQ1TX                      WBQ1TX
     I              MRQ2TX                      WBQ2TX
     I              MRQ3TX                      WBQ3TX
     I              MRQ4TX                      WBQ4TX
     I              MRQ5TX                      WBQ5TX
     I              MRQ6TX                      WBQ6TX
     I              MRQ7TX                      WBQ7TX
     I              MRQ8TX                      WBQ8TX
     I              MRQ9TX                      WBQ9TX
     I              MRSMTX                      WBSMTX
     I              MRZQCD                      WBZQCD
     I              MRZRCD                      WBZRCD
     I              MRA7VL                      WBA7VL
     I              MRA8VL                      WBA8VL
     I              MRC2SX                      WBC2SX
     I              MRC8SX                      WBC8SX
     I              MRHRWG                      WBHRWG
     I              MRBIVL                      WBBIVL
     I              MRK2QT                      WBK2QT
     I              MRO5NA                      WBO5NA
     I              MRHSWG                      WBHSWG
     I              MRBJVL                      WBBJVL
     I              MRRATX                      WBRATX
     I              MRRBTX                      WBRBTX
     I              MRRCTX                      WBRCTX
     I              MRRDTX                      WBRDTX
     I              MRRETX                      WBRETX
     I              MRC3SX                      WBC3SX
     I              MRC4SX                      WBC4SX
     I              MRC5SX                      WBC5SX
     I              MRC6SX                      WBC6SX
     I              MRC7SX                      WBC7SX
     I              MRMQDT                      WBMQDT
     I              MRMRDT                      WBMRDT
     I              MRMSDT                      WBMSDT
     I              MRAJNX                      WBAJNX
     I              MRYFTX                      WBYFTX
     I              MRX9TX                      WBX9TX
     I              MRYATX                      WBYATX
     I              MRYBTX                      WBYBTX
     I              MRB5AA                      WBB5AA
     I              MRYCTX                      WBYCTX
     I              MRYDTX                      WBYDTX
     I              MRYETX                      WBYETX
     I              MRB6AA                      WBB6AA
     I              MRPADT                      WBPADT
     I              MRPBDT                      WBPBDT
     I              MRPCDT                      WBPCDT
     I              MRPDDT                      WBPDDT
     I              MRPEDT                      WBPEDT
     I              MRO4SX                      WBO4SX
     I              MRO5SX                      WBO5SX
     I              MRC1T1                      WBC1T1
     I              MRC2T1                      WBC2T1
     I              MRLKSC                      WBLKSC
     I              MRLLSC                      WBLLSC
     I              MRPIU1                      WBPIU1
     I              MRPJU1                      WBPJU1
     I              MRFFNZ                      WBFFNZ
     I              MRBUDX                      WBBUDX
     I              MRUVST                      WBUVST
     I              MRUWST                      WBUWST
     I              MRUXST                      WBUXST
     I              MRVSST                      WBVSST
     I              MRAATM                      WBAATM
     I              MRAYNA                      WBAYNA
     I              MRA0NA                      WBA0NA
     I              MRAXDT                      WBAXDT
      *
     I@MRREWS
      * Export Doc Order Hdr      Update index
      * Renamed input format fields
     I              MRAIC3                      WCAIC3
     I              MRC4NB                      WCC4NB
     I              MRDGSX                      WCDGSX
     I              MRKXCD                      WCKXCD
     I              MRZMCD                      WCZMCD
     I              MRPSTX                      WCPSTX
     I              MRPUTX                      WCPUTX
     I              MRPVTX                      WCPVTX
     I              MRPWTX                      WCPWTX
     I              MRRVTX                      WCRVTX
     I              MRPPU1                      WCPPU1
     I              MRZ7AA                      WCZ7AA
     I              MRPDU1                      WCPDU1
     I              MRZ8AA                      WCZ8AA
     I              MRRHTX                      WCRHTX
     I              MRRITX                      WCRITX
     I              MRRJTX                      WCRJTX
     I              MRSCTX                      WCSCTX
     I              MRSDTX                      WCSDTX
     I              MRAAAB                      WCAAAB
     I              MRPHU1                      WCPHU1
     I              MRABAB                      WCABAB
     I              MRPXTX                      WCPXTX
     I              MRZOCD                      WCZOCD
     I              MRZNCD                      WCZNCD
     I              MRCSSX                      WCCSSX
     I              MRCTSX                      WCCTSX
     I              MRCUSX                      WCCUSX
     I              MRCVSX                      WCCVSX
     I              MRPTTX                      WCPTTX
     I              MRORNA                      WCORNA
     I              MRRKTX                      WCRKTX
     I              MRPZTX                      WCPZTX
     I              MRRLTX                      WCRLTX
     I              MRP0TX                      WCP0TX
     I              MRP1TX                      WCP1TX
     I              MRP2TX                      WCP2TX
     I              MRP3TX                      WCP3TX
     I              MRP4TX                      WCP4TX
     I              MRP5TX                      WCP5TX
     I              MRP6TX                      WCP6TX
     I              MRYHTX                      WCYHTX
     I              MRYITX                      WCYITX
     I              MRCWSX                      WCCWSX
     I              MROUNA                      WCOUNA
     I              MRP7TX                      WCP7TX
     I              MRP9TX                      WCP9TX
     I              MROVNA                      WCOVNA
     I              MRQATX                      WCQATX
     I              MRQBTX                      WCQBTX
     I              MRQCTX                      WCQCTX
     I              MROWNA                      WCOWNA
     I              MROXNA                      WCOXNA
     I              MRABNX                      WCABNX
     I              MRACNX                      WCACNX
     I              MRADNX                      WCADNX
     I              MRQDTX                      WCQDTX
     I              MRQETX                      WCQETX
     I              MROYNA                      WCOYNA
     I              MROZNA                      WCOZNA
     I              MRO0NA                      WCO0NA
     I              MRO1NA                      WCO1NA
     I              MRCXSX                      WCCXSX
     I              MRCYSX                      WCCYSX
     I              MRAGNX                      WCAGNX
     I              MRCZSX                      WCCZSX
     I              MRC0SX                      WCC0SX
     I              MRC1SX                      WCC1SX
     I              MRQFTX                      WCQFTX
     I              MRAHNX                      WCAHNX
     I              MRQGTX                      WCQGTX
     I              MRQHTX                      WCQHTX
     I              MRQITX                      WCQITX
     I              MRQJTX                      WCQJTX
     I              MRQKTX                      WCQKTX
     I              MRQMTX                      WCQMTX
     I              MRQNTX                      WCQNTX
     I              MRQOTX                      WCQOTX
     I              MRQPTX                      WCQPTX
     I              MRQQTX                      WCQQTX
     I              MRQRTX                      WCQRTX
     I              MRQSTX                      WCQSTX
     I              MRQTTX                      WCQTTX
     I              MRQUTX                      WCQUTX
     I              MRQVTX                      WCQVTX
     I              MRQYTX                      WCQYTX
     I              MRQWTX                      WCQWTX
     I              MRQZTX                      WCQZTX
     I              MRAINX                      WCAINX
     I              MRQ1TX                      WCQ1TX
     I              MRQ2TX                      WCQ2TX
     I              MRQ3TX                      WCQ3TX
     I              MRQ4TX                      WCQ4TX
     I              MRQ5TX                      WCQ5TX
     I              MRQ6TX                      WCQ6TX
     I              MRQ7TX                      WCQ7TX
     I              MRQ8TX                      WCQ8TX
     I              MRQ9TX                      WCQ9TX
     I              MRSMTX                      WCSMTX
     I              MRZQCD                      WCZQCD
     I              MRZRCD                      WCZRCD
     I              MRA7VL                      WCA7VL
     I              MRA8VL                      WCA8VL
     I              MRC2SX                      WCC2SX
     I              MRC8SX                      WCC8SX
     I              MRHRWG                      WCHRWG
     I              MRBIVL                      WCBIVL
     I              MRK2QT                      WCK2QT
     I              MRO5NA                      WCO5NA
     I              MRHSWG                      WCHSWG
     I              MRBJVL                      WCBJVL
     I              MRRATX                      WCRATX
     I              MRRBTX                      WCRBTX
     I              MRRCTX                      WCRCTX
     I              MRRDTX                      WCRDTX
     I              MRRETX                      WCRETX
     I              MRC3SX                      WCC3SX
     I              MRC4SX                      WCC4SX
     I              MRC5SX                      WCC5SX
     I              MRC6SX                      WCC6SX
     I              MRC7SX                      WCC7SX
     I              MRMQDT                      WCMQDT
     I              MRMRDT                      WCMRDT
     I              MRMSDT                      WCMSDT
     I              MRAJNX                      WCAJNX
     I              MRYFTX                      WCYFTX
     I              MRX9TX                      WCX9TX
     I              MRYATX                      WCYATX
     I              MRYBTX                      WCYBTX
     I              MRB5AA                      WCB5AA
     I              MRYCTX                      WCYCTX
     I              MRYDTX                      WCYDTX
     I              MRYETX                      WCYETX
     I              MRB6AA                      WCB6AA
     I              MRPADT                      WCPADT
     I              MRPBDT                      WCPBDT
     I              MRPCDT                      WCPCDT
     I              MRPDDT                      WCPDDT
     I              MRPEDT                      WCPEDT
     I              MRO4SX                      WCO4SX
     I              MRO5SX                      WCO5SX
     I              MRC1T1                      WCC1T1
     I              MRC2T1                      WCC2T1
     I              MRLKSC                      WCLKSC
     I              MRLLSC                      WCLLSC
     I              MRPIU1                      WCPIU1
     I              MRPJU1                      WCPJU1
     I              MRFFNZ                      WCFFNZ
     I              MRBUDX                      WCBUDX
     I              MRUVST                      WCUVST
     I              MRUWST                      WCUWST
     I              MRUXST                      WCUXST
     I              MRVSST                      WCVSST
     I              MRAATM                      WCAATM
     I              MRAYNA                      WCAYNA
     I              MRA0NA                      WCA0NA
     I              MRAXDT                      WCAXDT
      *
      /EJECT
      *****************************************************************
      * Entry parameters
     C     *ENTRY        PLIST
     C                   PARM                    P0RTN
      *****************************************************************
      * Initialize
     C                   EXSR      ZZINIT
      *
      * Cnv Upd Hex 41 to BlankXF
      * Cnv Upd Hex 41 to BlankRT - Order Header TRG  * 
     C                   EXSR      SARVGN
      *----------------------------------------------------------------
      * Exit program
     C     AAEXIT        TAG
     C                   EVAL      P0RTN = ' '
     C                   EXSR      ZYEXPG
      *================================================================
      /EJECT
     CSR   SARVGN        BEGSR
      *================================================================
      * Cnv Upd Hex 41 to BlankRT - Order Header TRG  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Establish starting position
     C     *LOVAL        SETLL     @BFCPMC                                      *
     C                   READ      @BFCPMC                                90    *
      * Data record not found
     C   90              MOVEL     'USR0176'     W0RTN
      * USER: Process Data record
      * CASE: DB1.Header Status is Not cancelled
     C                   DOW       NOT *IN90
     C                   IF        WAGWST = 'L' OR
     C                             WAGWST = 'A' OR
     C                             WAGWST = 'C' OR
     C                             WAGWST = 'R' OR
     C                             WAGWST = 'E' OR
     C                             WAGWST = 'H' OR
     C                             WAGWST = 'I'
     C                   Z-ADD     18            YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00030 OR
     C                             ZQ > 00030
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WABRTX:ZQ     YL0001                 90      Text-18
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * CASE: LCL.Text-18               USR is Itochu Corporation
      * Cnv Upd Hex 41 to BlankRT - Export Doc Order Hdr  * 
     C                   IF        YL0001 = @CN(001)
     C                   EXSR      SBRVGN
     C                   END                                                    *FI
     C                   END                                                    *FI
     C                   READ      @BFCPMC                                90    *
     C                   ENDDO
      *================================================================
     CSR   SAEXIT        ENDSR
      /EJECT
     CSR   SBRVGN        BEGSR
      *================================================================
      * Cnv Upd Hex 41 to BlankRT - Export Doc Order Hdr  * 
      *================================================================
     C                   EVAL      W0RTN = ' '
      * Declare restrictor key work fields
      * Define keylist
     C     KRSSB         KLIST
     C                   KFLD                    WQSB01                         Company Number
     C                   KFLD                    WQSB02                         Order Number
     C                   KFLD                    WQSB03                         ED Export Docum
      * Setup key
     C                   Z-ADD     WAAIC3        WQSB01                         Company Number
     C                   Z-ADD     WAC4NB        WQSB02                         Order Number
     C                   MOVEL     'H'           WQSB03                         ED Export Docum
      * Establish starting position
     C     KRSSB         SETLL     @MRREWT                                      *
     C     KRSSB         READE     @MRREWT                                90    *
      * Data record not found
     C   90              MOVEL     'USR2743'     W0RTN
      * USER: Process Data record
      * CASE: DB1.ED Language Xlate Desc 2 is Chilled Pork
     C                   DOW       NOT *IN90
     C                   IF        WBRBTX = @CN(002)
     C                   Z-ADD     18            YRSW00
     C                   Z-ADD     1             ZQ
     C                   IF        YRSW00 < 1 OR
     C                             ZQ < 1 OR
     C                             YRSW00 > 00063 OR
     C                             ZQ > 00063
     C                   MOVEL     'Y2U0510'     W0RTN
     C                   ELSE
     C     YRSW00        SUBST(P)  WBRHTX:ZQ     YL0002                 90      Text-18
     C   90              MOVEL     'Y2U0510'     W0RTN
     C                   END
      * CASE: LCL.Text-18               USR is Itochu Corporation
     C                   IF        YL0002 = @CN(001)
     C                   MOVEL     WBRHTX        YL0003                         ED Consignee Na
     C                   MOVEL     WBRITX        YL0004                         ED Consignee Ad
      * Update Hex Value '41' to 'blank'.
      * Cnv Upd Hex 41 to BlankUS - Export Doc Order Hdr  * 
      * Cnv Upd Hex 41 to BlankUS
      *
      * Consignee Name.
     C                   move      YL0003        wkrhtx
     C                   if        wkrhtx <> *blank
     C     x'41':' '     xlate     wkrhtx        YL0003
     C                   endif
      * Consignee Addr 1.
     C                   move      YL0004        wkritx
     C                   if        wkritx <> *blank
     C     x'41':' '     xlate     wkritx        YL0004
     C                   endif
      *
      * Cnv Upd Hex 41 to BlankCH - Export Doc Order Hdr  * 
     C                   EXSR      SCCHRC
     C                   END                                                    *FI
     C                   END                                                    *FI
     C     KRSSB         READE     @MRREWT                                90    *
     C                   ENDDO
      *================================================================
     CSR   SBEXIT        ENDSR
      /EJECT
     CSR   SCCHRC        BEGSR
      *================================================================
      * Cnv Upd Hex 41 to BlankCH - Export Doc Order Hdr  * 
      *================================================================
      *
     C                   EVAL      WN0001 = ' '                                 ED Area Office
     C                   EVAL      WN0002 = ' '                                 ED Destination
     C                   EVAL      WN0003 = ' '                                 ED Consignor Na
     C                   EVAL      WN0004 = ' '                                 ED Consignor Ad
     C                   EVAL      WN0005 = ' '                                 ED Consignor Ad
     C                   EVAL      WN0006 = ' '                                 ED Consignor Ad
     C                   EVAL      WN0007 = ' '                                 ED Consignor Ad
     C                   EVAL      WN0008 = ' '                                 ED Consignor St
     C                   EVAL      WN0009 = ' '                                 ED Consignor Po
     C                   EVAL      WN0010 = ' '                                 ED Consignor Co
     C                   EVAL      WN0011 = ' '                                 ED Consignee Ad
     C                   EVAL      WN0012 = ' '                                 ED Consignee Ad
     C                   EVAL      WN0013 = ' '                                 ED Consignee Ad
     C                   EVAL      WN0014 = ' '                                 ED Consignee St
     C                   EVAL      WN0015 = ' '                                 ED Consignee Po
     C                   EVAL      WN0016 = ' '                                 ED Consignee Co
     C                   EVAL      WN0017 = ' '                                 ED Plant Locati
     C                   EVAL      WN0018 = ' '                                 ED Plant Locati
     C                   EVAL      WN0019 = ' '                                 ED Plant Number
     C                   EVAL      WN0020 = ' '                                 ED Processing P
     C                   EVAL      WN0021 = ' '                                 ED Attachment S
     C                   EVAL      WN0022 = ' '                                 ED Attachment T
     C                   EVAL      WN0023 = ' '                                 ED Xlate Desc t
     C                   EVAL      WN0024 = ' '                                 ED Unmarked Txt
     C                   EVAL      WN0025 = ' '                                 ED Shipping Mar
     C                   EVAL      WN0026 = ' '                                 ED Date of Slau
     C                   EVAL      WN0027 = ' '                                 ED Place of Sla
     C                   EVAL      WN0028 = ' '                                 ED Date of Proc
     C                   EVAL      WN0029 = ' '                                 ED Place of pro
     C                   EVAL      WN0030 = ' '                                 ED Continue Com
     C                   EVAL      WN0031 = ' '                                 ED Remark Const
     C                   EVAL      WN0032 = ' '                                 ED Remark Const
     C                   EVAL      WN0033 = ' '                                 ED Remark Const
     C                   EVAL      WN0034 = ' '                                 ED Remark Const
     C                   EVAL      WN0035 = ' '                                 ED Remark Const
     C                   EVAL      WN0036 = ' '                                 ED Remark Const
     C                   EVAL      WN0037 = ' '                                 ED Remark Const
     C                   EVAL      WN0038 = ' '                                 ED Certify that
     C                   EVAL      WN0039 = ' '                                 ED Inspector Na
     C                   EVAL      WN0040 = ' '                                 ED Origin Count
     C                   EVAL      WN0041 = ' '                                 ED Port of Load
     C                   EVAL      WN0042 = ' '                                 ED Transportion
     C                   EVAL      WN0043 = ' '                                 ED Seal Number
     C                   EVAL      WN0044 = ' '                                 ED Seal Number
     C                   EVAL      WN0045 = ' '                                 ED Can. Import
     C                   EVAL      WN0046 = ' '                                 ED Can. Import
     C                   EVAL      WN0047 = ' '                                 ED Can. Import
     C                   Z-ADD     *ZERO         WN0048                         ED Can. Import
     C                   Z-ADD     *ZERO         WN0049                         ED Can. Import
     C                   Z-ADD     *ZERO         WN0050                         ED Seaboard Pla
     C                   EVAL      WN0051 = ' '                                 ED USDA Cert Nb
     C                   EVAL      WN0052 = ' '                                 ED USDA Cert Nb
     C                   EVAL      WN0053 = ' '                                 ED Can. Port of
     C                   EVAL      WN0054 = ' '                                 ED Can. Reinsp
     C                   EVAL      WN0055 = ' '                                 ED Can. Reinsp
     C                   EVAL      WN0056 = ' '                                 ED Can. Reinsp
     C                   EVAL      WN0057 = ' '                                 ED Herm Sealed
     C                   EVAL      WN0058 = ' '                                 ED Herm Sealed
     C                   EVAL      WN0059 = ' '                                 ED Herm Sealed
     C                   EVAL      WN0060 = ' '                                 ED Whole Bird S
     C                   EVAL      WN0061 = ' '                                 ED Marked Sts
     C                   EVAL      WN0062 = ' '                                 ED Tamper Evide
     C                   EVAL      WN0063 = ' '                                 ED Plant Contac
     C                   Z-ADD     *ZERO         WN0064                         ED Plant Contac
     C                   EVAL      WN0065 = ' '                                 ED Modified Tex
     C                   EVAL      WN0066 = ' '                                 ED Issued Crt f
     C                   EVAL      WN0067 = ' '                                 ED Species
     C                   EVAL      WN0068 = ' '                                 ED Slaughter Pl
     C                   EVAL      WN0069 = ' '                                 ED Slaughter Pl
     C                   EVAL      WN0070 = ' '                                 ED Slaughter Pl
     C                   EVAL      WN0071 = ' '                                 ED Packaging Pl
     C                   EVAL      WN0072 = ' '                                 ED Packaging Pl
     C                   EVAL      WN0073 = ' '                                 ED Packaging Pl
     C                   EVAL      WN0074 = ' '                                 ED Manufact Pla
     C                   EVAL      WN0075 = ' '                                 ED Manufact Pla
     C                   EVAL      WN0076 = ' '                                 ED Manufact Pla
     C                   EVAL      WN0077 = ' '                                 ED USDA Name 1
     C                   EVAL      WN0078 = ' '                                 ED USDA Name 2
     C                   EVAL      WN0079 = ' '                                 ED USDA Name 3
     C                   EVAL      WN0080 = ' '                                 ED Title of Off
     C                   EVAL      WN0081 = ' '                                 ED Letter of Cr
     C                   EVAL      WN0082 = ' '                                 ED Unused prd m
     C                   Z-ADD     *ZERO         WN0083                         ED Nbr of prods
     C                   EVAL      WN0084 = ' '                                 ED Importer Nam
     C                   EVAL      WN0085 = ' '                                 ED Importer Add
     C                   EVAL      WN0086 = ' '                                 ED Importer Add
     C                   EVAL      WN0087 = ' '                                 ED Purchaser Na
     C                   EVAL      WN0088 = ' '                                 ED Purchaser Ad
     C                   EVAL      WN0089 = ' '                                 ED Purchaser Ad
     C                   EVAL      WN0090 = ' '                                 ED Place Drct S
     C                   EVAL      WN0091 = ' '                                 ED Place Drct S
     C                   EVAL      WN0092 = ' '                                 ED Place Drct S
     C                   EVAL      WN0093 = ' '                                 ED Place Drct S
     C                   EVAL      WN0094 = ' '                                 ED Currency
     C                   EVAL      WN0095 = ' '                                 ED Conditions o
     C                   Z-ADD     *ZERO         WN0096                         ED Total Unit P
     C                   Z-ADD     *ZERO         WN0097                         ED Invoice Tota
     C                   EVAL      WN0098 = ' '                                 ED Live with PH
     C                   EVAL      WN0099 = ' '                                 ED Print Status
     C                   Z-ADD     *ZERO         WN0100                         ED Total Net We
     C                   Z-ADD     *ZERO         WN0101                         ED Total Net We
     C                   Z-ADD     *ZERO         WN0102                         ED Nbr of Packa
     C                   EVAL      WN0103 = ' '                                 ED Customer PO
     C                   Z-ADD     *ZERO         WN0104                         ED Total Gross
     C                   Z-ADD     *ZERO         WN0105                         ED Total Gross
     C                   EVAL      WN0106 = ' '                                 ED Plant Number
     C                   EVAL      WN0107 = ' '                                 ED Language Xla
     C                   EVAL      WN0108 = ' '                                 ED Slaughter Da
     C                   EVAL      WN0109 = ' '                                 ED Production m
     C                   EVAL      WN0110 = ' '                                 ED Remark Const
     C                   EVAL      WN0111 = ' '                                 ED Allow Print
     C                   EVAL      WN0112 = ' '                                 ED Cert of Orig
     C                   EVAL      WN0113 = ' '                                 ED Use item lab
     C                   EVAL      WN0114 = ' '                                 ED Slg_Proc Dat
     C                   EVAL      WN0115 = ' '                                 ED Total Packag
     C                   Z-ADD     *ZERO         WN0116                         ED Export Certi
     C                   Z-ADD     *ZERO         WN0117                         ED Sail Date
     C                   Z-ADD     *ZERO         WN0118                         ED Sworn on Dat
     C                   Z-ADD     *ZERO         WN0119                         ED Consignee Ad
     C                   EVAL      WN0120 = ' '                                 ED Form Identif
     C                   EVAL      WN0121 = ' '                                 ED Cold Storage
     C                   EVAL      WN0122 = ' '                                 ED Cold Storage
     C                   EVAL      WN0123 = ' '                                 ED Cold Storage
     C                   EVAL      WN0124 = ' '                                 ED Cold Storage
     C                   EVAL      WN0125 = ' '                                 ED Slaughter Da
     C                   EVAL      WN0126 = ' '                                 ED Production m
     C                   EVAL      WN0127 = ' '                                 ED Production m
     C                   EVAL      WN0128 = ' '                                 ED Booking Nbr
     C                   Z-ADD     *ZERO         WN0129                         ED Document Dat
     C                   Z-ADD     *ZERO         WN0130                         ED Packing Date
     C                   Z-ADD     *ZERO         WN0131                         ED Expiration D
     C                   Z-ADD     *ZERO         WN0132                         ED Packing Date
     C                   Z-ADD     *ZERO         WN0133                         ED Unused Date
     C                   EVAL      WN0134 = ' '                                 ED Print Kilogr
     C                   EVAL      WN0135 = ' '                                 ED MPR Canadian
     C                   EVAL      WN0136 = ' '                                 ED Container Nb
     C                   EVAL      WN0137 = ' '                                 ED Slaughter Da
     C                   EVAL      WN0138 = ' '                                 ED Submit Statu
     C                   EVAL      WN0139 = ' '                                 EDOH Unused Sts
     C                   EVAL      WN0140 = ' '                                 EDOH Unused Tex
     C                   EVAL      WN0141 = ' '                                 EDOH Unused Tex
     C                   Z-ADD     *ZERO         WN0142                         EDOH Unused Num
     C                   Z-ADD     *ZERO         WN0143                         EDOH Unused Dat
     C                   EVAL      WN0144 = ' '                                 EDI Status 1
     C                   EVAL      WN0145 = ' '                                 EDI Status 2
     C                   EVAL      WN0146 = ' '                                 EDI Status 3
     C                   EVAL      WN0147 = ' '                                 Record Status
     C                   Z-ADD     *ZERO         WN0148                         Job Time
     C                   EVAL      WN0149 = ' '                                 User Id
     C                   EVAL      WN0150 = ' '                                 Job Name
     C                   Z-ADD     *ZERO         WN0151                         Job Date
      *
     C                   EVAL      W0RTN = ' '
      * Set PGM.*Record Data Changed flag
     C                   EVALR     YARDC = ' '
      *
      * Move key fields to @MRREWS
     C                   Z-ADD     WBAIC3        WCAIC3                         Company Number
     C                   Z-ADD     WBC4NB        WCC4NB                         Order Number
     C                   MOVEL(P)  WBDGSX        WCDGSX                         ED Export Docum
     C                   MOVEL(P)  WBKXCD        WCKXCD                         Country Code
      *
     C     KLCHSC        KLIST
     C                   KFLD                    WCAIC3                         Company Number
     C                   KFLD                    WCC4NB                         Order Number
     C                   KFLD                    WCDGSX                         ED Export Docum
     C                   KFLD                    WCKXCD                         Country Code
     C     KLCHSC        CHAIN     @MRREWS                            9091      *
      *
      * Record not found
     C                   IF        *IN90
     C                   MOVEL     'Y2U0009'     W0RTN
     C                   MOVEL     ##PGM         MDPGM
     C                   MOVEL     'PDMRREL0'    MDACP
     C                   MOVEL     '@MRREWS'     MDFMT
     C                   MOVEL     '*CHG'        MDACT
      * Record not found label: LBL001.
     C                   MOVEL     'LBL001'      MDLBL
      * Send message '*Record no longer on file'
     C                   MOVEL     'Y2U0009'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   MOVEL     MD0009        ZAMSDA                         Message data
     C                   EXSR      ZASNMS
     C                   EVAL      MD0009 = ' '
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Record locked
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
      * Send message '*Database operation error'
     C                   MOVEL     'Y2U0004'     ZAMSID
     C                   MOVEL     'Y2USRMSG'    ZAMSGF
     C                   EXSR      ZASNMS
     C                   GOTO      SCEXIT
     C                   ENDIF
      *
      * Store record data for null update check
     C                   MOVE      QPDMR1        YARDCS
      * Move non-key fields to @MRREWS
     C                   MOVEL(P)  YL0003        WCRHTX                         ED Consignee Na
     C                   MOVEL(P)  YL0004        WCRITX                         ED Consignee Ad
      *
      * Set PGM.*Record Data Changed flag
     C                   IF        QPDMR1 <> YARDCS AND
     C                             YARDC <> 'N'
     C                   MOVE      'Y'           YARDC
     C                   ENDIF
      * If changed update record otherwise release record
     C                   IF        YARDC = 'Y'
     C                   UPDATE    @MRREWS                              91      *
     C                   ELSE
      * Release record lock
     C                   UNLOCK    PDMRREL0                             91      *
     C                   ENDIF
      * Change error detected
     C                   IF        *IN91
     C                   MOVEL     'Y2U0004'     W0RTN
     C                   ELSE
      *
      * DBF change successful
     C                   ENDIF
      *================================================================
     CSR   SCEXIT        ENDSR
      /EJECT
     CSR   ZASNMS        BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C                   IF        ZAPGMQ = ' '
     C                   MOVEL     ##PGM         ZAPGMQ
     C                   END
     C                   CALL      'Y2SNMGC'
     C                   PARM                    ZAPGMQ                         Program queue
     C                   PARM                    ZAPGRL                         Rel queue
     C                   PARM                    ZAMSID                         Message ID
     C                   PARM                    ZAMSGF                         Message file
     C                   PARM                    ZAMSDA                         Message data
     C                   PARM                    ZAMSTP                         Message type
     C                   PARM      'Y'           YILE
      * Clear all fields for default mechanism next time
     C                   EVAL      ZAPGMQ = ' '
     C                   EVAL      ZAPGRL = ' '
     C                   EVAL      ZAMSID = ' '
     C                   EVAL      ZAMSGF = ' '
     C                   EVAL      ZAMSDA = ' '
     C                   EVAL      ZAMSTP = ' '
      *================================================================
     CSR   ZAEXIT        ENDSR
      /EJECT
     CSR   ZXEXPG        BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                   EXSR      ZYEXPG
      *================================================================
     CSR   ZXEXIT        ENDSR
      /EJECT
     CSR   ZYEXPG        BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                   SETON                                        LR
      *
      * Exit program
     C                   RETURN
      *
      *================================================================
     CSR   ZYEXIT        ENDSR
      /EJECT
     CSR   ZZINIT        BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C                   IF        W0ICL = ' '
     C                   MOVEL     'Y'           W0ICL                          *Initial call
     C                   ELSE
     C                   MOVEL     'N'           W0ICL
     C                   END
     C                   EVALR     P0RTN = ' '
     C                   EVALR     W0RTN = ' '
     C                   EVAL      W0RSL = ' '
     C                   EVAL      W0RSF = ' '
     C                   MOVEL     *ZEROS        W0RTW
     C                   MOVEL     '400'         W0ENV
      * Retrieve job attributes
     C                   CALL      'Y2RTJCR'
     C                   PARM                    PGMDS
      * Setup job date/time
     C                   Z-ADD     ##SD7         ##JDT
     C                   TIME                    ##JTM
      * Update screen time
     C                   TIME                    ##TME
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WAAIC3                         Company Number
     C                   Z-ADD     *ZERO         WAC4NB                         Order Number
     C                   Z-ADD     *ZERO         WAANC7                         AR Customer Num
     C                   Z-ADD     *ZERO         WABKC7                         Ship To Custome
     C                   Z-ADD     *ZERO         WAB0C7                         Bill to Custome
     C                   Z-ADD     *ZERO         WAA0DT                         Order Date
     C                   Z-ADD     *ZERO         WAA5DT                         Requested Ship
     C                   Z-ADD     *ZERO         WAGNDT                         Actual Shipped
     C                   Z-ADD     *ZERO         WAACDT                         Cancel Date
     C                   Z-ADD     *ZERO         WAAODT                         Scheduled Ship
     C                   Z-ADD     *ZERO         WACXDT                         Date of Origina
     C                   Z-ADD     *ZERO         WAJZVA                         Order Value Tot
     C                   Z-ADD     *ZERO         WAA1WG                         Order Weight To
     C                   Z-ADD     *ZERO         WAEIDT                         Requested Deliv
     C                   Z-ADD     *ZERO         WAAFTM                         Requested Deliv
     C                   Z-ADD     *ZERO         WARMNB                         Load ID
     C                   Z-ADD     *ZERO         WATBNB                         Absorbed Freigh
     C                   Z-ADD     *ZERO         WAR1NB                         Rated Freight
     C                   Z-ADD     *ZERO         WARNNB                         Reefer Temperat
     C                   Z-ADD     *ZERO         WAATIN                         Attach to Invoi
     C                   Z-ADD     *ZERO         WARSRN                         Resell Referenc
     C                   Z-ADD     *ZERO         WAT3NB                         Attach to Order
     C                   Z-ADD     *ZERO         WACONB                         Invoice Number
     C                   Z-ADD     *ZERO         WAAWDT                         Invoice Date
     C                   Z-ADD     *ZERO         WAVRVA                         A/R order Value
     C                   Z-ADD     *ZERO         WAB7VL                         Invoice Order V
     C                   Z-ADD     *ZERO         WANODT                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WANPDT                         JPN Invoice Iss
     C                   Z-ADD     *ZERO         WANQDT                         Load Actual Shi
     C                   Z-ADD     *ZERO         WANRDT                         Load BOL Comple
     C                   Z-ADD     *ZERO         WANSDT                         Load Truck Depa
     C                   Z-ADD     *ZERO         WABPTM                         Maximum Gross W
     C                   Z-ADD     *ZERO         WABQTM                         Time of Origina
     C                   Z-ADD     *ZERO         WABRTM                         OH Appt Confirm
     C                   Z-ADD     *ZERO         WABSTM                         Load BOL Comple
     C                   Z-ADD     *ZERO         WABTTM                         Load Truck Depa
     C                   Z-ADD     *ZERO         WAH0NX                         Act Frt Referen
     C                   Z-ADD     *ZERO         WAH1NX                         Act Non_Ref Frt
     C                   Z-ADD     *ZERO         WAH2NX                         OH Fuel Surchar
     C                   Z-ADD     *ZERO         WAH3NX                         OH Total Non_Re
     C                   Z-ADD     *ZERO         WAH4NX                         OH Total Ref Fr
     C                   Z-ADD     *ZERO         WAC0C7                         Claim Number
     C                   Z-ADD     *ZERO         WAAATM                         Job Time
     C                   Z-ADD     *ZERO         WAAXDT                         Job Date
      * Initialize renamed input format fields
     C                   Z-ADD     *ZERO         WBAIC3                         Company Number
     C                   Z-ADD     *ZERO         WBC4NB                         Order Number
     C                   Z-ADD     *ZERO         WBABNX                         ED Can. Import
     C                   Z-ADD     *ZERO         WBACNX                         ED Can. Import
     C                   Z-ADD     *ZERO         WBADNX                         ED Seaboard Pla
     C                   Z-ADD     *ZERO         WBAHNX                         ED Plant Contac
     C                   Z-ADD     *ZERO         WBAINX                         ED Nbr of prods
     C                   Z-ADD     *ZERO         WBA7VL                         ED Total Unit P
     C                   Z-ADD     *ZERO         WBA8VL                         ED Invoice Tota
     C                   Z-ADD     *ZERO         WBHRWG                         ED Total Net We
     C                   Z-ADD     *ZERO         WBBIVL                         ED Total Net We
     C                   Z-ADD     *ZERO         WBK2QT                         ED Nbr of Packa
     C                   Z-ADD     *ZERO         WBHSWG                         ED Total Gross
     C                   Z-ADD     *ZERO         WBBJVL                         ED Total Gross
     C                   Z-ADD     *ZERO         WBMQDT                         ED Export Certi
     C                   Z-ADD     *ZERO         WBMRDT                         ED Sail Date
     C                   Z-ADD     *ZERO         WBMSDT                         ED Sworn on Dat
     C                   Z-ADD     *ZERO         WBAJNX                         ED Consignee Ad
     C                   Z-ADD     *ZERO         WBPADT                         ED Document Dat
     C                   Z-ADD     *ZERO         WBPBDT                         ED Packing Date
     C                   Z-ADD     *ZERO         WBPCDT                         ED Expiration D
     C                   Z-ADD     *ZERO         WBPDDT                         ED Packing Date
     C                   Z-ADD     *ZERO         WBPEDT                         ED Unused Date
     C                   Z-ADD     *ZERO         WBFFNZ                         EDOH Unused Num
     C                   Z-ADD     *ZERO         WBBUDX                         EDOH Unused Dat
     C                   Z-ADD     *ZERO         WBAATM                         Job Time
     C                   Z-ADD     *ZERO         WBAXDT                         Job Date
      * Define *Synon program work fields
     C                   Z-ADD     *ZEROS        YRSW00                         *Synon (5,0) wo
     C                   Z-ADD     *ZEROS        YRSW01                         *Synon (5,0) wo
      * Dummy move for compiler
     C                   MOVE      '0'           @CN#(1)
     C                   MOVEL     'N'           W0PMT
      * Define local work field Text-18               USR
     C                   EVAL      YL0001 = ' '
      * Define local work field Text-18               USR
     C                   EVAL      YL0002 = ' '
      * Define local work field ED Consignee Name
     C                   EVAL      YL0003 = ' '
      * Define local work field ED Consignee Addr 1
     C                   EVAL      YL0004 = ' '
      *================================================================
     CSR   ZZEXIT        ENDSR
** @CN
00001 Itochu Corporation
00002 Chilled Pork
