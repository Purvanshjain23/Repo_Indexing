// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POEZPVR
// ?Date: 14.08.2025 Time: 03:36:55
// ?------------------------------------------------------------------------------------------------

//?USER: Validate fields

EXECUTE FUNCTION(Rtv Co/Eff Dt         RT) TYPE(RTVOBJ) FILE(POAKCPP)           AC1599593;
PARAMETER(DTL.Company_Number);
PARAMETER(DTL.Effective_Date);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 QUIT;

}


CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// Send error message - 'Sales Payment Interest already exists for effective date.'
ERROR(USR2970);
MSGPARM(DTL.Effective_Date);

ENDIF;

//?USER: User defined action

CASE;

// IF DTL.Payment Interest Pct is Not equal to zero
IF DTL.Payment_Interest_Pct <> *ZERO;

EXECUTE FUNCTION(Rtv/Chg All Custs     RT) TYPE(RTVOBJ) FILE(POAKCPP)           AC1599590;
PARAMETER(DTL.Company_Number);
PARAMETER(DTL.Effective_Date);
PARAMETER(DTL.Payment_Interest_Pct);
{
 //?USER: Process Data record

 CASE;

 // IF DB1.A/R Customer NE LCL.A/R Customer
 IF DB1.A_R_Customer <> LCL.A_R_Customer;

 EXECUTE FUNCTION(Crt Sales Exp PaymInt CR) TYPE(CRTOBJ) FILE(POAKCPP)           AC1597675;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.A_R_Customer);
 PARAMETER(PAR.Effective_Date);
 PARAMETER(PAR.Payment_Interest_Pct);
 PARAMETER(DB1.EDI_Status_1);
 PARAMETER(DB1.EDI_Status_2);
 PARAMETER(DB1.EDI_Status_3);
 PARAMETER(DB1.Record_Status);
 PARAMETER(DB1.Job_Time);
 PARAMETER(DB1.User_Id);
 PARAMETER(DB1.Job_Name);
 PARAMETER(DB1.Job_Date);
 // LCL.A/R Customer = DB1.A/R Customer
 LCL.A_R_Customer = DB1.A_R_Customer;

 ENDIF;

}


ENDIF;

