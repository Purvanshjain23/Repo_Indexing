     H/TITLE CRT AS Ord Hdr/Dtl DLT XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 02/22/10  Time  : 17:04:06
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDLHCPL3IF  E           K        DISK
      * RSQ : Load Order Change Log     Ld ID,Typ,Dte/Time/Se
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPDLCREL0IF  E           K        DISK
      * RTV : Shipping Line/Port        Retrieval index
      *
     FOMFFREL0IF  E           K        DISK
      * RTV : Carrier                   Retrieval index
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDIECPL1IF  E           K        DISK
      * RTV : Shipping Instructions     Retrieval index
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FPDJRCPL1IF  E           K        DISK
      * RTV : AS Order Detail           Retrieval index
      *
     FOPCPCPL1IF  E           K        DISK
      * RTV : Order Detail Comment      Retrieval index       NV
      *
     FPDJQCPL0UF  E           K        DISK                      A
      * UPD : AS Order Header           Update index
      *
     FPDLHCPL0UF  E           K        DISK
      * UPD : Load Order Change Log     Update index
      *
     FPDJRCPL0UF  E           K        DISK                      A
      * UPD : AS Order Detail           Update index
      *
     E                    YDOW        7  1               *Days of week
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WARMNB
     I              FLRUNB                          WARUNB
     I              FLRVNB                          WARVNB
     I              FLDQTX                          WADQTX
     I              FLRWNB                          WARWNB
     I              FLRXNB                          WARXNB
     I              FLSQNB                          WASQNB
     I              FLT0NB                          WAT0NB
     I              FLT1NB                          WAT1NB
     I              FLR1NB                          WAR1NB
     I              FLAIC3                          WAAIC3
     I              FLC4NB                          WAC4NB
     I              FLVCST                          WAVCST
     I              FLKEDT                          WAKEDT
     I              FLSXNB                          WASXNB
     I              FLKFDT                          WAKFDT
     I              FLACTM                          WAACTM
     I              FLK5TX                          WAK5TX
     I              FLW5CD                          WAW5CD
     I              FLEJDT                          WAEJDT
     I              FLAGTM                          WAAGTM
     I              FLKJDT                          WAKJDT
     I              FLATTM                          WAATTM
     I              FLHDDT                          WAHDDT
     I              FLAUTM                          WAAUTM
     I              FLKKDT                          WAKKDT
     I              FLAVTM                          WAAVTM
     I              FLZ4NB                          WAZ4NB
     I              FLY7ST                          WAY7ST
     I              FLY2ST                          WAY2ST
     I              FLWHTX                          WAWHTX
     I              FLWITX                          WAWITX
     I              FLWJTX                          WAWJTX
     I              FLWKTX                          WAWKTX
     I              FLWLTX                          WAWLTX
     I              FLN7DT                          WAN7DT
     I              FLN8DT                          WAN8DT
     I              FLN9DT                          WAN9DT
     I              FLB3TM                          WAB3TM
     I              FLB4TM                          WAB4TM
     I              FLB5TM                          WAB5TM
     I              FLIASX                          WAIASX
     I              FLIBSX                          WAIBSX
     I              FLICSX                          WAICSX
     I              FLWVTX                          WAWVTX
     I              FLWWTX                          WAWWTX
     I              FLWXTX                          WAWXTX
     I              FLUVST                          WAUVST
     I              FLUWST                          WAUWST
     I              FLUXST                          WAUXST
     I              FLAATM                          WAAATM
     I              FLAYNA                          WAAYNA
     I              FLA0NA                          WAA0NA
     I              FLAXDT                          WAAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@JQCPAJ
      * AS Order Header           Update index
      * Renamed input format fields
     I              JQBPST                          WCBPST
     I              JQASON                          WCASON
     I              JQIHTX                          WCIHTX
     I              JQIITX                          WCIITX
     I              JQIJTX                          WCIJTX
     I              JQIKTX                          WCIKTX
     I              JQIFTX                          WCIFTX
     I              JQTXCD                          WCTXCD
     I              JQASZI                          WCASZI
     I              JQILTX                          WCILTX
     I              JQHFDT                          WCHFDT
     I              JQU1CD                          WCU1CD
     I              JQIGTX                          WCIGTX
     I              JQASLN                          WCASLN
     I              JQASSN                          WCASSN
     I              JQASPN                          WCASPN
     I              JQTYCD                          WCTYCD
     I              JQU3CD                          WCU3CD
     I              JQJATX                          WCJATX
     I              JQJBTX                          WCJBTX
     I              JQINTX                          WCINTX
     I              JQIOTX                          WCIOTX
     I              JQIPTX                          WCIPTX
     I              JQUYCD                          WCUYCD
     I              JQASTR                          WCASTR
     I              JQU4CD                          WCU4CD
     I              JQY5ST                          WCY5ST
     I              JQTVCD                          WCTVCD
      *
     I@LHCPO4
      * Load Order Change Log     Ld ID,Typ,Dte/Time/Se
      * Renamed input format fields
     I              LHK4DT                          WDK4DT
     I              LHA1TM                          WDA1TM
     I              LHDXNB                          WDDXNB
     I              LHRMNB                          WDRMNB
     I              LHRVNB                          WDRVNB
     I              LHRVST                          WDRVST
     I              LHUJST                          WDUJST
     I              LHMNTX                          WDMNTX
     I              LHMOTX                          WDMOTX
     I              LHAYNA                          WDAYNA
     I              LHA0NA                          WDA0NA
     I              LHBZNA                          WDBZNA
     I              LHXMCD                          WDXMCD
     I              LHAIC3                          WDAIC3
     I              LHC4NB                          WDC4NB
      *
     I@LHCPN6
      * Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WEK4DT
     I              LHA1TM                          WEA1TM
     I              LHDXNB                          WEDXNB
     I              LHRMNB                          WERMNB
     I              LHRVNB                          WERVNB
     I              LHRVST                          WERVST
     I              LHUJST                          WEUJST
     I              LHMNTX                          WEMNTX
     I              LHMOTX                          WEMOTX
     I              LHAYNA                          WEAYNA
     I              LHA0NA                          WEA0NA
     I              LHBZNA                          WEBZNA
     I              LHXMCD                          WEXMCD
     I              LHAIC3                          WEAIC3
     I              LHC4NB                          WEC4NB
      *
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WFRMNB
     I              FJAIC3                          WFAIC3
     I              FJAODT                          WFAODT
     I              FJPJST                          WFPJST
     I              FJPKST                          WFPKST
     I              FJRNNB                          WFRNNB
     I              FJDMTX                          WFDMTX
     I              FJDNTX                          WFDNTX
     I              FJDOTX                          WFDOTX
     I              FJWTTX                          WFWTTX
     I              FJWUTX                          WFWUTX
     I              FJRPNB                          WFRPNB
     I              FJFLAM                          WFFLAM
     I              FJXQST                          WFXQST
     I              FJRRNB                          WFRRNB
     I              FJDXTX                          WFDXTX
     I              FJDYTX                          WFDYTX
     I              FJSBNB                          WFSBNB
     I              FJBZNA                          WFBZNA
     I              FJRONB                          WFRONB
     I              FJSQNB                          WFSQNB
     I              FJR1NB                          WFR1NB
     I              FJVCST                          WFVCST
     I              FJVDST                          WFVDST
     I              FJSDNB                          WFSDNB
     I              FJPAOU                          WFPAOU
     I              FJDGWG                          WFDGWG
     I              FJSXNB                          WFSXNB
     I              FJHADT                          WFHADT
     I              FJAART                          WFAART
     I              FJDHWG                          WFDHWG
     I              FJDIWG                          WFDIWG
     I              FJAQDT                          WFAQDT
     I              FJS6NB                          WFS6NB
     I              FJT4NB                          WFT4NB
     I              FJPRTM                          WFPRTM
     I              FJNPSV                          WFNPSV
     I              FJJ8TX                          WFJ8TX
     I              FJTLMI                          WFTLMI
     I              FJJ9TX                          WFJ9TX
     I              FJQ2CD                          WFQ2CD
     I              FJVPCD                          WFVPCD
     I              FJDBCD                          WFDBCD
     I              FJGRWE                          WFGRWE
     I              FJXCCD                          WFXCCD
     I              FJU2ST                          WFU2ST
     I              FJF9DT                          WFF9DT
     I              FJONTM                          WFONTM
     I              FJJ4DT                          WFJ4DT
     I              FJTRTM                          WFTRTM
     I              FJJ5DT                          WFJ5DT
     I              FJSPTM                          WFSPTM
     I              FJJ6DT                          WFJ6DT
     I              FJLFTM                          WFLFTM
     I              FJJ7DT                          WFJ7DT
     I              FJBOTM                          WFBOTM
     I              FJJ8DT                          WFJ8DT
     I              FJBLTM                          WFBLTM
     I              FJKIDT                          WFKIDT
     I              FJASTM                          WFASTM
     I              FJKADT                          WFKADT
     I              FJAJCM                          WFAJCM
     I              FJXACD                          WFXACD
     I              FJOANA                          WFOANA
     I              FJK4TX                          WFK4TX
     I              FJVOAG                          WFVOAG
     I              FJKBDT                          WFKBDT
     I              FJNBBO                          WFNBBO
     I              FJW4CD                          WFW4CD
     I              FJEFDT                          WFEFDT
     I              FJCNTN                          WFCNTN
     I              FJKCDT                          WFKCDT
     I              FJTMIN                          WFTMIN
     I              FJKDDT                          WFKDDT
     I              FJVMNB                          WFVMNB
     I              FJOCFR                          WFOCFR
     I              FJKJDT                          WFKJDT
     I              FJATTM                          WFATTM
     I              FJOTRS                          WFOTRS
     I              FJRNST                          WFRNST
     I              FJBRBK                          WFBRBK
     I              FJEIDT                          WFEIDT
     I              FJRMST                          WFRMST
     I              FJAJCD                          WFAJCD
     I              FJKKDT                          WFKKDT
     I              FJAVTM                          WFAVTM
     I              FJKZDT                          WFKZDT
     I              FJAXTM                          WFAXTM
     I              FJLHOS                          WFLHOS
     I              FJLHOR                          WFLHOR
     I              FJWNTX                          WFWNTX
     I              FJOITX                          WFOITX
     I              FJOJTX                          WFOJTX
     I              FJLLDT                          WFLLDT
     I              FJLSHG                          WFLSHG
     I              FJYPST                          WFYPST
     I              FJK0DT                          WFK0DT
     I              FJAYTM                          WFAYTM
     I              FJKNNX                          WFKNNX
     I              FJICWG                          WFICWG
     I              FJIDWG                          WFIDWG
     I              FJH9SX                          WFH9SX
     I              FJWOTX                          WFWOTX
     I              FJK1DT                          WFK1DT
     I              FJAZTM                          WFAZTM
     I              FJK2DT                          WFK2DT
     I              FJA0TM                          WFA0TM
     I              FJROST                          WFROST
     I              FJRPST                          WFRPST
     I              FJRQST                          WFRQST
     I              FJRRST                          WFRRST
     I              FJZBVA                          WFZBVA
     I              FJWPTX                          WFWPTX
     I              FJWQTX                          WFWQTX
     I              FJWRTX                          WFWRTX
     I              FJWSTX                          WFWSTX
     I              FJRVSX                          WFRVSX
     I              FJRUSX                          WFRUSX
     I              FJRWSX                          WFRWSX
     I              FJRXSX                          WFRXSX
     I              FJRYSX                          WFRYSX
     I              FJRZSX                          WFRZSX
     I              FJR0SX                          WFR0SX
     I              FJR1SX                          WFR1SX
     I              FJR2SX                          WFR2SX
     I              FJR3SX                          WFR3SX
     I              FJR4SX                          WFR4SX
     I              FJPYDT                          WFPYDT
     I              FJCKTM                          WFCKTM
     I              FJPZDT                          WFPZDT
     I              FJCLTM                          WFCLTM
     I              FJP0DT                          WFP0DT
     I              FJCMTM                          WFCMTM
     I              FJP1DT                          WFP1DT
     I              FJCNTM                          WFCNTM
     I              FJP2DT                          WFP2DT
     I              FJCOTM                          WFCOTM
     I              FJP3DT                          WFP3DT
     I              FJCQTM                          WFCQTM
     I              FJUVST                          WFUVST
     I              FJUWST                          WFUWST
     I              FJUXST                          WFUXST
     I              FJAATM                          WFAATM
     I              FJAYNA                          WFAYNA
     I              FJA0NA                          WFA0NA
     I              FJAXDT                          WFAXDT
      *
     I@LCREL2
      * Shipping Line/Port        Retrieval index
      * Renamed input format fields
     I              LCXACD                          WGXACD
     I              LCOANA                          WGOANA
     I              LCOKTX                          WGOKTX
     I              LCLBTX                          WGLBTX
     I              LCLATX                          WGLATX
     I              LCXBCD                          WGXBCD
     I              LCLCTX                          WGLCTX
     I              LCSPPN                          WGSPPN
     I              LCLDTX                          WGLDTX
     I              LCUVST                          WGUVST
     I              LCUWST                          WGUWST
     I              LCUXST                          WGUXST
     I              LCVSST                          WGVSST
     I              LCAATM                          WGAATM
     I              LCAYNA                          WGAYNA
     I              LCA0NA                          WGA0NA
     I              LCAXDT                          WGAXDT
      *
     I@FFREBF
      * Carrier                   Retrieval index
      * Renamed input format fields
     I              FFBZNA                          WHBZNA
     I              FFADTX                          WHADTX
     I              FFACNA                          WHACNA
     I              FFADNA                          WHADNA
     I              FFAENA                          WHAENA
     I              FFAJNA                          WHAJNA
     I              FFBTTX                          WHBTTX
     I              FFEZNB                          WHEZNB
     I              FFBGCD                          WHBGCD
     I              FFEEDT                          WHEEDT
     I              FFDUTX                          WHDUTX
     I              FFNRVA                          WHNRVA
     I              FFNSVA                          WHNSVA
     I              FFNTVA                          WHNTVA
     I              FFNUVA                          WHNUVA
     I              FFP1ST                          WHP1ST
     I              FFDVTX                          WHDVTX
     I              FFDWTX                          WHDWTX
     I              FFLVCD                          WHLVCD
     I              FFS8NB                          WHS8NB
     I              FFS9NB                          WHS9NB
     I              FFNMVA                          WHNMVA
     I              FFNOVA                          WHNOVA
     I              FFNPVA                          WHNPVA
     I              FFNQVA                          WHNQVA
     I              FFMFCD                          WHMFCD
     I              FFQXNB                          WHQXNB
     I              FFQ1NB                          WHQ1NB
     I              FFMRNG                          WHMRNG
     I              FFMRNE                          WHMRNE
     I              FFRFNB                          WHRFNB
     I              FFMREG                          WHMREG
     I              FFBQPR                          WHBQPR
     I              FFBRPR                          WHBRPR
     I              FFBSPR                          WHBSPR
     I              FFBTPR                          WHBTPR
     I              FFBUPR                          WHBUPR
     I              FFBVPR                          WHBVPR
     I              FFDJWG                          WHDJWG
     I              FFDKWG                          WHDKWG
     I              FFDLWG                          WHDLWG
     I              FFDMWG                          WHDMWG
     I              FFDNWG                          WHDNWG
     I              FFDOWG                          WHDOWG
     I              FFB2PR                          WHB2PR
     I              FFB3PR                          WHB3PR
     I              FFB4PR                          WHB4PR
     I              FFB5PR                          WHB5PR
     I              FFB6PR                          WHB6PR
     I              FFB7PR                          WHB7PR
     I              FFAAC7                          WHAAC7
     I              FFCOFI                          WHCOFI
     I              FFK6TX                          WHK6TX
     I              FFOCNA                          WHOCNA
     I              FFODNA                          WHODNA
     I              FFW7CD                          WHW7CD
     I              FFK7TX                          WHK7TX
     I              FFTENO                          WHTENO
     I              FFK8TX                          WHK8TX
     I              FFAOFC                          WHAOFC
     I              FFAOLI                          WHAOLI
     I              FFKHDT                          WHKHDT
     I              FFUNUS                          WHUNUS
     I              FFUNU2                          WHUNU2
     I              FFUNU3                          WHUNU3
     I              FFUVST                          WHUVST
     I              FFUWST                          WHUWST
     I              FFUXST                          WHUXST
     I              FFVSST                          WHVSST
     I              FFAATM                          WHAATM
     I              FFAYNA                          WHAYNA
     I              FFA0NA                          WHA0NA
     I              FFAXDT                          WHAXDT
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WIBKC7
     I              BBAYTX                          WIAYTX
     I              BBACNA                          WIACNA
     I              BBADNA                          WIADNA
     I              BBAENA                          WIAENA
     I              BBAJNA                          WIAJNA
     I              BBBGCD                          WIBGCD
     I              BBG5CD                          WIG5CD
     I              BBBTTX                          WIBTTX
     I              BBBVTX                          WIBVTX
     I              BBBWTX                          WIBWTX
     I              BBABTX                          WIABTX
     I              BBA2NA                          WIA2NA
     I              BBCBST                          WICBST
     I              BBB0NA                          WIB0NA
     I              BBP3NB                          WIP3NB
     I              BBAXNA                          WIAXNA
     I              BBI6DT                          WII6DT
     I              BBAYDT                          WIAYDT
     I              BBANC7                          WIANC7
     I              BBBTC7                          WIBTC7
     I              BBK6ST                          WIK6ST
     I              BBUZST                          WIUZST
     I              BBKXCD                          WIKXCD
     I              BBLTCD                          WILTCD
     I              BBQNST                          WIQNST
     I              BBS2NB                          WIS2NB
     I              BBVHVA                          WIVHVA
     I              BBI7DT                          WII7DT
     I              BBRJST                          WIRJST
     I              BBRKST                          WIRKST
     I              BBQWST                          WIQWST
     I              BBQXST                          WIQXST
     I              BBQYST                          WIQYST
     I              BBUNCS                          WIUNCS
     I              BBUVST                          WIUVST
     I              BBUWST                          WIUWST
     I              BBUXST                          WIUXST
     I              BBVSST                          WIVSST
     I              BBAATM                          WIAATM
     I              BBAYNA                          WIAYNA
     I              BBA0NA                          WIA0NA
     I              BBAXDT                          WIAXDT
      *
     I@IECPSA
      * Shipping Instructions     Retrieval index
      * Renamed input format fields
     I              IEAIC3                          WJAIC3
     I              IEC4NB                          WJC4NB
     I              IEDXNB                          WJDXNB
     I              IEMQNA                          WJMQNA
     I              IEUVST                          WJUVST
     I              IEUWST                          WJUWST
     I              IEUXST                          WJUXST
     I              IEAATM                          WJAATM
     I              IEAYNA                          WJAYNA
     I              IEA0NA                          WJA0NA
     I              IEAXDT                          WJAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMGSPR                          WKGSPR
     I              OMGTPR                          WKGTPR
     I              OMGUPR                          WKGUPR
     I              OMHOST                          WKHOST
     I              OMHPST                          WKHPST
     I              OMIOST                          WKIOST
     I              OMPEWG                          WKPEWG
     I              OMRINY                          WKRINY
     I              OMTIDT                          WKTIDT
     I              OMTJDT                          WKTJDT
     I              OMH2ST                          WKH2ST
     I              OMH0ST                          WKH0ST
     I              OMH1ST                          WKH1ST
     I              OMTKDT                          WKTKDT
     I              OMTLDT                          WKTLDT
     I              OMTMDT                          WKTMDT
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     I@JRCPAT
      * AS Order Detail           Retrieval index
      * Renamed input format fields
     I              JRBPST                          WLBPST
     I              JRASON                          WLASON
     I              JRASPD                          WLASPD
     I              JRASQU                          WLASQU
     I              JRIQTX                          WLIQTX
     I              JRY5ST                          WLY5ST
     I              JRXDTX                          WLXDTX
     I              JRTVCD                          WLTVCD
      *
     I@JRCPAM
      * AS Order Detail           Update index
      * Renamed input format fields
     I              JRBPST                          WMBPST
     I              JRASON                          WMASON
     I              JRASPD                          WMASPD
     I              JRASQU                          WMASQU
     I              JRIQTX                          WMIQTX
     I              JRY5ST                          WMY5ST
     I              JRXDTX                          WMXDTX
     I              JRTVCD                          WMTVCD
      *
     I@CPCPOL
      * Order Detail Comment      Retrieval index       NV
      * Renamed input format fields
     I              CPAIC3                          WOAIC3
     I              CPC4NB                          WOC4NB
     I              CPDPNB                          WODPNB
     I              CPUENB                          WOUENB
     I              CPDXNB                          WODXNB
     I              CPG4NA                          WOG4NA
     I              CPUVST                          WOUVST
     I              CPUWST                          WOUWST
     I              CPUXST                          WOUXST
     I              CPAATM                          WOAATM
     I              CPAYNA                          WOAYNA
     I              CPA0NA                          WOA0NA
     I              CPAXDT                          WOAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDJQ1    E DSPDJQCPL0
      * UPD : AS Order Header           Update index
      * Renamed input format fields
     I              JQBPST                          WCBPST
     I              JQASON                          WCASON
     I              JQIHTX                          WCIHTX
     I              JQIITX                          WCIITX
     I              JQIJTX                          WCIJTX
     I              JQIKTX                          WCIKTX
     I              JQIFTX                          WCIFTX
     I              JQTXCD                          WCTXCD
     I              JQASZI                          WCASZI
     I              JQILTX                          WCILTX
     I              JQHFDT                          WCHFDT
     I              JQU1CD                          WCU1CD
     I              JQIGTX                          WCIGTX
     I              JQASLN                          WCASLN
     I              JQASSN                          WCASSN
     I              JQASPN                          WCASPN
     I              JQTYCD                          WCTYCD
     I              JQU3CD                          WCU3CD
     I              JQJATX                          WCJATX
     I              JQJBTX                          WCJBTX
     I              JQINTX                          WCINTX
     I              JQIOTX                          WCIOTX
     I              JQIPTX                          WCIPTX
     I              JQUYCD                          WCUYCD
     I              JQASTR                          WCASTR
     I              JQU4CD                          WCU4CD
     I              JQY5ST                          WCY5ST
     I              JQTVCD                          WCTVCD
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDLH1    E DSPDLHCPL0
      * UPD : Load Order Change Log     Update index
      * Renamed input format fields
     I              LHK4DT                          WEK4DT
     I              LHA1TM                          WEA1TM
     I              LHDXNB                          WEDXNB
     I              LHRMNB                          WERMNB
     I              LHRVNB                          WERVNB
     I              LHRVST                          WERVST
     I              LHUJST                          WEUJST
     I              LHMNTX                          WEMNTX
     I              LHMOTX                          WEMOTX
     I              LHAYNA                          WEAYNA
     I              LHA0NA                          WEA0NA
     I              LHBZNA                          WEBZNA
     I              LHXMCD                          WEXMCD
     I              LHAIC3                          WEAIC3
     I              LHC4NB                          WEC4NB
      *
     IQPDJR1    E DSPDJRCPL0
      * UPD : AS Order Detail           Update index
      * Renamed input format fields
     I              JRBPST                          WMBPST
     I              JRASON                          WMASON
     I              JRASPD                          WMASPD
     I              JRASQU                          WMASQU
     I              JRIQTX                          WMIQTX
     I              JRY5ST                          WMY5ST
     I              JRXDTX                          WMXDTX
     I              JRTVCD                          WMTVCD
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Detail
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * I :  Order Number
     I                                    P   7  100P1C4NB
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1C4NB    PARM           WP0003  70       Order Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * CRT AS Ord Hdr/Dtl DLT XF
      * CRT AS Order Hdr/ Dlt  RT - Load Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * CRT AS Order Hdr/ Dlt  RT - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  7        AS Order Number
     C                     MOVEL*BLANK    WN0002 25        AS Customer Nam
     C                     MOVEL*BLANK    WN0003 25        AS Address 1
     C                     MOVEL*BLANK    WN0004 25        AS Address 2
     C                     MOVEL*BLANK    WN0005 25        AS Address 3
     C                     MOVEL*BLANK    WN0006 20        AS City
     C                     MOVEL*BLANK    WN0007  2        AS State
     C                     MOVEL*BLANK    WN0008 11        AS Zip
     C                     MOVEL*BLANK    WN0009 15        AS Purchase Ord
     C                     MOVEL*BLANK    WN0010 25        AS Trucking Com
     C                     MOVEL*BLANK    WN0011  7        AS Load Number
     C                     MOVEL*BLANK    WN0012  2        AS Stop Number
     C                     MOVEL*BLANK    WN0013 12        AS Phone Number
     C                     MOVEL*BLANK    WN0014  3        AS Reefer Tempe
     C                     MOVEL*BLANK    WN0015 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0016 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0017 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0018  1        AS Add/Change/D
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WARMNB    WQSA02           Load ID
     C           *LIKE     DEFN WAC4NB    WQSA03           Order Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA02           Load ID
     C                     KFLD           WQSA03           Order Number
      * Setup key
     C                     Z-ADDP1RMNB    WQSA02           Load ID
     C                     Z-ADDP1C4NB    WQSA03           Order Number
      * Establish starting position
     C           KRSSA     SETLL@FLCPKF                    *
     C           KRSSA     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'D'       WN0018           AS Add/Change/D
      * This func will delete existing AS Order header and create a new o
      * CRT AS Order Header    RT - Order Header TRG  * 
     C                     EXSR SBRVGN
      * This func will delete existing AS Order detail and create a new o
      * CRT AS Order Detail    RT - Order Detail  * 
     C                     EXSR SNRVGN
     C           KRSSA     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * CRT AS Order Header    RT - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0019  7        AS Order Number
     C                     MOVEL*BLANK    WN0020 25        AS Customer Nam
     C                     MOVEL*BLANK    WN0021 25        AS Address 1
     C                     MOVEL*BLANK    WN0022 25        AS Address 2
     C                     MOVEL*BLANK    WN0023 25        AS Address 3
     C                     MOVEL*BLANK    WN0024 20        AS City
     C                     MOVEL*BLANK    WN0025  2        AS State
     C                     MOVEL*BLANK    WN0026 11        AS Zip
     C                     MOVEL*BLANK    WN0027 15        AS Purchase Ord
     C                     MOVEL*BLANK    WN0028  6        AS Req. Deliver
     C                     MOVEL*BLANK    WN0029  5        AS Req. Deliver
     C                     MOVEL*BLANK    WN0030 25        AS Trucking Com
     C                     MOVEL*BLANK    WN0031  7        AS Load Number
     C                     MOVEL*BLANK    WN0032  2        AS Stop Number
     C                     MOVEL*BLANK    WN0033 12        AS Phone Number
     C                     MOVEL*BLANK    WN0034  3        AS Reefer Tempe
     C                     MOVEL*BLANK    WN0035  7        AS Collect/Prep
     C                     MOVEL*BLANK    WN0036 45        AS Special Inst
     C                     MOVEL*BLANK    WN0037 45        AS Special Inst
     C                     MOVEL*BLANK    WN0038 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0039 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0040 30        AS Shipping Ins
     C                     MOVEL*BLANK    WN0041  3        AS Warehouse ID
     C                     MOVEL*BLANK    WN0042  8        AS Trailer Numb
     C                     MOVEL*BLANK    WN0043  1        AS Age Code
     C                     MOVEL*BLANK    WN0044  4        Time  4A
     C                     MOVEL*BLANK    WN0045 20        Trailer Id
     C                     MOVEL*BLANK    WN0046  3        Shipping Line
     C                     MOVEL*BLANK    WN0047 20        Port Delv Termi
     C                     Z-ADD*ZERO     WN0048  60       Date Out (6,0)
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     Z-ADDWAC4NB    WBC4NB           Order Number
      * Establish starting position
     C           KRSSB     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.Header Status is Cancelled
     C           WBGWST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Delete any Existing records prior to creating new
     C                     MOVEL*BLANK    WN0019           AS Order Number
     C                     MOVELWBC4NB    WN0019           AS Order Number
      * DLT AS Order Header    DL - AS Order Header  * 
     C                     EXSR SCDLRC
      * OMS280:  delete existing SNDACC records for order
      * Del SNDACC Entry/Ord   RT - Load Order Change Log  * 
     C                     EXSR SDRVGN
     C                     MOVEL*BLANK    W0RTN            *Return code
      * ****
      * Load AS file fields
     C                     EXSR UASUBR                     Load AS file fi
      * CRT AS Order Header    CR - AS Order Header  * 
     C                     EXSR SMCRRC
      * ****
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCDLRC    BEGSR
      *================================================================
      * DLT AS Order Header    DL - AS Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JQCPAJ
     C                     MOVEL'H'       WCBPST           AS File Type
     C                     MOVELWN0019    WCASON           AS Order Number
      *
     C           KLDLSC    KLIST
     C                     KFLD           WCBPST           AS File Type
     C                     KFLD           WCASON           AS Order Number
     C           KLDLSC    CHAIN@JQCPAJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJQCPL0'MDACP
     C                     MOVEL'@JQCPAJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JQCPAJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Del SNDACC Entry/Ord   RT - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSD02           Load ID
     C           *LIKE     DEFN WDRVST    WQSD03           Load Change Typ
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD02           Load ID
     C                     KFLD           WQSD03           Load Change Typ
      * Setup key
     C                     Z-ADDWBRMNB    WQSD02           Load ID
     C                     MOVEL'SNDACC'  WQSD03           Load Change Typ
      * Establish starting position
     C           KRSSD     SETLL@LHCPO4                    *
     C           KRSSD     READE@LHCPO4                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2471' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Order Number EQ PAR.Order Number
     C           WDC4NB    IFEQ WBC4NB                     *IF
      * DEL Load/Order Chg Log DR - Load Order Change Log  * 
     C                     EXSR SEDLRC
     C                     END                             *FI
     C           KRSSD     READE@LHCPO4                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * DEL Load/Order Chg Log DR - Load Order Change Log  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @LHCPN6
     C                     Z-ADDWDK4DT    WEK4DT           Created Date
     C                     Z-ADDWDA1TM    WEA1TM           Created Time
     C                     Z-ADDWDDXNB    WEDXNB           Sequence Number
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEK4DT           Created Date
     C                     KFLD           WEA1TM           Created Time
     C                     KFLD           WEDXNB           Sequence Number
     C           KLDLSE    CHAIN@LHCPN6              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDLHCPL0'MDACP
     C                     MOVEL'@LHCPN6' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@LHCPN6                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/Port RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFRMNB           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WFRMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0046           Shipping Line
     C                     MOVEL*BLANK    WN0047           Port Delv Termi
     C                     MOVEL*BLANK    WUG0TX           Vessel Name
     C                     Z-ADD*ZERO     WUNFNN           Voyage
     C                     Z-ADD*ZERO     WUNFNN           Sail Date
     C                     MOVEL*BLANK    WUG0TX           Booking Number
     C                     MOVEL*BLANK    WUG0TX           Discharge Port
     C                     Z-ADD*ZERO     WUNFNN           Arrival Date
     C                     MOVEL*BLANK    WUG0TX           Container Numbe
     C                     Z-ADD*ZERO     WUNFNN           Date In
     C                     Z-ADD*ZERO     WUNFNN           Time In
     C                     Z-ADD*ZERO     WUNFNN           Date Out
     C                     Z-ADD*ZERO     WUNFNN           Time Out
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFXACD    WN0046           Shipping Line
     C                     MOVELWFOANA    WN0047           Port Delv Termi
     C                     MOVELWFK4TX    WUG0TX           Vessel Name
     C                     Z-ADDWFVOAG    WUNFNN           Voyage
     C                     Z-ADDWFKBDT    WUNFNN           Sail Date
     C                     MOVELWFNBBO    WUG0TX           Booking Number
     C                     MOVELWFW4CD    WUG0TX           Discharge Port
     C                     Z-ADDWFEFDT    WUNFNN           Arrival Date
     C                     MOVELWFCNTN    WUG0TX           Container Numbe
     C                     Z-ADDWFKCDT    WUNFNN           Date In
     C                     Z-ADDWFTMIN    WUNFNN           Time In
     C                     Z-ADDWFKDDT    WUNFNN           Date Out
     C                     Z-ADDWFVMNB    WUNFNN           Time Out
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Shipping Line/PortsRT - PD Shipping Line/Port  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGXACD           Shipping Line
     C                     KFLD           WGOANA           Port Delv Termi
      * Setup key
     C                     MOVELWN0046    WGXACD           Shipping Line
     C                     MOVELWN0047    WGOANA           Port Delv Termi
      * Establish starting position
     C           KRSSG     CHAIN@LCREL2              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2419' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0024           Port City
     C                     MOVEL*BLANK    WN0021           Port Address Li
     C                     MOVEL*BLANK    WN0022           Port Address Li
     C                     MOVEL*BLANK    WN0025           Sail Port State
     C                     MOVEL*BLANK    WN0026           Port Zip/Postal
     C                     Z-ADD*ZERO     WUNFNN           Port Phone Numb
     C                     MOVEL*BLANK    WUG0TX           Port Fax Number
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGOKTX    WN0024           Port City
     C                     MOVELWGLBTX    WN0021           Port Address Li
     C                     MOVELWGLATX    WN0022           Port Address Li
     C                     MOVELWGXBCD    WN0025           Sail Port State
     C                     MOVELWGLCTX    WN0026           Port Zip/Postal
     C                     Z-ADDWGSPPN    WUNFNN           Port Phone Numb
     C                     MOVELWGLDTX    WUG0TX           Port Fax Number
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Name, Status       RT - OM Carrier  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHBZNA           Carrier Code
      * Setup key
     C                     MOVELWBBZNA    WHBZNA           Carrier Code
      * Establish starting position
     C           KRSSH     CHAIN@FFREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1180' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0030           Name
     C                     MOVEL*BLANK    WUVSST           Record Status
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHADTX    WN0030           Name
     C                     MOVELWHVSST    WUVSST           Record Status
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Customer Telephone RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WIBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDWBBKC7    WIBKC7           Ship To Custome
      * Establish starting position
     C           KRSSI     CHAIN@BBREE9              90    *
      * Data record not found
     C   90                MOVEL'USR0170' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWIBVTX    WUBVTX           Telephone Numbe
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Ship Inst for AS   RT - Shipping Instructions  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUWQNB           USR Counter
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0038           AS Shipping Ins
     C                     MOVEL*BLANK    WN0039           AS Shipping Ins
     C                     MOVEL*BLANK    WN0040           AS Shipping Ins
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WJC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSJ01           Company Number
     C                     Z-ADDWBC4NB    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@IECPSA                    *
     C           KRSSJ     READE@IECPSA                  90*
      * Data record not found
     C   90                MOVEL'USR1659' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WUWQNB           USR Counter
      * CASE: WRK.USR Counter is EQ 1
     C           WUWQNB    IFEQ 1                          *IF
     C                     MOVELWJMQNA    WN0038           AS Shipping Ins
     C                     ELSE
      * CASE: WRK.USR Counter is EQ 2
     C           WUWQNB    IFEQ 2                          *IF
     C                     MOVELWJMQNA    WN0039           AS Shipping Ins
     C                     ELSE
      * CASE: WRK.USR Counter is EQ 3
     C           WUWQNB    IFEQ 3                          *IF
     C                     MOVELWJMQNA    WN0040           AS Shipping Ins
     C                     GOTO SJEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSJ     READE@IECPSA                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * RTV Warehouse code     RT - PD Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSK01           Company Number
     C           *LIKE     DEFN WKC4NB    WQSK02           Order Number
      * Define keylist
     C           KPSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
     C                     KFLD           WQSK02           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WQSK01           Company Number
     C                     Z-ADDWBC4NB    WQSK02           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
      * Establish starting position
     C           KPSSK     SETLL@BGWKL1                    *
     C           KRSSK     READE@BGWKL1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1309' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0041           Warehouse Code
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
      * CASE: DB1.Detail Line Status is Cancelled
     C           WKGMST    IFEQ 'X'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * PAR = DB1 By name
     C                     MOVELWKAJCD    WN0041           Warehouse Code
     C                     GOTO SKEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSK     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Trailer Number     RT - OM Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WFRMNB           Load ID
      * Setup key
     C                     Z-ADDWBRMNB    WFRMNB           Load ID
      * Establish starting position
     C           KRSSL     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFDXTX    WN0045           Trailer Id
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT AS Order Header    CR - AS Order Header  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0054  1        AS Carriage Ret
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JQCPAJ
     C                     MOVEL'H'       WCBPST           AS File Type
     C                     MOVELWN0019    WCASON           AS Order Number
     C                     MOVELWN0020    WCIHTX           AS Customer Nam
     C                     MOVELWN0021    WCIITX           AS Address 1
     C                     MOVELWN0022    WCIJTX           AS Address 2
     C                     MOVELWN0023    WCIKTX           AS Address 3
     C                     MOVELWN0024    WCIFTX           AS City
     C                     MOVELWN0025    WCTXCD           AS State
     C                     MOVELWN0026    WCASZI           AS Zip
     C                     MOVELWN0027    WCILTX           AS Purchase Ord
     C                     MOVELWN0028    WCHFDT           AS Req. Deliver
     C                     MOVELWN0029    WCU1CD           AS Req. Deliver
     C                     MOVELWN0030    WCIGTX           AS Trucking Com
     C                     MOVELWN0031    WCASLN           AS Load Number
     C                     MOVELWN0032    WCASSN           AS Stop Number
     C                     MOVELWN0033    WCASPN           AS Phone Number
     C                     MOVELWN0034    WCTYCD           AS Reefer Tempe
     C                     MOVELWN0035    WCU3CD           AS Collect/Prep
     C                     MOVELWN0036    WCJATX           AS Special Inst
     C                     MOVELWN0037    WCJBTX           AS Special Inst
     C                     MOVELWN0038    WCINTX           AS Shipping Ins
     C                     MOVELWN0039    WCIOTX           AS Shipping Ins
     C                     MOVELWN0040    WCIPTX           AS Shipping Ins
     C                     MOVELWN0041    WCUYCD           AS Warehouse ID
     C                     MOVELWN0042    WCASTR           AS Trailer Numb
     C                     MOVELWN0043    WCU4CD           AS Age Code
     C                     MOVELWN0018    WCY5ST           AS Add/Change/D
      *
     C           KLCRSM    KLIST
     C                     KFLD           WCBPST           AS File Type
     C                     KFLD           WCASON           AS Order Number
      * Check for duplicate primary key
     C           KLCRSM    SETLL@JQCPAJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1986' W0RTN   7
      * Send message 'AS Order Header        EX'
     C                     MOVEL'USR1986' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@JQCPAJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * CRT AS Order Detail    RT - Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0055  7        AS Order Number
     C                     MOVEL*BLANK    WN0056  5        AS Product Code
     C                     MOVEL*BLANK    WN0057  4        AS Quantity
     C                     MOVEL*BLANK    WN0058 50        AS Line Comment
     C                     MOVEL*BLANK    WN0059  8        AS Label Date Y
     C                     MOVEL*BLANK    WN0060  1        AS Carriage Ret
     C                     Z-ADD*ZERO     WN0061  70       Label Date  USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Delete existing detail records prior to create
     C                     MOVEL*BLANK    WN0055           AS Order Number
     C                     MOVELWAC4NB    WN0055           AS Order Number
      * DEL All AS Order Dtl   RT - AS Order Detail  * 
     C                     EXSR SORVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WKC4NB    WQSN02           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADDWAAIC3    WQSN01           Company Number
     C                     Z-ADDWAC4NB    WQSN02           Order Number
      * Establish starting position
     C           KRSSN     SETLL@BGWKL1                    *
     C           KRSSN     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WKGMST    IFEQ 'X'                        *IF
      * The add change flag will be delete.
      * Load AS file fields
     C                     EXSR UBSUBR                     Load AS file fi
      * CRT AS Order Detail    CR - AS Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'D'       WL0006    P      AS File Type
     C                     MOVELWN0055    WL0007    P      AS Order Number
     C                     MOVELWN0056    WL0008    P      AS Product Code
     C                     MOVELWN0057    WL0009    P      AS Quantity
     C                     MOVELWN0058    WL0010    P      AS Line Comment
     C                     MOVEL'D'       WL0011    P      AS Add/Change/D
     C                     MOVELWN0059    WL0012    P      AS Label Date Y
     C                     EXSR SRCRRC
     C                     ELSE
      * CASE: *OTHERWISE
      * Load AS file fields
     C                     EXSR UCSUBR                     Load AS file fi
      * CRT AS Order Detail    CR - AS Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     MOVEL'D'       WL0006    P      AS File Type
     C                     MOVELWN0055    WL0007    P      AS Order Number
     C                     MOVELWN0056    WL0008    P      AS Product Code
     C                     MOVELWN0057    WL0009    P      AS Quantity
     C                     MOVELWN0058    WL0010    P      AS Line Comment
     C                     MOVELWN0018    WL0011    P      AS Add/Change/D
     C                     MOVELWN0059    WL0012    P      AS Label Date Y
     C                     EXSR SRCRRC
     C                     END                             *FI
     C           KRSSN     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * DEL All AS Order Dtl   RT - AS Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLBPST    WQSO01           AS File Type
     C           *LIKE     DEFN WLASON    WQSO02           AS Order Number
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           AS File Type
     C                     KFLD           WQSO02           AS Order Number
      * Setup key
     C                     MOVEL'D'       WQSO01           AS File Type
     C                     MOVELWN0055    WQSO02           AS Order Number
      * Establish starting position
     C           KRSSO     SETLL@JRCPAT                    *
     C           KRSSO     READE@JRCPAT                  90*
      * Data record not found
     C   90                MOVEL'USR1987' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * DLT AS Order Detail    DL - AS Order Detail  * 
     C                     EXSR SPDLRC
     C           KRSSO     READE@JRCPAT                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPDLRC    BEGSR
      *================================================================
      * DLT AS Order Detail    DL - AS Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @JRCPAM
     C                     MOVEL'D'       WMBPST           AS File Type
     C                     MOVELWLASON    WMASON           AS Order Number
     C                     MOVELWLASPD    WMASPD           AS Product Code
      *
     C           KLDLSP    KLIST
     C                     KFLD           WMBPST           AS File Type
     C                     KFLD           WMASON           AS Order Number
     C                     KFLD           WMASPD           AS Product Code
     C           KLDLSP    CHAIN@JRCPAM              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDJRCPL0'MDACP
     C                     MOVEL'@JRCPAM' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@JRCPAM                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV First Comment Line RT - OP Order Detail Comment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WOC4NB    WQSQ02           Order Number
     C           *LIKE     DEFN WODPNB    WQSQ03           Order Sequence
     C           *LIKE     DEFN WOUENB    WQSQ04           Order Secondary
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Order Number
     C                     KFLD           WQSQ03           Order Sequence
     C                     KFLD           WQSQ04           Order Secondary
      * Setup key
     C                     Z-ADDWL0001    WQSQ01           Company Number
     C                     Z-ADDWL0002    WQSQ02           Order Number
     C                     Z-ADDWL0003    WQSQ03           Order Sequence
     C                     Z-ADDWL0004    WQSQ04           Order Secondary
      * Establish starting position
     C           KRSSQ     SETLL@CPCPOL                    *
     C           KRSSQ     READE@CPCPOL                  90*
      * Data record not found
     C   90                MOVEL'USR0488' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWOG4NA    WL0005           Comment Text
      * CASE: DB1.Comment Text is not equal to blank
     C           WOG4NA    IFNE *BLANK                     *IF
     C                     GOTO SQEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSQ     READE@CPCPOL                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCRRC    BEGSR
      *================================================================
      * CRT AS Order Detail    CR - AS Order Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0062  1        AS Carriage Ret
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @JRCPAM
     C                     MOVELWL0006    WMBPST           AS File Type
     C                     MOVELWL0007    WMASON           AS Order Number
     C                     MOVELWL0008    WMASPD           AS Product Code
     C                     MOVELWL0009    WMASQU           AS Quantity
     C                     MOVELWL0010    WMIQTX           AS Line Comment
     C                     MOVELWL0011    WMY5ST           AS Add/Change/D
     C                     MOVELWL0012    WMXDTX           AS Label Date Y
      *
     C           KLCRSR    KLIST
     C                     KFLD           WMBPST           AS File Type
     C                     KFLD           WMASON           AS Order Number
     C                     KFLD           WMASPD           AS Product Code
      * Check for duplicate primary key
     C           KLCRSR    SETLL@JRCPAM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1988' W0RTN   7
      * Send message 'AS Order Detail        EX'
     C                     MOVEL'USR1988' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C                     WRITE@JRCPAM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Load AS file fields
      *================================================================
     C                     MOVELWBBRTX    WN0020           AS Customer Nam
     C                     MOVELWBHMNA    WN0021           AS Address 1
     C                     MOVELWBHONA    WN0022           AS Address 2
     C                     MOVELWBHPNA    WN0023           AS Address 3
     C                     MOVELWBHNNA    WN0024           AS City
     C                     MOVELWBDBCD    WN0025           AS State
     C                     MOVELWBCKTX    WN0026           AS Zip
      * OMS228:  for export orders, change ship to info to sail port info
      * CASE: DB1.Export Status is yes
     C           WBU2ST    IFEQ 'Y'                        *IF
      * RTV Shipping Line/Port RT - OM Load Header  * 
     C                     EXSR SFRVGN
      * CASE: PAR.Sail Port Delv Terminal NE WRK.BLANK
     C           WN0047    IFNE WUGSTX                     *IF
      * RTV Shipping Line/PortsRT - PD Shipping Line/Port  * 
     C                     EXSR SGRVGN
     C                     MOVEL*BLANK    WN0023           AS Address 3
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVELWBBCNA    WN0027           AS Purchase Ord
      *
     C                     MOVEL*BLANK    WN0049  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0050  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0051  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0052  2        Month (Char) US
     C                     MOVEL*BLANK    WN0053  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0050           Date (Alpha) US
     C                     MOVELWBEIDT    WN0050           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0050:ZQ WN0051    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0050:ZQ WN0052    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0050:ZQ WN0053    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0052    CAT  WN0053:ZQ WN0049    P      Date (Char-6) U
     C                     Z-ADD*ZERO     ZQ      50
     C           WN0049    CAT  WN0051:ZQ WN0049    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0049    WN0048           Date Out (6,0)
     C                     MOVEL*BLANK    WN0028           AS Req. Deliver
     C                     MOVELWN0048    WN0028           AS Req. Deliver
     C                     MOVEL*BLANK    WN0044           Time  4A
     C                     MOVELWBAFTM    WN0044           Time  4A
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0044:ZQ WUVDCD    P  90  Hours  2A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00004
     C           ZQ        ORGT 00004
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0044:ZQ WUVECD    P  90  Minutes  2A
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVDCD    CAT  ':':ZQ    WUVFCD    P      Hours HH:  3A
     C                     Z-ADD*ZERO     ZQ      50
     C           WUVFCD    CAT  WUVECD:ZQ WN0029    P      AS Req. Deliver
      * RTV Name, Status       RT - OM Carrier  * 
     C                     EXSR SHRVGN
     C                     MOVEL*BLANK    WN0031           AS Load Number
     C                     MOVELWBRMNB    WN0031           AS Load Number
     C           WARVNB    MULT 1         WUTPNB           Calc 2
     C                     MOVELWUTPNB    WN0032           AS Stop Number
      * RTV Customer Telephone RT - Customer  * 
     C                     EXSR SIRVGN
     C                     MOVELWUBVTX    WN0033           AS Phone Number
     C                     MOVEL*BLANK    WN0034           AS Reefer Tempe
      * PAR.AS Collect/Prepaid = Condition name of DB1.Shipping Method
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1252129   Y2LSNO  70       List number
     C                     PARM WBQ2CD    W0INVL 25        Shipping Method
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           WN0035    PARM           W0CNNM 25        AS Collect/Prep
      *
     C                     MOVEL*BLANK    WN0036           AS Special Inst
     C                     MOVELWBB6NA    WN0036           AS Special Inst
     C                     MOVEL*BLANK    WN0037           AS Special Inst
     C                     MOVELWBBYNA    WN0037           AS Special Inst
      * RTV Ship Inst for AS   RT - Shipping Instructions  * 
     C                     EXSR SJRVGN
      * RTV Warehouse code     RT - PD Order Detail  * 
     C                     EXSR SKRVGN
      * RTV Trailer Number     RT - OM Load Header  * 
     C                     EXSR SLRVGN
     C                     MOVELWN0045    WN0042           AS Trailer Numb
     C                     MOVELWBRPCD    WN0043           AS Age Code
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Load AS file fields
      *================================================================
     C                     MOVEL*BLANK    WN0055           AS Order Number
     C                     MOVELWKC4NB    WN0055           AS Order Number
     C           WKHGCD    MULT 1         WUTSNB           Calc 5
     C                     MOVELWUTSNB    WN0056           AS Product Code
     C           WKCCQT    MULT 1         WUTRNB           Calc 4
     C                     MOVELWUTRNB    WN0057           AS Quantity
      * RTV First Comment Line RT - OP Order Detail Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0001           Company Number
     C                     Z-ADDWKC4NB    WL0002           Order Number
     C                     Z-ADDWKDPNB    WL0003           Order Sequence
     C                     Z-ADDWKUENB    WL0004           Order Secondary
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0058    P      Comment Text
      * CLC Oldest Label Dt    IF
      * This internal function will return the 'Oldest Label Date' to it'
      * calling function based on the input 'Age Code' and 'Scheduled Shi
      * Date'.
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * CASE: PAR.Age Code is A: 0 Day
     C           WKRPCD    IFEQ 'A'                        *IF
     C                     Z-ADDWKAODT    YL0001           Date - ATR
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is B: 1 Day
     C           WKRPCD    IFEQ 'B'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is C: 2 Day
     C           WKRPCD    IFEQ 'C'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is D: 3 Day
     C           WKRPCD    IFEQ 'D'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is E: 4 Day
     C           WKRPCD    IFEQ 'E'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is F: 5 Day
     C           WKRPCD    IFEQ 'F'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is G: 6 Day
     C           WKRPCD    IFEQ 'G'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WKRPCD    IFEQ 'H'                        *IF
     C           WKRPCD    OREQ 'I'                        *OR
      * RMC 9/12/06 PFS019 90 days chgd to 120 days
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-7 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-7        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0002           Date (Alpha) US
     C                     MOVELYL0001    YL0002           Date (Alpha) US
     C                     MOVEL*BLANK    YL0003           Date From Conve
     C                     MOVELYL0002    YL0003           Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM YL0003    WQ0001 10        Date From Conve
     C           YL0004    PARM *BLANK    WQ0002 11        Date To Convert
     C                     PARM '*CYMD'   WQ0003  8        Date From Forma
     C                     PARM '*YYMD'   WQ0004  8        Date To Format
     C                     PARM '*NONE'   WQ0005  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    WN0059           AS Label Date Y
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Load AS file fields
      *================================================================
     C                     MOVEL*BLANK    WN0055           AS Order Number
     C                     MOVELWKC4NB    WN0055           AS Order Number
     C           WKHGCD    MULT 1         WUTSNB           Calc 5
     C                     MOVELWUTSNB    WN0056           AS Product Code
     C           WKCCQT    MULT 1         WUTRNB           Calc 4
     C                     MOVELWUTRNB    WN0057           AS Quantity
      * RTV First Comment Line RT - OP Order Detail Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWKAIC3    WL0001           Company Number
     C                     Z-ADDWKC4NB    WL0002           Order Number
     C                     Z-ADDWKDPNB    WL0003           Order Sequence
     C                     Z-ADDWKUENB    WL0004           Order Secondary
     C                     EXSR SQRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0058    P      Comment Text
      * CLC Oldest Label Dt    IF
      * This internal function will return the 'Oldest Label Date' to it'
      * calling function based on the input 'Age Code' and 'Scheduled Shi
      * Date'.
      * 04/10/07 Effective 04/23/07 representation of Age Code changes
      *          will be such that Age Code A will be 0 day for boxes
      *          and combos.  The labels on the cartons will not print
      *          a date that is offset by Sunday or Holiday.  Instead of
      *          Code Date, it will be the Pack Date.
      * CASE: PAR.Age Code is A: 0 Day
     C           WKRPCD    IFEQ 'A'                        *IF
     C                     Z-ADDWKAODT    YL0001           Date - ATR
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is B: 1 Day
     C           WKRPCD    IFEQ 'B'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-1 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-1        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is C: 2 Day
     C           WKRPCD    IFEQ 'C'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-2 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-2        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is D: 3 Day
     C           WKRPCD    IFEQ 'D'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-3 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-3        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is E: 4 Day
     C           WKRPCD    IFEQ 'E'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-4 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-4        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is F: 5 Day
     C           WKRPCD    IFEQ 'F'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-5 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-5        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.Age Code is G: 6 Day
     C           WKRPCD    IFEQ 'G'                        *IF
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-6 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-6        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Age Code is H: 7 Days to 119 Days
      *   |- c2    : PAR.Age Code is I: 120 Days +
      *   '-
     C           WKRPCD    IFEQ 'H'                        *IF
     C           WKRPCD    OREQ 'I'                        *OR
      * RMC 9/12/06 PFS019 90 days chgd to 120 days
      * PAR.Date - ATR = PAR.Scheduled Ship Date USR + CON.-7 *DAYS
     C           WKAODT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-7        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     YL0001
     C                     ELSE
     C           XDINDT    SUB  1000000   YL0001
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     MOVEL*BLANK    YL0002           Date (Alpha) US
     C                     MOVELYL0001    YL0002           Date (Alpha) US
     C                     MOVEL*BLANK    YL0003           Date From Conve
     C                     MOVELYL0002    YL0003           Date From Conve
      * Cvt Date              UP - /UT Functions  * 
     C                     CALL 'POD5UPR'              90  Cvt Date
     C                     PARM YL0003    WQ0006 10        Date From Conve
     C           YL0004    PARM *BLANK    WQ0007 11        Date To Convert
     C                     PARM '*CYMD'   WQ0008  8        Date From Forma
     C                     PARM '*YYMD'   WQ0009  8        Date To Format
     C                     PARM '*NONE'   WQ0010  7        Date Separator
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POD5UPR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVELYL0004    WN0059           AS Label Date Y
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WARUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WARVNB           Stop/Drop
     C                     Z-ADD*ZERO     WARWNB           Miles to next s
     C                     Z-ADD*ZERO     WARXNB           Freight Charge
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WAT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAC4NB           Order Number
     C                     Z-ADD*ZERO     WAKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAKFDT           Appointment Con
     C                     Z-ADD*ZERO     WAACTM           Appointment Con
     C                     Z-ADD*ZERO     WAEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WAAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WAHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAZ4NB           MPC Number
     C                     Z-ADD*ZERO     WAN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WAN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WAN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WAB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WAB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WAB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDK4DT           Created Date
     C                     Z-ADD*ZERO     WDA1TM           Created Time
     C                     Z-ADD*ZERO     WDDXNB           Sequence Number
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFRMNB           Load ID
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WFRPNB           Total Load Orde
     C                     Z-ADD*ZERO     WFFLAM           Flat Amount
     C                     Z-ADD*ZERO     WFRRNB           Total Stops
     C                     Z-ADD*ZERO     WFSBNB           BOL Time
     C                     Z-ADD*ZERO     WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WFR1NB           Rated Freight
     C                     Z-ADD*ZERO     WFSDNB           Number Pallets
     C                     Z-ADD*ZERO     WFPAOU           Number Pallets
     C                     Z-ADD*ZERO     WFDGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WFSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WFHADT           Actual Arrival
     C                     Z-ADD*ZERO     WFAART           Actual Arrival
     C                     Z-ADD*ZERO     WFDHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WFDIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WFAQDT           Actual Departur
     C                     Z-ADD*ZERO     WFS6NB           Departure Time
     C                     Z-ADD*ZERO     WFT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WFPRTM           Product Tempera
     C                     Z-ADD*ZERO     WFNPSV           Number Pallets
     C                     Z-ADD*ZERO     WFTLMI           Total Load Mile
     C                     Z-ADD*ZERO     WFGRWE           Gross Weight
     C                     Z-ADD*ZERO     WFF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WFJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WFTRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WFJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WFSPTM           Spotted Time
     C                     Z-ADD*ZERO     WFJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WFLFTM           Load Finished T
     C                     Z-ADD*ZERO     WFJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WFBOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WFJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WFBLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WFKIDT           Truck Departure
     C                     Z-ADD*ZERO     WFASTM           Truck Departure
     C                     Z-ADD*ZERO     WFKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WFAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WFVOAG           Voyage
     C                     Z-ADD*ZERO     WFKBDT           Sail Date
     C                     Z-ADD*ZERO     WFEFDT           Arrival Date
     C                     Z-ADD*ZERO     WFKCDT           Date In
     C                     Z-ADD*ZERO     WFTMIN           Time In
     C                     Z-ADD*ZERO     WFKDDT           Date Out
     C                     Z-ADD*ZERO     WFVMNB           Time Out
     C                     Z-ADD*ZERO     WFOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WFKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WFATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WFBRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WFEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WFKKDT           On Yard Date
     C                     Z-ADD*ZERO     WFAVTM           On Yard Time
     C                     Z-ADD*ZERO     WFKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WFAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WFLLDT           Express Mail Da
     C                     Z-ADD*ZERO     WFK0DT           Product Complet
     C                     Z-ADD*ZERO     WFAYTM           Product Complet
     C                     Z-ADD*ZERO     WFKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WFICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WFIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WFK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WFAZTM           Load Door 1
     C                     Z-ADD*ZERO     WFK2DT           Override Total
     C                     Z-ADD*ZERO     WFA0TM           Load Door 2
     C                     Z-ADD*ZERO     WFZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WFPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WFCKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WFPZDT           LH Unused Date
     C                     Z-ADD*ZERO     WFCLTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP0DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCMTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP1DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCNTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCOTM           LH Unused Time
     C                     Z-ADD*ZERO     WFP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WFCQTM           LH Unused Time
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field BLANK
     C                     MOVEL*BLANK    WUGSTX256
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGSPPN           Port Phone Numb
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Define work field Hours  2A            USR
     C                     MOVEL*BLANK    WUVDCD  2
      * Define work field Minutes  2A          USR
     C                     MOVEL*BLANK    WUVECD  2
      * Define work field Hours HH:  3A
     C                     MOVEL*BLANK    WUVFCD  3
      * Define work field Record Status
     C                     MOVEL*BLANK    WUVSST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHEZNB           Telephone Numbe
     C                     Z-ADD*ZERO     WHEEDT           Carrier Last Us
     C                     Z-ADD*ZERO     WHNRVA           Pallet Balance
     C                     Z-ADD*ZERO     WHNSVA           Long hook balan
     C                     Z-ADD*ZERO     WHNTVA           Short hook bala
     C                     Z-ADD*ZERO     WHNUVA           Tub Balance
     C                     Z-ADD*ZERO     WHS8NB           Home Phone
     C                     Z-ADD*ZERO     WHS9NB           Other Phone
     C                     Z-ADD*ZERO     WHNMVA           Flat Rate
     C                     Z-ADD*ZERO     WHNOVA           Rate Per Pound
     C                     Z-ADD*ZERO     WHNPVA           Unused Rate Per
     C                     Z-ADD*ZERO     WHNQVA           Miscellaneous C
     C                     Z-ADD*ZERO     WHQXNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WHQ1NB           Unused Mile Ran
     C                     Z-ADD*ZERO     WHMRNG           Unused Mile Ran
     C                     Z-ADD*ZERO     WHMRNE           Unused Mile Ran
     C                     Z-ADD*ZERO     WHRFNB           Unused Mile Ran
     C                     Z-ADD*ZERO     WHMREG           Unused Mile Ran
     C                     Z-ADD*ZERO     WHBQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WHBRPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WHBSPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WHBTPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WHBUPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WHBVPR           Unused Mile Rat
     C                     Z-ADD*ZERO     WHDJWG           Unused Weight R
     C                     Z-ADD*ZERO     WHDKWG           Unused Weight R
     C                     Z-ADD*ZERO     WHDLWG           Unused Weight R
     C                     Z-ADD*ZERO     WHDMWG           Unused Weight R
     C                     Z-ADD*ZERO     WHDNWG           Unused Weight R
     C                     Z-ADD*ZERO     WHDOWG           Unused Weight R
     C                     Z-ADD*ZERO     WHB2PR           Unused Weight R
     C                     Z-ADD*ZERO     WHB3PR           Unused Weight R
     C                     Z-ADD*ZERO     WHB4PR           Unused Weight R
     C                     Z-ADD*ZERO     WHB5PR           Unused Weight R
     C                     Z-ADD*ZERO     WHB6PR           Unused Weight R
     C                     Z-ADD*ZERO     WHB7PR           Unused Weight R
     C                     Z-ADD*ZERO     WHAAC7           Contact Number
     C                     Z-ADD*ZERO     WHTENO           Carrier Unused
     C                     Z-ADD*ZERO     WHAOFC           Amount of Cargo
     C                     Z-ADD*ZERO     WHAOLI           Amount of Liabi
     C                     Z-ADD*ZERO     WHKHDT           Date of Expirat
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Calc 2
     C                     Z-ADD*ZERO     WUTPNB  20
      * Define work field Telephone Number FF
     C                     MOVEL*BLANK    WUBVTX 25
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WIP3NB           D & B Number
     C                     Z-ADD*ZERO     WII6DT           Date of D & B R
     C                     Z-ADD*ZERO     WIAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WIANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WIBTC7           Parent Customer
     C                     Z-ADD*ZERO     WIS2NB           Parent Credit L
     C                     Z-ADD*ZERO     WIVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WII7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDXNB           Sequence Number
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Define work field USR Counter
     C                     Z-ADD*ZERO     WUWQNB  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDPNB           Order Sequence
     C                     Z-ADD*ZERO     WKUENB           Order Secondary
     C                     Z-ADD*ZERO     WKHGCD           Item Code
     C                     Z-ADD*ZERO     WKBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WKCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WKMAVA           Billing Detail
     C                     Z-ADD*ZERO     WKKDVA           Billing Detail
     C                     Z-ADD*ZERO     WKL8VA           Billing Detail
     C                     Z-ADD*ZERO     WKL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WKAYVA           Extended Amount
     C                     Z-ADD*ZERO     WKEXDT           Market Pricing
     C                     Z-ADD*ZERO     WKBZPR           Price Overage O
     C                     Z-ADD*ZERO     WKL6NB           Contract Number
     C                     Z-ADD*ZERO     WKGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WKR1NB           Rated Freight
     C                     Z-ADD*ZERO     WKAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WKD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WKCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WKAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WKCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WKATWG           Weight Shipped
     C                     Z-ADD*ZERO     WKAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WKAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WKAKPR           Unit Price
     C                     Z-ADD*ZERO     WKALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WKAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WKAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WKA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WKA5DT           Requested Ship
     C                     Z-ADD*ZERO     WKAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WKGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WKRGNB           Item Structure
     C                     Z-ADD*ZERO     WKRHNB           Item Structure
     C                     Z-ADD*ZERO     WKRINB           Item Structure
     C                     Z-ADD*ZERO     WKCXDT           Date of Origina
     C                     Z-ADD*ZERO     WKDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WKB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WKA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WKNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WKNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WKNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WKNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WKNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WKBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WKBVTM           Price Code
     C                     Z-ADD*ZERO     WKBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WKBXTM           Substitution Li
     C                     Z-ADD*ZERO     WKBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WKH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WKH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WKH7NX           OD Item Target
     C                     Z-ADD*ZERO     WKH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WKH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WKDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WKDWPR           OD Base MKT Ovr
     C                     Z-ADD*ZERO     WKDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WKDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WKDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WKGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WKGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WKGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WKPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WKRINY           Delv Ageing Day
     C                     Z-ADD*ZERO     WKTIDT           Production Ovr
     C                     Z-ADD*ZERO     WKTJDT           Production Ovr
     C                     Z-ADD*ZERO     WKTKDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WKTLDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WKTMDT           OD UnUsed Date
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
      * Define work field Calc 5
     C                     Z-ADD*ZERO     WUTSNB  50
      * Define work field Calc 4
     C                     Z-ADD*ZERO     WUTRNB  40
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOC4NB           Order Number
     C                     Z-ADD*ZERO     WODPNB           Order Sequence
     C                     Z-ADD*ZERO     WOUENB           Order Secondary
     C                     Z-ADD*ZERO     WODXNB           Sequence Number
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  30
     C                     MOVEL*BLANK    WL0005 30
      * Define local variables for subroutine SRCRRC.
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  7
     C                     MOVEL*BLANK    WL0008  5
     C                     MOVEL*BLANK    WL0009  4
     C                     MOVEL*BLANK    WL0010 50
     C                     MOVEL*BLANK    WL0011  1
     C                     MOVEL*BLANK    WL0012  8
      * Define local work field Date - ATR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0002  7
      * Define local work field Date From Convert USR
     C                     MOVEL*BLANK    YL0003 10
      * Define local work field Date To Convert USR
     C                     MOVEL*BLANK    YL0004 11
      *================================================================
     CSR         ZZEXIT    ENDSR
