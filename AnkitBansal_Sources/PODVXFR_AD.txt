// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PODVXFR
// ?Date: 14.08.2025 Time: 03:36:49
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(RTV for Tlx Fax        RT) TYPE(RTVOBJ) FILE(PDJ4CPP)          AC1596114;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Job_Name_CDE);
PARAMETER(PAR.Cover_Sheet_Name);
PARAMETER(PAR.Use_Credit_Contact_Info);
PARAMETER(LCL.Ship_To_Customer);
{
 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 CASE;

 // IF DB1.Job Name CDE EQ PAR.Job Name CDE
 IF DB1.Job_Name_CDE = PAR.Job_Name_CDE;

 //?062507 slm
 //?Std Invoice Record will be use on Std Invoice and Custom Invoice
 //?Department is INVCUST
 //?Add invoice customer fax report
 // Call program RTV CDD for Overlays   XF.
 CALL PROGRAM(RTV CDD for Overlays   XF) ('PMG9XFR');
 PARAMETER(DB1.Company_Number);
 PARAMETER('IN');
 PARAMETER('INCFX1');
 PARAMETER(NLL.CDD_Name_of_Overlay);
 PARAMETER(LCL.CDD_Program_Name);
 PARAMETER(NLL.CDD_Printer_File_Name);
 PARAMETER(NLL.CDD_Additional_Object);
 PARAMETER(NLL.CDD_Sender_Phone);
 PARAMETER(NLL.CDD_Sender_Fax);
 PARAMETER(NLL.Output_Queue);
 PARAMETER(NLL.Hold_File);
 PARAMETER(NLL.Save_File);
 PARAMETER(NLL.Source_Drawer);
 PARAMETER(NLL.Printer_Device_Type);
 PARAMETER(NLL.Page_Length_2);
 PARAMETER(NLL.Page_Width_2);
 PARAMETER(NLL.Page_LPI);
 PARAMETER(NLL.Page_CPI);
 PARAMETER(NLL.Page_Overflow);
 PARAMETER(NLL.Page_Rotation);
 PARAMETER(NLL.CDD_Comment_1);
 PARAMETER(NLL.CDD_Comment_2);
 PARAMETER(NLL.CDD_Comment_3);
 PARAMETER(NLL.CDD_Comment_4);
 PARAMETER(NLL.CDD_Comment_5);
 PARAMETER(NLL.Record_Status);

 //?Standard Faxing or Custom Faxing program
 CASE;

 // IF LCL.CDD Program Name is Not entered
 IF LCL.CDD_Program_Name = *BLANK;

 //?ship to customer on this file is really A/R Customer.
 // PAR.Ship To Customer = DB1.Ship To Customer
 PAR.Ship_To_Customer = DB1.Ship_To_Customer;

 // Call program PRT Inv/Fast Fax 6LPI  PF.
 CALL PROGRAM(PRT Inv/Fast Fax 6LPI  PF) ('PDVGPFR');
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(PAR.AR_Customer_Number);
 PARAMETER(WRK.Printed_Status);
 PARAMETER(*MISSING);
 PARAMETER(PAR.Job_Name_CDE);

 //?Standard Faxing or Custom Faxing program
 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Ship To Customer = DB1.Ship To Customer
 PAR.Ship_To_Customer = DB1.Ship_To_Customer;

 // Call program Zzz Inv/Fast Fax 8LPIDLPF.
 CALL PROGRAM(Zzz Inv/Fast Fax 8LPIDLPF) ('PMJHPFR');
 PARAMETER(PAR.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(PAR.AR_Customer_Number);
 PARAMETER(WRK.Printed_Status);
 PARAMETER(PAR.Job_Name_CDE);

 ENDIF;

 ENDIF;

}


CASE;

// IF PAR.Use Credit Contact Info is yes
IF PAR.Use_Credit_Contact_Info = 'Y';

EXECUTE FUNCTION(RTV Contact Info.      RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC1356453;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Ship_To_Customer);
PARAMETER(PAR.Credit_Contact_Name);
PARAMETER(NLL.Credit_Contact_Telephone);
PARAMETER(NLL.Credit_Contact_Bus_Title);
PARAMETER(PAR.Credit_Contact_Fax_Number);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(RTV Fax Number,Contact RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC1470252;
PARAMETER(PAR.Company_Number);
PARAMETER(LCL.Ship_To_Customer);
PARAMETER(PAR.Credit_Contact_Fax_Number);
PARAMETER(PAR.Credit_Contact_Name);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


ENDIF;

CASE;

// IF PGM.*Return code is *Record does not exist
IF PGM.*Return_code = 'Y2U0005';

// IF *OTHERWISE
IF *OTHERWISE;

//?** Result field has been change to 25 to accommodate international fax
// PAR.Fax Area Code = SUBSTRING(PAR.Credit Contact Fax Number,CON.1,CON.3)
PAR.Fax_Area_Code = SUBSTRING(PAR.Credit_Contact_Fax_Number:1:3);

// PAR.Fax Phone Number = SUBSTRING(PAR.Credit Contact Fax Number,CON.4,CON.21)
PAR.Fax_Phone_Number = SUBSTRING(PAR.Credit_Contact_Fax_Number:4:21);

// Call program Zzz Fax Invoice TLX    UP.
CALL PROGRAM(Zzz Fax Invoice TLX    UP) ('PODTUPC');
PARAMETER(PGM.*Return_code);
PARAMETER('PODTPCLP');
PARAMETER('OMS');
PARAMETER('Fax Invoice');
PARAMETER(LCL.Company_Number_Pass_USR);
PARAMETER(LCL.Customer_Number_Pass_USR);
PARAMETER(*ZERO);
PARAMETER(WRK.USR_Active_Flag);
PARAMETER(WRK.PRT_Night_Queue_USR);
PARAMETER(WRK.Job_Name_CDE);
PARAMETER(WRK.Cover_Sheet_Name);
PARAMETER(PAR.Use_Credit_Contact_Info);
PARAMETER(WRK.Credit_Contact_Name);
PARAMETER(WRK.Fax_Area_Code);
PARAMETER(WRK.Fax_Phone_Number);

ENDIF;

//?***** Change Log and comments
DO;

//?*****
//?** 05/16/2006 LJB T00008
//?** Result field for the fax number has been changed to 25 char
//?** to accommodate international fax phone numbers.
//?*****
ENDDO;

