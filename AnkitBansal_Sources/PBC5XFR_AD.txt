// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBC5XFR
// ?Date: 14.08.2025 Time: 03:47:29
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?* one time conversion program
EXECUTE FUNCTION(RTV/Cnv Assoc File Sts RT) TYPE(RTVOBJ) FILE(CABBREP)          AC2041020;
{
 //?USER: Process Data record

 //?** If Company/Customer record exists, set status to match Customer
 DO;

 //?** If Ship To record exists, set to match Customer
 EXECUTE FUNCTION(Val Customer exists    RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC2041333;
 PARAMETER(DB1.Ship_To_Customer);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

 }

 //?** Update CoCust status
 CASE;

 // IF PGM.*Return code is *Record already exists
 IF PGM.*Return_code = 'Y2U0003';

 //?** Updates Ship To for all companies in the library
 EXECUTE FUNCTION(RTV/UPD Co Cust Status RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC2042208;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  //?USER: Process Data record

  CASE;

  // IF DB1.Record Status NE PAR.Record Status
  IF DB1.Record_Status <> PAR.Record_Status;

  EXECUTE FUNCTION(Chg Co Cust Status    CH) TYPE(CHGOBJ) FILE(CAEOREP)           AC2041021;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Terms_Code);
  PARAMETER(DB1.Sales_Route_Code);
  PARAMETER(DB1.Special_Instructions_2);
  PARAMETER(DB1.Special_Instructions);
  PARAMETER(DB1.Carrier_Code);
  PARAMETER(DB1.Broker);
  PARAMETER(DB1.P_O_Required_Flag);
  PARAMETER(DB1.Deliver_after_time);
  PARAMETER(DB1.Deliver_before_time);
  PARAMETER(DB1.Alt_Remittance_Flag);
  PARAMETER(DB1.Type_Code);
  PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
  PARAMETER(DB1.Mileage_To_Customer);
  PARAMETER(DB1.Co_Cust_Overage_Rate_CWT);
  PARAMETER(DB1.Age_Code);
  PARAMETER(DB1.Warehouse_Code);
  PARAMETER(DB1.Outside_Warehouse_Flag);
  PARAMETER(DB1.Customer_Group_Code);
  PARAMETER(DB1.Customer_Group_Code_2);
  PARAMETER(DB1.G_L_Code);
  PARAMETER(DB1.Commodity_Market_Code);
  PARAMETER(DB1.Credit_Contact_Name);
  PARAMETER(DB1.Credit_Contact_Telephone);
  PARAMETER(DB1.Credit_Contact_Bus_Title);
  PARAMETER(DB1.Credit_Contact_Fax_Number);
  PARAMETER(DB1.Allow_Man_Qt_WO_Approval);
  PARAMETER(DB1.Fax_Invoice_Flag);
  PARAMETER(DB1.Fax_Invoice_Fax_Number);
  PARAMETER(DB1.Fax_Invoice_Contact_Name);
  PARAMETER(DB1.Distributor);
  PARAMETER(DB1.Default_Shipping_Co_Sts);
  PARAMETER(DB1.Ord_Ent_Default_Sls_Rte);
  PARAMETER(DB1.Bypass_DDt_Delay_w_Invcng);
  PARAMETER(DB1.EDI_Status_1);
  PARAMETER(DB1.EDI_Status_2);
  PARAMETER(DB1.EDI_Status_3);
  PARAMETER(PAR.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?USER: Processing if Data record not found

   //?Not an error if no record
   // PGM.*Return code = CND.*Normal
   PGM.*Return_code = *BLANK;

   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

 }

 ENDIF;

 ENDDO;

 //?** If Customer EXT exists, set record status to match customer
 DO;

 //?** If Ship To record exists, set status to match Customer
 EXECUTE FUNCTION(Val Cust in Custom EXT RT) TYPE(RTVOBJ) FILE(PDNEREP)          AC2031831;
 PARAMETER(DB1.Ship_To_Customer);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

 }

 //?** Update Cust EXT status to match Customer status
 CASE;

 // IF PGM.*Return code is *Record already exists
 IF PGM.*Return_code = 'Y2U0003';

 EXECUTE FUNCTION(RTV Upd Cust Status   RT) TYPE(RTVOBJ) FILE(PDNEREP)           AC2041577;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  //?USER: Process Data record

  CASE;

  // IF PAR.Record Status NE DB1.Record Status
  IF PAR.Record_Status <> DB1.Record_Status;

  EXECUTE FUNCTION(Chg Cust EXT Rec Sts  CH) TYPE(CHGOBJ) FILE(PDNEREP)           AC2041019;
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Internet_Password);
  PARAMETER(DB1.Email_Address);
  PARAMETER(DB1.Email_User_ID);
  PARAMETER(DB1.EDI_Trading_Partner_No);
  PARAMETER(DB1.EDI_Cust_Duns_Number);
  PARAMETER(DB1.EDI_Warehouse_Store_No);
  PARAMETER(DB1.State_Tax_ID);
  PARAMETER(DB1.Cust_Shipping_Temp_C_F);
  PARAMETER(DB1.One_Invoice_Per_PO);
  PARAMETER(DB1.EDI_Advanced_Ship_Notice);
  PARAMETER(DB1.Customer_G_L_Vendor_Num);
  PARAMETER(DB1.Air_Freight_Orders);
  PARAMETER(DB1.Regional_Mgr_Fax_Email);
  PARAMETER(DB1.Employee_Co_Packer_Sale);
  PARAMETER(DB1.Customer_TF_Exempt_Code);
  PARAMETER(DB1.Customer_Watch_Flag);
  PARAMETER(DB1.Customer_Sales_Region);
  PARAMETER(DB1.Customer_Market_Code);
  PARAMETER(DB1.EDI_Status_1);
  PARAMETER(DB1.EDI_Status_2);
  PARAMETER(DB1.EDI_Status_3);
  PARAMETER(PAR.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

 }

 ENDIF;

 ENDDO;

 //?** If Co Customer Item record exists, set status to match Customer
 DO;

 //?** If Ship To record exists, set to match Customer
 EXECUTE FUNCTION(Val Customer exists    RT) TYPE(RTVOBJ) FILE(PDISREP)          AC2041349;
 PARAMETER(DB1.Ship_To_Customer);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

 }

 //?** Update Co Customer Item record
 CASE;

 // IF PGM.*Return code is *Record already exists
 IF PGM.*Return_code = 'Y2U0003';

 //?** Updates Ship To for all companies in the library
 EXECUTE FUNCTION(RTV/Upd Cust Item Sts  RT) TYPE(RTVOBJ) FILE(PDISREP)          AC2042210;
 PARAMETER(1);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(*ZERO);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  //?USER: Process Data record

  CASE;

  // IF DB1.Record Status NE PAR.Record Status
  IF DB1.Record_Status <> PAR.Record_Status;

  EXECUTE FUNCTION(CHG CoCust Item Status CH) TYPE(CHGOBJ) FILE(PDISREP)          AC2041041;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.Overage_Begin_Date);
  PARAMETER(DB1.Overage_End_Date);
  PARAMETER(DB1.Seasonal_Overage);
  PARAMETER(DB1.Market_Overage);
  PARAMETER(DB1.Formula_Differential);
  PARAMETER(DB1.Formula_Processing_Fee);
  PARAMETER(DB1.Commodity_Market_Code);
  PARAMETER(DB1.EDI_Status_1);
  PARAMETER(DB1.EDI_Status_2);
  PARAMETER(DB1.EDI_Status_3);
  PARAMETER(PAR.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?USER: Processing after Data read

   MOVE *ALL (To: DB1 From: PAR);

   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

 }

 ENDIF;

 ENDDO;

 //?** If Customer Freight Rate exists, set RecSts to match customer
 DO;

 //?** If Ship To record exists, set status to match Customer
 EXECUTE FUNCTION(VAL Cust Frt Rt Exists RT) TYPE(RTVOBJ) FILE(PNGKREP)          AC2041242;
 PARAMETER(DB1.Ship_To_Customer);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

 }

 //?** Update Customer Freight Rate status to match Customer status
 CASE;

 // IF PGM.*Return code is *Record already exists
 IF PGM.*Return_code = 'Y2U0003';

 EXECUTE FUNCTION(RTV/UPD Cst Frt Rt Sts RT) TYPE(RTVOBJ) FILE(PNGKREP)          AC2041061;
 PARAMETER(1);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

  //?USER: Process Data record

  CASE;

  // IF DB1.Record Status NE PAR.Record Status
  IF DB1.Record_Status <> PAR.Record_Status;

  EXECUTE FUNCTION(CHG Cust Frt Rate Sts  CH) TYPE(CHGOBJ) FILE(PNGKREP)          AC2041056;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Change_Date);
  PARAMETER(DB1.Change_Time);
  PARAMETER(DB1.Absorbed_Freight_Rate_CWT);
  PARAMETER(PAR.Record_Status);
  PARAMETER(DB1.Job_Time);
  PARAMETER(DB1.User_Id);
  PARAMETER(DB1.Job_Name);
  PARAMETER(DB1.Job_Date);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Date/Time Stamp   IF) TYPE(EXCINTFUN)                      AC1142219;
   PARAMETER(DB1.Job_Time);
   PARAMETER(DB1.User_Id);
   PARAMETER(DB1.Job_Name);
   PARAMETER(DB1.Job_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*JOB
    PAR.Job_Name = JOB.*JOB;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

 }

 ENDIF;

 ENDDO;

 //?** If Customer Item Reference exists, set RecSts to match customer
 DO;

 //?** If Ship To record exists, set status to match Customer
 EXECUTE FUNCTION(VAL Cust Item Ref Exis RT) TYPE(RTVOBJ) FILE(POBIREP)          AC2041243;
 PARAMETER(DB1.Ship_To_Customer);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  // PGM.*Return code = CND.*Record already exists
  PGM.*Return_code = 'Y2U0003';

 }

 //?** Update Customer Item Reference status to match Customer status
 CASE;

 // IF PGM.*Return code is *Record already exists
 IF PGM.*Return_code = 'Y2U0003';

 EXECUTE FUNCTION(RTV/UPD CIR Status    RT) TYPE(RTVOBJ) FILE(POBIREP)           AC2041245;
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(1);
 PARAMETER(DB1.Record_Status);
 {
  //?USER: Process Data record

  CASE;

  // IF DB1.Record Status NE PAR.Record Status
  IF DB1.Record_Status <> PAR.Record_Status;

  EXECUTE FUNCTION(CHG Cust Itm Ref Sts  CH) TYPE(CHGOBJ) FILE(POBIREP)           AC2041244;
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.CIR_Resource_No);
  PARAMETER(DB1.CIR_Item_No);
  PARAMETER(DB1.CIR_Description_Line_1);
  PARAMETER(DB1.CIR_Description_Line_2);
  PARAMETER(DB1.CIR_Description_Line_3);
  PARAMETER(DB1.CIR_Unused_Status_1);
  PARAMETER(DB1.CIR_Unused_Status_2);
  PARAMETER(DB1.CIR_Resource_No_Type);
  PARAMETER(DB1.CIR_UM_Base_Price);
  PARAMETER(DB1.CIR_Unused_Status_5);
  PARAMETER(PAR.Record_Status);
  PARAMETER(DB1.Create_Date);
  PARAMETER(DB1.Create_Time);
  PARAMETER(DB1.Create_User);
  PARAMETER(DB1.Create_Program);
  PARAMETER(DB1.Change_Date);
  PARAMETER(DB1.Change_Time);
  PARAMETER(DB1.Change_User);
  PARAMETER(DB1.Change_Program);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Set Record Stamp CHGOB IF) TYPE(EXCINTFUN)                     AC1283156;
   PARAMETER(DB1.Change_Time);
   PARAMETER(DB1.Change_User);
   PARAMETER(DB1.Change_Program);
   PARAMETER(DB1.Change_Date);
   {
    //?Execute internal function

    // PAR.Job Time = JOB.*Job time
    PAR.Job_Time = JOB.*Job_time;

    // PAR.User Id = JOB.*USER
    PAR.User_Id = JOB.*USER;

    // PAR.Job Name = JOB.*PROGRAM
    PAR.Job_Name = JOB.*PROGRAM;

    // PAR.Job Date = JOB.*Job date
    PAR.Job_Date = JOB.*Job_date;

   }

  }

  ENDIF;

 }

 ENDIF;

 ENDDO;

}


