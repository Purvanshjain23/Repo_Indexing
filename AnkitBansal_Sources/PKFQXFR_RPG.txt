     H/TITLE Clc D/A for Subj AfPd XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:28:46
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKCDCPL3IF  E           K        DISK
      * RSQ : Tattoo Ded/Add            By Ded (-) Prd's
      *
     FPKCDCPL4IF  E           K        DISK
      * RSQ : Tattoo Ded/Add            By Add (+) Prd's
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKCDCPL8IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Rtv Index - Seab's
      *
     FPKCDCPL0UF  E           K        DISK                      A
      * UPD : Tattoo Ded/Add            Update index
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WAHMNB
     I              CDBNNB                          WABNNB
     I              CDBONB                          WABONB
     I              CDCVNB                          WACVNB
     I              CDB0DT                          WAB0DT
     I              CDBQCD                          WABQCD
     I              CDAZVA                          WAAZVA
     I              CDA0VA                          WAA0VA
     I              CDJBST                          WAJBST
     I              CDEIST                          WAEIST
     I              CDJDST                          WAJDST
     I              CDDPCD                          WADPCD
     I              CDE3CD                          WAE3CD
     I              CDAQNB                          WAAQNB
     I              CDOCST                          WAOCST
     I              CDPEST                          WAPEST
     I              CDPFST                          WAPFST
     I              CDPGST                          WAPGST
     I              CDPIST                          WAPIST
     I              CDPJST                          WAPJST
     I              CDPKST                          WAPKST
     I              CDPLST                          WAPLST
     I              CDAAVN                          WAAAVN
     I              CDAADT                          WAAADT
     I              CDAMTM                          WAAMTM
     I              CDAJST                          WAAJST
     I              CDAHVN                          WAAHVN
     I              CDAGVN                          WAAGVN
     I              CDABVN                          WAABVN
     I              CDABDT                          WAABDT
     I              CDABTM                          WAABTM
      *
     I@CDCPT8
      * Tattoo Ded/Add            By Ded (-) Prd's
      * Renamed input format fields
     I              CDHMNB                          WBHMNB
     I              CDBNNB                          WBBNNB
     I              CDBONB                          WBBONB
     I              CDCVNB                          WBCVNB
     I              CDB0DT                          WBB0DT
     I              CDBQCD                          WBBQCD
     I              CDAZVA                          WBAZVA
     I              CDA0VA                          WBA0VA
     I              CDJBST                          WBJBST
     I              CDEIST                          WBEIST
     I              CDJDST                          WBJDST
     I              CDDPCD                          WBDPCD
     I              CDE3CD                          WBE3CD
     I              CDAQNB                          WBAQNB
     I              CDOCST                          WBOCST
     I              CDPEST                          WBPEST
     I              CDPFST                          WBPFST
     I              CDPGST                          WBPGST
     I              CDPIST                          WBPIST
     I              CDPJST                          WBPJST
     I              CDPKST                          WBPKST
     I              CDPLST                          WBPLST
     I              CDAAVN                          WBAAVN
     I              CDAADT                          WBAADT
     I              CDAMTM                          WBAMTM
     I              CDAJST                          WBAJST
     I              CDAHVN                          WBAHVN
     I              CDAGVN                          WBAGVN
     I              CDABVN                          WBABVN
     I              CDABDT                          WBABDT
     I              CDABTM                          WBABTM
      *
     I@CDCPIT
      * Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WCHMNB
     I              CDBNNB                          WCBNNB
     I              CDBONB                          WCBONB
     I              CDCVNB                          WCCVNB
     I              CDB0DT                          WCB0DT
     I              CDBQCD                          WCBQCD
     I              CDAZVA                          WCAZVA
     I              CDA0VA                          WCA0VA
     I              CDJBST                          WCJBST
     I              CDEIST                          WCEIST
     I              CDJDST                          WCJDST
     I              CDDPCD                          WCDPCD
     I              CDE3CD                          WCE3CD
     I              CDAQNB                          WCAQNB
     I              CDOCST                          WCOCST
     I              CDPEST                          WCPEST
     I              CDPFST                          WCPFST
     I              CDPGST                          WCPGST
     I              CDPIST                          WCPIST
     I              CDPJST                          WCPJST
     I              CDPKST                          WCPKST
     I              CDPLST                          WCPLST
     I              CDAAVN                          WCAAVN
     I              CDAADT                          WCAADT
     I              CDAMTM                          WCAMTM
     I              CDAJST                          WCAJST
     I              CDAHVN                          WCAHVN
     I              CDAGVN                          WCAGVN
     I              CDABVN                          WCABVN
     I              CDABDT                          WCABDT
     I              CDABTM                          WCABTM
      *
     I@CDCPT9
      * Tattoo Ded/Add            By Add (+) Prd's
      * Renamed input format fields
     I              CDHMNB                          WDHMNB
     I              CDBNNB                          WDBNNB
     I              CDBONB                          WDBONB
     I              CDCVNB                          WDCVNB
     I              CDB0DT                          WDB0DT
     I              CDBQCD                          WDBQCD
     I              CDAZVA                          WDAZVA
     I              CDA0VA                          WDA0VA
     I              CDJBST                          WDJBST
     I              CDEIST                          WDEIST
     I              CDJDST                          WDJDST
     I              CDDPCD                          WDDPCD
     I              CDE3CD                          WDE3CD
     I              CDAQNB                          WDAQNB
     I              CDOCST                          WDOCST
     I              CDPEST                          WDPEST
     I              CDPFST                          WDPFST
     I              CDPGST                          WDPGST
     I              CDPIST                          WDPIST
     I              CDPJST                          WDPJST
     I              CDPKST                          WDPKST
     I              CDPLST                          WDPLST
     I              CDAAVN                          WDAAVN
     I              CDAADT                          WDAADT
     I              CDAMTM                          WDAMTM
     I              CDAJST                          WDAJST
     I              CDAHVN                          WDAHVN
     I              CDAGVN                          WDAGVN
     I              CDABVN                          WDABVN
     I              CDABDT                          WDABDT
     I              CDABTM                          WDABTM
      *
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WEHMNB
     I              A1BNNB                          WEBNNB
     I              A1BONB                          WEBONB
     I              A1CVNB                          WECVNB
     I              A1B0DT                          WEB0DT
     I              A1AWDT                          WEAWDT
     I              A1BICD                          WEBICD
     I              A1CPST                          WECPST
     I              A1ACPR                          WEACPR
     I              A1B9PR                          WEB9PR
     I              A1CAPR                          WECAPR
     I              A1C4ST                          WEC4ST
     I              A1AIPR                          WEAIPR
     I              A1A6DT                          WEA6DT
     I              A1C2ST                          WEC2ST
     I              A1CXNB                          WECXNB
     I              A1CWNB                          WECWNB
     I              A1FCNB                          WEFCNB
     I              A1H9NB                          WEH9NB
     I              A1FDNB                          WEFDNB
     I              A1FENB                          WEFENB
     I              A1HENB                          WEHENB
     I              A1HFNB                          WEHFNB
     I              A1CYNB                          WECYNB
     I              A1LRNB                          WELRNB
     I              A1E0NB                          WEE0NB
     I              A1A5PC                          WEA5PC
     I              A1FBNB                          WEFBNB
     I              A1A4PC                          WEA4PC
     I              A1F7NB                          WEF7NB
     I              A1HDNB                          WEHDNB
     I              A1F5NB                          WEF5NB
     I              A1F4NB                          WEF4NB
     I              A1F3NB                          WEF3NB
     I              A1F2NB                          WEF2NB
     I              A1AVPC                          WEAVPC
     I              A1AWPC                          WEAWPC
     I              A1CWPC                          WECWPC
     I              A1A8PC                          WEA8PC
     I              A1A7PC                          WEA7PC
     I              A1B8PR                          WEB8PR
     I              A1AMPR                          WEAMPR
     I              A1ANPR                          WEANPR
     I              A1AYVA                          WEAYVA
     I              A1AWVA                          WEAWVA
     I              A1AOPR                          WEAOPR
     I              A1AXVA                          WEAXVA
     I              A1APPR                          WEAPPR
     I              A1ASPR                          WEASPR
     I              A1A4VA                          WEA4VA
     I              A1ATPR                          WEATPR
     I              A1A5VA                          WEA5VA
     I              A1CBPR                          WECBPR
     I              A1CCPR                          WECCPR
     I              A1LPNB                          WELPNB
     I              A1CDPR                          WECDPR
     I              A1A7VA                          WEA7VA
     I              A1A2PR                          WEA2PR
     I              A1JWST                          WEJWST
     I              A1CWST                          WECWST
     I              A1D7ST                          WED7ST
     I              A1D8ST                          WED8ST
     I              A1DWST                          WEDWST
     I              A1D6ST                          WED6ST
     I              A1GHNB                          WEGHNB
     I              A1BYDT                          WEBYDT
     I              A1E0ST                          WEE0ST
     I              A1E1ST                          WEE1ST
     I              A1E2ST                          WEE2ST
     I              A1BSDT                          WEBSDT
     I              A1BTDT                          WEBTDT
     I              A1BUDT                          WEBUDT
     I              A1HGNB                          WEHGNB
     I              A1HHNB                          WEHHNB
     I              A1HINB                          WEHINB
     I              A1A3PR                          WEA3PR
     I              A1A4PR                          WEA4PR
     I              A1A6PR                          WEA6PR
     I              A1J9NB                          WEJ9NB
     I              A1D6PR                          WED6PR
     I              A1D7PR                          WED7PR
     I              A1D8PR                          WED8PR
     I              A1D9PR                          WED9PR
     I              A1EAPR                          WEEAPR
     I              A1EBPR                          WEEBPR
     I              A1ECPR                          WEECPR
     I              A1EDPR                          WEEDPR
     I              A1EEPR                          WEEEPR
     I              A1EFPR                          WEEFPR
     I              A1EGPR                          WEEGPR
     I              A1EHPR                          WEEHPR
     I              A1KAST                          WEKAST
     I              A1J7ST                          WEJ7ST
     I              A1J9ST                          WEJ9ST
     I              A1OXNB                          WEOXNB
     I              A1LKST                          WELKST
     I              A1LLST                          WELLST
     I              A1J8ST                          WEJ8ST
     I              A1LIST                          WELIST
     I              A1LJST                          WELJST
     I              A1NZTX                          WENZTX
     I              A1HJCD                          WEHJCD
     I              A1R4ST                          WER4ST
     I              A1R5ST                          WER5ST
     I              A1R6ST                          WER6ST
     I              A1R7ST                          WER7ST
     I              A1THWT                          WETHWT
     I              A1T2WT                          WET2WT
     I              A1THHD                          WETHHD
     I              A1T2HD                          WET2HD
     I              A1OBPR                          WEOBPR
     I              A1KOER                          WEKOER
     I              A1OPIR                          WEOPIR
     I              A1OPEM                          WEOPEM
     I              A1IORP                          WEIORP
     I              A1OWEO                          WEOWEO
     I              A1OQET                          WEOQET
     I              A1URST                          WEURST
     I              A1USST                          WEUSST
     I              A1HHPC                          WEHHPC
     I              A1S9PR                          WES9PR
     I              A1TAPR                          WETAPR
     I              A1TBPR                          WETBPR
     I              A1JFUR                          WEJFUR
     I              A1KRIF                          WEKRIF
     I              A1KORF                          WEKORF
     I              A1KAPR                          WEKAPR
     I              A1KROT                          WEKROT
     I              A1OTJG                          WEOTJG
     I              A1IRJG                          WEIRJG
     I              A1IMJF                          WEIMJF
     I              A1IRGF                          WEIRGF
     I              A1KRJF                          WEKRJF
     I              A1OJRF                          WEOJRF
     I              A1KFOR                          WEKFOR
     I              A1ORJK                          WEORJK
     I              A1OMVJ                          WEOMVJ
     I              A1MVNF                          WEMVNF
     I              A1MCNF                          WEMCNF
     I              A1NCNF                          WENCNF
     I              A1NCHF                          WENCHF
     I              A1IGIR                          WEIGIR
     I              A1KFJR                          WEKFJR
     I              A1EADT                          WEEADT
     I              A1EBDT                          WEEBDT
     I              A1ECDT                          WEECDT
     I              A1EDDT                          WEEDDT
     I              A1EEDT                          WEEEDT
     I              A1U4ST                          WEU4ST
     I              A1U5ST                          WEU5ST
     I              A1U6ST                          WEU6ST
     I              A1U7ST                          WEU7ST
     I              A1U8ST                          WEU8ST
     I              A1U9ST                          WEU9ST
     I              A1VAST                          WEVAST
     I              A1VBST                          WEVBST
     I              A1BDCD                          WEBDCD
     I              A1CSCD                          WECSCD
     I              A1ABCD                          WEABCD
     I              A1AECD                          WEAECD
     I              A1ACCD                          WEACCD
     I              A1AGCD                          WEAGCD
     I              A1BECD                          WEBECD
     I              A1AAVN                          WEAAVN
     I              A1AADT                          WEAADT
     I              A1AMTM                          WEAMTM
     I              A1AJST                          WEAJST
     I              A1AHVN                          WEAHVN
     I              A1AGVN                          WEAGVN
     I              A1ABVN                          WEABVN
     I              A1ABDT                          WEABDT
     I              A1ABTM                          WEABTM
      *
     I@CDCPWY
      * Tattoo Ded/Add            Rtv Index - Seab's
      * Renamed input format fields
     I              CDHMNB                          WFHMNB
     I              CDBNNB                          WFBNNB
     I              CDBONB                          WFBONB
     I              CDCVNB                          WFCVNB
     I              CDB0DT                          WFB0DT
     I              CDBQCD                          WFBQCD
     I              CDAZVA                          WFAZVA
     I              CDA0VA                          WFA0VA
     I              CDJBST                          WFJBST
     I              CDEIST                          WFEIST
     I              CDJDST                          WFJDST
     I              CDDPCD                          WFDPCD
     I              CDE3CD                          WFE3CD
     I              CDAQNB                          WFAQNB
     I              CDOCST                          WFOCST
     I              CDPEST                          WFPEST
     I              CDPFST                          WFPFST
     I              CDPGST                          WFPGST
     I              CDPIST                          WFPIST
     I              CDPJST                          WFPJST
     I              CDPKST                          WFPKST
     I              CDPLST                          WFPLST
     I              CDAAVN                          WFAAVN
     I              CDAADT                          WFAADT
     I              CDAMTM                          WFAMTM
     I              CDAJST                          WFAJST
     I              CDAHVN                          WFAHVN
     I              CDAGVN                          WFAGVN
     I              CDABVN                          WFABVN
     I              CDABDT                          WFABDT
     I              CDABTM                          WFABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKCD1    E DSPKCDCPL0
      * UPD : Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WCHMNB
     I              CDBNNB                          WCBNNB
     I              CDBONB                          WCBONB
     I              CDCVNB                          WCCVNB
     I              CDB0DT                          WCB0DT
     I              CDBQCD                          WCBQCD
     I              CDAZVA                          WCAZVA
     I              CDA0VA                          WCA0VA
     I              CDJBST                          WCJBST
     I              CDEIST                          WCEIST
     I              CDJDST                          WCJDST
     I              CDDPCD                          WCDPCD
     I              CDE3CD                          WCE3CD
     I              CDAQNB                          WCAQNB
     I              CDOCST                          WCOCST
     I              CDPEST                          WCPEST
     I              CDPFST                          WCPFST
     I              CDPGST                          WCPGST
     I              CDPIST                          WCPIST
     I              CDPJST                          WCPJST
     I              CDPKST                          WCPKST
     I              CDPLST                          WCPLST
     I              CDAAVN                          WCAAVN
     I              CDAADT                          WCAADT
     I              CDAMTM                          WCAMTM
     I              CDAJST                          WCAJST
     I              CDAHVN                          WCAHVN
     I              CDAGVN                          WCAGVN
     I              CDABVN                          WCABVN
     I              CDABDT                          WCABDT
     I              CDABTM                          WCABTM
      *
     IYARDCS      DS                            118
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            118
     IYCRDCS      DS                            118
     IYDRDCS      DS                            118
     IYERDCS      DS                            118
     IYFRDCS      DS                            118
     IYGRDCS      DS                            118
     IYHRDCS      DS                            118
     IYIRDCS      DS                            118
     IYJRDCS      DS                            118
     IYKRDCS      DS                            118
     IYLRDCS      DS                            118
     IYMRDCS      DS                            118
     IYNRDCS      DS                            118
     IYORDCS      DS                            118
     IYPRDCS      DS                            118
     IYQRDCS      DS                            118
     IYRRDCS      DS                            118
     IYSRDCS      DS                            118
     IYTRDCS      DS                            118
     IYURDCS      DS                            118
     IYVRDCS      DS                            118
     IYWRDCS      DS                            118
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I :  BOL Load Number
     I                                    P   7   90P1BONB
      * I :  TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I :  TH Kill Date
     I                                    P  13  160P1B0DT
      * I :  TH Purchase Date
     I                                    P  17  200P1AWDT
      * I :  TH Deduction Amt
     I                                    P  21  242P1ASPR
      * I :  TH Additions Amt
     I                                    P  25  282P1A5VA
      * I :  TH Payment Sts
     I                                       29  30 P1CWST
     IP2PARM      DS
      * I : MAP Tattoo Number New User
     I                                    P   1   30P2GENB
     IP3PARM      DS
      * I : MAP Freight Cur Amount Usr
     I                                    P   1   42P3MEPR
     IP4PARM      DS
      * I : MAP Freight Nxt Amount Usr
     I                                    P   1   42P4MFPR
     IP5PARM      DS
      * I : MAP Th Accruals Amt Org Usr
     I                                    P   1   42P5L8PR
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P1AWDT    PARM           WP0006  70       TH Purchase Dat
     C           P1ASPR    PARM           WP0007  72       TH Deduction Am
     C           P1A5VA    PARM           WP0008  72       TH Additions Am
     C           P1CWST    PARM           WP0009  2        TH Payment Sts
     C           P2GENB    PARM           WP0010  50       Tattoo Number N
     C           P3MEPR    PARM           WP0011  72       Freight Cur Amo
     C           P4MFPR    PARM           WP0012  72       Freight Nxt Amo
     C           P5L8PR    PARM           WP0013  72       Th Accruals Amt
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc D/A for Subj AfPd XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * ******  HPE053P - Added Dead head uom checks
      * ******
     C                     Z-ADD*ZERO     WUIVPR           TOT ADDITION Us
     C                     Z-ADD*ZERO     WUIUPR           TOT DEDUCTION U
      * Producer Totals Deduction/Add Tattoo Ded/Add
     C                     EXSR UBSUBR                     Producer Totals
      * Seaboard Totals Deduction/Add Tattoo Ded/Add Accruals
     C                     EXSR UCSUBR                     Seaboard Totals
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NACHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YWRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHNA    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHNA    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL023.
     C                     MOVEL'LBL023'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NAEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NAEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YWRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWAA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YWRDCS
     C           YWRDC     ANDNE'N'
     C                     MOVE 'Y'       YWRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YWRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * * Rd of Prd only *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQSA02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQSA03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQSA04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQSA05           TH Kill Date
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
     C                     KFLD           WQSA04           TH Tattoo Numbe
     C                     KFLD           WQSA05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSA03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSA04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSA05           TH Kill Date
      * Establish starting position
     C           KRSSA     SETLL@CDCPIU                    *
     C           KRSSA     READE@CDCPIU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'N'       IFEQ 'N'                        *IF
     C           WAEIST    IFEQ 'CH'                       *IF
     C           WAEIST    OREQ 'DH'
     C           WAEIST    OREQ 'DY'
     C           WAEIST    OREQ 'YH'
     C           WAEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Process Producer Ded/Add only
      * CASE: PAR.Exp Payed By Who Usr is Producer
     C           WUPRST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Expense Paid by is Producer
     C           WAPEST    IFEQ 'P'                        *IF
      * Freight for the producer is included in ded/add totals
      * There are no accruals for producer
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUIVPR           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WAA0VA    WUIUPR           TH Deduction Am
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process Seaboard Expense
      * CASE: PAR.Exp Payed By Who Usr is Seaboard
     C           WUPRST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WAPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WAPFST    IFEQ 'F'                        *IF
      * Freight should only be a +
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WAPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUA7VA           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUA7VA           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tto Ddd Sbj    RT - Tattoo Ded/Add  * * Producer *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.First Time Flag Usr is Yes
     C           'Y'       IFEQ 'Y'                        *IF
      * CASE: PAR.TOT DEDUCTION Usr NE WRK.Zero USR
     C           WUIUPR    IFNE WUE9NB                     *IF
     C           P1ASPR    DIV  WUIUPR    WUFMPC    H      @Percent Fld Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUFMPC           @Percent Fld Us
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSB03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSB04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSB05           TH Kill Date
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           BOH Buy Order N
     C                     KFLD           WQSB03           BOL Load Number
     C                     KFLD           WQSB04           TH Tattoo Numbe
     C                     KFLD           WQSB05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSB01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSB02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSB03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSB04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSB05           TH Kill Date
      * Establish starting position
     C           KRSSB     SETLL@CDCPT8                    *
     C           KRSSB     READE@CDCPT8                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Read D/As except those with Dead Head UOM
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WBEIST    IFEQ 'CH'                       *IF
     C           WBEIST    OREQ 'DH'
     C           WBEIST    OREQ 'DY'
     C           WBEIST    OREQ 'YH'
     C           WBEIST    OREQ 'KH'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.First Time Flag Usr is Yes
     C           'Y'       IFEQ 'Y'                        *IF
     C           WBA0VA    MULT WUFMPC    WUA0VA    H      THD Ded/Add Amo
     C                     ADD  WUA0VA    WUIZPR           tot Amt fld 2 U
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SCCHRC
     C           WBA0VA    SUB  WUA0VA    WUIYPR           Tot Amt fld 1 u
      * CASE: WRK.Tot Amt fld 1 usr is Not Zeros
     C           WUIYPR    IFNE 0                          *IF
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.First Time Flag Usr is No
     C           'Y'       IFEQ 'N'                        *IF
      * CASE: PAR.TH Deduction Amt GT PAR.tot Amt fld 2 Usr
     C           P1ASPR    IFGT WUIZPR                     *IF
     C           P1ASPR    SUB  WUIZPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WBA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIZPR    SUB  P1ASPR    WUA0VA           THD Ded/Add Amo
     C           WBA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SGCHRC
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@CDCPT8                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSC    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YARDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST    P      THD UOM
     C                     MOVELWBJDST    WCJDST    P      THD Transaction
     C                     MOVELWBDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWBE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWBPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWBPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWBPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWBPIST    WCPIST    P      THD Commission
     C                     MOVELWBPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWBPKST    WCPKST    P      THD Status 4
     C                     MOVELWBPLST    WCPLST    P      THD Status 5
     C                     MOVELWBAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WCAHVN    P      RS Job
     C                     MOVELWBAGVN    WCAGVN    P      RS Program
     C                     MOVELWBABVN    WCABVN    P      RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWBHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WAB0DT           TH Kill Date
     C                     MOVELWBBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSSD     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SECRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SFCHRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST           THD UOM
     C                     MOVELWBJDST    WCJDST           THD Transaction
     C                     MOVELWBDPCD    WCDPCD           THD GL Code
     C                     MOVELWBE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST           THD Payment Sts
     C                     MOVELWBPEST    WCPEST           THD Expense Pai
     C                     MOVELWBPFST    WCPFST           THD Expense Typ
     C                     MOVEL*BLANK    WCPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WCPIST           THD Commission
     C                     MOVEL*BLANK    WCPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WCPKST           THD Status 4
     C                     MOVEL*BLANK    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSE    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSE    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSF    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSF    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YBRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSG    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YCRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST    P      THD UOM
     C                     MOVELWBJDST    WCJDST    P      THD Transaction
     C                     MOVELWBDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWBE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWBPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWBPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWBPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWBPIST    WCPIST    P      THD Commission
     C                     MOVELWBPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWBPKST    WCPKST    P      THD Status 4
     C                     MOVELWBPLST    WCPLST    P      THD Status 5
     C                     MOVELWBAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WCAHVN    P      RS Job
     C                     MOVELWBAGVN    WCAGVN    P      RS Program
     C                     MOVELWBABVN    WCABVN    P      RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tto Ddd Sbj    RT - Tattoo Ded/Add  * * Producer *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.First Time Flag Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * CASE: PAR.TOT DEDUCTION Usr NE WRK.Zero USR
     C           WUIUPR    IFNE WUE9NB                     *IF
     C           P1ASPR    DIV  WUIUPR    WUFMPC    H      @Percent Fld Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUFMPC           @Percent Fld Us
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSH01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQSH03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQSH04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQSH05           TH Kill Date
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           BOH Company Num
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
     C                     KFLD           WQSH04           TH Tattoo Numbe
     C                     KFLD           WQSH05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSH01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSH03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSH04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSH05           TH Kill Date
      * Establish starting position
     C           KRSSH     SETLL@CDCPT8                    *
     C           KRSSH     READE@CDCPT8                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Read D/As except those with Dead Head UOM
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WBEIST    IFEQ 'CH'                       *IF
     C           WBEIST    OREQ 'DH'
     C           WBEIST    OREQ 'DY'
     C           WBEIST    OREQ 'YH'
     C           WBEIST    OREQ 'KH'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.First Time Flag Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
     C           WBA0VA    MULT WUFMPC    WUA0VA    H      THD Ded/Add Amo
     C                     ADD  WUA0VA    WUIZPR           tot Amt fld 2 U
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SICHRC
     C           WBA0VA    SUB  WUA0VA    WUIYPR           Tot Amt fld 1 u
      * CASE: WRK.Tot Amt fld 1 usr is Not Zeros
     C           WUIYPR    IFNE 0                          *IF
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.First Time Flag Usr is No
     C           'N'       IFEQ 'N'                        *IF
      * CASE: PAR.TH Deduction Amt GT PAR.tot Amt fld 2 Usr
     C           P1ASPR    IFGT WUIZPR                     *IF
     C           P1ASPR    SUB  WUIZPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WBA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIZPR    SUB  P1ASPR    WUA0VA           THD Ded/Add Amo
     C           WBA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SMCHRC
     C                     GOTO SHEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSH     READE@CDCPT8                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSI    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSI    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YDRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST    P      THD UOM
     C                     MOVELWBJDST    WCJDST    P      THD Transaction
     C                     MOVELWBDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWBE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWBPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWBPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWBPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWBPIST    WCPIST    P      THD Commission
     C                     MOVELWBPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWBPKST    WCPKST    P      THD Status 4
     C                     MOVELWBPLST    WCPLST    P      THD Status 5
     C                     MOVELWBAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WCAHVN    P      RS Job
     C                     MOVELWBAGVN    WCAGVN    P      RS Program
     C                     MOVELWBABVN    WCABVN    P      RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWBHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WAB0DT           TH Kill Date
     C                     MOVELWBBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSSJ     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SKCRRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST           THD UOM
     C                     MOVELWBJDST    WCJDST           THD Transaction
     C                     MOVELWBDPCD    WCDPCD           THD GL Code
     C                     MOVELWBE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST           THD Payment Sts
     C                     MOVELWBPEST    WCPEST           THD Expense Pai
     C                     MOVELWBPFST    WCPFST           THD Expense Typ
     C                     MOVEL*BLANK    WCPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WCPIST           THD Commission
     C                     MOVEL*BLANK    WCPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WCPKST           THD Status 4
     C                     MOVEL*BLANK    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSK    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSL    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSL    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YERDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSM    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSM    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YFRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST    P      THD UOM
     C                     MOVELWBJDST    WCJDST    P      THD Transaction
     C                     MOVELWBDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWBE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWBPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWBPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWBPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWBPIST    WCPIST    P      THD Commission
     C                     MOVELWBPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWBPKST    WCPKST    P      THD Status 4
     C                     MOVELWBPLST    WCPLST    P      THD Status 5
     C                     MOVELWBAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WCAHVN    P      RS Job
     C                     MOVELWBAGVN    WCAGVN    P      RS Program
     C                     MOVELWBABVN    WCABVN    P      RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tto Dad Sbj    RT - Tattoo Ded/Add  * * Producer *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.First Time Flag Usr is Yes
     C           'Y'       IFEQ 'Y'                        *IF
      * CASE: PAR.TOT ADDITION Usr NE WRK.Zero USR
     C           WUIVPR    IFNE WUE9NB                     *IF
     C           P1A5VA    DIV  WUIVPR    WUBCPC    H      Percent USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUBCPC           Percent USR
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSN01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSN02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSN03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQSN04           TH Tattoo Numbe
     C           *LIKE     DEFN WDB0DT    WQSN05           TH Kill Date
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           BOH Company Num
     C                     KFLD           WQSN02           BOH Buy Order N
     C                     KFLD           WQSN03           BOL Load Number
     C                     KFLD           WQSN04           TH Tattoo Numbe
     C                     KFLD           WQSN05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQSN01           BOH Company Num
     C                     Z-ADDP1BNNB    WQSN02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQSN03           BOL Load Number
     C                     Z-ADDP1CVNB    WQSN04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQSN05           TH Kill Date
      * Establish starting position
     C           KRSSN     SETLL@CDCPT9                    *
     C           KRSSN     READE@CDCPT9                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WDEIST    IFEQ 'CH'                       *IF
     C           WDEIST    OREQ 'DH'
     C           WDEIST    OREQ 'DY'
     C           WDEIST    OREQ 'YH'
     C           WDEIST    OREQ 'KH'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.First Time Flag Usr is Yes
     C           'Y'       IFEQ 'Y'                        *IF
     C           WDA0VA    MULT WUFMPC    WUA0VA    H      THD Ded/Add Amo
     C                     ADD  WUA0VA    WUIZPR           tot Amt fld 2 U
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SOCHRC
     C           WDA0VA    SUB  WUA0VA    WUIYPR           Tot Amt fld 1 u
      * CASE: WRK.Tot Amt fld 1 usr is Not Zeros
     C           WUIYPR    IFNE 0                          *IF
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.First Time Flag Usr is No
     C           'Y'       IFEQ 'N'                        *IF
      * CASE: PAR.TH Additions Amt GT PAR.tot Amt fld 2 Usr
     C           P1A5VA    IFGT WUIZPR                     *IF
     C           WUIVPR    SUB  WUIZPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WDA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIZPR    SUB  P1A5VA    WUA0VA           THD Ded/Add Amo
     C           WDA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SSCHRC
     C                     GOTO SNEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@CDCPT9                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSO    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSO    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YGRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST    P      THD UOM
     C                     MOVELWDJDST    WCJDST    P      THD Transaction
     C                     MOVELWDDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWDE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWDPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWDPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWDPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWDPIST    WCPIST    P      THD Commission
     C                     MOVELWDPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWDPKST    WCPKST    P      THD Status 4
     C                     MOVELWDPLST    WCPLST    P      THD Status 5
     C                     MOVELWDAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WCAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WCAMTM           RS Time Changed
     C                     MOVELWDAJST    WCAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WCAHVN    P      RS Job
     C                     MOVELWDAGVN    WCAGVN    P      RS Program
     C                     MOVELWDABVN    WCABVN    P      RS User Added
     C                     Z-ADDWDABDT    WCABDT           RS Date Added
     C                     Z-ADDWDABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWDHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WAB0DT           TH Kill Date
     C                     MOVELWDBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSSP     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SQCRRC
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SRCHRC
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST           THD UOM
     C                     MOVELWDJDST    WCJDST           THD Transaction
     C                     MOVELWDDPCD    WCDPCD           THD GL Code
     C                     MOVELWDE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST           THD Payment Sts
     C                     MOVELWDPEST    WCPEST           THD Expense Pai
     C                     MOVELWDPFST    WCPFST           THD Expense Typ
     C                     MOVEL*BLANK    WCPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WCPIST           THD Commission
     C                     MOVEL*BLANK    WCPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WCPKST           THD Status 4
     C                     MOVEL*BLANK    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSR    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSR    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YHRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YIRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSS    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSS    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL009.
     C                     MOVEL'LBL009'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YIRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST    P      THD UOM
     C                     MOVELWDJDST    WCJDST    P      THD Transaction
     C                     MOVELWDDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWDE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWDPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWDPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWDPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWDPIST    WCPIST    P      THD Commission
     C                     MOVELWDPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWDPKST    WCPKST    P      THD Status 4
     C                     MOVELWDPLST    WCPLST    P      THD Status 5
     C                     MOVELWDAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WCAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WCAMTM           RS Time Changed
     C                     MOVELWDAJST    WCAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WCAHVN    P      RS Job
     C                     MOVELWDAGVN    WCAGVN    P      RS Program
     C                     MOVELWDABVN    WCABVN    P      RS User Added
     C                     Z-ADDWDABDT    WCABDT           RS Date Added
     C                     Z-ADDWDABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YIRDCS
     C           YIRDC     ANDNE'N'
     C                     MOVE 'Y'       YIRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YIRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tto Dad Sbj    RT - Tattoo Ded/Add  * * Producer *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.First Time Flag Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * CASE: PAR.TOT ADDITION Usr NE WRK.Zero USR
     C           WUIVPR    IFNE WUE9NB                     *IF
     C           P1A5VA    DIV  WUIVPR    WUBCPC    H      Percent USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUBCPC           Percent USR
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQST01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQST02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQST03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQST04           TH Tattoo Numbe
     C           *LIKE     DEFN WDB0DT    WQST05           TH Kill Date
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WQST01           BOH Company Num
     C                     KFLD           WQST02           BOH Buy Order N
     C                     KFLD           WQST03           BOL Load Number
     C                     KFLD           WQST04           TH Tattoo Numbe
     C                     KFLD           WQST05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQST01           BOH Company Num
     C                     Z-ADDP1BNNB    WQST02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQST03           BOL Load Number
     C                     Z-ADDP1CVNB    WQST04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQST05           TH Kill Date
      * Establish starting position
     C           KRSST     SETLL@CDCPT9                    *
     C           KRSST     READE@CDCPT9                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WDEIST    IFEQ 'CH'                       *IF
     C           WDEIST    OREQ 'DH'
     C           WDEIST    OREQ 'DY'
     C           WDEIST    OREQ 'YH'
     C           WDEIST    OREQ 'KH'
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.First Time Flag Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
     C           WDA0VA    MULT WUFMPC    WUA0VA    H      THD Ded/Add Amo
     C                     ADD  WUA0VA    WUIZPR           tot Amt fld 2 U
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SUCHRC
     C           WDA0VA    SUB  WUA0VA    WUIYPR           Tot Amt fld 1 u
      * CASE: WRK.Tot Amt fld 1 usr is Not Zeros
     C           WUIYPR    IFNE 0                          *IF
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.First Time Flag Usr is No
     C           'N'       IFEQ 'N'                        *IF
      * CASE: PAR.TH Additions Amt GT PAR.tot Amt fld 2 Usr
     C           P1A5VA    IFGT WUIZPR                     *IF
     C           WUIVPR    SUB  WUIZPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WDA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIZPR    SUB  P1A5VA    WUA0VA           THD Ded/Add Amo
     C           WDA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SYCHRC
     C                     GOTO STEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSST     READE@CDCPT9                  90*
     C                     ENDDO
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YJRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSU    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSU    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL010.
     C                     MOVEL'LBL010'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YJRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST    P      THD UOM
     C                     MOVELWDJDST    WCJDST    P      THD Transaction
     C                     MOVELWDDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWDE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWDPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWDPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWDPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWDPIST    WCPIST    P      THD Commission
     C                     MOVELWDPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWDPKST    WCPKST    P      THD Status 4
     C                     MOVELWDPLST    WCPLST    P      THD Status 5
     C                     MOVELWDAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WCAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WCAMTM           RS Time Changed
     C                     MOVELWDAJST    WCAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WCAHVN    P      RS Job
     C                     MOVELWDAGVN    WCAGVN    P      RS Program
     C                     MOVELWDABVN    WCABVN    P      RS User Added
     C                     Z-ADDWDABDT    WCABDT           RS Date Added
     C                     Z-ADDWDABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YJRDCS
     C           YJRDC     ANDNE'N'
     C                     MOVE 'Y'       YJRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YJRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWDHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WAB0DT           TH Kill Date
     C                     MOVELWDBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSSV     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SWCRRC
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SXCHRC
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST           THD UOM
     C                     MOVELWDJDST    WCJDST           THD Transaction
     C                     MOVELWDDPCD    WCDPCD           THD GL Code
     C                     MOVELWDE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST           THD Payment Sts
     C                     MOVELWDPEST    WCPEST           THD Expense Pai
     C                     MOVELWDPFST    WCPFST           THD Expense Typ
     C                     MOVEL*BLANK    WCPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WCPIST           THD Commission
     C                     MOVEL*BLANK    WCPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WCPKST           THD Status 4
     C                     MOVEL*BLANK    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSW    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSW    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YKRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSX    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSX    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL011.
     C                     MOVEL'LBL011'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YKRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YKRDCS
     C           YKRDC     ANDNE'N'
     C                     MOVE 'Y'       YKRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YKRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YLRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHSY    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHSY    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL012.
     C                     MOVEL'LBL012'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YLRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST    P      THD UOM
     C                     MOVELWDJDST    WCJDST    P      THD Transaction
     C                     MOVELWDDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWDE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWDPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWDPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWDPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWDPIST    WCPIST    P      THD Commission
     C                     MOVELWDPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWDPKST    WCPKST    P      THD Status 4
     C                     MOVELWDPLST    WCPLST    P      THD Status 5
     C                     MOVELWDAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WCAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WCAMTM           RS Time Changed
     C                     MOVELWDAJST    WCAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WCAHVN    P      RS Job
     C                     MOVELWDAGVN    WCAGVN    P      RS Program
     C                     MOVELWDABVN    WCABVN    P      RS User Added
     C                     Z-ADDWDABDT    WCABDT           RS Date Added
     C                     Z-ADDWDABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YLRDCS
     C           YLRDC     ANDNE'N'
     C                     MOVE 'Y'       YLRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YLRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WEHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WEBONB           BOL Load Number
     C                     Z-ADDP2GENB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
      * Establish starting position
     C           KRSSZ     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAWDT    WUAWDT           TH Purchase Dat
     C                     MOVELWEBICD    WUBICD           TH Group Refere
     C                     MOVELWECPST    WUCPST           TH Live Purchas
     C                     Z-ADDWEACPR    WUACPR           TH Live Purchas
     C                     MOVELWEC4ST    WUC4ST           TH Resale UOM
     C                     Z-ADDWEAIPR    WUAIPR           TH Recalc Live
     C                     Z-ADDWEA6DT    WUA6DT           TH Pricing Date
     C                     MOVELWEC2ST    WUC2ST           TH Resale Sprea
     C                     Z-ADDWECXNB    WUCXNB           TH Dead On Arri
     C                     Z-ADDWECWNB    WUCWNB           TH Head Receive
     C                     Z-ADDWEFCNB    WUFCNB           TH Yard Deads
     C                     Z-ADDWEH9NB    WUH9NB           TH Held Over
     C                     Z-ADDWEFDNB    WUFDNB           TH Head Condemn
     C                     Z-ADDWEFENB    WUFENB           TH Head Killed
     C                     Z-ADDWEHENB    WUHENB           TH Head Adds
     C                     Z-ADDWEHFNB    WUHFNB           TH Head Accepte
     C                     Z-ADDWECYNB    WUCYNB           TH Live Wgt
     C                     Z-ADDWEE0NB    WUE0NB           TH Hot Wgt
     C                     Z-ADDWEA5PC    WUA5PC           TH Tot Loin Eye
     C                     Z-ADDWEFBNB    WUFBNB           TH Tot Backfat
     C                     Z-ADDWEA4PC    WUA4PC           TH Tot Light Re
     C                     Z-ADDWEF7NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDWEHDNB    WUHDNB           TH Avg Hot Wgt
     C                     Z-ADDWEF5NB    WUF5NB           TH Avg Light Re
     C                     Z-ADDWEF4NB    WUF4NB           TH Avg Lean Per
     C                     Z-ADDWEF3NB    WUF3NB           TH Avg Loin Eye
     C                     Z-ADDWEF2NB    WUF2NB           TH Avg Backfat
     C                     Z-ADDWEAVPC    WUAVPC           TH Std Yield Pe
     C                     Z-ADDWEAWPC    WUAWPC           TH Actual Yield
     C                     Z-ADDWEA8PC    WUA8PC           TH Yield Differ
     C                     Z-ADDWEA7PC    WUA7PC           TH Recalc Live
     C                     Z-ADDWEAMPR    WUAMPR           TH CM Base Mkt
     C                     Z-ADDWEANPR    WUANPR           TH CM Base Mkt
     C                     Z-ADDWEAYVA    WUAYVA           TH CM Sort Disc
     C                     Z-ADDWEAWVA    WUAWVA           TH CM Yield Gai
     C                     Z-ADDWEAOPR    WUAOPR           TH CM Base Carc
     C                     Z-ADDWEAXVA    WUAXVA           TH CM LN AddOn/
     C                     Z-ADDWEAPPR    WUAPPR           TH CM Carcass G
     C                     Z-ADDWEASPR    WUASPR           TH Deduction Am
     C                     Z-ADDWEA4VA    WUA4VA           TH Total Net WO
     C                     Z-ADDWEATPR    WUATPR           TH Carcass Net
     C                     Z-ADDWEA5VA    WUA5VA           TH Additions Am
     C                     Z-ADDWEA7VA    WUA7VA           TH Accrual Amou
     C                     Z-ADDWEA2PR    WUA2PR           TH Fixed Cost A
     C                     MOVELWECWST    WUCWST           TH Payment Sts
     C                     MOVELWED7ST    WUD7ST           TH Header Error
     C                     MOVELWED8ST    WUD8ST           TH Detail Error
     C                     MOVELWEDWST    WUDWST           TH Kill Balanci
     C                     MOVELWED6ST    WUD6ST           TH Bal to Kill
     C                     Z-ADDWEGHNB    WUGHNB           TH Commission A
     C                     Z-ADDWEBYDT    WUBYDT           TH Voucher Paym
     C                     MOVELWEE0ST    WUE0ST           TH User Error O
     C                     MOVELWEE1ST    WUE1ST           TH Held Over Re
     C                     MOVELWEE2ST    WUE2ST           TH Sex
     C                     Z-ADDWEBSDT    WUBSDT           TH Held/Ovr Com
     C                     Z-ADDWEBTDT    WUBTDT           TH Commission P
     C                     Z-ADDWEBUDT    WUBUDT           TH Actual Check
     C                     Z-ADDWEHGNB    WUHGNB           TH Shipped Weig
     C                     Z-ADDWEHHNB    WUHHNB           TH Avg Hot Wgt
     C                     Z-ADDWEHINB    WUHINB           TH FFLI
     C                     Z-ADDWEA3PR    WUA3PR           TH Kill Product
     C                     Z-ADDWEA4PR    WUA4PR           TH Cut Product
     C                     Z-ADDWEA6PR    WUA6PR           TH Render Produ
     C                     Z-ADDWET2HD    WUT2HD           TH Shift Held O
     C                     MOVELWEBDCD    WUBDCD           DF Defect Code
     C                     MOVELWECSCD    WUCSCD           THP Process Cod
     C                     MOVELWEACCD    WUACCD           HB Buyer Code
     C                     MOVELWEAGCD    WUAGCD           GN Genetic Code
     C                     MOVELWEBECD    WUBECD           HC Class Code
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * * Rd of Prd Only *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQTA01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQTA02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQTA03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQTA04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQTA05           TH Kill Date
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WQTA01           BOH Company Num
     C                     KFLD           WQTA02           BOH Buy Order N
     C                     KFLD           WQTA03           BOL Load Number
     C                     KFLD           WQTA04           TH Tattoo Numbe
     C                     KFLD           WQTA05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTA01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTA02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTA03           BOL Load Number
     C                     Z-ADDP2GENB    WQTA04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTA05           TH Kill Date
      * Establish starting position
     C           KRSTA     SETLL@CDCPIU                    *
     C           KRSTA     READE@CDCPIU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WAEIST    IFEQ 'CH'                       *IF
     C           WAEIST    OREQ 'DH'
     C           WAEIST    OREQ 'DY'
     C           WAEIST    OREQ 'YH'
     C           WAEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Process Producer Ded/Add only
      * CASE: PAR.Exp Payed By Who Usr is Producer
     C           WUPRST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Expense Paid by is Producer
     C           WAPEST    IFEQ 'P'                        *IF
      * Freight for the producer is included in ded/add totals
      * There are no accruals for producer
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUIVPR           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WAA0VA    WUIUPR           TH Deduction Am
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process Seaboard Expense
      * CASE: PAR.Exp Payed By Who Usr is Seaboard
     C           WUPRST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WAPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WAPFST    IFEQ 'F'                        *IF
      * Freight should only be a +
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WAPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUA7VA           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUA7VA           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTA     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv/chg Tto Ddd Adjrt  RT - Tattoo Ded/Add  * * Producer *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQTB01           BOH Company Num
     C           *LIKE     DEFN WBBNNB    WQTB02           BOH Buy Order N
     C           *LIKE     DEFN WBBONB    WQTB03           BOL Load Number
     C           *LIKE     DEFN WBCVNB    WQTB04           TH Tattoo Numbe
     C           *LIKE     DEFN WBB0DT    WQTB05           TH Kill Date
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           BOH Company Num
     C                     KFLD           WQTB02           BOH Buy Order N
     C                     KFLD           WQTB03           BOL Load Number
     C                     KFLD           WQTB04           TH Tattoo Numbe
     C                     KFLD           WQTB05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTB01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTB02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTB03           BOL Load Number
     C                     Z-ADDP2GENB    WQTB04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTB05           TH Kill Date
      * Establish starting position
     C           KRSTB     SETLL@CDCPT8                    *
     C           KRSTB     READE@CDCPT8                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD Expense Paid by is Producer
     C           WBPEST    IFEQ 'P'                        *IF
      * CASE: PAR.TH Deduction Amt GT PAR.TOT DEDUCTION Usr
     C           WUASPR    IFGT WUIUPR                     *IF
     C           WUASPR    SUB  WUIUPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WBA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIUPR    SUB  WUASPR    WUA0VA           THD Ded/Add Amo
     C           WBA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TCCHRC
     C                     GOTO TBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTB     READE@CDCPT8                  90*
     C                     ENDDO
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YMRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWBHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WCBONB           BOL Load Number
     C                     Z-ADDWBCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WCB0DT           TH Kill Date
     C                     MOVELWBBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTC    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL013.
     C                     MOVEL'LBL013'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YMRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWBAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWBJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWBEIST    WCEIST    P      THD UOM
     C                     MOVELWBJDST    WCJDST    P      THD Transaction
     C                     MOVELWBDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWBE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWBAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWBOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWBPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWBPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWBPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWBPIST    WCPIST    P      THD Commission
     C                     MOVELWBPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWBPKST    WCPKST    P      THD Status 4
     C                     MOVELWBPLST    WCPLST    P      THD Status 5
     C                     MOVELWBAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWBAADT    WCAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WCAMTM           RS Time Changed
     C                     MOVELWBAJST    WCAJST    P      RS Record Statu
     C                     MOVELWBAHVN    WCAHVN    P      RS Job
     C                     MOVELWBAGVN    WCAGVN    P      RS Program
     C                     MOVELWBABVN    WCABVN    P      RS User Added
     C                     Z-ADDWBABDT    WCABDT           RS Date Added
     C                     Z-ADDWBABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YMRDCS
     C           YMRDC     ANDNE'N'
     C                     MOVE 'Y'       YMRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YMRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv/chg Tto Dad Adjrt  RT - Tattoo Ded/Add  * * Producer *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQTD01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQTD02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQTD03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQTD04           TH Tattoo Numbe
     C           *LIKE     DEFN WDB0DT    WQTD05           TH Kill Date
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           BOH Company Num
     C                     KFLD           WQTD02           BOH Buy Order N
     C                     KFLD           WQTD03           BOL Load Number
     C                     KFLD           WQTD04           TH Tattoo Numbe
     C                     KFLD           WQTD05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTD01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTD02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTD03           BOL Load Number
     C                     Z-ADDP2GENB    WQTD04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTD05           TH Kill Date
      * Establish starting position
     C           KRSTD     SETLL@CDCPT9                    *
     C           KRSTD     READE@CDCPT9                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD Expense Paid by is Producer
     C           WDPEST    IFEQ 'P'                        *IF
      * CASE: PAR.TH Additions Amt GT PAR.TOT ADDITION Usr
     C           WUA5VA    IFGT WUIVPR                     *IF
     C           WUA5VA    SUB  WUIVPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WDA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIVPR    SUB  WUA5VA    WUA0VA           THD Ded/Add Amo
     C           WDA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TECHRC
     C                     GOTO TDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSTD     READE@CDCPT9                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YNRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWDHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WCBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WCB0DT           TH Kill Date
     C                     MOVELWDBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTE    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTE    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL014.
     C                     MOVEL'LBL014'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YNRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWDAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWDJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWDEIST    WCEIST    P      THD UOM
     C                     MOVELWDJDST    WCJDST    P      THD Transaction
     C                     MOVELWDDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWDE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWDAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWDOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWDPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWDPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWDPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWDPIST    WCPIST    P      THD Commission
     C                     MOVELWDPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWDPKST    WCPKST    P      THD Status 4
     C                     MOVELWDPLST    WCPLST    P      THD Status 5
     C                     MOVELWDAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWDAADT    WCAADT           RS Date Changed
     C                     Z-ADDWDAMTM    WCAMTM           RS Time Changed
     C                     MOVELWDAJST    WCAJST    P      RS Record Statu
     C                     MOVELWDAHVN    WCAHVN    P      RS Job
     C                     MOVELWDAGVN    WCAGVN    P      RS Program
     C                     MOVELWDABVN    WCABVN    P      RS User Added
     C                     Z-ADDWDABDT    WCABDT           RS Date Added
     C                     Z-ADDWDABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YNRDCS
     C           YNRDC     ANDNE'N'
     C                     MOVE 'Y'       YNRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YNRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * * seaboard *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQTF01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQTF02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQTF03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQTF04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQTF05           TH Kill Date
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           BOH Company Num
     C                     KFLD           WQTF02           BOH Buy Order N
     C                     KFLD           WQTF03           BOL Load Number
     C                     KFLD           WQTF04           TH Tattoo Numbe
     C                     KFLD           WQTF05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTF01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTF02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTF03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTF04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTF05           TH Kill Date
      * Establish starting position
     C           KRSTF     SETLL@CDCPIU                    *
     C           KRSTF     READE@CDCPIU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'N'       IFEQ 'N'                        *IF
     C           WAEIST    IFEQ 'CH'                       *IF
     C           WAEIST    OREQ 'DH'
     C           WAEIST    OREQ 'DY'
     C           WAEIST    OREQ 'YH'
     C           WAEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Process Producer Ded/Add only
      * CASE: PAR.Exp Payed By Who Usr is Producer
     C           WUPRST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Expense Paid by is Producer
     C           WAPEST    IFEQ 'P'                        *IF
      * Freight for the producer is included in ded/add totals
      * There are no accruals for producer
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUIVPR           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WAA0VA    WUIUPR           TH Deduction Am
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process Seaboard Expense
      * CASE: PAR.Exp Payed By Who Usr is Seaboard
     C           WUPRST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WAPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WAPFST    IFEQ 'F'                        *IF
      * Freight should only be a +
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WAPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUA7VA           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUA7VA           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTF     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv/Chg Ttto Dd Sbj SB RT - Tattoo Ded/Add  * * seaboard *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.First Time Flag Usr is Yes
     C           'Y'       IFEQ 'Y'                        *IF
      * CASE: PAR.Exp Amount Total F/A Usr NE WRK.Zero USR
     C           WUMDPR    IFNE WUE9NB                     *IF
     C           P5L8PR    DIV  WUMDPR    WUFMPC    H      @Percent Fld Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUFMPC           @Percent Fld Us
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQTG01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQTG02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQTG03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQTG04           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQTG05           TH Kill Date
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           BOH Company Num
     C                     KFLD           WQTG02           BOH Buy Order N
     C                     KFLD           WQTG03           BOL Load Number
     C                     KFLD           WQTG04           TH Tattoo Numbe
     C                     KFLD           WQTG05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTG01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTG02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTG03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTG04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTG05           TH Kill Date
      * Establish starting position
     C           KRSTG     SETLL@CDCPWY                    *
     C           KRSTG     READE@CDCPWY                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WFPEST    IFEQ 'S'                        *IF
      * Read D/As except those with Dead Head UOM
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WFEIST    IFEQ 'CH'                       *IF
     C           WFEIST    OREQ 'DH'
     C           WFEIST    OREQ 'DY'
     C           WFEIST    OREQ 'YH'
     C           WFEIST    OREQ 'KH'
     C                     ELSE
      * CASE: DB1.THD Expense Type is Freight
     C           WFPFST    IFEQ 'F'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.First Time Flag Usr is Yes
     C           'Y'       IFEQ 'Y'                        *IF
     C           WFA0VA    MULT WUFMPC    WUA0VA    H      THD Ded/Add Amo
     C                     ADD  WUA0VA    WUIZPR           tot Amt fld 2 U
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR THCHRC
     C           WFA0VA    SUB  WUA0VA    WUIYPR           Tot Amt fld 1 u
      * CASE: WRK.Tot Amt fld 1 usr is Not Zeros
     C           WUIYPR    IFNE 0                          *IF
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
     C                     EXSR TIRVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.First Time Flag Usr is No
     C           'Y'       IFEQ 'N'                        *IF
      * CASE: PAR.Th Accruals Amt Org Usr GT PAR.tot Amt fld 2 Usr
     C           P5L8PR    IFGT WUIZPR                     *IF
     C           P5L8PR    SUB  WUIZPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WFA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIZPR    SUB  P5L8PR    WUA0VA           THD Ded/Add Amo
     C           WFA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TLCHRC
     C                     GOTO TGEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTG     READE@CDCPWY                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YORDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTH    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTH    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL015.
     C                     MOVEL'LBL015'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YORDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST    P      THD UOM
     C                     MOVELWFJDST    WCJDST    P      THD Transaction
     C                     MOVELWFDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWFE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWFPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWFPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWFPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    WCPIST    P      THD Commission
     C                     MOVELWFPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    WCPKST    P      THD Status 4
     C                     MOVELWFPLST    WCPLST    P      THD Status 5
     C                     MOVELWFAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WCAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WCAMTM           RS Time Changed
     C                     MOVELWFAJST    WCAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WCAHVN    P      RS Job
     C                     MOVELWFAGVN    WCAGVN    P      RS Program
     C                     MOVELWFABVN    WCABVN    P      RS User Added
     C                     Z-ADDWFABDT    WCABDT           RS Date Added
     C                     Z-ADDWFABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YORDCS
     C           YORDC     ANDNE'N'
     C                     MOVE 'Y'       YORDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YORDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWFHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WAB0DT           TH Kill Date
     C                     MOVELWFBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSTI     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TJCRRC
     C                     GOTO TIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TKCHRC
     C                     ENDIF
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST           THD UOM
     C                     MOVELWFJDST    WCJDST           THD Transaction
     C                     MOVELWFDPCD    WCDPCD           THD GL Code
     C                     MOVELWFE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST           THD Payment Sts
     C                     MOVELWFPEST    WCPEST           THD Expense Pai
     C                     MOVELWFPFST    WCPFST           THD Expense Typ
     C                     MOVEL*BLANK    WCPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WCPIST           THD Commission
     C                     MOVEL*BLANK    WCPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WCPKST           THD Status 4
     C                     MOVEL*BLANK    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTJ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTJ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YPRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTK    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTK    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL016.
     C                     MOVEL'LBL016'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TKEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YPRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YPRDCS
     C           YPRDC     ANDNE'N'
     C                     MOVE 'Y'       YPRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YPRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YQRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTL    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTL    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL017.
     C                     MOVEL'LBL017'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YQRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST    P      THD UOM
     C                     MOVELWFJDST    WCJDST    P      THD Transaction
     C                     MOVELWFDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWFE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWFPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWFPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWFPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    WCPIST    P      THD Commission
     C                     MOVELWFPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    WCPKST    P      THD Status 4
     C                     MOVELWFPLST    WCPLST    P      THD Status 5
     C                     MOVELWFAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WCAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WCAMTM           RS Time Changed
     C                     MOVELWFAJST    WCAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WCAHVN    P      RS Job
     C                     MOVELWFAGVN    WCAGVN    P      RS Program
     C                     MOVELWFABVN    WCABVN    P      RS User Added
     C                     Z-ADDWFABDT    WCABDT           RS Date Added
     C                     Z-ADDWFABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YQRDCS
     C           YQRDC     ANDNE'N'
     C                     MOVE 'Y'       YQRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YQRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv/Chg Ttto Dd Sbj SB RT - Tattoo Ded/Add  * * Seaboard *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * CASE: PAR.First Time Flag Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
      * CASE: PAR.Exp Amount Total F/A Usr NE WRK.Zero USR
     C           WUMDPR    IFNE WUE9NB                     *IF
     C           P5L8PR    DIV  WUMDPR    WUFMPC    H      @Percent Fld Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUFMPC           @Percent Fld Us
     C                     END                             *FI
     C                     END                             *FI
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQTM01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQTM02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQTM03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQTM04           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQTM05           TH Kill Date
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           BOH Company Num
     C                     KFLD           WQTM02           BOH Buy Order N
     C                     KFLD           WQTM03           BOL Load Number
     C                     KFLD           WQTM04           TH Tattoo Numbe
     C                     KFLD           WQTM05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTM01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTM02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTM03           BOL Load Number
     C                     Z-ADDP1CVNB    WQTM04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTM05           TH Kill Date
      * Establish starting position
     C           KRSTM     SETLL@CDCPWY                    *
     C           KRSTM     READE@CDCPWY                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WFPEST    IFEQ 'S'                        *IF
      * Read D/As except those with Dead Head UOM
      * CASE: DB1.THD UOM is Dead Head UOM
     C           WFEIST    IFEQ 'CH'                       *IF
     C           WFEIST    OREQ 'DH'
     C           WFEIST    OREQ 'DY'
     C           WFEIST    OREQ 'YH'
     C           WFEIST    OREQ 'KH'
     C                     ELSE
      * CASE: DB1.THD Expense Type is Freight
     C           WFPFST    IFEQ 'F'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.First Time Flag Usr is Yes
     C           'N'       IFEQ 'Y'                        *IF
     C           WFA0VA    MULT WUFMPC    WUA0VA    H      THD Ded/Add Amo
     C                     ADD  WUA0VA    WUIZPR           tot Amt fld 2 U
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TNCHRC
     C           WFA0VA    SUB  WUA0VA    WUIYPR           Tot Amt fld 1 u
      * CASE: WRK.Tot Amt fld 1 usr is Not Zeros
     C           WUIYPR    IFNE 0                          *IF
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
     C                     EXSR TORVGN
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PAR.First Time Flag Usr is No
     C           'N'       IFEQ 'N'                        *IF
      * CASE: PAR.Th Accruals Amt Org Usr GT PAR.tot Amt fld 2 Usr
     C           P5L8PR    IFGT WUIZPR                     *IF
     C           P5L8PR    SUB  WUIZPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WFA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUIZPR    SUB  P5L8PR    WUA0VA           THD Ded/Add Amo
     C           WFA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TRCHRC
     C                     GOTO TMEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTM     READE@CDCPWY                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YRRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTN    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTN    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL018.
     C                     MOVEL'LBL018'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YRRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST    P      THD UOM
     C                     MOVELWFJDST    WCJDST    P      THD Transaction
     C                     MOVELWFDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWFE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWFPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWFPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWFPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    WCPIST    P      THD Commission
     C                     MOVELWFPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    WCPKST    P      THD Status 4
     C                     MOVELWFPLST    WCPLST    P      THD Status 5
     C                     MOVELWFAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WCAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WCAMTM           RS Time Changed
     C                     MOVELWFAJST    WCAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WCAHVN    P      RS Job
     C                     MOVELWFAGVN    WCAGVN    P      RS Program
     C                     MOVELWFABVN    WCABVN    P      RS User Added
     C                     Z-ADDWFABDT    WCABDT           RS Date Added
     C                     Z-ADDWFABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YRRDCS
     C           YRRDC     ANDNE'N'
     C                     MOVE 'Y'       YRRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YRRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv/Chg Tattoo D/A Pd Rt - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWFHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WAB0DT           TH Kill Date
     C                     MOVELWFBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSTO     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TPCRRC
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TQCHRC
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST           THD UOM
     C                     MOVELWFJDST    WCJDST           THD Transaction
     C                     MOVELWFDPCD    WCDPCD           THD GL Code
     C                     MOVELWFE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST           THD Payment Sts
     C                     MOVELWFPEST    WCPEST           THD Expense Pai
     C                     MOVELWFPFST    WCPFST           THD Expense Typ
     C                     MOVEL*BLANK    WCPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WCPIST           THD Commission
     C                     MOVEL*BLANK    WCPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WCPKST           THD Status 4
     C                     MOVEL*BLANK    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL*BLANK    WCAHVN           RS Job
     C                     MOVEL*BLANK    WCAGVN           RS Program
     C                     MOVEL*BLANK    WCABVN           RS User Added
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTP    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTP    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YSRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
     C                     MOVELWABQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTQ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTQ    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL019.
     C                     MOVEL'LBL019'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YSRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWAAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUIYPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWAJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWAEIST    WCEIST    P      THD UOM
     C                     MOVELWAJDST    WCJDST    P      THD Transaction
     C                     MOVELWADPCD    WCDPCD    P      THD GL Code
     C                     MOVELWAE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWAAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWAOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWAPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWAPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWAPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWAPIST    WCPIST    P      THD Commission
     C                     MOVELWAPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWAPKST    WCPKST    P      THD Status 4
     C                     MOVELWAPLST    WCPLST    P      THD Status 5
     C                     MOVELWAAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWAAADT    WCAADT           RS Date Changed
     C                     Z-ADDWAAMTM    WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVELWAAHVN    WCAHVN    P      RS Job
     C                     MOVELWAAGVN    WCAGVN    P      RS Program
     C                     MOVELWAABVN    WCABVN    P      RS User Added
     C                     Z-ADDWAABDT    WCABDT           RS Date Added
     C                     Z-ADDWAABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YSRDCS
     C           YSRDC     ANDNE'N'
     C                     MOVE 'Y'       YSRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YSRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YTRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTR    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTR    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL020.
     C                     MOVEL'LBL020'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YTRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST    P      THD UOM
     C                     MOVELWFJDST    WCJDST    P      THD Transaction
     C                     MOVELWFDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWFE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWFPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWFPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWFPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    WCPIST    P      THD Commission
     C                     MOVELWFPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    WCPKST    P      THD Status 4
     C                     MOVELWFPLST    WCPLST    P      THD Status 5
     C                     MOVELWFAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WCAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WCAMTM           RS Time Changed
     C                     MOVELWFAJST    WCAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WCAHVN    P      RS Job
     C                     MOVELWFAGVN    WCAGVN    P      RS Program
     C                     MOVELWFABVN    WCABVN    P      RS User Added
     C                     Z-ADDWFABDT    WCABDT           RS Date Added
     C                     Z-ADDWFABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YTRDCS
     C           YTRDC     ANDNE'N'
     C                     MOVE 'Y'       YTRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YTRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Tattoo Record     RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WEHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WEBONB           BOL Load Number
     C                     Z-ADDP2GENB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WEB0DT           TH Kill Date
      * Establish starting position
     C           KRSTS     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWEAWDT    WUAWDT           TH Purchase Dat
     C                     MOVELWEBICD    WUBICD           TH Group Refere
     C                     MOVELWECPST    WUCPST           TH Live Purchas
     C                     Z-ADDWEACPR    WUACPR           TH Live Purchas
     C                     MOVELWEC4ST    WUC4ST           TH Resale UOM
     C                     Z-ADDWEAIPR    WUAIPR           TH Recalc Live
     C                     Z-ADDWEA6DT    WUA6DT           TH Pricing Date
     C                     MOVELWEC2ST    WUC2ST           TH Resale Sprea
     C                     Z-ADDWECXNB    WUCXNB           TH Dead On Arri
     C                     Z-ADDWECWNB    WUCWNB           TH Head Receive
     C                     Z-ADDWEFCNB    WUFCNB           TH Yard Deads
     C                     Z-ADDWEH9NB    WUH9NB           TH Held Over
     C                     Z-ADDWEFDNB    WUFDNB           TH Head Condemn
     C                     Z-ADDWEFENB    WUFENB           TH Head Killed
     C                     Z-ADDWEHENB    WUHENB           TH Head Adds
     C                     Z-ADDWEHFNB    WUHFNB           TH Head Accepte
     C                     Z-ADDWECYNB    WUCYNB           TH Live Wgt
     C                     Z-ADDWEE0NB    WUE0NB           TH Hot Wgt
     C                     Z-ADDWEA5PC    WUA5PC           TH Tot Loin Eye
     C                     Z-ADDWEFBNB    WUFBNB           TH Tot Backfat
     C                     Z-ADDWEA4PC    WUA4PC           TH Tot Light Re
     C                     Z-ADDWEF7NB    WUF7NB           TH Avg Live Wgt
     C                     Z-ADDWEHDNB    WUHDNB           TH Avg Hot Wgt
     C                     Z-ADDWEF5NB    WUF5NB           TH Avg Light Re
     C                     Z-ADDWEF4NB    WUF4NB           TH Avg Lean Per
     C                     Z-ADDWEF3NB    WUF3NB           TH Avg Loin Eye
     C                     Z-ADDWEF2NB    WUF2NB           TH Avg Backfat
     C                     Z-ADDWEAVPC    WUAVPC           TH Std Yield Pe
     C                     Z-ADDWEAWPC    WUAWPC           TH Actual Yield
     C                     Z-ADDWEA8PC    WUA8PC           TH Yield Differ
     C                     Z-ADDWEA7PC    WUA7PC           TH Recalc Live
     C                     Z-ADDWEAMPR    WUAMPR           TH CM Base Mkt
     C                     Z-ADDWEANPR    WUANPR           TH CM Base Mkt
     C                     Z-ADDWEAYVA    WUAYVA           TH CM Sort Disc
     C                     Z-ADDWEAWVA    WUAWVA           TH CM Yield Gai
     C                     Z-ADDWEAOPR    WUAOPR           TH CM Base Carc
     C                     Z-ADDWEAXVA    WUAXVA           TH CM LN AddOn/
     C                     Z-ADDWEAPPR    WUAPPR           TH CM Carcass G
     C                     Z-ADDWEASPR    WUASPR           TH Deduction Am
     C                     Z-ADDWEA4VA    WUA4VA           TH Total Net WO
     C                     Z-ADDWEATPR    WUATPR           TH Carcass Net
     C                     Z-ADDWEA5VA    WUA5VA           TH Additions Am
     C                     Z-ADDWEA7VA    WUA7VA           TH Accrual Amou
     C                     Z-ADDWEA2PR    WUA2PR           TH Fixed Cost A
     C                     MOVELWECWST    WUCWST           TH Payment Sts
     C                     MOVELWED7ST    WUD7ST           TH Header Error
     C                     MOVELWED8ST    WUD8ST           TH Detail Error
     C                     MOVELWEDWST    WUDWST           TH Kill Balanci
     C                     MOVELWED6ST    WUD6ST           TH Bal to Kill
     C                     Z-ADDWEGHNB    WUGHNB           TH Commission A
     C                     Z-ADDWEBYDT    WUBYDT           TH Voucher Paym
     C                     MOVELWEE0ST    WUE0ST           TH User Error O
     C                     MOVELWEE1ST    WUE1ST           TH Held Over Re
     C                     MOVELWEE2ST    WUE2ST           TH Sex
     C                     Z-ADDWEBSDT    WUBSDT           TH Held/Ovr Com
     C                     Z-ADDWEBTDT    WUBTDT           TH Commission P
     C                     Z-ADDWEBUDT    WUBUDT           TH Actual Check
     C                     Z-ADDWEHGNB    WUHGNB           TH Shipped Weig
     C                     Z-ADDWEHHNB    WUHHNB           TH Avg Hot Wgt
     C                     Z-ADDWEHINB    WUHINB           TH FFLI
     C                     Z-ADDWEA3PR    WUA3PR           TH Kill Product
     C                     Z-ADDWEA4PR    WUA4PR           TH Cut Product
     C                     Z-ADDWEA6PR    WUA6PR           TH Render Produ
     C                     Z-ADDWET2HD    WUT2HD           TH Shift Held O
     C                     MOVELWEBDCD    WUBDCD           DF Defect Code
     C                     MOVELWECSCD    WUCSCD           THP Process Cod
     C                     MOVELWEACCD    WUACCD           HB Buyer Code
     C                     MOVELWEAGCD    WUAGCD           GN Genetic Code
     C                     MOVELWEBECD    WUBECD           HC Class Code
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUMAPR           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAHMNB    WQTT01           BOH Company Num
     C           *LIKE     DEFN WABNNB    WQTT02           BOH Buy Order N
     C           *LIKE     DEFN WABONB    WQTT03           BOL Load Number
     C           *LIKE     DEFN WACVNB    WQTT04           TH Tattoo Numbe
     C           *LIKE     DEFN WAB0DT    WQTT05           TH Kill Date
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           BOH Company Num
     C                     KFLD           WQTT02           BOH Buy Order N
     C                     KFLD           WQTT03           BOL Load Number
     C                     KFLD           WQTT04           TH Tattoo Numbe
     C                     KFLD           WQTT05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTT01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTT02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTT03           BOL Load Number
     C                     Z-ADDP2GENB    WQTT04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTT05           TH Kill Date
      * Establish starting position
     C           KRSTT     SETLL@CDCPIU                    *
     C           KRSTT     READE@CDCPIU                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD*ZERO     WUIVPR           TH Additions Am
     C                     Z-ADD*ZERO     WUIUPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUMAPR           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WAEIST    IFEQ 'CH'                       *IF
     C           WAEIST    OREQ 'DH'
     C           WAEIST    OREQ 'DY'
     C           WAEIST    OREQ 'YH'
     C           WAEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Process Producer Ded/Add only
      * CASE: PAR.Exp Payed By Who Usr is Producer
     C           WUPRST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Expense Paid by is Producer
     C           WAPEST    IFEQ 'P'                        *IF
      * Freight for the producer is included in ded/add totals
      * There are no accruals for producer
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUIVPR           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WAA0VA    WUIUPR           TH Deduction Am
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Process Seaboard Expense
      * CASE: PAR.Exp Payed By Who Usr is Seaboard
     C           WUPRST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WAPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WAPFST    IFEQ 'F'                        *IF
      * Freight should only be a +
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WAPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WAJBST    IFEQ '+'                        *IF
     C                     ADD  WAA0VA    WUMAPR           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WAA0VA    WUMAPR           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTT     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TURVGN    BEGSR
      *================================================================
      * Rtv/Chg Tto DAd AdjSJ SB - Tattoo Ded/Add  * * SEABOARD *
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFHMNB    WQTU01           BOH Company Num
     C           *LIKE     DEFN WFBNNB    WQTU02           BOH Buy Order N
     C           *LIKE     DEFN WFBONB    WQTU03           BOL Load Number
     C           *LIKE     DEFN WFCVNB    WQTU04           TH Tattoo Numbe
     C           *LIKE     DEFN WFB0DT    WQTU05           TH Kill Date
      * Define keylist
     C           KRSTU     KLIST
     C                     KFLD           WQTU01           BOH Company Num
     C                     KFLD           WQTU02           BOH Buy Order N
     C                     KFLD           WQTU03           BOL Load Number
     C                     KFLD           WQTU04           TH Tattoo Numbe
     C                     KFLD           WQTU05           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WQTU01           BOH Company Num
     C                     Z-ADDP1BNNB    WQTU02           BOH Buy Order N
     C                     Z-ADDP1BONB    WQTU03           BOL Load Number
     C                     Z-ADDP2GENB    WQTU04           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WQTU05           TH Kill Date
      * Establish starting position
     C           KRSTU     SETLL@CDCPWY                    *
     C           KRSTU     READE@CDCPWY                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WFPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WFPFST    IFEQ 'F'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: PAR.TH Accrual Amount GT PAR.Exp Paid By Amount Usr
     C           WUA7VA    IFGT WUMAPR                     *IF
     C           WUA7VA    SUB  WUMAPR    WUA0VA           THD Ded/Add Amo
     C                     ADD  WFA0VA    WUA0VA           THD Ded/Add Amo
     C                     ELSE
      * CASE: *OTHERWISE
     C           WUMAPR    SUB  WUA7VA    WUA0VA           THD Ded/Add Amo
     C           WFA0VA    SUB  WUA0VA    WUA0VA           THD Ded/Add Amo
     C                     END                             *FI
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TVCHRC
     C                     GOTO TUEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSTU     READE@CDCPWY                  90*
     C                     ENDDO
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YURDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTV    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTV    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL021.
     C                     MOVEL'LBL021'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TVEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TVEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YURDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDWUA0VA    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST    P      THD UOM
     C                     MOVELWFJDST    WCJDST    P      THD Transaction
     C                     MOVELWFDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWFE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWFPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWFPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWFPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    WCPIST    P      THD Commission
     C                     MOVELWFPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    WCPKST    P      THD Status 4
     C                     MOVELWFPLST    WCPLST    P      THD Status 5
     C                     MOVELWFAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WCAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WCAMTM           RS Time Changed
     C                     MOVELWFAJST    WCAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WCAHVN    P      RS Job
     C                     MOVELWFAGVN    WCAGVN    P      RS Program
     C                     MOVELWFABVN    WCABVN    P      RS User Added
     C                     Z-ADDWFABDT    WCABDT           RS Date Added
     C                     Z-ADDWFABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YURDCS
     C           YURDC     ANDNE'N'
     C                     MOVE 'Y'       YURDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YURDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv/Chg TTO DAd SB FrtSJ - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
     C                     KFLD           WFBQCD           DED D/A Code
      * Setup key
     C                     Z-ADDP1HMNB    WFHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WFBONB           BOL Load Number
     C                     Z-ADDP1CVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WFB0DT           TH Kill Date
     C                     MOVE *BLANK    WFBQCD           DED D/A Code
     C                     MOVEL'FRT'     WFBQCD           DED D/A Code
      * Establish starting position
     C           KRSTW     CHAIN@CDCPWY              90    *
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WFPEST    IFEQ 'S'                        *IF
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TXCHRC
      * Change or Create the next record
      * Rtv/Chg Tto Dad NxRd  RT - Tattoo Ded/Add  * 
     C                     EXSR TYRVGN
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXCHRC    BEGSR
      *================================================================
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YVRDC   1
      *
      * Move key fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDWFCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD    P      DED D/A Code
      *
     C           KLCHTX    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
     C           KLCHTX    CHAIN@CDCPIT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKCDCPL0'MDACP
     C                     MOVEL'@CDCPIT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL022.
     C                     MOVEL'LBL022'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TXEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKCD1    YVRDCS
      * Move non-key fields to @CDCPIT
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDP3MEPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST    P      THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST    P      THD UOM
     C                     MOVELWFJDST    WCJDST    P      THD Transaction
     C                     MOVELWFDPCD    WCDPCD    P      THD GL Code
     C                     MOVELWFE3CD    WCE3CD    P      THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST    P      THD Payment Sts
     C                     MOVELWFPEST    WCPEST    P      THD Expense Pai
     C                     MOVELWFPFST    WCPFST    P      THD Expense Typ
     C                     MOVELWFPGST    WCPGST    P      THD Reserve Acc
     C                     MOVELWFPIST    WCPIST    P      THD Commission
     C                     MOVELWFPJST    WCPJST    P      THD Deferred Pa
     C                     MOVELWFPKST    WCPKST    P      THD Status 4
     C                     MOVELWFPLST    WCPLST    P      THD Status 5
     C                     MOVELWFAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWFAADT    WCAADT           RS Date Changed
     C                     Z-ADDWFAMTM    WCAMTM           RS Time Changed
     C                     MOVELWFAJST    WCAJST    P      RS Record Statu
     C                     MOVELWFAHVN    WCAHVN    P      RS Job
     C                     MOVELWFAGVN    WCAGVN    P      RS Program
     C                     MOVELWFABVN    WCABVN    P      RS User Added
     C                     Z-ADDWFABDT    WCABDT           RS Date Added
     C                     Z-ADDWFABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKCD1    IFNE YVRDCS
     C           YVRDC     ANDNE'N'
     C                     MOVE 'Y'       YVRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YVRDC     IFEQ 'Y'
     C                     UPDAT@CDCPIT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKCDCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Rtv/Chg Tto Dad NxRd  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
     C                     KFLD           WABQCD           DED D/A Code
      * Setup key
     C                     Z-ADDWFHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WABONB           BOL Load Number
     C                     Z-ADDP2GENB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WAB0DT           TH Kill Date
     C                     MOVELWFBQCD    WABQCD           DED D/A Code
      * Establish starting position
     C           KRSTY     CHAIN@CDCPIU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0174' W0RTN   7
      * USER: Processing if Data record not found
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TZCRRC
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Change Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR NACHRC
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWFHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWFBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWFBONB    WCBONB           BOL Load Number
     C                     Z-ADDP2GENB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWFB0DT    WCB0DT           TH Kill Date
     C                     MOVELWFBQCD    WCBQCD           DED D/A Code
     C                     Z-ADDWFAZVA    WCAZVA           THD Unit Amt
     C                     Z-ADDP4MFPR    WCA0VA           THD Ded/Add Amo
     C                     MOVELWFJBST    WCJBST           THD Unit Amt Si
     C                     MOVELWFEIST    WCEIST           THD UOM
     C                     MOVELWFJDST    WCJDST           THD Transaction
     C                     MOVELWFDPCD    WCDPCD           THD GL Code
     C                     MOVELWFE3CD    WCE3CD           THD Contra Gl C
     C                     Z-ADDWFAQNB    WCAQNB           THD Re-imbursem
     C                     MOVELWFOCST    WCOCST           THD Payment Sts
     C                     MOVELWFPEST    WCPEST           THD Expense Pai
     C                     MOVELWFPFST    WCPFST           THD Expense Typ
     C                     MOVELWFPGST    WCPGST           THD Reserve Acc
     C                     MOVELWFPIST    WCPIST           THD Commission
     C                     MOVELWFPJST    WCPJST           THD Deferred Pa
     C                     MOVELWFPKST    WCPKST           THD Status 4
     C                     MOVELWFPLST    WCPLST           THD Status 5
     C                     MOVEL*BLANK    WCAAVN           RS User Changed
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
     C                     Z-ADD##JDT     WCABDT           RS Date Added
     C                     Z-ADD##JTM     WCABTM           RS Time Added
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTZ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C                     KFLD           WCBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTZ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *   length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Producer Totals Deduction/Add Tattoo Ded/Add
      *================================================================
      * Accumulate totals of ded/add for this current kill date
      *   Dont include D/A with Dead head uom in D/A totals
     C                     MOVEL'P'       WUPRST           Exp Payed By Wh
      * CASE: WRK.Exp Payed By Who Usr is Producer
     C           WUPRST    IFEQ 'P'                        *IF
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * * Rd of Prd only *
     C                     EXSR SARVGN
      * CASE: PAR.TH Deduction Amt NE WRK.TOT DEDUCTION Usr
     C           P1ASPR    IFNE WUIUPR                     *IF
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * Spread new total amoung the ded
      * Rtv/Chg Tto Ddd Sbj    RT - Tattoo Ded/Add  * * Producer *
     C                     EXSR SBRVGN
      * Rtv/Chg Tto Ddd Sbj    RT - Tattoo Ded/Add  * * Producer *
     C                     EXSR SHRVGN
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * CASE: PAR.TH Additions Amt NE WRK.TOT ADDITION Usr
     C           P1A5VA    IFNE WUIVPR                     *IF
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * Spread new total amoung the add
      * Rtv/Chg Tto Dad Sbj    RT - Tattoo Ded/Add  * * Producer *
     C                     EXSR SNRVGN
      * Rtv/Chg Tto Dad Sbj    RT - Tattoo Ded/Add  * * Producer *
     C                     EXSR STRVGN
     C                     END                             *FI
      * Verify that ded/add for next kill date = totals from tattoo hdr
      * Accumulate totals of ded/add for this next kill date
     C                     Z-ADD*ZERO     WUIVPR           TOT ADDITION Us
     C                     Z-ADD*ZERO     WUIUPR           TOT DEDUCTION U
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * RTV Tattoo Record     RT - Tattoo Header  * 
     C                     EXSR SZRVGN
      *   Include D/A with Dead head uom in D/A totals
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * * Rd of Prd Only *
     C                     EXSR TARVGN
      * CASE: WRK.TH Deduction Amt NE WRK.TOT DEDUCTION Usr
     C           WUASPR    IFNE WUIUPR                     *IF
      * Spread new total amoung the ded
      * Rtv/chg Tto Ddd Adjrt  RT - Tattoo Ded/Add  * * Producer *
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * CASE: PAR.TH Additions Amt NE WRK.TOT ADDITION Usr
     C           P1A5VA    IFNE WUIVPR                     *IF
      * Spread new total amoung the add
      * Rtv/chg Tto Dad Adjrt  RT - Tattoo Ded/Add  * * Producer *
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Seaboard Totals Deduction/Add Tattoo Ded/Add Accruals
      *================================================================
      * Accumulate totals of ded/add for this current kill date
      *   Dont include D/A with Dead head uom in D/A totals
     C                     MOVEL'S'       WUPRST           Exp Payed By Wh
      * CASE: WRK.Exp Payed By Who Usr is Seaboard
     C           WUPRST    IFEQ 'S'                        *IF
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * * seaboard *
     C                     EXSR TFRVGN
     C                     Z-ADDWUA7VA    WUMDPR           Exp Amount Tota
      * CASE: PAR.Th Accruals Amt Org Usr NE WRK.Exp Amount Total F/A Usr
     C           P5L8PR    IFNE WUMDPR                     *IF
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * Spread new total amoung the ded
      * Rtv/Chg Ttto Dd Sbj SB RT - Tattoo Ded/Add  * * seaboard *
     C                     EXSR TGRVGN
      * Rtv/Chg Ttto Dd Sbj SB RT - Tattoo Ded/Add  * * Seaboard *
     C                     EXSR TMRVGN
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * Verify that ded/add for next kill date = totals from tattoo hdr
      * Accumulate totals of ded/add for this next kill date
      * RTV Tattoo Record     RT - Tattoo Header  * 
     C                     EXSR TSRVGN
      *   Include D/A with Dead head uom in D/A totals
      * Rtv Ttto Hdr Ttl Pd/Sb RT - Tattoo Ded/Add  * 
     C                     EXSR TTRVGN
      * CASE: WRK.TH Accrual Amount NE WRK.Exp Amount Total F/A Usr
     C           WUA7VA    IFNE WUMDPR                     *IF
      * Spread new total amoung the ded
      * Rtv/Chg Tto DAd AdjSJ SB - Tattoo Ded/Add  * * SEABOARD *
     C                     EXSR TURVGN
     C                     END                             *FI
     C                     Z-ADD*ZERO     WUIZPR           tot Amt fld 2 U
      * Seaboard Totals for Freight
     C                     EXSR UDSUBR                     Seaboard Totals
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Seaboard Totals for Freight
      *================================================================
      * There is a 1 for 1 frt transaction
      * So what the total frt is for the current  = ded/add frt
      * If this frt is for the next then
      *    must = next kill ded/add
      * CASE: WRK.Exp Payed By Who Usr is Seaboard
     C           WUPRST    IFEQ 'S'                        *IF
      * Current Tattoo number update frt then update new tattoo number
      * Rtv/Chg TTO DAd SB FrtSJ - Tattoo Ded/Add  * 
     C                     EXSR TWRVGN
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field TOT ADDITION Usr
     C                     Z-ADD*ZERO     WUIVPR  72
      * Define work field TOT DEDUCTION Usr
     C                     Z-ADD*ZERO     WUIUPR  72
      * Define work field Exp Payed By Who Usr
     C                     MOVEL*BLANK    WUPRST  1
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Define work field Freight Tot Ded/Add Exp
     C                     Z-ADD*ZERO     WUMCPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WAA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WAAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field tot Amt fld 2 Usr
     C                     Z-ADD*ZERO     WUIZPR  72
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field @Percent Fld Usr
     C                     Z-ADD*ZERO     WUFMPC  74
      * Define work field THD Ded/Add Amount
     C                     Z-ADD*ZERO     WUA0VA  72
      * Define work field Tot Amt fld 1 usr
     C                     Z-ADD*ZERO     WUIYPR  72
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Percent USR
     C                     Z-ADD*ZERO     WUBCPC  30
      * Define work field TH Purchase Date
     C                     Z-ADD*ZERO     WUAWDT  70
      * Define work field TH Group Reference
     C                     MOVEL*BLANK    WUBICD 10
      * Define work field TH Live Purchase UOM
     C                     MOVEL*BLANK    WUCPST  2
      * Define work field TH Live Purchase Price
     C                     Z-ADD*ZERO     WUACPR  52
      * Define work field TH Resale UOM
     C                     MOVEL*BLANK    WUC4ST  2
      * Define work field TH Recalc Live Wgt Yld
     C                     Z-ADD*ZERO     WUAIPR  52
      * Define work field TH Pricing Date
     C                     Z-ADD*ZERO     WUA6DT  70
      * Define work field TH Resale Spread Sts
     C                     MOVEL*BLANK    WUC2ST  1
      * Define work field TH Dead On Arrival
     C                     Z-ADD*ZERO     WUCXNB  50
      * Define work field TH Head Received
     C                     Z-ADD*ZERO     WUCWNB  50
      * Define work field TH Yard Deads
     C                     Z-ADD*ZERO     WUFCNB  50
      * Define work field TH Held Over
     C                     Z-ADD*ZERO     WUH9NB  50
      * Define work field TH Head Condemned
     C                     Z-ADD*ZERO     WUFDNB  50
      * Define work field TH Head Killed
     C                     Z-ADD*ZERO     WUFENB  50
      * Define work field TH Head Adds
     C                     Z-ADD*ZERO     WUHENB  50
      * Define work field TH Head Accepted
     C                     Z-ADD*ZERO     WUHFNB  50
      * Define work field TH Live Wgt
     C                     Z-ADD*ZERO     WUCYNB  71
      * Define work field TH Hot Wgt
     C                     Z-ADD*ZERO     WUE0NB  71
      * Define work field TH Tot Loin Eye Depth
     C                     Z-ADD*ZERO     WUA5PC  61
      * Define work field TH Tot Backfat Inches
     C                     Z-ADD*ZERO     WUFBNB  61
      * Define work field TH Tot Light Reflectance
     C                     Z-ADD*ZERO     WUA4PC  61
      * Define work field TH Avg Live Wgt
     C                     Z-ADD*ZERO     WUF7NB  51
      * Define work field TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WUHDNB  51
      * Define work field TH Avg Light Reflectance
     C                     Z-ADD*ZERO     WUF5NB  31
      * Define work field TH Avg Lean Percent
     C                     Z-ADD*ZERO     WUF4NB  31
      * Define work field TH Avg Loin Eye Depth
     C                     Z-ADD*ZERO     WUF3NB  31
      * Define work field TH Avg Backfat
     C                     Z-ADD*ZERO     WUF2NB  31
      * Define work field TH Std Yield Percent
     C                     Z-ADD*ZERO     WUAVPC  52
      * Define work field TH Actual Yield %
     C                     Z-ADD*ZERO     WUAWPC  52
      * Define work field TH Yield Difference
     C                     Z-ADD*ZERO     WUA8PC  52
      * Define work field TH Recalc Live Wgt
     C                     Z-ADD*ZERO     WUA7PC  31
      * Define work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     WUAMPR  52
      * Define work field TH CM Base Mkt Price Amt
     C                     Z-ADD*ZERO     WUANPR  72
      * Define work field TH CM Sort Discount Amt
     C                     Z-ADD*ZERO     WUAYVA  72
      * Define work field TH CM Yield Gain/Loss Amt
     C                     Z-ADD*ZERO     WUAWVA  72
      * Define work field TH CM Base Carcass Value
     C                     Z-ADD*ZERO     WUAOPR  72
      * Define work field TH CM LN AddOn/Deduct Amt
     C                     Z-ADD*ZERO     WUAXVA  72
      * Define work field TH CM Carcass Gross Amt
     C                     Z-ADD*ZERO     WUAPPR  72
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field TH Fixed Cost Amount
     C                     Z-ADD*ZERO     WUA2PR  72
      * Define work field TH Payment Sts
     C                     MOVEL*BLANK    WUCWST  2
      * Define work field TH Header Error Sts
     C                     MOVEL*BLANK    WUD7ST  1
      * Define work field TH Detail Error Sts
     C                     MOVEL*BLANK    WUD8ST  1
      * Define work field TH Kill Balancing Sts
     C                     MOVEL*BLANK    WUDWST  1
      * Define work field TH Bal to Kill Gen
     C                     MOVEL*BLANK    WUD6ST  1
      * Define work field TH Commission A/P Voucher
     C                     Z-ADD*ZERO     WUGHNB  80
      * Define work field TH Voucher Payment Date
     C                     Z-ADD*ZERO     WUBYDT  70
      * Define work field TH User Error Override
     C                     MOVEL*BLANK    WUE0ST  1
      * Define work field TH Held Over Record
     C                     MOVEL*BLANK    WUE1ST  1
      * Define work field TH Sex
     C                     MOVEL*BLANK    WUE2ST  1
      * Define work field TH Held/Ovr Completed Dte
     C                     Z-ADD*ZERO     WUBSDT  70
      * Define work field TH Commission Paid Date
     C                     Z-ADD*ZERO     WUBTDT  70
      * Define work field TH Actual Check Date
     C                     Z-ADD*ZERO     WUBUDT  70
      * Define work field TH Shipped Weight
     C                     Z-ADD*ZERO     WUHGNB  71
      * Define work field TH Avg Hot Wgt EXC/ADD
     C                     Z-ADD*ZERO     WUHHNB  71
      * Define work field TH FFLI
     C                     Z-ADD*ZERO     WUHINB  31
      * Define work field TH Kill Product Value
     C                     Z-ADD*ZERO     WUA3PR  72
      * Define work field TH Cut Product Value
     C                     Z-ADD*ZERO     WUA4PR  72
      * Define work field TH Render Product Value
     C                     Z-ADD*ZERO     WUA6PR  72
      * Define work field TH Shift Held Over Head
     C                     Z-ADD*ZERO     WUT2HD  50
      * Define work field DF Defect Code
     C                     MOVEL*BLANK    WUBDCD  6
      * Define work field THP Process Code
     C                     MOVEL*BLANK    WUCSCD  6
      * Define work field HB Buyer Code
     C                     MOVEL*BLANK    WUACCD  3
      * Define work field GN Genetic Code
     C                     MOVEL*BLANK    WUAGCD  5
      * Define work field HC Class Code
     C                     MOVEL*BLANK    WUBECD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WEBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WEBONB           BOL Load Number
     C                     Z-ADD*ZERO     WECVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WEB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WEAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WEACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WEB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WECAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WEAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WEA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WECXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WECWNB           TH Head Receive
     C                     Z-ADD*ZERO     WEFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WEH9NB           TH Held Over
     C                     Z-ADD*ZERO     WEFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WEFENB           TH Head Killed
     C                     Z-ADD*ZERO     WEHENB           TH Head Adds
     C                     Z-ADD*ZERO     WEHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WECYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WELRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WEE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WEA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WEFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WEA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WEF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WEHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WEF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WEF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WEAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WEAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WECWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WEA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WEA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WEB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WEAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WEAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WEAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WEAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WEAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WEAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WEASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WEA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WEATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WEA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WECBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WECCPR           Th Payment Net
     C                     Z-ADD*ZERO     WELPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WECDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WEA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WEA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WEGHNB           TH Commission A
     C                     Z-ADD*ZERO     WEBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WEBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WEBTDT           TH Commission P
     C                     Z-ADD*ZERO     WEBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WEHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WEHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WEHINB           TH FFLI
     C                     Z-ADD*ZERO     WEA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WEA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WEA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WEJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WED6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WED7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WED8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WED9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WEEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WEEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WEECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WEEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WEEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WEEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WEEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WEOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WETHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WET2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WETHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WET2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WEOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WEKOER           TH Head Identif
     C                     Z-ADD*ZERO     WEOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WEOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WEIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WEOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WEHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WES9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WETAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WETBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WEJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WEKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WEKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WEKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WEKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WEOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WEIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WEIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WEIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WEKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WEKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WEORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WEOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WEMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WEMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WENCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WENCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WEIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WEKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WEEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WEECDT           TH Head LFT
     C                     Z-ADD*ZERO     WEEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WEEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Exp Amount Total F/A Usr
     C                     Z-ADD*ZERO     WUMDPR  72
      * Define work field Exp Paid By Amount Usr
     C                     Z-ADD*ZERO     WUMAPR  72
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
