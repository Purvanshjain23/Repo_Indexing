     H/TITLE UPD Revalue Inv/Sls Pc XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 02/15/06  Time  : 08:09:58
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FCAAFREL5IF  E           K        DISK
      * RSQ : Calendar                  RSQ Co/Yr/Period/OMWeek
      *
     FOMHSTPLIIF  E           K        DISK
      * RSQ : Sales History             RSQ Whse/Shipped Item/da
      *
     FOPEXREL2IF  E           K        DISK
      * RTV : Order Types               Active order Types
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAB1REL8IF  E           K        DISK
      * RSQ : Item Balance Detail      Co/Item/Whse/PrdDt (D)Sel
      *
     FCAB7CPLEIF  E           K        DISK
      * RSQ : Item Transaction Detail   Normal KEY Sequence (D)
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : Item Balance              Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : Item Balance Detail       Update index
      *
     FCAB7CPL0IF  E           K        DISK                      A
      * UPD : Item Transaction Detail   Update index
      *
     FPDKZCPL0IF  E           K        DISK                      A
      * UPD : Item Values               Update index
      *
      * Long constants
     E                    @CN#    1   1  6   @CN    25
     I@B0REHD
      * Item Balance              Co/Whse/Item
      * Renamed input format fields
     I              B0AIC3                          WAAIC3
     I              B0HGCD                          WAHGCD
     I              B0AJCD                          WAAJCD
     I              B0AGCS                          WAAGCS
     I              B0AECS                          WAAECS
     I              B0BACS                          WABACS
     I              B0BBCS                          WABBCS
     I              B0CBPR                          WACBPR
     I              B0GUDT                          WAGUDT
     I              B0XYST                          WAXYST
     I              B0CTPR                          WACTPR
     I              B0G4DT                          WAG4DT
     I              B0BOWG                          WABOWG
     I              B0DDQT                          WADDQT
     I              B0DEQT                          WADEQT
     I              B0DFQT                          WADFQT
     I              B0HDQT                          WAHDQT
     I              B0HEQT                          WAHEQT
     I              B0AJQT                          WAAJQT
     I              B0AQQT                          WAAQQT
     I              B0AUQT                          WAAUQT
     I              B0EMQT                          WAEMQT
     I              B0DOQT                          WADOQT
     I              B0ATNA                          WAATNA
     I              B0AKDT                          WAAKDT
     I              B0ANDT                          WAANDT
     I              B0IDVA                          WAIDVA
     I              B0JVST                          WAJVST
     I              B0BZPC                          WABZPC
     I              B0DGQT                          WADGQT
     I              B0DIDT                          WADIDT
     I              B0ALCD                          WAALCD
     I              B0BFDY                          WABFDY
     I              B0DJDT                          WADJDT
     I              B0BGDY                          WABGDY
     I              B0DKDT                          WADKDT
     I              B0J2ST                          WAJ2ST
     I              B0DJQT                          WADJQT
     I              B0BNWG                          WABNWG
     I              B0DLDT                          WADLDT
     I              B0DPQT                          WADPQT
     I              B0DQQT                          WADQQT
     I              B0DMDT                          WADMDT
     I              B0M0ST                          WAM0ST
     I              B0J9ST                          WAJ9ST
     I              B0KBST                          WAKBST
     I              B0AKC8                          WAAKC8
     I              B0RINB                          WARINB
     I              B0RHNB                          WARHNB
     I              B0RGNB                          WARGNB
     I              B0UVST                          WAUVST
     I              B0UWST                          WAUWST
     I              B0UXST                          WAUXST
     I              B0VSST                          WAVSST
     I              B0AATM                          WAAATM
     I              B0AYNA                          WAAYNA
     I              B0A0NA                          WAA0NA
     I              B0AXDT                          WAAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WBAIC3
     I              AFBCDT                          WBBCDT
     I              AFCQNB                          WBCQNB
     I              AFESNB                          WBESNB
     I              AFETNB                          WBETNB
     I              AFBZNB                          WBBZNB
     I              AFA9ST                          WBA9ST
     I              AFEINB                          WBEINB
     I              AFC5ST                          WBC5ST
     I              AFAQNB                          WBAQNB
     I              AFCMST                          WBCMST
     I              AFV9ST                          WBV9ST
     I              AFWAST                          WBWAST
     I              AFX2ST                          WBX2ST
     I              AFOJDT                          WBOJDT
     I              AFNQNX                          WBNQNX
     I              AFNRNX                          WBNRNX
     I              AFI9SX                          WBI9SX
     I              AFJASX                          WBJASX
     I              AFOKDT                          WBOKDT
     I              AFOLDT                          WBOLDT
     I              AFUVST                          WBUVST
     I              AFUWST                          WBUWST
     I              AFUXST                          WBUXST
     I              AFAATM                          WBAATM
     I              AFAYNA                          WBAYNA
     I              AFA0NA                          WBA0NA
     I              AFAXDT                          WBAXDT
      *
     I@AFREOI
      * Calendar                  RSQ Co/Yr/Period/OMWeek
      * Renamed input format fields
     I              AFAIC3                          WCAIC3
     I              AFBCDT                          WCBCDT
     I              AFCQNB                          WCCQNB
     I              AFESNB                          WCESNB
     I              AFETNB                          WCETNB
     I              AFBZNB                          WCBZNB
     I              AFA9ST                          WCA9ST
     I              AFEINB                          WCEINB
     I              AFC5ST                          WCC5ST
     I              AFAQNB                          WCAQNB
     I              AFCMST                          WCCMST
     I              AFV9ST                          WCV9ST
     I              AFWAST                          WCWAST
     I              AFX2ST                          WCX2ST
     I              AFOJDT                          WCOJDT
     I              AFNQNX                          WCNQNX
     I              AFNRNX                          WCNRNX
     I              AFI9SX                          WCI9SX
     I              AFJASX                          WCJASX
     I              AFOKDT                          WCOKDT
     I              AFOLDT                          WCOLDT
     I              AFUVST                          WCUVST
     I              AFUWST                          WCUWST
     I              AFUXST                          WCUXST
     I              AFAATM                          WCAATM
     I              AFAYNA                          WCAYNA
     I              AFA0NA                          WCA0NA
     I              AFAXDT                          WCAXDT
      *
     I@HSTPNF
      * Sales History             RSQ Whse/Shipped Item/da
      * Renamed input format fields
     I              F4AIC3                          WDAIC3
     I              F4C4NB                          WDC4NB
     I              F4DPNB                          WDDPNB
     I              F4UENB                          WDUENB
     I              F4MONA                          WDMONA
     I              F4RJCD                          WDRJCD
     I              F4RKCD                          WDRKCD
     I              F4GPTX                          WDGPTX
     I              F4ABTX                          WDABTX
     I              F4KXCD                          WDKXCD
     I              F4BOCD                          WDBOCD
     I              F4BTC7                          WDBTC7
     I              F4ANC7                          WDANC7
     I              F4AQTX                          WDAQTX
     I              F4BKC7                          WDBKC7
     I              F4BRTX                          WDBRTX
     I              F4HNNA                          WDHNNA
     I              F4DBCD                          WDDBCD
     I              F4CKTX                          WDCKTX
     I              F4BCNA                          WDBCNA
     I              F4A0DT                          WDA0DT
     I              F4ACDT                          WDACDT
     I              F4R4CD                          WDR4CD
     I              F4R5CD                          WDR5CD
     I              F4BFCD                          WDBFCD
     I              F4Q4CD                          WDQ4CD
     I              F4AQCD                          WDAQCD
     I              F4TBNB                          WDTBNB
     I              F4BZNA                          WDBZNA
     I              F4RLCD                          WDRLCD
     I              F4JNCD                          WDJNCD
     I              F4Q2CD                          WDQ2CD
     I              F4U2ST                          WDU2ST
     I              F4ATIN                          WDATIN
     I              F4T3NB                          WDT3NB
     I              F4RSRN                          WDRSRN
     I              F4ORIT                          WDORIT
     I              F4AJCD                          WDAJCD
     I              F4AVQT                          WDAVQT
     I              F4D0WG                          WDD0WG
     I              F4CCQT                          WDCCQT
     I              F4AUWG                          WDAUWG
     I              F4AGCD                          WDAGCD
     I              F4AKPR                          WDAKPR
     I              F4AUPR                          WDAUPR
     I              F4CRCD                          WDCRCD
     I              F4A5DT                          WDA5DT
     I              F4AWDT                          WDAWDT
     I              F4HDDT                          WDHDDT
     I              F4AGCS                          WDAGCS
     I              F4AQCS                          WDAQCS
     I              F4AVWG                          WDAVWG
     I              F4AYVA                          WDAYVA
     I              F4AMST                          WDAMST
     I              F4ANST                          WDANST
     I              F4VAST                          WDVAST
     I              F4L6NB                          WDL6NB
     I              F4UMCD                          WDUMCD
     I              F4HCDT                          WDHCDT
     I              F4ESNB                          WDESNB
     I              F4ETNB                          WDETNB
     I              F4BZNB                          WDBZNB
     I              F4EXQT                          WDEXQT
     I              F4BYWG                          WDBYWG
     I              F4S5NB                          WDS5NB
     I              F4MAVA                          WDMAVA
     I              F4KDVA                          WDKDVA
     I              F4USVA                          WDUSVA
     I              F4UTVA                          WDUTVA
     I              F4A4WG                          WDA4WG
     I              F4CKNB                          WDCKNB
     I              F4BMST                          WDBMST
     I              F4R8NB                          WDR8NB
     I              F4RMCD                          WDRMCD
     I              F4BZPR                          WDBZPR
     I              F4RDCD                          WDRDCD
     I              F4Q7CD                          WDQ7CD
     I              F4EXDT                          WDEXDT
     I              F4LQCD                          WDLQCD
     I              F4HICD                          WDHICD
     I              F4RBCD                          WDRBCD
     I              F4RGNB                          WDRGNB
     I              F4RHNB                          WDRHNB
     I              F4RINB                          WDRINB
     I              F4R1NB                          WDR1NB
     I              F4CONB                          WDCONB
     I              F4CEST                          WDCEST
     I              F4GNDT                          WDGNDT
     I              F4RMNB                          WDRMNB
     I              F4AODT                          WDAODT
     I              F4LLCD                          WDLLCD
     I              F4LMCD                          WDLMCD
     I              F4SKNB                          WDSKNB
     I              F4SLNB                          WDSLNB
     I              F4SMNB                          WDSMNB
     I              F4G7NA                          WDG7NA
     I              F4ONVA                          WDONVA
     I              F4N0CD                          WDN0CD
     I              F4B4NB                          WDB4NB
     I              F4B5NB                          WDB5NB
     I              F4N1CD                          WDN1CD
     I              F4GIDT                          WDGIDT
     I              F4Z1ST                          WDZ1ST
     I              F4ULVA                          WDULVA
     I              F4UNVA                          WDUNVA
     I              F4UOVA                          WDUOVA
     I              F4UPVA                          WDUPVA
     I              F4UQVA                          WDUQVA
     I              F4SDCD                          WDSDCD
     I              F4QZCD                          WDQZCD
     I              F4XWST                          WDXWST
     I              F4T9CD                          WDT9CD
     I              F4UBCD                          WDUBCD
     I              F4CFC7                          WDCFC7
     I              F4X1CD                          WDX1CD
     I              F4GASX                          WDGASX
     I              F4DUPR                          WDDUPR
     I              F4B6VL                          WDB6VL
     I              F4IANX                          WDIANX
     I              F4IBNX                          WDIBNX
     I              F4RPCD                          WDRPCD
     I              F4NYDT                          WDNYDT
     I              F4BZTM                          WDBZTM
     I              F4Z4NB                          WDZ4NB
     I              F4XACD                          WDXACD
     I              F4OANA                          WDOANA
     I              F4OKTX                          WDOKTX
     I              F4K4TX                          WDK4TX
     I              F4NBBO                          WDNBBO
     I              F4OCFR                          WDOCFR
     I              F4C0C7                          WDC0C7
     I              F4A1AA                          WDA1AA
     I              F4VEST                          WDVEST
     I              F4A5PR                          WDA5PR
     I              F4CDPR                          WDCDPR
     I              F4D0PR                          WDD0PR
     I              F4D0VL                          WDD0VL
     I              F4IRSX                          WDIRSX
     I              F4CEVL                          WDCEVL
     I              F4ISSX                          WDISSX
     I              F4ITSX                          WDITSX
     I              F4IUSX                          WDIUSX
     I              F4OHDT                          WDOHDT
     I              F4D9PR                          WDD9PR
     I              F4CFVL                          WDCFVL
     I              F4UVST                          WDUVST
     I              F4UWST                          WDUWST
     I              F4UXST                          WDUXST
     I              F4AATM                          WDAATM
     I              F4AYNA                          WDAYNA
     I              F4A0NA                          WDA0NA
     I              F4AXDT                          WDAXDT
      *
     I@EXRETY
      * Order Types               Active order Types
      * Renamed input format fields
     I              EXJNCD                          WEJNCD
     I              EXJVNA                          WEJVNA
     I              EXOAST                          WEOAST
     I              EXOBST                          WEOBST
     I              EXOEST                          WEOEST
     I              EXOFST                          WEOFST
     I              EXVBST                          WEVBST
     I              EXPYST                          WEPYST
     I              EXX8ST                          WEX8ST
     I              EXISTX                          WEISTX
     I              EXUVST                          WEUVST
     I              EXUWST                          WEUWST
     I              EXUXST                          WEUXST
     I              EXVSST                          WEVSST
     I              EXAATM                          WEAATM
     I              EXAYNA                          WEAYNA
     I              EXA0NA                          WEA0NA
     I              EXAXDT                          WEAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@B0REJT
      * Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WGAIC3
     I              B0HGCD                          WGHGCD
     I              B0AJCD                          WGAJCD
     I              B0AGCS                          WGAGCS
     I              B0AECS                          WGAECS
     I              B0BACS                          WGBACS
     I              B0BBCS                          WGBBCS
     I              B0CBPR                          WGCBPR
     I              B0GUDT                          WGGUDT
     I              B0XYST                          WGXYST
     I              B0CTPR                          WGCTPR
     I              B0G4DT                          WGG4DT
     I              B0BOWG                          WGBOWG
     I              B0DDQT                          WGDDQT
     I              B0DEQT                          WGDEQT
     I              B0DFQT                          WGDFQT
     I              B0HDQT                          WGHDQT
     I              B0HEQT                          WGHEQT
     I              B0AJQT                          WGAJQT
     I              B0AQQT                          WGAQQT
     I              B0AUQT                          WGAUQT
     I              B0EMQT                          WGEMQT
     I              B0DOQT                          WGDOQT
     I              B0ATNA                          WGATNA
     I              B0AKDT                          WGAKDT
     I              B0ANDT                          WGANDT
     I              B0IDVA                          WGIDVA
     I              B0JVST                          WGJVST
     I              B0BZPC                          WGBZPC
     I              B0DGQT                          WGDGQT
     I              B0DIDT                          WGDIDT
     I              B0ALCD                          WGALCD
     I              B0BFDY                          WGBFDY
     I              B0DJDT                          WGDJDT
     I              B0BGDY                          WGBGDY
     I              B0DKDT                          WGDKDT
     I              B0J2ST                          WGJ2ST
     I              B0DJQT                          WGDJQT
     I              B0BNWG                          WGBNWG
     I              B0DLDT                          WGDLDT
     I              B0DPQT                          WGDPQT
     I              B0DQQT                          WGDQQT
     I              B0DMDT                          WGDMDT
     I              B0M0ST                          WGM0ST
     I              B0J9ST                          WGJ9ST
     I              B0KBST                          WGKBST
     I              B0AKC8                          WGAKC8
     I              B0RINB                          WGRINB
     I              B0RHNB                          WGRHNB
     I              B0RGNB                          WGRGNB
     I              B0UVST                          WGUVST
     I              B0UWST                          WGUWST
     I              B0UXST                          WGUXST
     I              B0VSST                          WGVSST
     I              B0AATM                          WGAATM
     I              B0AYNA                          WGAYNA
     I              B0A0NA                          WGA0NA
     I              B0AXDT                          WGAXDT
      *
     I@B1REAC
      * Item Balance Detail      Co/Item/Whse/PrdDt (D)Sel
      * Renamed input format fields
     I              B1AIC3                          WHAIC3
     I              B1HGCD                          WHHGCD
     I              B1AJCD                          WHAJCD
     I              B1ELDT                          WHELDT
     I              B1ABWG                          WHABWG
     I              B1AGQT                          WHAGQT
     I              B1AHQT                          WHAHQT
     I              B1AIQT                          WHAIQT
     I              B1CTST                          WHCTST
     I              B1ACWG                          WHACWG
     I              B1ARQT                          WHARQT
     I              B1ASQT                          WHASQT
     I              B1ATQT                          WHATQT
     I              B1HDQT                          WHHDQT
     I              B1HEQT                          WHHEQT
     I              B1F6ST                          WHF6ST
     I              B1BMWG                          WHBMWG
     I              B1DSQT                          WHDSQT
     I              B1DTQT                          WHDTQT
     I              B1DUQT                          WHDUQT
     I              B1DHDT                          WHDHDT
     I              B1AGCS                          WHAGCS
     I              B1AECS                          WHAECS
     I              B1IDVA                          WHIDVA
     I              B1K7DT                          WHK7DT
     I              B1RINB                          WHRINB
     I              B1RHNB                          WHRHNB
     I              B1RGNB                          WHRGNB
     I              B1UVST                          WHUVST
     I              B1UWST                          WHUWST
     I              B1UXST                          WHUXST
     I              B1VSST                          WHVSST
     I              B1AATM                          WHAATM
     I              B1AYNA                          WHAYNA
     I              B1A0NA                          WHA0NA
     I              B1AXDT                          WHAXDT
      *
     I@B1REJ1
      * Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@B7CPZA
      * Item Transaction Detail   Normal KEY Sequence (D)
      * Renamed input format fields
     I              B7AIC3                          WJAIC3
     I              B7HGCD                          WJHGCD
     I              B7AJCD                          WJAJCD
     I              B7W9ST                          WJW9ST
     I              B7BSST                          WJBSST
     I              B7B4DT                          WJB4DT
     I              B7C4NY                          WJC4NY
     I              B7DXNB                          WJDXNB
     I              B7ELDT                          WJELDT
     I              B7HVCD                          WJHVCD
     I              B7F1ST                          WJF1ST
     I              B7AUNA                          WJAUNA
     I              B7A5QT                          WJA5QT
     I              B7AHWG                          WJAHWG
     I              B7AKCS                          WJAKCS
     I              B7CGCD                          WJCGCD
     I              B7AYVA                          WJAYVA
     I              B7BJNA                          WJBJNA
     I              B7CKNB                          WJCKNB
     I              B7BMST                          WJBMST
     I              B7CQCD                          WJCQCD
     I              B7DTCD                          WJDTCD
     I              B7MGNA                          WJMGNA
     I              B7TRBN                          WJTRBN
     I              B7TRBS                          WJTRBS
     I              B7C4NB                          WJC4NB
     I              B7RINB                          WJRINB
     I              B7RHNB                          WJRHNB
     I              B7RGNB                          WJRGNB
     I              B7M3NA                          WJM3NA
     I              B7AWTM                          WJAWTM
     I              B7XLCD                          WJXLCD
     I              B7K7DT                          WJK7DT
     I              B7UVST                          WJUVST
     I              B7UWST                          WJUWST
     I              B7UXST                          WJUXST
     I              B7VSST                          WJVSST
     I              B7AATM                          WJAATM
     I              B7AYNA                          WJAYNA
     I              B7A0NA                          WJA0NA
     I              B7AXDT                          WJAXDT
      *
     I@B7CPJZ
      * Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WKAIC3
     I              B7HGCD                          WKHGCD
     I              B7AJCD                          WKAJCD
     I              B7W9ST                          WKW9ST
     I              B7BSST                          WKBSST
     I              B7B4DT                          WKB4DT
     I              B7C4NY                          WKC4NY
     I              B7DXNB                          WKDXNB
     I              B7ELDT                          WKELDT
     I              B7HVCD                          WKHVCD
     I              B7F1ST                          WKF1ST
     I              B7AUNA                          WKAUNA
     I              B7A5QT                          WKA5QT
     I              B7AHWG                          WKAHWG
     I              B7AKCS                          WKAKCS
     I              B7CGCD                          WKCGCD
     I              B7AYVA                          WKAYVA
     I              B7BJNA                          WKBJNA
     I              B7CKNB                          WKCKNB
     I              B7BMST                          WKBMST
     I              B7CQCD                          WKCQCD
     I              B7DTCD                          WKDTCD
     I              B7MGNA                          WKMGNA
     I              B7TRBN                          WKTRBN
     I              B7TRBS                          WKTRBS
     I              B7C4NB                          WKC4NB
     I              B7RINB                          WKRINB
     I              B7RHNB                          WKRHNB
     I              B7RGNB                          WKRGNB
     I              B7M3NA                          WKM3NA
     I              B7AWTM                          WKAWTM
     I              B7XLCD                          WKXLCD
     I              B7K7DT                          WKK7DT
     I              B7UVST                          WKUVST
     I              B7UWST                          WKUWST
     I              B7UXST                          WKUXST
     I              B7VSST                          WKVSST
     I              B7AATM                          WKAATM
     I              B7AYNA                          WKAYNA
     I              B7A0NA                          WKA0NA
     I              B7AXDT                          WKAXDT
      *
     I@KZCPJI
      * Item Values               Update index
      * Renamed input format fields
     I              KZAIC3                          WLAIC3
     I              KZHGCD                          WLHGCD
     I              KZAJCD                          WLAJCD
     I              KZGUDT                          WLGUDT
     I              KZAQTM                          WLAQTM
     I              KZAGCS                          WLAGCS
     I              KZGIDT                          WLGIDT
     I              KZXYST                          WLXYST
     I              KZJ0DT                          WLJ0DT
     I              KZUVST                          WLUVST
     I              KZUWST                          WLUWST
     I              KZUXST                          WLUXST
     I              KZVSST                          WLVSST
     I              KZAATM                          WLAATM
     I              KZAYNA                          WLAYNA
     I              KZA0NA                          WLA0NA
     I              KZAXDT                          WLAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQCAB01    E DSCAB0REL0
      * UPD : Item Balance              Update index
      * Renamed input format fields
     I              B0AIC3                          WGAIC3
     I              B0HGCD                          WGHGCD
     I              B0AJCD                          WGAJCD
     I              B0AGCS                          WGAGCS
     I              B0AECS                          WGAECS
     I              B0BACS                          WGBACS
     I              B0BBCS                          WGBBCS
     I              B0CBPR                          WGCBPR
     I              B0GUDT                          WGGUDT
     I              B0XYST                          WGXYST
     I              B0CTPR                          WGCTPR
     I              B0G4DT                          WGG4DT
     I              B0BOWG                          WGBOWG
     I              B0DDQT                          WGDDQT
     I              B0DEQT                          WGDEQT
     I              B0DFQT                          WGDFQT
     I              B0HDQT                          WGHDQT
     I              B0HEQT                          WGHEQT
     I              B0AJQT                          WGAJQT
     I              B0AQQT                          WGAQQT
     I              B0AUQT                          WGAUQT
     I              B0EMQT                          WGEMQT
     I              B0DOQT                          WGDOQT
     I              B0ATNA                          WGATNA
     I              B0AKDT                          WGAKDT
     I              B0ANDT                          WGANDT
     I              B0IDVA                          WGIDVA
     I              B0JVST                          WGJVST
     I              B0BZPC                          WGBZPC
     I              B0DGQT                          WGDGQT
     I              B0DIDT                          WGDIDT
     I              B0ALCD                          WGALCD
     I              B0BFDY                          WGBFDY
     I              B0DJDT                          WGDJDT
     I              B0BGDY                          WGBGDY
     I              B0DKDT                          WGDKDT
     I              B0J2ST                          WGJ2ST
     I              B0DJQT                          WGDJQT
     I              B0BNWG                          WGBNWG
     I              B0DLDT                          WGDLDT
     I              B0DPQT                          WGDPQT
     I              B0DQQT                          WGDQQT
     I              B0DMDT                          WGDMDT
     I              B0M0ST                          WGM0ST
     I              B0J9ST                          WGJ9ST
     I              B0KBST                          WGKBST
     I              B0AKC8                          WGAKC8
     I              B0RINB                          WGRINB
     I              B0RHNB                          WGRHNB
     I              B0RGNB                          WGRGNB
     I              B0UVST                          WGUVST
     I              B0UWST                          WGUWST
     I              B0UXST                          WGUXST
     I              B0VSST                          WGVSST
     I              B0AATM                          WGAATM
     I              B0AYNA                          WGAYNA
     I              B0A0NA                          WGA0NA
     I              B0AXDT                          WGAXDT
      *
     IYARDCS      DS                            245
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQCAB11    E DSCAB1REL1
      * UPD : Item Balance Detail       Update index
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     IYBRDCS      DS                            163
     IQCAB71    E DSCAB7CPL0
      * UPD : Item Transaction Detail   Update index
      * Renamed input format fields
     I              B7AIC3                          WKAIC3
     I              B7HGCD                          WKHGCD
     I              B7AJCD                          WKAJCD
     I              B7W9ST                          WKW9ST
     I              B7BSST                          WKBSST
     I              B7B4DT                          WKB4DT
     I              B7C4NY                          WKC4NY
     I              B7DXNB                          WKDXNB
     I              B7ELDT                          WKELDT
     I              B7HVCD                          WKHVCD
     I              B7F1ST                          WKF1ST
     I              B7AUNA                          WKAUNA
     I              B7A5QT                          WKA5QT
     I              B7AHWG                          WKAHWG
     I              B7AKCS                          WKAKCS
     I              B7CGCD                          WKCGCD
     I              B7AYVA                          WKAYVA
     I              B7BJNA                          WKBJNA
     I              B7CKNB                          WKCKNB
     I              B7BMST                          WKBMST
     I              B7CQCD                          WKCQCD
     I              B7DTCD                          WKDTCD
     I              B7MGNA                          WKMGNA
     I              B7TRBN                          WKTRBN
     I              B7TRBS                          WKTRBS
     I              B7C4NB                          WKC4NB
     I              B7RINB                          WKRINB
     I              B7RHNB                          WKRHNB
     I              B7RGNB                          WKRGNB
     I              B7M3NA                          WKM3NA
     I              B7AWTM                          WKAWTM
     I              B7XLCD                          WKXLCD
     I              B7K7DT                          WKK7DT
     I              B7UVST                          WKUVST
     I              B7UWST                          WKUWST
     I              B7UXST                          WKUXST
     I              B7VSST                          WKVSST
     I              B7AATM                          WKAATM
     I              B7AYNA                          WKAYNA
     I              B7A0NA                          WKA0NA
     I              B7AXDT                          WKAXDT
      *
     IQPDKZ1    E DSPDKZCPL0
      * UPD : Item Values               Update index
      * Renamed input format fields
     I              KZAIC3                          WLAIC3
     I              KZHGCD                          WLHGCD
     I              KZAJCD                          WLAJCD
     I              KZGUDT                          WLGUDT
     I              KZAQTM                          WLAQTM
     I              KZAGCS                          WLAGCS
     I              KZGIDT                          WLGIDT
     I              KZXYST                          WLXYST
     I              KZJ0DT                          WLJ0DT
     I              KZUVST                          WLUVST
     I              KZUWST                          WLUWST
     I              KZUXST                          WLUXST
     I              KZVSST                          WLVSST
     I              KZAATM                          WLAATM
     I              KZAYNA                          WLAYNA
     I              KZA0NA                          WLA0NA
     I              KZAXDT                          WLAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Item Balance
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Warehouse Code
     I                                        3   5 P1AJCD
      * I :  Revaluation Eff. Date
     I                                    P   6   90P1GUDT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1AJCD    PARM           WP0002  3        Warehouse Code
     C           P1GUDT    PARM           WP0003  70       Revaluation Eff
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Revalue Inv/Sls Pc XF
      * Upd Revalue Inv/Sls Pc RT - IC Item Balance  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Upd Revalue Inv/Sls Pc RT - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001 114       Unit Cost Per P
     C                     MOVEL*BLANK    WN0002  2        U/M - Catchweig
     C                     MOVEL*BLANK    WN0003  2        U/M - Primary
     C                     Z-ADD*ZERO     WN0004  94       Conversion Fact
     C                     MOVEL*BLANK    WN0005  1        Operation Facto
     C                     MOVEL*BLANK    WN0006  2        U/M - Second
     C                     Z-ADD*ZERO     WN0007  94       Conversion Fact
     C                     MOVEL*BLANK    WN0008  1        Operation Facto
     C                     MOVEL*BLANK    WN0009  2        U/M - Third
     C                     MOVEL*BLANK    WN0010  2        U/M - Pricing
     C                     Z-ADD*ZERO     WN0011 112       Unit Weight
     C                     MOVEL*BLANK    WN0012  1        Production Date
     C                     MOVEL*BLANK    WN0013  1        Catch Weight St
     C                     MOVEL*BLANK    WN0014  3        Default Commod
     C                     MOVEL*BLANK    WN0015  3        Price Method De
     C                     Z-ADD*ZERO     WN0016 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0017 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0018 114       Cost based on U
     C                     Z-ADD*ZERO     WN0019 114       Cost based on U
     C                     Z-ADD*ZERO     WN0020 114       Cost based on U
     C                     MOVEL*BLANK    WN0021  2        U/M - Transacti
     C                     MOVEL*BLANK    WN0022  2        U/M - Cost
     C                     Z-ADD*ZERO     WN0023  70       USR From Date
     C                     Z-ADD*ZERO     WN0024  70       USR To Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * RTV Period & Week      RT - Calendar  * 
     C                     EXSR SBRVGN
      * Rtv From Week/To Week  RT - Calendar  * 
     C                     EXSR SCRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAAJCD    WQSA02           Warehouse Code
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Warehouse Code
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP1AJCD    WQSA02           Warehouse Code
      * Establish starting position
     C           KRSSA     SETLL@B0REHD                    *
     C           KRSSA     READE@B0REHD                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WUBYWG           Weight Billed
     C                     Z-ADD*ZERO     WUUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WN0001           Unit Cost Per P
      * Rtv Dol/Pnds for Dates RT - OM History  * 
     C                     EXSR SDRVGN
      * CASE: WRK.Weight Billed is Not equal zero
     C           WUBYWG    IFNE *ZERO                      *IF
     C           WUUSVA    DIV  WUBYWG    WN0001    H      Unit Cost Per P
      * If unit cost/LB is less than zero make it positive
      * CASE: PAR.Unit Cost Per Pound is Less than zero
     C           WN0001    IFLT *ZERO                      *IF
     C           *ZERO     SUB  WN0001    WN0001           Unit Cost Per P
     C                     END                             *FI
     C                     END                             *FI
      * RTV Desc,U/Ms,CWT,PrcM RT - Company/Item  * 
     C                     EXSR SFRVGN
      * If market price is not equal to zero then update price
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Unit Cost Per Pound NE WRK.ZERO
      *   |- c2    : PAR.Unit Cost Per Pound NE DB1.Unit Cost Per Pound
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0001    IFNE WUW0NB                     *IF
     C           WN0001    IFNE WAAGCS                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Upd Cost From Revalue  CH - IC Item Balance  * 
     C                     EXSR SGCHRC
     C                     END                             *FI
     C           KRSSA     READE@B0REHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Period & Week      RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     Z-ADDP1GUDT    WBBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSB     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWBESNB    WUESNB           Accounting Year
     C                     Z-ADDWBETNB    WUETNB           Accounting Peri
     C                     Z-ADDWBBZNB    WUBZNB           OM Week
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv From Week/To Week  RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUJGNB           USR number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCESNB    WQSC02           Accounting Year
     C           *LIKE     DEFN WCETNB    WQSC03           Accounting Peri
     C           *LIKE     DEFN WCBZNB    WQSC04           OM Week
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Accounting Year
     C                     KFLD           WQSC03           Accounting Peri
     C                     KFLD           WQSC04           OM Week
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDWUESNB    WQSC02           Accounting Year
     C                     Z-ADDWUETNB    WQSC03           Accounting Peri
     C                     Z-ADDWUBZNB    WQSC04           OM Week
      * Establish starting position
     C           KRSSC     SETLL@AFREOI                    *
     C           KRSSC     READE@AFREOI                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0023           USR From Date
     C                     Z-ADD*ZERO     WN0024           USR To Date
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.USR number is Equal to 1
     C           WUJGNB    IFEQ 1                          *IF
     C                     Z-ADDWCBCDT    WN0023           USR From Date
     C                     Z-ADDWCBCDT    WN0024           USR To Date
     C                     ADD  1         WUJGNB           USR number
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWCBCDT    WN0024           USR To Date
     C                     END                             *FI
     C           KRSSC     READE@AFREOI                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Dol/Pnds for Dates RT - OM History  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0025  1        Billing Activit
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUBYWG           Weight Billed
     C                     Z-ADD*ZERO     WUUSVA           FOB Gross Amoun
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDAJCD    WQSD02           Warehouse Code
     C           *LIKE     DEFN WDS5NB    WQSD03           Shipped Item Co
      * Define keylist
     C           KPSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Warehouse Code
     C                     KFLD           WQSD03           Shipped Item Co
     C                     KFLD           WDGNDT           Actual Shipped
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Warehouse Code
     C                     KFLD           WQSD03           Shipped Item Co
      * Setup key
     C                     Z-ADDWAAIC3    WQSD01           Company Number
     C                     MOVELWAAJCD    WQSD02           Warehouse Code
     C                     Z-ADDWAHGCD    WQSD03           Shipped Item Co
     C                     Z-ADDWN0023    WDGNDT           Actual Shipped
      * Establish starting position
     C           KPSSD     SETLL@HSTPNF                    *
     C           KRSSD     READE@HSTPNF                  90*
      * Data record not found
     C   90                MOVEL'USR1241' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assumes Position to first date
      * CASE:
      *  - c2 AND c1
      *   |- c2    : DB1.Actual Shipped Date GE PAR.Actual Shipped Date
      *   |- c1    : DB1.Actual Shipped Date LE PAR.USR To Date
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WDGNDT    IFGE WN0023                     *IF
     C           WDGNDT    IFLE WN0024                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * RTV Billing Type       RT - OP Order Types  * 
     C                     EXSR SERVGN
      * CASE: PAR.Billing Activity Type is Invoice
     C           WN0025    IFEQ '1'                        *IF
     C                     ADD  WDBYWG    WUBYWG           Weight Billed
     C                     ADD  WDUSVA    WUUSVA           FOB Gross Amoun
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@HSTPNF                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Billing Type       RT - OP Order Types  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEJNCD           Order Type - Sa
      * Setup key
     C                     MOVELWDJNCD    WEJNCD           Order Type - Sa
      * Establish starting position
     C           KRSSE     CHAIN@EXRETY              90    *
      * Data record not found
     C   90                MOVEL'USR1063' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEOBST    WN0025           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Desc,U/Ms,CWT,PrcM RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWAAIC3    WFAIC3           Company Number
     C                     Z-ADDWAHGCD    WFHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAVNA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     MOVEL*BLANK    WN0003           U/M - Primary
     C                     Z-ADD*ZERO     WN0004           Conversion Fact
     C                     MOVEL*BLANK    WN0005           Operation Facto
     C                     MOVEL*BLANK    WN0006           U/M - Second
     C                     Z-ADD*ZERO     WN0007           Conversion Fact
     C                     MOVEL*BLANK    WN0008           Operation Facto
     C                     MOVEL*BLANK    WN0009           U/M - Third
     C                     MOVEL*BLANK    WN0010           U/M - Pricing
     C                     Z-ADD*ZERO     WN0011           Unit Weight
     C                     MOVEL*BLANK    WN0012           Production Date
     C                     MOVEL*BLANK    WN0013           Catch Weight St
     C                     MOVEL*BLANK    WN0014           Default Commod
     C                     MOVEL*BLANK    WN0015           Price Method De
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFAVNA    WUAVNA           Description Lin
     C                     MOVELWFAWNA    WUAWNA           Description Lin
     C                     MOVELWFADCD    WN0003           U/M - Primary
     C                     Z-ADDWFAWPC    WN0004           Conversion Fact
     C                     MOVELWFLXST    WN0005           Operation Facto
     C                     MOVELWFAECD    WN0006           U/M - Second
     C                     Z-ADDWFAXPC    WN0007           Conversion Fact
     C                     MOVELWFLYST    WN0008           Operation Facto
     C                     MOVELWFAFCD    WN0009           U/M - Third
     C                     MOVELWFAICD    WN0010           U/M - Pricing
     C                     Z-ADDWFAIWG    WN0011           Unit Weight
     C                     MOVELWFFZST    WN0012           Production Date
     C                     MOVELWFAVST    WN0013           Catch Weight St
     C                     MOVELWFLNCD    WN0014           Default Commod
     C                     MOVELWFQ8CD    WN0015           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCHRC    BEGSR
      *================================================================
      * Upd Cost From Revalue  CH - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0026 112       Extended Amount
     C                     MOVEL*BLANK    WN0027  1        Shift Number
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B0REJT
     C                     Z-ADDWAAIC3    WGAIC3           Company Number
     C                     Z-ADDWAHGCD    WGHGCD           Item Code
     C                     MOVELWAAJCD    WGAJCD    P      Warehouse Code
      *
     C           KLCHSG    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGHGCD           Item Code
     C                     KFLD           WGAJCD           Warehouse Code
     C           KLCHSG    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB0REL0'MDACP
     C                     MOVEL'@B0REJT' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     MOVEL'1'       WN0027           Shift Number
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     Z-ADDWGAGCS    WGAECS           Last Cost
     C                     Z-ADDWGCBPR    WGCTPR           Last Revaluatio
     C                     Z-ADDWGGUDT    WGG4DT           Last Revaluatio
     C                     Z-ADDWN0001    WGAGCS           Unit Cost Per P
     C                     Z-ADDWN0001    WGCBPR           Revaluation Cos
     C                     Z-ADDP1GUDT    WGGUDT           Revaluation Eff
     C                     MOVEL'S'       WGXYST           Revaluation Cos
      * Update IC Item Balance Detail
      * Upd Value From Revalue RT - IC Item Balance Detail  * 
     C                     EXSR SHRVGN
     C           WGBOWG    MULT WN0001    WGIDVA    H      Value of On Han
      * CRT PD Item Values     CR - PD Item Values  * 
     C                     EXSR SLCRRC
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WGAATM' defaulted for 'Job Time'.
      * Field '(DB1) WGAYNA' defaulted for 'User Id'.
      * Field '(DB1) WGA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WGAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     MOVEL##USR     WGAYNA           User Id
     C                     MOVEL##JOB     WGA0NA           Job Name
     C                     Z-ADD##JDT     WGAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Upd Value From Revalue RT - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0028 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0029 114       Last Cost
     C                     Z-ADD*ZERO     WN0030 112       Value of On Han
     C                     Z-ADD*ZERO     WN0031  50       ITD Sequence Nu
     C                     Z-ADD*ZERO     WN0032  30       Sequence Number
     C                     Z-ADD*ZERO     WN0033 112       Extended Amount
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WHHGCD    WQSH02           Item Code
     C           *LIKE     DEFN WHAJCD    WQSH03           Warehouse Code
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Item Code
     C                     KFLD           WQSH03           Warehouse Code
      * Setup key
     C                     Z-ADDWGAIC3    WQSH01           Company Number
     C                     Z-ADDWGHGCD    WQSH02           Item Code
     C                     MOVELWGAJCD    WQSH03           Warehouse Code
      * Establish starting position
     C           KRSSH     SETLL@B1REAC                    *
     C           KRSSH     READE@B1REAC                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WN0001    MULT WHACWG    WN0030    H      Value of On Han
     C           WN0030    SUB  WHIDVA    WN0033           Extended Amount
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR SICHRC
      * Create transaction detail
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
     C                     EXSR SJRVGN
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     EXSR SKCRRC
     C           KRSSH     READE@B1REAC                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0034  70       Label Date
     C                     MOVEL*BLANK    WN0035  1        EDI Status 1
     C                     MOVEL*BLANK    WN0036  1        EDI Status 2
     C                     MOVEL*BLANK    WN0037  1        EDI Status 3
     C                     MOVEL*BLANK    WN0038  1        Record Status
     C                     Z-ADD*ZERO     WN0039  60       Job Time
     C                     MOVEL*BLANK    WN0040 10        User Id
     C                     MOVEL*BLANK    WN0041 10        Job Name
     C                     Z-ADD*ZERO     WN0042  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHHGCD    WIHGCD           Item Code
     C                     MOVELWHAJCD    WIAJCD    P      Warehouse Code
     C                     Z-ADDWHELDT    WIELDT           Production Date
      *
     C           KLCHSI    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
     C                     KFLD           WIELDT           Production Date
     C           KLCHSI    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAB1REL1'MDACP
     C                     MOVEL'@B1REJ1' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDWHABWG    WIABWG           Physical Count
     C                     Z-ADDWHAGQT    WIAGQT           Physical Count
     C                     Z-ADDWHAHQT    WIAHQT           Physical Count
     C                     Z-ADDWHAIQT    WIAIQT           Physical Count
     C                     MOVELWHCTST    WICTST    P      Physical Count
     C                     Z-ADDWHACWG    WIACWG           Quantity on Han
     C                     Z-ADDWHARQT    WIARQT           Quantity on Han
     C                     Z-ADDWHASQT    WIASQT           Quantity on Han
     C                     Z-ADDWHATQT    WIATQT           Quantity on Han
     C                     Z-ADDWHHDQT    WIHDQT           Quantity In Chi
     C                     Z-ADDWHHEQT    WIHEQT           Weight In Chill
     C                     MOVELWHF6ST    WIF6ST    P      Update Exceptio
     C                     Z-ADDWHBMWG    WIBMWG           Physical Start
     C                     Z-ADDWHDSQT    WIDSQT           Physical Start
     C                     Z-ADDWHDTQT    WIDTQT           Physical Start
     C                     Z-ADDWHDUQT    WIDUQT           Physical Start
     C                     Z-ADDWHDHDT    WIDHDT           Physical Start
     C                     Z-ADDWHAGCS    WIAGCS           Unit Cost Per P
     C                     Z-ADDWHAECS    WIAECS           Last Cost
     C                     Z-ADDWN0030    WIIDVA           Value of On Han
     C                     Z-ADDWHRINB    WIRINB           Item Structure
     C                     Z-ADDWHRHNB    WIRHNB           Item Structure
     C                     Z-ADDWHRGNB    WIRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C                     MOVEL##PGM     WIA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Next Sequence No.  RT - Item Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WJHGCD    WQSJ02           Item Code
     C           *LIKE     DEFN WJAJCD    WQSJ03           Warehouse Code
     C           *LIKE     DEFN WJW9ST    WQSJ04           Inventory Trans
     C           *LIKE     DEFN WJBSST    WQSJ05           Inventory Trans
     C           *LIKE     DEFN WJB4DT    WQSJ06           Transaction Dat
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Item Code
     C                     KFLD           WQSJ03           Warehouse Code
     C                     KFLD           WQSJ04           Inventory Trans
     C                     KFLD           WQSJ05           Inventory Trans
     C                     KFLD           WQSJ06           Transaction Dat
      * Setup key
     C                     Z-ADDWHAIC3    WQSJ01           Company Number
     C                     Z-ADDWHHGCD    WQSJ02           Item Code
     C                     MOVELWHAJCD    WQSJ03           Warehouse Code
     C                     MOVEL'A'       WQSJ04           Inventory Trans
     C                     MOVEL'RV'      WQSJ05           Inventory Trans
     C                     Z-ADD##JDT     WQSJ06           Transaction Dat
      * Establish starting position
     C           KRSSJ     SETLL@B7CPZA                    *
     C           KRSSJ     READE@B7CPZA                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0344' W0RTN   7
      * USER: Processing if Data record not found
     C                     Z-ADD1         WN0031           ITD Sequence Nu
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WJC4NY    ADD  1         WN0031           ITD Sequence Nu
     C                     GOTO SJEXIT                     *QUIT
     C           KRSSJ     READE@B7CPZA                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0043  60       Job Time
     C                     MOVEL*BLANK    WN0044 10        User Id
     C                     MOVEL*BLANK    WN0045 10        Job Name
     C                     Z-ADD*ZERO     WN0046  70       Job Date
     C                     Z-ADD*ZERO     WN0047  20       Production Hour
     C                     Z-ADD*ZERO     WN0048 112       Production Weig
     C                     Z-ADD*ZERO     WN0049  50       Production Quan
     C                     Z-ADD*ZERO     WN0050  70       Production Piec
     C                     MOVEL*BLANK    WN0051  1        Export/Domestic
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @B7CPJZ
     C                     Z-ADDWHAIC3    WKAIC3           Company Number
     C                     Z-ADDWHHGCD    WKHGCD           Item Code
     C                     MOVELWHAJCD    WKAJCD           Warehouse Code
     C                     MOVEL'A'       WKW9ST           Inventory Trans
     C                     MOVEL'RV'      WKBSST           Inventory Trans
     C                     Z-ADD##JDT     WKB4DT           Transaction Dat
     C                     Z-ADDWN0031    WKC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WKDXNB           Sequence Number
     C                     Z-ADDWHELDT    WKELDT           Production Date
     C                     MOVELWN0003    WKHVCD           U/M - Transacti
     C                     MOVEL'IC'      WKF1ST           Item Transactio
     C                     MOVEL@CN,01    WKAUNA           Description
     C                     Z-ADD*ZERO     WKA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WKAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WKAKCS           USR Transaction
     C                     MOVEL'LB'      WKCGCD           U/M - Cost
     C                     Z-ADDWN0033    WKAYVA           Extended Amount
     C                     MOVEL*BLANK    WKBJNA           Ticket Number
     C                     Z-ADD*ZERO     WKCKNB           G/L Document Nu
     C                     MOVEL*BLANK    WKBMST           G/L Update Stat
     C                     MOVEL*BLANK    WKCQCD           Reason Code
     C                     MOVEL*BLANK    WKDTCD           Reference Numbe
     C                     MOVEL*BLANK    WKMGNA           Lot ID
     C                     Z-ADD*ZERO     WKTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WKTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADDWGRINB    WKRINB           Item Structure
     C                     Z-ADDWGRHNB    WKRHNB           Item Structure
     C                     Z-ADDWGRGNB    WKRGNB           Item Structure
     C                     MOVEL*BLANK    WKM3NA           Employee Badge
     C                     Z-ADD*ZERO     WKAWTM           Production Time
     C                     MOVELWN0027    WKXLCD           Shift Number
     C                     Z-ADDWHK7DT    WKK7DT           Label Date
     C                     MOVEL*BLANK    WKUVST           EDI Status 1
     C                     MOVEL*BLANK    WKUWST           EDI Status 2
     C                     MOVEL*BLANK    WKUXST           EDI Status 3
     C                     MOVEL'A'       WKVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##JOB     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C                     KFLD           WKW9ST           Inventory Trans
     C                     KFLD           WKBSST           Inventory Trans
     C                     KFLD           WKB4DT           Transaction Dat
     C                     KFLD           WKC4NY           ITD Sequence Nu
     C                     KFLD           WKDXNB           Sequence Number
      * Check for duplicate primary key
     C           KLCRSK    SETLL@B7CPJZ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0345' W0RTN   7
      * Send message 'Item Transaction Detai EX'
     C                     MOVEL'USR0345' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@B7CPJZ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * Crt Export Rate Dtl   XF - Item Transaction Detail  * 
     C                     CALL 'POO5XFR'              90  Crt Export Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WKAIC3    WQ0001  30       Company Number
     C                     PARM WKHGCD    WQ0002  70       Item Code
     C                     PARM WKAJCD    WQ0003  3        Warehouse Code
     C                     PARM WKW9ST    WQ0004  1        Inventory Trans
     C                     PARM WKBSST    WQ0005  2        Inventory Trans
     C                     PARM WKB4DT    WQ0006  70       Transaction Dat
     C                     PARM WKDXNB    WQ0007  30       Sequence Number
     C                     PARM WKELDT    WQ0008  70       Production Date
     C                     PARM WKHVCD    WQ0009  2        U/M - Transacti
     C                     PARM WKF1ST    WQ0010  2        Item Transactio
     C                     PARM WKAUNA    WQ0011 30        Description
     C                     PARM WKA5QT    WQ0012 112       Transaction Qua
     C                     PARM WKAHWG    WQ0013 112       Transaction Wei
     C                     PARM WKAKCS    WQ0014 114       USR Transaction
     C                     PARM WKCGCD    WQ0015  2        U/M - Cost
     C                     PARM WKAYVA    WQ0016 112       Extended Amount
     C                     PARM WKBJNA    WQ0017  6        Ticket Number
     C                     PARM WKCKNB    WQ0018  80       G/L Document Nu
     C                     PARM WKBMST    WQ0019  1        G/L Update Stat
     C                     PARM WKCQCD    WQ0020  3        Reason Code
     C                     PARM WKDTCD    WQ0021 15        Reference Numbe
     C                     PARM WKMGNA    WQ0022 10        Lot ID
     C                     PARM WKTRBN    WQ0023  70       Transfer Batch
     C                     PARM WKTRBS    WQ0024  30       Transfer Batch
     C                     PARM WKC4NB    WQ0025  70       Order Number
     C                     PARM WKRINB    WQ0026  30       Item Structure
     C                     PARM WKRHNB    WQ0027  30       Item Structure
     C                     PARM WKRGNB    WQ0028  30       Item Structure
     C                     PARM WKM3NA    WQ0029 10        Employee Badge
     C                     PARM WKAWTM    WQ0030  60       Production Time
     C                     PARM WKXLCD    WQ0031  1        Shift Number
     C                     PARM WKK7DT    WQ0032  70       Label Date
     C                     PARM WKVSST    WQ0033  1        Record Status
     C                     PARM WKAATM    WQ0034  60       Job Time
     C                     PARM WKAXDT    WQ0035  70       Job Date
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POO5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCRRC    BEGSR
      *================================================================
      * CRT PD Item Values     CR - PD Item Values  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0052  60       Job Time
     C                     MOVEL*BLANK    WN0053 10        User Id
     C                     MOVEL*BLANK    WN0054 10        Job Name
     C                     Z-ADD*ZERO     WN0055  70       Job Date
     C                     MOVEL*BLANK    WN0056  7        *Return code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @KZCPJI
     C                     Z-ADDWGAIC3    WLAIC3           Company Number
     C                     Z-ADDWGHGCD    WLHGCD           Item Code
     C                     MOVELWGAJCD    WLAJCD           Warehouse Code
     C                     Z-ADD##JDT     WLGUDT           Revaluation Eff
     C                     Z-ADD##JTM     WLAQTM           Revaluation Eff
     C                     Z-ADDWN0001    WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLGIDT           Pricing Date Us
     C                     MOVEL'S'       WLXYST           Revaluation Cos
     C                     Z-ADDP1GUDT    WLJ0DT           Revaluation Dat
     C                     MOVELWGUVST    WLUVST           EDI Status 1
     C                     MOVELWGUWST    WLUWST           EDI Status 2
     C                     MOVELWGUXST    WLUXST           EDI Status 3
     C                     MOVELWGVSST    WLVSST           Record Status
      *
      * USER: Processing before Data update
      * VAL Exists             XF - PD Item Values  * 
     C                     CALL 'PDNHXFR'              90  VAL Exists
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0036  30       Company Number
     C                     PARM WLHGCD    WQ0037  70       Item Code
     C                     PARM WLAJCD    WQ0038  3        Warehouse Code
     C                     PARM WLGUDT    WQ0039  70       Revaluation Eff
     C                     PARM WLAQTM    WQ0040  60       Revaluation Eff
     C           WN0056    PARM *BLANK    WQ0041  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * DO WHILE: PAR.*Return code is *Record already exists
     C           WN0056    DOWEQ'Y2U0003'                  *DOW
     C                     ADD  1         WLAQTM           Revaluation Eff
      * VAL Exists             XF - PD Item Values  * 
     C                     CALL 'PDNHXFR'              90  VAL Exists
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WLAIC3    WQ0042  30       Company Number
     C                     PARM WLHGCD    WQ0043  70       Item Code
     C                     PARM WLAJCD    WQ0044  3        Warehouse Code
     C                     PARM WLGUDT    WQ0045  70       Revaluation Eff
     C                     PARM WLAQTM    WQ0046  60       Revaluation Eff
     C           WN0056    PARM *BLANK    WQ0047  7        *Return code
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDNHXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *ITR
      * SET Off Indicator 98   US - /UT User Source  * 
     C                     SETOF                     98    SETOFF INDIC
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
     C                     MOVEL##PGM     WLA0NA           Job Name
     C           KLCRSL    KLIST
     C                     KFLD           WLAIC3           Company Number
     C                     KFLD           WLHGCD           Item Code
     C                     KFLD           WLAJCD           Warehouse Code
     C                     KFLD           WLGUDT           Revaluation Eff
     C                     KFLD           WLAQTM           Revaluation Eff
      * Check for duplicate primary key
     C           KLCRSL    SETLL@KZCPJI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2348' W0RTN   7
      * Send message 'Item Values            EX'
     C                     MOVEL'USR2348' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C                     WRITE@KZCPJI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAHGCD           Item Code
     C                     Z-ADD*ZERO     WAAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WAAECS           Last Cost
     C                     Z-ADD*ZERO     WABACS           Cost per Primar
     C                     Z-ADD*ZERO     WABBCS           Cost per Pricin
     C                     Z-ADD*ZERO     WACBPR           Revaluation Cos
     C                     Z-ADD*ZERO     WAGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WACTPR           Last Revaluatio
     C                     Z-ADD*ZERO     WAG4DT           Last Revaluatio
     C                     Z-ADD*ZERO     WABOWG           On Hand Weight
     C                     Z-ADD*ZERO     WADDQT           On Hand U/M1 Su
     C                     Z-ADD*ZERO     WADEQT           On Hand U/M2 Su
     C                     Z-ADD*ZERO     WADFQT           On Hand U/M3 Su
     C                     Z-ADD*ZERO     WAHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WAHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WAAJQT           Quantity Schedu
     C                     Z-ADD*ZERO     WAAQQT           Quantity on Sal
     C                     Z-ADD*ZERO     WAAUQT           Quantity on Pur
     C                     Z-ADD*ZERO     WAEMQT           Quantity on Tra
     C                     Z-ADD*ZERO     WADOQT           Quantity Avail.
     C                     Z-ADD*ZERO     WAAKDT           Date of Last Or
     C                     Z-ADD*ZERO     WAANDT           Date of Last Sh
     C                     Z-ADD*ZERO     WAIDVA           Value of On Han
     C                     Z-ADD*ZERO     WABZPC           Safety Allowanc
     C                     Z-ADD*ZERO     WADGQT           Safety Allowanc
     C                     Z-ADD*ZERO     WADIDT           Stock Out Date
     C                     Z-ADD*ZERO     WABFDY           Lead Time - Las
     C                     Z-ADD*ZERO     WADJDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WABGDY           Lead Time - Nex
     C                     Z-ADD*ZERO     WADKDT           Lead Time - Dat
     C                     Z-ADD*ZERO     WADJQT           Usage Qty per C
     C                     Z-ADD*ZERO     WABNWG           Usage Weight pe
     C                     Z-ADD*ZERO     WADLDT           Inventory Manag
     C                     Z-ADD*ZERO     WADPQT           Minimum Quantit
     C                     Z-ADD*ZERO     WADQQT           Maximum Quantit
     C                     Z-ADD*ZERO     WADMDT           Last Physical C
     C                     Z-ADD*ZERO     WAAKC8           Vendor - Item/W
     C                     Z-ADD*ZERO     WARINB           Item Structure
     C                     Z-ADD*ZERO     WARHNB           Item Structure
     C                     Z-ADD*ZERO     WARGNB           Item Structure
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Accounting Year Code
     C                     Z-ADD*ZERO     WUESNB  40
      * Define work field Accounting Period Code
     C                     Z-ADD*ZERO     WUETNB  20
      * Define work field OM Week
     C                     Z-ADD*ZERO     WUBZNB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WBCQNB           Julian Date
     C                     Z-ADD*ZERO     WBESNB           Accounting Year
     C                     Z-ADD*ZERO     WBETNB           Accounting Peri
     C                     Z-ADD*ZERO     WBBZNB           OM Week
     C                     Z-ADD*ZERO     WBEINB           Week Number
     C                     Z-ADD*ZERO     WBAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WBOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WBNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WBNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WBOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WBOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field USR number
     C                     Z-ADD*ZERO     WUJGNB  60
      * Define work field Weight Billed
     C                     Z-ADD*ZERO     WUBYWG 112
      * Define work field FOB Gross Amount
     C                     Z-ADD*ZERO     WUUSVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDDPNB           Order Sequence
     C                     Z-ADD*ZERO     WDUENB           Order Secondary
     C                     Z-ADD*ZERO     WDBTC7           Parent Customer
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDORIT           Original Item
     C                     Z-ADD*ZERO     WDAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WDD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WDCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WDAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WDAKPR           Unit Price
     C                     Z-ADD*ZERO     WDAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WDAQCS           Unit Cost Order
     C                     Z-ADD*ZERO     WDAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WDAYVA           Extended Amount
     C                     Z-ADD*ZERO     WDL6NB           Contract Number
     C                     Z-ADD*ZERO     WDHCDT           LD Arrival Date
     C                     Z-ADD*ZERO     WDESNB           Accounting Year
     C                     Z-ADD*ZERO     WDETNB           Accounting Peri
     C                     Z-ADD*ZERO     WDBZNB           OM Week
     C                     Z-ADD*ZERO     WDEXQT           Quantity Billed
     C                     Z-ADD*ZERO     WDBYWG           Weight Billed
     C                     Z-ADD*ZERO     WDS5NB           Shipped Item Co
     C                     Z-ADD*ZERO     WDMAVA           Billing Detail
     C                     Z-ADD*ZERO     WDKDVA           Billing Detail
     C                     Z-ADD*ZERO     WDUSVA           FOB Gross Amoun
     C                     Z-ADD*ZERO     WDUTVA           Standard Overag
     C                     Z-ADD*ZERO     WDA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WDCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WDR8NB           Original Order
     C                     Z-ADD*ZERO     WDBZPR           Price Overage O
     C                     Z-ADD*ZERO     WDEXDT           Market Pricing
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WDSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WDSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WDONVA           Actual Freight
     C                     Z-ADD*ZERO     WDB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WDB5NB           PM Line Number
     C                     Z-ADD*ZERO     WDGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WDULVA           Absorbed Freigh
     C                     Z-ADD*ZERO     WDUNVA           Trade Fund Accr
     C                     Z-ADD*ZERO     WDUOVA           Commission Amou
     C                     Z-ADD*ZERO     WDUPVA           Financials Amou
     C                     Z-ADD*ZERO     WDUQVA           Financials Amou
     C                     Z-ADD*ZERO     WDCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WDDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WDB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WDIANX           Req Shipping Te
     C                     Z-ADD*ZERO     WDIBNX           Actual Shipping
     C                     Z-ADD*ZERO     WDNYDT           Req Delivery Da
     C                     Z-ADD*ZERO     WDBZTM           Req Delivery Ti
     C                     Z-ADD*ZERO     WDZ4NB           MPC Number
     C                     Z-ADD*ZERO     WDOCFR           Ocean Freight
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WDA5PR           Commodity Marke
     C                     Z-ADD*ZERO     WDCDPR           Market Value
     C                     Z-ADD*ZERO     WDD0PR           Default Cmdty M
     C                     Z-ADD*ZERO     WDD0VL           Raw Material Co
     C                     Z-ADD*ZERO     WDCEVL           Sales Expense T
     C                     Z-ADD*ZERO     WDOHDT           LD Sail Date
     C                     Z-ADD*ZERO     WDD9PR           SBD Accrual Amo
     C                     Z-ADD*ZERO     WDCFVL           HST Item Target
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Item Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           CI Unused Numbe
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WFILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WFCHNB           Use/Freeze/Sell
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           Std Costing Uni
     C                     Z-ADD*ZERO     WFCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WFCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHABWG           Physical Count
     C                     Z-ADD*ZERO     WHAGQT           Physical Count
     C                     Z-ADD*ZERO     WHAHQT           Physical Count
     C                     Z-ADD*ZERO     WHAIQT           Physical Count
     C                     Z-ADD*ZERO     WHACWG           Quantity on Han
     C                     Z-ADD*ZERO     WHARQT           Quantity on Han
     C                     Z-ADD*ZERO     WHASQT           Quantity on Han
     C                     Z-ADD*ZERO     WHATQT           Quantity on Han
     C                     Z-ADD*ZERO     WHHDQT           Quantity In Chi
     C                     Z-ADD*ZERO     WHHEQT           Weight In Chill
     C                     Z-ADD*ZERO     WHBMWG           Physical Start
     C                     Z-ADD*ZERO     WHDSQT           Physical Start
     C                     Z-ADD*ZERO     WHDTQT           Physical Start
     C                     Z-ADD*ZERO     WHDUQT           Physical Start
     C                     Z-ADD*ZERO     WHDHDT           Physical Start
     C                     Z-ADD*ZERO     WHAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WHAECS           Last Cost
     C                     Z-ADD*ZERO     WHIDVA           Value of On Han
     C                     Z-ADD*ZERO     WHK7DT           Label Date
     C                     Z-ADD*ZERO     WHRINB           Item Structure
     C                     Z-ADD*ZERO     WHRHNB           Item Structure
     C                     Z-ADD*ZERO     WHRGNB           Item Structure
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJB4DT           Transaction Dat
     C                     Z-ADD*ZERO     WJC4NY           ITD Sequence Nu
     C                     Z-ADD*ZERO     WJDXNB           Sequence Number
     C                     Z-ADD*ZERO     WJELDT           Production Date
     C                     Z-ADD*ZERO     WJA5QT           Transaction Qua
     C                     Z-ADD*ZERO     WJAHWG           Transaction Wei
     C                     Z-ADD*ZERO     WJAKCS           USR Transaction
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WJTRBN           Transfer Batch
     C                     Z-ADD*ZERO     WJTRBS           Transfer Batch
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJAWTM           Production Time
     C                     Z-ADD*ZERO     WJK7DT           Label Date
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Clear all neither parameters
      * Crt IC Trans. Detail   CR - Item Transaction Detail  * 
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLHGCD           Item Code
     C                     Z-ADD*ZERO     WLGUDT           Revaluation Eff
     C                     Z-ADD*ZERO     WLAQTM           Revaluation Eff
     C                     Z-ADD*ZERO     WLAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WLGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WLJ0DT           Revaluation Dat
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Revalue Inventory
