     H/TITLE Exc Dept/Line Yield   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 04/29/04  Time  : 10:00:23
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOCYREL2IF  E           K        DISK
      * RSQ : Yld Component             Co/EntDpt/EntLn/Comp
      *
     FPOCZREL2IF  E           K        DISK
      * RSQ : Production Line Yld Comp  Co/Comp/Dept/Line
      *
     FPOCSCPL2IF  E           K        DISK
      * RSQ : Yld Daily Line Header     Co/Dept/Lne/Dte/Shft OPN
      *
     I@CYRERM
      * Yld Component             Co/EntDpt/EntLn/Comp
      * Renamed input format fields
     I              CYAIC3                          WAAIC3
     I              CYE4AA                          WAE4AA
     I              CYQCNA                          WAQCNA
     I              CYE5AA                          WAE5AA
     I              CYE6AA                          WAE6AA
     I              CYUVST                          WAUVST
     I              CYUWST                          WAUWST
     I              CYUXST                          WAUXST
     I              CYVSST                          WAVSST
     I              CYAATM                          WAAATM
     I              CYAYNA                          WAAYNA
     I              CYA0NA                          WAA0NA
     I              CYAXDT                          WAAXDT
      *
     I@CZRERN
      * Production Line Yld Comp  Co/Comp/Dept/Line
      * Renamed input format fields
     I              CZAIC3                          WBAIC3
     I              CZR3CD                          WBR3CD
     I              CZEWAA                          WBEWAA
     I              CZE4AA                          WBE4AA
     I              CZO6SX                          WBO6SX
     I              CZFLPC                          WBFLPC
     I              CZQDNA                          WBQDNA
     I              CZPCSX                          WBPCSX
     I              CZO8SX                          WBO8SX
     I              CZRGNB                          WBRGNB
     I              CZO9SX                          WBO9SX
     I              CZRHNB                          WBRHNB
     I              CZPASX                          WBPASX
     I              CZRINB                          WBRINB
     I              CZPDSX                          WBPDSX
     I              CZPESX                          WBPESX
     I              CZPFSX                          WBPFSX
     I              CZPGSX                          WBPGSX
     I              CZUVST                          WBUVST
     I              CZUWST                          WBUWST
     I              CZUXST                          WBUXST
     I              CZVSST                          WBVSST
     I              CZAATM                          WBAATM
     I              CZAYNA                          WBAYNA
     I              CZA0NA                          WBA0NA
     I              CZAXDT                          WBAXDT
      *
     I@CSCPQ1
      * Yld Daily Line Header     Co/Dept/Lne/Dte/Shft OPN
      * Renamed input format fields
     I              CSAIC3                          WCAIC3
     I              CSR3CD                          WCR3CD
     I              CSEWAA                          WCEWAA
     I              CSELDT                          WCELDT
     I              CSN3SX                          WCN3SX
     I              CSJ3WG                          WCJ3WG
     I              CSW6NX                          WCW6NX
     I              CSJ6WG                          WCJ6WG
     I              CSJ4WG                          WCJ4WG
     I              CSJ5WG                          WCJ5WG
     I              CSF4PC                          WCF4PC
     I              CSKOWG                          WCKOWG
     I              CSFJPC                          WCFJPC
     I              CSFKPC                          WCFKPC
     I              CSFNPC                          WCFNPC
     I              CSKNWG                          WCKNWG
     I              CSCWT1                          WCCWT1
     I              CSOKSX                          WCOKSX
     I              CSONSX                          WCONSX
     I              CSXCNX                          WCXCNX
     I              CSMEWG                          WCMEWG
     I              CSMFWG                          WCMFWG
     I              CSW9NX                          WCW9NX
     I              CSXANX                          WCXANX
     I              CSXBNX                          WCXBNX
     I              CSMGWG                          WCMGWG
     I              CSMHWG                          WCMHWG
     I              CSUVST                          WCUVST
     I              CSUWST                          WCUWST
     I              CSUXST                          WCUXST
     I              CSVSST                          WCVSST
     I              CSAATM                          WCAATM
     I              CSAYNA                          WCAYNA
     I              CSA0NA                          WCA0NA
     I              CSAXDT                          WCAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      * Outward parameters
     IPARC        DS                             29
      * KEY : Yld Daily Line Yld Comp   Co/Dpt/Dte/Shf/Line
      * I : RST Company Number
     I                                    P   1   20PAAIC3
      * I : RST Department Code
     I                                        3   8 PAR3CD
      * I : RST Production Date
     I                                    P   9  120PAELDT
      * I : RST Production Shift
     I                                       13  13 PAN3SX
      * I : RST Production Line Code
     I                                       14  19 PAEWAA
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Yld Daily Line Header
      * N :  Company Number
     I                                    P   1   20P1AIC3
      * N :  Department Code
     I                                        3   8 P1R3CD
      * N :  Production Line Code
     I                                        9  14 P1EWAA
      * N :  Production Date
     I                                    P  15  180P1ELDT
      * N :  Production Shift
     I                                       19  19 P1N3SX
     IP2PARM      DS
      * FLD: User Prod Line Access
      * N :  User Profile Name
     I                                        1  10 P2AJVN
      * N :  User Department
     I                                       11  12 P2OOSX
      * N :  User Access
     I                                       13  13 P2OPSX
      * N :  Yield Entry Type
     I                                       14  14 P2ORSX
     IP3PARM      DS
      * FLD: *Arrays
      * N :  YDL Post Status
     I                                        1   1 P3OKSX
      * N :  YDL Process Status
     I                                        2   3 P3ONSX
      * N :  Record Found USR
     I                                        4   4 P3WXST
      * B :  Yld Program USR
     I                                        5   6 P3OSSX
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'YR Start Wgt Not Avail'
      * Department Code
     I                                        1   6 ZA0001
      * Production Line Code
     I                                        7  12 ZA0002
      * Production Date
     I                                    P  13  160ZA0003
      * Production Shift
     I                                       17  17 ZA0004
      * Message data for 'YR Dept/Line Not Avail'
      * Department Code
     I                                        1   6 ZA0005
      * Production Line Code
     I                                        7  12 ZA0006
      * Production Date
     I                                    P  13  160ZA0007
      * Production Shift
     I                                       17  17 ZA0008
      * Message data for 'YR Opt Invalid'
      * Department Code
     I                                        1   6 ZA0009
      * Production Line Code
     I                                        7  12 ZA0010
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P3OSSX    PARM P3OSSX    WP0001  2        Yld Program USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Dept/Line Yield   XF
     C                     MOVEL##USR     P2AJVN           User Profile Na
      * Call Program
      * CASE: PAR.Yld Program USR is Change Line In Progress
     C           P3OSSX    IFEQ 'CL'                       *IF
      * Sel Prod Line         SR - User Prod Line Access  * 
     C                     CALL 'POVPSRR'              90  Sel Prod Line
     C                     PARM *BLANK    W0RTN   7
     C           P2AJVN    PARM P2AJVN    WQ0001 10        User Profile Na
     C           P1AIC3    PARM P1AIC3    WQ0002  30       Company Number
     C           P1R3CD    PARM P1R3CD    WQ0003  6        Department Code
     C           P1EWAA    PARM P1EWAA    WQ0004  6        Production Line
     C           P2OOSX    PARM P2OOSX    WQ0005  2        User Department
     C           P2OPSX    PARM P2OPSX    WQ0006  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Rtv Yld Profile Dft   XF - User Prod Line Access  * 
     C                     CALL 'POWAXFR'              90  Rtv Yld Profile
     C                     PARM *BLANK    W0RTN   7
     C           P2AJVN    PARM P2AJVN    WQ0007 10        User Profile Na
     C           P1AIC3    PARM P1AIC3    WQ0008  30       Company Number
     C           P1R3CD    PARM P1R3CD    WQ0009  6        Department Code
     C           P1EWAA    PARM P1EWAA    WQ0010  6        Production Line
     C           P2OOSX    PARM P2OOSX    WQ0011  2        User Department
     C           P2OPSX    PARM P2OPSX    WQ0012  1        User Access
     C           P2ORSX    PARM P2ORSX    WQ0013  1        Yield Entry Typ
     C           WUPHSX    PARM WUPHSX    WQ0014  1        User Line In Pr
     C           WUPISX    PARM WUPISX    WQ0015  1        UPLA Unused Sts
     C           WUPJSX    PARM WUPJSX    WQ0016  1        UPLA Unused Sts
     C           WUPKSX    PARM WUPKSX    WQ0017  2        UPLA Unused Sts
     C           WUPLSX    PARM WUPLSX    WQ0018  2        UPLA Unused Sts
     C           P3WXST    PARM *BLANK    WQ0019  1        Record Found US
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POWAXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Record Found USR is Record Not Found
     C           P3WXST    IFEQ 'N'                        *IF
      * Send message 'User Prd Line Access CMP'
     C                     MOVEL'USR3257' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Process Screens
      * DO WHILE: PAR.Yld Program USR is Not Exit
     C           P3OSSX    DOWEQ'ES'                       *DO
     C           P3OSSX    OREQ 'IR'
     C           P3OSSX    OREQ 'PR'
     C           P3OSSX    OREQ 'YC'
     C           P3OSSX    OREQ 'YR'
     C           P3OSSX    OREQ 'SW'
     C           P3OSSX    OREQ 'DE'
     C           P3OSSX    OREQ 'LB'
     C           P3OSSX    OREQ 'LD'
     C                     MOVEL'N'       YL0001           Status - Y or N
      * Validate Option
      * CASE: PAR.Yld Program USR is Conv Start Wgt Entry
     C           P3OSSX    IFEQ 'SW'                       *IF
      * Rtv Dte/Shft/PrcSts   RT - Yld Component  * 
     C                     EXSR SARVGN
      * CASE: PAR.Record Found USR is Record Not Found
     C           P3WXST    IFEQ 'N'                        *IF
     C                     MOVEL'EX'      P3OSSX           Yld Program USR
      * Setup message data for message
     C                     MOVELP1R3CD    ZA0001           Department Code
     C                     MOVELP1EWAA    ZA0002           Production Line
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  P1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0003
     C                     MOVELP1N3SX    ZA0004           Production Shif
      * Send message 'YR Start Wgt Not Avail'
     C                     MOVEL'USR3267' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       YL0001           Status - Y or N
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Dte/Shft/PrcSts   RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0001           Company Number
     C                     MOVELP1R3CD    WL0002    P      Department Code
     C                     MOVELP1EWAA    WL0003    P      Production Line
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P1ELDT           Production Date
     C                     MOVELWL0005    P1N3SX    P      Production Shif
     C                     MOVELWL0006    P3OKSX    P      YDL Post Status
     C                     MOVELWL0007    P3ONSX    P      YDL Process Sta
     C                     MOVELWL0008    P3WXST    P      Record Found US
      * CASE: PAR.Record Found USR is Record Not Found
     C           P3WXST    IFEQ 'N'                        *IF
     C                     MOVEL'EX'      P3OSSX           Yld Program USR
      * Setup message data for message
     C                     MOVELP1R3CD    ZA0005           Department Code
     C                     MOVELP1EWAA    ZA0006           Production Line
      * Convert Production Date to display format
      * Convert date
     C           1000000   ADD  P1ELDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    ZA0007
     C                     MOVELP1N3SX    ZA0008           Production Shif
      * Send message 'YR Dept/Line Not Avail'
     C                     MOVEL'USR3242' ZAMSID
     C                     MOVEL'*PRV '   ZAPGRL           Rel queue
     C                     MOVEL'*COMP  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
     C                     END                             *FI
     C                     END                             *FI
      * Process Option
      * CASE: PAR.Record Found USR is Record Found
     C           P3WXST    IFEQ 'Y'                        *IF
      * Call Program
      * CASE: PAR.Yld Program USR is End of Shift
     C           P3OSSX    IFEQ 'ES'                       *IF
      * Pmt End of Shift      PV - Production Line  * 
     C                     CALL 'POVSPVR'              90  Pmt End of Shif
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0020  30       Company Number
     C                     PARM P1R3CD    WQ0021  6        Department Code
     C                     PARM P1EWAA    WQ0022  6        Production Line
     C                     PARM P1ELDT    WQ0023  70       Production Date
     C                     PARM P1N3SX    WQ0024  1        Production Shif
     C                     PARM P3OKSX    WQ0025  1        YDL Post Status
     C                     PARM P3ONSX    WQ0026  2        YDL Process Sta
     C                     PARM P3WXST    WQ0027  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0028  2        Yld Program USR
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVSPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Loin Boning Input Worksht
     C           P3OSSX    IFEQ 'LB'                       *IF
      * Edt YDLD Worksheet    EF - Yld Daily Line Detail  * 
     C                     CALL 'PPEJEFR'              90  Edt YDLD Worksh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0029  30       Company Number
     C                     PARM P1R3CD    WQ0030  6        Department Code
     C                     PARM P1EWAA    WQ0031  6        Production Line
     C                     PARM P1ELDT    WQ0032  70       Production Date
     C                     PARM P1N3SX    WQ0033  1        Production Shif
     C           P3OSSX    PARM P3OSSX    WQ0034  2        Yld Program USR
     C                     PARM P2OOSX    WQ0035  2        User Department
     C                     PARM P2OPSX    WQ0036  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPEJEFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Loin Boning Dsply Worksht
     C           P3OSSX    IFEQ 'LD'                       *IF
      * Dsp YDLD Worksheet    DF - Yld Daily Line Detail  * 
     C                     CALL 'PPEODFR'              90  Dsp YDLD Worksh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0037  30       Company Number
     C                     PARM 'LOINS'   WQ0038  6        Department Code
     C                     PARM 'BONING'  WQ0039  6        Production Line
     C                     PARM P1ELDT    WQ0040  70       Production Date
     C                     PARM P1N3SX    WQ0041  1        Production Shif
     C           P3OSSX    PARM P3OSSX    WQ0042  2        Yld Program USR
     C                     PARM P2OOSX    WQ0043  2        User Department
     C                     PARM P2OPSX    WQ0044  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPEODFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Production Review
     C           P3OSSX    IFEQ 'PR'                       *IF
      * Dsp Production Review DF - Yld Detail Transaction  * 
     C                     CALL 'POVTDFR'              90  Dsp Production
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0045  30       Company Number
     C                     PARM P1R3CD    WQ0046  6        Department Code
     C                     PARM P1EWAA    WQ0047  6        Production Line
     C                     PARM P1ELDT    WQ0048  70       Production Date
     C                     PARM P1N3SX    WQ0049  1        Production Shif
     C                     PARM P3OKSX    WQ0050  1        YDL Post Status
     C                     PARM P3ONSX    WQ0051  2        YDL Process Sta
     C                     PARM P3WXST    WQ0052  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0053  2        Yld Program USR
     C                     PARM P2OOSX    WQ0054  2        User Department
     C                     PARM P2OPSX    WQ0055  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVTDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Inventory Reconcile
     C           P3OSSX    IFEQ 'IR'                       *IF
      * Dsp Inv Reconcile     DF - Yld Inventory Balance  * 
     C                     CALL 'POVVDFR'              90  Dsp Inv Reconci
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0056  30       Company Number
     C                     PARM P1R3CD    WQ0057  6        Department Code
     C                     PARM P1EWAA    WQ0058  6        Production Line
     C                     PARM P1ELDT    WQ0059  70       Production Date
     C                     PARM P1N3SX    WQ0060  1        Production Shif
     C                     PARM P3OKSX    WQ0061  1        YDL Post Status
     C                     PARM P3ONSX    WQ0062  2        YDL Process Sta
     C                     PARM P3WXST    WQ0063  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0064  2        Yld Program USR
     C                     PARM P2OOSX    WQ0065  2        User Department
     C                     PARM P2OPSX    WQ0066  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVVDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Yield Calculation
     C           P3OSSX    IFEQ 'YC'                       *IF
      * Exc Calculate Yield   DF - Yld Daily Line Yld Comp  * 
     C                     CALL 'POW6DFR'              90  Exc Calculate Y
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0067  30       Company Number
     C                     PARM P1R3CD    WQ0068  6        Department Code
     C                     PARM P1EWAA    WQ0069  6        Production Line
     C                     PARM P1ELDT    WQ0070  70       Production Date
     C                     PARM P1N3SX    WQ0071  1        Production Shif
     C                     PARM P3OKSX    WQ0072  1        YDL Post Status
     C                     PARM P3ONSX    WQ0073  2        YDL Process Sta
     C                     PARM P3WXST    WQ0074  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0075  2        Yld Program USR
     C                     PARM P2OOSX    WQ0076  2        User Department
     C                     PARM P2OPSX    WQ0077  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POW6DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Yield Review
     C           P3OSSX    IFEQ 'YR'                       *IF
      * Dsp Yld Approval II   DF - Yld Daily Line Yld Comp  * 
     C                     CLEARPARC
     C                     Z-ADDP1AIC3    PAAIC3           Company Number
     C                     MOVELP1R3CD    PAR3CD    P      Department Code
     C                     Z-ADDP1ELDT    PAELDT           Production Date
     C                     MOVELP1N3SX    PAN3SX    P      Production Shif
     C                     MOVELP1EWAA    PAEWAA    P      Production Line
      *
     C                     CALL 'PPEKDFR'              90  Dsp Yld Approva
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             KEY: Yld Daily
     C                     PARM P3OKSX    WQ0078  1        YDL Post Status
     C                     PARM P3ONSX    WQ0079  2        YDL Process Sta
     C                     PARM P3WXST    WQ0080  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0081  2        Yld Program USR
     C                     PARM P2OOSX    WQ0082  2        User Department
     C                     PARM P2OPSX    WQ0083  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPEKDFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Dept Head/Wgt Entry
     C           P3OSSX    IFEQ 'DE'                       *IF
      * Ent Dept Start Wgt    PV - Yld Daily Dept Header  * 
     C                     CALL 'POVWPVR'              90  Ent Dept Start
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0084  30       Company Number
     C                     PARM P1R3CD    WQ0085  6        Department Code
     C                     PARM P1ELDT    WQ0086  70       Production Date
     C                     PARM P1N3SX    WQ0087  1        Production Shif
     C                     PARM P3OKSX    WQ0088  1        YDL Post Status
     C                     PARM P3ONSX    WQ0089  2        YDL Process Sta
     C                     PARM P3WXST    WQ0090  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0091  2        Yld Program USR
     C                     PARM P2OOSX    WQ0092  2        User Department
     C                     PARM P2OPSX    WQ0093  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POVWPVR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: PAR.Yld Program USR is Conv Start Wgt Entry
     C           P3OSSX    IFEQ 'SW'                       *IF
      * CASE: LCL.Status - Y or N is yes
     C           YL0001    IFEQ 'Y'                        *IF
      * Ent Start Weight      DF - Yld Component  * 
     C                     CALL 'POW4DFR'              90  Ent Start Weigh
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1AIC3    WQ0094  30       Company Number
     C                     PARM P1R3CD    WQ0095  6        Entry Departmen
     C                     PARM P1EWAA    WQ0096  6        Entry Prod Line
     C                     PARM P1ELDT    WQ0097  70       Production Date
     C                     PARM P1N3SX    WQ0098  1        Production Shif
     C                     PARM P3OKSX    WQ0099  1        YDL Post Status
     C                     PARM P3ONSX    WQ0100  2        YDL Process Sta
     C                     PARM P3WXST    WQ0101  1        Record Found US
     C           P3OSSX    PARM P3OSSX    WQ0102  2        Yld Program USR
     C                     PARM P2OOSX    WQ0103  2        User Department
     C                     PARM P2OPSX    WQ0104  1        User Access
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POW4DFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVELP1R3CD    ZA0009           Department Code
     C                     MOVELP1EWAA    ZA0010           Production Line
      * Send message 'YR Opt Invalid'
     C                     MOVEL'USR3266' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     MOVEL'EX'      P3OSSX           Yld Program USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Exit to Menu
      * CASE: LCL.Yield Entry Type is Options
     C           YL0002    IFEQ 'O'                        *IF
     C                     MOVEL'EX'      P3OSSX           Yld Program USR
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *ITR
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Dte/Shft/PrcSts   RT - Yld Component  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAAIC3    WQSA01           Company Number
     C           *LIKE     DEFN WAE5AA    WQSA02           Entry Departmen
     C           *LIKE     DEFN WAE6AA    WQSA03           Entry Prod Line
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Company Number
     C                     KFLD           WQSA02           Entry Departmen
     C                     KFLD           WQSA03           Entry Prod Line
      * Setup key
     C                     Z-ADDP1AIC3    WQSA01           Company Number
     C                     MOVELP1R3CD    WQSA02           Entry Departmen
     C                     MOVELP1EWAA    WQSA03           Entry Prod Line
      * Establish starting position
     C           KRSSA     SETLL@CYRERM                    *
     C           KRSSA     READE@CYRERM                  90*
      * Data record not found
     C   90                MOVEL'USR3260' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Dte/Shft/PrcSts   RT - Production Line Yld Comp  * 
     C                     EXSR SBRVGN
      * CASE: PAR.Record Found USR is Record Found
     C           P3WXST    IFEQ 'Y'                        *IF
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSA     READE@CYRERM                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Dte/Shft/PrcSts   RT - Production Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBE4AA    WQSB02           Yld Component C
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Yld Component C
      * Setup key
     C                     Z-ADDWAAIC3    WQSB01           Company Number
     C                     MOVELWAE4AA    WQSB02           Yld Component C
      * Establish starting position
     C           KRSSB     SETLL@CZRERN                    *
     C           KRSSB     READE@CZRERN                  90*
      * Data record not found
     C   90                MOVEL'USR3262' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Dte/Shft/PrcSts   RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0004    P1ELDT           Production Date
     C                     MOVELWL0005    P1N3SX    P      Production Shif
     C                     MOVELWL0006    P3OKSX    P      YDL Post Status
     C                     MOVELWL0007    P3ONSX    P      YDL Process Sta
     C                     MOVELWL0008    P3WXST    P      Record Found US
      * CASE: PAR.Record Found USR is Record Found
     C           P3WXST    IFEQ 'Y'                        *IF
     C                     GOTO SBEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSB     READE@CZRERN                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Dte/Shft/PrcSts   RT - Yld Daily Line Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0004           Production Date
     C                     MOVEL*BLANK    WL0005           Production Shif
     C                     MOVEL*BLANK    WL0006           YDL Post Status
     C                     MOVEL*BLANK    WL0007           YDL Process Sta
     C                     MOVEL*BLANK    WL0008           Record Found US
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
     C           *LIKE     DEFN WCR3CD    WQSC02           Department Code
     C           *LIKE     DEFN WCEWAA    WQSC03           Production Line
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Department Code
     C                     KFLD           WQSC03           Production Line
      * Setup key
     C                     Z-ADDWL0001    WQSC01           Company Number
     C                     MOVELWL0002    WQSC02           Department Code
     C                     MOVELWL0003    WQSC03           Production Line
      * Establish starting position
     C           KRSSC     SETLL@CSCPQ1                    *
     C           KRSSC     READE@CSCPQ1                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3223' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WL0008           Record Found US
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCELDT    WL0004           Production Date
     C                     MOVELWCN3SX    WL0005           Production Shif
     C                     MOVELWCOKSX    WL0006           YDL Post Status
     C                     MOVELWCONSX    WL0007           YDL Process Sta
     C                     MOVEL'Y'       WL0008           Record Found US
     C           KRSSC     READE@CSCPQ1                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1AIC3           Company Number
     C                     MOVEL*BLANK    P1R3CD           Department Code
     C                     MOVEL*BLANK    P1EWAA           Production Line
     C                     Z-ADD*ZERO     P1ELDT           Production Date
     C                     MOVEL*BLANK    P1N3SX           Production Shif
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2OOSX           User Department
     C                     MOVEL*BLANK    P2OPSX           User Access
     C                     MOVEL*BLANK    P2ORSX           Yield Entry Typ
     C                     MOVEL*BLANK    P3OKSX           YDL Post Status
     C                     MOVEL*BLANK    P3ONSX           YDL Process Sta
     C                     MOVEL*BLANK    P3WXST           Record Found US
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field User Line In Process
     C                     MOVEL*BLANK    WUPHSX  1
      * Define work field UPLA Unused Sts 2
     C                     MOVEL*BLANK    WUPISX  1
      * Define work field UPLA Unused Sts 3
     C                     MOVEL*BLANK    WUPJSX  1
      * Define work field UPLA Unused Sts 4
     C                     MOVEL*BLANK    WUPKSX  2
      * Define work field UPLA Unused Sts 5
     C                     MOVEL*BLANK    WUPLSX  2
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBFLPC           PLYC Percent of
     C                     Z-ADD*ZERO     WBRGNB           Item Structure
     C                     Z-ADD*ZERO     WBRHNB           Item Structure
     C                     Z-ADD*ZERO     WBRINB           Item Structure
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCELDT           Production Date
     C                     Z-ADD*ZERO     WCJ3WG           Start Weight
     C                     Z-ADD*ZERO     WCW6NX           Start Pieces
     C                     Z-ADD*ZERO     WCJ6WG           Ending Weight
     C                     Z-ADD*ZERO     WCJ4WG           Converting Star
     C                     Z-ADD*ZERO     WCJ5WG           Converting End
     C                     Z-ADD*ZERO     WCF4PC           Pct Pieces Conv
     C                     Z-ADD*ZERO     WCKOWG           Total Line Weig
     C                     Z-ADD*ZERO     WCFJPC           Production Stan
     C                     Z-ADD*ZERO     WCFKPC           Actual Yield
     C                     Z-ADD*ZERO     WCFNPC           Yield Variance
     C                     Z-ADD*ZERO     WCKNWG           Weight Variance
     C                     Z-ADD*ZERO     WCXCNX           Hogs Cut
     C                     Z-ADD*ZERO     WCMEWG           Bone In Zone Av
     C                     Z-ADD*ZERO     WCMFWG           Bone Ls Zone St
     C                     Z-ADD*ZERO     WCW9NX           Bone Ls Zone Pi
     C                     Z-ADD*ZERO     WCXANX           Conv: Finished
     C                     Z-ADD*ZERO     WCXBNX           Loins Returned
     C                     Z-ADD*ZERO     WCMGWG           Start Wgt Retur
     C                     Z-ADD*ZERO     WCMHWG           Total Start Wgt
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  6
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  1
     C                     MOVEL*BLANK    WL0006  1
     C                     MOVEL*BLANK    WL0007  2
     C                     MOVEL*BLANK    WL0008  1
      * Define local work field Status - Y or N
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field Yield Entry Type
     C                     MOVEL*BLANK    YL0002  1
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
