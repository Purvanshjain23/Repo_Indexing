/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PMRIUPC                                       */
/*  PROGRAM NAME:    VALIDATE "Z" MEMBERS EXIST FOR AT LEAST       */
/*                   ONE FILE FOR APPLICATION CODE                 */
/*  PROGRAMMER:      LARA BUSER                                    */
/*  CREATE DATE:     04/21/2009                                    */
/*                                                                 */
/*  FUNCTION:        THIS CL IS CALLED FROM VAL "Z" MEMBERS EXIST  */
/*                   RT FUNCTION                                   */
/*******************************************************************/
/* Modification History                                            */
/* MM/DD/YYYY XXX XXNNNN                                           */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&PCGCODE &PCGLIB &PCACODE &PRGTAPF +
                          &TOLIB &RTNCODE)

             DCL        VAR(&PCGCODE) TYPE(*CHAR) LEN(3)
             DCL        VAR(&PCGLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PCACODE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&PRGTAPF) TYPE(*CHAR) LEN(10)
             DCL        VAR(&TOLIB) TYPE(*CHAR) LEN(10)
             DCL        VAR(&RTNCODE) TYPE(*CHAR) LEN(7)
             DCL        VAR(&MBRS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&MBRNAME) TYPE(*CHAR) LEN(10)

/*-----------------------------------------------------------------*/
/* SEE IF "Z" MEMBERS EXIST IN THE ASSOCIATED PURGE TAPE FILE      */
/* IN THE PURGE LIBRARY                                            */
/*-----------------------------------------------------------------*/
             CHGVAR     VAR(&MBRS) VALUE('Y')
             RTVMBRD    FILE(&TOLIB/&PRGTAPF) MBR(Z*) RTNMBR(&MBRNAME)
             MONMSG     MSGID(CPF0000) EXEC(CHGVAR VAR(&MBRS) +
                          VALUE('N'))
             IF         COND(&MBRS *EQ 'Y') THEN(DO)
             CHGVAR     VAR(&RTNCODE) VALUE('RCDFND')
             ENDDO

/* END PROGRAM                                                     */
 DONE:       ENDPGM
