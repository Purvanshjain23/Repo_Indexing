     H/TITLE Prc GAF Ship Order Dtl XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by  : 2E  Version:  1135
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISSMASO
     H* Date          : 05/11/04  Time  : 08:58:16
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPONOCPL1IF  E           K        DISK
      * RTV : GAF Ship Order Detail     Retrieval index
      *
     FPOACCPL1IF  E           K        DISK
      * RTV : GAF Ship Order Dtl Hist   Retrieval index
      *
     FPOAEREL2IF  E           K        DISK
      * RSQ : GAF Company Cross Ref     RSQ GAF Customer
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPOACCPL0UF  E           K        DISK                      A
      * UPD : GAF Ship Order Dtl Hist   Update index
      *
     I@NOCPBU
      * GAF Ship Order Detail     Retrieval index
      * Renamed input format fields
     I              NOKCNX                          WAKCNX
     I              NOKYNX                          WAKYNX
     I              NOKTNX                          WAKTNX
     I              NOLHNX                          WALHNX
     I              NOLINX                          WALINX
     I              NOLJNX                          WALJNX
     I              NOLKNX                          WALKNX
     I              NOLLNX                          WALLNX
      *
     I@ACCPB9
      * GAF Ship Order Dtl Hist   Retrieval index
      * Renamed input format fields
     I              ACKCNX                          WBKCNX
     I              ACC4NB                          WBC4NB
     I              ACKTNX                          WBKTNX
     I              ACHGCD                          WBHGCD
     I              ACELDT                          WBELDT
     I              ACF9DT                          WBF9DT
     I              ACCBQT                          WBCBQT
     I              ACATWG                          WBATWG
     I              ACH2SX                          WBH2SX
     I              ACH3SX                          WBH3SX
     I              ACUVST                          WBUVST
     I              ACUWST                          WBUWST
     I              ACUXST                          WBUXST
     I              ACAATM                          WBAATM
     I              ACAYNA                          WBAYNA
     I              ACA0NA                          WBA0NA
     I              ACAXDT                          WBAXDT
      *
     I@ACCPB8
      * GAF Ship Order Dtl Hist   Update index
      * Renamed input format fields
     I              ACKCNX                          WCKCNX
     I              ACC4NB                          WCC4NB
     I              ACKTNX                          WCKTNX
     I              ACHGCD                          WCHGCD
     I              ACELDT                          WCELDT
     I              ACF9DT                          WCF9DT
     I              ACCBQT                          WCCBQT
     I              ACATWG                          WCATWG
     I              ACH2SX                          WCH2SX
     I              ACH3SX                          WCH3SX
     I              ACUVST                          WCUVST
     I              ACUWST                          WCUWST
     I              ACUXST                          WCUXST
     I              ACAATM                          WCAATM
     I              ACAYNA                          WCAYNA
     I              ACA0NA                          WCA0NA
     I              ACAXDT                          WCAXDT
      *
     I@AERECM
      * GAF Company Cross Ref     RSQ GAF Customer
      * Renamed input format fields
     I              AEAIC3                          WDAIC3
     I              AEAJCD                          WDAJCD
     I              AEKCNX                          WDKCNX
     I              AEWCTX                          WDWCTX
     I              AEH5SX                          WDH5SX
     I              AEUVST                          WDUVST
     I              AEUWST                          WDUWST
     I              AEUXST                          WDUXST
     I              AEAATM                          WDAATM
     I              AEAYNA                          WDAYNA
     I              AEA0NA                          WDA0NA
     I              AEAXDT                          WDAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WEAIC3
     I              BEC4NB                          WEC4NB
     I              BEJNCD                          WEJNCD
     I              BEANC7                          WEANC7
     I              BEBKC7                          WEBKC7
     I              BEBRTX                          WEBRTX
     I              BEHMNA                          WEHMNA
     I              BEHONA                          WEHONA
     I              BEHPNA                          WEHPNA
     I              BEHNNA                          WEHNNA
     I              BEDBCD                          WEDBCD
     I              BECKTX                          WECKTX
     I              BEB0C7                          WEB0C7
     I              BEAETX                          WEAETX
     I              BEB1NA                          WEB1NA
     I              BEB3NA                          WEB3NA
     I              BEB4NA                          WEB4NA
     I              BEB2NA                          WEB2NA
     I              BEBHCD                          WEBHCD
     I              BEC8TX                          WEC8TX
     I              BEBCNA                          WEBCNA
     I              BEA0DT                          WEA0DT
     I              BEA5DT                          WEA5DT
     I              BEGNDT                          WEGNDT
     I              BEACDT                          WEACDT
     I              BEAQCD                          WEAQCD
     I              BEB6NA                          WEB6NA
     I              BEBYNA                          WEBYNA
     I              BEBZNA                          WEBZNA
     I              BEGTST                          WEGTST
     I              BEGVST                          WEGVST
     I              BEGUST                          WEGUST
     I              BEQFST                          WEQFST
     I              BECQCD                          WECQCD
     I              BEGJST                          WEGJST
     I              BEGWST                          WEGWST
     I              BEGXST                          WEGXST
     I              BEGYST                          WEGYST
     I              BEAODT                          WEAODT
     I              BEAIVN                          WEAIVN
     I              BECXDT                          WECXDT
     I              BEJZVA                          WEJZVA
     I              BEA1WG                          WEA1WG
     I              BEXIST                          WEXIST
     I              BEXJST                          WEXJST
     I              BEXKST                          WEXKST
     I              BEEIDT                          WEEIDT
     I              BEAFTM                          WEAFTM
     I              BEE8CD                          WEE8CD
     I              BEE9CD                          WEE9CD
     I              BERMNB                          WERMNB
     I              BETBNB                          WETBNB
     I              BER1NB                          WER1NB
     I              BEPJST                          WEPJST
     I              BEU0ST                          WEU0ST
     I              BEU1ST                          WEU1ST
     I              BEQ2CD                          WEQ2CD
     I              BEU2ST                          WEU2ST
     I              BEVEST                          WEVEST
     I              BEVFST                          WEVFST
     I              BEVGST                          WEVGST
     I              BERPCD                          WERPCD
     I              BERNNB                          WERNNB
     I              BEVDST                          WEVDST
     I              BEATIN                          WEATIN
     I              BEU4ST                          WEU4ST
     I              BEU5ST                          WEU5ST
     I              BERSRN                          WERSRN
     I              BEMHNA                          WEMHNA
     I              BEMINA                          WEMINA
     I              BEWBST                          WEWBST
     I              BER4CD                          WER4CD
     I              BEBFCD                          WEBFCD
     I              BEQ4CD                          WEQ4CD
     I              BET3NB                          WET3NB
     I              BESICD                          WESICD
     I              BECONB                          WECONB
     I              BECEST                          WECEST
     I              BEAWDT                          WEAWDT
     I              BEJPCD                          WEJPCD
     I              BEXUST                          WEXUST
     I              BEZ1ST                          WEZ1ST
     I              BEVRVA                          WEVRVA
     I              BEOBST                          WEOBST
     I              BEBCST                          WEBCST
     I              BEBDST                          WEBDST
     I              BEB7VL                          WEB7VL
     I              BEGASX                          WEGASX
     I              BEGBSX                          WEGBSX
     I              BEGCSX                          WEGCSX
     I              BEGDSX                          WEGDSX
     I              BEFNSX                          WEFNSX
     I              BEFOSX                          WEFOSX
     I              BEFPSX                          WEFPSX
     I              BEFQSX                          WEFQSX
     I              BEFRSX                          WEFRSX
     I              BEFSSX                          WEFSSX
     I              BEFTSX                          WEFTSX
     I              BEFUSX                          WEFUSX
     I              BEFVSX                          WEFVSX
     I              BEFWSX                          WEFWSX
     I              BEFXSX                          WEFXSX
     I              BEFYSX                          WEFYSX
     I              BENODT                          WENODT
     I              BENPDT                          WENPDT
     I              BENQDT                          WENQDT
     I              BENRDT                          WENRDT
     I              BENSDT                          WENSDT
     I              BEBPTM                          WEBPTM
     I              BEBQTM                          WEBQTM
     I              BEBRTM                          WEBRTM
     I              BEBSTM                          WEBSTM
     I              BEBTTM                          WEBTTM
     I              BEH0NX                          WEH0NX
     I              BEH1NX                          WEH1NX
     I              BEH2NX                          WEH2NX
     I              BEH3NX                          WEH3NX
     I              BEH4NX                          WEH4NX
     I              BEC0C7                          WEC0C7
     I              BEUVST                          WEUVST
     I              BEUWST                          WEUWST
     I              BEUXST                          WEUXST
     I              BEAATM                          WEAATM
     I              BEAYNA                          WEAYNA
     I              BEA0NA                          WEA0NA
     I              BEAXDT                          WEAXDT
      *
     I@BZREJU
      * Company Item              Retrieval index       NV
      * Renamed input format fields
     I              BZAIC3                          WFAIC3
     I              BZHGCD                          WFHGCD
     I              BZAVNA                          WFAVNA
     I              BZAWNA                          WFAWNA
     I              BZL7NA                          WFL7NA
     I              BZL8NA                          WFL8NA
     I              BZL6NA                          WFL6NA
     I              BZMFNA                          WFMFNA
     I              BZADCD                          WFADCD
     I              BZAWPC                          WFAWPC
     I              BZLXST                          WFLXST
     I              BZAECD                          WFAECD
     I              BZAXPC                          WFAXPC
     I              BZLYST                          WFLYST
     I              BZAFCD                          WFAFCD
     I              BZAICD                          WFAICD
     I              BZAIWG                          WFAIWG
     I              BZHICD                          WFHICD
     I              BZRBCD                          WFRBCD
     I              BZFZST                          WFFZST
     I              BZAVST                          WFAVST
     I              BZCZWG                          WFCZWG
     I              BZC0WG                          WFC0WG
     I              BZURTN                          WFURTN
     I              BZAJC8                          WFAJC8
     I              BZRINB                          WFRINB
     I              BZRHNB                          WFRHNB
     I              BZRGNB                          WFRGNB
     I              BZLNCD                          WFLNCD
     I              BZTFNB                          WFTFNB
     I              BZN0CD                          WFN0CD
     I              BZX4ST                          WFX4ST
     I              BZTMVA                          WFTMVA
     I              BZTNVA                          WFTNVA
     I              BZBLPR                          WFBLPR
     I              BZBMPR                          WFBMPR
     I              BZLRCD                          WFLRCD
     I              BZU9ST                          WFU9ST
     I              BZCMCO                          WFCMCO
     I              BZQ1CD                          WFQ1CD
     I              BZQ8CD                          WFQ8CD
     I              BZCHTM                          WFCHTM
     I              BZQZCD                          WFQZCD
     I              BZXWST                          WFXWST
     I              BZXXST                          WFXXST
     I              BZVMST                          WFVMST
     I              BZSWGH                          WFSWGH
     I              BZPPHE                          WFPPHE
     I              BZR3CD                          WFR3CD
     I              BZSDCD                          WFSDCD
     I              BZICN1                          WFICN1
     I              BZSVCD                          WFSVCD
     I              BZICN2                          WFICN2
     I              BZSWCD                          WFSWCD
     I              BZV2NB                          WFV2NB
     I              BZSXCD                          WFSXCD
     I              BZITCN                          WFITCN
     I              BZSYCD                          WFSYCD
     I              BZITC5                          WFITC5
     I              BZSZCD                          WFSZCD
     I              BZICN6                          WFICN6
     I              BZS0CD                          WFS0CD
     I              BZICN7                          WFICN7
     I              BZS1CD                          WFS1CD
     I              BZICN8                          WFICN8
     I              BZS2CD                          WFS2CD
     I              BZICN9                          WFICN9
     I              BZS3CD                          WFS3CD
     I              BZICN0                          WFICN0
     I              BZS4CD                          WFS4CD
     I              BZSFNB                          WFSFNB
     I              BZA3WG                          WFA3WG
     I              BZSJNB                          WFSJNB
     I              BZLLCD                          WFLLCD
     I              BZLMCD                          WFLMCD
     I              BZP3ST                          WFP3ST
     I              BZSKNB                          WFSKNB
     I              BZSLNB                          WFSLNB
     I              BZSMNB                          WFSMNB
     I              BZP4ST                          WFP4ST
     I              BZCFNB                          WFCFNB
     I              BZCGNB                          WFCGNB
     I              BZILNB                          WFILNB
     I              BZCHNB                          WFCHNB
     I              BZCINB                          WFCINB
     I              BZCJNB                          WFCJNB
     I              BZCMNB                          WFCMNB
     I              BZCNNB                          WFCNNB
     I              BZCRNB                          WFCRNB
     I              BZCSNB                          WFCSNB
     I              BZCVNB                          WFCVNB
     I              BZCWNB                          WFCWNB
     I              BZCXNB                          WFCXNB
     I              BZCZNB                          WFCZNB
     I              BZC0NB                          WFC0NB
     I              BZN1CD                          WFN1CD
     I              BZB4NB                          WFB4NB
     I              BZB5NB                          WFB5NB
     I              BZX5ST                          WFX5ST
     I              BZX6ST                          WFX6ST
     I              BZX7ST                          WFX7ST
     I              BZPCCT                          WFPCCT
     I              BZBDNB                          WFBDNB
     I              BZBJNB                          WFBJNB
     I              BZSUST                          WFSUST
     I              BZSVST                          WFSVST
     I              BZSYST                          WFSYST
     I              BZSZST                          WFSZST
     I              BZS1ST                          WFS1ST
     I              BZXRCD                          WFXRCD
     I              BZXTCD                          WFXTCD
     I              BZXUCD                          WFXUCD
     I              BZF5WG                          WFF5WG
     I              BZF6WG                          WFF6WG
     I              BZF7WG                          WFF7WG
     I              BZBLNB                          WFBLNB
     I              BZBNNB                          WFBNNB
     I              BZS2ST                          WFS2ST
     I              BZS4ST                          WFS4ST
     I              BZS5ST                          WFS5ST
     I              BZS6ST                          WFS6ST
     I              BZS8ST                          WFS8ST
     I              BZS9ST                          WFS9ST
     I              BZTCST                          WFTCST
     I              BZTDST                          WFTDST
     I              BZUVST                          WFUVST
     I              BZUWST                          WFUWST
     I              BZUXST                          WFUXST
     I              BZVSST                          WFVSST
     I              BZAATM                          WFAATM
     I              BZAYNA                          WFAYNA
     I              BZA0NA                          WFA0NA
     I              BZAXDT                          WFAXDT
      *
     I@AFREBE
      * Calendar                  Retrieval index       NV
      * Renamed input format fields
     I              AFAIC3                          WGAIC3
     I              AFBCDT                          WGBCDT
     I              AFCQNB                          WGCQNB
     I              AFESNB                          WGESNB
     I              AFETNB                          WGETNB
     I              AFBZNB                          WGBZNB
     I              AFA9ST                          WGA9ST
     I              AFEINB                          WGEINB
     I              AFC5ST                          WGC5ST
     I              AFAQNB                          WGAQNB
     I              AFCMST                          WGCMST
     I              AFV9ST                          WGV9ST
     I              AFWAST                          WGWAST
     I              AFX2ST                          WGX2ST
     I              AFOJDT                          WGOJDT
     I              AFNQNX                          WGNQNX
     I              AFNRNX                          WGNRNX
     I              AFI9SX                          WGI9SX
     I              AFJASX                          WGJASX
     I              AFOKDT                          WGOKDT
     I              AFOLDT                          WGOLDT
     I              AFUVST                          WGUVST
     I              AFUWST                          WGUWST
     I              AFUXST                          WGUXST
     I              AFAATM                          WGAATM
     I              AFAYNA                          WGAYNA
     I              AFA0NA                          WGA0NA
     I              AFAXDT                          WGAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOAC1    E DSPOACCPL0
      * UPD : GAF Ship Order Dtl Hist   Update index
      * Renamed input format fields
     I              ACKCNX                          WCKCNX
     I              ACC4NB                          WCC4NB
     I              ACKTNX                          WCKTNX
     I              ACHGCD                          WCHGCD
     I              ACELDT                          WCELDT
     I              ACF9DT                          WCF9DT
     I              ACCBQT                          WCCBQT
     I              ACATWG                          WCATWG
     I              ACH2SX                          WCH2SX
     I              ACH3SX                          WCH3SX
     I              ACUVST                          WCUVST
     I              ACUWST                          WCUWST
     I              ACUXST                          WCUXST
     I              ACAATM                          WCAATM
     I              ACAYNA                          WCAYNA
     I              ACA0NA                          WCA0NA
     I              ACAXDT                          WCAXDT
      *
     IYARDCS      DS                             77
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc GAF Ship Order Dtl XF
      * Prc GAF Ship Order Dtl RT - GAF Ship Order Detail  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Prc GAF Ship Order Dtl RT - GAF Ship Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       GAF Order Numbe
     C                     MOVEL*BLANK    WN0002  1        First Time Flag
     C                     MOVEL*BLANK    WN0003  1        GAF Process Cod
     C                     MOVEL*BLANK    WN0004  1        GAF Error Code
     C                     Z-ADD*ZERO     WN0005  30       Company Number
     C                     Z-ADD*ZERO     WN0006  70       Order Number
     C                     MOVEL*BLANK    WN0007  1        Header Status
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'Y'       WN0002           First Time Flag
      * Establish starting position
     C           *LOVAL    SETLL@NOCPBU                    *
     C                     READ @NOCPBU                  90*
      * Data record not found
     C   90                MOVEL'USR2918' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Setup order break on first time flag
      * CASE: PAR.First Time Flag is Yes
     C           WN0002    IFEQ 'Y'                        *IF
     C                     Z-ADDWAKYNX    WN0001           GAF Order Numbe
     C                     MOVEL*BLANK    WN0004           GAF Error Code
     C                     MOVEL'N'       WN0002           First Time Flag
     C                     END                             *FI
      * Change history file on order break
      * CASE: PAR.GAF Order Number Numeric NE DB1.GAF Order Number Numeri
     C           WN0001    IFNE WAKYNX                     *IF
      * Rtv Chg Error/Process  RT - GAF Ship Order Dtl Hist  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAKCNX    WL0001           GAF Customer Nu
     C                     Z-ADDWN0001    WL0002           Order Number
     C                     MOVEL'N'       WL0003    P      GAF Process Cod
     C                     MOVELWN0004    WL0004    P      GAF Error Code
     C                     EXSR SBRVGN
     C                     Z-ADDWAKYNX    WN0001           GAF Order Numbe
     C                     MOVEL*BLANK    WN0004           GAF Error Code
     C                     END                             *FI
      * Val Cust Exists        RT - GAF Company Cross Ref  * 
     C                     EXSR SDRVGN
      * If not a valid GAF Cust then Error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'E'       WN0004           GAF Error Code
     C                     END                             *FI
      * RTV Header Status      RT - PD Order Header      TRG  * 
     C                     EXSR SERVGN
      * If order is canceled, shipped, complete or not found then error
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Header Status is Conf/Comp/Canc
      *   |- c2    : PGM.*Return code is *Record does not exist
      *   '-
     C           WN0007    IFEQ 'X'                        *IF
     C           WN0007    OREQ 'C'
     C           WN0007    OREQ 'R'
     C           W0RTN     OREQ 'Y2U0005'                  *OR
     C                     MOVEL'E'       WN0004           GAF Error Code
     C                     END                             *FI
      * Val Comp/Item Exists   RT - Company/Item  * 
     C                     EXSR SFRVGN
      * If item does not exists then error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'E'       WN0004           GAF Error Code
     C                     END                             *FI
      * Validate production date
      * CASE: DB1.GAF Production Date is Entered
     C           WALINX    IFNE *ZERO                      *IF
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0005    WL0005           Company Number
     C                     Z-ADDWALINX    WL0006           Post to G/L Dat
     C                     EXSR SGRVGN
      * If production date is invalid then error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'E'       WN0004           GAF Error Code
     C                     END                             *FI
     C                     END                             *FI
      * Validate actual ship date
      * CASE: DB1.GAF Actual Ship Date is Entered
     C           WALJNX    IFNE *ZERO                      *IF
      * VAL Date               RT - Calendar  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWN0005    WL0005           Company Number
     C                     Z-ADDWALJNX    WL0006           Post to G/L Dat
     C                     EXSR SGRVGN
      * If actual ship date is invalid then error
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'E'       WN0004           GAF Error Code
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'E'       WN0004           GAF Error Code
     C                     END                             *FI
      * Val GAF Ship Order Dtl RT - GAF Ship Order Dtl Hist  * 
     C                     EXSR SHRVGN
      * If order not already in history file create history record.
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Crt GAF Ship Order Dtl CR - GAF Ship Order Dtl Hist  * 
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     READ @NOCPBU                  90*
     C                     ENDDO
      * USER: Exit processing
      * Rtv Chg Error/Process  RT - GAF Ship Order Dtl Hist  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWAKCNX    WL0001           GAF Customer Nu
     C                     Z-ADDWN0001    WL0002           Order Number
     C                     MOVEL'N'       WL0003    P      GAF Process Cod
     C                     MOVELWN0004    WL0004    P      GAF Error Code
     C                     EXSR SBRVGN
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Chg Error/Process  RT - GAF Ship Order Dtl Hist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBKCNX    WQSB01           GAF Customer Nu
     C           *LIKE     DEFN WBC4NB    WQSB02           Order Number
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           GAF Customer Nu
     C                     KFLD           WQSB02           Order Number
      * Setup key
     C                     Z-ADDWL0001    WQSB01           GAF Customer Nu
     C                     Z-ADDWL0002    WQSB02           Order Number
      * Establish starting position
     C           KRSSB     SETLL@ACCPB9                    *
     C           KRSSB     READE@ACCPB9                  90*
      * Data record not found
     C   90                MOVEL'USR2925' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Process/Error Cds  CH - GAF Ship Order Dtl Hist  * 
     C                     EXSR SCCHRC
     C           KRSSB     READE@ACCPB9                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Process/Error Cds  CH - GAF Ship Order Dtl Hist  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0008  70       Actual Ship Dat
     C                     Z-ADD*ZERO     WN0009 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0010 112       Weight Shipped
     C                     MOVEL*BLANK    WN0011  1        EDI Status 1
     C                     MOVEL*BLANK    WN0012  1        EDI Status 2
     C                     MOVEL*BLANK    WN0013  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0014  60       Job Time
     C                     MOVEL*BLANK    WN0015 10        User Id
     C                     MOVEL*BLANK    WN0016 10        Job Name
     C                     Z-ADD*ZERO     WN0017  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ACCPB8
     C                     Z-ADDWBKCNX    WCKCNX           GAF Customer Nu
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
     C                     Z-ADDWBKTNX    WCKTNX           GAF Ticket Numb
     C                     Z-ADDWBHGCD    WCHGCD           Item Code
     C                     Z-ADDWBELDT    WCELDT           Production Date
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCKCNX           GAF Customer Nu
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCKTNX           GAF Ticket Numb
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCELDT           Production Date
     C           KLCHSC    CHAIN@ACCPB8              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POACCPL0'MDACP
     C                     MOVEL'@ACCPB8' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOAC1    YARDCS
      * Move non-key fields to @ACCPB8
     C                     MOVELWL0003    WCH2SX    P      GAF Process Cod
     C                     MOVELWL0004    WCH3SX    P      GAF Error Code
      *
      * Set PGM.*Record Data Changed flag
     C           QPOAC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOAC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ACCPB8                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOACCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Val Cust Exists        RT - GAF Company Cross Ref  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDKCNX    WQSD01           GAF Customer Nu
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           GAF Customer Nu
      * Setup key
     C                     Z-ADDWAKCNX    WQSD01           GAF Customer Nu
      * Establish starting position
     C           KRSSD     SETLL@AERECM                    *
     C           KRSSD     READE@AERECM                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2929' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           Company Number
     C                     MOVEL*BLANK    YN0001           Warehouse Code
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.GAF Customer Number EQ PAR.GAF Customer Number
     C           WDKCNX    IFEQ WAKCNX                     *IF
      * PAR = DB1 By name
     C                     Z-ADDWDAIC3    WN0005           Company Number
     C                     MOVELWDAJCD    YN0001           Warehouse Code
     C                     END                             *FI
     C                     GOTO SDEXIT                     *QUIT
     C           KRSSD     READE@AERECM                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - PD Order Header      TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
      * Setup key
     C                     Z-ADDWN0005    WEAIC3           Company Number
     C                     Z-ADDWAKYNX    WEC4NB           Order Number
      * Establish starting position
     C           KRSSE     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEGWST    WN0007           Header Status
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Val Comp/Item Exists   RT - Company/Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFAIC3           Company Number
     C                     KFLD           WFHGCD           Item Code
      * Setup key
     C                     Z-ADDWN0005    WFAIC3           Company Number
     C                     Z-ADDWALHNX    WFHGCD           Item Code
      * Establish starting position
     C           KRSSF     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y2U0003' W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * VAL Date               RT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGBCDT           Post to G/L Dat
      * Setup key
     C                     Z-ADDWL0005    WGAIC3           Company Number
     C                     Z-ADDWL0006    WGBCDT           Post to G/L Dat
      * Establish starting position
     C           KRSSG     CHAIN@AFREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0018' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Val GAF Ship Order Dtl RT - GAF Ship Order Dtl Hist  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WBKCNX           GAF Customer Nu
     C                     KFLD           WBC4NB           Order Number
     C                     KFLD           WBKTNX           GAF Ticket Numb
     C                     KFLD           WBHGCD           Item Code
     C                     KFLD           WBELDT           Production Date
      * Setup key
     C                     Z-ADDWAKCNX    WBKCNX           GAF Customer Nu
     C                     Z-ADDWAKYNX    WBC4NB           Order Number
     C                     Z-ADDWAKTNX    WBKTNX           GAF Ticket Numb
     C                     Z-ADDWALHNX    WBHGCD           Item Code
     C                     Z-ADDWALINX    WBELDT           Production Date
      * Establish starting position
     C           KRSSH     CHAIN@ACCPB9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2925' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Crt GAF Ship Order Dtl CR - GAF Ship Order Dtl Hist  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0018  1        EDI Status 1
     C                     MOVEL*BLANK    WN0019  1        EDI Status 2
     C                     MOVEL*BLANK    WN0020  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0021  60       Job Time
     C                     MOVEL*BLANK    WN0022 10        User Id
     C                     MOVEL*BLANK    WN0023 10        Job Name
     C                     Z-ADD*ZERO     WN0024  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ACCPB8
     C                     Z-ADDWAKCNX    WCKCNX           GAF Customer Nu
     C                     Z-ADDWAKYNX    WCC4NB           Order Number
     C                     Z-ADDWAKTNX    WCKTNX           GAF Ticket Numb
     C                     Z-ADDWALHNX    WCHGCD           Item Code
     C                     Z-ADDWALINX    WCELDT           Production Date
     C                     Z-ADDWALJNX    WCF9DT           Actual Ship Dat
     C                     Z-ADDWALKNX    WCCBQT           Quantity Shippe
     C                     Z-ADDWALLNX    WCATWG           Weight Shipped
     C                     MOVEL'N'       WCH2SX           GAF Process Cod
     C                     MOVEL*BLANK    WCH3SX           GAF Error Code
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WCAATM           Job Time
     C                     MOVEL##USR     WCAYNA           User Id
     C                     MOVEL##JOB     WCA0NA           Job Name
     C                     Z-ADD##JDT     WCAXDT           Job Date
     C           KLCRSI    KLIST
     C                     KFLD           WCKCNX           GAF Customer Nu
     C                     KFLD           WCC4NB           Order Number
     C                     KFLD           WCKTNX           GAF Ticket Numb
     C                     KFLD           WCHGCD           Item Code
     C                     KFLD           WCELDT           Production Date
      * Check for duplicate primary key
     C           KLCRSI    SETLL@ACCPB8                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2926' W0RTN   7
      * Send message 'GAF Ship Order Dtl His EX'
     C                     MOVEL'USR2926' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@ACCPB8                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAKCNX           GAF Customer Nu
     C                     Z-ADD*ZERO     WAKYNX           GAF Order Numbe
     C                     Z-ADD*ZERO     WAKTNX           GAF Ticket Numb
     C                     Z-ADD*ZERO     WALHNX           GAF Item Code
     C                     Z-ADD*ZERO     WALINX           GAF Production
     C                     Z-ADD*ZERO     WALJNX           GAF Actual Ship
     C                     Z-ADD*ZERO     WALKNX           GAF Quantity Sh
     C                     Z-ADD*ZERO     WALLNX           GAF Weight Ship
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBKCNX           GAF Customer Nu
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBKTNX           GAF Ticket Numb
     C                     Z-ADD*ZERO     WBHGCD           Item Code
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WBCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WBATWG           Weight Shipped
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDKCNX           GAF Customer Nu
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEC4NB           Order Number
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WEA0DT           Order Date
     C                     Z-ADD*ZERO     WEA5DT           Requested Ship
     C                     Z-ADD*ZERO     WEGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WEACDT           Cancel Date
     C                     Z-ADD*ZERO     WEAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WECXDT           Date of Origina
     C                     Z-ADD*ZERO     WEJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WEA1WG           Order Weight To
     C                     Z-ADD*ZERO     WEEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WEAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WERMNB           Load ID
     C                     Z-ADD*ZERO     WETBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WER1NB           Rated Freight
     C                     Z-ADD*ZERO     WERNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WEATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WERSRN           Resell Referenc
     C                     Z-ADD*ZERO     WET3NB           Attach to Order
     C                     Z-ADD*ZERO     WECONB           Invoice Number
     C                     Z-ADD*ZERO     WEAWDT           Invoice Date
     C                     Z-ADD*ZERO     WEVRVA           A/R order Value
     C                     Z-ADD*ZERO     WEB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WENODT           OH Unused Date
     C                     Z-ADD*ZERO     WENPDT           OH Unused Date
     C                     Z-ADD*ZERO     WENQDT           OH Unused Date
     C                     Z-ADD*ZERO     WENRDT           OH Unused Date
     C                     Z-ADD*ZERO     WENSDT           OH Unused Date
     C                     Z-ADD*ZERO     WEBPTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBQTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WEBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WEH0NX           OH Unused Nbr 1
     C                     Z-ADD*ZERO     WEH1NX           OH Unused Nbr 2
     C                     Z-ADD*ZERO     WEH2NX           OH Unused Nbr 3
     C                     Z-ADD*ZERO     WEH3NX           OH Unused Nbr 4
     C                     Z-ADD*ZERO     WEH4NX           OH Unused Nbr 5
     C                     Z-ADD*ZERO     WEC0C7           Claim Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFAWPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAXPC           Conversion Fact
     C                     Z-ADD*ZERO     WFAIWG           Unit Weight
     C                     Z-ADD*ZERO     WFCZWG           Minimum Weight
     C                     Z-ADD*ZERO     WFC0WG           Maximum Weight
     C                     Z-ADD*ZERO     WFURTN           Number Cases On
     C                     Z-ADD*ZERO     WFAJC8           Vendor - Item D
     C                     Z-ADD*ZERO     WFRINB           Item Structure
     C                     Z-ADD*ZERO     WFRHNB           Item Structure
     C                     Z-ADD*ZERO     WFRGNB           Item Structure
     C                     Z-ADD*ZERO     WFTFNB           Transportation
     C                     Z-ADD*ZERO     WFTMVA           Maximum Audit V
     C                     Z-ADD*ZERO     WFTNVA           Minimum Audit V
     C                     Z-ADD*ZERO     WFBLPR           Market Overage
     C                     Z-ADD*ZERO     WFBMPR           Standard Overag
     C                     Z-ADD*ZERO     WFCMCO           Item Pricing Co
     C                     Z-ADD*ZERO     WFCHTM           Fresh Chilling
     C                     Z-ADD*ZERO     WFSWGH           Std Weight/Head
     C                     Z-ADD*ZERO     WFPPHE           Pieces Per Head
     C                     Z-ADD*ZERO     WFICN1           Item Category N
     C                     Z-ADD*ZERO     WFICN2           Item Category N
     C                     Z-ADD*ZERO     WFV2NB           Item Category N
     C                     Z-ADD*ZERO     WFITCN           Item Category N
     C                     Z-ADD*ZERO     WFITC5           Item Category N
     C                     Z-ADD*ZERO     WFICN6           Item Category N
     C                     Z-ADD*ZERO     WFICN7           Item Category N
     C                     Z-ADD*ZERO     WFICN8           Item Category N
     C                     Z-ADD*ZERO     WFICN9           Item Category N
     C                     Z-ADD*ZERO     WFICN0           Iten Category N
     C                     Z-ADD*ZERO     WFSFNB           Pallet Tare Wei
     C                     Z-ADD*ZERO     WFA3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     WFSJNB           Packages (Trays
     C                     Z-ADD*ZERO     WFSKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     WFSLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     WFSMNB           Agrimetrics gra
     C                     Z-ADD*ZERO     WFCFNB           PM Pounds per H
     C                     Z-ADD*ZERO     WFCGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     WFILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     WFCHNB           PM Size
     C                     Z-ADD*ZERO     WFCINB           PM Batch Size
     C                     Z-ADD*ZERO     WFCJNB           PM Lot Size
     C                     Z-ADD*ZERO     WFCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WFCNNB           WIP Item Code
     C                     Z-ADD*ZERO     WFCRNB           WIP Reject Code
     C                     Z-ADD*ZERO     WFCSNB           PM Raw Yield
     C                     Z-ADD*ZERO     WFCVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     WFCWNB           PM Standard LBS
     C                     Z-ADD*ZERO     WFCXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     WFCZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     WFC0NB           PM Finished LBS
     C                     Z-ADD*ZERO     WFB4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     WFB5NB           PM Line Number
     C                     Z-ADD*ZERO     WFBDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     WFBJNB           Bags Per Unit
     C                     Z-ADD*ZERO     WFF5WG           Item Target Pri
     C                     Z-ADD*ZERO     WFF6WG           Minimum Piece W
     C                     Z-ADD*ZERO     WFF7WG           Maximum Piece W
     C                     Z-ADD*ZERO     WFBLNB           Seaboard Equiva
     C                     Z-ADD*ZERO     WFBNNB           Production Qty
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGAIC3           Company Number
     C                     Z-ADD*ZERO     WGBCDT           Post to G/L Dat
     C                     Z-ADD*ZERO     WGCQNB           Julian Date
     C                     Z-ADD*ZERO     WGESNB           Accounting Year
     C                     Z-ADD*ZERO     WGETNB           Accounting Peri
     C                     Z-ADD*ZERO     WGBZNB           OM Week
     C                     Z-ADD*ZERO     WGEINB           Week Number
     C                     Z-ADD*ZERO     WGAQNB           Billing Cycle
     C                     Z-ADD*ZERO     WGOJDT           HPS PIC Date
     C                     Z-ADD*ZERO     WGNQNX           HPS Calendar Ye
     C                     Z-ADD*ZERO     WGNRNX           HPS Calendar We
     C                     Z-ADD*ZERO     WGOKDT           Calendar Unused
     C                     Z-ADD*ZERO     WGOLDT           Calendar Unused
     C                     Z-ADD*ZERO     WGAATM           Job Time
     C                     Z-ADD*ZERO     WGAXDT           Job Date
      * Clear all neither parameters
      * Crt GAF Ship Order Dtl CR - GAF Ship Order Dtl Hist  * 
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SBRVGN.
     C                     Z-ADD*ZERO     WL0001  90
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  1
     C                     MOVEL*BLANK    WL0004  1
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
      * Define null work field Warehouse Code
     C                     MOVEL*BLANK    YN0001  3
      *================================================================
     CSR         ZZEXIT    ENDSR
