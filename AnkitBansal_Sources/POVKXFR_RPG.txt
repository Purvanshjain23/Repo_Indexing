     H/TITLE Exc Calc Actual Yld   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.5 (1351)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 12/03/10  Time  : 16:07:39
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPOCRCPL1IF  E           K        DISK
      * RTV : Yld Daily Dept Header     Retrieval index
      *
     FPOC0CPL1IF  E           K        DISK
      * RTV : Yld Daily Line Yld Comp   Retrieval index
      *
     FPOCZREL1IF  E           K        DISK
      * RTV : Yld Prod Line Component   Retrieval index
      *
     FPMAQREL1IF  E           K        DISK
      * RTV : Yld Prod Line Comp Sel    Retrieval index
      *
     FPOCTCPL1IF  E           K        DISK
      * RTV : Yld Daily Prod Summary    Retrieval index
      *
     FPOCTCPL4IF  E           K        DISK
      * RSQ : Yld Daily Prod Summary    Co/Dp/Ln/Dt/Shf/Str
      *
     FPOC0CPL2IF  E           K        DISK
      * RSQ : Yld Daily Line Yld Comp   Co/Dpt/Dte/Shf/Line
      *
     FPOCSCPL1IF  E           K        DISK
      * RTV : Yld Daily Line Header     Retrieval index
      *
     FPPAGCPL2IF  E           K        DISK
      * RSQ : Productn Ln Yld Comp Std  Co/Dept/Line/Comp/Dt(d)
      *
     FPOC2CPL4IF  E           K        DISK
      * RSQ : Production Line Std Yld   Co/Dept/Line/Dte(d)
      *
     FPOCPCPL1IF  E           K        DISK
      * RTV : Yld Detail Transaction    Retrieval index
      *
     FPDIOREL5IF  E           K        DISK
      * RTV : Item Bill Of Material     Type = Consumed/Produced
      *
     FPOCOCPL1IF  E           K        DISK
      * RTV : Yld Inventory Balance     Retrieval index
      *
     FPOCSCPL5IF  E           K        DISK
      * RSQ : Yld Daily Line Header     Co/Dept/Dt/Shft/Line
      *
     FPOC2CPL3IF  E           K        DISK
      * RSQ : Production Line Std Yld   Co/Dept/Dte(d)/Line
      *
     FPOCYREL2IF  E           K        DISK
      * RSQ : Yld Component             Co/EntDpt/EntLn/Comp
      *
     FPOCZREL2IF  E           K        DISK
      * RSQ : Yld Prod Line Component   Co/Comp/Dept/Line
      *
     FPOCSCPL0UF  E           K        DISK                      A
      * UPD : Yld Daily Line Header     Update index
      *
     FPOC0CPL0UF  E           K        DISK                      A
      * UPD : Yld Daily Line Yld Comp   Update index
      *
     FPOCRCPL0UF  E           K        DISK
      * UPD : Yld Daily Dept Header     Update index
      *
      * Long constants
     E                    @CN#    1  28  6   @CN    25
     I@CRCPQG
      * Yld Daily Dept Header     Retrieval index
      * Renamed input format fields
     I              CRAIC3                          WAAIC3
     I              CRR3CD                          WAR3CD
     I              CRELDT                          WAELDT
     I              CRN3SX                          WAN3SX
     I              CRT7NX                          WAT7NX
     I              CRJ1WG                          WAJ1WG
     I              CRJ2WG                          WAJ2WG
     I              CRJ3WG                          WAJ3WG
     I              CRFJPC                          WAFJPC
     I              CRFKPC                          WAFKPC
     I              CRFNPC                          WAFNPC
     I              CRKNWG                          WAKNWG
     I              CROJSX                          WAOJSX
     I              CRUVST                          WAUVST
     I              CRUWST                          WAUWST
     I              CRUXST                          WAUXST
     I              CRVSST                          WAVSST
     I              CRAATM                          WAAATM
     I              CRAYNA                          WAAYNA
     I              CRA0NA                          WAA0NA
     I              CRAXDT                          WAAXDT
      *
     I@C0CPRL
      * Yld Daily Line Yld Comp   Retrieval index
      * Renamed input format fields
     I              C0AIC3                          WBAIC3
     I              C0R3CD                          WBR3CD
     I              C0EWAA                          WBEWAA
     I              C0ELDT                          WBELDT
     I              C0N3SX                          WBN3SX
     I              C0E4AA                          WBE4AA
     I              C0KKWG                          WBKKWG
     I              C0FMPC                          WBFMPC
     I              C0FOPC                          WBFOPC
     I              C0L2WG                          WBL2WG
     I              C0RISX                          WBRISX
     I              C0RJSX                          WBRJSX
     I              C0RKSX                          WBRKSX
     I              C0UVST                          WBUVST
     I              C0UWST                          WBUWST
     I              C0UXST                          WBUXST
     I              C0VSST                          WBVSST
     I              C0AATM                          WBAATM
     I              C0AYNA                          WBAYNA
     I              C0A0NA                          WBA0NA
     I              C0AXDT                          WBAXDT
      *
     I@CZRERI
      * Yld Prod Line Component   Retrieval index
      * Renamed input format fields
     I              CZAIC3                          WCAIC3
     I              CZR3CD                          WCR3CD
     I              CZEWAA                          WCEWAA
     I              CZE4AA                          WCE4AA
     I              CZO6SX                          WCO6SX
     I              CZFLPC                          WCFLPC
     I              CZQDNA                          WCQDNA
     I              CZPCSX                          WCPCSX
     I              CZO8SX                          WCO8SX
     I              CZRGNB                          WCRGNB
     I              CZO9SX                          WCO9SX
     I              CZRHNB                          WCRHNB
     I              CZPASX                          WCPASX
     I              CZRINB                          WCRINB
     I              CZPDSX                          WCPDSX
     I              CZPESX                          WCPESX
     I              CZPFSX                          WCPFSX
     I              CZPGSX                          WCPGSX
     I              CZUVST                          WCUVST
     I              CZUWST                          WCUWST
     I              CZUXST                          WCUXST
     I              CZVSST                          WCVSST
     I              CZAATM                          WCAATM
     I              CZAYNA                          WCAYNA
     I              CZA0NA                          WCA0NA
     I              CZAXDT                          WCAXDT
      *
     I@AQREJX
      * Yld Prod Line Comp Sel    Retrieval index
      * Renamed input format fields
     I              AQAIC3                          WDAIC3
     I              AQR3CD                          WDR3CD
     I              AQEWAA                          WDEWAA
     I              AQE4AA                          WDE4AA
     I              AQGSNY                          WDGSNY
     I              AQO8SX                          WDO8SX
     I              AQRGNB                          WDRGNB
     I              AQO9SX                          WDO9SX
     I              AQRHNB                          WDRHNB
     I              AQPASX                          WDPASX
     I              AQRINB                          WDRINB
     I              AQUVST                          WDUVST
     I              AQUWST                          WDUWST
     I              AQUXST                          WDUXST
     I              AQVSST                          WDVSST
     I              AQAATM                          WDAATM
     I              AQAYNA                          WDAYNA
     I              AQA0NA                          WDA0NA
     I              AQAXDT                          WDAXDT
      *
     I@CTCPQM
      * Yld Daily Prod Summary    Retrieval index
      * Renamed input format fields
     I              CTAIC3                          WEAIC3
     I              CTR3CD                          WER3CD
     I              CTEWAA                          WEEWAA
     I              CTELDT                          WEELDT
     I              CTN3SX                          WEN3SX
     I              CTHGCD                          WEHGCD
     I              CTN0CD                          WEN0CD
     I              CTCMNB                          WECMNB
     I              CTVMST                          WEVMST
     I              CTRGNB                          WERGNB
     I              CTRHNB                          WERHNB
     I              CTRINB                          WERINB
     I              CTT8NX                          WET8NX
     I              CTJ7WG                          WEJ7WG
     I              CTT9NX                          WET9NX
     I              CTJ8WG                          WEJ8WG
     I              CTUANX                          WEUANX
     I              CTJ9WG                          WEJ9WG
     I              CTUBNX                          WEUBNX
     I              CTKAWG                          WEKAWG
     I              CTCXT1                          WECXT1
     I              CTOLSX                          WEOLSX
     I              CTUVST                          WEUVST
     I              CTUWST                          WEUWST
     I              CTUXST                          WEUXST
     I              CTVSST                          WEVSST
     I              CTAATM                          WEAATM
     I              CTAYNA                          WEAYNA
     I              CTA0NA                          WEA0NA
     I              CTAXDT                          WEAXDT
      *
     I@CTCPR9
      * Yld Daily Prod Summary    Co/Dp/Ln/Dt/Shf/Str
      * Renamed input format fields
     I              CTAIC3                          WFAIC3
     I              CTR3CD                          WFR3CD
     I              CTEWAA                          WFEWAA
     I              CTELDT                          WFELDT
     I              CTN3SX                          WFN3SX
     I              CTHGCD                          WFHGCD
     I              CTN0CD                          WFN0CD
     I              CTCMNB                          WFCMNB
     I              CTVMST                          WFVMST
     I              CTRGNB                          WFRGNB
     I              CTRHNB                          WFRHNB
     I              CTRINB                          WFRINB
     I              CTT8NX                          WFT8NX
     I              CTJ7WG                          WFJ7WG
     I              CTT9NX                          WFT9NX
     I              CTJ8WG                          WFJ8WG
     I              CTUANX                          WFUANX
     I              CTJ9WG                          WFJ9WG
     I              CTUBNX                          WFUBNX
     I              CTKAWG                          WFKAWG
     I              CTCXT1                          WFCXT1
     I              CTOLSX                          WFOLSX
     I              CTUVST                          WFUVST
     I              CTUWST                          WFUWST
     I              CTUXST                          WFUXST
     I              CTVSST                          WFVSST
     I              CTAATM                          WFAATM
     I              CTAYNA                          WFAYNA
     I              CTA0NA                          WFA0NA
     I              CTAXDT                          WFAXDT
      *
     I@C0CPRT
      * Yld Daily Line Yld Comp   Co/Dpt/Dte/Shf/Line
      * Renamed input format fields
     I              C0AIC3                          WGAIC3
     I              C0R3CD                          WGR3CD
     I              C0EWAA                          WGEWAA
     I              C0ELDT                          WGELDT
     I              C0N3SX                          WGN3SX
     I              C0E4AA                          WGE4AA
     I              C0KKWG                          WGKKWG
     I              C0FMPC                          WGFMPC
     I              C0FOPC                          WGFOPC
     I              C0L2WG                          WGL2WG
     I              C0RISX                          WGRISX
     I              C0RJSX                          WGRJSX
     I              C0RKSX                          WGRKSX
     I              C0UVST                          WGUVST
     I              C0UWST                          WGUWST
     I              C0UXST                          WGUXST
     I              C0VSST                          WGVSST
     I              C0AATM                          WGAATM
     I              C0AYNA                          WGAYNA
     I              C0A0NA                          WGA0NA
     I              C0AXDT                          WGAXDT
      *
     I@CSCPQJ
      * Yld Daily Line Header     Retrieval index
      * Renamed input format fields
     I              CSAIC3                          WHAIC3
     I              CSR3CD                          WHR3CD
     I              CSEWAA                          WHEWAA
     I              CSELDT                          WHELDT
     I              CSN3SX                          WHN3SX
     I              CSJ3WG                          WHJ3WG
     I              CSW6NX                          WHW6NX
     I              CSJ6WG                          WHJ6WG
     I              CSJ4WG                          WHJ4WG
     I              CSJ5WG                          WHJ5WG
     I              CSF4PC                          WHF4PC
     I              CSKOWG                          WHKOWG
     I              CSFJPC                          WHFJPC
     I              CSFKPC                          WHFKPC
     I              CSFNPC                          WHFNPC
     I              CSKNWG                          WHKNWG
     I              CSCWT1                          WHCWT1
     I              CSOKSX                          WHOKSX
     I              CSONSX                          WHONSX
     I              CSXCNX                          WHXCNX
     I              CSMEWG                          WHMEWG
     I              CSMFWG                          WHMFWG
     I              CSW9NX                          WHW9NX
     I              CSXANX                          WHXANX
     I              CSXBNX                          WHXBNX
     I              CSMGWG                          WHMGWG
     I              CSMHWG                          WHMHWG
     I              CSUVST                          WHUVST
     I              CSUWST                          WHUWST
     I              CSUXST                          WHUXST
     I              CSVSST                          WHVSST
     I              CSAATM                          WHAATM
     I              CSAYNA                          WHAYNA
     I              CSA0NA                          WHA0NA
     I              CSAXDT                          WHAXDT
      *
     I@CSCPQI
      * Yld Daily Line Header     Update index
      * Renamed input format fields
     I              CSAIC3                          WIAIC3
     I              CSR3CD                          WIR3CD
     I              CSEWAA                          WIEWAA
     I              CSELDT                          WIELDT
     I              CSN3SX                          WIN3SX
     I              CSJ3WG                          WIJ3WG
     I              CSW6NX                          WIW6NX
     I              CSJ6WG                          WIJ6WG
     I              CSJ4WG                          WIJ4WG
     I              CSJ5WG                          WIJ5WG
     I              CSF4PC                          WIF4PC
     I              CSKOWG                          WIKOWG
     I              CSFJPC                          WIFJPC
     I              CSFKPC                          WIFKPC
     I              CSFNPC                          WIFNPC
     I              CSKNWG                          WIKNWG
     I              CSCWT1                          WICWT1
     I              CSOKSX                          WIOKSX
     I              CSONSX                          WIONSX
     I              CSXCNX                          WIXCNX
     I              CSMEWG                          WIMEWG
     I              CSMFWG                          WIMFWG
     I              CSW9NX                          WIW9NX
     I              CSXANX                          WIXANX
     I              CSXBNX                          WIXBNX
     I              CSMGWG                          WIMGWG
     I              CSMHWG                          WIMHWG
     I              CSUVST                          WIUVST
     I              CSUWST                          WIUWST
     I              CSUXST                          WIUXST
     I              CSVSST                          WIVSST
     I              CSAATM                          WIAATM
     I              CSAYNA                          WIAYNA
     I              CSA0NA                          WIA0NA
     I              CSAXDT                          WIAXDT
      *
     I@C0CPRK
      * Yld Daily Line Yld Comp   Update index
      * Renamed input format fields
     I              C0AIC3                          WJAIC3
     I              C0R3CD                          WJR3CD
     I              C0EWAA                          WJEWAA
     I              C0ELDT                          WJELDT
     I              C0N3SX                          WJN3SX
     I              C0E4AA                          WJE4AA
     I              C0KKWG                          WJKKWG
     I              C0FMPC                          WJFMPC
     I              C0FOPC                          WJFOPC
     I              C0L2WG                          WJL2WG
     I              C0RISX                          WJRISX
     I              C0RJSX                          WJRJSX
     I              C0RKSX                          WJRKSX
     I              C0UVST                          WJUVST
     I              C0UWST                          WJUWST
     I              C0UXST                          WJUXST
     I              C0VSST                          WJVSST
     I              C0AATM                          WJAATM
     I              C0AYNA                          WJAYNA
     I              C0A0NA                          WJA0NA
     I              C0AXDT                          WJAXDT
      *
     I@AGCPUJ
      * Productn Ln Yld Comp Std  Co/Dept/Line/Comp/Dt(d)
      * Renamed input format fields
     I              AGAIC3                          WKAIC3
     I              AGR3CD                          WKR3CD
     I              AGEWAA                          WKEWAA
     I              AGE4AA                          WKE4AA
     I              AGPXDT                          WKPXDT
     I              AGFPPC                          WKFPPC
     I              AGUVST                          WKUVST
     I              AGUWST                          WKUWST
     I              AGUXST                          WKUXST
     I              AGVSST                          WKVSST
     I              AGAATM                          WKAATM
     I              AGAYNA                          WKAYNA
     I              AGA0NA                          WKA0NA
     I              AGAXDT                          WKAXDT
      *
     I@C2CPR1
      * Production Line Std Yld   Co/Dept/Line/Dte(d)
      * Renamed input format fields
     I              C2AIC3                          WLAIC3
     I              C2R3CD                          WLR3CD
     I              C2EWAA                          WLEWAA
     I              C2AUDT                          WLAUDT
     I              C2FJPC                          WLFJPC
     I              C2UVST                          WLUVST
     I              C2UWST                          WLUWST
     I              C2UXST                          WLUXST
     I              C2VSST                          WLVSST
     I              C2AATM                          WLAATM
     I              C2AYNA                          WLAYNA
     I              C2A0NA                          WLA0NA
     I              C2AXDT                          WLAXDT
      *
     I@CPCPPX
      * Yld Detail Transaction    Retrieval index
      * Renamed input format fields
     I              CPAIC3                          WMAIC3
     I              CPR3CD                          WMR3CD
     I              CPEWAA                          WMEWAA
     I              CPELDT                          WMELDT
     I              CPN3SX                          WMN3SX
     I              CPHGCD                          WMHGCD
     I              CPCMNB                          WMCMNB
     I              CPN5SX                          WMN5SX
     I              CPTZNX                          WMTZNX
     I              CPT0NX                          WMT0NX
     I              CPJSWG                          WMJSWG
     I              CPXDNX                          WMXDNX
     I              CPCVT1                          WMCVT1
     I              CPN6SX                          WMN6SX
     I              CPN0CD                          WMN0CD
     I              CPVMST                          WMVMST
     I              CPOASX                          WMOASX
     I              CPRGNB                          WMRGNB
     I              CPRHNB                          WMRHNB
     I              CPRINB                          WMRINB
     I              CPUVST                          WMUVST
     I              CPUWST                          WMUWST
     I              CPUXST                          WMUXST
     I              CPVSST                          WMVSST
     I              CPAATM                          WMAATM
     I              CPAYNA                          WMAYNA
     I              CPA0NA                          WMA0NA
     I              CPAXDT                          WMAXDT
      *
     I@IOREBP
      * Item Bill Of Material     Type = Consumed/Produced
      * Renamed input format fields
     I              IOAIC3                          WOAIC3
     I              IOHGCD                          WOHGCD
     I              IOC9NB                          WOC9NB
     I              IOV2ST                          WOV2ST
     I              IOBOPR                          WOBOPR
     I              IOBPPR                          WOBPPR
     I              IOHGQT                          WOHGQT
     I              IOHHCD                          WOHHCD
     I              IOYAST                          WOYAST
     I              IOCNSM                          WOCNSM
     I              IOBMY1                          WOBMY1
     I              IOBMY2                          WOBMY2
     I              IOIXQT                          WOIXQT
     I              IOIYQT                          WOIYQT
     I              IORSST                          WORSST
     I              IORTST                          WORTST
     I              IOUVST                          WOUVST
     I              IOUWST                          WOUWST
     I              IOUXST                          WOUXST
     I              IOVSST                          WOVSST
     I              IOAATM                          WOAATM
     I              IOAYNA                          WOAYNA
     I              IOA0NA                          WOA0NA
     I              IOAXDT                          WOAXDT
      *
     I@COCPQA
      * Yld Inventory Balance     Retrieval index
      * Renamed input format fields
     I              COAIC3                          WRAIC3
     I              COR3CD                          WRR3CD
     I              COEWAA                          WREWAA
     I              COELDT                          WRELDT
     I              CON3SX                          WRN3SX
     I              COHGCD                          WRHGCD
     I              COCMNB                          WRCMNB
     I              COOISX                          WROISX
     I              COBPC3                          WRBPC3
     I              COE1AA                          WRE1AA
     I              COE0AA                          WRE0AA
     I              COT1NX                          WRT1NX
     I              COJVWG                          WRJVWG
     I              COT2NX                          WRT2NX
     I              COJWWG                          WRJWWG
     I              COT3NX                          WRT3NX
     I              COJXWG                          WRJXWG
     I              COT4NX                          WRT4NX
     I              COJYWG                          WRJYWG
     I              COT5NX                          WRT5NX
     I              COJZWG                          WRJZWG
     I              COT6NX                          WRT6NX
     I              COJ0WG                          WRJ0WG
     I              COP8NA                          WRP8NA
     I              COOHSX                          WROHSX
     I              COVMST                          WRVMST
     I              CORGNB                          WRRGNB
     I              CORHNB                          WRRHNB
     I              CORINB                          WRRINB
     I              COUVST                          WRUVST
     I              COUWST                          WRUWST
     I              COUXST                          WRUXST
     I              COVSST                          WRVSST
     I              COAATM                          WRAATM
     I              COAYNA                          WRAYNA
     I              COA0NA                          WRA0NA
     I              COAXDT                          WRAXDT
      *
     I@CSCPRV
      * Yld Daily Line Header     Co/Dept/Dt/Shft/Line
      * Renamed input format fields
     I              CSAIC3                          WSAIC3
     I              CSR3CD                          WSR3CD
     I              CSEWAA                          WSEWAA
     I              CSELDT                          WSELDT
     I              CSN3SX                          WSN3SX
     I              CSJ3WG                          WSJ3WG
     I              CSW6NX                          WSW6NX
     I              CSJ6WG                          WSJ6WG
     I              CSJ4WG                          WSJ4WG
     I              CSJ5WG                          WSJ5WG
     I              CSF4PC                          WSF4PC
     I              CSKOWG                          WSKOWG
     I              CSFJPC                          WSFJPC
     I              CSFKPC                          WSFKPC
     I              CSFNPC                          WSFNPC
     I              CSKNWG                          WSKNWG
     I              CSCWT1                          WSCWT1
     I              CSOKSX                          WSOKSX
     I              CSONSX                          WSONSX
     I              CSXCNX                          WSXCNX
     I              CSMEWG                          WSMEWG
     I              CSMFWG                          WSMFWG
     I              CSW9NX                          WSW9NX
     I              CSXANX                          WSXANX
     I              CSXBNX                          WSXBNX
     I              CSMGWG                          WSMGWG
     I              CSMHWG                          WSMHWG
     I              CSUVST                          WSUVST
     I              CSUWST                          WSUWST
     I              CSUXST                          WSUXST
     I              CSVSST                          WSVSST
     I              CSAATM                          WSAATM
     I              CSAYNA                          WSAYNA
     I              CSA0NA                          WSA0NA
     I              CSAXDT                          WSAXDT
      *
     I@C2CPR0
      * Production Line Std Yld   Co/Dept/Dte(d)/Line
      * Renamed input format fields
     I              C2AIC3                          WTAIC3
     I              C2R3CD                          WTR3CD
     I              C2EWAA                          WTEWAA
     I              C2AUDT                          WTAUDT
     I              C2FJPC                          WTFJPC
     I              C2UVST                          WTUVST
     I              C2UWST                          WTUWST
     I              C2UXST                          WTUXST
     I              C2VSST                          WTVSST
     I              C2AATM                          WTAATM
     I              C2AYNA                          WTAYNA
     I              C2A0NA                          WTA0NA
     I              C2AXDT                          WTAXDT
      *
     I@CRCPQF
      * Yld Daily Dept Header     Update index
      * Renamed input format fields
     I              CRAIC3                          WVAIC3
     I              CRR3CD                          WVR3CD
     I              CRELDT                          WVELDT
     I              CRN3SX                          WVN3SX
     I              CRT7NX                          WVT7NX
     I              CRJ1WG                          WVJ1WG
     I              CRJ2WG                          WVJ2WG
     I              CRJ3WG                          WVJ3WG
     I              CRFJPC                          WVFJPC
     I              CRFKPC                          WVFKPC
     I              CRFNPC                          WVFNPC
     I              CRKNWG                          WVKNWG
     I              CROJSX                          WVOJSX
     I              CRUVST                          WVUVST
     I              CRUWST                          WVUWST
     I              CRUXST                          WVUXST
     I              CRVSST                          WVVSST
     I              CRAATM                          WVAATM
     I              CRAYNA                          WVAYNA
     I              CRA0NA                          WVA0NA
     I              CRAXDT                          WVAXDT
      *
     I@CYRERM
      * Yld Component             Co/EntDpt/EntLn/Comp
      * Renamed input format fields
     I              CYAIC3                          WWAIC3
     I              CYE4AA                          WWE4AA
     I              CYQCNA                          WWQCNA
     I              CYE5AA                          WWE5AA
     I              CYE6AA                          WWE6AA
     I              CYUVST                          WWUVST
     I              CYUWST                          WWUWST
     I              CYUXST                          WWUXST
     I              CYVSST                          WWVSST
     I              CYAATM                          WWAATM
     I              CYAYNA                          WWAYNA
     I              CYA0NA                          WWA0NA
     I              CYAXDT                          WWAXDT
      *
     I@CZRERN
      * Yld Prod Line Component   Co/Comp/Dept/Line
      * Renamed input format fields
     I              CZAIC3                          WXAIC3
     I              CZR3CD                          WXR3CD
     I              CZEWAA                          WXEWAA
     I              CZE4AA                          WXE4AA
     I              CZO6SX                          WXO6SX
     I              CZFLPC                          WXFLPC
     I              CZQDNA                          WXQDNA
     I              CZPCSX                          WXPCSX
     I              CZO8SX                          WXO8SX
     I              CZRGNB                          WXRGNB
     I              CZO9SX                          WXO9SX
     I              CZRHNB                          WXRHNB
     I              CZPASX                          WXPASX
     I              CZRINB                          WXRINB
     I              CZPDSX                          WXPDSX
     I              CZPESX                          WXPESX
     I              CZPFSX                          WXPFSX
     I              CZPGSX                          WXPGSX
     I              CZUVST                          WXUVST
     I              CZUWST                          WXUWST
     I              CZUXST                          WXUXST
     I              CZVSST                          WXVSST
     I              CZAATM                          WXAATM
     I              CZAYNA                          WXAYNA
     I              CZA0NA                          WXA0NA
     I              CZAXDT                          WXAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPOCS1    E DSPOCSCPL0
      * UPD : Yld Daily Line Header     Update index
      * Renamed input format fields
     I              CSAIC3                          WIAIC3
     I              CSR3CD                          WIR3CD
     I              CSEWAA                          WIEWAA
     I              CSELDT                          WIELDT
     I              CSN3SX                          WIN3SX
     I              CSJ3WG                          WIJ3WG
     I              CSW6NX                          WIW6NX
     I              CSJ6WG                          WIJ6WG
     I              CSJ4WG                          WIJ4WG
     I              CSJ5WG                          WIJ5WG
     I              CSF4PC                          WIF4PC
     I              CSKOWG                          WIKOWG
     I              CSFJPC                          WIFJPC
     I              CSFKPC                          WIFKPC
     I              CSFNPC                          WIFNPC
     I              CSKNWG                          WIKNWG
     I              CSCWT1                          WICWT1
     I              CSOKSX                          WIOKSX
     I              CSONSX                          WIONSX
     I              CSXCNX                          WIXCNX
     I              CSMEWG                          WIMEWG
     I              CSMFWG                          WIMFWG
     I              CSW9NX                          WIW9NX
     I              CSXANX                          WIXANX
     I              CSXBNX                          WIXBNX
     I              CSMGWG                          WIMGWG
     I              CSMHWG                          WIMHWG
     I              CSUVST                          WIUVST
     I              CSUWST                          WIUWST
     I              CSUXST                          WIUXST
     I              CSVSST                          WIVSST
     I              CSAATM                          WIAATM
     I              CSAYNA                          WIAYNA
     I              CSA0NA                          WIA0NA
     I              CSAXDT                          WIAXDT
      *
     IYARDCS      DS                            182
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPOC01    E DSPOC0CPL0
      * UPD : Yld Daily Line Yld Comp   Update index
      * Renamed input format fields
     I              C0AIC3                          WJAIC3
     I              C0R3CD                          WJR3CD
     I              C0EWAA                          WJEWAA
     I              C0ELDT                          WJELDT
     I              C0N3SX                          WJN3SX
     I              C0E4AA                          WJE4AA
     I              C0KKWG                          WJKKWG
     I              C0FMPC                          WJFMPC
     I              C0FOPC                          WJFOPC
     I              C0L2WG                          WJL2WG
     I              C0RISX                          WJRISX
     I              C0RJSX                          WJRJSX
     I              C0RKSX                          WJRKSX
     I              C0UVST                          WJUVST
     I              C0UWST                          WJUWST
     I              C0UXST                          WJUXST
     I              C0VSST                          WJVSST
     I              C0AATM                          WJAATM
     I              C0AYNA                          WJAYNA
     I              C0A0NA                          WJA0NA
     I              C0AXDT                          WJAXDT
      *
     IYBRDCS      DS                             82
     IYCRDCS      DS                             82
     IYDRDCS      DS                            182
     IQPOCR1    E DSPOCRCPL0
      * UPD : Yld Daily Dept Header     Update index
      * Renamed input format fields
     I              CRAIC3                          WVAIC3
     I              CRR3CD                          WVR3CD
     I              CRELDT                          WVELDT
     I              CRN3SX                          WVN3SX
     I              CRT7NX                          WVT7NX
     I              CRJ1WG                          WVJ1WG
     I              CRJ2WG                          WVJ2WG
     I              CRJ3WG                          WVJ3WG
     I              CRFJPC                          WVFJPC
     I              CRFKPC                          WVFKPC
     I              CRFNPC                          WVFNPC
     I              CRKNWG                          WVKNWG
     I              CROJSX                          WVOJSX
     I              CRUVST                          WVUVST
     I              CRUWST                          WVUWST
     I              CRUXST                          WVUXST
     I              CRVSST                          WVVSST
     I              CRAATM                          WVAATM
     I              CRAYNA                          WVAYNA
     I              CRA0NA                          WVA0NA
     I              CRAXDT                          WVAXDT
      *
     IYERDCS      DS                             79
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Yld Daily Prod Summary
      * I :  Company Number
     I                                    P   1   20P1AIC3
      * I :  Department Code
     I                                        3   8 P1R3CD
      * I :  Production Line Code
     I                                        9  14 P1EWAA
      * I :  Production Date
     I                                    P  15  180P1ELDT
      * I :  Production Shift
     I                                       19  19 P1N3SX
     IP2PARM      DS
      * FLD: Yld Daily Dept Header
      * N :  Head Cut
     I                                    P   1   30P2T7NX
      * N :  Cold Weight
     I                                    P   4   92P2J1WG
      * N :  Avg Cold Weight
     I                                    P  10  122P2J2WG
     IP3PARM      DS
      * FLD: Yld Daily Line Header
      * N :  Total Line Weight
     I                                    P   1   62P3KOWG
      * N :  Production Standard Yld%
     I                                    P   7   92P3FJPC
      * N :  Actual Yield
     I                                    P  10  122P3FKPC
      * N :  Yield Variance
     I                                    P  13  152P3FNPC
      * N :  Weight Variance
     I                                    P  16  212P3KNWG
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1R3CD    PARM           WP0002  6        Department Code
     C           P1EWAA    PARM           WP0003  6        Production Line
     C           P1ELDT    PARM           WP0004  70       Production Date
     C           P1N3SX    PARM           WP0005  1        Production Shif
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Calc Actual Yld   XF
      * Rtv Head Cut/Cold Wgt RT - Yld Daily Dept Header  * 
     C                     EXSR SARVGN
      * Exc Calc Comp Wgts    RT - Yld Daily Line Yld Comp  * 
     C                     EXSR SBRVGN
      * Calc Prod Std Yield %
      * CASE: PAR.Department Code is CUT
     C           P1R3CD    IFEQ 'CUT'                      *IF
      * Actual Yield
      * CASE: PAR.Cold Weight is Greater than zero
     C           P2J1WG    IFGT *ZERO                      *IF
      * Actual Yield
      * PAR.Actual Yield =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.Total Line Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.Cold Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           P3KOWG    DIV  P2J1WG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3FKPC           Actual Yield
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     P3FKPC           Actual Yield
     C                     END                             *FI
      * Rtv Line Std Yield    RT - Production Line Std Yld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0085           Company Number
     C                     MOVELP1R3CD    WL0086    P      Department Code
     C                     MOVELP1EWAA    WL0087    P      Production Line
     C                     Z-ADDP1ELDT    WL0088           Effective Date
     C                     Z-ADDP3FJPC    WL0089           Production Stan
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    P3FJPC           Production Stan
      * CASE: PAR.Total Line Weight is Greater than zero
     C           P3KOWG    IFGT *ZERO                      *IF
      * Exc Calc Mix Pct      RT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0090           Company Number
     C                     MOVELP1R3CD    WL0091    P      Department Code
     C                     MOVELP1EWAA    WL0092    P      Production Line
     C                     Z-ADDP1ELDT    WL0093           Production Date
     C                     MOVELP1N3SX    WL0094    P      Production Shif
     C                     Z-ADDP3KOWG    WL0095           Total Line Weig
     C                     EXSR SQRVGN
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.Department Code is Belly
      *   |- c2    : PAR.Department Code is Loin Boning
      *   '-
     C           P1R3CD    IFEQ 'BELLY'                    *IF
     C           P1R3CD    OREQ 'LOINS'                    *OR
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0050           Company Number
     C                     MOVELP1R3CD    WL0051    P      Department Code
     C                     MOVELP1EWAA    WL0052    P      Production Line
     C                     Z-ADDP1ELDT    WL0053           Production Date
     C                     MOVELP1N3SX    WL0054    P      Production Shif
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    YL0035           Start Weight
      * Belly & loins use start weight whereas CUT uses Cold Weight
      * CASE: LCL.Start Weight is Greater than zero
     C           YL0035    IFGT *ZERO                      *IF
      * Exc Calc Mix Pct      RT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0090           Company Number
     C                     MOVELP1R3CD    WL0091    P      Department Code
     C                     MOVELP1EWAA    WL0092    P      Production Line
     C                     Z-ADDP1ELDT    WL0093           Production Date
     C                     MOVELP1N3SX    WL0094    P      Production Shif
     C                     Z-ADDYL0035    WL0095           Total Line Weig
     C                     EXSR SQRVGN
     C                     END                             *FI
      * CASE: PAR.Department Code is Belly
     C           P1R3CD    IFEQ 'BELLY'                    *IF
      * Rtv Finished Mix %    RT - Yld Daily Line Yld Comp  * 
     C                     EXSR TARVGN
     C                     ELSE
      * CASE: PAR.Department Code is Loin Boning
     C           P1R3CD    IFEQ 'LOINS'                    *IF
      * Rtv Bnls Loin Mix %  RT - Yld Daily Line Yld Comp  * 
     C                     EXSR TBRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           P3FKPC    SUB  P3FJPC    P3FNPC           Yield Variance
      * CASE: PAR.Department Code is CUT
     C           P1R3CD    IFEQ 'CUT'                      *IF
      * Weight Variance
      * PAR.Weight Variance =
      *    *COMPUTE (x1 - (x2 * (x3 / x4)))
      * x1    : PAR.Total Line Weight
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.Cold Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Production Standard Yld%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           P3FJPC    DIV  100       W0WB02    H      *Synon (15,5) w
     C           P2J1WG    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           P3KOWG    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    P3KNWG           Weight Variance
     C                     ELSE
      * CASE: PAR.Department Code is Belly
     C           P1R3CD    IFEQ 'BELLY'                    *IF
      * Weight Variance
      * PAR.Weight Variance =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : LCL.Start Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Yield Variance
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P3FNPC    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0035    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3KNWG           Weight Variance
     C                     ELSE
      * CASE: PAR.Department Code is Loin Boning
     C           P1R3CD    IFEQ 'LOINS'                    *IF
      * Weight Variance
      * PAR.Weight Variance =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : LCL.Start Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Yield Variance
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           P3FNPC    DIV  100       W0WD01           *Synon (17,7) w
     C           YL0035    MULT W0WD01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3KNWG           Weight Variance
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Chg Actual Yld    RT - Yld Daily Line Header  * 
     C                     EXSR TCRVGN
      * CASE: PAR.Department Code is CUT
     C           P1R3CD    IFEQ 'CUT'                      *IF
      * Exc Calc Dept Yield   RT - Yld Daily Line Header  * 
     C                     EXSR TERVGN
     C                     END                             *FI
      * Upd Start Wt for Single Rib, Sheet Belly for CUT dept
      * CASE: PAR.Department Code is Belly
     C           P1R3CD    IFEQ 'BELLY'                    *IF
      * Rtv Upd Comp Start Wt RT - Yld Component  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0168           Company Number
     C                     MOVELP1R3CD    WL0169    P      Entry Departmen
     C                     MOVELP1EWAA    WL0170    P      Entry Prod Line
     C                     Z-ADDP1ELDT    WL0171           Production Date
     C                     MOVELP1N3SX    WL0172    P      Production Shif
     C                     Z-ADDYL0035    WL0173           Start Weight
     C                     EXSR TIRVGN
     C                     END                             *FI
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Head Cut/Cold Wgt RT - Yld Daily Dept Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAR3CD           Department Code
     C                     KFLD           WAELDT           Production Date
     C                     KFLD           WAN3SX           Production Shif
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVELP1R3CD    WAR3CD           Department Code
     C                     Z-ADDP1ELDT    WAELDT           Production Date
     C                     MOVELP1N3SX    WAN3SX           Production Shif
      * Establish starting position
     C           KRSSA     CHAIN@CRCPQG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3221' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     P2T7NX           Head Cut
     C                     Z-ADD*ZERO     P2J1WG           Cold Weight
     C                     Z-ADD*ZERO     P2J2WG           Avg Cold Weight
     C                     Z-ADD*ZERO     WUJ3WG           Start Weight
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAT7NX    P2T7NX           Head Cut
     C                     Z-ADDWAJ1WG    P2J1WG           Cold Weight
     C                     Z-ADDWAJ2WG    P2J2WG           Avg Cold Weight
     C                     Z-ADDWAJ3WG    WUJ3WG           Start Weight
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Exc Calc Comp Wgts    RT - Yld Daily Line Yld Comp  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0001  2        PLYC Type
     C                     Z-ADD*ZERO     WN0002  52       PLYC Percent of
     C                     MOVEL*BLANK    WN0003 30        PLYC Comment
     C                     MOVEL*BLANK    WN0004  1        Credit Item Inc
     C                     MOVEL*BLANK    WN0005  1        Type Inc/Exc St
     C                     Z-ADD*ZERO     WN0006  30       Item Structure
     C                     MOVEL*BLANK    WN0007  1        Group Inc/Exc S
     C                     Z-ADD*ZERO     WN0008  30       Item Structure
     C                     MOVEL*BLANK    WN0009  1        Class Inc/Exc S
     C                     Z-ADD*ZERO     WN0010  30       Item Structure
     C                     MOVEL*BLANK    WN0011  1        YC Component Gr
     C                     Z-ADD*ZERO     WN0012 112       Wgt Component U
     C                     Z-ADD*ZERO     WN0013 112       Start Weight
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     P3KOWG           Wgt Produced US
     C                     MOVEL*BLANK    WN0001           PLYC Type
     C                     Z-ADD*ZERO     WN0002           PLYC Percent of
     C                     MOVEL*BLANK    WN0003           PLYC Comment
     C                     MOVEL*BLANK    WN0004           Credit Item Inc
     C                     MOVEL*BLANK    WN0005           Type Inc/Exc St
     C                     Z-ADD*ZERO     WN0006           Item Structure
     C                     MOVEL*BLANK    WN0007           Group Inc/Exc S
     C                     Z-ADD*ZERO     WN0008           Item Structure
     C                     MOVEL*BLANK    WN0009           Class Inc/Exc S
     C                     Z-ADD*ZERO     WN0010           Item Structure
     C                     MOVEL*BLANK    WN0011           YC Component Gr
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
     C                     Z-ADD*ZERO     WN0013           Start Weight
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSB01           Company Number
     C           *LIKE     DEFN WBR3CD    WQSB02           Department Code
     C           *LIKE     DEFN WBEWAA    WQSB03           Production Line
     C           *LIKE     DEFN WBELDT    WQSB04           Production Date
     C           *LIKE     DEFN WBN3SX    WQSB05           Production Shif
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Company Number
     C                     KFLD           WQSB02           Department Code
     C                     KFLD           WQSB03           Production Line
     C                     KFLD           WQSB04           Production Date
     C                     KFLD           WQSB05           Production Shif
      * Setup key
     C                     Z-ADDP1AIC3    WQSB01           Company Number
     C                     MOVELP1R3CD    WQSB02           Department Code
     C                     MOVELP1EWAA    WQSB03           Production Line
     C                     Z-ADDP1ELDT    WQSB04           Production Date
     C                     MOVELP1N3SX    WQSB05           Production Shif
      * Establish starting position
     C           KRSSB     SETLL@C0CPRL                    *
     C           KRSSB     READE@C0CPRL                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
      * Rtv Component Info    RT - Production Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVELWBE4AA    WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WN0001    P      PLYC Type
     C                     Z-ADDWL0006    WN0002           PLYC Percent of
     C                     MOVELWL0007    WN0003    P      PLYC Comment
     C                     MOVELWL0008    WN0004    P      Credit Item Inc
     C                     MOVELWL0009    WN0005    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WN0006           Item Structure
     C                     MOVELWL0011    WN0007    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WN0008           Item Structure
     C                     MOVELWL0013    WN0009    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WN0010           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WN0011    P      YC Component Gr
      * CASE:
      *  - c1ORc2
      *   |- c1    : PAR.PLYC Type is Start Weight Entry
      *   |- c2    : PAR.PLYC Type is Auto-calculated
      *   '-
     C           WN0001    IFEQ 'SW'                       *IF
     C           WN0001    OREQ 'AC'                       *OR
     C                     ADD  WBKKWG    P3KOWG           Wgt Produced US
     C                     ELSE
      * CASE: *OTHERWISE
      * 05/02/07 PKD Added Component Type of MS-Retrieve w/Mult Item Str
      * SEL: Item Structure
      * CASE: PAR.PLYC Type is Retrieve w/Mult Item Str
     C           WN0001    IFEQ 'MS'                       *IF
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
      * Rtv Yld Comp Wgt      RT - Yld Prod Line Comp Sel  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE:
      *  - c1ORc2ORc3ORc4
      *   |- c1    : PAR.Credit Item Inc/Exc Sts is Include/Exclude
      *   |- c2    : PAR.Item Structure Type Code is Entered
      *   |- c3    : PAR.Item Structure Group Code is Entered
      *   |- c4    : PAR.Item Structure Class Code is Entered
      *   '-
     C           WN0004    IFEQ 'E'                        *IF
     C           WN0004    OREQ 'I'
     C           WN0006    ORNE *ZERO                      *OR
     C           WN0008    ORNE *ZERO                      *OR
     C           WN0010    ORNE *ZERO                      *OR
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
      * Rtv Yld Comp Wgt      RT - Yld Daily Prod Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0017           Company Number
     C                     MOVELWBR3CD    WL0018    P      Department Code
     C                     MOVELWBEWAA    WL0019    P      Production Line
     C                     Z-ADDWBELDT    WL0020           Production Date
     C                     MOVELWBN3SX    WL0021    P      Production Shif
     C                     MOVELWN0004    WL0022    P      Credit Item Inc
     C                     MOVELWN0005    WL0023    P      Type Inc/Exc St
     C                     Z-ADDWN0006    WL0024           Item Structure
     C                     MOVELWN0007    WL0025    P      Group Inc/Exc S
     C                     Z-ADDWN0008    WL0026           Item Structure
     C                     MOVELWN0009    WL0027    P      Class Inc/Exc S
     C                     Z-ADDWN0010    WL0028           Item Structure
     C                     Z-ADDWN0012    WL0029           Wgt Component U
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
      * Wgt Component for Special Calculation
      * CASE: PAR.PLYC Type is Special Calculation
     C           WN0001    IFEQ 'SC'                       *IF
      * RIB Line
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Department Code is CUT
      *   |- c2    : PAR.Production Line Code is Ribs
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1R3CD    IFEQ 'CUT'                      *IF
     C           P1EWAA    IFEQ 'RIB'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR.Wgt Component USR
      * PAR.Wgt Component USR =
      *    *COMPUTE (x1 - (x2 * x3 * x4))
      * x1    : PAR.Wgt Component USR
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.Head Cut
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.2
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON.0.3
     C           P2T7NX    MULT 2         W0WA02           *Synon (15,2) w
     C           W0WA02    MULT 0.3       W0WA01    H      *Synon (15,2) w
     C           WN0012    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0012           Wgt Component U
     C                     END                             *FI
      * Picnic Line
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Department Code is CUT
      *   |- c2    : PAR.Production Line Code is Picnic
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1R3CD    IFEQ 'CUT'                      *IF
     C           P1EWAA    IFEQ @CN,001                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * PAR.Wgt Component USR
      * PAR.Wgt Component USR =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.Wgt Component USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : CON..743
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON..735
     C           WN0012    DIV  .743      W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT .735      W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0012           Wgt Component U
     C                     END                             *FI
      * Trim Line
      * CASE:
      *  - c2 AND c1
      *   |- c2    : PAR.Department Code is CUT
      *   |- c1    : PAR.Production Line Code is Trim
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1R3CD    IFEQ 'CUT'                      *IF
     C           P1EWAA    IFEQ 'TRIM'                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: DB1.Yld Component Code is Butt Trim
     C           WBE4AA    IFEQ @CN,002                    *IF
      * Rtv Trim Total        RT - Yld Daily Prod Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0030           Company Number
     C                     MOVELWBR3CD    WL0031    P      Department Code
     C                     MOVEL'BUTT'    WL0032    P      Production Line
     C                     Z-ADDWBELDT    WL0033           Production Date
     C                     MOVELWBN3SX    WL0034    P      Production Shif
     C                     Z-ADD720       WL0035           Item Structure
     C                     Z-ADDYL0002    WL0036           Wgt Total USR
     C                     EXSR SFRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0036    YL0002           Wgt Total USR
     C                     SUB  YL0002    WN0012           Wgt Component U
     C                     ELSE
      * CASE: DB1.Yld Component Code is Rib Trim
     C           WBE4AA    IFEQ @CN,003                    *IF
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
      * Rtv Yld Comp Wgt      RT - Yld Daily Prod Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0017           Company Number
     C                     MOVELWBR3CD    WL0018    P      Department Code
     C                     MOVEL'RIB'     WL0019    P      Production Line
     C                     Z-ADDWBELDT    WL0020           Production Date
     C                     MOVELWBN3SX    WL0021    P      Production Shif
     C                     MOVELWN0004    WL0022    P      Credit Item Inc
     C                     MOVELWN0005    WL0023    P      Type Inc/Exc St
     C                     Z-ADDWN0006    WL0024           Item Structure
     C                     MOVELWN0007    WL0025    P      Group Inc/Exc S
     C                     Z-ADDWN0008    WL0026           Item Structure
     C                     MOVELWN0009    WL0027    P      Class Inc/Exc S
     C                     Z-ADDWN0010    WL0028           Item Structure
     C                     Z-ADDWN0012    WL0029           Wgt Component U
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WN0012           Wgt Component U
      * PAR.Wgt Component USR
      * PAR.Wgt Component USR =
      *    *COMPUTE (x5 - (x1 - (x2 * x3 * x4)))
      * x5    : PAR.Wgt Component USR
      * -     : PGM.*Synon (15,2) work field
      * x1    : PAR.Wgt Component USR
      * -     : PGM.*Synon (17,7) work field
      * x2    : PAR.Head Cut
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.2
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON.0.3
     C           P2T7NX    MULT 2         W0WA03           *Synon (15,2) w
     C           W0WA03    MULT 0.3       W0WA02    H      *Synon (15,2) w
     C           WN0012    SUB  W0WA02    W0WD01           *Synon (17,7) w
     C           WN0012    SUB  W0WD01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Belly - Single Rib - Export Trim
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Single Rib
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,004                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (1) Wgt Compnent USR - SHTBEL EXPBLYTRSH weight  (which is item 6
      * CASE: DB1.Yld Component Code is Export Trim
     C           WBE4AA    IFEQ @CN,005                    *IF
      * Rtv Prod Weight 1 compRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0037           Company Number
     C                     MOVEL'BELLY'   WL0038    P      Department Code
     C                     MOVEL@CN,006   WL0039    P      Production Line
     C                     Z-ADDWBELDT    WL0040           Production Date
     C                     MOVELWBN3SX    WL0041    P      Production Shif
     C                     MOVEL@CN,007   WL0042    P      Yld Component C
     C                     Z-ADDYL0003    WL0043           Weight Tot Star
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    YL0003           Weight Tot Star
     C                     SUB  YL0003    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
      * Belly - Single Rib - Inedible
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Single Rib
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,004                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (1) Get Comp total wt, except Inedible (2) Get Finished Weight
      * CASE: DB1.Yld Component Code is Inedible
     C           WBE4AA    IFEQ @CN,008                    *IF
      * Rtv Prod Weight,O InedRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0044           Company Number
     C                     MOVELWBR3CD    WL0045    P      Department Code
     C                     MOVELWBEWAA    WL0046    P      Production Line
     C                     Z-ADDWBELDT    WL0047           Production Date
     C                     MOVELWBN3SX    WL0048    P      Production Shif
     C                     Z-ADDYL0003    WL0049           Weight Tot Star
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0049    YL0003           Weight Tot Star
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0050           Company Number
     C                     MOVELWBR3CD    WL0051    P      Department Code
     C                     MOVELWBEWAA    WL0052    P      Production Line
     C                     Z-ADDWBELDT    WL0053           Production Date
     C                     MOVELWBN3SX    WL0054    P      Production Shif
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    WN0013           Start Weight
     C           WN0013    SUB  YL0003    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
      * Belly - Sheet Belly  - Inedible
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Sheet Belly
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,006                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (1) Get Comp total wt, except Inedible (2) Get Finished Weight
      * CASE: DB1.Yld Component Code is Inedible
     C           WBE4AA    IFEQ @CN,008                    *IF
      * Rtv Prod Weight,O InedRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0044           Company Number
     C                     MOVELWBR3CD    WL0045    P      Department Code
     C                     MOVELWBEWAA    WL0046    P      Production Line
     C                     Z-ADDWBELDT    WL0047           Production Date
     C                     MOVELWBN3SX    WL0048    P      Production Shif
     C                     Z-ADDYL0003    WL0049           Weight Tot Star
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0049    YL0003           Weight Tot Star
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0050           Company Number
     C                     MOVELWBR3CD    WL0051    P      Department Code
     C                     MOVELWBEWAA    WL0052    P      Production Line
     C                     Z-ADDWBELDT    WL0053           Production Date
     C                     MOVELWBN3SX    WL0054    P      Production Shif
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    WN0013           Start Weight
     C           WN0013    SUB  YL0003    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
      * Belly - Skinless - Inedible
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Skinless
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,009                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (1) Get Comp total wt, except Inedible (2) Get Finished Weight
      * CASE: DB1.Yld Component Code is Inedible
     C           WBE4AA    IFEQ @CN,008                    *IF
      * Rtv Prod Weight,O InedRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0044           Company Number
     C                     MOVELWBR3CD    WL0045    P      Department Code
     C                     MOVELWBEWAA    WL0046    P      Production Line
     C                     Z-ADDWBELDT    WL0047           Production Date
     C                     MOVELWBN3SX    WL0048    P      Production Shif
     C                     Z-ADDYL0003    WL0049           Weight Tot Star
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0049    YL0003           Weight Tot Star
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0050           Company Number
     C                     MOVELWBR3CD    WL0051    P      Department Code
     C                     MOVELWBEWAA    WL0052    P      Production Line
     C                     Z-ADDWBELDT    WL0053           Production Date
     C                     MOVELWBN3SX    WL0054    P      Production Shif
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    WN0013           Start Weight
      * 4/6/04 Chg Start Wt if less than the sum of the components.
      * CASE: PAR.Start Weight LT LCL.Weight Tot Start Need USR
     C           WN0013    IFLT YL0003                     *IF
      * Upd Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0056           Company Number
     C                     MOVELWBR3CD    WL0057    P      Department Code
     C                     MOVELWBEWAA    WL0058    P      Production Line
     C                     Z-ADDWBELDT    WL0059           Production Date
     C                     MOVELWBN3SX    WL0060    P      Production Shif
     C                     Z-ADDYL0003    WL0061           Start Weight
     C                     EXSR SJRVGN
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0013    SUB  YL0003    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Belly - Skinls - Sknboxed
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Skinless
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,009                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Item Str Wgt - (belly/sglrib/sknsglrib wgt)- (belly/shtbel/sknsht
      * CASE: DB1.Yld Component Code is Skins Boxed
     C           WBE4AA    IFEQ @CN,010                    *IF
      * Rtv Prod Weight 1 compRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0037           Company Number
     C                     MOVEL'BELLY'   WL0038    P      Department Code
     C                     MOVEL@CN,004   WL0039    P      Production Line
     C                     Z-ADDWBELDT    WL0040           Production Date
     C                     MOVELWBN3SX    WL0041    P      Production Shif
     C                     MOVEL@CN,011   WL0042    P      Yld Component C
     C                     Z-ADDYL0003    WL0043           Weight Tot Star
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    YL0003           Weight Tot Star
     C                     SUB  YL0003    WN0012           Wgt Component U
      * Rtv Prod Weight 1 compRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0037           Company Number
     C                     MOVEL'BELLY'   WL0038    P      Department Code
     C                     MOVEL@CN,006   WL0039    P      Production Line
     C                     Z-ADDWBELDT    WL0040           Production Date
     C                     MOVELWBN3SX    WL0041    P      Production Shif
     C                     MOVEL@CN,012   WL0042    P      Yld Component C
     C                     Z-ADDYL0003    WL0043           Weight Tot Star
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    YL0003           Weight Tot Star
     C                     SUB  YL0003    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
      * Loins - Boning - Tenderloin/BiSirloin
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (This comp wgt per the item str)-(Cut biloin wgt per same item st
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Yld Component Code is Bone In Sirloin
      *   |- c2    : DB1.Yld Component Code is Tenderloin
      *   '-
     C           WBE4AA    IFEQ @CN,014                    *IF
     C           WBE4AA    OREQ @CN,015                    *OR
     C                     MOVELWBEWAA    YL0004           Production Line
     C                     Z-ADD*ZERO     WUJCWG           Weight Prod 1 U
      * Rtv Yld Comp Wgt      RT - Yld Daily Prod Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0017           Company Number
     C                     MOVEL'CUT'     WL0018    P      Department Code
     C                     MOVEL@CN,016   WL0019    P      Production Line
     C                     Z-ADDWBELDT    WL0020           Production Date
     C                     MOVELWBN3SX    WL0021    P      Production Shif
     C                     MOVELWN0004    WL0022    P      Credit Item Inc
     C                     MOVELWN0005    WL0023    P      Type Inc/Exc St
     C                     Z-ADDWN0006    WL0024           Item Structure
     C                     MOVELWN0007    WL0025    P      Group Inc/Exc S
     C                     Z-ADDWN0008    WL0026           Item Structure
     C                     MOVELWN0009    WL0027    P      Class Inc/Exc S
     C                     Z-ADDWN0010    WL0028           Item Structure
     C                     Z-ADDWUJCWG    WL0029           Wgt Component U
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WUJCWG           Wgt Component U
     C                     SUB  WUJCWG    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
      * Loins - Boning - Inedible
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * (1) Get Comp total wt, except Inedible (2) Get Finished Weight
      * CASE: DB1.Yld Component Code is Inedible
     C           WBE4AA    IFEQ @CN,008                    *IF
      * Rtv Prod Weight,O InedRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0044           Company Number
     C                     MOVELWBR3CD    WL0045    P      Department Code
     C                     MOVELWBEWAA    WL0046    P      Production Line
     C                     Z-ADDWBELDT    WL0047           Production Date
     C                     MOVELWBN3SX    WL0048    P      Production Shif
     C                     Z-ADDYL0003    WL0049           Weight Tot Star
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0049    YL0003           Weight Tot Star
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0050           Company Number
     C                     MOVELWBR3CD    WL0051    P      Department Code
     C                     MOVELWBEWAA    WL0052    P      Production Line
     C                     Z-ADDWBELDT    WL0053           Production Date
     C                     MOVELWBN3SX    WL0054    P      Production Shif
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    WN0013           Start Weight
      * 4/6/04 Chg Start Wt if less than the sum of the components.
      * CASE: PAR.Start Weight LT LCL.Weight Tot Start Need USR
     C           WN0013    IFLT YL0003                     *IF
      * Upd Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0056           Company Number
     C                     MOVELWBR3CD    WL0057    P      Department Code
     C                     MOVELWBEWAA    WL0058    P      Production Line
     C                     Z-ADDWBELDT    WL0059           Production Date
     C                     MOVELWBN3SX    WL0060    P      Production Shif
     C                     Z-ADDYL0003    WL0061           Start Weight
     C                     EXSR SJRVGN
     C                     Z-ADD*ZERO     WN0012           Wgt Component U
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0013    SUB  YL0003    WN0012           Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Loins - Boning - Cut Loss
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Wgt =  .70% of dept line SW
      * CASE: DB1.Yld Component Code is Cut Loss
     C           WBE4AA    IFEQ @CN,017                    *IF
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0050           Company Number
     C                     MOVELWBR3CD    WL0051    P      Department Code
     C                     MOVELWBEWAA    WL0052    P      Production Line
     C                     Z-ADDWBELDT    WL0053           Production Date
     C                     MOVELWBN3SX    WL0054    P      Production Shif
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0055    WN0013           Start Weight
     C           WN0013    MULT .007      WN0012    H      Wgt Component U
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Bone IN Loin
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Production Line Code is Bone-In Loin
      *   |- c2    : DB1.Yld Component Code is Loin Conversion Weight
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1EWAA    IFEQ @CN,016                    *IF
     C           WBE4AA    IFEQ @CN,018                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Add 2% to the Converions Weight
      * PAR.Wgt Component USR
      * PAR.Wgt Component USR =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.Wgt Component USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.1.02
     C           WN0012    MULT 1.02      W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0012           Wgt Component U
     C                     END                             *FI
      * Bone-In Smoker
      * CASE: DB1.Yld Component Code is Bone-In Smoker
     C           WBE4AA    IFEQ @CN,019                    *IF
     C                     MULT -1        WN0012           Wgt Component U
     C                     END                             *FI
     C                     ADD  WN0012    P3KOWG           Wgt Produced US
      * Chg Yld Daily Wgt     CH - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0062           Company Number
     C                     MOVELWBR3CD    WL0063    P      Department Code
     C                     MOVELWBEWAA    WL0064    P      Production Line
     C                     Z-ADDWBELDT    WL0065           Production Date
     C                     MOVELWBN3SX    WL0066    P      Production Shif
     C                     MOVELWBE4AA    WL0067    P      Yld Component C
     C                     Z-ADDWN0012    WL0068           YDL Yld Comp We
     C                     MOVELWBRISX    WL0069    P      YDL Component G
     C                     MOVELWBRJSX    WL0070    P      YDL Unused Sts
     C                     MOVELWBRKSX    WL0071    P      YDL Unused Sts
     C                     EXSR SMCHRC
      * Calculate Start Weight for Department and Line
      * CASE: DB1.Yld Component Code is Finished
     C           WBE4AA    IFEQ @CN,020                    *IF
      * Belly
      * CASE: DB1.Department Code is Belly
     C           WBR3CD    IFEQ 'BELLY'                    *IF
      * Line: SGLRIB SHTBEL- dont do shtbel as of 6/9/04 RMC
      * CASE: DB1.Production Line Code is Single Rib
     C           WBEWAA    IFEQ @CN,004                    *IF
      * Rtv Component Std     RT - Productn Ln Yld Comp Std  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0072           Company Number
     C                     MOVELWBR3CD    WL0073    P      Department Code
     C                     MOVELWBEWAA    WL0074    P      Production Line
     C                     MOVELWBE4AA    WL0075    P      Yld Component C
     C                     Z-ADDWBELDT    WL0076           PLYC Std Effect
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0077    YL0005           PLYC Std Percen
      * Start Weight
      * PAR.Start Weight =
      *    *COMPUTE ((x1 / (x2 / x3)))
      * x1    : PAR.Wgt Component USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.PLYC Std Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0005    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WN0012    DIV  W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0013           Start Weight
      * Upd Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0056           Company Number
     C                     MOVELWBR3CD    WL0057    P      Department Code
     C                     MOVELWBEWAA    WL0058    P      Production Line
     C                     Z-ADDWBELDT    WL0059           Production Date
     C                     MOVELWBN3SX    WL0060    P      Production Shif
     C                     Z-ADDWN0013    WL0061           Start Weight
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Line: SHTBEL- get from the cut belly sheetbly component  6/15/04
      * CASE: DB1.Production Line Code is Sheet Belly
     C           WBEWAA    IFEQ @CN,006                    *IF
      * Rtv Start Weight 2    RT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0078           Company Number
     C                     MOVEL'CUT'     WL0079    P      Department Code
     C                     Z-ADDWBELDT    WL0080           Production Date
     C                     MOVELWBN3SX    WL0081    P      Production Shif
     C                     MOVEL'BELLY'   WL0082    P      Production Line
     C                     MOVEL@CN,021   WL0083    P      Yld Component C
     C                     Z-ADDWN0013    WL0084           YDL Yld Comp We
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0084    WN0013           YDL Yld Comp We
      * Upd Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0056           Company Number
     C                     MOVELWBR3CD    WL0057    P      Department Code
     C                     MOVELWBEWAA    WL0058    P      Production Line
     C                     Z-ADDWBELDT    WL0059           Production Date
     C                     MOVELWBN3SX    WL0060    P      Production Shif
     C                     Z-ADDWN0013    WL0061           Start Weight
     C                     EXSR SJRVGN
     C                     END                             *FI
      * Line: SKINLS
      * CASE: DB1.Production Line Code is Skinless
     C           WBEWAA    IFEQ @CN,009                    *IF
      * Rtv Start Weight 2    RT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0078           Company Number
     C                     MOVEL'CUT'     WL0079    P      Department Code
     C                     Z-ADDWBELDT    WL0080           Production Date
     C                     MOVELWBN3SX    WL0081    P      Production Shif
     C                     MOVEL'BELLY'   WL0082    P      Production Line
     C                     MOVEL@CN,022   WL0083    P      Yld Component C
     C                     Z-ADDWN0013    WL0084           YDL Yld Comp We
     C                     EXSR SORVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0084    WN0013           YDL Yld Comp We
      * Upd Start Weight      RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0056           Company Number
     C                     MOVELWBR3CD    WL0057    P      Department Code
     C                     MOVELWBEWAA    WL0058    P      Production Line
     C                     Z-ADDWBELDT    WL0059           Production Date
     C                     MOVELWBN3SX    WL0060    P      Production Shif
     C                     Z-ADDWN0013    WL0061           Start Weight
     C                     EXSR SJRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@C0CPRL                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Component Info    RT - Production Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCR3CD           Department Code
     C                     KFLD           WCEWAA           Production Line
     C                     KFLD           WCE4AA           Yld Component C
      * Setup key
     C                     Z-ADDWL0001    WCAIC3           Company Number
     C                     MOVELWL0002    WCR3CD           Department Code
     C                     MOVELWL0003    WCEWAA           Production Line
     C                     MOVELWL0004    WCE4AA           Yld Component C
      * Establish starting position
     C           KRSSC     CHAIN@CZRERI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3262' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0005           PLYC Type
     C                     Z-ADD*ZERO     WL0006           PLYC Percent of
     C                     MOVEL*BLANK    WL0007           PLYC Comment
     C                     MOVEL*BLANK    WL0008           Credit Item Inc
     C                     MOVEL*BLANK    WL0009           Type Inc/Exc St
     C                     Z-ADD*ZERO     WL0010           Item Structure
     C                     MOVEL*BLANK    WL0011           Group Inc/Exc S
     C                     Z-ADD*ZERO     WL0012           Item Structure
     C                     MOVEL*BLANK    WL0013           Class Inc/Exc S
     C                     Z-ADD*ZERO     WL0014           Item Structure
     C                     MOVEL*BLANK    WL0015           YC Required Sts
     C                     MOVEL*BLANK    WL0016           YC Component Gr
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCO6SX    WL0005           PLYC Type
     C                     Z-ADDWCFLPC    WL0006           PLYC Percent of
     C                     MOVELWCQDNA    WL0007           PLYC Comment
     C                     MOVELWCPCSX    WL0008           Credit Item Inc
     C                     MOVELWCO8SX    WL0009           Type Inc/Exc St
     C                     Z-ADDWCRGNB    WL0010           Item Structure
     C                     MOVELWCO9SX    WL0011           Group Inc/Exc S
     C                     Z-ADDWCRHNB    WL0012           Item Structure
     C                     MOVELWCPASX    WL0013           Class Inc/Exc S
     C                     Z-ADDWCRINB    WL0014           Item Structure
     C                     MOVELWCPDSX    WL0015           YC Required Sts
     C                     MOVELWCPESX    WL0016           YC Component Gr
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Yld Comp Wgt      RT - Yld Prod Line Comp Sel  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSD01           Company Number
     C           *LIKE     DEFN WDR3CD    WQSD02           Department Code
     C           *LIKE     DEFN WDEWAA    WQSD03           Production Line
     C           *LIKE     DEFN WDE4AA    WQSD04           Yld Component C
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Department Code
     C                     KFLD           WQSD03           Production Line
     C                     KFLD           WQSD04           Yld Component C
      * Setup key
     C                     Z-ADDWBAIC3    WQSD01           Company Number
     C                     MOVELWBR3CD    WQSD02           Department Code
     C                     MOVELWBEWAA    WQSD03           Production Line
     C                     MOVELWBE4AA    WQSD04           Yld Component C
      * Establish starting position
     C           KRSSD     SETLL@AQREJX                    *
     C           KRSSD     READE@AQREJX                  90*
      * Data record not found
     C   90                MOVEL'USR3710' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Yld Comp Wgt      RT - Yld Daily Prod Summary  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0017           Company Number
     C                     MOVELWDR3CD    WL0018    P      Department Code
     C                     MOVELWDEWAA    WL0019    P      Production Line
     C                     Z-ADDWBELDT    WL0020           Production Date
     C                     MOVELWBN3SX    WL0021    P      Production Shif
     C                     MOVELWN0004    WL0022    P      Credit Item Inc
     C                     MOVELWDO8SX    WL0023    P      Type Inc/Exc St
     C                     Z-ADDWDRGNB    WL0024           Item Structure
     C                     MOVELWDO9SX    WL0025    P      Group Inc/Exc S
     C                     Z-ADDWDRHNB    WL0026           Item Structure
     C                     MOVELWDPASX    WL0027    P      Class Inc/Exc S
     C                     Z-ADDWDRINB    WL0028           Item Structure
     C                     Z-ADDWN0012    WL0029           Wgt Component U
     C                     EXSR SERVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0029    WN0012           Wgt Component U
     C           KRSSD     READE@AQREJX                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Yld Comp Wgt      RT - Yld Daily Prod Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WEAIC3    WQSE01           Company Number
     C           *LIKE     DEFN WER3CD    WQSE02           Department Code
     C           *LIKE     DEFN WEEWAA    WQSE03           Production Line
     C           *LIKE     DEFN WEELDT    WQSE04           Production Date
     C           *LIKE     DEFN WEN3SX    WQSE05           Production Shif
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Company Number
     C                     KFLD           WQSE02           Department Code
     C                     KFLD           WQSE03           Production Line
     C                     KFLD           WQSE04           Production Date
     C                     KFLD           WQSE05           Production Shif
      * Setup key
     C                     Z-ADDWL0017    WQSE01           Company Number
     C                     MOVELWL0018    WQSE02           Department Code
     C                     MOVELWL0019    WQSE03           Production Line
     C                     Z-ADDWL0020    WQSE04           Production Date
     C                     MOVELWL0021    WQSE05           Production Shif
      * Establish starting position
     C           KRSSE     SETLL@CTCPQM                    *
     C           KRSSE     READE@CTCPQM                  90*
      * Data record not found
     C   90                MOVEL'USR3225' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * SEL:  Credit Items
      * CASE: PAR.Credit Item Inc/Exc Sts is Entered
     C           WL0022    IFEQ 'E'                        *IF
     C           WL0022    OREQ 'I'
      * CASE: PAR.Credit Item Inc/Exc Sts is Include
     C           WL0022    IFEQ 'I'                        *IF
      * CASE: DB1.Credit Item Status is no
     C           WEVMST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Credit Item Inc/Exc Sts is Exclude
     C           WL0022    IFEQ 'E'                        *IF
      * CASE: DB1.Credit Item Status is yes
     C           WEVMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Type
      * CASE: PAR.Item Structure Type Code is Entered
     C           WL0024    IFNE *ZERO                      *IF
      * CASE: PAR.Type Inc/Exc Sts is Include
     C           WL0023    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Type Code NE DB1.Item Structure Type Cod
     C           WL0024    IFNE WERGNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Type Inc/Exc Sts is Exclude
     C           WL0023    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Type Code EQ DB1.Item Structure Type Cod
     C           WL0024    IFEQ WERGNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Group
      * CASE: PAR.Item Structure Group Code is Entered
     C           WL0026    IFNE *ZERO                      *IF
      * CASE: PAR.Group Inc/Exc Sts is Include
     C           WL0025    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Group Code NE DB1.Item Structure Group C
     C           WL0026    IFNE WERHNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Group Inc/Exc Sts is Exclude
     C           WL0025    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Group Code EQ DB1.Item Structure Group C
     C           WL0026    IFEQ WERHNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Class
      * CASE: PAR.Item Structure Class Code is Entered
     C           WL0028    IFNE *ZERO                      *IF
      * CASE: PAR.Class Inc/Exc Sts is Include
     C           WL0027    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Class Code NE DB1.Item Structure Class C
     C           WL0028    IFNE WERINB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Class Inc/Exc Sts is Exclude
     C           WL0027    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Class Code EQ DB1.Item Structure Class C
     C           WL0028    IFEQ WERINB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Total Product Weight
      * LCL.Wgt Total USR =
      *    *COMPUTE (x1 - x2 + x3 - x4)
      * x1    : DB1.Production Wgt
      * -     : PGM.*Synon (15,2) work field
      * x2    : DB1.Beginning WIP Inv Wgt
      * +     : PGM.*Synon (15,2) work field
      * x3    : DB1.Ending WIP Inv Wgt
      * -     : PGM.*Synon (15,2) work field
      * x4    : DB1.Product Delete Wgt
     C           WEJ7WG    SUB  WEJ8WG    W0WA02           *Synon (15,2) w
     C           W0WA02    ADD  WEJ9WG    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  WEKAWG    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0001           Wgt Total USR
     C                     ADD  YL0001    WL0029           Wgt Component U
     C                     END                             *FI
     C           KRSSE     READE@CTCPQM                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Trim Total        RT - Yld Daily Prod Summary  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0036           Wgt Total USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSF01           Company Number
     C           *LIKE     DEFN WFR3CD    WQSF02           Department Code
     C           *LIKE     DEFN WFEWAA    WQSF03           Production Line
     C           *LIKE     DEFN WFELDT    WQSF04           Production Date
     C           *LIKE     DEFN WFN3SX    WQSF05           Production Shif
     C           *LIKE     DEFN WFRGNB    WQSF06           Item Structure
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Company Number
     C                     KFLD           WQSF02           Department Code
     C                     KFLD           WQSF03           Production Line
     C                     KFLD           WQSF04           Production Date
     C                     KFLD           WQSF05           Production Shif
     C                     KFLD           WQSF06           Item Structure
      * Setup key
     C                     Z-ADDWL0030    WQSF01           Company Number
     C                     MOVELWL0031    WQSF02           Department Code
     C                     MOVELWL0032    WQSF03           Production Line
     C                     Z-ADDWL0033    WQSF04           Production Date
     C                     MOVELWL0034    WQSF05           Production Shif
     C                     Z-ADDWL0035    WQSF06           Item Structure
      * Establish starting position
     C           KRSSF     SETLL@CTCPR9                    *
     C           KRSSF     READE@CTCPR9                  90*
      * Data record not found
     C   90                MOVEL'USR3225' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR.Wgt Total USR
      * PAR.Wgt Total USR =
      *    *COMPUTE (x1 + (x2 - x3 + x4 - x5))
      * x1    : PAR.Wgt Total USR
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.Production Wgt
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.Beginning WIP Inv Wgt
      * +     : PGM.*Synon (15,2) work field
      * x4    : DB1.Ending WIP Inv Wgt
      * -     : PGM.*Synon (15,2) work field
      * x5    : DB1.Product Delete Wgt
     C           WFJ7WG    SUB  WFJ8WG    W0WA03           *Synon (15,2) w
     C           W0WA03    ADD  WFJ9WG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  WFKAWG    W0WA01           *Synon (15,2) w
     C           WL0036    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0036           Wgt Total USR
     C           KRSSF     READE@CTCPR9                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prod Weight 1 compRT - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0043           Weight Tot Star
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WGR3CD    WQSG02           Department Code
     C           *LIKE     DEFN WGELDT    WQSG03           Production Date
     C           *LIKE     DEFN WGN3SX    WQSG04           Production Shif
     C           *LIKE     DEFN WGEWAA    WQSG05           Production Line
     C           *LIKE     DEFN WGE4AA    WQSG06           Yld Component C
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Department Code
     C                     KFLD           WQSG03           Production Date
     C                     KFLD           WQSG04           Production Shif
     C                     KFLD           WQSG05           Production Line
     C                     KFLD           WQSG06           Yld Component C
      * Setup key
     C                     Z-ADDWL0037    WQSG01           Company Number
     C                     MOVELWL0038    WQSG02           Department Code
     C                     Z-ADDWL0040    WQSG03           Production Date
     C                     MOVELWL0041    WQSG04           Production Shif
     C                     MOVELWL0039    WQSG05           Production Line
     C                     MOVELWL0042    WQSG06           Yld Component C
      * Establish starting position
     C           KRSSG     SETLL@C0CPRT                    *
     C           KRSSG     READE@C0CPRT                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Yld Component Code is Inedible
     C           WGE4AA    IFEQ @CN,008                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGKKWG    WL0043           Weight Tot Star
     C                     END                             *FI
     C           KRSSG     READE@C0CPRT                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Prod Weight,O InedRT - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0049           Weight Tot Star
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSH01           Company Number
     C           *LIKE     DEFN WGR3CD    WQSH02           Department Code
     C           *LIKE     DEFN WGELDT    WQSH03           Production Date
     C           *LIKE     DEFN WGN3SX    WQSH04           Production Shif
     C           *LIKE     DEFN WGEWAA    WQSH05           Production Line
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           Company Number
     C                     KFLD           WQSH02           Department Code
     C                     KFLD           WQSH03           Production Date
     C                     KFLD           WQSH04           Production Shif
     C                     KFLD           WQSH05           Production Line
      * Setup key
     C                     Z-ADDWL0044    WQSH01           Company Number
     C                     MOVELWL0045    WQSH02           Department Code
     C                     Z-ADDWL0047    WQSH03           Production Date
     C                     MOVELWL0048    WQSH04           Production Shif
     C                     MOVELWL0046    WQSH05           Production Line
      * Establish starting position
     C           KRSSH     SETLL@C0CPRT                    *
     C           KRSSH     READE@C0CPRT                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Yld Component Code is Inedible
     C           WGE4AA    IFEQ @CN,008                    *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGKKWG    WL0049           Weight Tot Star
     C                     END                             *FI
     C           KRSSH     READE@C0CPRT                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Start Weight      RT - Yld Daily Line Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHR3CD           Department Code
     C                     KFLD           WHEWAA           Production Line
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHN3SX           Production Shif
      * Setup key
     C                     Z-ADDWL0050    WHAIC3           Company Number
     C                     MOVELWL0051    WHR3CD           Department Code
     C                     MOVELWL0052    WHEWAA           Production Line
     C                     Z-ADDWL0053    WHELDT           Production Date
     C                     MOVELWL0054    WHN3SX           Production Shif
      * Establish starting position
     C           KRSSI     CHAIN@CSCPQJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3223' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0055           Start Weight
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHJ3WG    WL0055           Start Weight
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Upd Start Weight      RT - Yld Daily Line Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  70       Start Pieces
     C                     Z-ADD*ZERO     WN0015 112       Ending Weight
     C                     Z-ADD*ZERO     WN0016 112       Converting Star
     C                     Z-ADD*ZERO     WN0017 112       Converting End
     C                     Z-ADD*ZERO     WN0018 112       Total Line Weig
     C                     Z-ADD*ZERO     WN0019  52       Production Stan
     C                     Z-ADD*ZERO     WN0020  52       Actual Yield
     C                     Z-ADD*ZERO     WN0021  52       Yield Variance
     C                     Z-ADD*ZERO     WN0022 112       Weight Variance
     C                     MOVEL*BLANK    WN0023 40        YDL Comment
     C                     MOVEL*BLANK    WN0024  1        YDL Post Status
     C                     MOVEL*BLANK    WN0025  2        YDL Process Sta
     C                     MOVEL*BLANK    WN0026  1        EDI Status 1
     C                     MOVEL*BLANK    WN0027  1        EDI Status 2
     C                     MOVEL*BLANK    WN0028  1        EDI Status 3
     C                     MOVEL*BLANK    WN0029  1        Record Status
     C                     Z-ADD*ZERO     WN0030  60       Job Time
     C                     MOVEL*BLANK    WN0031 10        User Id
     C                     MOVEL*BLANK    WN0032 10        Job Name
     C                     Z-ADD*ZERO     WN0033  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHR3CD           Department Code
     C                     KFLD           WHEWAA           Production Line
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHN3SX           Production Shif
      * Setup key
     C                     Z-ADDWL0056    WHAIC3           Company Number
     C                     MOVELWL0057    WHR3CD           Department Code
     C                     MOVELWL0058    WHEWAA           Production Line
     C                     Z-ADDWL0059    WHELDT           Production Date
     C                     MOVELWL0060    WHN3SX           Production Shif
      * Establish starting position
     C           KRSSJ     CHAIN@CSCPQJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3223' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Start Weight      CR - Yld Daily Line Header  * 
     C                     EXSR SKCRRC
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Start Weight      CH - Yld Daily Line Header  * 
     C                     EXSR SLCHRC
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Crt Start Weight      CR - Yld Daily Line Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CSCPQI
     C                     Z-ADDWL0056    WIAIC3           Company Number
     C                     MOVELWL0057    WIR3CD           Department Code
     C                     MOVELWL0058    WIEWAA           Production Line
     C                     Z-ADDWL0059    WIELDT           Production Date
     C                     MOVELWL0060    WIN3SX           Production Shif
     C                     Z-ADDWL0061    WIJ3WG           Start Weight
     C                     Z-ADD*ZERO     WIW6NX           Start Pieces
     C                     Z-ADDWN0015    WIJ6WG           Ending Weight
     C                     Z-ADDWN0016    WIJ4WG           Converting Star
     C                     Z-ADDWN0017    WIJ5WG           Converting End
     C                     Z-ADD*ZERO     WIF4PC           Pct Pieces Conv
     C                     Z-ADDWN0018    WIKOWG           Total Line Weig
     C                     Z-ADDWN0019    WIFJPC           Production Stan
     C                     Z-ADDWN0020    WIFKPC           Actual Yield
     C                     Z-ADDWN0021    WIFNPC           Yield Variance
     C                     Z-ADDWN0022    WIKNWG           Weight Variance
     C                     MOVELWN0023    WICWT1           YDL Comment
     C                     MOVELWN0024    WIOKSX           YDL Post Status
     C                     MOVELWN0025    WIONSX           YDL Process Sta
     C                     Z-ADD*ZERO     WIXCNX           Hogs Cut
     C                     Z-ADD*ZERO     WIMEWG           Bone In Zone Av
     C                     Z-ADD*ZERO     WIMFWG           Bone Ls Zone St
     C                     Z-ADD*ZERO     WIW9NX           Bone Ls Zone Pi
     C                     Z-ADD*ZERO     WIXANX           Conv: Finished
     C                     Z-ADD*ZERO     WIXBNX           Loins Returned
     C                     Z-ADD*ZERO     WIMGWG           Start Wgt Retur
     C                     Z-ADD*ZERO     WIMHWG           YDLH Unused Wgt
     C                     MOVELWN0026    WIUVST           EDI Status 1
     C                     MOVELWN0027    WIUWST           EDI Status 2
     C                     MOVELWN0028    WIUXST           EDI Status 3
     C                     MOVELWN0029    WIVSST           Record Status
     C                     Z-ADDWN0030    WIAATM           Job Time
     C                     MOVELWN0031    WIAYNA           User Id
     C                     MOVELWN0032    WIA0NA           Job Name
     C                     Z-ADDWN0033    WIAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WIVSST           Record Status
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIR3CD           Department Code
     C                     KFLD           WIEWAA           Production Line
     C                     KFLD           WIELDT           Production Date
     C                     KFLD           WIN3SX           Production Shif
      * Check for duplicate primary key
     C           KLCRSK    SETLL@CSCPQI                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3224' W0RTN   7
      * Send message 'Yld Daily Line Header  EX'
     C                     MOVEL'USR3224' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@CSCPQI                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLCHRC    BEGSR
      *================================================================
      * Chg Start Weight      CH - Yld Daily Line Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0034 112       Ending Weight
     C                     Z-ADD*ZERO     WN0035 112       Converting Star
     C                     Z-ADD*ZERO     WN0036 112       Converting End
     C                     Z-ADD*ZERO     WN0037 112       Total Line Weig
     C                     Z-ADD*ZERO     WN0038  52       Production Stan
     C                     Z-ADD*ZERO     WN0039  52       Actual Yield
     C                     Z-ADD*ZERO     WN0040  52       Yield Variance
     C                     Z-ADD*ZERO     WN0041 112       Weight Variance
     C                     MOVEL*BLANK    WN0042 40        YDL Comment
     C                     MOVEL*BLANK    WN0043  1        YDL Post Status
     C                     MOVEL*BLANK    WN0044  2        YDL Process Sta
     C                     Z-ADD*ZERO     WN0045  50       Hogs Cut
     C                     Z-ADD*ZERO     WN0046  52       Bone In Zone Av
     C                     Z-ADD*ZERO     WN0047 112       Bone Ls Zone St
     C                     Z-ADD*ZERO     WN0048  70       Bone Ls Zone Pi
     C                     Z-ADD*ZERO     WN0049  70       Conv: Finished
     C                     Z-ADD*ZERO     WN0050  70       Loins Returned
     C                     Z-ADD*ZERO     WN0051 112       Start Wgt Retur
     C                     Z-ADD*ZERO     WN0052 112       YDLH Unused Wgt
     C                     MOVEL*BLANK    WN0053  1        EDI Status 1
     C                     MOVEL*BLANK    WN0054  1        EDI Status 2
     C                     MOVEL*BLANK    WN0055  1        EDI Status 3
     C                     MOVEL*BLANK    WN0056  1        Record Status
     C                     Z-ADD*ZERO     WN0057  60       Job Time
     C                     MOVEL*BLANK    WN0058 10        User Id
     C                     MOVEL*BLANK    WN0059 10        Job Name
     C                     Z-ADD*ZERO     WN0060  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @CSCPQI
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     MOVELWHR3CD    WIR3CD    P      Department Code
     C                     MOVELWHEWAA    WIEWAA    P      Production Line
     C                     Z-ADDWHELDT    WIELDT           Production Date
     C                     MOVELWHN3SX    WIN3SX    P      Production Shif
      *
     C           KLCHSL    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIR3CD           Department Code
     C                     KFLD           WIEWAA           Production Line
     C                     KFLD           WIELDT           Production Date
     C                     KFLD           WIN3SX           Production Shif
     C           KLCHSL    CHAIN@CSCPQI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POCSCPL0'MDACP
     C                     MOVEL'@CSCPQI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOCS1    YARDCS
      * USER: Processing after Data read
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Move non-key fields to @CSCPQI
     C                     Z-ADDWL0061    WIJ3WG           Start Weight
     C                     Z-ADDWHW6NX    WIW6NX           Start Pieces
     C                     Z-ADDWHF4PC    WIF4PC           Pct Pieces Conv
      *
      * Set PGM.*Record Data Changed flag
     C           QPOCS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@CSCPQI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOCSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCHRC    BEGSR
      *================================================================
      * Chg Yld Daily Wgt     CH - Yld Daily Line Yld Comp  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0061  52       YDL Yld Mix Per
     C                     Z-ADD*ZERO     WN0062  52       YDL Yld Standar
     C                     Z-ADD*ZERO     WN0063 112       YDL Yld Weight
     C                     MOVEL*BLANK    WN0064  1        EDI Status 1
     C                     MOVEL*BLANK    WN0065  1        EDI Status 2
     C                     MOVEL*BLANK    WN0066  1        EDI Status 3
     C                     MOVEL*BLANK    WN0067  1        Record Status
     C                     Z-ADD*ZERO     WN0068  60       Job Time
     C                     MOVEL*BLANK    WN0069 10        User Id
     C                     MOVEL*BLANK    WN0070 10        Job Name
     C                     Z-ADD*ZERO     WN0071  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @C0CPRK
     C                     Z-ADDWL0062    WJAIC3           Company Number
     C                     MOVELWL0063    WJR3CD    P      Department Code
     C                     MOVELWL0064    WJEWAA    P      Production Line
     C                     Z-ADDWL0065    WJELDT           Production Date
     C                     MOVELWL0066    WJN3SX    P      Production Shif
     C                     MOVELWL0067    WJE4AA    P      Yld Component C
      *
     C           KLCHSM    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJR3CD           Department Code
     C                     KFLD           WJEWAA           Production Line
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJN3SX           Production Shif
     C                     KFLD           WJE4AA           Yld Component C
     C           KLCHSM    CHAIN@C0CPRK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POC0CPL0'MDACP
     C                     MOVEL'@C0CPRK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOC01    YBRDCS
      * Move non-key fields to @C0CPRK
     C                     Z-ADDWL0068    WJKKWG           YDL Yld Comp We
     C                     MOVELWL0069    WJRISX    P      YDL Component G
     C                     MOVELWL0070    WJRJSX    P      YDL Unused Sts
     C                     MOVELWL0071    WJRKSX    P      YDL Unused Sts
      *
      * Set PGM.*Record Data Changed flag
     C           QPOC01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOC01    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@C0CPRK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOC0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Component Std     RT - Productn Ln Yld Comp Std  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WKR3CD    WQSN02           Department Code
     C           *LIKE     DEFN WKEWAA    WQSN03           Production Line
     C           *LIKE     DEFN WKE4AA    WQSN04           Yld Component C
      * Define keylist
     C           KPSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Department Code
     C                     KFLD           WQSN03           Production Line
     C                     KFLD           WQSN04           Yld Component C
     C                     KFLD           WKPXDT           PLYC Std Effect
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Department Code
     C                     KFLD           WQSN03           Production Line
     C                     KFLD           WQSN04           Yld Component C
      * Setup key
     C                     Z-ADDWL0072    WQSN01           Company Number
     C                     MOVELWL0073    WQSN02           Department Code
     C                     MOVELWL0074    WQSN03           Production Line
     C                     MOVELWL0075    WQSN04           Yld Component C
     C                     Z-ADDWL0076    WKPXDT           PLYC Std Effect
      * Establish starting position
     C           KPSSN     SETLL@AGCPUJ                    *
     C           KRSSN     READE@AGCPUJ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3350' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0077           PLYC Std Percen
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWKFPPC    WL0077           PLYC Std Percen
     C                     GOTO SNEXIT                     *QUIT
     C           KRSSN     READE@AGCPUJ                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Start Weight 2    RT - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSO01           Company Number
     C           *LIKE     DEFN WGR3CD    WQSO02           Department Code
     C           *LIKE     DEFN WGELDT    WQSO03           Production Date
     C           *LIKE     DEFN WGN3SX    WQSO04           Production Shif
     C           *LIKE     DEFN WGEWAA    WQSO05           Production Line
     C           *LIKE     DEFN WGE4AA    WQSO06           Yld Component C
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WQSO01           Company Number
     C                     KFLD           WQSO02           Department Code
     C                     KFLD           WQSO03           Production Date
     C                     KFLD           WQSO04           Production Shif
     C                     KFLD           WQSO05           Production Line
     C                     KFLD           WQSO06           Yld Component C
      * Setup key
     C                     Z-ADDWL0078    WQSO01           Company Number
     C                     MOVELWL0079    WQSO02           Department Code
     C                     Z-ADDWL0080    WQSO03           Production Date
     C                     MOVELWL0081    WQSO04           Production Shif
     C                     MOVELWL0082    WQSO05           Production Line
     C                     MOVELWL0083    WQSO06           Yld Component C
      * Establish starting position
     C           KRSSO     SETLL@C0CPRT                    *
     C           KRSSO     READE@C0CPRT                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WGKKWG    WL0084           YDL Yld Comp We
      * CASE: DB1.Yld Component Code is Loin Conversion Weight
     C           WGE4AA    IFEQ @CN,018                    *IF
      * CASE: DB1.YDL Yld Mix Percent is not equal to zeros
     C           WGFMPC    IFNE *ZERO                      *IF
      * PAR.YDL Yld Comp Weight =
      *    *COMPUTE (x1 * x2)
      * x1    : PAR.YDL Yld Comp Weight
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON..8
     C           WL0084    MULT .8        W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0084           YDL Yld Comp We
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSO     READE@C0CPRT                  90*
     C                     ENDDO
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Line Std Yield    RT - Production Line Std Yld  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0089           Production Stan
     C                     MOVEL'Y'       YL0006           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WLAIC3    WQSP01           Company Number
     C           *LIKE     DEFN WLR3CD    WQSP02           Department Code
     C           *LIKE     DEFN WLEWAA    WQSP03           Production Line
      * Define keylist
     C           KPSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Department Code
     C                     KFLD           WQSP03           Production Line
     C                     KFLD           WLAUDT           Effective Date
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
     C                     KFLD           WQSP02           Department Code
     C                     KFLD           WQSP03           Production Line
      * Setup key
     C                     Z-ADDWL0085    WQSP01           Company Number
     C                     MOVELWL0086    WQSP02           Department Code
     C                     MOVELWL0087    WQSP03           Production Line
     C                     Z-ADDWL0088    WLAUDT           Effective Date
      * Establish starting position
     C           KPSSP     SETLL@C2CPR1                    *
     C           KRSSP     READE@C2CPR1                  90*
      * Data record not found
     C   90                MOVEL'USR3272' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADDWLFJPC    WL0089           Production Stan
     C                     GOTO SPEXIT                     *QUIT
     C           KRSSP     READE@C2CPR1                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Exc Calc Mix Pct      RT - Yld Daily Line Yld Comp  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0072  52       YDL Yld Mix Per
     C                     Z-ADD*ZERO     WN0073  52       YDL Yld Standar
     C                     Z-ADD*ZERO     WN0074 112       YDL Yld Weight
     C                     MOVEL*BLANK    WN0075  1        YDL Component G
     C                     MOVEL*BLANK    WN0076  1        YDL Unused Sts
     C                     MOVEL*BLANK    WN0077  1        YDL Unused Sts
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WBR3CD    WQSQ02           Department Code
     C           *LIKE     DEFN WBEWAA    WQSQ03           Production Line
     C           *LIKE     DEFN WBELDT    WQSQ04           Production Date
     C           *LIKE     DEFN WBN3SX    WQSQ05           Production Shif
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           Department Code
     C                     KFLD           WQSQ03           Production Line
     C                     KFLD           WQSQ04           Production Date
     C                     KFLD           WQSQ05           Production Shif
      * Setup key
     C                     Z-ADDWL0090    WQSQ01           Company Number
     C                     MOVELWL0091    WQSQ02           Department Code
     C                     MOVELWL0092    WQSQ03           Production Line
     C                     Z-ADDWL0093    WQSQ04           Production Date
     C                     MOVELWL0094    WQSQ05           Production Shif
      * Establish starting position
     C           KRSSQ     SETLL@C0CPRL                    *
     C           KRSSQ     READE@C0CPRL                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     Z-ADD*ZERO     WN0072           YDL Yld Mix Per
     C                     Z-ADD*ZERO     WN0073           YDL Yld Standar
     C                     Z-ADD*ZERO     WN0074           YDL Yld Weight
      * CASE: DB1.YDL Yld Comp Weight is Greater than zero
     C           WBKKWG    IFGT *ZERO                      *IF
      * Mix Percent
      * PAR.YDL Yld Mix Percent =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : DB1.YDL Yld Comp Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.Total Line Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WBKKWG    DIV  WL0095    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0072           YDL Yld Mix Per
     C                     END                             *FI
      * STD %  - std from yld comp std file and spec calcs from bom
      * CASE: Belly/Skinless/Finished
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Skinless
      *   |- c3    : DB1.Yld Component Code is Finished
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,009                    *IF
     C           WBE4AA    IFEQ @CN,020                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Std% = sum((wgt produced/item bom sales yield)) / sw
      * Clc Skinls Finish Std IF
      * Rtv Component Info    RT - Yld Prod Line Component  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVEL@CN,020   WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0007    P      PLYC Type
     C                     Z-ADDWL0006    WUFLPC           PLYC Percent of
     C                     MOVELWL0007    WUQDNA    P      PLYC Comment
     C                     MOVELWL0008    YL0008    P      Credit Item Inc
     C                     MOVELWL0009    WUO8SX    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WURGNB           Item Structure
     C                     MOVELWL0011    WUO9SX    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WURHNB           Item Structure
     C                     MOVELWL0013    WUPASX    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WURINB           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WUPESX    P      YC Component Gr
      * CASE: LCL.PLYC Type is Retrieve w/Mult Item Str
     C           YL0007    IFEQ 'MS'                       *IF
      * Rtv Skinls Fin Std    RT - Yld Prod Line Comp Sel  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0096           Company Number
     C                     MOVELWBR3CD    WL0097    P      Department Code
     C                     MOVELWBEWAA    WL0098    P      Production Line
     C                     MOVEL@CN,020   WL0099    P      Yld Component C
     C                     Z-ADDWBELDT    WL0100           Production Date
     C                     MOVELWBN3SX    WL0101    P      Production Shif
     C                     MOVELYL0008    WL0102    P      Credit Item Inc
     C                     Z-ADDWL0095    WL0103           Start Weight
     C                     Z-ADDYL0009    WL0105           Unused Weight R
     C                     Z-ADDYL0010    WL0106           Weight Prod 2 U
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    WN0073           YDL Yld Standar
     C                     Z-ADDWL0105    YL0009           Unused Weight R
     C                     Z-ADDWL0106    YL0010           Weight Prod 2 U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Skinls Fin Std    RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0107           Company Number
     C                     MOVELWBR3CD    WL0108    P      Department Code
     C                     MOVELWBEWAA    WL0109    P      Production Line
     C                     Z-ADDWBELDT    WL0110           Production Date
     C                     MOVELWBN3SX    WL0111    P      Production Shif
     C                     MOVELYL0008    WL0112    P      Credit Item Inc
     C                     MOVELWUO8SX    WL0113    P      Type Inc/Exc St
     C                     Z-ADDWURGNB    WL0114           Item Structure
     C                     MOVELWUO9SX    WL0115    P      Group Inc/Exc S
     C                     Z-ADDWURHNB    WL0116           Item Structure
     C                     MOVELWUPASX    WL0117    P      Class Inc/Exc S
     C                     Z-ADDWURINB    WL0118           Item Structure
     C                     Z-ADDWL0095    WL0120           Start Weight
     C                     Z-ADDYL0009    WL0121           Unused Weight R
     C                     Z-ADDYL0010    WL0122           Weight Prod 2 U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0119    WN0073           YDL Yld Standar
     C                     Z-ADDWL0121    YL0009           Unused Weight R
     C                     Z-ADDWL0122    YL0010           Weight Prod 2 U
     C                     END                             *FI
     C                     ELSE
      * CASE: Boneless Loins - Str on/off STD%
      *  - c1ANDc2AND(c3ORc4)
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   |- c3    : DB1.Yld Component Code is Boneless Loin-Strap On
      *   |- c4    : DB1.Yld Component Code is Boneless Loin-Strap Off
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WBE4AA    IFEQ @CN,023                    *IF
     C           WBE4AA    OREQ @CN,024                    *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc Bonless Loins Std IF
      * Rtv Component Info    RT - Yld Prod Line Component  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVELWBE4AA    WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0017    P      PLYC Type
     C                     Z-ADDWL0006    WUFLPC           PLYC Percent of
     C                     MOVELWL0007    WUQDNA    P      PLYC Comment
     C                     MOVELWL0008    YL0018    P      Credit Item Inc
     C                     MOVELWL0009    WUO8SX    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WURGNB           Item Structure
     C                     MOVELWL0011    WUO9SX    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WURHNB           Item Structure
     C                     MOVELWL0013    WUPASX    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WURINB           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WUPESX    P      YC Component Gr
      * CASE: LCL.PLYC Type is Retrieve w/Mult Item Str
     C           YL0017    IFEQ 'MS'                       *IF
      * Rtv Skinls Fin Std    RT - Yld Prod Line Comp Sel  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0096           Company Number
     C                     MOVELWBR3CD    WL0097    P      Department Code
     C                     MOVELWBEWAA    WL0098    P      Production Line
     C                     MOVELWBE4AA    WL0099    P      Yld Component C
     C                     Z-ADDWBELDT    WL0100           Production Date
     C                     MOVELWBN3SX    WL0101    P      Production Shif
     C                     MOVELYL0018    WL0102    P      Credit Item Inc
     C                     Z-ADDWL0095    WL0103           Start Weight
     C                     Z-ADDYL0019    WL0105           Unused Weight R
     C                     Z-ADDYL0020    WL0106           Weight Prod 2 U
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    WN0073           YDL Yld Standar
     C                     Z-ADDWL0105    YL0019           Unused Weight R
     C                     Z-ADDWL0106    YL0020           Weight Prod 2 U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Skinls Fin Std    RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0107           Company Number
     C                     MOVELWBR3CD    WL0108    P      Department Code
     C                     MOVELWBEWAA    WL0109    P      Production Line
     C                     Z-ADDWBELDT    WL0110           Production Date
     C                     MOVELWBN3SX    WL0111    P      Production Shif
     C                     MOVELYL0018    WL0112    P      Credit Item Inc
     C                     MOVELWUO8SX    WL0113    P      Type Inc/Exc St
     C                     Z-ADDWURGNB    WL0114           Item Structure
     C                     MOVELWUO9SX    WL0115    P      Group Inc/Exc S
     C                     Z-ADDWURHNB    WL0116           Item Structure
     C                     MOVELWUPASX    WL0117    P      Class Inc/Exc S
     C                     Z-ADDWURINB    WL0118           Item Structure
     C                     Z-ADDWL0095    WL0120           Start Weight
     C                     Z-ADDYL0019    WL0121           Unused Weight R
     C                     Z-ADDYL0020    WL0122           Weight Prod 2 U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0119    WN0073           YDL Yld Standar
     C                     Z-ADDWL0121    YL0019           Unused Weight R
     C                     Z-ADDWL0122    YL0020           Weight Prod 2 U
     C                     END                             *FI
     C                     ELSE
      * CASE: Bone In/bone less Sirloin STD%
      *  - c1ANDc2AND(c3ORc4)
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   |- c3    : DB1.Yld Component Code is Bone In Sirloin
      *   |- c4    : DB1.Yld Component Code is Bone Less Sirloin
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C                     MOVEL'0'       Y0CX02  1
     C           WBE4AA    IFEQ @CN,014                    *IF
     C           WBE4AA    OREQ @CN,025                    *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc Loins Sirloin Std IF
      * Rtv Prod Weight 1 compRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0037           Company Number
     C                     MOVELWBR3CD    WL0038    P      Department Code
     C                     MOVELWBEWAA    WL0039    P      Production Line
     C                     Z-ADDWBELDT    WL0040           Production Date
     C                     MOVELWBN3SX    WL0041    P      Production Shif
     C                     MOVELWBE4AA    WL0042    P      Yld Component C
     C                     Z-ADDYL0021    WL0043           Weight Tot Star
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    YL0021           Weight Tot Star
      * CASE: PAR.Yld Component Code is Bone In Sirloin
     C           WBE4AA    IFEQ @CN,014                    *IF
     C                     MOVEL@CN,025   YL0022           Yld Component C
     C                     ELSE
      * CASE: PAR.Yld Component Code is Bone Less Sirloin
     C           WBE4AA    IFEQ @CN,025                    *IF
     C                     MOVEL@CN,014   YL0022           Yld Component C
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Prod Weight 1 compRT - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0037           Company Number
     C                     MOVELWBR3CD    WL0038    P      Department Code
     C                     MOVELWBEWAA    WL0039    P      Production Line
     C                     Z-ADDWBELDT    WL0040           Production Date
     C                     MOVELWBN3SX    WL0041    P      Production Shif
     C                     MOVELYL0022    WL0042    P      Yld Component C
     C                     Z-ADDYL0023    WL0043           Weight Tot Star
     C                     EXSR SGRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0043    YL0023           Weight Tot Star
      * CASE: PAR.Yld Component Code is Bone In Sirloin
     C           WBE4AA    IFEQ @CN,014                    *IF
      * Std% =(bi comp wgt*.1714)/((bls sirloin comp wgt/2) + bi sirloin
      *  Perform if weights arent zero
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Weight Prod 2 USR is Not equal zero
      *   |- c2    : LCL.YDL Yld Comp Weight is Not equal zero
      *   '-
     C           YL0023    IFNE *ZERO                      *IF
     C           YL0021    ORNE *ZERO                      *OR
      * Compute:BISIRLOIN STD %
      * PAR.YDL Yld Standard Pct =
      *    *COMPUTE (((x1*x2)/((x3*x4)+x1))*x5)
      * x1    : LCL.YDL Yld Comp Weight
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON..1714
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : LCL.Weight Prod 2 USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON.2
      * +     : PGM.*Synon (17,7) work field
      * x1    : LCL.YDL Yld Comp Weight
      * *     : PGM.*Synon (17,7) work field
      * x5    : CON.100
     C           YL0021    MULT .1714     W0WD02           *Synon (17,7) w
     C           YL0023    MULT 2         W0WA04           *Synon (15,2) w
     C           W0WA04    ADD  YL0021    W0WD03           *Synon (17,7) w
     C           W0WD02    DIV  W0WD03    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WN0073           YDL Yld Standar
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Yld Component Code is Bone Less Sirloin
     C           WBE4AA    IFEQ @CN,025                    *IF
      * Std% =(blsComp wgt*.0857)/((bi Sirloin comp wgt/2) + Bls sirloin
      *  Perform if weights arent zero
      * CASE:
      *  - c1ORc2
      *   |- c1    : LCL.Weight Prod 2 USR is Not equal zero
      *   |- c2    : LCL.YDL Yld Comp Weight is Not equal zero
      *   '-
     C           YL0023    IFNE *ZERO                      *IF
     C           YL0021    ORNE *ZERO                      *OR
      * Compute:BLSSIRLOIN STD %
      * PAR.YDL Yld Standard Pct =
      *    *COMPUTE (((x1*x2)/((x3/x4)+x1))*x5)
      * x1    : LCL.YDL Yld Comp Weight
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON..0857
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : LCL.Weight Prod 2 USR
      * /     : PGM.*Synon (15,2) work field *
      * x4    : CON.2
      * +     : PGM.*Synon (17,7) work field
      * x1    : LCL.YDL Yld Comp Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x5    : CON.100
     C           YL0021    MULT .0857     W0WD02           *Synon (17,7) w
     C           YL0023    DIV  2         W0WA04           *Synon (15,2) w
     C           W0WA04    ADD  YL0021    W0WD03           *Synon (17,7) w
     C           W0WD02    DIV  W0WD03    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0073           YDL Yld Standar
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: Shoulder Loin STD %
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   |- c3    : DB1.Yld Component Code is Shoulder Loin
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C           WBE4AA    IFEQ @CN,026                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWN0072    WN0073           YDL Yld Standar
     C                     ELSE
      * CASE: Loins Boning Inedible STD %
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Department Code is Loin Boning
      *   |- c2    : DB1.Production Line Code is Boning
      *   |- c3    : DB1.Yld Component Code is Inedible
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C           WBE4AA    IFEQ @CN,008                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Std% = sum(std wt prod*Std Ined % in each Itm BOM for 96309) / (T
      *
     C                     MOVEL*BLANK    WN0078 10        Yld Component C
      *
      * Clc Loin Bng Ined Std IF
      * 07/30/09 PKD Added processing for Multiple Structures for a
      *              Component.
     C                     Z-ADD*ZERO     YL0024           Weight Prod 1 U
     C                     Z-ADD*ZERO     YL0025           Weight Prod 2 U
     C                     MOVEL@CN,023   WN0078           Yld Component C
      * Rtv Component Info    RT - Production Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVELWN0078    WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUO6SX    P      PLYC Type
     C                     Z-ADDWL0006    WUFLPC           PLYC Percent of
     C                     MOVELWL0007    WUQDNA    P      PLYC Comment
     C                     MOVELWL0008    WUPCSX    P      Credit Item Inc
     C                     MOVELWL0009    WUO8SX    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WURGNB           Item Structure
     C                     MOVELWL0011    WUO9SX    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WURHNB           Item Structure
     C                     MOVELWL0013    WUPASX    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WURINB           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WUPESX    P      YC Component Gr
      * CASE: WRK.PLYC Type is Retrieve w/Mult Item Str
     C           WUO6SX    IFEQ 'MS'                       *IF
      * Rtv Loin Bng Ined Std RT - Yld Prod Line Comp Sel  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0133           Company Number
     C                     MOVELWBR3CD    WL0134    P      Department Code
     C                     MOVELWBEWAA    WL0135    P      Production Line
     C                     MOVELWN0078    WL0136    P      Yld Component C
     C                     Z-ADDWBELDT    WL0137           Production Date
     C                     MOVELWBN3SX    WL0138    P      Production Shif
     C                     MOVELWUPCSX    WL0139    P      Credit Item Inc
     C                     Z-ADDYL0024    WL0140           Weight Prod 1 U
     C                     Z-ADDYL0025    WL0141           Weight Prod 2 U
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0140    YL0024           Weight Prod 1 U
     C                     Z-ADDWL0141    YL0025           Weight Prod 2 U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Loin Bng Ined Std RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0142           Company Number
     C                     MOVELWBR3CD    WL0143    P      Department Code
     C                     MOVELWBEWAA    WL0144    P      Production Line
     C                     Z-ADDWBELDT    WL0145           Production Date
     C                     MOVELWBN3SX    WL0146    P      Production Shif
     C                     MOVELWUPCSX    WL0147    P      Credit Item Inc
     C                     MOVELWUO8SX    WL0148    P      Type Inc/Exc St
     C                     Z-ADDWURGNB    WL0149           Item Structure
     C                     MOVELWUO9SX    WL0150    P      Group Inc/Exc S
     C                     Z-ADDWURHNB    WL0151           Item Structure
     C                     MOVELWUPASX    WL0152    P      Class Inc/Exc S
     C                     Z-ADDWURINB    WL0153           Item Structure
     C                     Z-ADDYL0024    WL0154           Weight Prod 1 U
     C                     Z-ADDYL0025    WL0155           Weight Prod 2 U
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0154    YL0024           Weight Prod 1 U
     C                     Z-ADDWL0155    YL0025           Weight Prod 2 U
     C                     END                             *FI
     C                     MOVEL@CN,024   WN0078           Yld Component C
      * Rtv Component Info    RT - Production Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVELWN0078    WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUO6SX    P      PLYC Type
     C                     Z-ADDWL0006    WUFLPC           PLYC Percent of
     C                     MOVELWL0007    WUQDNA    P      PLYC Comment
     C                     MOVELWL0008    WUPCSX    P      Credit Item Inc
     C                     MOVELWL0009    WUO8SX    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WURGNB           Item Structure
     C                     MOVELWL0011    WUO9SX    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WURHNB           Item Structure
     C                     MOVELWL0013    WUPASX    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WURINB           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WUPESX    P      YC Component Gr
      * CASE: WRK.PLYC Type is Retrieve w/Mult Item Str
     C           WUO6SX    IFEQ 'MS'                       *IF
      * Rtv Loin Bng Ined Std RT - Yld Prod Line Comp Sel  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0133           Company Number
     C                     MOVELWBR3CD    WL0134    P      Department Code
     C                     MOVELWBEWAA    WL0135    P      Production Line
     C                     MOVELWN0078    WL0136    P      Yld Component C
     C                     Z-ADDWBELDT    WL0137           Production Date
     C                     MOVELWBN3SX    WL0138    P      Production Shif
     C                     MOVELWUPCSX    WL0139    P      Credit Item Inc
     C                     Z-ADDYL0024    WL0140           Weight Prod 1 U
     C                     Z-ADDYL0025    WL0141           Weight Prod 2 U
     C                     EXSR SWRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0140    YL0024           Weight Prod 1 U
     C                     Z-ADDWL0141    YL0025           Weight Prod 2 U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Loin Bng Ined Std RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0142           Company Number
     C                     MOVELWBR3CD    WL0143    P      Department Code
     C                     MOVELWBEWAA    WL0144    P      Production Line
     C                     Z-ADDWBELDT    WL0145           Production Date
     C                     MOVELWBN3SX    WL0146    P      Production Shif
     C                     MOVELWUPCSX    WL0147    P      Credit Item Inc
     C                     MOVELWUO8SX    WL0148    P      Type Inc/Exc St
     C                     Z-ADDWURGNB    WL0149           Item Structure
     C                     MOVELWUO9SX    WL0150    P      Group Inc/Exc S
     C                     Z-ADDWURHNB    WL0151           Item Structure
     C                     MOVELWUPASX    WL0152    P      Class Inc/Exc S
     C                     Z-ADDWURINB    WL0153           Item Structure
     C                     Z-ADDYL0024    WL0154           Weight Prod 1 U
     C                     Z-ADDYL0025    WL0155           Weight Prod 2 U
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0154    YL0024           Weight Prod 1 U
     C                     Z-ADDWL0155    YL0025           Weight Prod 2 U
     C                     END                             *FI
      * Compute: Ined Yld Std Pct
      * PAR.YDL Yld Standard Pct =
      *    *COMPUTE ((x1/x2)*x3)
      * x1    : LCL.Weight Prod 1 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.Total Line Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0024    DIV  WL0095    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0073           YDL Yld Standar
     C                     ELSE
      * CASE: Belly/Sheet Belly/Finished OR Single Rib
      *  - (c1ANDc2ANDc3) OR (c4ANDc5ANDc6)
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Sheet Belly
      *   |- c3    : DB1.Yld Component Code is Finished
      *   |- c4    : DB1.Department Code is Belly
      *   |- c5    : DB1.Production Line Code is Single Rib
      *   |- c6    : DB1.Yld Component Code is Finished
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,006                    *IF
     C           WBE4AA    IFEQ @CN,020                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,004                    *IF
     C           WBE4AA    IFEQ @CN,020                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc Skinls Finish Std IF
      * Rtv Component Info    RT - Yld Prod Line Component  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVEL@CN,020   WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    YL0007    P      PLYC Type
     C                     Z-ADDWL0006    WUFLPC           PLYC Percent of
     C                     MOVELWL0007    WUQDNA    P      PLYC Comment
     C                     MOVELWL0008    YL0008    P      Credit Item Inc
     C                     MOVELWL0009    WUO8SX    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WURGNB           Item Structure
     C                     MOVELWL0011    WUO9SX    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WURHNB           Item Structure
     C                     MOVELWL0013    WUPASX    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WURINB           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WUPESX    P      YC Component Gr
      * CASE: LCL.PLYC Type is Retrieve w/Mult Item Str
     C           YL0007    IFEQ 'MS'                       *IF
      * Rtv Skinls Fin Std    RT - Yld Prod Line Comp Sel  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0096           Company Number
     C                     MOVELWBR3CD    WL0097    P      Department Code
     C                     MOVELWBEWAA    WL0098    P      Production Line
     C                     MOVEL@CN,020   WL0099    P      Yld Component C
     C                     Z-ADDWBELDT    WL0100           Production Date
     C                     MOVELWBN3SX    WL0101    P      Production Shif
     C                     MOVELYL0008    WL0102    P      Credit Item Inc
     C                     Z-ADDWL0095    WL0103           Start Weight
     C                     Z-ADDYL0009    WL0105           Unused Weight R
     C                     Z-ADDYL0010    WL0106           Weight Prod 2 U
     C                     EXSR SRRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0104    WN0073           YDL Yld Standar
     C                     Z-ADDWL0105    YL0009           Unused Weight R
     C                     Z-ADDWL0106    YL0010           Weight Prod 2 U
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Skinls Fin Std    RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0107           Company Number
     C                     MOVELWBR3CD    WL0108    P      Department Code
     C                     MOVELWBEWAA    WL0109    P      Production Line
     C                     Z-ADDWBELDT    WL0110           Production Date
     C                     MOVELWBN3SX    WL0111    P      Production Shif
     C                     MOVELYL0008    WL0112    P      Credit Item Inc
     C                     MOVELWUO8SX    WL0113    P      Type Inc/Exc St
     C                     Z-ADDWURGNB    WL0114           Item Structure
     C                     MOVELWUO9SX    WL0115    P      Group Inc/Exc S
     C                     Z-ADDWURHNB    WL0116           Item Structure
     C                     MOVELWUPASX    WL0117    P      Class Inc/Exc S
     C                     Z-ADDWURINB    WL0118           Item Structure
     C                     Z-ADDWL0095    WL0120           Start Weight
     C                     Z-ADDYL0009    WL0121           Unused Weight R
     C                     Z-ADDYL0010    WL0122           Weight Prod 2 U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0119    WN0073           YDL Yld Standar
     C                     Z-ADDWL0121    YL0009           Unused Weight R
     C                     Z-ADDWL0122    YL0010           Weight Prod 2 U
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Component Std     RT - Productn Ln Yld Comp Std  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0072           Company Number
     C                     MOVELWBR3CD    WL0073    P      Department Code
     C                     MOVELWBEWAA    WL0074    P      Production Line
     C                     MOVELWBE4AA    WL0075    P      Yld Component C
     C                     Z-ADDWBELDT    WL0076           PLYC Std Effect
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0077    WN0073           PLYC Std Percen
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Actual - Std Weight Diff
      * CASE: PAR.YDL Yld Standard Pct is Greater than zero
     C           WN0073    IFGT *ZERO                      *IF
      * Compute: yld weight diff
      * PAR.YDL Yld Weight Diff =
      *    *COMPUTE ((x1/x4*x2) - (x3/x4*x2))
      * x1    : PAR.YDL Yld Mix Percent
      * /     : PGM.*Synon (15,5) work field *
      * x4    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Total Line Weight
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.YDL Yld Standard Pct
      * /     : PGM.*Synon (15,5) work field *
      * x4    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Total Line Weight
     C           WN0072    DIV  100       W0WB02           *Synon (15,5) w
     C           W0WB02    MULT WL0095    W0WA01    H      *Synon (15,2) w
     C           WN0073    DIV  100       W0WB04           *Synon (15,5) w
     C           W0WB04    MULT WL0095    W0WA03    H      *Synon (15,2) w
     C           W0WA01    SUB  W0WA03    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0074           YDL Yld Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0074           YDL Yld Weight
     C                     END                             *FI
      * Chg Mix Percent       CH - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0156           Company Number
     C                     MOVELWBR3CD    WL0157    P      Department Code
     C                     MOVELWBEWAA    WL0158    P      Production Line
     C                     Z-ADDWBELDT    WL0159           Production Date
     C                     MOVELWBN3SX    WL0160    P      Production Shif
     C                     MOVELWBE4AA    WL0161    P      Yld Component C
     C                     Z-ADDWN0072    WL0162           YDL Yld Mix Per
     C                     Z-ADDWN0073    WL0163           YDL Yld Standar
     C                     Z-ADDWN0074    WL0164           YDL Yld Weight
     C                     MOVELWBRISX    WL0165    P      YDL Component G
     C                     MOVELWBRJSX    WL0166    P      YDL Unused Sts
     C                     MOVELWBRKSX    WL0167    P      YDL Unused Sts
     C                     EXSR SYCHRC
      * Save TRIM for later
      * CASE:
      *  - (c1ANDc2ANDc3) OR (c4ANDc5ANDc6)
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Skinless
      *   |- c3    : DB1.Yld Component Code is Trim Yield
      *   |- c4    : DB1.Department Code is Loin Boning
      *   |- c5    : DB1.Production Line Code is Boning
      *   |- c6    : DB1.Yld Component Code is Pork Loin Trimmings
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WBR3CD    IFEQ 'BELLY'                    *IF
     C           WBEWAA    IFEQ @CN,009                    *IF
     C           WBE4AA    IFEQ @CN,027                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WBR3CD    IFEQ 'LOINS'                    *IF
     C           WBEWAA    IFEQ @CN,013                    *IF
     C           WBE4AA    IFEQ @CN,028                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDWN0072    YL0028           YDL Yld Mix Per
     C                     END                             *FI
     C           KRSSQ     READE@C0CPRL                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE:
      *  - (c1ANDc2)OR(c3ANDc4)
      *   |- c1    : PAR.Department Code is Belly
      *   |- c2    : PAR.Production Line Code is Skinless
      *   |- c3    : PAR.Department Code is Loin Boning
      *   |- c4    : PAR.Production Line Code is Boning
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WL0091    IFEQ 'BELLY'                    *IF
     C           WL0092    IFEQ @CN,009                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WL0091    IFEQ 'LOINS'                    *IF
     C           WL0092    IFEQ @CN,013                    *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Department Code is Belly
     C           WL0091    IFEQ 'BELLY'                    *IF
     C                     MOVEL@CN,027   YL0029           Yld Component C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL@CN,028   YL0029           Yld Component C
     C                     END                             *FI
      * std% = 1 - sum(other comp. std%)
      * Rtv Std %, OMT Trim   RT - Yld Daily Line Yld Comp  * 
     C                     EXSR SZRVGN
     C           100       SUB  YL0030    WN0073           YDL Yld Standar
      * Actual - Std Weight Diff
      * CASE: PAR.YDL Yld Standard Pct is Greater than zero
     C           WN0073    IFGT *ZERO                      *IF
      * Compute: yld weight diff
      * PAR.YDL Yld Weight Diff =
      *    *COMPUTE ((x1/x4*x2) - (x3/x4*x2))
      * x1    : LCL.YDL Yld Mix Percent 1
      * /     : PGM.*Synon (15,5) work field *
      * x4    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Total Line Weight
      * -     : PGM.*Synon (15,2) work field
      * x3    : PAR.YDL Yld Standard Pct
      * /     : PGM.*Synon (15,5) work field *
      * x4    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.Total Line Weight
     C           YL0028    DIV  100       W0WB02           *Synon (15,5) w
     C           W0WB02    MULT WL0095    W0WA01    H      *Synon (15,2) w
     C           WN0073    DIV  100       W0WB04           *Synon (15,5) w
     C           W0WB04    MULT WL0095    W0WA03    H      *Synon (15,2) w
     C           W0WA01    SUB  W0WA03    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0074           YDL Yld Weight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WN0074           YDL Yld Weight
     C                     END                             *FI
      * Chg Mix Percent       CH - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWL0090    WL0156           Company Number
     C                     MOVELWL0091    WL0157    P      Department Code
     C                     MOVELWL0092    WL0158    P      Production Line
     C                     Z-ADDWL0093    WL0159           Production Date
     C                     MOVELWL0094    WL0160    P      Production Shif
     C                     MOVELYL0029    WL0161    P      Yld Component C
     C                     Z-ADDYL0028    WL0162           YDL Yld Mix Per
     C                     Z-ADDWN0073    WL0163           YDL Yld Standar
     C                     Z-ADDWN0074    WL0164           YDL Yld Weight
     C                     MOVELWN0075    WL0165    P      YDL Component G
     C                     MOVELWN0076    WL0166    P      YDL Unused Sts
     C                     MOVELWN0077    WL0167    P      YDL Unused Sts
     C                     EXSR SYCHRC
     C                     END                             *FI
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv Skinls Fin Std    RT - Yld Prod Line Comp Sel  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WL0105           Unused Weight R
     C                     Z-ADD*ZERO     WL0106           Weight Prod 2 U
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSR01           Company Number
     C           *LIKE     DEFN WDR3CD    WQSR02           Department Code
     C           *LIKE     DEFN WDEWAA    WQSR03           Production Line
     C           *LIKE     DEFN WDE4AA    WQSR04           Yld Component C
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           Company Number
     C                     KFLD           WQSR02           Department Code
     C                     KFLD           WQSR03           Production Line
     C                     KFLD           WQSR04           Yld Component C
      * Setup key
     C                     Z-ADDWL0096    WQSR01           Company Number
     C                     MOVELWL0097    WQSR02           Department Code
     C                     MOVELWL0098    WQSR03           Production Line
     C                     MOVELWL0099    WQSR04           Yld Component C
      * Establish starting position
     C           KRSSR     SETLL@AQREJX                    *
     C           KRSSR     READE@AQREJX                  90*
      * Data record not found
     C   90                MOVEL'USR3710' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Skinls Fin Std    RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0107           Company Number
     C                     MOVELWDR3CD    WL0108    P      Department Code
     C                     MOVELWDEWAA    WL0109    P      Production Line
     C                     Z-ADDWL0100    WL0110           Production Date
     C                     MOVELWL0101    WL0111    P      Production Shif
     C                     MOVELWL0102    WL0112    P      Credit Item Inc
     C                     MOVELWDO8SX    WL0113    P      Type Inc/Exc St
     C                     Z-ADDWDRGNB    WL0114           Item Structure
     C                     MOVELWDO9SX    WL0115    P      Group Inc/Exc S
     C                     Z-ADDWDRHNB    WL0116           Item Structure
     C                     MOVELWDPASX    WL0117    P      Class Inc/Exc S
     C                     Z-ADDWDRINB    WL0118           Item Structure
     C                     Z-ADDWL0103    WL0120           Start Weight
     C                     Z-ADDWL0105    WL0121           Unused Weight R
     C                     Z-ADDWL0106    WL0122           Weight Prod 2 U
     C                     EXSR SSRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0119    WL0104           YDL Yld Standar
     C                     Z-ADDWL0121    WL0105           Unused Weight R
     C                     Z-ADDWL0122    WL0106           Weight Prod 2 U
     C           KRSSR     READE@AQREJX                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: PAR.Unused Weight Rate 1 is Greater than zero
     C           WL0105    IFGT *ZERO                      *IF
      * Compute:Std Pct
      * PAR.YDL Yld Standard Pct =
      *    *COMPUTE ((x2 / x1) * x3)
      * x2    : PAR.Weight Prod 2 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x1    : PAR.Unused Weight Rate 1
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WL0106    DIV  WL0105    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0104           YDL Yld Standar
     C                     END                             *FI
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Skinls Fin Std    RT - Yld Detail Transaction  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0011           Unused Weight R
     C                     Z-ADD*ZERO     YL0012           Weight Prod 2 U
     C                     Z-ADD*ZERO     WL0119           YDL Yld Standar
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSS01           Company Number
     C           *LIKE     DEFN WMR3CD    WQSS02           Department Code
     C           *LIKE     DEFN WMEWAA    WQSS03           Production Line
     C           *LIKE     DEFN WMELDT    WQSS04           Production Date
     C           *LIKE     DEFN WMN3SX    WQSS05           Production Shif
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WQSS01           Company Number
     C                     KFLD           WQSS02           Department Code
     C                     KFLD           WQSS03           Production Line
     C                     KFLD           WQSS04           Production Date
     C                     KFLD           WQSS05           Production Shif
      * Setup key
     C                     Z-ADDWL0107    WQSS01           Company Number
     C                     MOVELWL0108    WQSS02           Department Code
     C                     MOVELWL0109    WQSS03           Production Line
     C                     Z-ADDWL0110    WQSS04           Production Date
     C                     MOVELWL0111    WQSS05           Production Shif
      * Establish starting position
     C           KRSSS     SETLL@CPCPPX                    *
     C           KRSSS     READE@CPCPPX                  90*
      * Data record not found
     C   90                MOVEL'USR3217' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * SEL:  Credit Items
      * CASE: PAR.Credit Item Inc/Exc Sts is Entered
     C           WL0112    IFEQ 'E'                        *IF
     C           WL0112    OREQ 'I'
      * CASE: PAR.Credit Item Inc/Exc Sts is Include
     C           WL0112    IFEQ 'I'                        *IF
      * CASE: DB1.Credit Item Status is no
     C           WMVMST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Credit Item Inc/Exc Sts is Exclude
     C           WL0112    IFEQ 'E'                        *IF
      * CASE: DB1.Credit Item Status is yes
     C           WMVMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Type
      * CASE: PAR.Item Structure Type Code is Entered
     C           WL0114    IFNE *ZERO                      *IF
      * CASE: PAR.Type Inc/Exc Sts is Include
     C           WL0113    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Type Code NE DB1.Item Structure Type Cod
     C           WL0114    IFNE WMRGNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Type Inc/Exc Sts is Exclude
     C           WL0113    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Type Code EQ DB1.Item Structure Type Cod
     C           WL0114    IFEQ WMRGNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Group
      * CASE: PAR.Item Structure Group Code is Entered
     C           WL0116    IFNE *ZERO                      *IF
      * CASE: PAR.Group Inc/Exc Sts is Include
     C           WL0115    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Group Code NE DB1.Item Structure Group C
     C           WL0116    IFNE WMRHNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Group Inc/Exc Sts is Exclude
     C           WL0115    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Group Code EQ DB1.Item Structure Group C
     C           WL0116    IFEQ WMRHNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Class
      * CASE: PAR.Item Structure Class Code is Entered
     C           WL0118    IFNE *ZERO                      *IF
      * CASE: PAR.Class Inc/Exc Sts is Include
     C           WL0117    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Class Code NE DB1.Item Structure Class C
     C           WL0118    IFNE WMRINB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Class Inc/Exc Sts is Exclude
     C           WL0117    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Class Code EQ DB1.Item Structure Class C
     C           WL0118    IFEQ WMRINB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Rtv Item Sales Yield  RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0123           Company Number
     C                     Z-ADDWMHGCD    WL0124           Item Code
     C                     Z-ADDWMHGCD    WL0125           Component Item
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0126    YL0013           Sales Yield
      * Loin Boning : Calc 80025 Sales Yld from wgt, pieces, and avg zone
      * CASE: DB1.Item Code is Bone Ls Loin
     C           WMHGCD    IFEQ 80025                      *IF
      * Rtv Bone In Zone Wgt  RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0127           Company Number
     C                     MOVELWMR3CD    WL0128    P      Department Code
     C                     MOVELWMEWAA    WL0129    P      Production Line
     C                     Z-ADDWMELDT    WL0130           Production Date
     C                     MOVELWMN3SX    WL0131    P      Production Shif
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0132    YL0014           Bone In Zone Av
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Yld Transaction Pieces is NE Zeros
      *   |- c2    : LCL.Bone In Zone Avg Loin Wgt is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WMXDNX    IFNE *ZERO                      *IF
     C           YL0014    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 80025 Sales Yield
      * LCL.Sales Yield =
      *    *COMPUTE (((x1 / x2) / x3) * x4)
      * x1    : DB1.Yld Transaction Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Yld Transaction Pieces
      * /     : PGM.*Synon (17,7) work field *
      * x3    : LCL.Bone In Zone Avg Loin Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x4    : CON.100
     C           WMJSWG    DIV  WMXDNX    W0WD02    H      *Synon (17,7) w
     C           W0WD02    DIV  YL0014    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Sales Yield
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1ANDc2ANDc3
      *   |- c1    : DB1.Department Code is Belly
      *   |- c2    : DB1.Production Line Code is Skinless
      *   |- c3    : DB1.Item Code is Belly
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WMR3CD    IFEQ 'BELLY'                    *IF
     C           WMEWAA    IFEQ @CN,009                    *IF
     C           WMHGCD    IFEQ 57150                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Adjust belly item 57150 with Heavy Bellies WIP item 2320 deletes
      * Rtv Del Pend f/1 Item RT - Yld Inventory Balance  * 
     C                     EXSR SVRVGN
      * Compute:total SW
      * LCL.Weight Prod 1 USR =
      *    *COMPUTE (((x1 -(x2*x3))/(x4/x5))+x2)
      * x1    : DB1.Yld Transaction Weight
      * -     : PGM.*Synon (17,7) work field
      * x2    : LCL.Delete Pending Wgt
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : CON..77
      * /     : PGM.*Synon (17,7) work field *
      * x4    : LCL.Sales Yield
      * /     : PGM.*Synon (17,7) work field *
      * x5    : CON.100
      * +     : PGM.*Synon (17,7) work field
      * x2    : LCL.Delete Pending Wgt
     C           YL0015    MULT .77       W0WD03           *Synon (17,7) w
     C           WMJSWG    SUB  W0WD03    W0WD02           *Synon (17,7) w
     C           YL0013    DIV  100       W0WD04           *Synon (17,7) w
     C           W0WD02    DIV  W0WD04    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  YL0015    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0016           Weight Prod 1 U
      * Adj Sales Yld for 57150
      * LCL.Sales Yield =
      *    *COMPUTE (x1/x2*x3)
      * x1    : DB1.Yld Transaction Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : LCL.Weight Prod 1 USR
      * *     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
     C           WMJSWG    DIV  YL0016    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Sales Yield
      * SUM(Standard Start Weight)
      * CASE: LCL.Sales Yield is not equal to zeros
     C           YL0013    IFNE *ZERO                      *IF
      * Accum Sales Yld for items
      * LCL.Unused Weight Rate 1 =
      *    *COMPUTE ((x2/(x1/x4))+x3)
      * x2    : DB1.Yld Transaction Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x1    : LCL.Sales Yield
      * /     : PGM.*Synon (15,5) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (15,5) work field
      * x3    : LCL.Unused Weight Rate 1
     C           YL0013    DIV  100       W0WB02           *Synon (15,5) w
     C           WMJSWG    DIV  W0WB02    W0WB01    H      *Synon (15,5) w
     C           W0WB01    ADD  YL0011    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0011           Unused Weight R
     C                     END                             *FI
     C                     ADD  WMJSWG    YL0012           Weight Prod 2 U
     C                     ELSE
      * CASE: *OTHERWISE
      * SUM(Standard Start Weight)
      * CASE: LCL.Sales Yield is not equal to zeros
     C           YL0013    IFNE *ZERO                      *IF
      * Accum Sales Yld for items
      * LCL.Weight Rate 1 =
      *    *COMPUTE ((x2/(x1/x4))+x3)
      * x2    : DB1.Yld Transaction Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x1    : LCL.Sales Yield
      * /     : PGM.*Synon (15,5) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (15,5) work field
      * x3    : LCL.Unused Weight Rate 1
     C           YL0013    DIV  100       W0WB02           *Synon (15,5) w
     C           WMJSWG    DIV  W0WB02    W0WB01    H      *Synon (15,5) w
     C           W0WB01    ADD  YL0011    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    YL0011           Unused Weight R
     C                     END                             *FI
     C                     ADD  WMJSWG    YL0012           Weight Prod 2 U
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSS     READE@CPCPPX                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Unused Weight Rate 1 is Greater than zero
     C           YL0011    IFGT *ZERO                      *IF
      * Compute:Std Pct
      * PAR.YDL Yld Standard Pct =
      *    *COMPUTE ((x2 / x1) * x3)
      * x2    : LCL.Weight Prod 2 USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x1    : LCL.Unused Weight Rate 1
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           YL0012    DIV  YL0011    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0119           YDL Yld Standar
     C                     END                             *FI
     C                     ADD  YL0011    WL0121           Unused Weight R
     C                     ADD  YL0012    WL0122           Weight Prod 2 U
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Item Sales Yield  RT - Item Bill Of Material  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WOAIC3           Company Number
     C                     KFLD           WOHGCD           Item Code
     C                     KFLD           WOC9NB           Component Item
      * Setup key
     C                     Z-ADDWL0123    WOAIC3           Company Number
     C                     Z-ADDWL0124    WOHGCD           Item Code
     C                     Z-ADDWL0125    WOC9NB           Component Item
      * Establish starting position
     C           KRSST     CHAIN@IOREBP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1679' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0126           Sales Yield
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOBOPR    WL0126           Sales Yield
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Bone In Zone Wgt  RT - Yld Daily Line Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHR3CD           Department Code
     C                     KFLD           WHEWAA           Production Line
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHN3SX           Production Shif
      * Setup key
     C                     Z-ADDWL0127    WHAIC3           Company Number
     C                     MOVELWL0128    WHR3CD           Department Code
     C                     MOVELWL0129    WHEWAA           Production Line
     C                     Z-ADDWL0130    WHELDT           Production Date
     C                     MOVELWL0131    WHN3SX           Production Shif
      * Establish starting position
     C           KRSSU     CHAIN@CSCPQJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3223' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0132           Bone In Zone Av
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHMEWG    WL0132           Bone In Zone Av
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Del Pend f/1 Item RT - Yld Inventory Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRAIC3    WQSV01           Company Number
     C           *LIKE     DEFN WRR3CD    WQSV02           Department Code
     C           *LIKE     DEFN WREWAA    WQSV03           Production Line
     C           *LIKE     DEFN WRELDT    WQSV04           Production Date
     C           *LIKE     DEFN WRN3SX    WQSV05           Production Shif
     C           *LIKE     DEFN WRHGCD    WQSV06           Item Code
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Company Number
     C                     KFLD           WQSV02           Department Code
     C                     KFLD           WQSV03           Production Line
     C                     KFLD           WQSV04           Production Date
     C                     KFLD           WQSV05           Production Shif
     C                     KFLD           WQSV06           Item Code
      * Setup key
     C                     Z-ADDWMAIC3    WQSV01           Company Number
     C                     MOVE *BLANK    WQSV02           Department Code
     C                     MOVEL'CUT'     WQSV02           Department Code
     C                     MOVE *BLANK    WQSV03           Production Line
     C                     MOVEL'BELLY'   WQSV03           Production Line
     C                     Z-ADDWMELDT    WQSV04           Production Date
     C                     MOVELWMN3SX    WQSV05           Production Shif
     C                     Z-ADD2320      WQSV06           Item Code
      * Establish starting position
     C           KRSSV     SETLL@COCPQA                    *
     C           KRSSV     READE@COCPQA                  90*
      * Data record not found
     C   90                MOVEL'USR3215' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WRJXWG    YL0015           Delete Pending
     C           KRSSV     READE@COCPQA                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv Loin Bng Ined Std RT - Yld Prod Line Comp Sel  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDAIC3    WQSW01           Company Number
     C           *LIKE     DEFN WDR3CD    WQSW02           Department Code
     C           *LIKE     DEFN WDEWAA    WQSW03           Production Line
     C           *LIKE     DEFN WDE4AA    WQSW04           Yld Component C
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           Company Number
     C                     KFLD           WQSW02           Department Code
     C                     KFLD           WQSW03           Production Line
     C                     KFLD           WQSW04           Yld Component C
      * Setup key
     C                     Z-ADDWL0133    WQSW01           Company Number
     C                     MOVELWL0134    WQSW02           Department Code
     C                     MOVELWL0135    WQSW03           Production Line
     C                     MOVELWL0136    WQSW04           Yld Component C
      * Establish starting position
     C           KRSSW     SETLL@AQREJX                    *
     C           KRSSW     READE@AQREJX                  90*
      * Data record not found
     C   90                MOVEL'USR3710' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Loin Bng Ined Std RT - Yld Detail Transaction  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWDAIC3    WL0142           Company Number
     C                     MOVELWDR3CD    WL0143    P      Department Code
     C                     MOVELWDEWAA    WL0144    P      Production Line
     C                     Z-ADDWL0137    WL0145           Production Date
     C                     MOVELWL0138    WL0146    P      Production Shif
     C                     MOVELWL0139    WL0147    P      Credit Item Inc
     C                     MOVELWDO8SX    WL0148    P      Type Inc/Exc St
     C                     Z-ADDWDRGNB    WL0149           Item Structure
     C                     MOVELWDO9SX    WL0150    P      Group Inc/Exc S
     C                     Z-ADDWDRHNB    WL0151           Item Structure
     C                     MOVELWDPASX    WL0152    P      Class Inc/Exc S
     C                     Z-ADDWDRINB    WL0153           Item Structure
     C                     Z-ADDWL0140    WL0154           Weight Prod 1 U
     C                     Z-ADDWL0141    WL0155           Weight Prod 2 U
     C                     EXSR SXRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0154    WL0140           Weight Prod 1 U
     C                     Z-ADDWL0155    WL0141           Weight Prod 2 U
     C           KRSSW     READE@AQREJX                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv Loin Bng Ined Std RT - Yld Detail Transaction  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WMR3CD    WQSX02           Department Code
     C           *LIKE     DEFN WMEWAA    WQSX03           Production Line
     C           *LIKE     DEFN WMELDT    WQSX04           Production Date
     C           *LIKE     DEFN WMN3SX    WQSX05           Production Shif
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Department Code
     C                     KFLD           WQSX03           Production Line
     C                     KFLD           WQSX04           Production Date
     C                     KFLD           WQSX05           Production Shif
      * Setup key
     C                     Z-ADDWL0142    WQSX01           Company Number
     C                     MOVELWL0143    WQSX02           Department Code
     C                     MOVELWL0144    WQSX03           Production Line
     C                     Z-ADDWL0145    WQSX04           Production Date
     C                     MOVELWL0146    WQSX05           Production Shif
      * Establish starting position
     C           KRSSX     SETLL@CPCPPX                    *
     C           KRSSX     READE@CPCPPX                  90*
      * Data record not found
     C   90                MOVEL'USR3217' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * SEL:  Credit Items
      * CASE: PAR.Credit Item Inc/Exc Sts is Entered
     C           WL0147    IFEQ 'E'                        *IF
     C           WL0147    OREQ 'I'
      * CASE: PAR.Credit Item Inc/Exc Sts is Include
     C           WL0147    IFEQ 'I'                        *IF
      * CASE: DB1.Credit Item Status is no
     C           WMVMST    IFEQ 'N'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Credit Item Inc/Exc Sts is Exclude
     C           WL0147    IFEQ 'E'                        *IF
      * CASE: DB1.Credit Item Status is yes
     C           WMVMST    IFEQ 'Y'                        *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Type
      * CASE: PAR.Item Structure Type Code is Entered
     C           WL0149    IFNE *ZERO                      *IF
      * CASE: PAR.Type Inc/Exc Sts is Include
     C           WL0148    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Type Code NE DB1.Item Structure Type Cod
     C           WL0149    IFNE WMRGNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Type Inc/Exc Sts is Exclude
     C           WL0148    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Type Code EQ DB1.Item Structure Type Cod
     C           WL0149    IFEQ WMRGNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Group
      * CASE: PAR.Item Structure Group Code is Entered
     C           WL0151    IFNE *ZERO                      *IF
      * CASE: PAR.Group Inc/Exc Sts is Include
     C           WL0150    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Group Code NE DB1.Item Structure Group C
     C           WL0151    IFNE WMRHNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Group Inc/Exc Sts is Exclude
     C           WL0150    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Group Code EQ DB1.Item Structure Group C
     C           WL0151    IFEQ WMRHNB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * SEL:  Class
      * CASE: PAR.Item Structure Class Code is Entered
     C           WL0153    IFNE *ZERO                      *IF
      * CASE: PAR.Class Inc/Exc Sts is Include
     C           WL0152    IFEQ 'I'                        *IF
      * CASE: PAR.Item Structure Class Code NE DB1.Item Structure Class C
     C           WL0153    IFNE WMRINB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Class Inc/Exc Sts is Exclude
     C           WL0152    IFEQ 'E'                        *IF
      * CASE: PAR.Item Structure Class Code EQ DB1.Item Structure Class C
     C           WL0153    IFEQ WMRINB                     *IF
     C                     MOVEL'N'       W0RSL            *Record selecte
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: PGM.*Record selected is *YES
     C           W0RSL     IFEQ 'Y'                        *IF
      * Sales Yield
      * CASE: DB1.Item Code is Bone Ls Loin
     C           WMHGCD    IFEQ 80025                      *IF
      * Rtv Bone In Zone Wgt  RT - Yld Daily Line Header  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0127           Company Number
     C                     MOVELWMR3CD    WL0128    P      Department Code
     C                     MOVELWMEWAA    WL0129    P      Production Line
     C                     Z-ADDWMELDT    WL0130           Production Date
     C                     MOVELWMN3SX    WL0131    P      Production Shif
     C                     EXSR SURVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0132    YL0026           Bone In Zone Av
      * CASE:
      *  - c1ANDc2
      *   |- c1    : DB1.Yld Transaction Pieces is NE Zeros
      *   |- c2    : LCL.Bone In Zone Avg Loin Wgt is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WMXDNX    IFNE *ZERO                      *IF
     C           YL0026    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * 80025 Sales Yield
      * LCL.Sales Yield =
      *    *COMPUTE (((x1 / x2) / x3) * x4)
      * x1    : DB1.Yld Transaction Weight
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Yld Transaction Pieces
      * /     : PGM.*Synon (17,7) work field *
      * x3    : LCL.Bone In Zone Avg Loin Wgt
      * *     : PGM.*Synon (15,2) work field *
      * x4    : CON.100
     C           WMJSWG    DIV  WMXDNX    W0WD02    H      *Synon (17,7) w
     C           W0WD02    DIV  YL0026    W0WD01           *Synon (17,7) w
     C           W0WD01    MULT 100       W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0027           Sales Yield
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Item Sales Yield  RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0123           Company Number
     C                     Z-ADDWMHGCD    WL0124           Item Code
     C                     Z-ADDWMHGCD    WL0125           Component Item
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0126    YL0027           Sales Yield
     C                     END                             *FI
      * CASE: LCL.Sales Yield is not equal to zeros
     C           YL0027    IFNE *ZERO                      *IF
      * Compute:Std wt
      * WRK.Weight Rate 1 =
      *    *COMPUTE (x1 /(x2/x3))
      * x1    : DB1.Yld Transaction Weight
      * /     : WRK.Weight Rate 1 = DB1.Yld Transaction Weight / LCL.Sale
      * x2    : LCL.Sales Yield
      * /     : PGM.*Synon (17,7) work field *
      * x3    : CON.100
     C           YL0027    DIV  100       W0WD00           *Synon (17,7) w
     C           WMJSWG    DIV  W0WD00    WUB2PR    H      Unused Weight R
     C                     Z-ADDWUB2PR    WUB2PR           Unused Weight R
     C                     END                             *FI
      * Rtv Item Sales Yield  RT - Item Bill Of Material  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0123           Company Number
     C                     Z-ADDWMHGCD    WL0124           Item Code
     C                     Z-ADD96309     WL0125           Component Item
     C                     EXSR STRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0126    YL0027           Sales Yield
      * CASE: LCL.Sales Yield is not equal to zeros
     C           YL0027    IFNE *ZERO                      *IF
      * Accum Ined Yld for items
      * PAR.Weight Prod 1 USR =
      *    *COMPUTE ((x2*(x1/x4))+x3)
      * x2    : WRK.Unused Weight Rate 1
      * *     : PGM.*Synon (17,7) work field *
      * x1    : LCL.Sales Yield
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (15,2) work field
      * x3    : PAR.Weight Prod 1 USR
     C           YL0027    DIV  100       W0WD02           *Synon (17,7) w
     C           WUB2PR    MULT W0WD02    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WL0154    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WL0154           Weight Prod 1 U
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  WMJSWG    WL0155           Weight Prod 2 U
     C           KRSSX     READE@CPCPPX                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * Chg Mix Percent       CH - Yld Daily Line Yld Comp  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0079 112       YDL Yld Comp We
     C                     MOVEL*BLANK    WN0080  1        EDI Status 1
     C                     MOVEL*BLANK    WN0081  1        EDI Status 2
     C                     MOVEL*BLANK    WN0082  1        EDI Status 3
     C                     MOVEL*BLANK    WN0083  1        Record Status
     C                     Z-ADD*ZERO     WN0084  60       Job Time
     C                     MOVEL*BLANK    WN0085 10        User Id
     C                     MOVEL*BLANK    WN0086 10        Job Name
     C                     Z-ADD*ZERO     WN0087  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @C0CPRK
     C                     Z-ADDWL0156    WJAIC3           Company Number
     C                     MOVELWL0157    WJR3CD    P      Department Code
     C                     MOVELWL0158    WJEWAA    P      Production Line
     C                     Z-ADDWL0159    WJELDT           Production Date
     C                     MOVELWL0160    WJN3SX    P      Production Shif
     C                     MOVELWL0161    WJE4AA    P      Yld Component C
      *
     C           KLCHSY    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJR3CD           Department Code
     C                     KFLD           WJEWAA           Production Line
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJN3SX           Production Shif
     C                     KFLD           WJE4AA           Yld Component C
     C           KLCHSY    CHAIN@C0CPRK              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POC0CPL0'MDACP
     C                     MOVEL'@C0CPRK' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOC01    YCRDCS
      * Move non-key fields to @C0CPRK
     C                     Z-ADDWL0162    WJFMPC           YDL Yld Mix Per
     C                     Z-ADDWL0163    WJFOPC           YDL Yld Standar
     C                     Z-ADDWL0164    WJL2WG           YDL Yld Weight
     C                     MOVELWL0165    WJRISX    P      YDL Component G
     C                     MOVELWL0166    WJRJSX    P      YDL Unused Sts
     C                     MOVELWL0167    WJRKSX    P      YDL Unused Sts
      *
      * Set PGM.*Record Data Changed flag
     C           QPOC01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOC01    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@C0CPRK                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOC0CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Std %, OMT Trim   RT - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0030           Percent 7.4 USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGAIC3    WQSZ01           Company Number
     C           *LIKE     DEFN WGR3CD    WQSZ02           Department Code
     C           *LIKE     DEFN WGELDT    WQSZ03           Production Date
     C           *LIKE     DEFN WGN3SX    WQSZ04           Production Shif
     C           *LIKE     DEFN WGEWAA    WQSZ05           Production Line
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WQSZ01           Company Number
     C                     KFLD           WQSZ02           Department Code
     C                     KFLD           WQSZ03           Production Date
     C                     KFLD           WQSZ04           Production Shif
     C                     KFLD           WQSZ05           Production Line
      * Setup key
     C                     Z-ADDWL0090    WQSZ01           Company Number
     C                     MOVELWL0091    WQSZ02           Department Code
     C                     Z-ADDWL0093    WQSZ03           Production Date
     C                     MOVELWL0094    WQSZ04           Production Shif
     C                     MOVELWL0092    WQSZ05           Production Line
      * Establish starting position
     C           KRSSZ     SETLL@C0CPRT                    *
     C           KRSSZ     READE@C0CPRT                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Yld Component Code EQ PAR.Yld Component Code
     C           WGE4AA    IFEQ YL0029                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Department Code is Loin Boning
     C           WGR3CD    IFEQ 'LOINS'                    *IF
      * SAVE BONLESS LOIN STRAP OFF AMOUNTS    & combine with strap on
      * CASE: DB1.Yld Component Code is Boneless Loin-Strap Off
     C           WGE4AA    IFEQ @CN,024                    *IF
     C                     Z-ADDWGKKWG    YL0031           YDL Yld Comp We
     C                     Z-ADDWGFOPC    YL0032           YDL Yld Standar
     C                     ELSE
      * CASE: DB1.Yld Component Code is Boneless Loin-Strap On
     C           WGE4AA    IFEQ @CN,023                    *IF
     C           YL0031    ADD  WGKKWG    WUKKWG           YDL Yld Comp We
     C           YL0031    MULT YL0032    YL0033           Unused Weight R
     C           WGKKWG    MULT WGFOPC    YL0034           Unused Weight R
     C                     ADD  YL0034    YL0033           Unused Weight R
      * CASE: WRK.YDL Yld Comp Weight is Not equal zero
     C           WUKKWG    IFNE *ZERO                      *IF
     C           YL0033    DIV  WUKKWG    YL0032    H      YDL Yld Standar
     C                     END                             *FI
     C                     ADD  YL0032    YL0030           Percent 7.4 USR
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGFOPC    YL0030           Percent 7.4 USR
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WGFOPC    YL0030           Percent 7.4 USR
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSZ     READE@C0CPRT                  90*
     C                     ENDDO
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Finished Mix %    RT - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBR3CD           Department Code
     C                     KFLD           WBEWAA           Production Line
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBN3SX           Production Shif
     C                     KFLD           WBE4AA           Yld Component C
      * Setup key
     C                     Z-ADDP1AIC3    WBAIC3           Company Number
     C                     MOVELP1R3CD    WBR3CD           Department Code
     C                     MOVELP1EWAA    WBEWAA           Production Line
     C                     Z-ADDP1ELDT    WBELDT           Production Date
     C                     MOVELP1N3SX    WBN3SX           Production Shif
     C                     MOVEL@CN,020   WBE4AA           Yld Component C
      * Establish starting position
     C           KRSTA     CHAIN@C0CPRL              90    *
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     Z-ADDWBFMPC    P3FKPC           YDL Yld Mix Per
     C                     Z-ADDWBFOPC    P3FJPC           YDL Yld Standar
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Bnls Loin Mix %  RT - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     P3FKPC           YDL Yld Mix Per
     C                     Z-ADD*ZERO     WUJCWG           Weight Prod 1 U
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBAIC3    WQTB01           Company Number
     C           *LIKE     DEFN WBR3CD    WQTB02           Department Code
     C           *LIKE     DEFN WBEWAA    WQTB03           Production Line
     C           *LIKE     DEFN WBELDT    WQTB04           Production Date
     C           *LIKE     DEFN WBN3SX    WQTB05           Production Shif
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WQTB01           Company Number
     C                     KFLD           WQTB02           Department Code
     C                     KFLD           WQTB03           Production Line
     C                     KFLD           WQTB04           Production Date
     C                     KFLD           WQTB05           Production Shif
      * Setup key
     C                     Z-ADDP1AIC3    WQTB01           Company Number
     C                     MOVELP1R3CD    WQTB02           Department Code
     C                     MOVELP1EWAA    WQTB03           Production Line
     C                     Z-ADDP1ELDT    WQTB04           Production Date
     C                     MOVELP1N3SX    WQTB05           Production Shif
      * Establish starting position
     C           KRSTB     SETLL@C0CPRL                    *
     C           KRSTB     READE@C0CPRL                  90*
      * Data record not found
     C   90                MOVEL'USR3264' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.Yld Component Code is Boneless Loin-Strap Off
      *   |- c2    : DB1.Yld Component Code is Boneless Loin-Strap On
      *   '-
     C           WBE4AA    IFEQ @CN,024                    *IF
     C           WBE4AA    OREQ @CN,023                    *OR
      * Computed:for wghtd Std%
      * WRK.Unused Weight Rate 2 =
      *    *COMPUTE ((x1 * (x2/x4)) + x3)
      * x1    : DB1.YDL Yld Comp Weight
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : DB1.YDL Yld Standard Pct
      * /     : PGM.*Synon (17,7) work field *
      * x4    : CON.100
      * +     : PGM.*Synon (15,5) work field
      * x3    : WRK.Unused Weight Rate 2
     C           WBFOPC    DIV  100       W0WD02           *Synon (17,7) w
     C           WBKKWG    MULT W0WD02    W0WB01    H      *Synon (15,5) w
     C           W0WB01    ADD  WUB3PR    W0WB00           *Synon (15,5) w
     C                     Z-ADDW0WB00    WUB3PR           Unused Weight R
     C                     ADD  WBKKWG    WUJCWG           Weight Prod 1 U
      * Add mixed pct% together -- dont calc weighted avg.
     C                     ADD  WBFMPC    P3FKPC           YDL Yld Mix Per
     C                     END                             *FI
     C           KRSTB     READE@C0CPRL                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: WRK.Weight Prod 1 USR is Not equal zero
     C           WUJCWG    IFNE *ZERO                      *IF
      * Compute: Std pct
      * PAR.YDL Yld Standard Pct =
      *    *COMPUTE (x1 / x2 * x3)
      * x1    : WRK.Unused Weight Rate 2
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : WRK.Weight Prod 1 USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WUB3PR    DIV  WUJCWG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    P3FJPC           YDL Yld Standar
     C                     END                             *FI
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv Chg Actual Yld    RT - Yld Daily Line Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHR3CD           Department Code
     C                     KFLD           WHEWAA           Production Line
     C                     KFLD           WHELDT           Production Date
     C                     KFLD           WHN3SX           Production Shif
      * Setup key
     C                     Z-ADDP1AIC3    WHAIC3           Company Number
     C                     MOVELP1R3CD    WHR3CD           Department Code
     C                     MOVELP1EWAA    WHEWAA           Production Line
     C                     Z-ADDP1ELDT    WHELDT           Production Date
     C                     MOVELP1N3SX    WHN3SX           Production Shif
      * Establish starting position
     C           KRSTC     CHAIN@CSCPQJ              90    *
      * Data record not found
     C   90                MOVEL'USR3223' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Daily Line Header CH - Yld Daily Line Header  * 
     C                     EXSR TDCHRC
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDCHRC    BEGSR
      *================================================================
      * Chg Daily Line Header CH - Yld Daily Line Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @CSCPQI
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     MOVELWHR3CD    WIR3CD    P      Department Code
     C                     MOVELWHEWAA    WIEWAA    P      Production Line
     C                     Z-ADDWHELDT    WIELDT           Production Date
     C                     MOVELWHN3SX    WIN3SX    P      Production Shif
      *
     C           KLCHTD    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIR3CD           Department Code
     C                     KFLD           WIEWAA           Production Line
     C                     KFLD           WIELDT           Production Date
     C                     KFLD           WIN3SX           Production Shif
     C           KLCHTD    CHAIN@CSCPQI              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POCSCPL0'MDACP
     C                     MOVEL'@CSCPQI' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TDEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOCS1    YDRDCS
      * Move non-key fields to @CSCPQI
     C                     Z-ADDWHJ3WG    WIJ3WG           Start Weight
     C                     Z-ADDWHW6NX    WIW6NX           Start Pieces
     C                     Z-ADDWHJ6WG    WIJ6WG           Ending Weight
     C                     Z-ADDWHJ4WG    WIJ4WG           Converting Star
     C                     Z-ADDWHJ5WG    WIJ5WG           Converting End
     C                     Z-ADDWHF4PC    WIF4PC           Pct Pieces Conv
     C                     Z-ADDP3KOWG    WIKOWG           Total Line Weig
     C                     Z-ADDP3FJPC    WIFJPC           Production Stan
     C                     Z-ADDP3FKPC    WIFKPC           Actual Yield
     C                     Z-ADDP3FNPC    WIFNPC           Yield Variance
     C                     Z-ADDP3KNWG    WIKNWG           Weight Variance
     C                     MOVELWHCWT1    WICWT1    P      YDL Comment
     C                     MOVELWHOKSX    WIOKSX    P      YDL Post Status
     C                     MOVELWHONSX    WIONSX    P      YDL Process Sta
     C                     Z-ADDWHXCNX    WIXCNX           Hogs Cut
     C                     Z-ADDWHMEWG    WIMEWG           Bone In Zone Av
     C                     Z-ADDWHMFWG    WIMFWG           Bone Ls Zone St
     C                     Z-ADDWHW9NX    WIW9NX           Bone Ls Zone Pi
     C                     Z-ADDWHXANX    WIXANX           Conv: Finished
     C                     Z-ADDWHXBNX    WIXBNX           Loins Returned
     C                     Z-ADDWHMGWG    WIMGWG           Start Wgt Retur
     C                     Z-ADDWHMHWG    WIMHWG           YDLH Unused Wgt
     C                     MOVELWHUVST    WIUVST    P      EDI Status 1
     C                     MOVELWHUWST    WIUWST    P      EDI Status 2
     C                     MOVELWHUXST    WIUXST    P      EDI Status 3
     C                     MOVELWHVSST    WIVSST    P      Record Status
     C                     Z-ADDWHAATM    WIAATM           Job Time
     C                     MOVELWHAYNA    WIAYNA    P      User Id
     C                     MOVELWHA0NA    WIA0NA    P      Job Name
     C                     Z-ADDWHAXDT    WIAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPOCS1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOCS1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@CSCPQI                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOCSCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Exc Calc Dept Yield   RT - Yld Daily Line Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0088  52       Production Stan
     C                     Z-ADD*ZERO     WN0089  52       Actual Yield
     C                     Z-ADD*ZERO     WN0090  52       Yield Variance
     C                     Z-ADD*ZERO     WN0091 112       Weight Variance
     C                     Z-ADD*ZERO     WN0092 112       Wgt Total USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Rtv Dept Std Yield    RT - Production Line Std Yld  * 
     C                     EXSR TFRVGN
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSAIC3    WQTE01           Company Number
     C           *LIKE     DEFN WSR3CD    WQTE02           Department Code
     C           *LIKE     DEFN WSELDT    WQTE03           Production Date
     C           *LIKE     DEFN WSN3SX    WQTE04           Production Shif
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           WQTE01           Company Number
     C                     KFLD           WQTE02           Department Code
     C                     KFLD           WQTE03           Production Date
     C                     KFLD           WQTE04           Production Shif
      * Setup key
     C                     Z-ADDP1AIC3    WQTE01           Company Number
     C                     MOVELP1R3CD    WQTE02           Department Code
     C                     Z-ADDP1ELDT    WQTE03           Production Date
     C                     MOVELP1N3SX    WQTE04           Production Shif
      * Establish starting position
     C           KRSTE     SETLL@CSCPRV                    *
     C           KRSTE     READE@CSCPRV                  90*
      * Data record not found
     C   90                MOVEL'USR3223' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WSKOWG    WN0092           Wgt Total USR
     C           KRSTE     READE@CSCPRV                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Wgt Total USR is Greater than zero
      *   |- c2    : PAR.Cold Weight is Greater than zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0092    IFGT *ZERO                      *IF
     C           P2J1WG    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Actual Yield
      * PAR.Actual Yield =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.Wgt Total USR
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.Cold Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WN0092    DIV  P2J1WG    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0089           Actual Yield
     C           WN0089    SUB  WN0088    WN0090           Yield Variance
      * Weight Variance
      * PAR.Weight Variance =
      *    *COMPUTE (x1 - (x2 * (x3 / x4)))
      * x1    : PAR.Wgt Total USR
      * -     : PGM.*Synon (15,2) work field
      * x2    : PAR.Cold Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Production Standard Yld%
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           WN0088    DIV  100       W0WB02    H      *Synon (15,5) w
     C           P2J1WG    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           WN0092    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0091           Weight Variance
      * Upd Actual Yield Info RT - Yld Daily Dept Header  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Dept Std Yield    RT - Production Line Std Yld  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0088           Production Stan
     C                     MOVEL'Y'       YL0036           First Time Flag
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTAIC3    WQTF01           Company Number
     C           *LIKE     DEFN WTR3CD    WQTF02           Department Code
      * Define keylist
     C           KPSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Department Code
     C                     KFLD           WTAUDT           Effective Date
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           WQTF01           Company Number
     C                     KFLD           WQTF02           Department Code
      * Setup key
     C                     Z-ADDP1AIC3    WQTF01           Company Number
     C                     MOVELP1R3CD    WQTF02           Department Code
     C                     Z-ADDP1ELDT    WTAUDT           Effective Date
      * Establish starting position
     C           KPSTF     SETLL@C2CPR0                    *
     C           KRSTF     READE@C2CPR0                  90*
      * Data record not found
     C   90                MOVEL'USR3272' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * First Time
      * CASE: LCL.First Time Flag is Yes
     C           YL0036    IFEQ 'Y'                        *IF
     C                     Z-ADDWTAUDT    YL0037           Effective Date
     C                     MOVEL'N'       YL0036           First Time Flag
     C                     END                             *FI
      * Date Changed
      * CASE: LCL.Effective Date NE DB1.Effective Date
     C           YL0037    IFNE WTAUDT                     *IF
     C                     GOTO TFEXIT                     *QUIT
     C                     END                             *FI
     C                     Z-ADDWTFJPC    YL0038           Production Stan
      * CASE: LCL.Production Standard Yld% is equal to zero
     C           YL0038    IFEQ *ZERO                      *IF
      * Rtv Line Std Yield    RT - Production Line Std Yld  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDP1AIC3    WL0085           Company Number
     C                     MOVELP1R3CD    WL0086    P      Department Code
     C                     MOVELWTEWAA    WL0087    P      Production Line
     C                     Z-ADDP1ELDT    WL0088           Effective Date
     C                     Z-ADDYL0038    WL0089           Production Stan
     C                     EXSR SPRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0089    YL0038           Production Stan
     C                     END                             *FI
     C                     ADD  YL0038    WN0088           Production Stan
     C           KRSTF     READE@C2CPR0                  90*
     C                     ENDDO
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Upd Actual Yield Info RT - Yld Daily Dept Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAR3CD           Department Code
     C                     KFLD           WAELDT           Production Date
     C                     KFLD           WAN3SX           Production Shif
      * Setup key
     C                     Z-ADDP1AIC3    WAAIC3           Company Number
     C                     MOVELP1R3CD    WAR3CD           Department Code
     C                     Z-ADDP1ELDT    WAELDT           Production Date
     C                     MOVELP1N3SX    WAN3SX           Production Shif
      * Establish starting position
     C           KRSTG     CHAIN@CRCPQG              90    *
      * Data record not found
     C   90                MOVEL'USR3221' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Actual Yield Info CH - Yld Daily Dept Header  * 
     C                     EXSR THCHRC
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Chg Actual Yield Info CH - Yld Daily Dept Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0093  50       Head Cut
     C                     Z-ADD*ZERO     WN0094 112       Cold Weight
     C                     Z-ADD*ZERO     WN0095  52       Avg Cold Weight
     C                     Z-ADD*ZERO     WN0096 112       Start Weight
     C                     MOVEL*BLANK    WN0097  1        YDH Post Status
     C                     MOVEL*BLANK    WN0098  1        EDI Status 1
     C                     MOVEL*BLANK    WN0099  1        EDI Status 2
     C                     MOVEL*BLANK    WN0100  1        EDI Status 3
     C                     MOVEL*BLANK    WN0101  1        Record Status
     C                     Z-ADD*ZERO     WN0102  60       Job Time
     C                     MOVEL*BLANK    WN0103 10        User Id
     C                     MOVEL*BLANK    WN0104 10        Job Name
     C                     Z-ADD*ZERO     WN0105  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @CRCPQF
     C                     Z-ADDWAAIC3    WVAIC3           Company Number
     C                     MOVELWAR3CD    WVR3CD    P      Department Code
     C                     Z-ADDWAELDT    WVELDT           Production Date
     C                     MOVELWAN3SX    WVN3SX    P      Production Shif
      *
     C           KLCHTH    KLIST
     C                     KFLD           WVAIC3           Company Number
     C                     KFLD           WVR3CD           Department Code
     C                     KFLD           WVELDT           Production Date
     C                     KFLD           WVN3SX           Production Shif
     C           KLCHTH    CHAIN@CRCPQF              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POCRCPL0'MDACP
     C                     MOVEL'@CRCPQF' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPOCR1    YERDCS
      * Move non-key fields to @CRCPQF
     C                     Z-ADDWN0088    WVFJPC           Production Stan
     C                     Z-ADDWN0089    WVFKPC           Actual Yield
     C                     Z-ADDWN0090    WVFNPC           Yield Variance
     C                     Z-ADDWN0091    WVKNWG           Weight Variance
      *
      * Set PGM.*Record Data Changed flag
     C           QPOCR1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WVAATM           Job Time
     C                     MOVEL##USR     WVAYNA           User Id
     C                     MOVEL##JOB     WVA0NA           Job Name
     C                     Z-ADD##JDT     WVAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPOCR1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@CRCPQF                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPOCRCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Rtv Upd Comp Start Wt RT - Yld Component  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WWAIC3    WQTI01           Company Number
     C           *LIKE     DEFN WWE5AA    WQTI02           Entry Departmen
     C           *LIKE     DEFN WWE6AA    WQTI03           Entry Prod Line
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Entry Departmen
     C                     KFLD           WQTI03           Entry Prod Line
      * Setup key
     C                     Z-ADDWL0168    WQTI01           Company Number
     C                     MOVELWL0169    WQTI02           Entry Departmen
     C                     MOVELWL0170    WQTI03           Entry Prod Line
      * Establish starting position
     C           KRSTI     SETLL@CYRERM                    *
     C           KRSTI     READE@CYRERM                  90*
      * Data record not found
     C   90                MOVEL'USR3260' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Start Weight      RT - Production Line Yld Comp  * 
     C                     EXSR TJRVGN
     C           KRSTI     READE@CYRERM                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Chg Start Weight      RT - Production Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXAIC3    WQTJ01           Company Number
     C           *LIKE     DEFN WXE4AA    WQTJ02           Yld Component C
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WQTJ01           Company Number
     C                     KFLD           WQTJ02           Yld Component C
      * Setup key
     C                     Z-ADDWWAIC3    WQTJ01           Company Number
     C                     MOVELWWE4AA    WQTJ02           Yld Component C
      * Establish starting position
     C           KRSTJ     SETLL@CZRERN                    *
     C           KRSTJ     READE@CZRERN                  90*
      * Data record not found
     C   90                MOVEL'USR3262' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: PAR.PLYC Type EQ DB1.PLYC Type
     C           'AC'      IFEQ WXO6SX                     *IF
      * Chg Yld Daily Wgt     RT - Yld Daily Line Yld Comp  * 
     C                     EXSR TKRVGN
     C                     END                             *FI
     C           KRSTJ     READE@CZRERN                  90*
     C                     ENDDO
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Chg Yld Daily Wgt     RT - Yld Daily Line Yld Comp  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0106  52       YDL Yld Mix Per
     C                     Z-ADD*ZERO     WN0107  52       YDL Yld Standar
     C                     Z-ADD*ZERO     WN0108 112       YDL Yld Weight
     C                     MOVEL*BLANK    WN0109  1        EDI Status 1
     C                     MOVEL*BLANK    WN0110  1        EDI Status 2
     C                     MOVEL*BLANK    WN0111  1        EDI Status 3
     C                     MOVEL*BLANK    WN0112  1        Record Status
     C                     Z-ADD*ZERO     WN0113  60       Job Time
     C                     MOVEL*BLANK    WN0114 10        User Id
     C                     MOVEL*BLANK    WN0115 10        Job Name
     C                     Z-ADD*ZERO     WN0116  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBR3CD           Department Code
     C                     KFLD           WBEWAA           Production Line
     C                     KFLD           WBELDT           Production Date
     C                     KFLD           WBN3SX           Production Shif
     C                     KFLD           WBE4AA           Yld Component C
      * Setup key
     C                     Z-ADDWXAIC3    WBAIC3           Company Number
     C                     MOVELWXR3CD    WBR3CD           Department Code
     C                     MOVELWXEWAA    WBEWAA           Production Line
     C                     Z-ADDWL0171    WBELDT           Production Date
     C                     MOVELWL0172    WBN3SX           Production Shif
     C                     MOVELWXE4AA    WBE4AA           Yld Component C
      * Establish starting position
     C           KRSTK     CHAIN@C0CPRL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3264' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Yld Daily Yld Cmp CR - Yld Daily Line Yld Comp  * 
     C                     EXSR TLCRRC
     C                     GOTO TKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Rtv Component Info    RT - Production Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0001           Company Number
     C                     MOVELWBR3CD    WL0002    P      Department Code
     C                     MOVELWBEWAA    WL0003    P      Production Line
     C                     MOVELWBE4AA    WL0004    P      Yld Component C
     C                     EXSR SCRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0005    WUO6SX    P      PLYC Type
     C                     Z-ADDWL0006    YL0039           PLYC Percent of
     C                     MOVELWL0007    WUQDNA    P      PLYC Comment
     C                     MOVELWL0008    WUPCSX    P      Credit Item Inc
     C                     MOVELWL0009    WUO8SX    P      Type Inc/Exc St
     C                     Z-ADDWL0010    WURGNB           Item Structure
     C                     MOVELWL0011    WUO9SX    P      Group Inc/Exc S
     C                     Z-ADDWL0012    WURHNB           Item Structure
     C                     MOVELWL0013    WUPASX    P      Class Inc/Exc S
     C                     Z-ADDWL0014    WURINB           Item Structure
     C                     MOVELWL0015    WUPDSX    P      YC Required Sts
     C                     MOVELWL0016    WUPESX    P      YC Component Gr
      * CASE: LCL.PLYC Percent of Weight is Greater than zero
     C           YL0039    IFGT *ZERO                      *IF
      * LCL.YDL Yld Comp Weight
      * LCL.YDL Yld Comp Weight =
      *    *COMPUTE (x1 * (x2/x3))
      * x1    : PAR.YDL Yld Comp Weight
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : LCL.PLYC Percent of Weight
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0039    DIV  100       W0WB01    H      *Synon (15,5) w
     C           WL0173    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0040           YDL Yld Comp We
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWL0173    YL0040           YDL Yld Comp We
     C                     END                             *FI
      * Chg Yld Daily Wgt     CH - Yld Daily Line Yld Comp  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWBAIC3    WL0062           Company Number
     C                     MOVELWBR3CD    WL0063    P      Department Code
     C                     MOVELWBEWAA    WL0064    P      Production Line
     C                     Z-ADDWBELDT    WL0065           Production Date
     C                     MOVELWBN3SX    WL0066    P      Production Shif
     C                     MOVELWBE4AA    WL0067    P      Yld Component C
     C                     Z-ADDYL0040    WL0068           YDL Yld Comp We
     C                     MOVELWBRISX    WL0069    P      YDL Component G
     C                     MOVELWBRJSX    WL0070    P      YDL Unused Sts
     C                     MOVELWBRKSX    WL0071    P      YDL Unused Sts
     C                     EXSR SMCHRC
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Crt Yld Daily Yld Cmp CR - Yld Daily Line Yld Comp  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @C0CPRK
     C                     Z-ADDWXAIC3    WJAIC3           Company Number
     C                     MOVELWXR3CD    WJR3CD           Department Code
     C                     MOVELWXEWAA    WJEWAA           Production Line
     C                     Z-ADDWL0171    WJELDT           Production Date
     C                     MOVELWL0172    WJN3SX           Production Shif
     C                     MOVELWXE4AA    WJE4AA           Yld Component C
     C                     Z-ADDWL0173    WJKKWG           YDL Yld Comp We
     C                     Z-ADDWN0106    WJFMPC           YDL Yld Mix Per
     C                     Z-ADDWN0107    WJFOPC           YDL Yld Standar
     C                     Z-ADDWN0108    WJL2WG           YDL Yld Weight
     C                     MOVELWURISX    WJRISX           YDL Component G
     C                     MOVELWURJSX    WJRJSX           YDL Unused Sts
     C                     MOVELWURKSX    WJRKSX           YDL Unused Sts
     C                     MOVELWN0109    WJUVST           EDI Status 1
     C                     MOVELWN0110    WJUWST           EDI Status 2
     C                     MOVELWN0111    WJUXST           EDI Status 3
     C                     MOVELWN0112    WJVSST           Record Status
     C                     Z-ADDWN0113    WJAATM           Job Time
     C                     MOVELWN0114    WJAYNA           User Id
     C                     MOVELWN0115    WJA0NA           Job Name
     C                     Z-ADDWN0116    WJAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       WJVSST           Record Status
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
     C           KLCRTL    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJR3CD           Department Code
     C                     KFLD           WJEWAA           Production Line
     C                     KFLD           WJELDT           Production Date
     C                     KFLD           WJN3SX           Production Shif
     C                     KFLD           WJE4AA           Yld Component C
      * Check for duplicate primary key
     C           KLCRTL    SETLL@C0CPRK                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3265' W0RTN   7
      * Send message 'Yld Daily Line Yld Com EX'
     C                     MOVEL'USR3265' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@C0CPRK                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2T7NX           Head Cut
     C                     Z-ADD*ZERO     P2J1WG           Cold Weight
     C                     Z-ADD*ZERO     P2J2WG           Avg Cold Weight
     C                     Z-ADD*ZERO     P3KOWG           Total Line Weig
     C                     Z-ADD*ZERO     P3FJPC           Production Stan
     C                     Z-ADD*ZERO     P3FKPC           Actual Yield
     C                     Z-ADD*ZERO     P3FNPC           Yield Variance
     C                     Z-ADD*ZERO     P3KNWG           Weight Variance
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Start Weight
     C                     Z-ADD*ZERO     WUJ3WG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAELDT           Production Date
     C                     Z-ADD*ZERO     WAT7NX           Head Cut
     C                     Z-ADD*ZERO     WAJ1WG           Cold Weight
     C                     Z-ADD*ZERO     WAJ2WG           Avg Cold Weight
     C                     Z-ADD*ZERO     WAJ3WG           Start Weight
     C                     Z-ADD*ZERO     WAFJPC           Production Stan
     C                     Z-ADD*ZERO     WAFKPC           Actual Yield
     C                     Z-ADD*ZERO     WAFNPC           Yield Variance
     C                     Z-ADD*ZERO     WAKNWG           Weight Variance
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBELDT           Production Date
     C                     Z-ADD*ZERO     WBKKWG           YDL Yld Comp We
     C                     Z-ADD*ZERO     WBFMPC           YDL Yld Mix Per
     C                     Z-ADD*ZERO     WBFOPC           YDL Yld Standar
     C                     Z-ADD*ZERO     WBL2WG           YDL Yld Weight
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field YC Required Sts
     C                     MOVEL*BLANK    WUPDSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCFLPC           PLYC Percent of
     C                     Z-ADD*ZERO     WCRGNB           Item Structure
     C                     Z-ADD*ZERO     WCRHNB           Item Structure
     C                     Z-ADD*ZERO     WCRINB           Item Structure
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDGSNY           YPLCS Sequence
     C                     Z-ADD*ZERO     WDRGNB           Item Structure
     C                     Z-ADD*ZERO     WDRHNB           Item Structure
     C                     Z-ADD*ZERO     WDRINB           Item Structure
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEELDT           Production Date
     C                     Z-ADD*ZERO     WEHGCD           Item Code
     C                     Z-ADD*ZERO     WECMNB           Partial Item Co
     C                     Z-ADD*ZERO     WERGNB           Item Structure
     C                     Z-ADD*ZERO     WERHNB           Item Structure
     C                     Z-ADD*ZERO     WERINB           Item Structure
     C                     Z-ADD*ZERO     WET8NX           Production Qty
     C                     Z-ADD*ZERO     WEJ7WG           Production Wgt
     C                     Z-ADD*ZERO     WET9NX           Beginning WIP I
     C                     Z-ADD*ZERO     WEJ8WG           Beginning WIP I
     C                     Z-ADD*ZERO     WEUANX           Ending WIP Inv
     C                     Z-ADD*ZERO     WEJ9WG           Ending WIP Inv
     C                     Z-ADD*ZERO     WEUBNX           Product Delete
     C                     Z-ADD*ZERO     WEKAWG           Product Delete
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHELDT           Production Date
     C                     Z-ADD*ZERO     WHJ3WG           Start Weight
     C                     Z-ADD*ZERO     WHW6NX           Start Pieces
     C                     Z-ADD*ZERO     WHJ6WG           Ending Weight
     C                     Z-ADD*ZERO     WHJ4WG           Converting Star
     C                     Z-ADD*ZERO     WHJ5WG           Converting End
     C                     Z-ADD*ZERO     WHF4PC           Pct Pieces Conv
     C                     Z-ADD*ZERO     WHKOWG           Total Line Weig
     C                     Z-ADD*ZERO     WHFJPC           Production Stan
     C                     Z-ADD*ZERO     WHFKPC           Actual Yield
     C                     Z-ADD*ZERO     WHFNPC           Yield Variance
     C                     Z-ADD*ZERO     WHKNWG           Weight Variance
     C                     Z-ADD*ZERO     WHXCNX           Hogs Cut
     C                     Z-ADD*ZERO     WHMEWG           Bone In Zone Av
     C                     Z-ADD*ZERO     WHMFWG           Bone Ls Zone St
     C                     Z-ADD*ZERO     WHW9NX           Bone Ls Zone Pi
     C                     Z-ADD*ZERO     WHXANX           Conv: Finished
     C                     Z-ADD*ZERO     WHXBNX           Loins Returned
     C                     Z-ADD*ZERO     WHMGWG           Start Wgt Retur
     C                     Z-ADD*ZERO     WHMHWG           YDLH Unused Wgt
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Weight Prod 1 USR
     C                     Z-ADD*ZERO     WUJCWG 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKPXDT           PLYC Std Effect
     C                     Z-ADD*ZERO     WKFPPC           PLYC Std Percen
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLAIC3           Company Number
     C                     Z-ADD*ZERO     WLAUDT           Effective Date
     C                     Z-ADD*ZERO     WLFJPC           Production Stan
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field PLYC Percent of Weight
     C                     Z-ADD*ZERO     WUFLPC  52
      * Define work field PLYC Comment
     C                     MOVEL*BLANK    WUQDNA 30
      * Define work field Type Inc/Exc Sts
     C                     MOVEL*BLANK    WUO8SX  1
      * Define work field Item Structure Type Code
     C                     Z-ADD*ZERO     WURGNB  30
      * Define work field Group Inc/Exc Sts
     C                     MOVEL*BLANK    WUO9SX  1
      * Define work field Item Structure Group Code
     C                     Z-ADD*ZERO     WURHNB  30
      * Define work field Class Inc/Exc Sts
     C                     MOVEL*BLANK    WUPASX  1
      * Define work field Item Structure Class Code
     C                     Z-ADD*ZERO     WURINB  30
      * Define work field YC Component Group
     C                     MOVEL*BLANK    WUPESX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMELDT           Production Date
     C                     Z-ADD*ZERO     WMHGCD           Item Code
     C                     Z-ADD*ZERO     WMCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WMTZNX           Yld Transaction
     C                     Z-ADD*ZERO     WMT0NX           Yld Transaction
     C                     Z-ADD*ZERO     WMJSWG           Yld Transaction
     C                     Z-ADD*ZERO     WMXDNX           Yld Transaction
     C                     Z-ADD*ZERO     WMRGNB           Item Structure
     C                     Z-ADD*ZERO     WMRHNB           Item Structure
     C                     Z-ADD*ZERO     WMRINB           Item Structure
     C                     Z-ADD*ZERO     WMAATM           Job Time
     C                     Z-ADD*ZERO     WMAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOHGCD           Item Code
     C                     Z-ADD*ZERO     WOC9NB           Component Item
     C                     Z-ADD*ZERO     WOBOPR           Sales Yield
     C                     Z-ADD*ZERO     WOBPPR           Production Yiel
     C                     Z-ADD*ZERO     WOHGQT           Packaging Quant
     C                     Z-ADD*ZERO     WOCNSM           Consume Priorit
     C                     Z-ADD*ZERO     WOBMY1           Consume Priorit
     C                     Z-ADD*ZERO     WOBMY2           BOM Pumped Perc
     C                     Z-ADD*ZERO     WOIXQT           BOM Meat Cost C
     C                     Z-ADD*ZERO     WOIYQT           BOM Off Line Yi
     C                     Z-ADD*ZERO     WOAATM           Job Time
     C                     Z-ADD*ZERO     WOAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRELDT           Production Date
     C                     Z-ADD*ZERO     WRHGCD           Item Code
     C                     Z-ADD*ZERO     WRCMNB           Partial Item Co
     C                     Z-ADD*ZERO     WRBPC3           WIP Usage Compa
     C                     Z-ADD*ZERO     WRT1NX           Partial Produce
     C                     Z-ADD*ZERO     WRJVWG           Partial Produce
     C                     Z-ADD*ZERO     WRT2NX           Beginning Inv Q
     C                     Z-ADD*ZERO     WRJWWG           Beginning Inv W
     C                     Z-ADD*ZERO     WRT3NX           Delete Pending
     C                     Z-ADD*ZERO     WRJXWG           Delete Pending
     C                     Z-ADD*ZERO     WRT4NX           Used Qty
     C                     Z-ADD*ZERO     WRJYWG           Used Wgt
     C                     Z-ADD*ZERO     WRT5NX           Not Used Qty
     C                     Z-ADD*ZERO     WRJZWG           Not Used Wgt
     C                     Z-ADD*ZERO     WRT6NX           WIP Rejected Qt
     C                     Z-ADD*ZERO     WRJ0WG           WIP Rejected Wg
     C                     Z-ADD*ZERO     WRRGNB           Item Structure
     C                     Z-ADD*ZERO     WRRHNB           Item Structure
     C                     Z-ADD*ZERO     WRRINB           Item Structure
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field PLYC Type
     C                     MOVEL*BLANK    WUO6SX  2
      * Define work field Credit Item Inc/Exc Sts
     C                     MOVEL*BLANK    WUPCSX  1
      * Define work field Unused Weight Rate 1
     C                     Z-ADD*ZERO     WUB2PR 114
      * Define work field YDL Yld Comp Weight
     C                     Z-ADD*ZERO     WUKKWG 112
      * Define work field Unused Weight Rate 2
     C                     Z-ADD*ZERO     WUB3PR 114
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWAIC3           Company Number
     C                     Z-ADD*ZERO     WWAATM           Job Time
     C                     Z-ADD*ZERO     WWAXDT           Job Date
      * Define work field YDL Component Group
     C                     MOVEL*BLANK    WURISX  1
      * Define work field YDL Unused Sts 1
     C                     MOVEL*BLANK    WURJSX  1
      * Define work field YDL Unused Sts 2
     C                     MOVEL*BLANK    WURKSX  1
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD03 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD04 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA04 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB04 155       *Synon (15,5) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002  6
     C                     MOVEL*BLANK    WL0003  6
     C                     MOVEL*BLANK    WL0004 10
     C                     MOVEL*BLANK    WL0005  2
     C                     Z-ADD*ZERO     WL0006  52
     C                     MOVEL*BLANK    WL0007 30
     C                     MOVEL*BLANK    WL0008  1
     C                     MOVEL*BLANK    WL0009  1
     C                     Z-ADD*ZERO     WL0010  30
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  30
     C                     MOVEL*BLANK    WL0013  1
     C                     Z-ADD*ZERO     WL0014  30
     C                     MOVEL*BLANK    WL0015  1
     C                     MOVEL*BLANK    WL0016  1
      * Define local variables for subroutine SERVGN.
     C                     Z-ADD*ZERO     WL0017  30
     C                     MOVEL*BLANK    WL0018  6
     C                     MOVEL*BLANK    WL0019  6
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  1
     C                     MOVEL*BLANK    WL0022  1
     C                     MOVEL*BLANK    WL0023  1
     C                     Z-ADD*ZERO     WL0024  30
     C                     MOVEL*BLANK    WL0025  1
     C                     Z-ADD*ZERO     WL0026  30
     C                     MOVEL*BLANK    WL0027  1
     C                     Z-ADD*ZERO     WL0028  30
     C                     Z-ADD*ZERO     WL0029 112
      * Define local variables for subroutine SFRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     MOVEL*BLANK    WL0031  6
     C                     MOVEL*BLANK    WL0032  6
     C                     Z-ADD*ZERO     WL0033  70
     C                     MOVEL*BLANK    WL0034  1
     C                     Z-ADD*ZERO     WL0035  30
     C                     Z-ADD*ZERO     WL0036 112
      * Define local variables for subroutine SGRVGN.
     C                     Z-ADD*ZERO     WL0037  30
     C                     MOVEL*BLANK    WL0038  6
     C                     MOVEL*BLANK    WL0039  6
     C                     Z-ADD*ZERO     WL0040  70
     C                     MOVEL*BLANK    WL0041  1
     C                     MOVEL*BLANK    WL0042 10
     C                     Z-ADD*ZERO     WL0043 112
      * Define local variables for subroutine SHRVGN.
     C                     Z-ADD*ZERO     WL0044  30
     C                     MOVEL*BLANK    WL0045  6
     C                     MOVEL*BLANK    WL0046  6
     C                     Z-ADD*ZERO     WL0047  70
     C                     MOVEL*BLANK    WL0048  1
     C                     Z-ADD*ZERO     WL0049 112
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0050  30
     C                     MOVEL*BLANK    WL0051  6
     C                     MOVEL*BLANK    WL0052  6
     C                     Z-ADD*ZERO     WL0053  70
     C                     MOVEL*BLANK    WL0054  1
     C                     Z-ADD*ZERO     WL0055 112
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0056  30
     C                     MOVEL*BLANK    WL0057  6
     C                     MOVEL*BLANK    WL0058  6
     C                     Z-ADD*ZERO     WL0059  70
     C                     MOVEL*BLANK    WL0060  1
     C                     Z-ADD*ZERO     WL0061 112
      * Define local variables for subroutine SMCHRC.
     C                     Z-ADD*ZERO     WL0062  30
     C                     MOVEL*BLANK    WL0063  6
     C                     MOVEL*BLANK    WL0064  6
     C                     Z-ADD*ZERO     WL0065  70
     C                     MOVEL*BLANK    WL0066  1
     C                     MOVEL*BLANK    WL0067 10
     C                     Z-ADD*ZERO     WL0068 112
     C                     MOVEL*BLANK    WL0069  1
     C                     MOVEL*BLANK    WL0070  1
     C                     MOVEL*BLANK    WL0071  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0072  30
     C                     MOVEL*BLANK    WL0073  6
     C                     MOVEL*BLANK    WL0074  6
     C                     MOVEL*BLANK    WL0075 10
     C                     Z-ADD*ZERO     WL0076  70
     C                     Z-ADD*ZERO     WL0077  52
      * Define local variables for subroutine SORVGN.
     C                     Z-ADD*ZERO     WL0078  30
     C                     MOVEL*BLANK    WL0079  6
     C                     Z-ADD*ZERO     WL0080  70
     C                     MOVEL*BLANK    WL0081  1
     C                     MOVEL*BLANK    WL0082  6
     C                     MOVEL*BLANK    WL0083 10
     C                     Z-ADD*ZERO     WL0084 112
      * Define local variables for subroutine SPRVGN.
     C                     Z-ADD*ZERO     WL0085  30
     C                     MOVEL*BLANK    WL0086  6
     C                     MOVEL*BLANK    WL0087  6
     C                     Z-ADD*ZERO     WL0088  70
     C                     Z-ADD*ZERO     WL0089  52
      * Define local variables for subroutine SQRVGN.
     C                     Z-ADD*ZERO     WL0090  30
     C                     MOVEL*BLANK    WL0091  6
     C                     MOVEL*BLANK    WL0092  6
     C                     Z-ADD*ZERO     WL0093  70
     C                     MOVEL*BLANK    WL0094  1
     C                     Z-ADD*ZERO     WL0095 112
      * Define local variables for subroutine SRRVGN.
     C                     Z-ADD*ZERO     WL0096  30
     C                     MOVEL*BLANK    WL0097  6
     C                     MOVEL*BLANK    WL0098  6
     C                     MOVEL*BLANK    WL0099 10
     C                     Z-ADD*ZERO     WL0100  70
     C                     MOVEL*BLANK    WL0101  1
     C                     MOVEL*BLANK    WL0102  1
     C                     Z-ADD*ZERO     WL0103 112
     C                     Z-ADD*ZERO     WL0104  52
     C                     Z-ADD*ZERO     WL0105 114
     C                     Z-ADD*ZERO     WL0106 112
      * Define local variables for subroutine SSRVGN.
     C                     Z-ADD*ZERO     WL0107  30
     C                     MOVEL*BLANK    WL0108  6
     C                     MOVEL*BLANK    WL0109  6
     C                     Z-ADD*ZERO     WL0110  70
     C                     MOVEL*BLANK    WL0111  1
     C                     MOVEL*BLANK    WL0112  1
     C                     MOVEL*BLANK    WL0113  1
     C                     Z-ADD*ZERO     WL0114  30
     C                     MOVEL*BLANK    WL0115  1
     C                     Z-ADD*ZERO     WL0116  30
     C                     MOVEL*BLANK    WL0117  1
     C                     Z-ADD*ZERO     WL0118  30
     C                     Z-ADD*ZERO     WL0119  52
     C                     Z-ADD*ZERO     WL0120 112
     C                     Z-ADD*ZERO     WL0121 114
     C                     Z-ADD*ZERO     WL0122 112
      * Define local variables for subroutine STRVGN.
     C                     Z-ADD*ZERO     WL0123  30
     C                     Z-ADD*ZERO     WL0124  70
     C                     Z-ADD*ZERO     WL0125  70
     C                     Z-ADD*ZERO     WL0126  52
      * Define local variables for subroutine SURVGN.
     C                     Z-ADD*ZERO     WL0127  30
     C                     MOVEL*BLANK    WL0128  6
     C                     MOVEL*BLANK    WL0129  6
     C                     Z-ADD*ZERO     WL0130  70
     C                     MOVEL*BLANK    WL0131  1
     C                     Z-ADD*ZERO     WL0132  52
      * Define local variables for subroutine SWRVGN.
     C                     Z-ADD*ZERO     WL0133  30
     C                     MOVEL*BLANK    WL0134  6
     C                     MOVEL*BLANK    WL0135  6
     C                     MOVEL*BLANK    WL0136 10
     C                     Z-ADD*ZERO     WL0137  70
     C                     MOVEL*BLANK    WL0138  1
     C                     MOVEL*BLANK    WL0139  1
     C                     Z-ADD*ZERO     WL0140 112
     C                     Z-ADD*ZERO     WL0141 112
      * Define local variables for subroutine SXRVGN.
     C                     Z-ADD*ZERO     WL0142  30
     C                     MOVEL*BLANK    WL0143  6
     C                     MOVEL*BLANK    WL0144  6
     C                     Z-ADD*ZERO     WL0145  70
     C                     MOVEL*BLANK    WL0146  1
     C                     MOVEL*BLANK    WL0147  1
     C                     MOVEL*BLANK    WL0148  1
     C                     Z-ADD*ZERO     WL0149  30
     C                     MOVEL*BLANK    WL0150  1
     C                     Z-ADD*ZERO     WL0151  30
     C                     MOVEL*BLANK    WL0152  1
     C                     Z-ADD*ZERO     WL0153  30
     C                     Z-ADD*ZERO     WL0154 112
     C                     Z-ADD*ZERO     WL0155 112
      * Define local variables for subroutine SYCHRC.
     C                     Z-ADD*ZERO     WL0156  30
     C                     MOVEL*BLANK    WL0157  6
     C                     MOVEL*BLANK    WL0158  6
     C                     Z-ADD*ZERO     WL0159  70
     C                     MOVEL*BLANK    WL0160  1
     C                     MOVEL*BLANK    WL0161 10
     C                     Z-ADD*ZERO     WL0162  52
     C                     Z-ADD*ZERO     WL0163  52
     C                     Z-ADD*ZERO     WL0164 112
     C                     MOVEL*BLANK    WL0165  1
     C                     MOVEL*BLANK    WL0166  1
     C                     MOVEL*BLANK    WL0167  1
      * Define local variables for subroutine TIRVGN.
     C                     Z-ADD*ZERO     WL0168  30
     C                     MOVEL*BLANK    WL0169  6
     C                     MOVEL*BLANK    WL0170  6
     C                     Z-ADD*ZERO     WL0171  70
     C                     MOVEL*BLANK    WL0172  1
     C                     Z-ADD*ZERO     WL0173 112
      * Define local work field Wgt Total USR
     C                     Z-ADD*ZERO     YL0001 112
      * Define local work field Wgt Total USR
     C                     Z-ADD*ZERO     YL0002 112
      * Define local work field Weight Tot Start Need USR
     C                     Z-ADD*ZERO     YL0003 112
      * Define local work field Production Line Code
     C                     MOVEL*BLANK    YL0004  6
      * Define local work field PLYC Std Percent
     C                     Z-ADD*ZERO     YL0005  52
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0006  1
      * Define local work field PLYC Type
     C                     MOVEL*BLANK    YL0007  2
      * Define local work field Credit Item Inc/Exc Sts
     C                     MOVEL*BLANK    YL0008  1
      * Define local work field Unused Weight Rate 1
     C                     Z-ADD*ZERO     YL0009 114
      * Define local work field Weight Prod 2 USR
     C                     Z-ADD*ZERO     YL0010 112
      * Define local work field Unused Weight Rate 1
     C                     Z-ADD*ZERO     YL0011 114
      * Define local work field Weight Prod 2 USR
     C                     Z-ADD*ZERO     YL0012 112
      * Define local work field Sales Yield
     C                     Z-ADD*ZERO     YL0013  52
      * Define local work field Bone In Zone Avg Loin Wgt
     C                     Z-ADD*ZERO     YL0014  52
      * Define local work field Delete Pending Wgt
     C                     Z-ADD*ZERO     YL0015 112
      * Define local work field Weight Prod 1 USR
     C                     Z-ADD*ZERO     YL0016 112
      * Define local work field PLYC Type
     C                     MOVEL*BLANK    YL0017  2
      * Define local work field Credit Item Inc/Exc Sts
     C                     MOVEL*BLANK    YL0018  1
      * Define local work field Unused Weight Rate 1
     C                     Z-ADD*ZERO     YL0019 114
      * Define local work field Weight Prod 2 USR
     C                     Z-ADD*ZERO     YL0020 112
      * Define local work field YDL Yld Comp Weight
     C                     Z-ADD*ZERO     YL0021 112
      * Define local work field Yld Component Code
     C                     MOVEL*BLANK    YL0022 10
      * Define local work field Weight Prod 2 USR
     C                     Z-ADD*ZERO     YL0023 112
      * Define local work field Weight Prod 1 USR
     C                     Z-ADD*ZERO     YL0024 112
      * Define local work field Weight Prod 2 USR
     C                     Z-ADD*ZERO     YL0025 112
      * Define local work field Bone In Zone Avg Loin Wgt
     C                     Z-ADD*ZERO     YL0026  52
      * Define local work field Sales Yield
     C                     Z-ADD*ZERO     YL0027  52
      * Define local work field YDL Yld Mix Percent 1
     C                     Z-ADD*ZERO     YL0028  52
      * Define local work field Yld Component Code
     C                     MOVEL*BLANK    YL0029 10
      * Define local work field Percent 7.4 USR
     C                     Z-ADD*ZERO     YL0030  74
      * Define local work field YDL Yld Comp Weight
     C                     Z-ADD*ZERO     YL0031 112
      * Define local work field YDL Yld Standard Pct
     C                     Z-ADD*ZERO     YL0032  52
      * Define local work field Unused Weight Rate 1
     C                     Z-ADD*ZERO     YL0033 114
      * Define local work field Unused Weight Rate 2
     C                     Z-ADD*ZERO     YL0034 114
      * Define local work field Start Weight
     C                     Z-ADD*ZERO     YL0035 112
      * Define local work field First Time Flag
     C                     MOVEL*BLANK    YL0036  1
      * Define local work field Effective Date
     C                     Z-ADD*ZERO     YL0037  70
      * Define local work field Production Standard Yld%
     C                     Z-ADD*ZERO     YL0038  52
      * Define local work field PLYC Percent of Weight
     C                     Z-ADD*ZERO     YL0039  52
      * Define local work field YDL Yld Comp Weight
     C                     Z-ADD*ZERO     YL0040 112
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PICNIC
00002 BUTTTRM
00003 RIBTRM
00004 SGLRIB
00005 EXPTRM
00006 SHTBEL
00007 EXPBLYTRSH
00008 ZINEDIBLE
00009 SKINLS
00010 SKNBOXED
00011 SKNSGLRIB
00012 SKNSHTBEL
00013 BONING
00014 BISIRLOIN
00015 TENDERLOIN
00016 BILOIN
00017 CUTLOSS
00018 LOINCNV
00019 BISMKTRM
00020 FINISHED
00021 SHEETBLY
00022 SKNLSBLY
00023 BNLSSTRON
00024 BNLSSTROFF
00025 BLSSIRLOIN
00026 SHLDRLOIN
00027 TRIMYIELD
00028 PLOINTRIM
