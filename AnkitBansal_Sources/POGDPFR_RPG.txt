     H/TITLE Prt Today PA          PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 09/04/17  Time  : 08:09:33
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAAFREL1IF  E           K        DISK
      * RTV : Calendar                  Retrieval index       NV
      *
     FPDKLREL2IF  E           K        DISK
      * RSQ : Company Item Avail Group  Co/Group/Item
      *
     FCAABREL3IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       NV
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDKKREL1IF  E           K        DISK
      * RTV : Availability Group        Retrieval index
      *
     FCABZREL1IF  E           K        DISK
      * RTV : Company Item              Retrieval index       NV
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPDL5CPL1IF  E           K        DISK
      * RTV : Item Lot Location         Retrieval index
      *
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FPDI8CPL1IF  E           K        DISK
      * RTV : PS Prod Item Schedule     Retrieval index
      *
     FOPBGWKLFIF  E           K        DISK
      * RSQ : Order Detail              Co/Itm/Whs/SSD(d)/Od Omt
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : Item Default              Retrieval index
      *
     FPPBGCPL4IF  E           K        DISK
      * RSQ : PFS Inventory Adjustment  Co/WHS/Item/LDte ShpNotP
      *
     FPOGDPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Today PA          PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
     E                    YDOW        7  1               *Days of week
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WAAJCD
     I              ADF8NA                          WAF8NA
     I              ADACNA                          WAACNA
     I              ADADNA                          WAADNA
     I              ADAENA                          WAAENA
     I              ADAJNA                          WAAJNA
     I              ADBTTX                          WABTTX
     I              ADAOCD                          WAAOCD
     I              ADBGCD                          WABGCD
     I              ADVHST                          WAVHST
     I              ADMPNA                          WAMPNA
     I              ADWPST                          WAWPST
     I              ADXUST                          WAXUST
     I              ADT0ST                          WAT0ST
     I              ADT1ST                          WAT1ST
     I              ADDBNB                          WADBNB
     I              ADT2ST                          WAT2ST
     I              ADT3ST                          WAT3ST
     I              ADT4ST                          WAT4ST
     I              ADT6ST                          WAT6ST
     I              ADBWC3                          WABWC3
     I              ADBTC3                          WABTC3
     I              ADBUC3                          WABUC3
     I              ADBVC3                          WABVC3
     I              ADFCAA                          WAFCAA
     I              ADRQSX                          WARQSX
     I              ADRRSX                          WARRSX
     I              ADRSSX                          WARSSX
     I              ADRTSX                          WARTSX
     I              ADT7ST                          WAT7ST
     I              ADT8ST                          WAT8ST
     I              ADRNSX                          WARNSX
     I              ADROSX                          WAROSX
     I              ADRPSX                          WARPSX
     I              ADUVST                          WAUVST
     I              ADUWST                          WAUWST
     I              ADUXST                          WAUXST
     I              ADVSST                          WAVSST
     I              ADAATM                          WAAATM
     I              ADAYNA                          WAAYNA
     I              ADA0NA                          WAA0NA
     I              ADAXDT                          WAAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Item Avail Group
      * I : RST Company Number
     I                                    P   1   20P1AIC3
      * I : RST Availability Group Code
     I                                        3   5 P1V4CD
     IP2PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P2AJCD
      * I :  Date From             USR
     I                                    P   4   70P2JEDT
      * I :  Date To               USR
     I                                    P   8  110P2JFDT
      * N :  USR Day 1
     I                                    P  12  150P2FFDT
      * N :  USR Day 2
     I                                    P  16  190P2E1DT
      * N :  USR Day 3
     I                                    P  20  230P2E2DT
      * N :  USR Day 4
     I                                    P  24  270P2E3DT
      * N :  USR Day 5
     I                                    P  28  310P2E4DT
     IP3PARM      DS
      * FLD: *Arrays
      * N :  USR Day 6
     I                                    P   1   40P3E5DT
      * N :  USR Day 7
     I                                    P   5   80P3E6DT
      * N :  USR Day 8
     I                                    P   9  120P3FKDT
      * N :  USR Day 9
     I                                    P  13  160P3FLDT
      * N :  USR Day 10
     I                                    P  17  200P3FGDT
      * N :  USR Day 11
     I                                    P  21  240P3FHDT
      * N :  USR Day 12
     I                                    P  25  280P3FIDT
      * N :  USR Day 13
     I                                    P  29  320P3FJDT
      * N :  USR Day 14
     I                                    P  33  360P3HPDT
      * N :  USR Day 15
     I                                    P  37  400P3HQDT
      * N :  USR Day 16
     I                                    P  41  440P3HRDT
     IP4PARM      DS
      * FLD: *Arrays
      * N :  Generic Heading 1
     I                                        1   8 P4MWTX
      * N :  Generic Heading 2
     I                                        9  16 P4MXTX
      * N :  Generic Heading 3
     I                                       17  24 P4MYTX
      * N :  Generic Heading 4
     I                                       25  32 P4MZTX
      * N :  Generic Heading 5
     I                                       33  40 P4M0TX
      * N :  Generic Heading 6
     I                                       41  48 P4M1TX
      * N :  Generic Heading 7
     I                                       49  56 P4M2TX
      * N :  Generic Heading 8
     I                                       57  64 P4M3TX
      * N :  Generic Heading 9
     I                                       65  72 P4M4TX
      * N :  Generic Heading 10
     I                                       73  80 P4M5TX
      * N :  Generic Heading 11
     I                                       81  88 P4M6TX
      * N :  Generic Heading 12
     I                                       89  96 P4M7TX
      * N :  Generic Heading 13
     I                                       97 104 P4M8TX
      * N :  Generic Heading 14
     I                                      105 112 P4M9TX
      * N :  Display Line Flag
     I                                      113 114 P4DFST
      * N :  Generic Heading 15
     I                                      115 122 P4Y5TX
      * N :  Generic Heading 16
     I                                      123 130 P4Y6TX
     IP5PARM      DS
      * N :  Total Sched Shipments USR
     I                                    P   1   51P5KNNB
     IP6PARM      DS
      * N :  Grand Total Schd Ship USR
     I                                    P   1   51P6LGNB
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1V4CD    PARM           WP0002  3        Availability Gr
     C           P2AJCD    PARM           WP0003  3        Warehouse Code
     C           P2JEDT    PARM           WP0004  70       Date From
     C           P2JFDT    PARM           WP0005  70       Date To
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Today PA          PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$EENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Today PA          PF: Mainline
      *================================================================
      * Declare restrictor key work fields
     C           *LIKE     DEFN KLAIC3    WQKA01           Company Number
     C           *LIKE     DEFN KLV4CD    WQKA02           Availability Gr
      * Define keylist
     C           KRSA      KLIST
     C                     KFLD           WQKA01           Company Number
     C                     KFLD           WQKA02           Availability Gr
      * Setup key
     C                     Z-ADDP1AIC3    WQKA01           Company Number
     C                     MOVELP1V4CD    WQKA02           Availability Gr
      * Establish starting position
     C           KRSA      SETLL@KLREHI                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Availability Gr
     C                     MOVEL'Y'       W0AL02  1        Item Display Se
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Load key header format
     C                     Z-ADD*ZERO     $BAIC3           Company Number
     C                     MOVEL*BLANK    $BADTX           Name
     C                     Z-ADD*ZERO     $BJEDT           Date From
     C                     Z-ADD*ZERO     $BJFDT           Date To
     C                     MOVEL*BLANK    $BV4CD           Availability Gr
     C                     MOVEL*BLANK    $BNVNA           Availability Gr
     C                     MOVEL*BLANK    $BAJCD           Warehouse Code
     C                     MOVEL*BLANK    $BF8NA           Warehouse Descr
     C                     MOVEL*BLANK    $BCPCD           USR Warehouse C
     C                     MOVEL*BLANK    $BAUNA           Description
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDKLAIC3    $CAIC3           Company Number
     C                     Z-ADD*ZERO     $CFFDT           USR Day 1
     C                     MOVEL*BLANK    $CMWTX           Generic Heading
     C                     MOVEL*BLANK    $CMXTX           Generic Heading
     C                     MOVEL*BLANK    $CYQTX           Generic Heading
     C                     MOVEL*BLANK    $CMYTX           Generic Heading
     C                     MOVEL*BLANK    $CYRTX           Generic Heading
     C                     MOVEL*BLANK    $CMZTX           Generic Heading
     C                     MOVEL*BLANK    $CYSTX           Generic Heading
     C                     MOVEL*BLANK    $CM0TX           Generic Heading
     C                     MOVEL*BLANK    $CYTTX           Generic Heading
     C                     MOVEL*BLANK    $CM1TX           Generic Heading
     C                     MOVEL*BLANK    $CYUTX           Generic Heading
     C                     MOVEL*BLANK    $CM2TX           Generic Heading
     C                     MOVEL*BLANK    $CYVTX           Generic Heading
     C                     MOVEL*BLANK    $CM3TX           Generic Heading
     C                     MOVEL*BLANK    $CYWTX           Generic Heading
     C                     MOVEL*BLANK    $CM4TX           Generic Heading
     C                     MOVEL*BLANK    $CYXTX           Generic Heading
     C                     MOVEL*BLANK    $CM5TX           Generic Heading
     C                     MOVEL*BLANK    $CYYTX           Generic Heading
     C                     MOVEL*BLANK    $CM6TX           Generic Heading
     C                     MOVEL*BLANK    $CYZTX           Generic Heading
     C                     MOVEL*BLANK    $CM7TX           Generic Heading
     C                     MOVEL*BLANK    $CY0TX           Generic Heading
     C                     MOVEL*BLANK    $CM8TX           Generic Heading
     C                     MOVEL*BLANK    $CY1TX           Generic Heading
     C                     MOVEL*BLANK    $CM9TX           Generic Heading
     C                     MOVEL*BLANK    $CY2TX           Generic Heading
     C                     MOVEL*BLANK    $CY5TX           Generic Heading
     C                     MOVEL*BLANK    $CY3TX           Generic Heading
     C                     MOVEL*BLANK    $CY6TX           Generic Heading
     C                     MOVEL*BLANK    $CY4TX           Generic Heading
     C                     Z-ADD*ZERO     $CE1DT           USR Day 2
     C                     Z-ADD*ZERO     $CE2DT           USR Day 3
     C                     Z-ADD*ZERO     $CE3DT           USR Day 4
     C                     Z-ADD*ZERO     $CE4DT           USR Day 5
     C                     Z-ADD*ZERO     $CE5DT           USR Day 6
     C                     Z-ADD*ZERO     $CE6DT           USR Day 7
     C                     MOVEL*BLANK    $CZ2CD           Warehouse 9 USR
     C                     MOVEL*BLANK    $CZ3CD           Warehouse 10 US
     C                     MOVEL*BLANK    $CSTTX           USR Text 7
     C                     MOVEL*BLANK    $CZ6CD           Warehouse 13 US
     C                     MOVEL*BLANK    $CZ7CD           Warehouse 14 US
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDKLAIC3    $DAIC3           Company Number
     C                     Z-ADDKLHGCD    $DHGCD           Item Code
     C                     MOVEL*BLANK    $DOONA           Item Desc DRV
     C                     Z-ADD*ZERO     $DAIWG           Unit Weight
     C                     MOVEL*BLANK    $DADCD           U/M - Primary
     C                     Z-ADD*ZERO     $DLEQT           Qty On-Hand USR
     C                     Z-ADD*ZERO     $DKCQT           Picked Inventor
     C                     Z-ADD*ZERO     $DLIQT           Qty Sched Prod
     C                     Z-ADD*ZERO     $DLKQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DLGQT           Qty EOD Inv 1 U
     C                     Z-ADD*ZERO     $DIRQT           Quantity Ordere
     C                     Z-ADD*ZERO     $DQS01           Quantity Schedu
     C                     Z-ADD*ZERO     $DQTO1           Quantity Ordere
     C                     Z-ADD*ZERO     $DQS02           Quantity Schedu
     C                     Z-ADD*ZERO     $DQT02           Quantity Ordere
     C                     Z-ADD*ZERO     $DQS03           Quantity Schedu
     C                     Z-ADD*ZERO     $DQT03           Quantity Ordere
     C                     Z-ADD*ZERO     $DQS04           Quantity Schedu
     C                     Z-ADD*ZERO     $DQT05           Quantity Ordere
     C                     Z-ADD*ZERO     $DQS05           Quantity Schedu
     C                     Z-ADD*ZERO     $DASNX           Quantity Sched
     C                     Z-ADD*ZERO     $DAQNX           Quantity On-Han
     C                     Z-ADD*ZERO     $DLLQT           Qty Sched Ord 2
     C                     MOVEL*BLANK    $DZCTX           Vertical Line 2
     C                     Z-ADD*ZERO     $DLVQT           Qty Sched Ord 3
     C                     MOVEL*BLANK    $DZDTX           Vertical Line 3
     C                     Z-ADD*ZERO     $DMOQT           Qty Sched Ord 4
     C                     MOVEL*BLANK    $DZETX           Vertical Line 4
     C                     Z-ADD*ZERO     $DMPQT           Qty Sched Ord 5
     C                     MOVEL*BLANK    $DZFTX           Vertical Line 5
     C                     Z-ADD*ZERO     $DMQQT           Qty Sched Ord 6
     C                     MOVEL*BLANK    $DZGTX           Vertical Line 6
     C                     Z-ADD*ZERO     $DMRQT           Qty Sched Ord 7
     C                     MOVEL*BLANK    $DZHTX           Vertical Line 7
     C                     Z-ADD*ZERO     $DMUQT           Qty Sched Ord 8
     C                     MOVEL*BLANK    $DZITX           Vertical Line 8
     C                     Z-ADD*ZERO     $DMVQT           Qty Sched Ord 9
     C                     MOVEL*BLANK    $DZJTX           Vertical Line 9
     C                     Z-ADD*ZERO     $DMWQT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZKTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DMXQT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZLTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DMYQT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZMTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DMZQT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZNTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DM0QT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZOTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DM6QT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZPTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DM7QT           Qty Sched Ord 1
     C                     MOVEL*BLANK    $DZQTX           Vertical Line 1
     C                     Z-ADD*ZERO     $DODNB           Number Value -
     C                     Z-ADD*ZERO     $DQLTX           Quantity Loc Tr
     C                     Z-ADD*ZERO     $DATNX           Quantity Sched
     C                     Z-ADD*ZERO     $DARNX           Quantity On-Han
     C                     Z-ADD*ZERO     $DTVNB           Calc 7
     C                     MOVELKLV4CD    $DV4CD           Availability Gr
     C                     Z-ADDKLIDSQ    $DIDSQ           Item Display Se
     C                     MOVELKLUVST    $DUVST           EDI Status 1
     C                     MOVELKLUWST    $DUWST           EDI Status 2
     C                     MOVELKLUXST    $DUXST           EDI Status 3
     C                     MOVELKLVSST    $DVSST           Record Status
     C                     Z-ADDKLAATM    $DAATM           Job Time
     C                     MOVELKLAYNA    $DAYNA           User Id
     C                     MOVELKLA0NA    $DA0NA           Job Name
     C                     Z-ADDKLAXDT    $DAXDT           Job Date
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN KLAIC3    WZA001           Company Number
     C                     Z-ADDKLAIC3    WZA001
     C           *LIKE     DEFN KLV4CD    WZA002           Availability Gr
     C                     MOVELKLV4CD    WZA002
     C           *LIKE     DEFN KLIDSQ    WZA003           Item Display Se
     C                     Z-ADDKLIDSQ    WZA003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C           KRSA      READE@KLREHI                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        Company Number
     C                     MOVEL*BLANK    W0AL01  1        Availability Gr
     C                     MOVEL*BLANK    W0AL02  1        Item Display Se
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        Company Number
     C                     MOVEL'Y'       W0AL01  1        Availability Gr
     C                     MOVEL'Y'       W0AL02  1        Item Display Se
     C                     ELSE
      * Next record - Detect level breaks
     C           KLAIC3    IFNE WZA001                     Company Number
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           KLV4CD    IFNE WZA002                     Availability Gr
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           KLIDSQ    IFNE WZA003                     Item Display Se
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Today PA          PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Today PA          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of first page format
      * 1PG = PAR By name
     C                     Z-ADDP1AIC3    $BAIC3           Company Number
     C                     Z-ADDP2JEDT    $BJEDT           Date From
     C                     Z-ADDP2JFDT    $BJFDT           Date To
     C                     MOVELP1V4CD    $BV4CD           Availability Gr
     C                     MOVELP2AJCD    $BAJCD           Warehouse Code
      * RTV Company Name       RT - Company Name and Address  * 
     C                     EXSR SDRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SERVGN
      * RTV Group Description  RT - Availability Group  * 
     C                     EXSR SFRVGN
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BAIC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BAIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBAIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBAIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Date From             USR to display format
      * Convert date
     C           1000000   ADD  $BJEDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBJEDT
      * Print format
     C                     WRITE$B1STPAG
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print Company Number of Prt Today PA          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of Company Number format
     C                     Z-ADDP2JEDT    P2FFDT           USR Day 1
      * PAR.USR Day 2 = PAR.USR Day 1 + CON.1 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD1         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E1DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E1DT
     C                     END
      * PAR.USR Day 3 = PAR.USR Day 1 + CON.2 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD2         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E2DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E2DT
     C                     END
      * PAR.USR Day 4 = PAR.USR Day 1 + CON.3 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD3         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E3DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E3DT
     C                     END
      * PAR.USR Day 5 = PAR.USR Day 1 + CON.4 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD4         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P2E4DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P2E4DT
     C                     END
      * PAR.USR Day 6 = PAR.USR Day 1 + CON.5 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD5         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3E5DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3E5DT
     C                     END
      * PAR.USR Day 7 = PAR.USR Day 1 + CON.6 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD6         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3E6DT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3E6DT
     C                     END
      * PAR.USR Day 8 = PAR.USR Day 1 + CON.7 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD7         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3FKDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3FKDT
     C                     END
      * PAR.USR Day 9 = PAR.USR Day 1 + CON.8 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD8         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3FLDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3FLDT
     C                     END
      * PAR.USR Day 10 = PAR.USR Day 1 + CON.9 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD9         XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3FGDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3FGDT
     C                     END
      * PAR.USR Day 11 = PAR.USR Day 1 + CON.10 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD10        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3FHDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3FHDT
     C                     END
      * PAR.USR Day 12 = PAR.USR Day 1 + CON.11 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD11        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3FIDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3FIDT
     C                     END
      * PAR.USR Day 13 = PAR.USR Day 1 + CON.12 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD12        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3FJDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3FJDT
     C                     END
      * PAR.USR Day 14 = PAR.USR Day 1 + CON.13 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD13        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3HPDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3HPDT
     C                     END
      * PAR.USR Day 15 = PAR.USR Day 1 + CON.14 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD14        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3HQDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3HQDT
     C                     END
      * PAR.USR Day 16 = PAR.USR Day 1 + CON.15 *DAYS
     C           P2FFDT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD15        XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3HRDT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3HRDT
     C                     END
      * CUR = PAR By name
     C                     Z-ADDP1AIC3    $CAIC3           Company Number
     C                     Z-ADDP2FFDT    $CFFDT           USR Day 1
     C                     MOVELP4MWTX    $CMWTX           Generic Heading
     C                     MOVELP4MXTX    $CMXTX           Generic Heading
     C                     MOVELP4MYTX    $CMYTX           Generic Heading
     C                     MOVELP4MZTX    $CMZTX           Generic Heading
     C                     MOVELP4M0TX    $CM0TX           Generic Heading
     C                     MOVELP4M1TX    $CM1TX           Generic Heading
     C                     MOVELP4M2TX    $CM2TX           Generic Heading
     C                     MOVELP4M3TX    $CM3TX           Generic Heading
     C                     MOVELP4M4TX    $CM4TX           Generic Heading
     C                     MOVELP4M5TX    $CM5TX           Generic Heading
     C                     MOVELP4M6TX    $CM6TX           Generic Heading
     C                     MOVELP4M7TX    $CM7TX           Generic Heading
     C                     MOVELP4M8TX    $CM8TX           Generic Heading
     C                     MOVELP4M9TX    $CM9TX           Generic Heading
     C                     MOVELP4Y5TX    $CY5TX           Generic Heading
     C                     MOVELP4Y6TX    $CY6TX           Generic Heading
     C                     Z-ADDP2E1DT    $CE1DT           USR Day 2
     C                     Z-ADDP2E2DT    $CE2DT           USR Day 3
     C                     Z-ADDP2E3DT    $CE3DT           USR Day 4
     C                     Z-ADDP2E4DT    $CE4DT           USR Day 5
     C                     Z-ADDP3E5DT    $CE5DT           USR Day 6
     C                     Z-ADDP3E6DT    $CE6DT           USR Day 7
      * Re-format Heading Date  1
      * CASE: CUR.Generic Heading 1 is Equal Total
     C           $CMWTX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZRTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0081  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMWTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0081    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMWTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0081    CAT  WUNATX:ZQ WN0081    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0081    CAT  '/':ZQ    WN0081    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMWTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0081    CAT  WUNATX:ZQ WN0081    P      Generic Heading
     C                     MOVELWN0081    $CMWTX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  2
      * CASE: CUR.Generic Heading 2 is Equal Total
     C           $CMXTX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZCTX           Vertical Line 2
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0082  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMXTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0082    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMXTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0082    CAT  WUNATX:ZQ WN0082    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0082    CAT  '/':ZQ    WN0082    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMXTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0082    CAT  WUNATX:ZQ WN0082    P      Generic Heading
     C                     MOVELWN0082    $CMXTX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  3
      * CASE: CUR.Generic Heading 3 is Equal Total
     C           $CMYTX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZDTX           Vertical Line 3
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0083  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMYTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0083    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMYTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0083    CAT  WUNATX:ZQ WN0083    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0083    CAT  '/':ZQ    WN0083    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMYTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0083    CAT  WUNATX:ZQ WN0083    P      Generic Heading
     C                     MOVELWN0083    $CMYTX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  4
      * CASE: CUR.Generic Heading 4 is Equal Total
     C           $CMZTX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZETX           Vertical Line 4
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0084  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMZTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0084    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMZTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0084    CAT  WUNATX:ZQ WN0084    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0084    CAT  '/':ZQ    WN0084    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CMZTX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0084    CAT  WUNATX:ZQ WN0084    P      Generic Heading
     C                     MOVELWN0084    $CMZTX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  5
      * CASE: CUR.Generic Heading 5 is Equal Total
     C           $CM0TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZFTX           Vertical Line 5
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0085  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM0TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0085    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM0TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0085    CAT  WUNATX:ZQ WN0085    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0085    CAT  '/':ZQ    WN0085    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM0TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0085    CAT  WUNATX:ZQ WN0085    P      Generic Heading
     C                     MOVELWN0085    $CM0TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  6
      * CASE: CUR.Generic Heading 6 is Equal Total
     C           $CM1TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZGTX           Vertical Line 6
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0086  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM1TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0086    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM1TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0086    CAT  WUNATX:ZQ WN0086    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0086    CAT  '/':ZQ    WN0086    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM1TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0086    CAT  WUNATX:ZQ WN0086    P      Generic Heading
     C                     MOVELWN0086    $CM1TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  7
      * CASE: CUR.Generic Heading 7 is Equal Total
     C           $CM2TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZHTX           Vertical Line 7
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0087  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM2TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0087    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM2TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0087    CAT  WUNATX:ZQ WN0087    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0087    CAT  '/':ZQ    WN0087    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM2TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0087    CAT  WUNATX:ZQ WN0087    P      Generic Heading
     C                     MOVELWN0087    $CM2TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  8
      * CASE: CUR.Generic Heading 8 is Equal Total
     C           $CM3TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZITX           Vertical Line 8
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0088  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM3TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0088    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM3TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0088    CAT  WUNATX:ZQ WN0088    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0088    CAT  '/':ZQ    WN0088    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM3TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0088    CAT  WUNATX:ZQ WN0088    P      Generic Heading
     C                     MOVELWN0088    $CM3TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date  9
      * CASE: CUR.Generic Heading 9 is Equal Total
     C           $CM4TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZJTX           Vertical Line 9
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0089  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM4TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0089    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM4TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0089    CAT  WUNATX:ZQ WN0089    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0089    CAT  '/':ZQ    WN0089    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM4TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0089    CAT  WUNATX:ZQ WN0089    P      Generic Heading
     C                     MOVELWN0089    $CM4TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 10
      * CASE: CUR.Generic Heading 10 is Equal Total
     C           $CM5TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZKTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0090  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM5TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0090    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM5TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0090    CAT  WUNATX:ZQ WN0090    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0090    CAT  '/':ZQ    WN0090    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM5TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0090    CAT  WUNATX:ZQ WN0090    P      Generic Heading
     C                     MOVELWN0090    $CM5TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 11
      * CASE: CUR.Generic Heading 11 is Equal Total
     C           $CM6TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZLTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0091  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM6TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0091    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM6TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0091    CAT  WUNATX:ZQ WN0091    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0091    CAT  '/':ZQ    WN0091    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM6TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0091    CAT  WUNATX:ZQ WN0091    P      Generic Heading
     C                     MOVELWN0091    $CM6TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 12
      * CASE: CUR.Generic Heading 12 is Equal Total
     C           $CM7TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZMTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0092  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM7TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0092    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM7TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0092    CAT  WUNATX:ZQ WN0092    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0092    CAT  '/':ZQ    WN0092    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM7TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0092    CAT  WUNATX:ZQ WN0092    P      Generic Heading
     C                     MOVELWN0092    $CM7TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 13
      * CASE: CUR.Generic Heading 13 is Equal Total
     C           $CM8TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZNTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0093  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM8TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0093    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM8TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0093    CAT  WUNATX:ZQ WN0093    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0093    CAT  '/':ZQ    WN0093    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM8TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0093    CAT  WUNATX:ZQ WN0093    P      Generic Heading
     C                     MOVELWN0093    $CM8TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 14
      * CASE: CUR.Generic Heading 14 is Equal Total
     C           $CM9TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZOTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0094  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM9TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0094    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM9TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0094    CAT  WUNATX:ZQ WN0094    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0094    CAT  '/':ZQ    WN0094    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CM9TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0094    CAT  WUNATX:ZQ WN0094    P      Generic Heading
     C                     MOVELWN0094    $CM9TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 15
      * CASE: CUR.Generic Heading 15 is Equal Total
     C           $CY5TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZPTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0095  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CY5TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0095    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CY5TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0095    CAT  WUNATX:ZQ WN0095    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0095    CAT  '/':ZQ    WN0095    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CY5TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0095    CAT  WUNATX:ZQ WN0095    P      Generic Heading
     C                     MOVELWN0095    $CY5TX           Generic Heading
     C                     END                             *FI
      * Re-format Heading Date 16
      * CASE: CUR.Generic Heading 16 is Equal Total
     C           $CY6TX    IFEQ 'Total'                    *IF
     C                     MOVEL'|'       WUZQTX           Vertical Line 1
     C                     ELSE
      * CASE: *OTHERWISE
      *
     C                     MOVEL*BLANK    WN0096  8        Generic Heading
      *
      * SET Format Text Dates  IF
     C                     Z-ADD2         YRSW00
     C                     Z-ADD1         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CY6TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WUNATX    CAT  '/':ZQ    WN0096    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD3         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CY6TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0096    CAT  WUNATX:ZQ WN0096    P      Generic Heading
     C                     Z-ADD0         ZQ      50
     C           WN0096    CAT  '/':ZQ    WN0096    P      Generic Heading
     C                     Z-ADD2         YRSW00
     C                     Z-ADD5         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00008
     C           ZQ        ORGT 00008
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBST$CY6TX:ZQ WUNATX    P  90  Generic Heading
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD0         ZQ      50
     C           WN0096    CAT  WUNATX:ZQ WN0096    P      Generic Heading
     C                     MOVELWN0096    $CY6TX           Generic Heading
     C                     END                             *FI
     C                     MOVEL$CMXTX    $CYQTX           Generic Heading
     C                     MOVEL$CMYTX    $CYRTX           Generic Heading
     C                     MOVEL$CMZTX    $CYSTX           Generic Heading
     C                     MOVEL$CM0TX    $CYTTX           Generic Heading
     C                     MOVEL$CM1TX    $CYUTX           Generic Heading
     C                     MOVEL$CM2TX    $CYVTX           Generic Heading
     C                     MOVEL$CM3TX    $CYWTX           Generic Heading
     C                     MOVEL$CM4TX    $CYXTX           Generic Heading
     C                     MOVEL$CM5TX    $CYYTX           Generic Heading
     C                     MOVEL$CM6TX    $CYZTX           Generic Heading
     C                     MOVEL$CM7TX    $CY0TX           Generic Heading
     C                     MOVEL$CM8TX    $CY1TX           Generic Heading
     C                     MOVEL$CM9TX    $CY2TX           Generic Heading
     C                     MOVEL$CY5TX    $CY3TX           Generic Heading
     C                     MOVEL$CY6TX    $CY4TX           Generic Heading
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE 'P'       W0AP00
     C                     END                             FI
      * Print Availability Group Code of Prt Today PA          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print Item Display Sequence of Prt Today PA          PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print Detail line. of Prt Today PA          PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
     C                     MOVELWUZCTX    $DZCTX           Vertical Line 2
     C                     MOVELWUZDTX    $DZDTX           Vertical Line 3
     C                     MOVELWUZETX    $DZETX           Vertical Line 4
     C                     MOVELWUZFTX    $DZFTX           Vertical Line 5
     C                     MOVELWUZGTX    $DZGTX           Vertical Line 6
     C                     MOVELWUZHTX    $DZHTX           Vertical Line 7
     C                     MOVELWUZITX    $DZITX           Vertical Line 8
     C                     MOVELWUZJTX    $DZJTX           Vertical Line 9
     C                     MOVELWUZKTX    $DZKTX           Vertical Line 1
     C                     MOVELWUZLTX    $DZLTX           Vertical Line 1
     C                     MOVELWUZMTX    $DZMTX           Vertical Line 1
     C                     MOVELWUZNTX    $DZNTX           Vertical Line 1
     C                     MOVELWUZOTX    $DZOTX           Vertical Line 1
     C                     MOVELWUZPTX    $DZPTX           Vertical Line 1
     C                     MOVELWUZQTX    $DZQTX           Vertical Line 1
      * RTV Pces/Bag,Bag/Unt,umRT - Company Item  * 
     C                     EXSR SGRVGN
      * CASE: CUR.Unit Weight is Equal to zero
     C           $DAIWG    IFEQ *ZERO                      *IF
     C                     Z-ADD1         $DAIWG           Unit Weight
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0097  92       Weight Producti
     C                     Z-ADD*ZERO     WN0098  70       Pieces Producti
     C                     MOVEL*BLANK    WN0099  3        PS Production W
     C                     Z-ADD*ZERO     WN0100  81       Total Sched Shi
     C                     Z-ADD*ZERO     WN0101  81       Grand Total Sch
     C                     MOVEL*BLANK    WN0102  1        Ord/Sch Sts USR
      *
      * Rtv Today PA          IF
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DLEQT           Qty On-Hand USR
     C                     Z-ADD*ZERO     $DLIQT           Qty Sched Prod
     C                     Z-ADD*ZERO     WULOQT           Qty Produced US
     C                     Z-ADD*ZERO     WULFQT           Qty Remaining P
     C                     Z-ADD*ZERO     $DLKQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DLGQT           Qty EOD Inv 1 U
     C                     Z-ADD*ZERO     $DLLQT           Qty Sched Ord 2
     C                     Z-ADD*ZERO     WULHQT           Qty EOD Inv 2 U
     C                     Z-ADD*ZERO     WULMQT           Qty Prod Needed
     C                     Z-ADD*ZERO     WULNQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     WULJQT           Qty Sched Prod
     C                     Z-ADD*ZERO     $DLVQT           Qty Sched Ord 3
     C                     Z-ADD*ZERO     WULRQT           Qty EOD Inv 3 U
     C                     Z-ADD*ZERO     WULUQT           Qty Prod Needed
     C                     Z-ADD*ZERO     WULTQT           Qty Prod Adjust
     C                     Z-ADD*ZERO     WULWQT           Qty Sched Prod
     C                     Z-ADD*ZERO     WN0097           Weight Producti
     C                     Z-ADD*ZERO     WN0098           Pieces Producti
     C                     MOVEL*BLANK    WN0099           PS Production W
     C                     Z-ADD*ZERO     $DMOQT           Qty Sched Ord 4
     C                     Z-ADD*ZERO     $DMPQT           Qty Sched Ord 5
     C                     Z-ADD*ZERO     $DMQQT           Qty Sched Ord 6
     C                     Z-ADD*ZERO     $DMRQT           Qty Sched Ord 7
     C                     Z-ADD*ZERO     $DMUQT           Qty Sched Ord 8
     C                     Z-ADD*ZERO     $DMVQT           Qty Sched Ord 9
     C                     Z-ADD*ZERO     $DMWQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DMXQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DMYQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DMZQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DM0QT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DM6QT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     $DM7QT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     WN0100           Total Sched Shi
     C                     Z-ADD*ZERO     WN0101           Grand Total Sch
     C                     MOVEL*BLANK    WN0102           Ord/Sch Sts USR
      * **********  Day 1  **********
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP2AJCD    WL0001    P      Warehouse Code
     C                     EXSR SHRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0002    YL0022    P      Lot Tracking Fl
      * CASE: LCL.Lot Tracking Flag is yes
     C           YL0022    IFEQ 'Y'                        *IF
      * Rtv Item Loc Qty Tot  RT - Item Lot Location  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0003           Company Number
     C                     Z-ADD$DHGCD    WL0004           Item Code
     C                     MOVELP2AJCD    WL0005    P      Warehouse Code
     C                     Z-ADD$DLEQT    WL0006           Quantity Loc On
     C                     EXSR SIRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0006    $DLEQT           Quantity Loc On
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV On Hand Qty f/Whse RT - IC Item Balance  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0007           Company Number
     C                     Z-ADD$DHGCD    WL0008           Item Code
     C                     MOVELP2AJCD    WL0009    P      Warehouse Code
     C                     Z-ADD$DLEQT    WL0010           On Hand U/M1 Su
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0010    $DLEQT           On Hand U/M1 Su
     C                     END                             *FI
      * If inventory qty is less than zero then make zero
      * CASE: PAR.Qty On-Hand USR is LT Zero
     C           $DLEQT    IFLT 0                          *IF
     C                     Z-ADD0         $DLEQT           Qty On-Hand USR
     C                     END                             *FI
      * Rtv Production        RT - PS Prod Item Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0011           Company Number
     C                     MOVEL'S'       WL0012    P      Production Type
     C                     Z-ADDYL0001    WL0013           Production Date
     C                     Z-ADD$DHGCD    WL0014           Item Code
     C                     MOVELP2AJCD    WL0015    P      Warehouse Code
     C                     EXSR SKRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0016    WN0097           Weight Producti
     C                     Z-ADDWL0017    WN0098           Pieces Producti
     C                     MOVELWL0018    WN0099    P      PS Production W
      * Scheduled Production Quantity
      * CASE: PAR.Piece Count Item is yes
     C           WUPCCT    IFEQ 'Y'                        *IF
      * Qty Sched Prod
      * PAR.Qty Sched Prod 1 USR =
      *    *COMPUTE (x1 / (x2 * x3))
      * x1    : PAR.Pieces Production USR
      * /     : PGM.*Synon (15,0) work field *Rounded
      * x2    : PAR.Pieces Per Bag
      * *     : PGM.*Synon (15,0) work field *Rounded
      * x3    : PAR.Bags Per Unit
     C           WUBDNB    MULT WUBJNB    W0WJ01           *Synon (15,0) w
     C           WN0098    DIV  W0WJ01    W0WJ00    H      *Synon (15,0) w
     C                     Z-ADDW0WJ00    $DLIQT           Qty Sched Prod
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0097    DIV  $DAIWG    $DLIQT    H      Qty Sched Prod
     C                     END                             *FI
      * Rtv Sched qty & wgt which is what it was doing before.. FP1054 4/
      * Rtv Sched Ship ALL    RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0019           Company Number
     C                     Z-ADD$DHGCD    WL0020           Item Code
     C                     MOVELP2AJCD    WL0021    P      Warehouse Code
     C                     Z-ADDYL0001    WL0022           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0023           Weight Schedule
     C                     Z-ADD$DLKQT    WL0024           Quantity Schedu
     C                     MOVEL'Y'       WL0025    P      Status Flag 10
     C                     EXSR SLRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0023    WUEEWG           Weight Schedule
     C                     Z-ADDWL0024    $DLKQT           Quantity Schedu
      * EOD Inventory
      * PAR.Qty EOD Inv 1 USR =
      *    *COMPUTE (x1 + x2 - x3)
      * x1    : PAR.Qty On-Hand USR
      * +     : PGM.*Synon (15,0) work field
      * x2    : PAR.Qty Sched Prod 1 USR
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Qty Sched Ord 1 USR
     C           $DLEQT    ADD  $DLIQT    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  $DLKQT    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    $DLGQT           Qty EOD Inv 1 U
     C                     Z-ADD$DLKQT    WN0100           Total Sched Shi
      * **********  Day 2  **********
     C                     MOVEL'S'       WN0102           Ord/Sch Sts USR
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0002    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DLLQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DLLQT           Quantity Schedu
      * **********  Day 3  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0003    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DLVQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DLVQT           Quantity Schedu
      * **********  Day 4  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0004    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMOQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMOQT           Quantity Schedu
      * **********  Day 5  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0005    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMPQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMPQT           Quantity Schedu
      * **********  Day 6  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0006    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMQQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMQQT           Quantity Schedu
      * **********  Day 7  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0007    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMRQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMRQT           Quantity Schedu
      * **********  Day 8  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0008    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMUQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMUQT           Quantity Schedu
      * **********  Day 9  **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0009    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMVQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMVQT           Quantity Schedu
      * **********  Day 10 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0010    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMWQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMWQT           Quantity Schedu
      * **********  Day 11 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0011    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMXQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMXQT           Quantity Schedu
      * **********  Day 12 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0012    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMYQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMYQT           Quantity Schedu
      * **********  Day 13 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0013    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DMZQT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DMZQT           Quantity Schedu
      * **********  Day 14 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0014    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DM0QT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DM0QT           Quantity Schedu
      * **********  Day 15 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0015    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DM6QT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DM6QT           Quantity Schedu
      * **********  Day 16 **********
      * Rtv Sched Shipments   RT - Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$DAIC3    WL0030           Company Number
     C                     Z-ADD$DHGCD    WL0031           Item Code
     C                     MOVELP2AJCD    WL0032    P      Warehouse Code
     C                     Z-ADDYL0016    WL0033           Scheduled Ship
     C                     Z-ADDWUEEWG    WL0034           Weight Schedule
     C                     Z-ADD$DM7QT    WL0035           Quantity Schedu
     C                     MOVELWN0102    WL0036    P      Ord/Sch Sts USR
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0034    WUEEWG           Weight Schedule
     C                     Z-ADDWL0035    $DM7QT           Quantity Schedu
     C                     MOVEL*BLANK    $DOONA           Item Desc DRV
      * Item Desc DRV
      * Rtv Item Descriptions  RT - OM Item  * 
     C                     EXSR SORVGN
     C                     Z-ADD$DLKQT    P5KNNB           Total Sched Shi
      * Total-day 2
      * CASE: PAR.Generic Heading 2 is Equal Total
     C           P4MXTX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DLLQT           Qty Sched Ord 2
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DLLQT    P5KNNB           Total Sched Shi
     C                     ADD  $DLLQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 3
      * CASE: PAR.Generic Heading 3 is Equal Total
     C           P4MYTX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DLVQT           Qty Sched Ord 3
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DLVQT    P5KNNB           Total Sched Shi
     C                     ADD  $DLVQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 4
      * CASE: PAR.Generic Heading 4 is Equal Total
     C           P4MZTX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMOQT           Qty Sched Ord 4
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMOQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMOQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 5
      * CASE: PAR.Generic Heading 5 is Equal Total
     C           P4M0TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMPQT           Qty Sched Ord 5
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMPQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMPQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 6
      * CASE: PAR.Generic Heading 6 is Equal Total
     C           P4M1TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMQQT           Qty Sched Ord 6
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMQQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMQQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 7
      * CASE: PAR.Generic Heading 7 is Equal Total
     C           P4M2TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMRQT           Qty Sched Ord 7
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMRQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMRQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 8
      * CASE: PAR.Generic Heading 8 is Equal Total
     C           P4M3TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMUQT           Qty Sched Ord 8
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMUQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMUQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 9
      * CASE: PAR.Generic Heading 9 is Equal Total
     C           P4M4TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMVQT           Qty Sched Ord 9
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMVQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMVQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 10
      * CASE: PAR.Generic Heading 10 is Equal Total
     C           P4M5TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMWQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMWQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMWQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 11
      * CASE: PAR.Generic Heading 11 is Equal Total
     C           P4M6TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMXQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMXQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMXQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 12
      * CASE: PAR.Generic Heading 12 is Equal Total
     C           P4M7TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMYQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMYQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMYQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 13
      * CASE: PAR.Generic Heading 13 is Equal Total
     C           P4M8TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DMZQT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DMZQT    P5KNNB           Total Sched Shi
     C                     ADD  $DMZQT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 14
      * CASE: PAR.Generic Heading 14 is Equal Total
     C           P4M9TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DM0QT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DM0QT    P5KNNB           Total Sched Shi
     C                     ADD  $DM0QT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 15
      * CASE: PAR.Generic Heading 15 is Equal Total
     C           P4Y5TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DM6QT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DM6QT    P5KNNB           Total Sched Shi
     C                     ADD  $DM6QT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Total-day 16
      * CASE: PAR.Generic Heading 16 is Equal Total
     C           P4Y6TX    IFEQ 'Total'                    *IF
     C                     Z-ADDP5KNNB    $DM7QT           Qty Sched Ord 1
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  $DM7QT    P5KNNB           Total Sched Shi
     C                     ADD  $DM7QT    P6LGNB           Grand Total Sch
     C                     END                             *FI
      * Rtv Picked Qty Tot    RT - PFS Inventory Adjustment  * 
     C                     EXSR SPRVGN
      * dont print line if all fields are zero
      * CASE:
      *  - c1ANDc2ANDc3ANDc4ANDc5ANDc6ANDc7ANDc8ANDc9ANDc10ANDc11ANDc12A
      *  - NDc14ANDc15ANDc16ANDc17ANDc18ANDc19ANDc20
      *   |- c1    : CUR.Qty On-Hand USR is EQ Zero
      *   |- c2    : CUR.Qty Sched Prod 1 USR is EQ Zero
      *   |- c3    : CUR.Qty Sched Ord 1 USR is EQ Zero
      *   |- c4    : CUR.Qty EOD Inv 1 USR is EQ Zero
      *   |- c5    : CUR.Qty Sched Ord 2 USR is EQ Zero
      *   |- c6    : CUR.Qty Sched Ord 3 USR is EQ Zero
      *   |- c7    : CUR.Qty Sched Ord 4 USR EQ WRK.ZERO
      *   |- c8    : CUR.Qty Sched Ord 5 USR EQ WRK.ZERO
      *   |- c9    : CUR.Qty Sched Ord 6 USR EQ WRK.ZERO
      *   |- c10   : CUR.Qty Sched Ord 7 USR EQ WRK.ZERO
      *   |- c11   : CUR.Qty Sched Ord 8 USR is EQ Zero
      *   |- c12   : CUR.Qty Sched Ord 9 USR is EQ Zero
      *   |- c14   : CUR.Qty Sched Ord 10 USR is EQ Zero
      *   |- c15   : CUR.Qty Sched Ord 11 USR is EQ Zero
      *   |- c16   : CUR.Qty Sched Ord 12 USR is EQ Zero
      *   |- c17   : CUR.Qty Sched Ord 13 USR is EQ Zero
      *   |- c18   : CUR.Qty Sched Ord 14 USR is EQ Zero
      *   |- c19   : CUR.Qty Sched Ord 15 USR is EQ Zero
      *   |- c20   : CUR.Qty Sched Ord 16 USR is EQ Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           $DLEQT    IFEQ *ZERO                      *IF
     C           $DLIQT    IFEQ *ZERO                      *IF
     C           $DLKQT    IFEQ *ZERO                      *IF
     C           $DLGQT    IFEQ *ZERO                      *IF
     C           $DLLQT    IFEQ *ZERO                      *IF
     C           $DLVQT    IFEQ *ZERO                      *IF
     C           $DMOQT    IFEQ WUW0NB                     *IF
     C           $DMPQT    IFEQ WUW0NB                     *IF
     C           $DMQQT    IFEQ WUW0NB                     *IF
     C           $DMRQT    IFEQ WUW0NB                     *IF
     C           $DMUQT    IFEQ *ZERO                      *IF
     C           $DMVQT    IFEQ *ZERO                      *IF
     C           $DMWQT    IFEQ *ZERO                      *IF
     C           $DMXQT    IFEQ *ZERO                      *IF
     C           $DMYQT    IFEQ *ZERO                      *IF
     C           $DMZQT    IFEQ *ZERO                      *IF
     C           $DM0QT    IFEQ *ZERO                      *IF
     C           $DM6QT    IFEQ *ZERO                      *IF
     C           $DM7QT    IFEQ *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $DHGCD    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$DHGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VDHGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VDHGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$DCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$DDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Today PA          PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  5         W0FSUM
     C                     END                             FI
      *
      * * Company Number of Prt Today PA          PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * Availability Group Code of Prt Today PA          PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Item Display Sequence of Prt Today PA          PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Today PA          PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD2         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv PA Shipdate-21+SunRT - Calendar  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD1         WUCNTU           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN AFAIC3    WQSC01           Company Number
      * Define keylist
     C           KPSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           AFBCDT           Post to G/L Dat
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDP1AIC3    WQSC01           Company Number
     C                     Z-ADDP2JEDT    AFBCDT           Post to G/L Dat
      * Establish starting position
     C           KPSSC     SETLL@AFREBE                    *
     C           KRSSC     READE@AFREBE                  90*
      * Data record not found
     C   90                MOVEL'USR0018' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: WRK.Count USR is GT 21
     C           WUCNTU    IFGT 21                         *IF
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: *OTHERWISE
      * Move Date
      * CASE: WRK.Count USR is One
     C           WUCNTU    IFEQ 1                          *IF
      *
     C                     MOVEL*BLANK    WN0001  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0002  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0003  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0004  2        Month (Char) US
     C                     MOVEL*BLANK    WN0005  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0002           Date (Alpha) US
     C                     MOVELAFBCDT    WN0002           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0002:ZQ WN0003    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0002:ZQ WN0004    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0002:ZQ WN0005    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0004    CAT  WN0005:ZQ WN0001    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0001    CAT  WN0003:ZQ WN0001    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0001    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4MWTX           Generic Heading
     C                     MOVELWUCLC6    P4MWTX           Generic Heading
     C                     Z-ADDAFBCDT    YL0001           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4MXTX           Generic Heading
     C                     MOVEL'Total'   P4MXTX           Generic Heading
     C                     Z-ADD0         YL0002           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUCNTU    IFEQ 2                          *IF
      *
     C                     MOVEL*BLANK    WN0006  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0007  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0008  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0009  2        Month (Char) US
     C                     MOVEL*BLANK    WN0010  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0007           Date (Alpha) US
     C                     MOVELAFBCDT    WN0007           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0007:ZQ WN0008    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0007:ZQ WN0009    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0007:ZQ WN0010    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0009    CAT  WN0010:ZQ WN0006    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0006    CAT  WN0008:ZQ WN0006    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0006    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4MXTX           Generic Heading
     C                     MOVELWUCLC6    P4MXTX           Generic Heading
     C                     Z-ADDAFBCDT    YL0002           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4MYTX           Generic Heading
     C                     MOVEL'Total'   P4MYTX           Generic Heading
     C                     Z-ADD0         YL0003           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUCNTU    IFEQ 3                          *IF
      *
     C                     MOVEL*BLANK    WN0011  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0012  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0013  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0014  2        Month (Char) US
     C                     MOVEL*BLANK    WN0015  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0012           Date (Alpha) US
     C                     MOVELAFBCDT    WN0012           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0012:ZQ WN0013    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0012:ZQ WN0014    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0012:ZQ WN0015    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0014    CAT  WN0015:ZQ WN0011    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0011    CAT  WN0013:ZQ WN0011    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0011    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4MYTX           Generic Heading
     C                     MOVELWUCLC6    P4MYTX           Generic Heading
     C                     Z-ADDAFBCDT    YL0003           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4MZTX           Generic Heading
     C                     MOVEL'Total'   P4MZTX           Generic Heading
     C                     Z-ADD0         YL0004           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Four
     C           WUCNTU    IFEQ 4                          *IF
      *
     C                     MOVEL*BLANK    WN0016  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0017  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0018  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0019  2        Month (Char) US
     C                     MOVEL*BLANK    WN0020  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0017           Date (Alpha) US
     C                     MOVELAFBCDT    WN0017           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0017:ZQ WN0018    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0017:ZQ WN0019    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0017:ZQ WN0020    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0019    CAT  WN0020:ZQ WN0016    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0016    CAT  WN0018:ZQ WN0016    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0016    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4MZTX           Generic Heading
     C                     MOVELWUCLC6    P4MZTX           Generic Heading
     C                     Z-ADDAFBCDT    YL0004           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M0TX           Generic Heading
     C                     MOVEL'Total'   P4M0TX           Generic Heading
     C                     Z-ADD0         YL0005           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Five
     C           WUCNTU    IFEQ 5                          *IF
      *
     C                     MOVEL*BLANK    WN0021  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0022  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0023  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0024  2        Month (Char) US
     C                     MOVEL*BLANK    WN0025  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0022           Date (Alpha) US
     C                     MOVELAFBCDT    WN0022           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0022:ZQ WN0023    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0022:ZQ WN0024    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0022:ZQ WN0025    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0024    CAT  WN0025:ZQ WN0021    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0021    CAT  WN0023:ZQ WN0021    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0021    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M0TX           Generic Heading
     C                     MOVELWUCLC6    P4M0TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0005           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M1TX           Generic Heading
     C                     MOVEL'Total'   P4M1TX           Generic Heading
     C                     Z-ADD0         YL0006           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Six
     C           WUCNTU    IFEQ 6                          *IF
      *
     C                     MOVEL*BLANK    WN0026  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0027  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0028  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0029  2        Month (Char) US
     C                     MOVEL*BLANK    WN0030  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0027           Date (Alpha) US
     C                     MOVELAFBCDT    WN0027           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0027:ZQ WN0028    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0027:ZQ WN0029    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0027:ZQ WN0030    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0029    CAT  WN0030:ZQ WN0026    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0026    CAT  WN0028:ZQ WN0026    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0026    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M1TX           Generic Heading
     C                     MOVELWUCLC6    P4M1TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0006           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M2TX           Generic Heading
     C                     MOVEL'Total'   P4M2TX           Generic Heading
     C                     Z-ADD0         YL0007           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Seven
     C           WUCNTU    IFEQ 7                          *IF
      *
     C                     MOVEL*BLANK    WN0031  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0032  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0033  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0034  2        Month (Char) US
     C                     MOVEL*BLANK    WN0035  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0032           Date (Alpha) US
     C                     MOVELAFBCDT    WN0032           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0032:ZQ WN0033    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0032:ZQ WN0034    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0032:ZQ WN0035    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0034    CAT  WN0035:ZQ WN0031    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0031    CAT  WN0033:ZQ WN0031    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0031    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M2TX           Generic Heading
     C                     MOVELWUCLC6    P4M2TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0007           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M3TX           Generic Heading
     C                     MOVEL'Total'   P4M3TX           Generic Heading
     C                     Z-ADD0         YL0008           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Eight
     C           WUCNTU    IFEQ 8                          *IF
      *
     C                     MOVEL*BLANK    WN0036  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0037  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0038  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0039  2        Month (Char) US
     C                     MOVEL*BLANK    WN0040  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0037           Date (Alpha) US
     C                     MOVELAFBCDT    WN0037           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0037:ZQ WN0038    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0037:ZQ WN0039    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0037:ZQ WN0040    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0039    CAT  WN0040:ZQ WN0036    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0036    CAT  WN0038:ZQ WN0036    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0036    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M3TX           Generic Heading
     C                     MOVELWUCLC6    P4M3TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0008           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M4TX           Generic Heading
     C                     MOVEL'Total'   P4M4TX           Generic Heading
     C                     Z-ADD0         YL0009           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Nine
     C           WUCNTU    IFEQ 9                          *IF
      *
     C                     MOVEL*BLANK    WN0041  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0042  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0043  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0044  2        Month (Char) US
     C                     MOVEL*BLANK    WN0045  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0042           Date (Alpha) US
     C                     MOVELAFBCDT    WN0042           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0042:ZQ WN0043    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0042:ZQ WN0044    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0042:ZQ WN0045    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0044    CAT  WN0045:ZQ WN0041    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0041    CAT  WN0043:ZQ WN0041    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0041    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M4TX           Generic Heading
     C                     MOVELWUCLC6    P4M4TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0009           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M5TX           Generic Heading
     C                     MOVEL'Total'   P4M5TX           Generic Heading
     C                     Z-ADD0         YL0010           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Ten
     C           WUCNTU    IFEQ 10                         *IF
      *
     C                     MOVEL*BLANK    WN0046  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0047  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0048  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0049  2        Month (Char) US
     C                     MOVEL*BLANK    WN0050  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0047           Date (Alpha) US
     C                     MOVELAFBCDT    WN0047           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0047:ZQ WN0048    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0047:ZQ WN0049    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0047:ZQ WN0050    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0049    CAT  WN0050:ZQ WN0046    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0046    CAT  WN0048:ZQ WN0046    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0046    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M5TX           Generic Heading
     C                     MOVELWUCLC6    P4M5TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0010           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M6TX           Generic Heading
     C                     MOVEL'Total'   P4M6TX           Generic Heading
     C                     Z-ADD0         YL0011           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Eleven
     C           WUCNTU    IFEQ 11                         *IF
      *
     C                     MOVEL*BLANK    WN0051  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0052  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0053  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0054  2        Month (Char) US
     C                     MOVEL*BLANK    WN0055  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0052           Date (Alpha) US
     C                     MOVELAFBCDT    WN0052           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0052:ZQ WN0053    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0052:ZQ WN0054    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0052:ZQ WN0055    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0054    CAT  WN0055:ZQ WN0051    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0051    CAT  WN0053:ZQ WN0051    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0051    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M6TX           Generic Heading
     C                     MOVELWUCLC6    P4M6TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0011           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M7TX           Generic Heading
     C                     MOVEL'Total'   P4M7TX           Generic Heading
     C                     Z-ADD0         YL0012           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Twelve
     C           WUCNTU    IFEQ 12                         *IF
      *
     C                     MOVEL*BLANK    WN0056  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0057  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0058  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0059  2        Month (Char) US
     C                     MOVEL*BLANK    WN0060  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0057           Date (Alpha) US
     C                     MOVELAFBCDT    WN0057           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0057:ZQ WN0058    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0057:ZQ WN0059    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0057:ZQ WN0060    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0059    CAT  WN0060:ZQ WN0056    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0056    CAT  WN0058:ZQ WN0056    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0056    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M7TX           Generic Heading
     C                     MOVELWUCLC6    P4M7TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0012           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M8TX           Generic Heading
     C                     MOVEL'Total'   P4M8TX           Generic Heading
     C                     Z-ADD0         YL0013           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Thirteen
     C           WUCNTU    IFEQ 13                         *IF
      *
     C                     MOVEL*BLANK    WN0061  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0062  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0063  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0064  2        Month (Char) US
     C                     MOVEL*BLANK    WN0065  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0062           Date (Alpha) US
     C                     MOVELAFBCDT    WN0062           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0062:ZQ WN0063    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0062:ZQ WN0064    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0062:ZQ WN0065    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0064    CAT  WN0065:ZQ WN0061    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0061    CAT  WN0063:ZQ WN0061    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0061    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M8TX           Generic Heading
     C                     MOVELWUCLC6    P4M8TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0013           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4M9TX           Generic Heading
     C                     MOVEL'Total'   P4M9TX           Generic Heading
     C                     Z-ADD0         YL0014           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Fourteen
     C           WUCNTU    IFEQ 14                         *IF
      *
     C                     MOVEL*BLANK    WN0066  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0067  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0068  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0069  2        Month (Char) US
     C                     MOVEL*BLANK    WN0070  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0067           Date (Alpha) US
     C                     MOVELAFBCDT    WN0067           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0067:ZQ WN0068    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0067:ZQ WN0069    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0067:ZQ WN0070    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0069    CAT  WN0070:ZQ WN0066    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0066    CAT  WN0068:ZQ WN0066    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0066    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4M9TX           Generic Heading
     C                     MOVELWUCLC6    P4M9TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0014           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4Y5TX           Generic Heading
     C                     MOVEL'Total'   P4Y5TX           Generic Heading
     C                     Z-ADD0         YL0015           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Fifteen
     C           WUCNTU    IFEQ 15                         *IF
      *
     C                     MOVEL*BLANK    WN0071  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0072  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0073  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0074  2        Month (Char) US
     C                     MOVEL*BLANK    WN0075  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0072           Date (Alpha) US
     C                     MOVELAFBCDT    WN0072           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0072:ZQ WN0073    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0072:ZQ WN0074    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0072:ZQ WN0075    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0074    CAT  WN0075:ZQ WN0071    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0071    CAT  WN0073:ZQ WN0071    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0071    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4Y5TX           Generic Heading
     C                     MOVELWUCLC6    P4Y5TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0015           Avail Ship Date
      * CASE: DB1.Day of Week is Sunday
     C           AFA9ST    IFEQ '1'                        *IF
     C                     MOVEL*BLANK    P4Y6TX           Generic Heading
     C                     MOVEL'Total'   P4Y6TX           Generic Heading
     C                     Z-ADD0         YL0016           Avail Ship Date
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.Count USR is Sixteen
     C           WUCNTU    IFEQ 16                         *IF
      *
     C                     MOVEL*BLANK    WN0076  6        Date (Char-6) U
     C                     MOVEL*BLANK    WN0077  7        Date (Alpha) US
     C                     MOVEL*BLANK    WN0078  2        Year  (Char) US
     C                     MOVEL*BLANK    WN0079  2        Month (Char) US
     C                     MOVEL*BLANK    WN0080  2        Day   (Char) US
      *
      * CNV cyymmdd to mmddyy
      * convert numeric date to character date.
     C                     MOVEL*BLANK    WN0077           Date (Alpha) US
     C                     MOVELAFBCDT    WN0077           Date (Alpha) US
      * extract month, day, and year.
     C                     Z-ADD2         YRSW00
     C                     Z-ADD2         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0077:ZQ WN0078    P  90  Year  (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0077:ZQ WN0079    P  90  Month (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     Z-ADD2         YRSW00
     C                     Z-ADD6         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00007
     C           ZQ        ORGT 00007
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWN0077:ZQ WN0080    P  90  Day   (Char) US
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
      * reconstruct date in mmddyy format.
     C                     Z-ADD0         ZQ      50
     C           WN0079    CAT  WN0080:ZQ WN0076    P      Date (Char-6) U
     C                     Z-ADD0         ZQ      50
     C           WN0076    CAT  WN0078:ZQ WN0076    P      Date (Char-6) U
      * convert character date to numeric date.
     C                     MOVE WN0076    WUCLC6           Date Out (6,0)
     C                     MOVEL*BLANK    P4Y6TX           Generic Heading
     C                     MOVELWUCLC6    P4Y6TX           Generic Heading
     C                     Z-ADDAFBCDT    YL0016           Avail Ship Date
     C                     ELSE
      * CASE: WRK.Count USR is Seventeen
     C           WUCNTU    IFEQ 17                         *IF
     C                     Z-ADDAFBCDT    YL0017           Avail Ship Date
     C                     ELSE
      * CASE: WRK.Count USR is Eighteen
     C           WUCNTU    IFEQ 18                         *IF
     C                     Z-ADDAFBCDT    YL0018           Avail Ship Date
     C                     ELSE
      * CASE: WRK.Count USR is Nineteen
     C           WUCNTU    IFEQ 19                         *IF
     C                     Z-ADDAFBCDT    YL0019           Avail Ship Date
     C                     ELSE
      * CASE: WRK.Count USR is Twenty
     C           WUCNTU    IFEQ 20                         *IF
     C                     Z-ADDAFBCDT    YL0020           Avail Ship Date
     C                     ELSE
      * CASE: WRK.Count USR is Twenty One
     C           WUCNTU    IFEQ 21                         *IF
     C                     Z-ADDAFBCDT    YL0021           Avail Ship Date
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ADD  1         WUCNTU           Count USR
     C                     END                             *FI
     C           KRSSC     READE@AFREBE                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Company Name       RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     Z-ADD$BAIC3    ABAIC3           Company Number
      * Establish starting position
     C           KRSSD     CHAIN@ABREG3              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0003' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BADTX           Name
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELABADTX    $BADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL$BAJCD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSE     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    $BF8NA           Warehouse Descr
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    $BF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Group Description  RT - Availability Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           KKV4CD           Availability Gr
      * Setup key
     C                     MOVEL$BV4CD    KKV4CD           Availability Gr
      * Establish starting position
     C           KRSSF     CHAIN@KKREG7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2215' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $BNVNA           Availability Gr
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELKKNVNA    $BNVNA           Availability Gr
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Pces/Bag,Bag/Unt,umRT - Company Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     Z-ADD$DAIC3    BZAIC3           Company Number
     C                     Z-ADD$DHGCD    BZHGCD           Item Code
      * Establish starting position
     C           KRSSG     CHAIN@BZREJU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0326' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBZAVNA    WUAVNA           Description Lin
     C                     MOVELBZADCD    $DADCD           U/M - Primary
     C                     Z-ADDBZAIWG    $DAIWG           Unit Weight
     C                     MOVELBZPCCT    WUPCCT           Piece Count Ite
     C                     Z-ADDBZBDNB    WUBDNB           Pieces Per Bag
     C                     Z-ADDBZBJNB    WUBJNB           Bags Per Unit
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Lot Tracking Flag RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WAAJCD           Warehouse Code
      * Setup key
     C                     MOVELWL0001    WAAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WL0002           Lot Tracking Fl
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAVHST    WL0002           Lot Tracking Fl
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Item Loc Qty Tot  RT - Item Lot Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0006           Quantity Loc On
      * Declare restrictor key work fields
     C           *LIKE     DEFN L5AIC3    WQSI01           Company Number
     C           *LIKE     DEFN L5HGCD    WQSI02           Item Code
     C           *LIKE     DEFN L5AJCD    WQSI03           Warehouse Code
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Item Code
     C                     KFLD           WQSI03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0003    WQSI01           Company Number
     C                     Z-ADDWL0004    WQSI02           Item Code
     C                     MOVELWL0005    WQSI03           Warehouse Code
      * Establish starting position
     C           KRSSI     SETLL@L5CPSV                    *
     C           KRSSI     READE@L5CPSV                  90*
      * Data record not found
     C   90                MOVEL'USR2634' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  L5J2QT    WL0006           Quantity Loc On
     C           KRSSI     READE@L5CPSV                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV On Hand Qty f/Whse RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQSJ01           Company Number
     C           *LIKE     DEFN B0AJCD    WQSJ02           Warehouse Code
     C           *LIKE     DEFN B0HGCD    WQSJ03           Item Code
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Warehouse Code
     C                     KFLD           WQSJ03           Item Code
      * Setup key
     C                     Z-ADDWL0007    WQSJ01           Company Number
     C                     MOVELWL0009    WQSJ02           Warehouse Code
     C                     Z-ADDWL0008    WQSJ03           Item Code
      * Establish starting position
     C           KRSSJ     SETLL@B0REHD                    *
     C           KRSSJ     READE@B0REHD                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B0DDQT    WL0010           On Hand U/M1 Su
     C           KRSSJ     READE@B0REHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Production        RT - PS Prod Item Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           I8AIC3           Company Number
     C                     KFLD           I8V5ST           Production Type
     C                     KFLD           I8ELDT           Production Date
     C                     KFLD           I8HGCD           Item Code
     C                     KFLD           I8AJCD           Warehouse Code
      * Setup key
     C                     Z-ADDWL0011    I8AIC3           Company Number
     C                     MOVELWL0012    I8V5ST           Production Type
     C                     Z-ADDWL0013    I8ELDT           Production Date
     C                     Z-ADDWL0014    I8HGCD           Item Code
     C                     MOVELWL0015    I8AJCD           Warehouse Code
      * Establish starting position
     C           KRSSK     CHAIN@I8CPUS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1763' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0016           Weight Producti
     C                     Z-ADD*ZERO     WL0017           Pieces Producti
     C                     MOVEL*BLANK    WL0018           PS Production W
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Weight Production
      * PAR.Weight Production USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Weight Standard
      * +     : PGM.*Synon (15,2) work field
      * x2    : DB1.PS Weight Prod Adj
      * -     : PGM.*Synon (15,2) work field
      * x3    : DB1.PS Weight Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Weight Whse Tfr Adj
     C           I8DXWG    ADD  I8D1WG    W0WA02           *Synon (15,2) w
     C           W0WA02    SUB  I8WTCN    W0WA01           *Synon (15,2) w
     C           W0WA01    SUB  I8GAWG    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0016           Weight Producti
      * Pieces Production
      * PAR.Pieces Production USR =
      *    *COMPUTE (x1 + x2 - x3 - x4)
      * x1    : DB1.PS Pieces Standard
      * +     : PGM.*Synon (15,0) work field
      * x2    : DB1.PS Pieces Prod Adj
      * -     : PGM.*Synon (15,0) work field
      * x3    : DB1.PS Pieces Converted
      * -     : PGM.*Synon (17,7) work field
      * x4    : DB1.PS Pieces Whse Tfr Adj
     C           I8B2NB    ADD  I8CBNB    W0WJ02           *Synon (15,0) w
     C           W0WJ02    SUB  I8PSCV    W0WJ01           *Synon (15,0) w
     C           W0WJ01    SUB  I8BPNB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    WL0017           Pieces Producti
     C                     MOVELI8B7ST    WL0018           PS Production W
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Sched Ship ALL    RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0023           Weight Schedule
     C                     Z-ADD0         WL0024           Quantity Schedu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSL01           Company Number
     C           *LIKE     DEFN OMHGCD    WQSL02           Item Code
     C           *LIKE     DEFN OMAJCD    WQSL03           Warehouse Code
      * Define keylist
     C           KPSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
     C                     KFLD           WQSL03           Warehouse Code
     C                     KFLD           OMAODT           Scheduled Ship
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Item Code
     C                     KFLD           WQSL03           Warehouse Code
      * Setup key
     C                     Z-ADDWL0019    WQSL01           Company Number
     C                     Z-ADDWL0020    WQSL02           Item Code
     C                     MOVELWL0021    WQSL03           Warehouse Code
     C                     Z-ADDWL0022    OMAODT           Scheduled Ship
      * Establish starting position
     C           KPSSL     SETLL@BGWKKG                    *
     C           KRSSL     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0026           Company Number
     C                     Z-ADDOMC4NB    WL0027           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUGWST    P      Header Status
     C                     MOVELWL0029    WUOBST    P      Billing Activit
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Header Status is Not Comp/Canc/Conf
      *   |- c2    : WRK.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUGWST    IFEQ 'L'                        *IF
     C           WUGWST    OREQ 'A'
     C           WUGWST    OREQ 'E'
     C           WUGWST    OREQ 'H'
     C           WUOBST    IFEQ '1'                        *IF
     C           WUOBST    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Status Flag 10 Y/N is Yes
     C           WL0025    IFEQ 'Y'                        *IF
      * FP1054 if Yes, accum Scheduled qty & wgt as it was before
     C                     ADD  OMAUWG    WL0023           Weight Schedule
     C                     ADD  OMCCQT    WL0024           Quantity Schedu
     C                     ELSE
      * CASE: *OTHERWISE
      * FP1054 if no, accum Ordered & qty & wgt
     C                     ADD  OMD0WG    WL0023           Weight Schedule
     C                     ADD  OMAVQT    WL0024           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSL     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADDWL0026    BEAIC3           Company Number
     C                     Z-ADDWL0027    BEC4NB           Order Number
      * Establish starting position
     C           KRSSM     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBEGWST    WL0028           Header Status
     C                     MOVELBEOBST    WL0029           Billing Activit
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Sched Shipments   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0034           Weight Schedule
     C                     Z-ADD0         WL0035           Quantity Schedu
      * Declare restrictor key work fields
     C           *LIKE     DEFN OMAIC3    WQSN01           Company Number
     C           *LIKE     DEFN OMHGCD    WQSN02           Item Code
     C           *LIKE     DEFN OMAJCD    WQSN03           Warehouse Code
     C           *LIKE     DEFN OMAODT    WQSN04           Scheduled Ship
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Item Code
     C                     KFLD           WQSN03           Warehouse Code
     C                     KFLD           WQSN04           Scheduled Ship
      * Setup key
     C                     Z-ADDWL0030    WQSN01           Company Number
     C                     Z-ADDWL0031    WQSN02           Item Code
     C                     MOVELWL0032    WQSN03           Warehouse Code
     C                     Z-ADDWL0033    WQSN04           Scheduled Ship
      * Establish starting position
     C           KRSSN     SETLL@BGWKKG                    *
     C           KRSSN     READE@BGWKKG                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Hdr Sts,BillActTy RT - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDOMAIC3    WL0026           Company Number
     C                     Z-ADDOMC4NB    WL0027           Order Number
     C                     EXSR SMRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0028    WUGWST    P      Header Status
     C                     MOVELWL0029    WUOBST    P      Billing Activit
      * CASE:
      *  - c1ANDc2
      *   |- c1    : WRK.Header Status is Not Comp/Canc/Conf
      *   |- c2    : WRK.Billing Activity Type is Invoice or Transfer
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUGWST    IFEQ 'L'                        *IF
     C           WUGWST    OREQ 'A'
     C           WUGWST    OREQ 'E'
     C           WUGWST    OREQ 'H'
     C           WUOBST    IFEQ '1'                        *IF
     C           WUOBST    OREQ '4'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE: PAR.Ord/Sch Sts USR is Scheduled
     C           WL0036    IFEQ 'S'                        *IF
     C                     ADD  OMAUWG    WL0034           Weight Schedule
     C                     ADD  OMCCQT    WL0035           Quantity Schedu
     C                     ELSE
      * CASE: PAR.Ord/Sch Sts USR is Ordered
     C           WL0036    IFEQ 'O'                        *IF
     C                     ADD  OMD0WG    WL0034           Weight Schedule
     C                     ADD  OMAVQT    WL0035           Quantity Schedu
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSN     READE@BGWKKG                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Item Descriptions  RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD$DHGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSSO     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    $DOONA           Description Lin
     C                     MOVEL*BLANK    WUAWNA           Description Lin
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    $DOONA           Description Lin
     C                     MOVELBYAWNA    WUAWNA           Description Lin
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Picked Qty Tot    RT - PFS Inventory Adjustment  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     $DKCQT           Quantity Picked
      * Declare restrictor key work fields
     C           *LIKE     DEFN BGY1NX    WQSP01           PFS Company Num
     C           *LIKE     DEFN BGU4SX    WQSP02           PFS Warehouse C
     C           *LIKE     DEFN BGY2NX    WQSP03           PFS Item Code
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           PFS Company Num
     C                     KFLD           WQSP02           PFS Warehouse C
     C                     KFLD           WQSP03           PFS Item Code
      * Setup key
     C                     Z-ADD$DAIC3    WQSP01           PFS Company Num
     C                     MOVELP2AJCD    WQSP02           PFS Warehouse C
     C                     Z-ADD$DHGCD    WQSP03           PFS Item Code
      * Establish starting position
     C           KRSSP     SETLL@BGCPEG                    *
     C           KRSSP     READE@BGCPEG                  90*
      * Data record not found
     C   90                MOVEL'USR3496' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1ORc2
      *   |- c1    : DB1.PFS Transaction Type is SM: Ship Regular Order
      *   |- c2    : DB1.PFS Transaction Type is SM: Transfer Order
      *   '-
     C           BGVLSX    IFEQ 'S01'                      *IF
     C           BGVLSX    OREQ 'S02'                      *OR
     C                     ADD  BGBDNY    $DKCQT           Quantity Picked
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  BGBDNY    $DKCQT           Quantity Picked
     C                     END                             *FI
     C           KRSSP     READE@BGCPEG                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2FFDT           USR Day 1
     C                     Z-ADD*ZERO     P2E1DT           USR Day 2
     C                     Z-ADD*ZERO     P2E2DT           USR Day 3
     C                     Z-ADD*ZERO     P2E3DT           USR Day 4
     C                     Z-ADD*ZERO     P2E4DT           USR Day 5
     C                     Z-ADD*ZERO     P3E5DT           USR Day 6
     C                     Z-ADD*ZERO     P3E6DT           USR Day 7
     C                     Z-ADD*ZERO     P3FKDT           USR Day 8
     C                     Z-ADD*ZERO     P3FLDT           USR Day 9
     C                     Z-ADD*ZERO     P3FGDT           USR Day 10
     C                     Z-ADD*ZERO     P3FHDT           USR Day 11
     C                     Z-ADD*ZERO     P3FIDT           USR Day 12
     C                     Z-ADD*ZERO     P3FJDT           USR Day 13
     C                     Z-ADD*ZERO     P3HPDT           USR Day 14
     C                     Z-ADD*ZERO     P3HQDT           USR Day 15
     C                     Z-ADD*ZERO     P3HRDT           USR Day 16
     C                     MOVEL*BLANK    P4MWTX           Generic Heading
     C                     MOVEL*BLANK    P4MXTX           Generic Heading
     C                     MOVEL*BLANK    P4MYTX           Generic Heading
     C                     MOVEL*BLANK    P4MZTX           Generic Heading
     C                     MOVEL*BLANK    P4M0TX           Generic Heading
     C                     MOVEL*BLANK    P4M1TX           Generic Heading
     C                     MOVEL*BLANK    P4M2TX           Generic Heading
     C                     MOVEL*BLANK    P4M3TX           Generic Heading
     C                     MOVEL*BLANK    P4M4TX           Generic Heading
     C                     MOVEL*BLANK    P4M5TX           Generic Heading
     C                     MOVEL*BLANK    P4M6TX           Generic Heading
     C                     MOVEL*BLANK    P4M7TX           Generic Heading
     C                     MOVEL*BLANK    P4M8TX           Generic Heading
     C                     MOVEL*BLANK    P4M9TX           Generic Heading
     C                     MOVEL*BLANK    P4DFST           Display Line Fl
     C                     MOVEL*BLANK    P4Y5TX           Generic Heading
     C                     MOVEL*BLANK    P4Y6TX           Generic Heading
     C                     Z-ADD*ZERO     P5KNNB           Total Sched Shi
     C                     Z-ADD*ZERO     P6LGNB           Grand Total Sch
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field @Calc 6,0
     C                     Z-ADD*ZERO     WUCLC6  60
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    KLAIC3           Company Number
     C                     MOVEL*LOVAL    KLV4CD           Availability Gr
     C                     MOVEL*LOVAL    KLIDSQ           Item Display Se
     C                     MOVEL*LOVAL    KLHGCD           Item Code
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Define work field Vertical Line 1
     C                     MOVEL*BLANK    WUZRTX  1
      * Define work field Generic Heading
     C                     MOVEL*BLANK    WUNATX  8
      * Define work field Vertical Line 2
     C                     MOVEL*BLANK    WUZCTX  1
      * Define work field Vertical Line 3
     C                     MOVEL*BLANK    WUZDTX  1
      * Define work field Vertical Line 4
     C                     MOVEL*BLANK    WUZETX  1
      * Define work field Vertical Line 5
     C                     MOVEL*BLANK    WUZFTX  1
      * Define work field Vertical Line 6
     C                     MOVEL*BLANK    WUZGTX  1
      * Define work field Vertical Line 7
     C                     MOVEL*BLANK    WUZHTX  1
      * Define work field Vertical Line 8
     C                     MOVEL*BLANK    WUZITX  1
      * Define work field Vertical Line 9
     C                     MOVEL*BLANK    WUZJTX  1
      * Define work field Vertical Line 10
     C                     MOVEL*BLANK    WUZKTX  1
      * Define work field Vertical Line 11
     C                     MOVEL*BLANK    WUZLTX  1
      * Define work field Vertical Line 12
     C                     MOVEL*BLANK    WUZMTX  1
      * Define work field Vertical Line 13
     C                     MOVEL*BLANK    WUZNTX  1
      * Define work field Vertical Line 14
     C                     MOVEL*BLANK    WUZOTX  1
      * Define work field Vertical Line 15
     C                     MOVEL*BLANK    WUZPTX  1
      * Define work field Vertical Line 16
     C                     MOVEL*BLANK    WUZQTX  1
      * Define work field Description Line One
     C                     MOVEL*BLANK    WUAVNA 30
      * Define work field Piece Count Item
     C                     MOVEL*BLANK    WUPCCT  1
      * Define work field Pieces Per Bag
     C                     Z-ADD*ZERO     WUBDNB  70
      * Define work field Bags Per Unit
     C                     Z-ADD*ZERO     WUBJNB  70
      * Define work field Qty Produced USR
     C                     Z-ADD*ZERO     WULOQT  50
      * Define work field Qty Remaining Prod USR
     C                     Z-ADD*ZERO     WULFQT  50
      * Define work field Qty EOD Inv 2 USR
     C                     Z-ADD*ZERO     WULHQT  50
      * Define work field Qty Prod Needed 2 USR
     C                     Z-ADD*ZERO     WULMQT  50
      * Define work field Qty Prod Adjusted 2 USR
     C                     Z-ADD*ZERO     WULNQT  50
      * Define work field Qty Sched Prod 2 USR
     C                     Z-ADD*ZERO     WULJQT  50
      * Define work field Qty EOD Inv 3 USR
     C                     Z-ADD*ZERO     WULRQT  50
      * Define work field Qty Prod Needed 3 USR
     C                     Z-ADD*ZERO     WULUQT  50
      * Define work field Qty Prod Adjusted 3 USR
     C                     Z-ADD*ZERO     WULTQT  50
      * Define work field Qty Sched Prod 3 USR
     C                     Z-ADD*ZERO     WULWQT  50
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WADBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WABWC3           Shipping Compan
     C                     Z-ADD*ZERO     WABTC3           Accounting Comp
     C                     Z-ADD*ZERO     WABUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WABVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Define work field Weight Scheduled SUM
     C                     Z-ADD*ZERO     WUEEWG 112
      * Define work field Header Status
     C                     MOVEL*BLANK    WUGWST  1
      * Define work field Billing Activity Type
     C                     MOVEL*BLANK    WUOBST  1
      * Define work field Description Line Two
     C                     MOVEL*BLANK    WUAWNA 30
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WJ02 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ01 150       *Synon (15,0) w
     C                     Z-ADD*ZEROS    W0WJ00 150       *Synon (15,0) w
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SHRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  1
      * Define local variables for subroutine SIRVGN.
     C                     Z-ADD*ZERO     WL0003  30
     C                     Z-ADD*ZERO     WL0004  70
     C                     MOVEL*BLANK    WL0005  3
     C                     Z-ADD*ZERO     WL0006  70
      * Define local variables for subroutine SJRVGN.
     C                     Z-ADD*ZERO     WL0007  30
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  3
     C                     Z-ADD*ZERO     WL0010 112
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     MOVEL*BLANK    WL0012  1
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  70
     C                     MOVEL*BLANK    WL0015  3
     C                     Z-ADD*ZERO     WL0016  92
     C                     Z-ADD*ZERO     WL0017  70
     C                     MOVEL*BLANK    WL0018  3
      * Define local variables for subroutine SLRVGN.
     C                     Z-ADD*ZERO     WL0019  30
     C                     Z-ADD*ZERO     WL0020  70
     C                     MOVEL*BLANK    WL0021  3
     C                     Z-ADD*ZERO     WL0022  70
     C                     Z-ADD*ZERO     WL0023 112
     C                     Z-ADD*ZERO     WL0024 112
     C                     MOVEL*BLANK    WL0025  1
      * Define local variables for subroutine SMRVGN.
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027  70
     C                     MOVEL*BLANK    WL0028  1
     C                     MOVEL*BLANK    WL0029  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0030  30
     C                     Z-ADD*ZERO     WL0031  70
     C                     MOVEL*BLANK    WL0032  3
     C                     Z-ADD*ZERO     WL0033  70
     C                     Z-ADD*ZERO     WL0034 112
     C                     Z-ADD*ZERO     WL0035 112
     C                     MOVEL*BLANK    WL0036  1
      * Define local work field Avail Ship Date 1 USR
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Avail Ship Date 2 USR
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Avail Ship Date 3 USR
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Avail Ship Date 4 USR
     C                     Z-ADD*ZERO     YL0004  70
      * Define local work field Avail Ship Date 5 USR
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Avail Ship Date 6 USR
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Avail Ship Date 7 USR
     C                     Z-ADD*ZERO     YL0007  70
      * Define local work field Avail Ship Date 8 USR
     C                     Z-ADD*ZERO     YL0008  70
      * Define local work field Avail Ship Date 9 USR
     C                     Z-ADD*ZERO     YL0009  70
      * Define local work field Avail Ship Date 10 USR
     C                     Z-ADD*ZERO     YL0010  70
      * Define local work field Avail Ship Date 11 USR
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Avail Ship Date 12 USR
     C                     Z-ADD*ZERO     YL0012  70
      * Define local work field Avail Ship Date 13 USR
     C                     Z-ADD*ZERO     YL0013  70
      * Define local work field Avail Ship Date 14 USR
     C                     Z-ADD*ZERO     YL0014  70
      * Define local work field Avail Ship Date 15 USR
     C                     Z-ADD*ZERO     YL0015  70
      * Define local work field Avail Ship Date 16 USR
     C                     Z-ADD*ZERO     YL0016  70
      * Define local work field Avail Ship Date 17 USR
     C                     Z-ADD*ZERO     YL0017  70
      * Define local work field Avail Ship Date 18 USR
     C                     Z-ADD*ZERO     YL0018  70
      * Define local work field Avail Ship Date 19 USR
     C                     Z-ADD*ZERO     YL0019  70
      * Define local work field Avail Ship Date 20 USR
     C                     Z-ADD*ZERO     YL0020  70
      * Define local work field Avail Ship Date 21 USR
     C                     Z-ADD*ZERO     YL0021  70
      * Define local work field Lot Tracking Flag
     C                     MOVEL*BLANK    YL0022  1
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * RMC 9/04/17        if cur.unit weight = 0, then set to 1
      * RMC 8/22/06 PFS019 print picked qty column
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
      * Rtv PA Shipdate-21+SunRT - Calendar  * 
     C                     EXSR SCRVGN
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
