     H/TITLE EDT Company Item      E3  Edit record(3 screens)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by  : SYNON/2  Version:  1500
     H* Function type : Edit record(3 screens)
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISPPATE
     H* Date          : 09/03/97  Time  : 11:07:07
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPDI9E3R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: EDT Company Item      E3  Edit record(3 screens)
      *
     FCABZREL1IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Company/Item              Retrieval index       NV
      *
     FOMBYREL1IF  E           K        DISK
      * RTV : OM Item                   Retrieval index
      *
     FCADPREL1IF  E           K        DISK
      * RTV : System Values             Retrieval index       NV
      *
     FCAB0REL1IF  E           K        DISK
      * RTV : IC Item Balance           Retrieval index       NV
      *
     FCAB1REL0IF  E           K        DISK
      * RTV : IC Item Balance Detail    Retrieval index       NV
      *
     FCAAIREL1IF  E           K        DISK
      * RTV : Quality Level             Retrieval index       NV
      *
     FPDILREL0IF  E           K        DISK
      * RTV : PD Item Level             Retrieval index
      *
     FOMFAREL1IF  E           K        DISK
      * RTV : OM Item Structure Class   Retrieval index
      *
     FPDJGREL1IF  E           K        DISK
      * RTV : PD Item Category Unused   Retrieval index
      *
     FOMFYREL0IF  E           K        DISK
      * RTV : OM Commodity Markets      Retrieval index
      *
     FOMFZREL0IF  E           K        DISK
      * RTV : OM Commodity Group        Retrieval index
      *
     FPDIHREL0IF  E           K        DISK
      * RTV : PD Price Method Header    Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FPDI5REL1IF  E           K        DISK
      * RTV : PS Production Department  Retrieval index
      *
     FCABJREL1IF  E           K        DISK
      * RTV : Vendor                    Retrieval index       NV
      *
     FCAAMREL1IF  E           K        DISK
      * RTV : Unit of Measure           Retrieval index       NV
      *
     FPDLLREL1IF  E           K        DISK
      * RTV : PS Primal Group           Retrieval index
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FOMBYREL2IF  E           K        DISK
      * RTV : OM Item                   Active Only
      *
     FCAAMREL3IF  E           K        DISK
      * RTV : Unit of Measure           Active Records
      *
     FCAAIREL3IF  E           K        DISK
      * RTV : Quality Level             Active Only
      *
     FPDILREL3IF  E           K        DISK
      * RTV : PD Item Level             Active Only
      *
     FCABJREL5IF  E           K        DISK
      * RTV : Vendor                    Retrieve Active Records
      *
     FOMFAREL3IF  E           K        DISK
      * RTV : OM Item Structure Class   Active Only
      *
     FOME9REL0IF  E           K        DISK
      * RTV : OM Item Structure Group   Retrieval index
      *
     FOME8REL0IF  E           K        DISK
      * RTV : OM Item Structure Type    Retrieval index
      *
     FOMFZREL2IF  E           K        DISK
      * RTV : OM Commodity Group        Active Only
      *
     FPDJIREL0IF  E           K        DISK
      * RTV : PD Item Category          Retrieval index
      *
     FPMG1REL0IF  E           K        DISK
      * RTV : PM R/M Type Master        Retrieval index
      *
     FPMG2REL1IF  E           K        DISK
      * RTV : PM Line Master            Retrieval index
      *
     FCAB7CPL1IF  E           K        DISK
      * RTV : IC Transaction Detail     Retrieval index       NV
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAB0REL0UF  E           K        DISK
      * UPD : IC Item Balance           Update index
      *
     FCAB1REL1UF  E           K        DISK
      * UPD : IC Item Balance Detail    Update index
      *
     FCAB7CPL0UF  E           K        DISK
      * UPD : IC Transaction Detail     Update index
      *
     FCABZREL0UF  E           K        DISK                      A
      * UPD : Company/Item              Update index
      *
     FPDKLREL0IF  E           K        DISK                      A
      * UPD : Company Item/Avail Group  Update index
      *
     FOMBYREL0UF  E           K        DISK
      * UPD : OM Item                   Update index
      *
     E                    J3          3  1
     E                    K3          3  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    J7          7  1
     E                    K7          7  1
      * RIGHT JUSTIFY INPUT FIELD
     E                    #L7         7  1
     E                    #L3         3  1
     E                    UCT        40  1               CENTER TABLE
      * KEY Screen: Field position and name array
     E                    W0BEG   2 002  5 0A
     E                    W0END   2 002  5 0A
     E                    W0NAM   2 002 10
      * DETAIL Screen: Field position and name array
     E                    W1BEG   7 026  5 0A
     E                    W1END   7 026  5 0A
     E                    W1NAM   7 026 10
      * DETAIL 2 Screen: Field position and name array
     E                    W2BEG   7 025  5 0A
     E                    W2END   7 025  5 0A
     E                    W2NAM   7 025 10
      * DETAIL 3 Screen: Field position and name array
     E                    W3BEG   7 026  5 0A
     E                    W3END   7 026  5 0A
     E                    W3NAM   7 026 10
      * Screen one error indicator store
     E                    @I1       100  1
      * Screen two error indicator store
     E                    @I2       100  1
      * Screen three error indicator store
     E                    @I3       100  1
     I@BYREZF
      * OM Item                   Active Only
      * Renamed input format fields
     I              BYHGCD                          WAHGCD
     I              BYAVNA                          WAAVNA
     I              BYAWNA                          WAAWNA
     I              BYL7NA                          WAL7NA
     I              BYL8NA                          WAL8NA
     I              BYL6NA                          WAL6NA
     I              BYMFNA                          WAMFNA
     I              BYHHCD                          WAHHCD
     I              BYAWPC                          WAAWPC
     I              BYLXST                          WALXST
     I              BYLGCD                          WALGCD
     I              BYAXPC                          WAAXPC
     I              BYLYST                          WALYST
     I              BYLHCD                          WALHCD
     I              BYLICD                          WALICD
     I              BYAIWG                          WAAIWG
     I              BYHICD                          WAHICD
     I              BYRBCD                          WARBCD
     I              BYFZST                          WAFZST
     I              BYAVST                          WAAVST
     I              BYCZWG                          WACZWG
     I              BYC0WG                          WAC0WG
     I              BYURTN                          WAURTN
     I              BYACC8                          WAACC8
     I              BYRINB                          WARINB
     I              BYRHNB                          WARHNB
     I              BYRGNB                          WARGNB
     I              BYLNCD                          WALNCD
     I              BYTFNB                          WATFNB
     I              BYN0CD                          WAN0CD
     I              BYX4ST                          WAX4ST
     I              BYCHTM                          WACHTM
     I              BYQZCD                          WAQZCD
     I              BYXWST                          WAXWST
     I              BYXXST                          WAXXST
     I              BYVMST                          WAVMST
     I              BYSWGH                          WASWGH
     I              BYPPHE                          WAPPHE
     I              BYLRCD                          WALRCD
     I              BYSFNB                          WASFNB
     I              BYA3WG                          WAA3WG
     I              BYSJNB                          WASJNB
     I              BYLLCD                          WALLCD
     I              BYLMCD                          WALMCD
     I              BYP3ST                          WAP3ST
     I              BYSKNB                          WASKNB
     I              BYSLNB                          WASLNB
     I              BYSMNB                          WASMNB
     I              BYP4ST                          WAP4ST
     I              BYCFNB                          WACFNB
     I              BYCGNB                          WACGNB
     I              BYILNB                          WAILNB
     I              BYCHNB                          WACHNB
     I              BYCINB                          WACINB
     I              BYCJNB                          WACJNB
     I              BYCMNB                          WACMNB
     I              BYCNNB                          WACNNB
     I              BYCRNB                          WACRNB
     I              BYCSNB                          WACSNB
     I              BYCVNB                          WACVNB
     I              BYCWNB                          WACWNB
     I              BYCXNB                          WACXNB
     I              BYCZNB                          WACZNB
     I              BYC0NB                          WAC0NB
     I              BYN1CD                          WAN1CD
     I              BYB4NB                          WAB4NB
     I              BYX5ST                          WAX5ST
     I              BYX6ST                          WAX6ST
     I              BYX7ST                          WAX7ST
     I              BYUVST                          WAUVST
     I              BYUWST                          WAUWST
     I              BYUXST                          WAUXST
     I              BYVSST                          WAVSST
     I              BYAHTM                          WAAHTM
     I              BYBEVN                          WABEVN
     I              BYBFVN                          WABFVN
     I              BYEKDT                          WAEKDT
      *
     I@AMREU9
      * Unit of Measure           Active Records
      * Renamed input format fields
     I              AMHHCD                          WBHHCD
     I              AMAUNA                          WBAUNA
     I              AMUVST                          WBUVST
     I              AMUWST                          WBUWST
     I              AMUXST                          WBUXST
     I              AMVSST                          WBVSST
     I              AMAATM                          WBAATM
     I              AMAYNA                          WBAYNA
     I              AMA0NA                          WBA0NA
     I              AMAXDT                          WBAXDT
      *
     I@AIREVD
      * Quality Level             Active Only
      * Renamed input format fields
     I              AIHICD                          WCHICD
     I              AIAUNA                          WCAUNA
     I              AIA7DT                          WCA7DT
     I              AIA8DT                          WCA8DT
     I              AIUVST                          WCUVST
     I              AIUWST                          WCUWST
     I              AIUXST                          WCUXST
     I              AIVSST                          WCVSST
     I              AIAATM                          WCAATM
     I              AIAYNA                          WCAYNA
     I              AIA0NA                          WCA0NA
     I              AIAXDT                          WCAXDT
      *
     I@ILREVH
      * PD Item Level             Active Only
      * Renamed input format fields
     I              ILRBCD                          WDRBCD
     I              ILAUNA                          WDAUNA
     I              ILUVST                          WDUVST
     I              ILUWST                          WDUWST
     I              ILUXST                          WDUXST
     I              ILVSST                          WDVSST
     I              ILAATM                          WDAATM
     I              ILAYNA                          WDAYNA
     I              ILA0NA                          WDA0NA
     I              ILAXDT                          WDAXDT
      *
     I@BJREU2
      * Vendor                    Retrieve Active Records
      * Renamed input format fields
     I              BJACC8                          WEACC8
     I              BJBATX                          WEBATX
     I              BJACNA                          WEACNA
     I              BJADNA                          WEADNA
     I              BJAENA                          WEAENA
     I              BJAJNA                          WEAJNA
     I              BJBGCD                          WEBGCD
     I              BJG5CD                          WEG5CD
     I              BJBTTX                          WEBTTX
     I              BJBVTX                          WEBVTX
     I              BJBWTX                          WEBWTX
     I              BJABTX                          WEABTX
     I              BJA2NA                          WEA2NA
     I              BJASVA                          WEASVA
     I              BJNLNB                          WENLNB
     I              BJBOCD                          WEBOCD
     I              BJADC8                          WEADC8
     I              BJAFC8                          WEAFC8
     I              BJUVST                          WEUVST
     I              BJUWST                          WEUWST
     I              BJUXST                          WEUXST
     I              BJVSST                          WEVSST
     I              BJAATM                          WEAATM
     I              BJAYNA                          WEAYNA
     I              BJA0NA                          WEA0NA
     I              BJAXDT                          WEAXDT
      *
     I@FAREVX
      * OM Item Structure Class   Active Only
      * Renamed input format fields
     I              FARINB                          WFRINB
     I              FARHNB                          WFRHNB
     I              FADETX                          WFDETX
     I              FAUVST                          WFUVST
     I              FAUWST                          WFUWST
     I              FAUXST                          WFUXST
     I              FAVSST                          WFVSST
     I              FAAATM                          WFAATM
     I              FAAYNA                          WFAYNA
     I              FAA0NA                          WFA0NA
     I              FAAXDT                          WFAXDT
      *
     I@FZREVP
      * OM Commodity Group        Active Only
      * Renamed input format fields
     I              FZLRCD                          WGLRCD
     I              FZJ4NA                          WGJ4NA
     I              FZAICD                          WGAICD
     I              FZUVST                          WGUVST
     I              FZUWST                          WGUWST
     I              FZUXST                          WGUXST
     I              FZVSST                          WGVSST
     I              FZAATM                          WGAATM
     I              FZAYNA                          WGAYNA
     I              FZA0NA                          WGA0NA
     I              FZAXDT                          WGAXDT
      *
     I@B0REJT
      * IC Item Balance           Update index
      * Renamed input format fields
     I              B0AIC3                          WHAIC3
     I              B0HGCD                          WHHGCD
     I              B0AJCD                          WHAJCD
     I              B0AGCS                          WHAGCS
     I              B0AECS                          WHAECS
     I              B0BACS                          WHBACS
     I              B0BBCS                          WHBBCS
     I              B0CBPR                          WHCBPR
     I              B0GUDT                          WHGUDT
     I              B0XYST                          WHXYST
     I              B0CTPR                          WHCTPR
     I              B0G4DT                          WHG4DT
     I              B0BOWG                          WHBOWG
     I              B0DDQT                          WHDDQT
     I              B0DEQT                          WHDEQT
     I              B0DFQT                          WHDFQT
     I              B0HDQT                          WHHDQT
     I              B0HEQT                          WHHEQT
     I              B0AJQT                          WHAJQT
     I              B0AQQT                          WHAQQT
     I              B0AUQT                          WHAUQT
     I              B0EMQT                          WHEMQT
     I              B0DOQT                          WHDOQT
     I              B0ATNA                          WHATNA
     I              B0AKDT                          WHAKDT
     I              B0ANDT                          WHANDT
     I              B0IDVA                          WHIDVA
     I              B0JVST                          WHJVST
     I              B0BZPC                          WHBZPC
     I              B0DGQT                          WHDGQT
     I              B0DIDT                          WHDIDT
     I              B0ALCD                          WHALCD
     I              B0BFDY                          WHBFDY
     I              B0DJDT                          WHDJDT
     I              B0BGDY                          WHBGDY
     I              B0DKDT                          WHDKDT
     I              B0J2ST                          WHJ2ST
     I              B0DJQT                          WHDJQT
     I              B0BNWG                          WHBNWG
     I              B0DLDT                          WHDLDT
     I              B0DPQT                          WHDPQT
     I              B0DQQT                          WHDQQT
     I              B0DMDT                          WHDMDT
     I              B0M0ST                          WHM0ST
     I              B0J9ST                          WHJ9ST
     I              B0KBST                          WHKBST
     I              B0AKC8                          WHAKC8
     I              B0RINB                          WHRINB
     I              B0RHNB                          WHRHNB
     I              B0RGNB                          WHRGNB
     I              B0UVST                          WHUVST
     I              B0UWST                          WHUWST
     I              B0UXST                          WHUXST
     I              B0VSST                          WHVSST
     I              B0AATM                          WHAATM
     I              B0AYNA                          WHAYNA
     I              B0A0NA                          WHA0NA
     I              B0AXDT                          WHAXDT
      *
     I@B1REJ1
      * IC Item Balance Detail    Update index
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     I@B7CPJZ
      * IC Transaction Detail     Update index
      * Renamed input format fields
     I              B7AIC3                          WJAIC3
     I              B7HGCD                          WJHGCD
     I              B7AJCD                          WJAJCD
     I              B7W9ST                          WJW9ST
     I              B7BSST                          WJBSST
     I              B7B4DT                          WJB4DT
     I              B7DXNB                          WJDXNB
     I              B7ELDT                          WJELDT
     I              B7HVCD                          WJHVCD
     I              B7F1ST                          WJF1ST
     I              B7AUNA                          WJAUNA
     I              B7A5QT                          WJA5QT
     I              B7AHWG                          WJAHWG
     I              B7AKCS                          WJAKCS
     I              B7CGCD                          WJCGCD
     I              B7AYVA                          WJAYVA
     I              B7BJNA                          WJBJNA
     I              B7CKNB                          WJCKNB
     I              B7BMST                          WJBMST
     I              B7CQCD                          WJCQCD
     I              B7DTCD                          WJDTCD
     I              B7MGNA                          WJMGNA
     I              B7TRBN                          WJTRBN
     I              B7TRBS                          WJTRBS
     I              B7C4NB                          WJC4NB
     I              B7RINB                          WJRINB
     I              B7RHNB                          WJRHNB
     I              B7RGNB                          WJRGNB
     I              B7M3NA                          WJM3NA
     I              B7AWTM                          WJAWTM
     I              B7XLCD                          WJXLCD
     I              B7K7DT                          WJK7DT
     I              B7UVST                          WJUVST
     I              B7UWST                          WJUWST
     I              B7UXST                          WJUXST
     I              B7VSST                          WJVSST
     I              B7AATM                          WJAATM
     I              B7AYNA                          WJAYNA
     I              B7A0NA                          WJA0NA
     I              B7AXDT                          WJAXDT
      *
     I@BYREA0
      * OM Item                   Update index
      * Renamed input format fields
     I              BYHGCD                          WKHGCD
     I              BYAVNA                          WKAVNA
     I              BYAWNA                          WKAWNA
     I              BYL7NA                          WKL7NA
     I              BYL8NA                          WKL8NA
     I              BYL6NA                          WKL6NA
     I              BYMFNA                          WKMFNA
     I              BYHHCD                          WKHHCD
     I              BYAWPC                          WKAWPC
     I              BYLXST                          WKLXST
     I              BYLGCD                          WKLGCD
     I              BYAXPC                          WKAXPC
     I              BYLYST                          WKLYST
     I              BYLHCD                          WKLHCD
     I              BYLICD                          WKLICD
     I              BYAIWG                          WKAIWG
     I              BYHICD                          WKHICD
     I              BYRBCD                          WKRBCD
     I              BYFZST                          WKFZST
     I              BYAVST                          WKAVST
     I              BYCZWG                          WKCZWG
     I              BYC0WG                          WKC0WG
     I              BYURTN                          WKURTN
     I              BYACC8                          WKACC8
     I              BYRINB                          WKRINB
     I              BYRHNB                          WKRHNB
     I              BYRGNB                          WKRGNB
     I              BYLNCD                          WKLNCD
     I              BYTFNB                          WKTFNB
     I              BYN0CD                          WKN0CD
     I              BYX4ST                          WKX4ST
     I              BYCHTM                          WKCHTM
     I              BYQZCD                          WKQZCD
     I              BYXWST                          WKXWST
     I              BYXXST                          WKXXST
     I              BYVMST                          WKVMST
     I              BYSWGH                          WKSWGH
     I              BYPPHE                          WKPPHE
     I              BYLRCD                          WKLRCD
     I              BYSFNB                          WKSFNB
     I              BYA3WG                          WKA3WG
     I              BYSJNB                          WKSJNB
     I              BYLLCD                          WKLLCD
     I              BYLMCD                          WKLMCD
     I              BYP3ST                          WKP3ST
     I              BYSKNB                          WKSKNB
     I              BYSLNB                          WKSLNB
     I              BYSMNB                          WKSMNB
     I              BYP4ST                          WKP4ST
     I              BYCFNB                          WKCFNB
     I              BYCGNB                          WKCGNB
     I              BYILNB                          WKILNB
     I              BYCHNB                          WKCHNB
     I              BYCINB                          WKCINB
     I              BYCJNB                          WKCJNB
     I              BYCMNB                          WKCMNB
     I              BYCNNB                          WKCNNB
     I              BYCRNB                          WKCRNB
     I              BYCSNB                          WKCSNB
     I              BYCVNB                          WKCVNB
     I              BYCWNB                          WKCWNB
     I              BYCXNB                          WKCXNB
     I              BYCZNB                          WKCZNB
     I              BYC0NB                          WKC0NB
     I              BYN1CD                          WKN1CD
     I              BYB4NB                          WKB4NB
     I              BYX5ST                          WKX5ST
     I              BYX6ST                          WKX6ST
     I              BYX7ST                          WKX7ST
     I              BYUVST                          WKUVST
     I              BYUWST                          WKUWST
     I              BYUXST                          WKUXST
     I              BYVSST                          WKVSST
     I              BYAHTM                          WKAHTM
     I              BYBEVN                          WKBEVN
     I              BYBFVN                          WKBFVN
     I              BYEKDT                          WKEKDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSCABZREL0
      * UPD : Company/Item              Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            605
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     I@@I1        DS
      * Screen one error indicator store
     I                                        1 100 @I1
     I                                       31  40 INSCR1
     I@@I2        DS
      * Screen two error indicator store
     I                                        1 100 @I2
     I                                       31  36 INSCR2
     I@@I3        DS
      * Screen three error indicator store
     I                                        1 100 @I3
     I                                       31  47 INSCR3
     IQCAB01    E DSCAB0REL0
      * UPD : IC Item Balance           Update index
      * Renamed input format fields
     I              B0AIC3                          WHAIC3
     I              B0HGCD                          WHHGCD
     I              B0AJCD                          WHAJCD
     I              B0AGCS                          WHAGCS
     I              B0AECS                          WHAECS
     I              B0BACS                          WHBACS
     I              B0BBCS                          WHBBCS
     I              B0CBPR                          WHCBPR
     I              B0GUDT                          WHGUDT
     I              B0XYST                          WHXYST
     I              B0CTPR                          WHCTPR
     I              B0G4DT                          WHG4DT
     I              B0BOWG                          WHBOWG
     I              B0DDQT                          WHDDQT
     I              B0DEQT                          WHDEQT
     I              B0DFQT                          WHDFQT
     I              B0HDQT                          WHHDQT
     I              B0HEQT                          WHHEQT
     I              B0AJQT                          WHAJQT
     I              B0AQQT                          WHAQQT
     I              B0AUQT                          WHAUQT
     I              B0EMQT                          WHEMQT
     I              B0DOQT                          WHDOQT
     I              B0ATNA                          WHATNA
     I              B0AKDT                          WHAKDT
     I              B0ANDT                          WHANDT
     I              B0IDVA                          WHIDVA
     I              B0JVST                          WHJVST
     I              B0BZPC                          WHBZPC
     I              B0DGQT                          WHDGQT
     I              B0DIDT                          WHDIDT
     I              B0ALCD                          WHALCD
     I              B0BFDY                          WHBFDY
     I              B0DJDT                          WHDJDT
     I              B0BGDY                          WHBGDY
     I              B0DKDT                          WHDKDT
     I              B0J2ST                          WHJ2ST
     I              B0DJQT                          WHDJQT
     I              B0BNWG                          WHBNWG
     I              B0DLDT                          WHDLDT
     I              B0DPQT                          WHDPQT
     I              B0DQQT                          WHDQQT
     I              B0DMDT                          WHDMDT
     I              B0M0ST                          WHM0ST
     I              B0J9ST                          WHJ9ST
     I              B0KBST                          WHKBST
     I              B0AKC8                          WHAKC8
     I              B0RINB                          WHRINB
     I              B0RHNB                          WHRHNB
     I              B0RGNB                          WHRGNB
     I              B0UVST                          WHUVST
     I              B0UWST                          WHUWST
     I              B0UXST                          WHUXST
     I              B0VSST                          WHVSST
     I              B0AATM                          WHAATM
     I              B0AYNA                          WHAYNA
     I              B0A0NA                          WHA0NA
     I              B0AXDT                          WHAXDT
      *
     IYARDCS      DS                            245
     IQCAB11    E DSCAB1REL1
      * UPD : IC Item Balance Detail    Update index
      * Renamed input format fields
     I              B1AIC3                          WIAIC3
     I              B1HGCD                          WIHGCD
     I              B1AJCD                          WIAJCD
     I              B1ELDT                          WIELDT
     I              B1ABWG                          WIABWG
     I              B1AGQT                          WIAGQT
     I              B1AHQT                          WIAHQT
     I              B1AIQT                          WIAIQT
     I              B1CTST                          WICTST
     I              B1ACWG                          WIACWG
     I              B1ARQT                          WIARQT
     I              B1ASQT                          WIASQT
     I              B1ATQT                          WIATQT
     I              B1HDQT                          WIHDQT
     I              B1HEQT                          WIHEQT
     I              B1F6ST                          WIF6ST
     I              B1BMWG                          WIBMWG
     I              B1DSQT                          WIDSQT
     I              B1DTQT                          WIDTQT
     I              B1DUQT                          WIDUQT
     I              B1DHDT                          WIDHDT
     I              B1AGCS                          WIAGCS
     I              B1AECS                          WIAECS
     I              B1IDVA                          WIIDVA
     I              B1K7DT                          WIK7DT
     I              B1RINB                          WIRINB
     I              B1RHNB                          WIRHNB
     I              B1RGNB                          WIRGNB
     I              B1UVST                          WIUVST
     I              B1UWST                          WIUWST
     I              B1UXST                          WIUXST
     I              B1VSST                          WIVSST
     I              B1AATM                          WIAATM
     I              B1AYNA                          WIAYNA
     I              B1A0NA                          WIA0NA
     I              B1AXDT                          WIAXDT
      *
     IYBRDCS      DS                            163
     IQCAB71    E DSCAB7CPL0
      * UPD : IC Transaction Detail     Update index
      * Renamed input format fields
     I              B7AIC3                          WJAIC3
     I              B7HGCD                          WJHGCD
     I              B7AJCD                          WJAJCD
     I              B7W9ST                          WJW9ST
     I              B7BSST                          WJBSST
     I              B7B4DT                          WJB4DT
     I              B7DXNB                          WJDXNB
     I              B7ELDT                          WJELDT
     I              B7HVCD                          WJHVCD
     I              B7F1ST                          WJF1ST
     I              B7AUNA                          WJAUNA
     I              B7A5QT                          WJA5QT
     I              B7AHWG                          WJAHWG
     I              B7AKCS                          WJAKCS
     I              B7CGCD                          WJCGCD
     I              B7AYVA                          WJAYVA
     I              B7BJNA                          WJBJNA
     I              B7CKNB                          WJCKNB
     I              B7BMST                          WJBMST
     I              B7CQCD                          WJCQCD
     I              B7DTCD                          WJDTCD
     I              B7MGNA                          WJMGNA
     I              B7TRBN                          WJTRBN
     I              B7TRBS                          WJTRBS
     I              B7C4NB                          WJC4NB
     I              B7RINB                          WJRINB
     I              B7RHNB                          WJRHNB
     I              B7RGNB                          WJRGNB
     I              B7M3NA                          WJM3NA
     I              B7AWTM                          WJAWTM
     I              B7XLCD                          WJXLCD
     I              B7K7DT                          WJK7DT
     I              B7UVST                          WJUVST
     I              B7UWST                          WJUWST
     I              B7UXST                          WJUXST
     I              B7VSST                          WJVSST
     I              B7AATM                          WJAATM
     I              B7AYNA                          WJAYNA
     I              B7A0NA                          WJA0NA
     I              B7AXDT                          WJAXDT
      *
     IYCRDCS      DS                            189
     IQPDKL1    E DSPDKLREL0
      * UPD : Company Item/Avail Group  Update index
      *
     IYDRDCS      DS                            605
     IQOMBY1    E DSOMBYREL0
      * UPD : OM Item                   Update index
      * Renamed input format fields
     I              BYHGCD                          WKHGCD
     I              BYAVNA                          WKAVNA
     I              BYAWNA                          WKAWNA
     I              BYL7NA                          WKL7NA
     I              BYL8NA                          WKL8NA
     I              BYL6NA                          WKL6NA
     I              BYMFNA                          WKMFNA
     I              BYHHCD                          WKHHCD
     I              BYAWPC                          WKAWPC
     I              BYLXST                          WKLXST
     I              BYLGCD                          WKLGCD
     I              BYAXPC                          WKAXPC
     I              BYLYST                          WKLYST
     I              BYLHCD                          WKLHCD
     I              BYLICD                          WKLICD
     I              BYAIWG                          WKAIWG
     I              BYHICD                          WKHICD
     I              BYRBCD                          WKRBCD
     I              BYFZST                          WKFZST
     I              BYAVST                          WKAVST
     I              BYCZWG                          WKCZWG
     I              BYC0WG                          WKC0WG
     I              BYURTN                          WKURTN
     I              BYACC8                          WKACC8
     I              BYRINB                          WKRINB
     I              BYRHNB                          WKRHNB
     I              BYRGNB                          WKRGNB
     I              BYLNCD                          WKLNCD
     I              BYTFNB                          WKTFNB
     I              BYN0CD                          WKN0CD
     I              BYX4ST                          WKX4ST
     I              BYCHTM                          WKCHTM
     I              BYQZCD                          WKQZCD
     I              BYXWST                          WKXWST
     I              BYXXST                          WKXXST
     I              BYVMST                          WKVMST
     I              BYSWGH                          WKSWGH
     I              BYPPHE                          WKPPHE
     I              BYLRCD                          WKLRCD
     I              BYSFNB                          WKSFNB
     I              BYA3WG                          WKA3WG
     I              BYSJNB                          WKSJNB
     I              BYLLCD                          WKLLCD
     I              BYLMCD                          WKLMCD
     I              BYP3ST                          WKP3ST
     I              BYSKNB                          WKSKNB
     I              BYSLNB                          WKSLNB
     I              BYSMNB                          WKSMNB
     I              BYP4ST                          WKP4ST
     I              BYCFNB                          WKCFNB
     I              BYCGNB                          WKCGNB
     I              BYILNB                          WKILNB
     I              BYCHNB                          WKCHNB
     I              BYCINB                          WKCINB
     I              BYCJNB                          WKCJNB
     I              BYCMNB                          WKCMNB
     I              BYCNNB                          WKCNNB
     I              BYCRNB                          WKCRNB
     I              BYCSNB                          WKCSNB
     I              BYCVNB                          WKCVNB
     I              BYCWNB                          WKCWNB
     I              BYCXNB                          WKCXNB
     I              BYCZNB                          WKCZNB
     I              BYC0NB                          WKC0NB
     I              BYN1CD                          WKN1CD
     I              BYB4NB                          WKB4NB
     I              BYX5ST                          WKX5ST
     I              BYX6ST                          WKX6ST
     I              BYX7ST                          WKX7ST
     I              BYUVST                          WKUVST
     I              BYUWST                          WKUWST
     I              BYUXST                          WKUXST
     I              BYVSST                          WKVSST
     I              BYAHTM                          WKAHTM
     I              BYBEVN                          WKBEVN
     I              BYBFVN                          WKBFVN
     I              BYEKDT                          WKEKDT
      *
     IYERDCS      DS                            422
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company/Item
      * B :  Company Number
     I                                    P   1   20P1AIC3
      * B :  Item Code
     I                                    P   3   60P1HGCD
      * N :  Description Line One
     I                                        7  36 P1AVNA
      * N :  Item Label Line 1
     I                                       37  68 P1L7NA
      * N :  Item Label Line 2
     I                                       69 100 P1L8NA
      * N :  Item Label Line 3
     I                                      101 132 P1L6NA
      * N :  U/M - Primary
     I                                      133 134 P1ADCD
      * N :  Conversion Factor 1
     I                                    P 135 1394P1AWPC
      * N :  U/M - Second
     I                                      140 141 P1AECD
      * N :  Conversion Factor 2
     I                                    P 142 1464P1AXPC
      * N :  U/M - Third
     I                                      147 148 P1AFCD
      * N :  U/M - Pricing
     I                                      149 150 P1AICD
      * N :  Unit Weight
     I                                    P 151 1562P1AIWG
      * N :  Production Date Control
     I                                      157 157 P1FZST
      * N :  Catch Weight Status
     I                                      158 158 P1AVST
      * N :  Minimum Weight Per Case
     I                                    P 159 1642P1CZWG
      * N :  Maximum Weight Per Case
     I                                    P 165 1702P1C0WG
      * N :  Number Cases On A Pallet
     I                                    P 171 1730P1URTN
      * N :  Item Structure Class Code
     I                                    P 174 1750P1RINB
      * N :  Default Commod Mark basis
     I                                      176 178 P1LNCD
      * N :  Market Overage
     I                                    P 179 1844P1BLPR
      * N :  Standard Overage/Underage
     I                                    P 185 1904P1BMPR
      * N :  Commodity Price Group
     I                                      191 197 P1LRCD
      * N :  Item Pricing Operation
     I                                      198 198 P1U9ST
      * N :  Item Pricing Constant
     I                                    P 199 2044P1CMCO
      * N :  Default Warehouse
     I                                      205 207 P1Q1CD
      * N :  Fresh Chilling Time
     I                                    P 208 2102P1CHTM
      * N :  Std Weight/Head (Var/Ren)
     I                                    P 211 2162P1SWGH
      * N :  Misc Tare Weight
     I                                    P 217 2192P1A3WG
      * N :  Record Status
     I                                      220 220 P1VSST
     IP2PARM      DS
      * FLD: *Arrays
      * N :  Warehouse Code
     I                                        1   3 P2AJCD
      * N :  Application Code
     I                                        4   9 P2DNCD
      * N :  Salesperson Code
     I                                       10  12 P2BCCD
      * N :  System Date Format
     I                                       13  15 P2B8NA
      * N :  User Profile Name
     I                                       16  25 P2AJVN
      * N :  Allow Multi-Company
     I                                       26  26 P2I6ST
      * N :  Default Printer
     I                                       27  36 P2MPNA
     IP3PARM      DS
      * FLD: *Arrays
      * N :  Commodity Market Code
     I                                        1   3 P3LQCD
      * N :  USR Formula Meth Type Sts
     I                                        4   4 P3YKST
      * N :  USR Market Meth Type Sts
     I                                        5   5 P3YLST
      * N :  USR Manual Meth Type Sts
     I                                        6   6 P3YMST
      * N :  USR Extend Meth Type Sts
     I                                        7   7 P3YNST
      * N :  Price Method Type
     I                                        8   8 P3V8ST
     IP4PARM      DS
      * N :  Change Plant Floor USR
     I                                        1   1 P4ZQST
     IP5PARM      DS
      * FLD: AS Product
      * N :  AS Add/Change/Delete
     I                                        1   1 P5Y5ST
     IP6PARM      DS
      * FLD: *Arrays
      * N :  USR Display field
     I                                        1   1 P6GGST
      * N :  Error Status
     I                                        2   2 P6ECST
      * N :  U/M - Catchweight
     I                                        3   4 P6H0CD
      * N :  Item Structure Change USR
     I                                        5   5 P6BAST
      * N :  USR Display 1
     I                                        6   6 P6TIST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'CD3 Non numeric data'
      * Message data for 'CD7 Non numeric data'
      * Message data for 'OM Item                NF'
      * Item Code
     I                                        1   7 ZA0001
      * Message data for 'CD7 Non numeric data'
      * Message data for 'Catch weight weight reqd'
      * Message data for 'Conversion Factor 1 req'd'
      * Message data for 'Operation Factor 1 req'd'
      * Message data for 'U/M 2 required if U/M 3'
      * U/M - Second
     I                                        1   2 ZA0002
      * Conversion Factor 1
     I                                    P   3   74ZA0003
      * Message data for 'Conversion Factor 2 req'd'
      * Message data for 'Operation Factor 2 req'd'
      * Message data for 'U/M-base not equal 1,2or3'
      * U/M - Primary
     I                                        1   2 ZA0004
      * U/M - Second
     I                                        3   4 ZA0005
      * U/M - Third
     I                                        5   6 ZA0006
      * Message data for 'Com Group U/M must= U/M P'
      * Commodity Price Group
     I                                        1   7 ZA0007
      * Message data for 'Vrty/Rend/Cut can't be BL'
      * Variety/Rendered/Cut
     I                                        1   1 ZA0008
      * Message data for 'Commdty Mrkt Can't be BL'
      * Default Commod Mark basis
     I                                        1   3 ZA0009
      * Message data for 'Commdty Group Can't be BL'
      * Commodity Price Group
     I                                        1   7 ZA0010
      * Message data for 'Vendor can't be Entered'
      * Vendor - Item Default
     I                                        1   8 ZA0011
      * Message data for 'Whse is Mandatory for FG'
      * Default Warehouse
     I                                        1   3 ZA0012
      * Message data for 'Package type can't be BLK'
      * Package Type Code
     I                                        1   1 ZA0013
      * Message data for 'Base/Cov/Fab can't be BL'
      * Base/Conv/Loss Item
     I                                        1   2 ZA0014
      * Message data for 'RM item must be a base'
      * Item Type Code
     I                                        1   3 ZA0015
      * Base/Conv/Loss Item
     I                                        4   5 ZA0016
      * Message data for 'Base/Cov/Fab can't be BL'
      * Base/Conv/Loss Item
     I                                        1   2 ZA0017
      * Message data for 'Std Wght Head can't be BL'
      * Std Weight/Head (Var/Ren)
     I                                    P   1   62ZA0018
      * Message data for 'Credit Item Must be FG'
      * Credit Item Status
     I                                        1   1 ZA0019
      * Message data for 'Min Wgt > Unit'
      * Minimum Weight Per Case
     I                                    P   1   62ZA0020
      * Message data for 'Max Wgt < Unit'
      * Maximum Weight Per Case
     I                                    P   1   62ZA0021
      * Message data for 'Pieces per Bag req'
      * Pieces Per Bag
     I                                    P   1   40ZA0022
      * Message data for 'Bags per Unit req'
      * Bags Per Unit
     I                                    P   1   40ZA0023
      * Message data for 'Export/Domestic Req'
      * Export/Domestic
     I                                        1   1 ZA0024
      * Message data for 'Primal Group Code req'
      * Primal Group Code
     I                                        1   6 ZA0025
      * Message data for 'Fresh Inv Allocation Seq'
      * Fresh Inv Allocation Seq
     I                                        1   1 ZA0026
      * Message data for 'Fresh Sched As Ordered rq'
      * Fresh Sched As Ordered
     I                                        1   1 ZA0027
      * Message data for 'Frozn Sched As Ordered rq'
      * Frozen Sched As Ordered
     I                                        1   1 ZA0028
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM P1AIC3    WP0001  30       Company Number
     C           P1HGCD    PARM P1HGCD    WP0002  70       Item Code
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Repeat forever
     C                     DO   *HIVAL
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
      *
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Set control to display first screen
     C                     Z-ADD1         W0SCR   30
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C  N09                EXSR MNCV#K
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C           #1HGCD    OREQ *ZERO                      Item Code
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Update screen time
     C                     TIME           ##TME
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Setup key
     C                     MOVEL#1AIC3    BZAIC3
     C                     MOVEL#1HGCD    BZHGCD
     C           KRTV      CHAIN@BZREJU              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * If record does not exist, flip to add mode
     C           *IN90     IFEQ '1'
     C                     MOVEL'ADD'     W0PMD
      * USER: Initialize detail screen (new record)
      *    Get System defaults for add
     C                     Z-ADD*ZERO     #1AJC8           Vendor - Item D
      *    Get item defaults for add
      * Rtv Item Defaults     RT - OM Item  * 
     C                     EXSR SARVGN
      * If item default was not found, default values
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
     C                     MOVEL'N'       #1FZST           Production Date
     C                     MOVEL'N'       #1AVST           Catch Weight St
     C                     MOVEL'N'       #1VMST           Credit Item Sta
     C                     MOVEL'N'       #1XXST           Case Ready Stat
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1X6ST           Print on Realiz
     C                     MOVEL'A'       #1VSST           Record Status
     C                     END                             *FI
      * If catch weight status from Item Dft is blank, use Co. Dft
      * CASE: DTL.Catch Weight Status is blank
     C           #1AVST    IFEQ *BLANK                     *IF
     C                     MOVELWUAVST    #1AVST           Catch Weight St
     C                     END                             *FI
      * Init print on realization rpt flag to Y if finished good
      * CASE: DTL.Item Type Code is Finished Good
     C           #1N0CD    IFEQ 'FG'                       *IF
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL'Y'       #1X6ST           Print on Realiz
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1X6ST           Print on Realiz
     C                     END                             *FI
     C                     MOVEL'A'       #1VSST           Record Status
      * 3RD.Status Description = Condition name of 3RD.Record Status
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 20        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
     C                     MOVEL'N'       #1X5ST           Seconds Item
     C                     MOVEL#1X6ST    #DSTAT           USR Prt on Real
     C                     MOVEL'N'       P3YKST           USR Formula Met
     C                     MOVEL'N'       P3YLST           USR Market Meth
     C                     MOVEL'N'       P3YMST           USR Manual Meth
     C                     MOVEL'N'       P3YNST           USR Extend Meth
     C                     MOVEL'Y'       P6TIST           USR Display 1
     C                     ELSE
      * If record does exist, flip to change mode
     C                     MOVEL'CHG'     W0PMD
      * Load screen fields from DBF
     C                     EXSR MBFL#1
      * USER: Initialize detail screen (existing record)
      * Default Print on Schedule
      * CASE: DB1.Print On Schedule is blank
     C           BZSVST    IFEQ *BLANK                     *IF
     C                     MOVEL'Y'       #1SVST           Print On Schedu
     C                     END                             *FI
      * Default Piece count item
      * CASE: DB1.Piece Count Item is blank
     C           BZPCCT    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       #1PCCT           Piece Count Ite
     C                     END                             *FI
      * Defaults on Screen 3 if Item Type Code n= PS
      * CASE: 2ND.Item Type Code is Finished Good/Raw Matrl
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
      * Default Inv Alloc
      * CASE: DB1.Fresh Inv Allocation Seq EQ WRK.BLANK 1               U
     C           BZSYST    IFEQ WUJ1TX                     *IF
     C                     MOVEL'F'       #1SYST           Fresh Inv Alloc
     C                     END                             *FI
      * Default Fresh Sched as Ordered
      * CASE: DB1.Fresh Sched As Ordered EQ WRK.BLANK 1               USR
     C           BZSZST    IFEQ WUJ1TX                     *IF
     C                     MOVEL'N'       #1SZST           Fresh Sched As
     C                     END                             *FI
      * Default Frozen Sched as Ordered
      * CASE: DB1.Frozen Sched As Ordered EQ WRK.BLANK 1               US
     C           BZS1ST    IFEQ WUJ1TX                     *IF
     C                     MOVEL'N'       #1S1ST           Frozen Sched As
     C                     END                             *FI
     C                     END                             *FI
      * Determine whether to display catchweight status field
      * RTV Enable Catch Wgt   RT - System Values  * 
     C                     EXSR SBRVGN
      * If any qty on hand or allocated, don't allow change to operators
      * RTV Chk Alloc/On Hand  RT - IC Item Balance  * 
     C                     EXSR SCRVGN
      * If any item balance detail exists for item, cannot change Prod Da
     C                     MOVEL'Y'       P6TIST           USR Display 1
      * VAL Any Dtl Exists     RT - IC Item Balance Detail  * 
     C                     EXSR SDRVGN
      * Set output only for prod date control if item bal detail found
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     MOVEL'N'       P6TIST           USR Display 1
     C                     END                             *FI
     C                     MOVELBZX6ST    #DSTAT           USR Prt on Real
      *   Save original U/M's  and catchweight status
     C                     MOVELBZADCD    P1ADCD           U/M - Primary
     C                     MOVELBZAECD    P1AECD           U/M - Second
     C                     MOVELBZAFCD    P1AFCD           U/M - Third
     C                     Z-ADDBZAWPC    P1AWPC           Conversion Fact
     C                     Z-ADDBZAXPC    P1AXPC           Conversion Fact
     C                     MOVEL#1AVST    P1AVST           Catch Weight St
     C                     Z-ADDBZRINB    P1RINB           Item Structure
      * Retrieve code names
      * Rtv Quality Level Desc RT - Quality Level  * 
     C                     EXSR SERVGN
      * RTV Item Level Descr   RT - PD Item Level  * 
     C                     EXSR SFRVGN
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
     C                     EXSR SGRVGN
      * Rtv Avl Dsp Grp Desc   RT - PD Item Category Unused  * 
     C                     EXSR SHRVGN
      * RTV Commod. Mkts Desc  RT - OM Commodity Markets  * 
     C                     EXSR SIRVGN
      * RTV Commod Group Desc  RT - OM Commodity Group  * 
     C                     EXSR SJRVGN
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
     C                     EXSR SKRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SLRVGN
      * Rtv Prod Dept Name    RT - PS Production Department  * 
     C                     EXSR SMRVGN
      * Rtv Vendor Name        RT - Vendor  * 
     C                     EXSR SNRVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SORVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR SPRVGN
      * Rtv Primal Grp Desc   RT - PS Primal Group  * 
     C                     EXSR SQRVGN
      * Retrieve condition names
      * 2ND.Condition Desc. 1  USR = Condition name of DB1.Item Type Code
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294118   Y2LSNO  70       List number
     C                     PARM BZN0CD    W0INVL 20        Item Type Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Desc. 2  USR = Condition name of DB1.Package Type C
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1301868   Y2LSNO  70       List number
     C                     PARM BZX4ST    W0INVL 20        Package Type Co
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Desc. 3  USR = Condition name of DB1.Converted/Base
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294120   Y2LSNO  70       List number
     C                     PARM BZQZCD    W0INVL 20        Base/Conv/Loss
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHNTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Desc. 4  USR = Condition name of DB1.Variety/Render
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1292551   Y2LSNO  70       List number
     C                     PARM BZXWST    W0INVL 20        Variety/Rendere
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Name USR = Condition name of DB1.Seconds Item
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1349716   Y2LSNO  70       List number
     C                     PARM BZX5ST    W0INVL 20        Seconds Item
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DGUTX    PARM           W0CNNM 25        Condition Name
      *
      * DTL.Condition Desc. 10 USR = Condition name of DB1.Item Pricing O
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260938   Y2LSNO  70       List number
     C                     PARM BZU9ST    W0INVL 20        Item Pricing Op
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHUTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 3RD.Status Description = Condition name of DB1.Record Status
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM BZVSST    W0INVL 20        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * 2ND.Export/Domestic Desc  USR = Condition name of 2ND.Export/Dome
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1472213   Y2LSNO  70       List number
     C                     PARM #1SUST    W0INVL 20        Export/Domestic
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DMRTX    PARM           W0CNNM 25        Export/Domestic
      *
      * 3RD.Fresh Inv Alloc Desc  USR = Condition name of 3RD.Fresh Inv A
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1472217   Y2LSNO  70       List number
     C                     PARM #1SYST    W0INVL 20        Fresh Inv Alloc
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DMSTX    PARM           W0CNNM 25        Fresh Inv Alloc
      *
      * Save Price Audit field values
     C                     MOVEL'N'       P3YKST           USR Formula Met
     C                     MOVEL'N'       P3YLST           USR Market Meth
     C                     MOVEL'N'       P3YMST           USR Manual Meth
     C                     MOVEL'N'       P3YNST           USR Extend Meth
     C                     MOVELBZAICD    P1AICD           U/M - Pricing
     C                     MOVELBZLNCD    P1LNCD           Default Commod
     C                     MOVELBZLRCD    P1LRCD           Commodity Price
     C                     Z-ADDBZBLPR    P1BLPR           Market Overage
     C                     Z-ADDBZBMPR    P1BMPR           Standard Overag
     C                     MOVELBZU9ST    P1U9ST           Item Pricing Op
     C                     Z-ADDBZCMCO    P1CMCO           Item Pricing Co
     C                     MOVELBZVSST    P1VSST           Record Status
     C                     MOVEL*BLANK    P3LQCD           Commodity Marke
      * Save Accu-Sort/Plant Floor values
     C                     MOVELBZAVNA    P1AVNA           Description Lin
     C                     MOVELBZL7NA    P1L7NA           Item Label Line
     C                     MOVELBZL8NA    P1L8NA           Item Label Line
     C                     MOVELBZL6NA    P1L6NA           Item Label Line
     C                     Z-ADDBZAIWG    P1AIWG           Unit Weight
     C                     Z-ADDBZCZWG    P1CZWG           Minimum Weight
     C                     Z-ADDBZC0WG    P1C0WG           Maximum Weight
     C                     Z-ADDBZURTN    P1URTN           Number Cases On
     C                     Z-ADDBZA3WG    P1A3WG           Misc Tare Weigh
     C                     Z-ADDBZCHTM    P1CHTM           Fresh Chilling
     C                     MOVELBZQ1CD    P1Q1CD           Default Warehou
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
      * Validate Company Number and convert to internal.
      * CD3 Ext/Int
     C                     MOVELV1AIC3    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC3  3
     C                     MOVEA*BLANKS   K3
     C                     Z-ADD3         C       30
     C                     Z-ADD3         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUDMCD    J3
     C                     MOVE *BLANKS   W0RTN
     C                     DO   3
     C           J3,C      IFNE ' '
     C                     MOVEAJ3,C      K3,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK3        JUSTC3
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC3    TESTC   1
     C           TESTC     IFGT '?'
     C           TESTC     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC3     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC3    WUDMCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD3 Non numeric data'
     C                     MOVEL'USR0752' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AIC3           CD3 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUDMCD    #1AIC3           CD3 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
      * Validate Item Code and convert to internal.
      * CD7 Ext/Int
     C                     MOVELV1HGCD    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
      * FIELD LOADED TO WRK CONTEXT BY INTERNAL FUNCTION
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
      * TEST FOR INVALID DATA IN FIELD
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1HGCD           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1HGCD           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9932  *
     C                     END
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Company Name and Address
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate key screen
      * Val Item Exists        RT - OM Item  * 
     C                     EXSR SRRVGN
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ 'Y2U0005'                  *IF
      * Setup message data for message
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0001           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0001           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'OM Item                NF'
     C                     MOVEL'USR1160' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END
      * Company Number required
     C           #1AIC3    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Item Code required
     C           #1HGCD    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
     C           W0HLP     DOUEQ'N'
     C           W0ROL     ANDEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0SCR     IFEQ 1
      * Set error
     C                     MOVEAINSCR1    *IN,31
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 2
      * Set error
     C                     MOVEAINSCR2    *IN,31
     C                     MOVEL'2'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y2SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT3
     C                     EXFMT#RCDDTL2
      * Test cursor
     C                     EXSR Y8TST
     C                     ELSE
     C           W0SCR     IFEQ 3
      * Set error
     C                     MOVEAINSCR3    *IN,31
     C                     MOVEL'3'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y3SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT4
     C                     EXFMT#RCDDTL3
      * Test cursor
     C                     EXSR Y8TST
     C                     END
     C                     END
     C                     END
      * Reset roll flag
     C                     MOVEL'N'       W0ROL   1
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Show next page of details
     C   27                EXSR CDNXSC
      * Show previous page of details
     C   28                EXSR CEPVSC
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      * Initialise error memories
     C                     MOVE *ZERO     INSCR1
     C                     MOVE *ZERO     INSCR2
     C                     MOVE *ZERO     INSCR3
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CDNXSC    BEGSR
      *================================================================
      * Display next screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C           W0SCR     IFLT 3
     C                     ADD  1         W0SCR
     C                     END
      *================================================================
     CSR         CDEXIT    ENDSR
      /EJECT
     CSR         CEPVSC    BEGSR
      *================================================================
      * Display previous screen
      *================================================================
      * Set roll flag
     C                     MOVEL'Y'       W0ROL   1
     C           W0SCR     IFGT 1
     C                     SUB  1         W0SCR
     C                     END
      *================================================================
     CSR         CEEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     MOVE *ZEROS    INSCR1
     C                     MOVE *ZEROS    INSCR2
     C                     MOVE *ZEROS    INSCR3
     C                     EXSR DCVLDL
      * Display first screen in error
     C           INSCR1    IFNE *ZERO
     C                     Z-ADD1         W0SCR
     C                     ELSE
     C           INSCR2    IFNE *ZERO
     C                     Z-ADD2         W0SCR
     C                     ELSE
     C           INSCR3    IFNE *ZERO
     C                     Z-ADD3         W0SCR
     C                     END
     C                     END
     C                     END
      * QUIT if error:
     C           *IN99     CABEQ'1'       CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Validate Production Date Control
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1FZST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Production Date Control
     C                     MOVEL#1FZST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHFZST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZHFZST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZHFZST
     C                     ENDSL
     C                     EXFMTZGFZST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHFZST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZHFZST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1FZST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
     C                     END
      * Validate Item Pricing Operation
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1U9ST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ1
      * Item Pricing Operation
     C                     MOVEL#1U9ST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHU9ST
     C                     SELEC
     C           W0INVL    WHEQ '+'                        +
     C                     Z-ADD1         ZHU9ST
     C           W0INVL    WHEQ '/'                        /
     C                     Z-ADD2         ZHU9ST
     C           W0INVL    WHEQ '*'                        *
     C                     Z-ADD3         ZHU9ST
     C           W0INVL    WHEQ '-'                        -
     C                     Z-ADD4         ZHU9ST
     C                     ENDSL
     C                     EXFMTZGU9ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHU9ST    WHEQ 1
     C                     MOVEL'+'       W0INVL           +
     C           ZHU9ST    WHEQ 2
     C                     MOVEL'/'       W0INVL           /
     C           ZHU9ST    WHEQ 3
     C                     MOVEL'*'       W0INVL           *
     C           ZHU9ST    WHEQ 4
     C                     MOVEL'-'       W0INVL           -
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1U9ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,39
     C                     SETON                     99    *
     C                     END
      * Validate USR Prt on Realization Rp
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#DSTAT'  IFEQ YPMTFD
     C           W0SCR     ANDEQ2
      * USR Prt on Realization Rp
     C                     MOVEL#DSTAT    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZKSTAT
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZKSTAT
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZKSTAT
     C                     ENDSL
     C                     EXFMTZISTAT
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZKSTAT    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZKSTAT    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #DSTAT
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,33
     C                     SETON                     99    *
     C                     END
      * Validate Export/Domestic
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1SUST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ2
      * Export/Domestic
     C                     MOVEL#1SUST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZKSUST
     C                     SELEC
     C           W0INVL    WHEQ 'E'                        E
     C                     Z-ADD1         ZKSUST
     C           W0INVL    WHEQ 'D'                        D
     C                     Z-ADD2         ZKSUST
     C                     ENDSL
     C                     EXFMTZISUST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZKSUST    WHEQ 1
     C                     MOVEL'E'       W0INVL           E
     C           ZKSUST    WHEQ 2
     C                     MOVEL'D'       W0INVL           D
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1SUST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,34
     C                     SETON                     99    *
     C                     END
      * Validate Print On Schedule
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1SVST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ2
      * Print On Schedule
     C                     MOVEL#1SVST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZKSVST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZKSVST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZKSVST
     C                     ENDSL
     C                     EXFMTZISVST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZKSVST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZKSVST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1SVST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,35
     C                     SETON                     99    *
     C                     END
      * Validate Vendor - Item Default and convert to internal.
      * CD8 Ext/Int
     C                     MOVELV1AJC8    WUI3ST           USR First Posit
     C                     MOVEL*BLANK    W0RTN            *Return code
      * CASE: WRK.USR First Position is Search request
     C           WUI3ST    IFEQ '?'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELV1AJC8    WUEOCD           CD7 Ext Numeric
      * CD7 Ext/Int EXCUSRSRC - *Field attribute types  * 
     C                     MOVE *BLANKS   JUSTC7  7
     C                     MOVEA*BLANKS   K7
     C                     Z-ADD7         C       30
     C                     Z-ADD7         D       30
     C                     MOVEAWUEOCD    J7
     C                     MOVE *BLANKS   W0RTN
     C                     DO   7
     C           J7,C      IFNE ' '
     C                     MOVEAJ7,C      K7,D
     C                     SUB  1         D
     C                     END
     C                     SUB  1         C
     C                     END
     C                     MOVEAK7        JUSTC7
     C                     MOVE JUSTC7    TEST7   1
     C           TEST7     IFGT '?'
     C           TEST7     ANDLT'0'
     C                     MOVE 'USR0752' W0RTN
     C                     ELSE
     C                     MOVE *IN60     HLDIN   1
     C                     TESTN          JUSTC7     606060
     C           *IN60     IFEQ '0'
     C                     MOVE 'USR0752' W0RTN
     C                     END
     C                     END
     C                     MOVE JUSTC7    WUEOCD
     C                     MOVE HLDIN     *IN60
      * CASE: PGM.*Return code is CD3 Non numeric data
     C           W0RTN     IFEQ 'USR0752'                  *IF
      * Setup message data for message
      * Send message 'CD7 Non numeric data'
     C                     MOVEL'USR0802' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     Z-ADD*ZERO     #1AJC8           CD7 Int Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVE WUEOCD    #1AJC8           CD7 Int Numeric
     C                     END                             *FI
     C                     END                             *FI
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,40
     C                     SETON                     99    *
     C                     END
      * Validate Piece Count Item
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1PCCT'  IFEQ YPMTFD
     C           W0SCR     ANDEQ3
      * Piece Count Item
     C                     MOVEL#1PCCT    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZNPCCT
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZNPCCT
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZNPCCT
     C                     ENDSL
     C                     EXFMTZLPCCT
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZNPCCT    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZNPCCT    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1PCCT
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,42
     C                     SETON                     99    *
     C                     END
      * Validate Fresh Inv Allocation Seq
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1SYST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ3
      * Fresh Inv Allocation Seq
     C                     MOVEL#1SYST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZNSYST
     C                     SELEC
     C           W0INVL    WHEQ 'F'                        F
     C                     Z-ADD1         ZNSYST
     C           W0INVL    WHEQ 'L'                        L
     C                     Z-ADD2         ZNSYST
     C                     ENDSL
     C                     EXFMTZLSYST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZNSYST    WHEQ 1
     C                     MOVEL'F'       W0INVL           F
     C           ZNSYST    WHEQ 2
     C                     MOVEL'L'       W0INVL           L
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1SYST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,45
     C                     SETON                     99    *
     C                     END
      * Validate Fresh Sched As Ordered
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1SZST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ3
      * Fresh Sched As Ordered
     C                     MOVEL#1SZST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZNSZST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZNSZST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZNSZST
     C                     ENDSL
     C                     EXFMTZLSZST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZNSZST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZNSZST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1SZST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,46
     C                     SETON                     99    *
     C                     END
      * Validate Frozen Sched As Ordered
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1S1ST'  IFEQ YPMTFD
     C           W0SCR     ANDEQ3
      * Frozen Sched As Ordered
     C                     MOVEL#1S1ST    W0INVL 20
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZNS1ST
     C                     SELEC
     C           W0INVL    WHEQ 'N'                        N
     C                     Z-ADD1         ZNS1ST
     C           W0INVL    WHEQ 'Y'                        Y
     C                     Z-ADD2         ZNS1ST
     C                     ENDSL
     C                     EXFMTZLS1ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZNS1ST    WHEQ 1
     C                     MOVEL'N'       W0INVL           N
     C           ZNS1ST    WHEQ 2
     C                     MOVEL'Y'       W0INVL           Y
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1S1ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,47
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Validate Zero if Active Item
      * CASE: DTL.Unit Weight is Equal to zero
     C           #1AIWG    IFEQ *ZERO                      *IF
      * CASE: 2ND.Record Status is Active
     C           #1VSST    IFEQ 'A'                        *IF
      * Setup message data for message
      * Send message 'Catch weight weight reqd'
     C                     MOVEL'USR0514' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Select Commodity market
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.Default Commod Mark basis
     C           W0SCR     IFEQ 1                          *
     C           W0CFL     ANDEQ'#1LNCD'                   *IF
      * SEL Commod. Mkts Actve SR - OM Commodity Markets  * 
     C                     CALL 'PDEDSRR'              90  SEL Commod. Mkt
     C                     PARM *BLANK    W0RTN   7
     C           #1LNCD    PARM #1LNCD    WQ0004  3        Commodity Marke
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
      * If U/M 2 entered then Conv. Factor 1 & operation 1 is required
      * CASE: DTL.U/M - Second is Entered
     C           #1AECD    IFNE *BLANK                     *IF
      * CASE: DTL.Conversion Factor 1 is Not Entered
     C           #1AWPC    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Send message 'Conversion Factor 1 req'd'
     C                     MOVEL'USR0364' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: DTL.Operation Factor 1 is Not Entered
     C           #1LXST    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'Operation Factor 1 req'd'
     C                     MOVEL'USR1011' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If U/M 3 entered then U/M 2, Conv. 2 & operation 2 required
      * CASE: DTL.U/M - Third is Entered
     C           #1AFCD    IFNE *BLANK                     *IF
      * CASE: DTL.U/M - Second is Not Entered
     C           #1AECD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1AECD    ZA0002           U/M - Second
     C                     Z-ADD#1AWPC    ZA0003           Conversion Fact
      * Send message 'U/M 2 required if U/M 3'
     C                     MOVEL'USR0886' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: DTL.Conversion Factor 2 is Not Entered
     C           #1AXPC    IFEQ *ZERO                      *IF
      * Setup message data for message
      * Send message 'Conversion Factor 2 req'd'
     C                     MOVEL'USR0365' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * CASE: DTL.Operation Factor 2 is Not Entered
     C           #1LYST    IFEQ *BLANK                     *IF
      * Setup message data for message
      * Send message 'Operation Factor 2 req'd'
     C                     MOVEL'USR1012' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Clear conversion/operation factor 1 if u/m 2 not entered
      * CASE: DTL.U/M - Second is Not Entered
     C           #1AECD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1AWPC           Conversion Fact
     C                     MOVEL*BLANK    #1LXST           Operation Facto
     C                     END                             *FI
      * Clear conversion/operation 2 if u/m 3 not entered
      * CASE: DTL.U/M - Third is Not Entered
     C           #1AFCD    IFEQ *BLANK                     *IF
     C                     Z-ADD*ZERO     #1AXPC           Conversion Fact
     C                     MOVEL*BLANK    #1LYST           Operation Facto
     C                     END                             *FI
      * Re- Add After Testing
      * Pricing UM must equal primary, second or third UOM
      * CASE:
      *  - c1 AND c2 AND c3
      *   |- c1    : DTL.U/M - Pricing NE DTL.U/M - Primary
      *   |- c2    : DTL.U/M - Pricing NE DTL.U/M - Second
      *   |- c3    : DTL.U/M - Pricing NE DTL.U/M - Third
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1AICD    IFNE #1ADCD                     *IF
     C           #1AICD    IFNE #1AECD                     *IF
     C           #1AICD    IFNE #1AFCD                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1ADCD    ZA0004           U/M - Primary
     C                     MOVEL#1AECD    ZA0005           U/M - Second
     C                     MOVEL#1AFCD    ZA0006           U/M - Third
      * Send message 'U/M-base not equal 1,2or3'
     C                     MOVEL'USR0543' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Edit Commodity Group U/M to EQ Pricing U/M
      * CASE: DTL.Commodity Price Group is Not Blank
     C           #1LRCD    IFNE *BLANK                     *IF
      * RTV Commod U/M         RT - OM Commodity Group  * 
     C                     EXSR SSRVGN
      * CASE: DTL.U/M - Pricing NE WRK.U/M - Pricing
     C           #1AICD    IFNE WUAICD                     *IF
      * Setup message data for message
     C                     MOVEL#1LRCD    ZA0007           Commodity Price
      * Send message 'Com Group U/M must= U/M P'
     C                     MOVEL'USR2165' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If item type is FG/RM then check for errors
      * CASE: 2ND.Item Type Code is Finished Good/Raw Matrl
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
      * Variety/Rendered/Cut must be entered
      * CASE: 2ND.Variety/Rendered/Cut is Not Entered
     C           #1XWST    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1XWST    ZA0008           Variety/Rendere
      * Send message 'Vrty/Rend/Cut can't be BL'
     C                     MOVEL'USR1861' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * Default commodity market basis must be entered
      * CASE: 3RD.Default Commod Mark basis is Not Entered
     C           #1LNCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1LNCD    ZA0009           Default Commod
      * Send message 'Commdty Mrkt Can't be BL'
     C                     MOVEL'USR1862' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,32           *
      *
     C                     END                             *FI
      * Commodity price group must be entered
      * CASE: 3RD.Commodity Price Group is Not entered
     C           #1LRCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1LRCD    ZA0010           Commodity Price
      * Send message 'Commdty Group Can't be BL'
     C                     MOVEL'USR1863' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
      *
     C                     END                             *FI
      * Vendor cannot be entered for FG/RM Item
      * CASE: 3RD.Vendor - Item Default is Entered
     C           #1AJC8    IFNE *ZERO                      *IF
      * Setup message data for message
      * Convert Vendor - Item Default to external.
      * CD8 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1AJC8    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1AJC8    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    ZA0011           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0011           CD7 Ext Numeric
     C                     END                             *FI
      * Send message 'Vendor can't be Entered'
     C                     MOVEL'USR1864' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,40           *
      *
     C                     END                             *FI
      * Warehouse must be entered
      * CASE: 3RD.Default Warehouse is Warehouse Code Blank
     C           #1Q1CD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1Q1CD    ZA0012           Default Warehou
      * Send message 'Whse is Mandatory for FG'
     C                     MOVEL'USR1893' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Package type must be entered for item type 'PS'
      * CASE: 2ND.Package Type Code is *ALL values
     C           #1X4ST    IFEQ 'B'                        *IF
     C           #1X4ST    OREQ 'O'
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1X4ST    ZA0013           Package Type Co
      * Send message 'Package type can't be BLK'
     C                     MOVEL'USR1906' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Item Type = FG & Var/Rnd/Cut = Cut, then Base/Conv/Fab require
      * CASE: 2ND.Item Type Code is Finished Goods
     C           #1N0CD    IFEQ 'FG'                       *IF
      * CASE: 2ND.Variety/Rendered/Cut is Cut
     C           #1XWST    IFEQ 'C'                        *IF
      * CASE: 2ND.Converted/Base Item is Blank
     C           #1QZCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1QZCD    ZA0014           Base/Conv/Loss
      * Send message 'Base/Cov/Fab can't be BL'
     C                     MOVEL'USR1865' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * If item type is raw material then item must be base
      * CASE: 2ND.Item Type Code is Raw Materials
     C           #1N0CD    IFEQ 'RM'                       *IF
      * CASE: 2ND.Converted/Base Item is Base
     C           #1QZCD    IFEQ 'B'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1N0CD    ZA0015           Item Type Code
     C                     MOVEL#1QZCD    ZA0016           Base/Conv/Loss
      * Send message 'RM item must be a base'
     C                     MOVEL'USR2160' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If cut item then check for errors
      * CASE: 2ND.Variety/Rendered/Cut is Cut
     C           #1XWST    IFEQ 'C'                        *IF
      * Converted/Base/Fab must be entered
      * CASE: 2ND.Converted/Base Item is Blank
     C           #1QZCD    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#1QZCD    ZA0017           Base/Conv/Loss
      * Send message 'Base/Cov/Fab can't be BL'
     C                     MOVEL'USR1865' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Variety or rendered then std weight/head must be entered
      * CASE: 2ND.Variety/Rendered/Cut is Variety/Rendered
     C           #1XWST    IFEQ 'R'                        *IF
     C           #1XWST    OREQ 'V'
      * CASE: 3RD.Std Weight/Head (Var/Ren) is Equal to zero
     C           #1SWGH    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#1SWGH    ZA0018           Std Weight/Head
      * Send message 'Std Wght Head can't be BL'
     C                     MOVEL'USR1866' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If Credit item is yes, then item type must be FG
      * CASE: DTL.Credit Item Status is yes
     C           #1VMST    IFEQ 'Y'                        *IF
      * CASE: 2ND.Item Type Code is Finished Goods
     C           #1N0CD    IFEQ 'FG'                       *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#1VMST    ZA0019           Credit Item Sta
      * Send message 'Credit Item Must be FG'
     C                     MOVEL'USR1943' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Minimum Weight Per Case cannot be greater than Maximum Weight Per
      * CASE: DTL.Minimum Weight Per Case GT DTL.Maximum Weight Per Case
     C           #1CZWG    IFGT #1C0WG                     *IF
      * Send message 'Weight Min LE Max'
     C                     MOVEL'USR2274' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
      * If not a finished good, print on realization rpt = N
      * CASE: 2ND.Item Type Code is Not Finished Good
     C           #1N0CD    IFNE 'FG'                       *IF
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL'N'       #1X6ST           Print on Realiz
     C                     END                             *FI
      * Validate Minimum Weight Per Case w/Unit Weight
      * CASE: 3RD.Minimum Weight Per Case GT DTL.Unit Weight
     C           #1CZWG    IFGT #1AIWG                     *IF
      * Setup message data for message
     C                     Z-ADD#1CZWG    ZA0020           Minimum Weight
      * Send message 'Min Wgt > Unit'
     C                     MOVEL'USR2285' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,33           *
      *
     C                     END                             *FI
      * Validate Maximum Weight Per Case w/Unit Weight
      * CASE: 3RD.Maximum Weight Per Case LT DTL.Unit Weight
     C           #1C0WG    IFLT #1AIWG                     *IF
      * Setup message data for message
     C                     Z-ADD#1C0WG    ZA0021           Maximum Weight
      * Send message 'Max Wgt < Unit'
     C                     MOVEL'USR2286' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,34           *
      *
     C                     END                             *FI
      * Requirements for a Piece Count Item
      * CASE: 3RD.Piece Count Item is yes
     C           #1PCCT    IFEQ 'Y'                        *IF
      * CASE: 3RD.Pieces Per Bag is EQ Zero
     C           #1BDNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#1BDNB    ZA0022           Pieces Per Bag
      * Send message 'Pieces per Bag req'
     C                     MOVEL'USR2517' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,43           *
      *
     C                     END                             *FI
      * CASE: 3RD.Bags Per Unit is EQ Zero
     C           #1BJNB    IFEQ *ZERO                      *IF
      * Setup message data for message
     C                     Z-ADD#1BJNB    ZA0023           Bags Per Unit
      * Send message 'Bags per Unit req'
     C                     MOVEL'USR2518' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,44           *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     #1BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #1BJNB           Bags Per Unit
     C                     END                             *FI
      * Requirements if Item Type Code n= PS (packaging/supplies)
      * CASE: 2ND.Item Type Code is Finished Good/Raw Matrl
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
      * CASE: 2ND.Export/Domestic EQ WRK.BLANK 1               USR
     C           #1SUST    IFEQ WUJ1TX                     *IF
      * Setup message data for message
     C                     MOVEL#1SUST    ZA0024           Export/Domestic
      * Send message 'Export/Domestic Req'
     C                     MOVEL'USR2515' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,34           *
      *
     C                     END                             *FI
      * CASE: 2ND.Primal Group Code EQ WRK.BLANK 1               USR
     C           #1XRCD    IFEQ WUJ1TX                     *IF
      * Setup message data for message
     C                     MOVEL#1XRCD    ZA0025           Primal Group Co
      * Send message 'Primal Group Code req'
     C                     MOVEL'USR2516' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I2,36           *
      *
     C                     END                             *FI
      * CASE: 3RD.Fresh Inv Allocation Seq EQ WRK.BLANK 1               U
     C           #1SYST    IFEQ WUJ1TX                     *IF
      * Setup message data for message
     C                     MOVEL#1SYST    ZA0026           Fresh Inv Alloc
      * Send message 'Fresh Inv Allocation Seq'
     C                     MOVEL'USR2521' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,45           *
      *
     C                     END                             *FI
      * CASE: 3RD.Fresh Sched As Ordered EQ WRK.BLANK 1               USR
     C           #1SZST    IFEQ WUJ1TX                     *IF
      * Setup message data for message
     C                     MOVEL#1SZST    ZA0027           Fresh Sched As
      * Send message 'Fresh Sched As Ordered rq'
     C                     MOVEL'USR2519' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,46           *
      *
     C                     END                             *FI
      * CASE: 3RD.Frozen Sched As Ordered EQ WRK.BLANK 1               US
     C           #1S1ST    IFEQ WUJ1TX                     *IF
      * Setup message data for message
     C                     MOVEL#1S1ST    ZA0028           Frozen Sched As
      * Send message 'Frozn Sched As Ordered rq'
     C                     MOVEL'USR2520' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     MOVEL'1'       @I3,47           *
      *
     C                     END                             *FI
     C                     END                             *FI
      * If change mode, Chk for Changes which should initiate Price Audit
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
      * CASE: 2ND.Item Type Code is Finished Good/Raw Matrl
     C           #1N0CD    IFEQ 'FG'                       *IF
     C           #1N0CD    OREQ 'RM'
      * Record Status change
      * CASE: PAR.Record Status NE 2ND.Record Status
     C           P1VSST    IFNE #1VSST                     *IF
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     MOVEL'Y'       P3YLST           USR Market Meth
     C                     MOVEL'Y'       P3YMST           USR Manual Meth
     C                     MOVEL'Y'       P3YNST           USR Extend Meth
     C                     END                             *FI
      * U/M - Pricing change
      * CASE: PAR.U/M - Pricing NE DTL.U/M - Pricing
     C           P1AICD    IFNE #1AICD                     *IF
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     MOVEL'Y'       P3YLST           USR Market Meth
     C                     MOVEL'Y'       P3YMST           USR Manual Meth
     C                     END                             *FI
      * Default Commod Mark Basis change
      * CASE: PAR.Default Commod Mark basis NE DTL.Default Commod Mark ba
     C           P1LNCD    IFNE #1LNCD                     *IF
     C                     MOVELP1LNCD    P3LQCD           Commodity Marke
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     END                             *FI
      * Commodity Price Group change
      * CASE: PAR.Commodity Price Group NE DTL.Commodity Price Group
     C           P1LRCD    IFNE #1LRCD                     *IF
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     MOVEL'Y'       P3YLST           USR Market Meth
     C                     END                             *FI
      * Market Overage change
      * CASE: PAR.Market Overage NE DTL.Market Overage
     C           P1BLPR    IFNE #1BLPR                     *IF
     C                     MOVEL'Y'       P3YLST           USR Market Meth
     C                     END                             *FI
      * Standard Overage/underage change
      * CASE: PAR.Standard Overage/Underage NE DTL.Standard Overage/Under
     C           P1BMPR    IFNE #1BMPR                     *IF
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     END                             *FI
      * Item Pricing Operation change
      * CASE: PAR.Item Pricing Operation NE DTL.Item Pricing Operation
     C           P1U9ST    IFNE #1U9ST                     *IF
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     END                             *FI
      * Item Pricing Constant change
      * CASE: PAR.Item Pricing Constant NE DTL.Item Pricing Constant
     C           P1CMCO    IFNE #1CMCO                     *IF
     C                     MOVEL'Y'       P3YKST           USR Formula Met
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Check for AS Product field changes = Accu-Sort Plant Floor
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6 OR c7 OR c8 OR c9 OR c10 OR
      *  -  c11 OR c12
      *   |- c1    : PAR.Item Label Line 1 NE DTL.Item Label Line 1
      *   |- c2    : PAR.Item Label Line 2 NE DTL.Item Label Line 2
      *   |- c3    : PAR.Unit Weight NE DTL.Unit Weight
      *   |- c4    : PAR.Minimum Weight Per Case NE DTL.Minimum Weight Pe
      *   |- c5    : PAR.Maximum Weight Per Case NE DTL.Maximum Weight Pe
      *   |- c6    : PAR.Number Cases On A Pallet NE DTL.Number Cases On
      *   |- c7    : PAR.Chilling Time NE DTL.Chilling Time
      *   |- c8    : PAR.Item Label Line 3 NE DTL.Item Label Line 3
      *   |- c9    : PAR.Default Warehouse NE DTL.Default Warehouse
      *   |- c10   : PAR.Description Line One NE DTL.Description Line One
      *   |- c11   : PAR.Misc Tare Weight NE DTL.Misc Tare Weight
      *   |- c12   : PAR.Record Status NE DTL.Record Status
      *   '-
     C           P1L7NA    IFNE #1L7NA                     *IF
     C           P1L8NA    ORNE #1L8NA                     *OR
     C           P1AIWG    ORNE #1AIWG                     *OR
     C           P1CZWG    ORNE #1CZWG                     *OR
     C           P1C0WG    ORNE #1C0WG                     *OR
     C           P1URTN    ORNE #1URTN                     *OR
     C           P1CHTM    ORNE #1CHTM                     *OR
     C           P1L6NA    ORNE #1L6NA                     *OR
     C           P1Q1CD    ORNE #1Q1CD                     *OR
     C           P1AVNA    ORNE #1AVNA                     *OR
     C           P1A3WG    ORNE #1A3WG                     *OR
     C           P1VSST    ORNE #1VSST                     *OR
     C                     MOVEL'P'       P4ZQST           Change Plant Fl
     C                     END                             *FI
     C                     END
      * Check relations
      * Check reference to Unit of Measure
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Unit of Measure
     C                     EXSR VFCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to Quality Level
     C                     EXSR VGCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,31
     C                     SETON                     99    *
     C                     END
      * Check reference to PD Item Level
     C                     EXSR VHCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,32
     C                     SETON                     99    *
     C                     END
      * Check reference to Vendor
     C                     EXSR VICKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,40
     C                     SETON                     99    *
     C                     END
      * Check reference to OM Item Structure Class
     C                     EXSR VJCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to OM Item Structure Group
     C                     EXSR VKCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to OM Item Structure Type
     C                     EXSR VLCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to OM Commodity Group
     C                     EXSR VMCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I1,33
     C                     SETON                     99    *
     C                     END
      * Check reference to Warehouse
     C                     EXSR VNCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I3,38
     C                     SETON                     99    *
     C                     END
      * Check reference to PD Price Method Header
     C                     EXSR VOCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I1,34
     C                     SETON                     9931  *
     C                     END
      * Check reference to PS Production Department
     C                     EXSR VPCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     MOVEL'1'       @I3,39
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category Unused
     C                     EXSR VQCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VRCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VSCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VTCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VUCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VVCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VWCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VXCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VYCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR VZCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PD Item Category
     C                     EXSR WACKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PM R/M Type Master
     C                     EXSR WBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     99    *
     C                     END
      * Check reference to PM Line Master
     C                     EXSR WCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     SETON                     9931  *
     C                     SETON                     9931  *
     C                     END
      * Check reference to PS Primal Group
     C                     EXSR WDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     MOVEL*BLANK    W0RTN
     C                     MOVEL'1'       @I2,36
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen relations
      * Retrieve code names
      * Rtv Quality Level Desc RT - Quality Level  * 
     C                     EXSR STRVGN
      * RTV Item Level Descr   RT - PD Item Level  * 
     C                     EXSR SURVGN
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
     C                     EXSR SVRVGN
      * RTV Commod. Mkts Desc  RT - OM Commodity Markets  * 
     C                     EXSR SWRVGN
      * RTV Commod Group Desc  RT - OM Commodity Group  * 
     C                     EXSR SXRVGN
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
     C                     EXSR SYRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SZRVGN
      * Rtv Prod Dept Name    RT - PS Production Department  * 
     C                     EXSR TARVGN
      * Rtv Vendor Name        RT - Vendor  * 
     C                     EXSR TBRVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR TCRVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR TDRVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR TERVGN
      * Rtv UOM Description    RT - Unit of Measure  * 
     C                     EXSR TFRVGN
      * Retrieve condition names
      * 2ND.Condition Desc. 1  USR = Condition name of 2ND.Item Type Code
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294118   Y2LSNO  70       List number
     C                     PARM #1N0CD    W0INVL 20        Item Type Code
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHLTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Desc. 2  USR = Condition name of 2ND.Package Type C
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1301868   Y2LSNO  70       List number
     C                     PARM #1X4ST    W0INVL 20        Package Type Co
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHMTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Desc. 3  USR = Condition name of 2ND.Converted/Base
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1294120   Y2LSNO  70       List number
     C                     PARM #1QZCD    W0INVL 20        Base/Conv/Loss
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHNTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Desc. 4  USR = Condition name of 2ND.Variety/Render
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1292551   Y2LSNO  70       List number
     C                     PARM #1XWST    W0INVL 20        Variety/Rendere
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHOTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 2ND.Condition Name USR = Condition name of 2ND.Seconds Item
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1349716   Y2LSNO  70       List number
     C                     PARM #1X5ST    W0INVL 20        Seconds Item
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DGUTX    PARM           W0CNNM 25        Condition Name
      *
      * DTL.Condition Desc. 10 USR = Condition name of DTL.Item Pricing O
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1260938   Y2LSNO  70       List number
     C                     PARM #1U9ST    W0INVL 20        Item Pricing Op
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHUTX    PARM           W0CNNM 25        Condition Desc.
      *
      * 3RD.Status Description = Condition name of 2ND.Record Status
     C                     CALL 'CARVCNR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1255478   Y2LSNO  70       List number
     C                     PARM #1VSST    W0INVL 20        Record Status
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DHKNA    PARM           W0CNNM 25        Status Descript
      *
      * RTV Item Group         RT - OM Item Structure Class  * 
     C                     EXSR TGRVGN
      * Rtv Item Type          RT - OM Item Structure Group  * 
     C                     EXSR THRVGN
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL#DSTAT    #1X6ST           Print on Realiz
     C                     END
      * Production Date Control required
     C           #1FZST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I1,31
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * USR Prt on Realization Rp required
     C           #DSTAT    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I2,33
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Print On Schedule required
     C           #1SVST    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I2,35
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * Piece Count Item required
     C           #1PCCT    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     MOVEL'1'       @I3,42
     C                     SETON                     99    *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert internal to external form
     C                     EXSR MOCV#D
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C           W0SCR     IFEQ 1
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     WRITE#CMDTXT3
     C                     WRITE#RCDDTL2
     C                     ELSE
     C           W0SCR     IFEQ 3
     C                     WRITE#CMDTXT4
     C                     WRITE#RCDDTL3
     C                     END
     C                     END
     C                     END
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 20        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: DTL.*CMD key is CF01
     C           *IN01     IFEQ '1'                        *IF
     C                     END                             *FI
     C                     MOVEL'00'      WUKTTX           Alpha Zeros
     C                     MOVEL'Y'       W0RSL            *Record selecte
      * Change AS Product code if change status is yes = Accu-Sort
      * CASE: PAR.Change Plant Floor USR is Change Product Only
     C           P4ZQST    IFEQ 'P'                        *IF
      * If Item status is not Active then send Accusort Delete Code
      * CASE: DTL.Record Status is Active
     C           #1VSST    IFEQ 'A'                        *IF
     C                     MOVEL'A'       P5Y5ST           AS Add/Change/D
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'D'       P5Y5ST           AS Add/Change/D
     C                     END                             *FI
      * UPD One AS Prod/Box Rc XF - Company/Item  * 
     C                     CALL 'PDK1XFR'              90  UPD One AS Prod
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0024  30       Company Number
     C                     PARM #1HGCD    WQ0025  70       Item Code
     C                     PARM #1AVNA    WQ0026 30        Description Lin
     C                     PARM #1L7NA    WQ0027 32        Item Label Line
     C                     PARM #1L8NA    WQ0028 32        Item Label Line
     C                     PARM #1L6NA    WQ0029 32        Item Label Line
     C                     PARM #1AIWG    WQ0030 112       Unit Weight
     C                     PARM #1AVST    WQ0031  1        Catch Weight St
     C                     PARM #1CZWG    WQ0032 112       Minimum Weight
     C                     PARM #1C0WG    WQ0033 112       Maximum Weight
     C                     PARM #1URTN    WQ0034  50       Number Cases On
     C                     PARM #1N0CD    WQ0035  3        Item Type Code
     C                     PARM #1X4ST    WQ0036  1        Package Type Co
     C                     PARM #1Q1CD    WQ0037  3        Default Warehou
     C                     PARM #1CHTM    WQ0038  52       Fresh Chilling
     C                     PARM #1A3WG    WQ0039  52       Misc Tare Weigh
     C                     PARM P5Y5ST    WQ0040  1        AS Add/Change/D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDK1XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Change item structure in inventory if item structure class change
      * CASE: PAR.Item Structure Class Code NE DTL.Item Structure Class C
     C           P1RINB    IFNE #1RINB                     *IF
      * Chg Item Structure     RT - IC Item Balance  * 
     C                     EXSR TIRVGN
      * Chg Item Structure     RT - IC Item Balance Detail  * 
     C                     EXSR TKRVGN
      * Chg Item Structure     RT - IC Transaction Detail  * 
     C                     EXSR TMRVGN
     C                     END                             *FI
      * CASE: One or more flags set
      *  - c1 OR c2 OR c3 OR c4
      *   |- c1    : PAR.USR Formula Meth Type Sts is yes
      *   |- c2    : PAR.USR Market Meth Type Sts is yes
      *   |- c3    : PAR.USR Manual Meth Type Sts is yes
      *   |- c4    : PAR.USR Extend Meth Type Sts is yes
      *   '-
     C           P3YKST    IFEQ 'Y'                        *IF
     C           P3YLST    OREQ 'Y'                        *OR
     C           P3YMST    OREQ 'Y'                        *OR
     C           P3YNST    OREQ 'Y'                        *OR
      * UPD Price Audit Update XF - OM Shipping Detail  * 
     C                     CALL 'PDMOXFR'              90  UPD Price Audit
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 'CABZREP' WQ0041 10        File Name
     C                     PARM #1AIC3    WQ0042  30       Company Number
     C                     PARM *ZERO     WQ0043  70       Ship To Custome
     C                     PARM #1HGCD    WQ0044  70       Item Code
     C                     PARM P3LQCD    WQ0045  3        Commodity Marke
     C                     PARM P1LRCD    WQ0046  7        Commodity Price
     C                     PARM *ZERO     WQ0047  70       Market Price Da
     C                     PARM P3YKST    WQ0048  1        USR Formula Met
     C                     PARM P3YLST    WQ0049  1        USR Market Meth
     C                     PARM P3YMST    WQ0050  1        USR Manual Meth
     C                     PARM P3YNST    WQ0051  1        USR Extend Meth
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMOXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * CRT Item/Add to AvlGrp CR - Company/Item  * 
     C                     EXSR TOCRRC
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Item/Item Default  CH - Company/Item  * 
     C                     EXSR TQCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YDRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C           W0SCR     IFNE 1
     C                     MOVEL'0'       *IN79
     C                     END
     C           W0SCR     IFNE 2
     C                     END
     C           W0SCR     IFNE 3
     C                     END
     C           W0SCR     IFEQ 1
     C                     MOVEL'0'       *IN79
     C           P6TIST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     ELSE
     C           W0SCR     IFEQ 2
     C                     ELSE
     C           W0SCR     IFEQ 3
     C                     END
     C                     END
     C                     END
      * Enable key screen
     C                     SETON                     87    *
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1L7NA           Item Label Line
     C                     MOVEL*BLANK    #1L8NA           Item Label Line
     C                     MOVEL*BLANK    #1L6NA           Item Label Line
     C                     MOVEL*BLANK    #1MFNA           Item Label Line
     C                     MOVEL*BLANK    #DMBNA           USR Label Descr
     C                     MOVEL*BLANK    #DMENA           USR Label Descr
     C                     Z-ADD*ZERO     #1AWPC           Conversion Fact
     C                     MOVEL*BLANK    #1LXST           Operation Facto
     C                     MOVEL*BLANK    #1AECD           U/M - Second
     C                     MOVEL*BLANK    #DM5NA           UOM Description
     C                     Z-ADD*ZERO     #1AXPC           Conversion Fact
     C                     MOVEL*BLANK    #1LYST           Operation Facto
     C                     MOVEL*BLANK    #1AFCD           U/M - Third
     C                     MOVEL*BLANK    #DM6NA           UOM Description
     C                     MOVEL*BLANK    #1HICD           Quality Level
     C                     Z-ADD*ZERO     #1CZWG           Minimum Weight
     C                     Z-ADD*ZERO     #1C0WG           Maximum Weight
     C                     Z-ADD*ZERO     #1URTN           Number Cases On
     C                     MOVEL*BLANK    #1RBCD           Item Level
     C                     MOVEL*BLANK    #1AJC8           Vendor - Item D
     C                     Z-ADD*ZERO     #1RINB           Item Structure
     C                     Z-ADD*ZERO     #1RHNB           Item Structure
     C                     Z-ADD*ZERO     #1RGNB           Item Structure
     C                     MOVEL*BLANK    #1LLCD           Packaging Code
     C                     MOVEL*BLANK    #1LMCD           Grade Code
     C                     Z-ADD*ZERO     #1SFNB           UnUsed NBR 5.2
     C                     Z-ADD*ZERO     #1A3WG           Misc Tare Weigh
     C                     Z-ADD*ZERO     #1SJNB           Packages (Trays
     C                     MOVEL*BLANK    #1P3ST           Agrimetrics Ran
     C                     Z-ADD*ZERO     #1SKNB           Agrimetrics gro
     C                     Z-ADD*ZERO     #1SLNB           Agrimetrics pac
     C                     Z-ADD*ZERO     #1SMNB           Agrimetrics gra
     C                     MOVEL*BLANK    #1P4ST           Agritech Captur
     C                     Z-ADD*ZERO     #1TFNB           Transportation
     C                     MOVEL*BLANK    #1N0CD           Item Type Code
     C                     MOVEL*BLANK    #1X4ST           Package Type Co
     C                     Z-ADD*ZERO     #1CFNB           PM Pounds per H
     C                     Z-ADD*ZERO     #1CGNB           PM Line Time Ef
     C                     Z-ADD*ZERO     #1ILNB           PM % 2nds Facto
     C                     Z-ADD*ZERO     #1CHNB           PM Crew Size
     C                     Z-ADD*ZERO     #1CINB           PM Batch Size
     C                     Z-ADD*ZERO     #1CJNB           PM Lot Size
     C                     Z-ADD*ZERO     #1CMNB           PM BOM Spec Dat
     C                     Z-ADD*ZERO     #1CNNB           PM Seaboard Spe
     C                     Z-ADD*ZERO     #1CRNB           PM Seaboard Rep
     C                     Z-ADD*ZERO     #1CSNB           PM Raw Yield
     C                     Z-ADD*ZERO     #1CVNB           PM Formula Yiel
     C                     Z-ADD*ZERO     #1CWNB           PM Standard LBS
     C                     Z-ADD*ZERO     #1CXNB           PM Raw Meat LBS
     C                     Z-ADD*ZERO     #1CZNB           PM Formula LBS/
     C                     Z-ADD*ZERO     #1C0NB           PM Finished LBS
     C                     MOVEL*BLANK    #1N1CD           PM ABC Class
     C                     Z-ADD*ZERO     #1B4NB           PM R/M Type Cod
     C                     Z-ADD*ZERO     #1B5NB           PM Line Number
     C                     MOVEL*BLANK    #1X5ST           Seconds Item
     C                     MOVEL*BLANK    #1X6ST           Print on Realiz
     C                     MOVEL*BLANK    #1X7ST           Unit Weight Cha
     C                     MOVEL*BLANK    #1PCCT           Piece Count Ite
     C                     Z-ADD*ZERO     #1BDNB           Pieces Per Bag
     C                     Z-ADD*ZERO     #1BJNB           Bags Per Unit
     C                     MOVEL*BLANK    #1SUST           Export/Domestic
     C                     MOVEL*BLANK    #1SVST           Print On Schedu
     C                     MOVEL*BLANK    #1SYST           Fresh Inv Alloc
     C                     MOVEL*BLANK    #1SZST           Fresh Sched As
     C                     MOVEL*BLANK    #1S1ST           Frozen Sched As
     C                     MOVEL*BLANK    #1XRCD           Primal Group Co
     C                     MOVEL*BLANK    #1XTCD           UPC Code 1
     C                     MOVEL*BLANK    #1XUCD           UPC Code 2
     C                     Z-ADD*ZERO     #1F5WG           CI Unused Wgt 1
     C                     Z-ADD*ZERO     #1F6WG           CI Unused Wgt 2
     C                     Z-ADD*ZERO     #1F7WG           CI Unused Wgt 3
     C                     Z-ADD*ZERO     #1BLNB           CI Unused Nbr 1
     C                     Z-ADD*ZERO     #1BNNB           CI Unused Nbr 2
     C                     MOVEL*BLANK    #1S2ST           CI Unused Sts 1
     C                     MOVEL*BLANK    #1S4ST           CI Unused Sts 2
     C                     MOVEL*BLANK    #1S5ST           CI Unused Sts 3
     C                     MOVEL*BLANK    #1S6ST           CI Unused Sts 4
     C                     MOVEL*BLANK    #1S8ST           CI Unused Sts 5
     C                     MOVEL*BLANK    #1S9ST           CI Unused Sts 6
     C                     MOVEL*BLANK    #1TCST           CI Unused Sts 7
     C                     MOVEL*BLANK    #1TDST           CI Unused Sts 8
     C                     MOVEL*BLANK    #1Q1CD           Default Warehou
     C                     Z-ADD*ZERO     #1CHTM           Fresh Chilling
     C                     MOVEL*BLANK    #1QZCD           Base/Conv/Loss
     C                     MOVEL*BLANK    #1XWST           Variety/Rendere
     C                     Z-ADD*ZERO     #1SWGH           Std Weight/Head
     C                     Z-ADD*ZERO     #1PPHE           Pieces Per Head
     C                     MOVEL*BLANK    #1R3CD           Department Code
     C                     MOVEL*BLANK    #1SDCD           PD Code UnUsed
     C                     Z-ADD*ZERO     #1ICN1           Item Category N
     C                     MOVEL*BLANK    #1SVCD           Item Category C
     C                     Z-ADD*ZERO     #1ICN2           Item Category N
     C                     MOVEL*BLANK    #1SWCD           Item Category C
     C                     Z-ADD*ZERO     #1V2NB           Item Category N
     C                     MOVEL*BLANK    #1SXCD           Item Category C
     C                     Z-ADD*ZERO     #1ITCN           Item Category N
     C                     MOVEL*BLANK    #1SYCD           Item Category C
     C                     Z-ADD*ZERO     #1ITC5           Item Category N
     C                     MOVEL*BLANK    #1SZCD           Item Category C
     C                     Z-ADD*ZERO     #1ICN6           Item Category N
     C                     MOVEL*BLANK    #1S0CD           Item Category C
     C                     Z-ADD*ZERO     #1ICN7           Item Category N
     C                     MOVEL*BLANK    #1S1CD           Item Category C
     C                     Z-ADD*ZERO     #1ICN8           Item Category N
     C                     MOVEL*BLANK    #1S2CD           Item Category C
     C                     Z-ADD*ZERO     #1ICN9           Item Category N
     C                     MOVEL*BLANK    #1S3CD           Item Category C
     C                     Z-ADD*ZERO     #1ICN0           Iten Category N
     C                     MOVEL*BLANK    #1S4CD           Item Category C
     C                     MOVEL*BLANK    #1UVST           EDI Status 1
     C                     MOVEL*BLANK    #1UWST           EDI Status 2
     C                     MOVEL*BLANK    #1UXST           EDI Status 3
     C                     MOVEL*BLANK    #1VSST           Record Status
     C                     Z-ADD*ZERO     #1AATM           Job Time
     C                     MOVEL*BLANK    #1AYNA           User Id
     C                     MOVEL*BLANK    #1A0NA           Job Name
     C                     Z-ADD*ZERO     #1AXDT           Job Date
     C                     MOVEL*BLANK    #1AVNA           Description Lin
     C                     MOVEL*BLANK    #1AWNA           Description Lin
     C                     MOVEL*BLANK    #1FZST           Production Date
     C                     MOVEL*BLANK    #1AVST           Catch Weight St
     C                     MOVEL*BLANK    #1XXST           Case Ready Stat
     C                     MOVEL*BLANK    #1VMST           Credit Item Sta
     C                     Z-ADD*ZERO     #1AIWG           Unit Weight
     C                     MOVEL*BLANK    #1ADCD           U/M - Primary
     C                     MOVEL*BLANK    #DM4NA           UOM Description
     C                     MOVEL*BLANK    #1AICD           U/M - Pricing
     C                     MOVEL*BLANK    #DM7NA           UOM Description
     C                     MOVEL*BLANK    #1LNCD           Default Commod
     C                     MOVEL*BLANK    #DJ3NA           Commodity Marke
     C                     MOVEL*BLANK    #1LRCD           Commodity Price
     C                     MOVEL*BLANK    #DJ4NA           Commodity Price
     C                     MOVEL*BLANK    #1Q8CD           Price Method De
     C                     MOVEL*BLANK    #DMLNA           Price Method De
     C                     Z-ADD*ZERO     #1TNVA           Minimum Audit V
     C                     Z-ADD*ZERO     #1TMVA           Maximum Audit V
     C                     Z-ADD*ZERO     #1BLPR           Market Overage
     C                     Z-ADD*ZERO     #1BMPR           Standard Overag
     C                     MOVEL*BLANK    #1U9ST           Item Pricing Op
     C                     MOVEL*BLANK    #DHUTX           Condition Desc.
     C                     Z-ADD*ZERO     #1CMCO           Item Pricing Co
     C                     MOVEL*BLANK    #DM0NA           PD Description
     C                     MOVEL*BLANK    #DOICD           USR R/M Type Co
     C                     Z-ADD*ZERO     #DPPHD           Pieces Per Head
     C                     MOVEL*BLANK    #DHLTX           Condition Desc.
     C                     MOVEL*BLANK    #DHMTX           Condition Desc.
     C                     MOVEL*BLANK    #DJNNA           USR Description
     C                     MOVEL*BLANK    #DGUTX           Condition Name
     C                     MOVEL*BLANK    #DDPNA           USR Description
     C                     MOVEL*BLANK    #DDETX           Item Structure
     C                     MOVEL*BLANK    #DHNTX           Condition Desc.
     C                     MOVEL*BLANK    #DHOTX           Condition Desc.
     C                     MOVEL*BLANK    #DSTAT           USR Prt on Real
     C                     MOVEL*BLANK    #DMRTX           Export/Domestic
     C                     MOVEL*BLANK    #DOJNA           Primal Group De
     C                     MOVEL*BLANK    #DMCNA           USR Label Addre
     C                     MOVEL*BLANK    #DMDNA           USR Label Addre
     C                     MOVEL*BLANK    #DHKNA           Status Descript
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     MOVEL*BLANK    #DMYNA           Department Desc
     C                     MOVEL*BLANK    #DBATX           Vendor Name
     C                     MOVEL*BLANK    #DMSTX           Fresh Inv Alloc
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @BZREJU fields to screen
      *================================================================
     C                     MOVELBZL7NA    #1L7NA           Item Label Line
     C                     MOVELBZL8NA    #1L8NA           Item Label Line
     C                     MOVELBZL6NA    #1L6NA           Item Label Line
     C                     MOVELBZMFNA    #1MFNA           Item Label Line
     C                     Z-ADDBZAWPC    #1AWPC           Conversion Fact
     C                     MOVELBZLXST    #1LXST           Operation Facto
     C                     MOVELBZAECD    #1AECD           U/M - Second
     C                     Z-ADDBZAXPC    #1AXPC           Conversion Fact
     C                     MOVELBZLYST    #1LYST           Operation Facto
     C                     MOVELBZAFCD    #1AFCD           U/M - Third
     C                     MOVELBZHICD    #1HICD           Quality Level
     C                     Z-ADDBZCZWG    #1CZWG           Minimum Weight
     C                     Z-ADDBZC0WG    #1C0WG           Maximum Weight
     C                     Z-ADDBZURTN    #1URTN           Number Cases On
     C                     MOVELBZRBCD    #1RBCD           Item Level
     C                     MOVELBZAJC8    #1AJC8           Vendor - Item D
     C                     Z-ADDBZRINB    #1RINB           Item Structure
     C                     Z-ADDBZRHNB    #1RHNB           Item Structure
     C                     Z-ADDBZRGNB    #1RGNB           Item Structure
     C                     MOVELBZLLCD    #1LLCD           Packaging Code
     C                     MOVELBZLMCD    #1LMCD           Grade Code
     C                     Z-ADDBZSFNB    #1SFNB           UnUsed NBR 5.2
     C                     Z-ADDBZA3WG    #1A3WG           Misc Tare Weigh
     C                     Z-ADDBZSJNB    #1SJNB           Packages (Trays
     C                     MOVELBZP3ST    #1P3ST           Agrimetrics Ran
     C                     Z-ADDBZSKNB    #1SKNB           Agrimetrics gro
     C                     Z-ADDBZSLNB    #1SLNB           Agrimetrics pac
     C                     Z-ADDBZSMNB    #1SMNB           Agrimetrics gra
     C                     MOVELBZP4ST    #1P4ST           Agritech Captur
     C                     Z-ADDBZTFNB    #1TFNB           Transportation
     C                     MOVELBZN0CD    #1N0CD           Item Type Code
     C                     MOVELBZX4ST    #1X4ST           Package Type Co
     C                     Z-ADDBZCFNB    #1CFNB           PM Pounds per H
     C                     Z-ADDBZCGNB    #1CGNB           PM Line Time Ef
     C                     Z-ADDBZILNB    #1ILNB           PM % 2nds Facto
     C                     Z-ADDBZCHNB    #1CHNB           PM Crew Size
     C                     Z-ADDBZCINB    #1CINB           PM Batch Size
     C                     Z-ADDBZCJNB    #1CJNB           PM Lot Size
     C                     Z-ADDBZCMNB    #1CMNB           PM BOM Spec Dat
     C                     Z-ADDBZCNNB    #1CNNB           PM Seaboard Spe
     C                     Z-ADDBZCRNB    #1CRNB           PM Seaboard Rep
     C                     Z-ADDBZCSNB    #1CSNB           PM Raw Yield
     C                     Z-ADDBZCVNB    #1CVNB           PM Formula Yiel
     C                     Z-ADDBZCWNB    #1CWNB           PM Standard LBS
     C                     Z-ADDBZCXNB    #1CXNB           PM Raw Meat LBS
     C                     Z-ADDBZCZNB    #1CZNB           PM Formula LBS/
     C                     Z-ADDBZC0NB    #1C0NB           PM Finished LBS
     C                     MOVELBZN1CD    #1N1CD           PM ABC Class
     C                     Z-ADDBZB4NB    #1B4NB           PM R/M Type Cod
     C                     Z-ADDBZB5NB    #1B5NB           PM Line Number
     C                     MOVELBZX5ST    #1X5ST           Seconds Item
     C                     MOVELBZX6ST    #1X6ST           Print on Realiz
     C                     MOVELBZX7ST    #1X7ST           Unit Weight Cha
     C                     MOVELBZPCCT    #1PCCT           Piece Count Ite
     C                     Z-ADDBZBDNB    #1BDNB           Pieces Per Bag
     C                     Z-ADDBZBJNB    #1BJNB           Bags Per Unit
     C                     MOVELBZSUST    #1SUST           Export/Domestic
     C                     MOVELBZSVST    #1SVST           Print On Schedu
     C                     MOVELBZSYST    #1SYST           Fresh Inv Alloc
     C                     MOVELBZSZST    #1SZST           Fresh Sched As
     C                     MOVELBZS1ST    #1S1ST           Frozen Sched As
     C                     MOVELBZXRCD    #1XRCD           Primal Group Co
     C                     MOVELBZXTCD    #1XTCD           UPC Code 1
     C                     MOVELBZXUCD    #1XUCD           UPC Code 2
     C                     Z-ADDBZF5WG    #1F5WG           CI Unused Wgt 1
     C                     Z-ADDBZF6WG    #1F6WG           CI Unused Wgt 2
     C                     Z-ADDBZF7WG    #1F7WG           CI Unused Wgt 3
     C                     Z-ADDBZBLNB    #1BLNB           CI Unused Nbr 1
     C                     Z-ADDBZBNNB    #1BNNB           CI Unused Nbr 2
     C                     MOVELBZS2ST    #1S2ST           CI Unused Sts 1
     C                     MOVELBZS4ST    #1S4ST           CI Unused Sts 2
     C                     MOVELBZS5ST    #1S5ST           CI Unused Sts 3
     C                     MOVELBZS6ST    #1S6ST           CI Unused Sts 4
     C                     MOVELBZS8ST    #1S8ST           CI Unused Sts 5
     C                     MOVELBZS9ST    #1S9ST           CI Unused Sts 6
     C                     MOVELBZTCST    #1TCST           CI Unused Sts 7
     C                     MOVELBZTDST    #1TDST           CI Unused Sts 8
     C                     MOVELBZQ1CD    #1Q1CD           Default Warehou
     C                     Z-ADDBZCHTM    #1CHTM           Fresh Chilling
     C                     MOVELBZQZCD    #1QZCD           Base/Conv/Loss
     C                     MOVELBZXWST    #1XWST           Variety/Rendere
     C                     Z-ADDBZSWGH    #1SWGH           Std Weight/Head
     C                     Z-ADDBZPPHE    #1PPHE           Pieces Per Head
     C                     MOVELBZR3CD    #1R3CD           Department Code
     C                     MOVELBZSDCD    #1SDCD           PD Code UnUsed
     C                     Z-ADDBZICN1    #1ICN1           Item Category N
     C                     MOVELBZSVCD    #1SVCD           Item Category C
     C                     Z-ADDBZICN2    #1ICN2           Item Category N
     C                     MOVELBZSWCD    #1SWCD           Item Category C
     C                     Z-ADDBZV2NB    #1V2NB           Item Category N
     C                     MOVELBZSXCD    #1SXCD           Item Category C
     C                     Z-ADDBZITCN    #1ITCN           Item Category N
     C                     MOVELBZSYCD    #1SYCD           Item Category C
     C                     Z-ADDBZITC5    #1ITC5           Item Category N
     C                     MOVELBZSZCD    #1SZCD           Item Category C
     C                     Z-ADDBZICN6    #1ICN6           Item Category N
     C                     MOVELBZS0CD    #1S0CD           Item Category C
     C                     Z-ADDBZICN7    #1ICN7           Item Category N
     C                     MOVELBZS1CD    #1S1CD           Item Category C
     C                     Z-ADDBZICN8    #1ICN8           Item Category N
     C                     MOVELBZS2CD    #1S2CD           Item Category C
     C                     Z-ADDBZICN9    #1ICN9           Item Category N
     C                     MOVELBZS3CD    #1S3CD           Item Category C
     C                     Z-ADDBZICN0    #1ICN0           Iten Category N
     C                     MOVELBZS4CD    #1S4CD           Item Category C
     C                     MOVELBZUVST    #1UVST           EDI Status 1
     C                     MOVELBZUWST    #1UWST           EDI Status 2
     C                     MOVELBZUXST    #1UXST           EDI Status 3
     C                     MOVELBZVSST    #1VSST           Record Status
     C                     Z-ADDBZAATM    #1AATM           Job Time
     C                     MOVELBZAYNA    #1AYNA           User Id
     C                     MOVELBZA0NA    #1A0NA           Job Name
     C                     Z-ADDBZAXDT    #1AXDT           Job Date
     C                     MOVELBZAIC3    #1AIC3           Company Number
     C                     MOVELBZHGCD    #1HGCD           Item Code
     C                     MOVELBZAVNA    #1AVNA           Description Lin
     C                     MOVELBZAWNA    #1AWNA           Description Lin
     C                     MOVELBZFZST    #1FZST           Production Date
     C                     MOVELBZAVST    #1AVST           Catch Weight St
     C                     MOVELBZXXST    #1XXST           Case Ready Stat
     C                     MOVELBZVMST    #1VMST           Credit Item Sta
     C                     Z-ADDBZAIWG    #1AIWG           Unit Weight
     C                     MOVELBZADCD    #1ADCD           U/M - Primary
     C                     MOVELBZAICD    #1AICD           U/M - Pricing
     C                     MOVELBZLNCD    #1LNCD           Default Commod
     C                     MOVELBZLRCD    #1LRCD           Commodity Price
     C                     MOVELBZQ8CD    #1Q8CD           Price Method De
     C                     Z-ADDBZTNVA    #1TNVA           Minimum Audit V
     C                     Z-ADDBZTMVA    #1TMVA           Maximum Audit V
     C                     Z-ADDBZBLPR    #1BLPR           Market Overage
     C                     Z-ADDBZBMPR    #1BMPR           Standard Overag
     C                     MOVELBZU9ST    #1U9ST           Item Pricing Op
     C                     Z-ADDBZCMCO    #1CMCO           Item Pricing Co
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVEL*BLANK    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #1HGCD           Item Code
      * Clear external version also
     C                     MOVEL*BLANK    V1HGCD
      * USER: Initialize key screen
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
     C                     Z-ADDP1HGCD    #1HGCD           Item Code
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MNCV#K    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         MOCV#D    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1HGCD    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1HGCD    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1HGCD           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1HGCD           CD7 Ext Numeric
     C                     END                             *FI
      * Convert Vendor - Item Default to external.
      * CD8 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1AJC8    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1AJC8    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1AJC8           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AJC8           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MOEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Item Defaults     RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BYHGCD           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    BYHGCD           Item Code
      * Establish starting position
     C           KRSSA     CHAIN@BYREA1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBYAVNA    #1AVNA           Description Lin
     C                     MOVELBYAWNA    #1AWNA           Description Lin
     C                     MOVELBYHHCD    #1ADCD           U/M - Primary D
     C                     Z-ADDBYAWPC    #1AWPC           Conversion Fact
     C                     MOVELBYLXST    #1LXST           Operation Facto
     C                     MOVELBYLGCD    #1AECD           U/M - Second Df
     C                     Z-ADDBYAXPC    #1AXPC           Conversion Fact
     C                     MOVELBYLYST    #1LYST           Operation Facto
     C                     MOVELBYLHCD    #1AFCD           U/M - Third Dft
     C                     MOVELBYLICD    #1AICD           U/M - Pricing D
     C                     Z-ADDBYAIWG    #1AIWG           Unit Weight
     C                     MOVELBYAVST    #1AVST           Catch Weight St
     C                     Z-ADDBYRINB    #1RINB           Item Structure
     C                     Z-ADDBYRHNB    #1RHNB           Item Structure
     C                     Z-ADDBYRGNB    #1RGNB           Item Structure
     C                     MOVELBYN0CD    #1N0CD           Item Type Code
     C                     MOVELBYX4ST    #1X4ST           Package Type Co
     C                     MOVELBYQZCD    #1QZCD           Base/Conv/Loss
     C                     MOVELBYXWST    #1XWST           Variety/Rendere
     C                     MOVELBYXXST    #1XXST           Case Ready Stat
     C                     MOVELBYVMST    #1VMST           Credit Item Sta
     C                     MOVELBYX5ST    #1X5ST           Seconds Item
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Enable Catch Wgt   RT - System Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           DPDOCD           System Value Co
      * Setup key
     C                     MOVE *BLANK    DPDOCD           System Value Co
     C                     MOVEL'ENBCWP'  DPDOCD           System Value Co
      * Establish starting position
     C           KRSSB     CHAIN@DPRETD              90    *
      * Data record not found
     C   90                MOVEL'USR0759' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELDPBXTX    P6GGST           USR Display fie
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Chk Alloc/On Hand  RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       P6ECST           Error Status
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQSC01           Company Number
     C           *LIKE     DEFN B0HGCD    WQSC02           Item Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQSC01           Company Number
     C                     Z-ADD#1HGCD    WQSC02           Item Code
      * Establish starting position
     C           KRSSC     SETLL@B0REJX                    *
     C           KRSSC     READE@B0REJX                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Signal error is any quantity on hand
      * CASE: DB1.On Hand U/M1 Summary is not equal zero
     C           B0DDQT    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       P6ECST           Error Status
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.On Hand U/M2 Summary is not equal zero
     C           B0DEQT    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       P6ECST           Error Status
     C                     GOTO SCEXIT                     *QUIT
     C                     ELSE
      * CASE: DB1.On Hand U/M3 Summary is not equal zero
     C           B0DFQT    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       P6ECST           Error Status
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Signal error if any quantity allocated
      * CASE: DB1.Quantity Allocated - U/M1 is not equal zero
     C           B0AJQT    IFNE *ZERO                      *IF
     C                     MOVEL'Y'       P6ECST           Error Status
     C                     GOTO SCEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSC     READE@B0REJX                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * VAL Any Dtl Exists     RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1AIC3    WQSD01           Company Number
     C           *LIKE     DEFN B1HGCD    WQSD02           Item Code
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Item Code
      * Setup key
     C                     Z-ADDBZAIC3    WQSD01           Company Number
     C                     Z-ADDBZHGCD    WQSD02           Item Code
      * Establish starting position
     C           KRSSD     SETLL@B1REJ0                    *
     C           KRSSD     READE@B1REJ0                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0330' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Quality Level Desc RT - Quality Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVELBZHICD    AIHICD           Quality Level
      * Establish starting position
     C           KRSSE     CHAIN@AIREBL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0024' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJNNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAUNA    #DJNNA           Description
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Item Level Descr   RT - PD Item Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           ILRBCD           Item Level
      * Setup key
     C                     MOVELBZRBCD    ILRBCD           Item Level
      * Establish starting position
     C           KRSSF     CHAIN@ILRERK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1673' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDPNA           Description
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELILAUNA    #DDPNA           Description
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADDBZRINB    FARINB           Item Structure
      * Establish starting position
     C           KRSSG     CHAIN@FAREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDETX           Item Structure
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFADETX    #DDETX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Avl Dsp Grp Desc   RT - PD Item Category Unused  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           JGAIC3           Company Number
     C                     KFLD           JGSDCD           PD Code UnUsed
      * Setup key
     C                     Z-ADDBZAIC3    JGAIC3           Company Number
     C                     MOVELBZSDCD    JGSDCD           PD Code UnUsed
      * Establish starting position
     C           KRSSH     CHAIN@JGREXH              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1830' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM0NA           PD Description
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELJGM0NA    #DM0NA           PD Description
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * RTV Commod. Mkts Desc  RT - OM Commodity Markets  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVELBZLNCD    FYLQCD           Commodity Marke
      * Establish starting position
     C           KRSSI     CHAIN@FYREDK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1218' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJ3NA           Commodity Marke
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFYJ3NA    #DJ3NA           Commodity Marke
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV Commod Group Desc  RT - OM Commodity Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           FZLRCD           Commodity Price
      * Setup key
     C                     MOVELBZLRCD    FZLRCD           Commodity Price
      * Establish starting position
     C           KRSSJ     CHAIN@FZREDN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1220' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJ4NA           Commodity Price
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFZJ4NA    #DJ4NA           Commodity Price
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADDBZAIC3    IHAIC3           Company Number
     C                     MOVELBZQ8CD    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSK     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DMLNA           Price Method De
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHMLNA    #DMLNA           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVELBZQ1CD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSL     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #DF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           I5AIC3           Company Number
     C                     KFLD           I5R3CD           Department Code
      * Setup key
     C                     Z-ADDBZAIC3    I5AIC3           Company Number
     C                     MOVELBZR3CD    I5R3CD           Department Code
      * Establish starting position
     C           KRSSM     CHAIN@I5REUJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1757' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DMYNA           Department Desc
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELI5MYNA    #DMYNA           Department Desc
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Vendor Name        RT - Vendor  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BJACC8           Vendor item Def
      * Setup key
     C                     Z-ADDBZAJC8    BJACC8           Vendor item Def
      * Establish starting position
     C           KRSSN     CHAIN@BJREGE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBATX           Vendor Name
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBJBATX    #DBATX           Vendor Name
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVELBZADCD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSSO     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM4NA           Description
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DM4NA           Description
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AICD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSSP     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM7NA           Description
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DM7NA           Description
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * Rtv Primal Grp Desc   RT - PS Primal Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           LLXRCD           Primal Group Co
      * Setup key
     C                     MOVELBZXRCD    LLXRCD           Primal Group Co
      * Establish starting position
     C           KRSSQ     CHAIN@LLREOY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2505' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DOJNA           Primal Group De
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELLLOJNA    #DOJNA           Primal Group De
     C                     GOTO SQEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Val Item Exists        RT - OM Item  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WAHGCD           Item Code
      * Setup key
     C                     Z-ADD#1HGCD    WAHGCD           Item Code
      * Establish starting position
     C           KRSSR     CHAIN@BYREZF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1160' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SREXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Commod U/M         RT - OM Commodity Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           FZLRCD           Commodity Price
      * Setup key
     C                     MOVEL#1LRCD    FZLRCD           Commodity Price
      * Establish starting position
     C           KRSSS     CHAIN@FZREDN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1220' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAICD           U/M - Pricing
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFZAICD    WUAICD           U/M - Pricing
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * Rtv Quality Level Desc RT - Quality Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           AIHICD           Quality Level
      * Setup key
     C                     MOVEL#1HICD    AIHICD           Quality Level
      * Establish starting position
     C           KRSST     CHAIN@AIREBL              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0024' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJNNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAIAUNA    #DJNNA           Description
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV Item Level Descr   RT - PD Item Level  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           ILRBCD           Item Level
      * Setup key
     C                     MOVEL#1RBCD    ILRBCD           Item Level
      * Establish starting position
     C           KRSSU     CHAIN@ILRERK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1673' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDPNA           Description
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELILAUNA    #DDPNA           Description
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Item Class Desc    RT - OM Item Structure Class  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           FARINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    FARINB           Item Structure
      * Establish starting position
     C           KRSSV     CHAIN@FAREBE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDETX           Item Structure
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFADETX    #DDETX           Item Structure
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Commod. Mkts Desc  RT - OM Commodity Markets  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           FYLQCD           Commodity Marke
      * Setup key
     C                     MOVEL#1LNCD    FYLQCD           Commodity Marke
      * Establish starting position
     C           KRSSW     CHAIN@FYREDK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1218' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJ3NA           Commodity Marke
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFYJ3NA    #DJ3NA           Commodity Marke
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Commod Group Desc  RT - OM Commodity Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           FZLRCD           Commodity Price
      * Setup key
     C                     MOVEL#1LRCD    FZLRCD           Commodity Price
      * Establish starting position
     C           KRSSX     CHAIN@FZREDN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1220' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DJ4NA           Commodity Price
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELFZJ4NA    #DJ4NA           Commodity Price
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Price Method Desc  RT - PD Price Method Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     Z-ADD#1AIC3    IHAIC3           Company Number
     C                     MOVEL#1Q8CD    IHQ7CD           Price Method Co
      * Establish starting position
     C           KRSSY     CHAIN@IHRERN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1665' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DMLNA           Price Method De
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELIHMLNA    #DMLNA           Price Method De
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1Q1CD    ADAJCD           Warehouse Code
      * Establish starting position
     C           KRSSZ     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DF8NA           Warehouse Descr
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELADF8NA    #DF8NA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Rtv Prod Dept Name    RT - PS Production Department  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           I5AIC3           Company Number
     C                     KFLD           I5R3CD           Department Code
      * Setup key
     C                     Z-ADD#1AIC3    I5AIC3           Company Number
     C                     MOVEL#1R3CD    I5R3CD           Department Code
      * Establish starting position
     C           KRSTA     CHAIN@I5REUJ              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1757' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DMYNA           Department Desc
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELI5MYNA    #DMYNA           Department Desc
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Rtv Vendor Name        RT - Vendor  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           BJACC8           Vendor item Def
      * Setup key
     C                     Z-ADD#1AJC8    BJACC8           Vendor item Def
      * Establish starting position
     C           KRSTB     CHAIN@BJREGE              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0213' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBATX           Vendor Name
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBJBATX    #DBATX           Vendor Name
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTC     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1ADCD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSTC     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM4NA           Description
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DM4NA           Description
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AECD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSTD     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM5NA           Description
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DM5NA           Description
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AFCD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSTE     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM6NA           Description
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DM6NA           Description
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv UOM Description    RT - Unit of Measure  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           AMHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AICD    AMHHCD           U/M - Primary D
      * Establish starting position
     C           KRSTF     CHAIN@AMREB0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0033' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DM7NA           Description
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL*BLANK    W0RTN            *Return code
      * PAR = DB1 By name
     C                     MOVELAMAUNA    #DM7NA           Description
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * RTV Item Group         RT - OM Item Structure Class  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WFRINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    WFRINB           Item Structure
      * Establish starting position
     C           KRSTG     CHAIN@FAREVX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1170' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFRHNB    #1RHNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THRVGN    BEGSR
      *================================================================
      * Rtv Item Type          RT - OM Item Structure Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTH     KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB           Item Structure
      * Establish starting position
     C           KRSTH     CHAIN@E9REA8              90    *
      * Data record not found
     C   90                MOVEL'USR1168' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDE9RGNB    #1RGNB           Item Structure
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Chg Item Structure     RT - IC Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQTI01           Company Number
     C           *LIKE     DEFN B0HGCD    WQTI02           Item Code
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           Company Number
     C                     KFLD           WQTI02           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQTI01           Company Number
     C                     Z-ADD#1HGCD    WQTI02           Item Code
      * Establish starting position
     C           KRSTI     SETLL@B0REJX                    *
     C           KRSTI     READE@B0REJX                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Item Balance       CH - IC Item Balance  * 
     C                     EXSR TJCHRC
     C           KRSTI     READE@B0REJX                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJCHRC    BEGSR
      *================================================================
      * Chg Item Balance       CH - IC Item Balance  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @B0REJT
     C                     MOVELB0AIC3    WHAIC3           Company Number
     C                     MOVELB0HGCD    WHHGCD           Item Code
     C                     MOVELB0AJCD    WHAJCD           Warehouse Code
      *
     C           KLCHTJ    KLIST
     C                     KFLD           WHAIC3           Company Number
     C                     KFLD           WHHGCD           Item Code
     C                     KFLD           WHAJCD           Warehouse Code
     C           KLCHTJ    CHAIN@B0REJT              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TJEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB01    YARDCS
      * Move non-key fields to @B0REJT
     C                     Z-ADDB0AGCS    WHAGCS           Unit Cost Per P
     C                     Z-ADDB0AECS    WHAECS           Last Cost
     C                     Z-ADDB0BACS    WHBACS           Cost per Primar
     C                     Z-ADDB0BBCS    WHBBCS           Cost per Pricin
     C                     Z-ADDB0CBPR    WHCBPR           Revaluation Cos
     C                     Z-ADDB0GUDT    WHGUDT           Revaluation Eff
     C                     MOVELB0XYST    WHXYST           Revaluation Cos
     C                     Z-ADDB0CTPR    WHCTPR           Last Revaluatio
     C                     Z-ADDB0G4DT    WHG4DT           Last Revaluatio
     C                     Z-ADDB0BOWG    WHBOWG           On Hand Weight
     C                     Z-ADDB0DDQT    WHDDQT           On Hand U/M1 Su
     C                     Z-ADDB0DEQT    WHDEQT           On Hand U/M2 Su
     C                     Z-ADDB0DFQT    WHDFQT           On Hand U/M3 Su
     C                     Z-ADDB0HDQT    WHHDQT           Quantity In Chi
     C                     Z-ADDB0HEQT    WHHEQT           Weight In Chill
     C                     Z-ADDB0AJQT    WHAJQT           Quantity Schedu
     C                     Z-ADDB0AQQT    WHAQQT           Quantity on Sal
     C                     Z-ADDB0AUQT    WHAUQT           Quantity on Pur
     C                     Z-ADDB0EMQT    WHEMQT           Quantity on Tra
     C                     Z-ADDB0DOQT    WHDOQT           Quantity Avail.
     C                     MOVELB0ATNA    WHATNA           Cycle Count Cod
     C                     Z-ADDB0AKDT    WHAKDT           Date of Last Or
     C                     Z-ADDB0ANDT    WHANDT           Date of Last Sh
     C                     Z-ADDB0IDVA    WHIDVA           Value of On Han
     C                     MOVELB0JVST    WHJVST           Inventory Plann
     C                     Z-ADDB0BZPC    WHBZPC           Safety Allowanc
     C                     Z-ADDB0DGQT    WHDGQT           Safety Allowanc
     C                     Z-ADDB0DIDT    WHDIDT           Stock Out Date
     C                     MOVELB0ALCD    WHALCD           Buyer Code
     C                     Z-ADDB0BFDY    WHBFDY           Lead Time - Las
     C                     Z-ADDB0DJDT    WHDJDT           Lead Time - Dat
     C                     Z-ADDB0BGDY    WHBGDY           Lead Time - Nex
     C                     Z-ADDB0DKDT    WHDKDT           Lead Time - Dat
     C                     MOVELB0J2ST    WHJ2ST           Lead Time - Exc
     C                     Z-ADDB0DJQT    WHDJQT           Usage Qty per C
     C                     Z-ADDB0BNWG    WHBNWG           Usage Weight pe
     C                     Z-ADDB0DLDT    WHDLDT           Inventory Manag
     C                     Z-ADDB0DPQT    WHDPQT           Minimum Quantit
     C                     Z-ADDB0DQQT    WHDQQT           Maximum Quantit
     C                     Z-ADDB0DMDT    WHDMDT           Last Physical C
     C                     MOVELB0M0ST    WHM0ST           Requisition Mod
     C                     MOVELB0J9ST    WHJ9ST           Cost Update Pen
     C                     MOVELB0KBST    WHKBST           Post G/L Status
     C                     MOVELB0AKC8    WHAKC8           Vendor - Item/W
     C                     Z-ADD#1RINB    WHRINB           Item Structure
     C                     Z-ADD#1RHNB    WHRHNB           Item Structure
     C                     Z-ADD#1RGNB    WHRGNB           Item Structure
     C                     MOVELB0UVST    WHUVST           EDI Status 1
     C                     MOVELB0UWST    WHUWST           EDI Status 2
     C                     MOVELB0UXST    WHUXST           EDI Status 3
     C                     MOVELB0VSST    WHVSST           Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WHAATM' defaulted for 'Job Time'.
      * Field '(DB1) WHAYNA' defaulted for 'User Id'.
      * Field '(DB1) WHA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WHAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WHAATM           Job Time
     C                     MOVEL##USR     WHAYNA           User Id
     C                     MOVEL##JOB     WHA0NA           Job Name
     C                     Z-ADD##JDT     WHAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB01    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@B0REJT                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB0REL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Chg Item Structure     RT - IC Item Balance Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B1AIC3    WQTK01           Company Number
     C           *LIKE     DEFN B1HGCD    WQTK02           Item Code
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WQTK01           Company Number
     C                     KFLD           WQTK02           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQTK01           Company Number
     C                     Z-ADD#1HGCD    WQTK02           Item Code
      * Establish starting position
     C           KRSTK     SETLL@B1REJ0                    *
     C           KRSTK     READE@B1REJ0                  90*
      * Data record not found
     C   90                MOVEL'USR0330' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
     C                     EXSR TLCHRC
     C           KRSTK     READE@B1REJ0                  90*
     C                     ENDDO
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCHRC    BEGSR
      *================================================================
      * Chg Item Bal. Detail   CH - IC Item Balance Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       Label Date
     C                     MOVEL*BLANK    WN0006  1        EDI Status 1
     C                     MOVEL*BLANK    WN0007  1        EDI Status 2
     C                     MOVEL*BLANK    WN0008  1        EDI Status 3
     C                     MOVEL*BLANK    WN0009  1        Record Status
     C                     Z-ADD*ZERO     WN0010  60       Job Time
     C                     MOVEL*BLANK    WN0011 10        User Id
     C                     MOVEL*BLANK    WN0012 10        Job Name
     C                     Z-ADD*ZERO     WN0013  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @B1REJ1
     C                     MOVELB1AIC3    WIAIC3           Company Number
     C                     MOVELB1HGCD    WIHGCD           Item Code
     C                     MOVELB1AJCD    WIAJCD           Warehouse Code
     C                     Z-ADDB1ELDT    WIELDT           Production Date
      *
     C           KLCHTL    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIHGCD           Item Code
     C                     KFLD           WIAJCD           Warehouse Code
     C                     KFLD           WIELDT           Production Date
     C           KLCHTL    CHAIN@B1REJ1              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB11    YBRDCS
      * Move non-key fields to @B1REJ1
     C                     Z-ADDB1ABWG    WIABWG           Physical Count
     C                     Z-ADDB1AGQT    WIAGQT           Physical Count
     C                     Z-ADDB1AHQT    WIAHQT           Physical Count
     C                     Z-ADDB1AIQT    WIAIQT           Physical Count
     C                     MOVELB1CTST    WICTST           Physical Count
     C                     Z-ADDB1ACWG    WIACWG           Quantity on Han
     C                     Z-ADDB1ARQT    WIARQT           Quantity on Han
     C                     Z-ADDB1ASQT    WIASQT           Quantity on Han
     C                     Z-ADDB1ATQT    WIATQT           Quantity on Han
     C                     Z-ADDB1HDQT    WIHDQT           Quantity In Chi
     C                     Z-ADDB1HEQT    WIHEQT           Weight In Chill
     C                     MOVELB1F6ST    WIF6ST           Update Exceptio
     C                     Z-ADDB1BMWG    WIBMWG           Physical Start
     C                     Z-ADDB1DSQT    WIDSQT           Physical Start
     C                     Z-ADDB1DTQT    WIDTQT           Physical Start
     C                     Z-ADDB1DUQT    WIDUQT           Physical Start
     C                     Z-ADDB1DHDT    WIDHDT           Physical Start
     C                     Z-ADDB1AGCS    WIAGCS           Unit Cost Per P
     C                     Z-ADDB1AECS    WIAECS           Last Cost
     C                     Z-ADDB1IDVA    WIIDVA           Value of On Han
     C                     Z-ADD#1RINB    WIRINB           Item Structure
     C                     Z-ADD#1RHNB    WIRHNB           Item Structure
     C                     Z-ADD#1RGNB    WIRGNB           Item Structure
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C                     MOVEL##PGM     WIA0NA           Job Name
      * Set PGM.*Record Data Changed flag
     C           QCAB11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@B1REJ1                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB1REL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Chg Item Structure     RT - IC Transaction Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN B7AIC3    WQTM01           Company Number
     C           *LIKE     DEFN B7HGCD    WQTM02           Item Code
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           Company Number
     C                     KFLD           WQTM02           Item Code
      * Setup key
     C                     Z-ADD#1AIC3    WQTM01           Company Number
     C                     Z-ADD#1HGCD    WQTM02           Item Code
      * Establish starting position
     C           KRSTM     SETLLRB7CPJ3                    *
     C           KRSTM     READERB7CPJ3                  90*
      * Data record not found
     C   90                MOVEL'USR0344' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) B7K7DT' defaulted for 'Label Date'.
      * CHG IC Trans. Detail   CH - IC Transaction Detail  * 
     C                     EXSR TNCHRC
     C           KRSTM     READERB7CPJ3                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * CHG IC Trans. Detail   CH - IC Transaction Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0014  60       Job Time
     C                     MOVEL*BLANK    WN0015 10        User Id
     C                     MOVEL*BLANK    WN0016 10        Job Name
     C                     Z-ADD*ZERO     WN0017  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @B7CPJZ
     C                     MOVELB7AIC3    WJAIC3           Company Number
     C                     MOVELB7HGCD    WJHGCD           Item Code
     C                     MOVELB7AJCD    WJAJCD           Warehouse Code
     C                     MOVELB7W9ST    WJW9ST           Inventory Trans
     C                     MOVELB7BSST    WJBSST           Inventory Trans
     C                     Z-ADDB7B4DT    WJB4DT           Transaction Dat
     C                     Z-ADDB7DXNB    WJDXNB           Sequence Number
      *
     C           KLCHTN    KLIST
     C                     KFLD           WJAIC3           Company Number
     C                     KFLD           WJHGCD           Item Code
     C                     KFLD           WJAJCD           Warehouse Code
     C                     KFLD           WJW9ST           Inventory Trans
     C                     KFLD           WJBSST           Inventory Trans
     C                     KFLD           WJB4DT           Transaction Dat
     C                     KFLD           WJDXNB           Sequence Number
     C           KLCHTN    CHAIN@B7CPJZ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAB71    YCRDCS
      * Move non-key fields to @B7CPJZ
     C                     Z-ADDB7ELDT    WJELDT           Production Date
     C                     MOVELB7HVCD    WJHVCD           U/M - Transacti
     C                     MOVELB7F1ST    WJF1ST           Item Transactio
     C                     MOVELB7AUNA    WJAUNA           Description
     C                     Z-ADDB7A5QT    WJA5QT           Transaction Qua
     C                     Z-ADDB7AHWG    WJAHWG           Transaction Wei
     C                     Z-ADDB7AKCS    WJAKCS           USR Transaction
     C                     MOVELB7CGCD    WJCGCD           U/M - Cost
     C                     Z-ADDB7AYVA    WJAYVA           Extended Amount
     C                     MOVELB7BJNA    WJBJNA           Ticket Number
     C                     Z-ADDB7CKNB    WJCKNB           G/L Document Nu
     C                     MOVELB7BMST    WJBMST           G/L Update Stat
     C                     MOVELB7CQCD    WJCQCD           Reason Code
     C                     MOVELB7DTCD    WJDTCD           Reference Numbe
     C                     MOVELB7MGNA    WJMGNA           Lot ID
     C                     Z-ADDB7TRBN    WJTRBN           Transfer Batch
     C                     Z-ADDB7TRBS    WJTRBS           Transfer Batch
     C                     MOVELB7C4NB    WJC4NB           Order Number
     C                     Z-ADD#1RINB    WJRINB           Item Structure
     C                     Z-ADD#1RHNB    WJRHNB           Item Structure
     C                     Z-ADD#1RGNB    WJRGNB           Item Structure
     C                     MOVELB7M3NA    WJM3NA           Employee Badge
     C                     Z-ADDB7AWTM    WJAWTM           Production Time
     C                     MOVELB7XLCD    WJXLCD           Shift Number
     C                     Z-ADDB7K7DT    WJK7DT           Label Date
     C                     MOVELB7UVST    WJUVST           EDI Status 1
     C                     MOVELB7UWST    WJUWST           EDI Status 2
     C                     MOVELB7UXST    WJUXST           EDI Status 3
     C                     MOVELB7VSST    WJVSST           Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WJAATM           Job Time
     C                     MOVEL##USR     WJAYNA           User Id
     C                     MOVEL##JOB     WJA0NA           Job Name
     C                     Z-ADD##JDT     WJAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAB71    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@B7CPJZ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAB7CPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TOCRRC    BEGSR
      *================================================================
      * CRT Item/Add to AvlGrp CR - Company/Item  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0018  60       Job Time
     C                     MOVEL*BLANK    WN0019 10        User Id
     C                     MOVEL*BLANK    WN0020 10        Job Name
     C                     Z-ADD*ZERO     WN0021  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      *
      * Move all fields to @BZREJV
     C                     MOVEL#1AIC3    BZAIC3           Company Number
     C                     MOVEL#1HGCD    BZHGCD           Item Code
     C                     MOVEL#1AVNA    BZAVNA           Description Lin
     C                     MOVEL#1AWNA    BZAWNA           Description Lin
     C                     MOVEL#1L7NA    BZL7NA           Item Label Line
     C                     MOVEL#1L8NA    BZL8NA           Item Label Line
     C                     MOVEL#1L6NA    BZL6NA           Item Label Line
     C                     MOVEL#1MFNA    BZMFNA           Item Label Line
     C                     MOVEL#1ADCD    BZADCD           U/M - Primary
     C                     Z-ADD#1AWPC    BZAWPC           Conversion Fact
     C                     MOVEL#1LXST    BZLXST           Operation Facto
     C                     MOVEL#1AECD    BZAECD           U/M - Second
     C                     Z-ADD#1AXPC    BZAXPC           Conversion Fact
     C                     MOVEL#1LYST    BZLYST           Operation Facto
     C                     MOVEL#1AFCD    BZAFCD           U/M - Third
     C                     MOVEL#1AICD    BZAICD           U/M - Pricing
     C                     Z-ADD#1AIWG    BZAIWG           Unit Weight
     C                     MOVEL#1HICD    BZHICD           Quality Level
     C                     MOVEL#1RBCD    BZRBCD           Item Level
     C                     MOVEL#1FZST    BZFZST           Production Date
     C                     MOVEL#1AVST    BZAVST           Catch Weight St
     C                     Z-ADD#1CZWG    BZCZWG           Minimum Weight
     C                     Z-ADD#1C0WG    BZC0WG           Maximum Weight
     C                     Z-ADD#1URTN    BZURTN           Number Cases On
     C                     MOVEL#1AJC8    BZAJC8           Vendor - Item D
     C                     Z-ADD#1RINB    BZRINB           Item Structure
     C                     Z-ADD#1RHNB    BZRHNB           Item Structure
     C                     Z-ADD#1RGNB    BZRGNB           Item Structure
     C                     MOVEL#1LNCD    BZLNCD           Default Commod
     C                     Z-ADD#1TFNB    BZTFNB           Transportation
     C                     MOVEL#1N0CD    BZN0CD           Item Type Code
     C                     MOVEL#1X4ST    BZX4ST           Package Type Co
     C                     Z-ADD#1TMVA    BZTMVA           Maximum Audit V
     C                     Z-ADD#1TNVA    BZTNVA           Minimum Audit V
     C                     Z-ADD#1BLPR    BZBLPR           Market Overage
     C                     Z-ADD#1BMPR    BZBMPR           Standard Overag
     C                     MOVEL#1LRCD    BZLRCD           Commodity Price
     C                     MOVEL#1U9ST    BZU9ST           Item Pricing Op
     C                     Z-ADD#1CMCO    BZCMCO           Item Pricing Co
     C                     MOVEL#1Q1CD    BZQ1CD           Default Warehou
     C                     MOVEL#1Q8CD    BZQ8CD           Price Method De
     C                     Z-ADD#1CHTM    BZCHTM           Fresh Chilling
     C                     MOVEL#1QZCD    BZQZCD           Base/Conv/Loss
     C                     MOVEL#1XWST    BZXWST           Variety/Rendere
     C                     MOVEL#1XXST    BZXXST           Case Ready Stat
     C                     MOVEL#1VMST    BZVMST           Credit Item Sta
     C                     Z-ADD#1SWGH    BZSWGH           Std Weight/Head
     C                     Z-ADD#1PPHE    BZPPHE           Pieces Per Head
     C                     MOVEL#1R3CD    BZR3CD           Department Code
     C                     MOVEL#1SDCD    BZSDCD           PD Code UnUsed
     C                     Z-ADD#1ICN1    BZICN1           Item Category N
     C                     MOVEL#1SVCD    BZSVCD           Item Category C
     C                     Z-ADD#1ICN2    BZICN2           Item Category N
     C                     MOVEL#1SWCD    BZSWCD           Item Category C
     C                     Z-ADD#1V2NB    BZV2NB           Item Category N
     C                     MOVEL#1SXCD    BZSXCD           Item Category C
     C                     Z-ADD#1ITCN    BZITCN           Item Category N
     C                     MOVEL#1SYCD    BZSYCD           Item Category C
     C                     Z-ADD#1ITC5    BZITC5           Item Category N
     C                     MOVEL#1SZCD    BZSZCD           Item Category C
     C                     Z-ADD#1ICN6    BZICN6           Item Category N
     C                     MOVEL#1S0CD    BZS0CD           Item Category C
     C                     Z-ADD#1ICN7    BZICN7           Item Category N
     C                     MOVEL#1S1CD    BZS1CD           Item Category C
     C                     Z-ADD#1ICN8    BZICN8           Item Category N
     C                     MOVEL#1S2CD    BZS2CD           Item Category C
     C                     Z-ADD#1ICN9    BZICN9           Item Category N
     C                     MOVEL#1S3CD    BZS3CD           Item Category C
     C                     Z-ADD#1ICN0    BZICN0           Iten Category N
     C                     MOVEL#1S4CD    BZS4CD           Item Category C
     C                     Z-ADD#1SFNB    BZSFNB           UnUsed NBR 5.2
     C                     Z-ADD#1A3WG    BZA3WG           Misc Tare Weigh
     C                     Z-ADD#1SJNB    BZSJNB           Packages (Trays
     C                     MOVEL#1LLCD    BZLLCD           Packaging Code
     C                     MOVEL#1LMCD    BZLMCD           Grade Code
     C                     MOVEL#1P3ST    BZP3ST           Agrimetrics Ran
     C                     Z-ADD#1SKNB    BZSKNB           Agrimetrics gro
     C                     Z-ADD#1SLNB    BZSLNB           Agrimetrics pac
     C                     Z-ADD#1SMNB    BZSMNB           Agrimetrics gra
     C                     MOVEL#1P4ST    BZP4ST           Agritech Captur
     C                     Z-ADD#1CFNB    BZCFNB           PM Pounds per H
     C                     Z-ADD#1CGNB    BZCGNB           PM Line Time Ef
     C                     Z-ADD#1ILNB    BZILNB           PM % 2nds Facto
     C                     Z-ADD#1CHNB    BZCHNB           PM Crew Size
     C                     Z-ADD#1CINB    BZCINB           PM Batch Size
     C                     Z-ADD#1CJNB    BZCJNB           PM Lot Size
     C                     Z-ADD#1CMNB    BZCMNB           PM BOM Spec Dat
     C                     Z-ADD#1CNNB    BZCNNB           PM Seaboard Spe
     C                     Z-ADD#1CRNB    BZCRNB           PM Seaboard Rep
     C                     Z-ADD#1CSNB    BZCSNB           PM Raw Yield
     C                     Z-ADD#1CVNB    BZCVNB           PM Formula Yiel
     C                     Z-ADD#1CWNB    BZCWNB           PM Standard LBS
     C                     Z-ADD#1CXNB    BZCXNB           PM Raw Meat LBS
     C                     Z-ADD#1CZNB    BZCZNB           PM Formula LBS/
     C                     Z-ADD#1C0NB    BZC0NB           PM Finished LBS
     C                     MOVEL#1N1CD    BZN1CD           PM ABC Class
     C                     Z-ADD#1B4NB    BZB4NB           PM R/M Type Cod
     C                     Z-ADD#1B5NB    BZB5NB           PM Line Number
     C                     MOVEL#1X5ST    BZX5ST           Seconds Item
     C                     MOVEL#1X6ST    BZX6ST           Print on Realiz
     C                     MOVEL#1X7ST    BZX7ST           Unit Weight Cha
     C                     MOVEL#1PCCT    BZPCCT           Piece Count Ite
     C                     Z-ADD#1BDNB    BZBDNB           Pieces Per Bag
     C                     Z-ADD#1BJNB    BZBJNB           Bags Per Unit
     C                     MOVEL#1SUST    BZSUST           Export/Domestic
     C                     MOVEL#1SVST    BZSVST           Print On Schedu
     C                     MOVEL#1SYST    BZSYST           Fresh Inv Alloc
     C                     MOVEL#1SZST    BZSZST           Fresh Sched As
     C                     MOVEL#1S1ST    BZS1ST           Frozen Sched As
     C                     MOVEL#1XRCD    BZXRCD           Primal Group Co
     C                     MOVEL#1XTCD    BZXTCD           UPC Code 1
     C                     MOVEL#1XUCD    BZXUCD           UPC Code 2
     C                     Z-ADD#1F5WG    BZF5WG           CI Unused Wgt 1
     C                     Z-ADD#1F6WG    BZF6WG           CI Unused Wgt 2
     C                     Z-ADD#1F7WG    BZF7WG           CI Unused Wgt 3
     C                     Z-ADD#1BLNB    BZBLNB           CI Unused Nbr 1
     C                     Z-ADD#1BNNB    BZBNNB           CI Unused Nbr 2
     C                     MOVEL#1S2ST    BZS2ST           CI Unused Sts 1
     C                     MOVEL#1S4ST    BZS4ST           CI Unused Sts 2
     C                     MOVEL#1S5ST    BZS5ST           CI Unused Sts 3
     C                     MOVEL#1S6ST    BZS6ST           CI Unused Sts 4
     C                     MOVEL#1S8ST    BZS8ST           CI Unused Sts 5
     C                     MOVEL#1S9ST    BZS9ST           CI Unused Sts 6
     C                     MOVEL#1TCST    BZTCST           CI Unused Sts 7
     C                     MOVEL#1TDST    BZTDST           CI Unused Sts 8
     C                     MOVEL#1UVST    BZUVST           EDI Status 1
     C                     MOVEL#1UWST    BZUWST           EDI Status 2
     C                     MOVEL#1UXST    BZUXST           EDI Status 3
     C                     MOVEL#1VSST    BZVSST           Record Status
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     BZAATM           Job Time
     C                     MOVEL##USR     BZAYNA           User Id
     C                     MOVEL##JOB     BZA0NA           Job Name
     C                     Z-ADD##JDT     BZAXDT           Job Date
     C           KLCRTO    KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
      * Check for duplicate primary key
     C           KLCRTO    SETLL@BZREJV                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0327' W0RTN   7
      * Send message 'Company/Item           EX'
     C                     MOVEL'USR0327' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TOEXIT
     C                     ENDIF
      *
     C                     WRITE@BZREJV                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      * USER: Processing after Data update
      * CASE: DB1.Item Type Code is Finished Goods
     C           BZN0CD    IFEQ 'FG'                       *IF
      * Crt Co Item/Avail Grp CR - Company Item/Avail Group  * 
     C                     EXSR TPCRRC
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPCRRC    BEGSR
      *================================================================
      * Crt Co Item/Avail Grp CR - Company Item/Avail Group  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      *
      * Move all fields to @KLREHG
     C                     MOVELBZAIC3    KLAIC3           Company Number
     C                     MOVELBZHGCD    KLHGCD           Item Code
     C                     MOVEL'ALL'     KLV4CD           Availability Gr
     C                     Z-ADD*ZERO     KLIDSQ           Item Display Se
     C                     MOVELBZUVST    KLUVST           EDI Status 1
     C                     MOVELBZUWST    KLUWST           EDI Status 2
     C                     MOVELBZUXST    KLUXST           EDI Status 3
     C                     MOVELBZVSST    KLVSST           Record Status
     C                     Z-ADDBZAATM    KLAATM           Job Time
     C                     MOVELBZAYNA    KLAYNA           User Id
     C                     MOVELBZA0NA    KLA0NA           Job Name
     C                     Z-ADDBZAXDT    KLAXDT           Job Date
      *
      * USER: Processing before Data update
      * SET Record Stamp CRTOB IF
     C                     MOVEL'A'       KLVSST           Record Status
     C                     Z-ADD##JTM     KLAATM           Job Time
     C                     MOVEL##USR     KLAYNA           User Id
     C                     MOVEL##JOB     KLA0NA           Job Name
     C                     Z-ADD##JDT     KLAXDT           Job Date
     C           KLCRTP    KLIST
     C                     KFLD           KLAIC3           Company Number
     C                     KFLD           KLHGCD           Item Code
     C                     KFLD           KLV4CD           Availability Gr
      * Check for duplicate primary key
     C           KLCRTP    SETLL@KLREHG                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR2218' W0RTN   7
      * Send message 'Company Item/Avail Gro EX'
     C                     MOVEL'USR2218' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C                     WRITE@KLREHG                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCHRC    BEGSR
      *================================================================
      * Chg Item/Item Default  CH - Company/Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0022 12        UPC Code 1
     C                     MOVEL*BLANK    WN0023 12        UPC Code 2
     C                     Z-ADD*ZERO     WN0024 112       CI Unused Wgt 1
     C                     Z-ADD*ZERO     WN0025 112       CI Unused Wgt 2
     C                     Z-ADD*ZERO     WN0026 112       CI Unused Wgt 3
     C                     Z-ADD*ZERO     WN0027  70       CI Unused Nbr 1
     C                     Z-ADD*ZERO     WN0028  70       CI Unused Nbr 2
     C                     MOVEL*BLANK    WN0029  1        CI Unused Sts 1
     C                     MOVEL*BLANK    WN0030  1        CI Unused Sts 2
     C                     MOVEL*BLANK    WN0031  1        CI Unused Sts 3
     C                     MOVEL*BLANK    WN0032  1        CI Unused Sts 4
     C                     MOVEL*BLANK    WN0033  2        CI Unused Sts 5
     C                     MOVEL*BLANK    WN0034  2        CI Unused Sts 6
     C                     MOVEL*BLANK    WN0035  3        CI Unused Sts 7
     C                     MOVEL*BLANK    WN0036  3        CI Unused Sts 8
     C                     Z-ADD*ZERO     WN0037  60       Job Time
     C                     MOVEL*BLANK    WN0038 10        User Id
     C                     MOVEL*BLANK    WN0039 10        Job Name
     C                     Z-ADD*ZERO     WN0040  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BZREJV
     C                     MOVEL#1AIC3    BZAIC3           Company Number
     C                     MOVEL#1HGCD    BZHGCD           Item Code
      *
     C           KLCHTQ    KLIST
     C                     KFLD           BZAIC3           Company Number
     C                     KFLD           BZHGCD           Item Code
     C           KLCHTQ    CHAIN@BZREJV              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     GOTO TQEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YDRDCS
      * Move non-key fields to @BZREJV
     C                     MOVEL#1AVNA    BZAVNA           Description Lin
     C                     MOVEL#1AWNA    BZAWNA           Description Lin
     C                     MOVEL#1L7NA    BZL7NA           Item Label Line
     C                     MOVEL#1L8NA    BZL8NA           Item Label Line
     C                     MOVEL#1L6NA    BZL6NA           Item Label Line
     C                     MOVEL#1MFNA    BZMFNA           Item Label Line
     C                     MOVEL#1ADCD    BZADCD           U/M - Primary
     C                     Z-ADD#1AWPC    BZAWPC           Conversion Fact
     C                     MOVEL#1LXST    BZLXST           Operation Facto
     C                     MOVEL#1AECD    BZAECD           U/M - Second
     C                     Z-ADD#1AXPC    BZAXPC           Conversion Fact
     C                     MOVEL#1LYST    BZLYST           Operation Facto
     C                     MOVEL#1AFCD    BZAFCD           U/M - Third
     C                     MOVEL#1AICD    BZAICD           U/M - Pricing
     C                     Z-ADD#1AIWG    BZAIWG           Unit Weight
     C                     MOVEL#1HICD    BZHICD           Quality Level
     C                     MOVEL#1RBCD    BZRBCD           Item Level
     C                     MOVEL#1FZST    BZFZST           Production Date
     C                     MOVEL#1AVST    BZAVST           Catch Weight St
     C                     Z-ADD#1CZWG    BZCZWG           Minimum Weight
     C                     Z-ADD#1C0WG    BZC0WG           Maximum Weight
     C                     Z-ADD#1URTN    BZURTN           Number Cases On
     C                     MOVEL#1AJC8    BZAJC8           Vendor - Item D
     C                     Z-ADD#1RINB    BZRINB           Item Structure
     C                     Z-ADD#1RHNB    BZRHNB           Item Structure
     C                     Z-ADD#1RGNB    BZRGNB           Item Structure
     C                     MOVEL#1LNCD    BZLNCD           Default Commod
     C                     Z-ADD#1TFNB    BZTFNB           Transportation
     C                     MOVEL#1N0CD    BZN0CD           Item Type Code
     C                     MOVEL#1X4ST    BZX4ST           Package Type Co
     C                     Z-ADD#1TMVA    BZTMVA           Maximum Audit V
     C                     Z-ADD#1TNVA    BZTNVA           Minimum Audit V
     C                     Z-ADD#1BLPR    BZBLPR           Market Overage
     C                     Z-ADD#1BMPR    BZBMPR           Standard Overag
     C                     MOVEL#1LRCD    BZLRCD           Commodity Price
     C                     MOVEL#1U9ST    BZU9ST           Item Pricing Op
     C                     Z-ADD#1CMCO    BZCMCO           Item Pricing Co
     C                     MOVEL#1Q1CD    BZQ1CD           Default Warehou
     C                     MOVEL#1Q8CD    BZQ8CD           Price Method De
     C                     Z-ADD#1CHTM    BZCHTM           Fresh Chilling
     C                     MOVEL#1QZCD    BZQZCD           Base/Conv/Loss
     C                     MOVEL#1XWST    BZXWST           Variety/Rendere
     C                     MOVEL#1XXST    BZXXST           Case Ready Stat
     C                     MOVEL#1VMST    BZVMST           Credit Item Sta
     C                     Z-ADD#1SWGH    BZSWGH           Std Weight/Head
     C                     Z-ADD#1PPHE    BZPPHE           Pieces Per Head
     C                     MOVEL#1R3CD    BZR3CD           Department Code
     C                     MOVEL#1SDCD    BZSDCD           PD Code UnUsed
     C                     Z-ADD#1ICN1    BZICN1           Item Category N
     C                     MOVEL#1SVCD    BZSVCD           Item Category C
     C                     Z-ADD#1ICN2    BZICN2           Item Category N
     C                     MOVEL#1SWCD    BZSWCD           Item Category C
     C                     Z-ADD#1V2NB    BZV2NB           Item Category N
     C                     MOVEL#1SXCD    BZSXCD           Item Category C
     C                     Z-ADD#1ITCN    BZITCN           Item Category N
     C                     MOVEL#1SYCD    BZSYCD           Item Category C
     C                     Z-ADD#1ITC5    BZITC5           Item Category N
     C                     MOVEL#1SZCD    BZSZCD           Item Category C
     C                     Z-ADD#1ICN6    BZICN6           Item Category N
     C                     MOVEL#1S0CD    BZS0CD           Item Category C
     C                     Z-ADD#1ICN7    BZICN7           Item Category N
     C                     MOVEL#1S1CD    BZS1CD           Item Category C
     C                     Z-ADD#1ICN8    BZICN8           Item Category N
     C                     MOVEL#1S2CD    BZS2CD           Item Category C
     C                     Z-ADD#1ICN9    BZICN9           Item Category N
     C                     MOVEL#1S3CD    BZS3CD           Item Category C
     C                     Z-ADD#1ICN0    BZICN0           Iten Category N
     C                     MOVEL#1S4CD    BZS4CD           Item Category C
     C                     Z-ADD#1SFNB    BZSFNB           UnUsed NBR 5.2
     C                     Z-ADD#1A3WG    BZA3WG           Misc Tare Weigh
     C                     Z-ADD#1SJNB    BZSJNB           Packages (Trays
     C                     MOVEL#1LLCD    BZLLCD           Packaging Code
     C                     MOVEL#1LMCD    BZLMCD           Grade Code
     C                     MOVEL#1P3ST    BZP3ST           Agrimetrics Ran
     C                     Z-ADD#1SKNB    BZSKNB           Agrimetrics gro
     C                     Z-ADD#1SLNB    BZSLNB           Agrimetrics pac
     C                     Z-ADD#1SMNB    BZSMNB           Agrimetrics gra
     C                     MOVEL#1P4ST    BZP4ST           Agritech Captur
     C                     Z-ADD#1CFNB    BZCFNB           PM Pounds per H
     C                     Z-ADD#1CGNB    BZCGNB           PM Line Time Ef
     C                     Z-ADD#1ILNB    BZILNB           PM % 2nds Facto
     C                     Z-ADD#1CHNB    BZCHNB           PM Crew Size
     C                     Z-ADD#1CINB    BZCINB           PM Batch Size
     C                     Z-ADD#1CJNB    BZCJNB           PM Lot Size
     C                     Z-ADD#1CMNB    BZCMNB           PM BOM Spec Dat
     C                     Z-ADD#1CNNB    BZCNNB           PM Seaboard Spe
     C                     Z-ADD#1CRNB    BZCRNB           PM Seaboard Rep
     C                     Z-ADD#1CSNB    BZCSNB           PM Raw Yield
     C                     Z-ADD#1CVNB    BZCVNB           PM Formula Yiel
     C                     Z-ADD#1CWNB    BZCWNB           PM Standard LBS
     C                     Z-ADD#1CXNB    BZCXNB           PM Raw Meat LBS
     C                     Z-ADD#1CZNB    BZCZNB           PM Formula LBS/
     C                     Z-ADD#1C0NB    BZC0NB           PM Finished LBS
     C                     MOVEL#1N1CD    BZN1CD           PM ABC Class
     C                     Z-ADD#1B4NB    BZB4NB           PM R/M Type Cod
     C                     Z-ADD#1B5NB    BZB5NB           PM Line Number
     C                     MOVEL#1X5ST    BZX5ST           Seconds Item
     C                     MOVEL#1X6ST    BZX6ST           Print on Realiz
     C                     MOVEL#1X7ST    BZX7ST           Unit Weight Cha
     C                     MOVEL#1PCCT    BZPCCT           Piece Count Ite
     C                     Z-ADD#1BDNB    BZBDNB           Pieces Per Bag
     C                     Z-ADD#1BJNB    BZBJNB           Bags Per Unit
     C                     MOVEL#1SUST    BZSUST           Export/Domestic
     C                     MOVEL#1SVST    BZSVST           Print On Schedu
     C                     MOVEL#1SYST    BZSYST           Fresh Inv Alloc
     C                     MOVEL#1SZST    BZSZST           Fresh Sched As
     C                     MOVEL#1S1ST    BZS1ST           Frozen Sched As
     C                     MOVEL#1XRCD    BZXRCD           Primal Group Co
     C                     MOVEL#1UVST    BZUVST           EDI Status 1
     C                     MOVEL#1UWST    BZUWST           EDI Status 2
     C                     MOVEL#1UXST    BZUXST           EDI Status 3
     C                     MOVEL#1VSST    BZVSST           Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     BZAATM           Job Time
     C                     MOVEL##USR     BZAYNA           User Id
     C                     MOVEL##JOB     BZA0NA           Job Name
     C                     Z-ADD##JDT     BZAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BZREJV                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCABZREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
      * USER: Processing after Data update
      * Chg Item Default w/Co  CH - OM Item  * 
     C                     EXSR TRCHRC
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRCHRC    BEGSR
      *================================================================
      * Chg Item Default w/Co  CH - OM Item  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0041 30        Description Lin
     C                     MOVEL*BLANK    WN0042 30        Description Lin
     C                     MOVEL*BLANK    WN0043  2        U/M - Primary D
     C                     Z-ADD*ZERO     WN0044  94       Conversion Fact
     C                     MOVEL*BLANK    WN0045  1        Operation Facto
     C                     MOVEL*BLANK    WN0046  2        U/M - Second Df
     C                     Z-ADD*ZERO     WN0047  94       Conversion Fact
     C                     MOVEL*BLANK    WN0048  1        Operation Facto
     C                     MOVEL*BLANK    WN0049  2        U/M - Third Dft
     C                     MOVEL*BLANK    WN0050  2        U/M - Pricing D
     C                     Z-ADD*ZERO     WN0051 112       Unit Weight
     C                     MOVEL*BLANK    WN0052  1        Catch Weight St
     C                     Z-ADD*ZERO     WN0053  30       Item Structure
     C                     Z-ADD*ZERO     WN0054  30       Item Structure
     C                     Z-ADD*ZERO     WN0055  30       Item Structure
     C                     MOVEL*BLANK    WN0056  3        Item Type Code
     C                     MOVEL*BLANK    WN0057  1        Package Type Co
     C                     MOVEL*BLANK    WN0058  2        Base/Conv/Loss
     C                     MOVEL*BLANK    WN0059  1        Variety/Rendere
     C                     MOVEL*BLANK    WN0060  1        Case Ready Stat
     C                     MOVEL*BLANK    WN0061  1        Credit Item Sta
     C                     MOVEL*BLANK    WN0062  1        Seconds Item
     C                     Z-ADD*ZERO     WN0063  60       Job Time
     C                     MOVEL*BLANK    WN0064 10        User Id
     C                     MOVEL*BLANK    WN0065 10        Job Name
     C                     Z-ADD*ZERO     WN0066  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @BYREA0
     C                     MOVELBZHGCD    WKHGCD           Item Code
      *
     C           KLCHTR    KLIST
     C                     KFLD           WKHGCD           Item Code
     C           KLCHTR    CHAIN@BYREA0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TREXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMBY1    YERDCS
      * Move non-key fields to @BYREA0
     C                     MOVELBZL7NA    WKL7NA           Item Label Line
     C                     MOVELBZL8NA    WKL8NA           Item Label Line
     C                     MOVELBZL6NA    WKL6NA           Item Label Line
     C                     MOVELBZMFNA    WKMFNA           Item Label Line
     C                     MOVELBZHICD    WKHICD           Quality Level
     C                     MOVELBZRBCD    WKRBCD           Item Level
     C                     MOVELBZFZST    WKFZST           Production Date
     C                     Z-ADDBZCZWG    WKCZWG           Minimum Weight
     C                     Z-ADDBZC0WG    WKC0WG           Maximum Weight
     C                     Z-ADDBZURTN    WKURTN           Number Cases On
     C                     MOVELBZAJC8    WKACC8           Vendor item Def
     C                     MOVELBZLNCD    WKLNCD           Default Commod
     C                     Z-ADDBZTFNB    WKTFNB           Transportation
     C                     Z-ADDBZCHTM    WKCHTM           Fresh Chilling
     C                     Z-ADDBZSWGH    WKSWGH           Std Weight/Head
     C                     Z-ADDBZPPHE    WKPPHE           Pieces Per Head
     C                     MOVELBZLRCD    WKLRCD           Commodity Price
     C                     Z-ADDBZSFNB    WKSFNB           UnUsed NBR 5.2
     C                     Z-ADDBZA3WG    WKA3WG           Misc Tare Weigh
     C                     Z-ADDBZSJNB    WKSJNB           Packages (Trays
     C                     MOVELBZLLCD    WKLLCD           Packaging Code
     C                     MOVELBZLMCD    WKLMCD           Grade Code
     C                     MOVELBZP3ST    WKP3ST           Agrimetrics Ran
     C                     Z-ADDBZSKNB    WKSKNB           Agrimetrics gro
     C                     Z-ADDBZSLNB    WKSLNB           Agrimetrics pac
     C                     Z-ADDBZSMNB    WKSMNB           Agrimetrics gra
     C                     MOVELBZP4ST    WKP4ST           Agritech Captur
     C                     Z-ADDBZCFNB    WKCFNB           PM Pounds per H
     C                     Z-ADDBZCGNB    WKCGNB           PM Line Time Ef
     C                     Z-ADDBZILNB    WKILNB           PM % 2nds Facto
     C                     Z-ADDBZCHNB    WKCHNB           PM Crew Size
     C                     Z-ADDBZCINB    WKCINB           PM Batch Size
     C                     Z-ADDBZCJNB    WKCJNB           PM Lot Size
     C                     Z-ADDBZCMNB    WKCMNB           PM BOM Spec Dat
     C                     Z-ADDBZCNNB    WKCNNB           PM Seaboard Spe
     C                     Z-ADDBZCRNB    WKCRNB           PM Seaboard Rep
     C                     Z-ADDBZCSNB    WKCSNB           PM Raw Yield
     C                     Z-ADDBZCVNB    WKCVNB           PM Formula Yiel
     C                     Z-ADDBZCWNB    WKCWNB           PM Standard LBS
     C                     Z-ADDBZCXNB    WKCXNB           PM Raw Meat LBS
     C                     Z-ADDBZCZNB    WKCZNB           PM Formula LBS/
     C                     Z-ADDBZC0NB    WKC0NB           PM Finished LBS
     C                     MOVELBZN1CD    WKN1CD           PM ABC Class
     C                     Z-ADDBZB4NB    WKB4NB           PM R/M Type Cod
     C                     MOVELBZX6ST    WKX6ST           Print on Realiz
     C                     MOVELBZX7ST    WKX7ST           Unit Weight Cha
     C                     MOVELBZUVST    WKUVST           EDI Status 1
     C                     MOVELBZUWST    WKUWST           EDI Status 2
     C                     MOVELBZUXST    WKUXST           EDI Status 3
     C                     MOVELBZVSST    WKVSST           Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QOMBY1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WKAHTM           Job Time
     C                     MOVEL##USR     WKBEVN           User Id
     C                     MOVEL##JOB     WKBFVN           Job Name
     C                     Z-ADD##JDT     WKEKDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMBY1    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@BYREA0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMBYREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTS01           Application Cod
      * Define keylist
     C           KRSTS     KLIST
     C                     KFLD           WQTS01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQTS01           Application Cod
     C                     MOVEL'C/S'     WQTS01           Application Cod
      * Establish starting position
     C           KRSTS     SETLL@DNRESF                    *
     C           KRSTS     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR TTRVGN
     C                     END                             *FI
     C           KRSTS     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQTT01           Application Cod
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WQTT01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQTT01           Application Cod
      * Establish starting position
     C           KRSTT     SETLL@DNRESF                    *
     C           KRSTT     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TTEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSTT     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1HGCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Item Code
     C           YPMTFD    OREQ '#1HGCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
      * Field '(KEY) #1HGCD' defaulted for 'Item Code'.
     C                     CALL 'PDJISRR'              90  SEL Company/Ite
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0001  30       Company Number
     C           #1HGCD    PARM #1HGCD    WQ0002  70       Item Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDJISRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1HGCD    IFNE *ZERO                      Item Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Company Name and Address
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1AIC3' defaulted for 'Company Number'.
     C                     CALL 'CAAJSRR'              90  SEL Company by
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0003  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAAJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AIC3    IFEQ *ZERO                      Company Number
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAB    KLIST
     C                     KFLD           ABAIC3           Company Number
      * Setup key
     C                     MOVEL#1AIC3    ABAIC3
     C           KLVBAB    CHAIN@ABREAK              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Company Name and Addre NF'
     C                     MOVEL'USR0003' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0003' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ADCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1ADCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ADCD' defaulted for 'U/M - Primary'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1ADCD    PARM #1ADCD    WQ0005  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ADCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ADCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCWB    KLIST
     C                     KFLD           WBHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1ADCD    WBHHCD
     C           KLVCWB    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AECD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AECD' defaulted for 'U/M - Second'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AECD    PARM #1AECD    WQ0006  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AECD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDWB    KLIST
     C                     KFLD           WBHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AECD    WBHHCD
     C           KLVDWB    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AFCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AFCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AFCD' defaulted for 'U/M - Third'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AFCD    PARM #1AFCD    WQ0007  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AFCD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AFCD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEWB    KLIST
     C                     KFLD           WBHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AFCD    WBHHCD
     C           KLVEWB    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         VFCKRL    BEGSR
      *================================================================
      * Check reference to Unit of Measure
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1AICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        U/M - Primary D
     C           YPMTFD    OREQ '#1AICD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AICD' defaulted for 'U/M - Pricing'.
     C                     CALL 'CAB5SRR'              90  SEL Unit of Mea
     C                     PARM *BLANK    W0RTN   7
     C           #1AICD    PARM #1AICD    WQ0008  2        U/M - Primary D
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAB5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AICD    IFNE *BLANK                     U/M - Primary D
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VFEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AICD    IFEQ *BLANK                     U/M - Primary D
     C                     GOTO VFEXIT
     C                     END
      *
     C           KLVFWB    KLIST
     C                     KFLD           WBHHCD           U/M - Primary D
      * Setup key
     C                     MOVEL#1AICD    WBHHCD
     C           KLVFWB    CHAIN@AMREU9              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VFEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VFEXIT
     C                     END
      * Send message 'Unit of Measure        NF'
     C                     MOVEL'USR0033' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0033' W0RTN
      *================================================================
     CSR         VFEXIT    ENDSR
      /EJECT
     CSR         VGCKRL    BEGSR
      *================================================================
      * Check reference to Quality Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1HICD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Quality Level
     C           YPMTFD    OREQ '#1HICD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1HICD' defaulted for 'Quality Level'.
     C                     CALL 'CABOSRR'              90  SEL Quality Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1HICD    PARM #1HICD    WQ0009  2        Quality Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CABOSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1HICD    IFNE *BLANK                     Quality Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VGEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HICD    IFEQ *BLANK                     Quality Level
     C                     GOTO VGEXIT
     C                     END
      *
     C           KLVGWC    KLIST
     C                     KFLD           WCHICD           Quality Level
      * Setup key
     C                     MOVEL#1HICD    WCHICD
     C           KLVGWC    CHAIN@AIREVD              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VGEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VGEXIT
     C                     END
      * Send message 'Quality Level          NF'
     C                     MOVEL'USR0024' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0024' W0RTN
      *================================================================
     CSR         VGEXIT    ENDSR
      /EJECT
     CSR         VHCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Level
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1RBCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Item Level
     C           YPMTFD    OREQ '#1RBCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RBCD' defaulted for 'Item Level'.
     C                     CALL 'PDBPSRR'              90  SEL PD Item Lev
     C                     PARM *BLANK    W0RTN   7
     C           #1RBCD    PARM #1RBCD    WQ0010  2        Item Level
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RBCD    IFNE *BLANK                     Item Level
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VHEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RBCD    IFEQ *BLANK                     Item Level
     C                     GOTO VHEXIT
     C                     END
      *
     C           KLVHWD    KLIST
     C                     KFLD           WDRBCD           Item Level
      * Setup key
     C                     MOVEL#1RBCD    WDRBCD
     C           KLVHWD    CHAIN@ILREVH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VHEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VHEXIT
     C                     END
      * Send message 'PD Item Level          NF'
     C                     MOVEL'USR1673' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1673' W0RTN
      *================================================================
     CSR         VHEXIT    ENDSR
      /EJECT
     CSR         VICKRL    BEGSR
      *================================================================
      * Check reference to Vendor
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1AJC8'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AJC8' defaulted for 'Vendor - Item Default'.
     C                     CALL 'PDE2SRR'              90  SEL Vendor Acti
     C                     PARM *BLANK    W0RTN   7
     C           #1AJC8    PARM #1AJC8    WQ0011  80       Vendor item Def
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDE2SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AJC8    IFNE *ZERO                      Vendor item Def
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VIEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1AJC8    IFEQ *ZERO                      Vendor item Def
     C                     GOTO VIEXIT
     C                     END
      *
     C           KLVIWE    KLIST
     C                     KFLD           WEACC8           Vendor item Def
      * Setup key
     C                     MOVEL#1AJC8    WEACC8
     C           KLVIWE    CHAIN@BJREU2              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VIEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VIEXIT
     C                     END
      * Send message 'Vendor                 NF'
     C                     MOVEL'USR0213' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0213' W0RTN
      *================================================================
     CSR         VIEXIT    ENDSR
      /EJECT
     CSR         VJCKRL    BEGSR
      *================================================================
      * Check reference to OM Item Structure Class
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RINB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RINB' defaulted for 'Item Structure Class Code'.
     C                     CALL 'PDELSRR'              90  SEL Item Class
     C                     PARM *BLANK    W0RTN   7
     C           #1RINB    PARM #1RINB    WQ0012  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RINB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VJEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RINB    IFEQ *ZERO                      Item Structure
     C                     GOTO VJEXIT
     C                     END
      *
     C           KLVJWF    KLIST
     C                     KFLD           WFRINB           Item Structure
      * Setup key
     C                     Z-ADD#1RINB    WFRINB
     C           KLVJWF    CHAIN@FAREVX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VJEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VJEXIT
     C                     END
      * Send message 'OM Item Structure Clas NF'
     C                     MOVEL'USR1170' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1170' W0RTN
      *================================================================
     CSR         VJEXIT    ENDSR
      /EJECT
     CSR         VKCKRL    BEGSR
      *================================================================
      * Check reference to OM Item Structure Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RHNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RHNB' defaulted for 'Item Structure Group Code'.
     C                     CALL 'PDEMSRR'              90  SEL Item Group
     C                     PARM *BLANK    W0RTN   7
     C           #1RHNB    PARM #1RHNB    WQ0013  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDEMSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RHNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VKEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RHNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VKEXIT
     C                     END
      *
     C           KLVKE9    KLIST
     C                     KFLD           E9RHNB           Item Structure
      * Setup key
     C                     Z-ADD#1RHNB    E9RHNB
     C           KLVKE9    CHAIN@E9REA8              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VKEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VKEXIT
     C                     END
      * Send message 'OM Item Structure Grou NF'
     C                     MOVEL'USR1168' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1168' W0RTN
      *================================================================
     CSR         VKEXIT    ENDSR
      /EJECT
     CSR         VLCKRL    BEGSR
      *================================================================
      * Check reference to OM Item Structure Type
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1RGNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1RGNB' defaulted for 'Item Structure Type Code'.
     C                     CALL 'PDENSRR'              90  SEL Item Type A
     C                     PARM *BLANK    W0RTN   7
     C           #1RGNB    PARM #1RGNB    WQ0014  30       Item Structure
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDENSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1RGNB    IFNE *ZERO                      Item Structure
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VLEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1RGNB    IFEQ *ZERO                      Item Structure
     C                     GOTO VLEXIT
     C                     END
      *
     C           KLVLE8    KLIST
     C                     KFLD           E8RGNB           Item Structure
      * Setup key
     C                     Z-ADD#1RGNB    E8RGNB
     C           KLVLE8    CHAIN@E8REBB              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VLEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VLEXIT
     C                     END
      * Send message 'OM Item Structure Type NF'
     C                     MOVEL'USR1166' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1166' W0RTN
      *================================================================
     CSR         VLEXIT    ENDSR
      /EJECT
     CSR         VMCKRL    BEGSR
      *================================================================
      * Check reference to OM Commodity Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1LRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Commodity Price
     C           YPMTFD    OREQ '#1LRCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1LRCD' defaulted for 'Commodity Price Group'.
     C                     CALL 'PDECSRR'              90  SEL Commod Grp
     C                     PARM *BLANK    W0RTN   7
     C           #1LRCD    PARM #1LRCD    WQ0015  7        Commodity Price
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDECSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,33           *
     C                     END
      *
     C           #1LRCD    IFNE *BLANK                     Commodity Price
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VMEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1LRCD    IFEQ *BLANK                     Commodity Price
     C                     GOTO VMEXIT
     C                     END
      *
     C           KLVMWG    KLIST
     C                     KFLD           WGLRCD           Commodity Price
      * Setup key
     C                     MOVEL#1LRCD    WGLRCD
     C           KLVMWG    CHAIN@FZREVP              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VMEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VMEXIT
     C                     END
      * Send message 'OM Commodity Group     NF'
     C                     MOVEL'USR1220' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1220' W0RTN
      *================================================================
     CSR         VMEXIT    ENDSR
      /EJECT
     CSR         VNCKRL    BEGSR
      *================================================================
      * Check reference to Warehouse
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1Q1CD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Warehouse Code
     C           YPMTFD    OREQ '#1Q1CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1Q1CD' defaulted for 'Default Warehouse'.
     C                     CALL 'CAANSRR'              90  SEL Warehouse
     C                     PARM *BLANK    W0RTN   7
     C           #1Q1CD    PARM #1Q1CD    WQ0016  3        Warehouse Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'CAANSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1Q1CD    IFNE *BLANK                     Warehouse Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VNEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q1CD    IFEQ *BLANK                     Warehouse Code
     C                     GOTO VNEXIT
     C                     END
      *
     C           KLVNAD    KLIST
     C                     KFLD           ADAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#1Q1CD    ADAJCD
     C           KLVNAD    CHAIN@ADRET1              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VNEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VNEXIT
     C                     END
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR0007' W0RTN
      *================================================================
     CSR         VNEXIT    ENDSR
      /EJECT
     CSR         VOCKRL    BEGSR
      *================================================================
      * Check reference to PD Price Method Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1Q8CD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Price Method Co
     C           YPMTFD    OREQ '#1Q8CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1Q8CD' defaulted for 'Price Method Default'.
     C                     CALL 'PDZDSRR'              90  SEL PD Price Me
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0017  30       Company Number
     C           #1Q8CD    PARM #1Q8CD    WQ0018  3        Price Method Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDZDSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     MOVEL'1'       @I1,34           *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1Q8CD    IFNE *BLANK                     Price Method Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VOEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1Q8CD    IFEQ *BLANK                     Price Method Co
     C                     GOTO VOEXIT
     C                     END
      *
     C           KLVOIH    KLIST
     C                     KFLD           IHAIC3           Company Number
     C                     KFLD           IHQ7CD           Price Method Co
      * Setup key
     C                     MOVEL#1AIC3    IHAIC3
     C                     MOVEL#1Q8CD    IHQ7CD
     C           KLVOIH    CHAIN@IHRERN              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VOEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VOEXIT
     C                     END
      * Send message 'PD Price Method Header NF'
     C                     MOVEL'USR1665' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1665' W0RTN
      *================================================================
     CSR         VOEXIT    ENDSR
      /EJECT
     CSR         VPCKRL    BEGSR
      *================================================================
      * Check reference to PS Production Department
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1R3CD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Department Code
     C           YPMTFD    OREQ '#1R3CD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1R3CD' defaulted for 'Department Code'.
     C                     CALL 'PDCXSRR'              90  Sel Prod. Depar
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0019  30       Company Number
     C           #1R3CD    PARM #1R3CD    WQ0020  6        Department Code
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDCXSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1R3CD    IFNE *BLANK                     Department Code
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VPEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1R3CD    IFEQ *BLANK                     Department Code
     C                     GOTO VPEXIT
     C                     END
      *
     C           KLVPI5    KLIST
     C                     KFLD           I5AIC3           Company Number
     C                     KFLD           I5R3CD           Department Code
      * Setup key
     C                     MOVEL#1AIC3    I5AIC3
     C                     MOVEL#1R3CD    I5R3CD
     C           KLVPI5    CHAIN@I5REUJ              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VPEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VPEXIT
     C                     END
      * Send message 'PS Production Departme NF'
     C                     MOVEL'USR1757' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1757' W0RTN
      *================================================================
     CSR         VPEXIT    ENDSR
      /EJECT
     CSR         VQCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category Unused
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVEL#1SDCD    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        PD Code UnUsed
     C           YPMTFD    OREQ '#1SDCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1SDCD' defaulted for 'PD Code UnUsed'.
     C                     CALL 'PDHPSRR'              90  Sel Item Avl Di
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0021  30       Company Number
     C           #1SDCD    PARM #1SDCD    WQ0022  1        PD Code UnUsed
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHPSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1SDCD    IFNE *BLANK                     PD Code UnUsed
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VQEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1SDCD    IFEQ *BLANK                     PD Code UnUsed
     C                     GOTO VQEXIT
     C                     END
      *
     C           KLVQJG    KLIST
     C                     KFLD           JGAIC3           Company Number
     C                     KFLD           JGSDCD           PD Code UnUsed
      * Setup key
     C                     MOVEL#1AIC3    JGAIC3
     C                     MOVEL#1SDCD    JGSDCD
     C           KLVQJG    CHAIN@JGREXH              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VQEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VQEXIT
     C                     END
      * Send message 'PD Item Category Unuse NF'
     C                     MOVEL'USR1830' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1830' W0RTN
      *================================================================
     CSR         VQEXIT    ENDSR
      /EJECT
     CSR         VRCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN1    IFEQ *ZERO                      Item Category N
     C           #1SVCD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VREXIT
     C                     END
      *
     C           KLVRJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN1    JIUSNB
     C                     MOVEL#1SVCD    JISLCD
     C           KLVRJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VREXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VREXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VREXIT    ENDSR
      /EJECT
     CSR         VSCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN2    IFEQ *ZERO                      Item Category N
     C           #1SWCD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VSEXIT
     C                     END
      *
     C           KLVSJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN2    JIUSNB
     C                     MOVEL#1SWCD    JISLCD
     C           KLVSJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VSEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VSEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VSEXIT    ENDSR
      /EJECT
     CSR         VTCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1V2NB    IFEQ *ZERO                      Item Category N
     C           #1SXCD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VTEXIT
     C                     END
      *
     C           KLVTJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1V2NB    JIUSNB
     C                     MOVEL#1SXCD    JISLCD
     C           KLVTJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VTEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VTEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VTEXIT    ENDSR
      /EJECT
     CSR         VUCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ITCN    IFEQ *ZERO                      Item Category N
     C           #1SYCD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VUEXIT
     C                     END
      *
     C           KLVUJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ITCN    JIUSNB
     C                     MOVEL#1SYCD    JISLCD
     C           KLVUJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VUEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VUEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VUEXIT    ENDSR
      /EJECT
     CSR         VVCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ITC5    IFEQ *ZERO                      Item Category N
     C           #1SZCD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VVEXIT
     C                     END
      *
     C           KLVVJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ITC5    JIUSNB
     C                     MOVEL#1SZCD    JISLCD
     C           KLVVJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VVEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VVEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VVEXIT    ENDSR
      /EJECT
     CSR         VWCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN6    IFEQ *ZERO                      Item Category N
     C           #1S0CD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VWEXIT
     C                     END
      *
     C           KLVWJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN6    JIUSNB
     C                     MOVEL#1S0CD    JISLCD
     C           KLVWJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VWEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VWEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VWEXIT    ENDSR
      /EJECT
     CSR         VXCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN7    IFEQ *ZERO                      Item Category N
     C           #1S1CD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VXEXIT
     C                     END
      *
     C           KLVXJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN7    JIUSNB
     C                     MOVEL#1S1CD    JISLCD
     C           KLVXJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VXEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VXEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VXEXIT    ENDSR
      /EJECT
     CSR         VYCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN8    IFEQ *ZERO                      Item Category N
     C           #1S2CD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VYEXIT
     C                     END
      *
     C           KLVYJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN8    JIUSNB
     C                     MOVEL#1S2CD    JISLCD
     C           KLVYJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VYEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VYEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VYEXIT    ENDSR
      /EJECT
     CSR         VZCKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN9    IFEQ *ZERO                      Item Category N
     C           #1S3CD    ANDEQ*BLANK                     Item Category C
     C                     GOTO VZEXIT
     C                     END
      *
     C           KLVZJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN9    JIUSNB
     C                     MOVEL#1S3CD    JISLCD
     C           KLVZJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VZEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VZEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         VZEXIT    ENDSR
      /EJECT
     CSR         WACKRL    BEGSR
      *================================================================
      * Check reference to PD Item Category
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1ICN0    IFEQ *ZERO                      Item Category N
     C           #1S4CD    ANDEQ*BLANK                     Item Category C
     C                     GOTO WAEXIT
     C                     END
      *
     C           KLWAJI    KLIST
     C                     KFLD           JIAIC3           Company Number
     C                     KFLD           JIUSNB           Item Category N
     C                     KFLD           JISLCD           Item Category C
      * Setup key
     C                     MOVEL#1AIC3    JIAIC3
     C                     Z-ADD#1ICN0    JIUSNB
     C                     MOVEL#1S4CD    JISLCD
     C           KLWAJI    CHAIN@JIREXX              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WAEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WAEXIT
     C                     END
      * Send message 'PD Item Category       NF'
     C                     MOVEL'USR1854' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1854' W0RTN
      *================================================================
     CSR         WAEXIT    ENDSR
      /EJECT
     CSR         WBCKRL    BEGSR
      *================================================================
      * Check reference to PM R/M Type Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B4NB    IFEQ *ZERO                      PM R/M Type Cod
     C                     GOTO WBEXIT
     C                     END
      *
     C           KLWBG1    KLIST
     C                     KFLD           G1B4NB           PM R/M Type Cod
      * Setup key
     C                     Z-ADD#1B4NB    G1B4NB
     C           KLWBG1    CHAIN@G1REI0              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WBEXIT
     C                     END
      * Send message 'PM R/M Type Master     NF'
     C                     MOVEL'USR1454' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1454' W0RTN
      *================================================================
     CSR         WBEXIT    ENDSR
      /EJECT
     CSR         WCCKRL    BEGSR
      *================================================================
      * Check reference to PM Line Master
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * If all low order keys not entered, exit
     C           #1B5NB    IFEQ *ZERO                      PM Line Number
     C                     GOTO WCEXIT
     C                     END
      *
     C           KLWCG2    KLIST
     C                     KFLD           G2AIC3           Company Number
     C                     KFLD           G2B5NB           PM Line Number
      * Setup key
     C                     MOVEL#1AIC3    G2AIC3
     C                     Z-ADD#1B5NB    G2B5NB
     C           KLWCG2    CHAIN@G2REIR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WCEXIT
     C                     END
      * Send message 'PM Line Master         NF'
     C                     MOVEL'USR1456' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR1456' W0RTN
      *================================================================
     CSR         WCEXIT    ENDSR
      /EJECT
     CSR         WDCKRL    BEGSR
      *================================================================
      * Check reference to PS Primal Group
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1XRCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        Primal Group Co
     C           YPMTFD    OREQ '#1XRCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1XRCD' defaulted for 'Primal Group Code'.
     C                     CALL 'PDAFSRR'              90  Sel PS Primal G
     C                     PARM *BLANK    W0RTN   7
     C           #1XRCD    PARM #1XRCD    WQ0023  6        Primal Group Co
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDAFSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      *
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1XRCD    IFNE *BLANK                     Primal Group Co
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO WDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1XRCD    IFEQ *BLANK                     Primal Group Co
     C                     GOTO WDEXIT
     C                     END
      *
     C           KLWDLL    KLIST
     C                     KFLD           LLXRCD           Primal Group Co
      * Setup key
     C                     MOVEL#1XRCD    LLXRCD
     C           KLWDLL    CHAIN@LLREOY              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO WDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO WDEXIT
     C                     END
      * Send message 'PS Primal Group        NF'
     C                     MOVEL'USR2505' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'USR2505' W0RTN
      *================================================================
     CSR         WDEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y2SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y2EXIT    ENDSR
      /EJECT
     CSR         Y3SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y3EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     END
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW1END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW1BEG,F
     C                     MOVELW1NAM,F   W0CFL
     C                     END
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL2'
      * DETAIL 2 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW2END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW2BEG,F
     C                     MOVELW2NAM,F   W0CFL
     C                     END
     C                     END
     C           @#DFMT    IFEQ '#RCDDTL3'
      * DETAIL 3 Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW3END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW3BEG,F
     C                     MOVELW3NAM,F   W0CFL
     C                     END
     C                     END
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA132        Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1AIC3'  YPMTFD           Company Number
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1HGCD'  YPMTFD           Item Code
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDEQ029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1FZST'  YPMTFD           Production Date
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDGE029
     C           ZHCSCL    ANDLE035
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1LRCD'  YPMTFD           Commodity Price
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDGE029
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1Q8CD'  YPMTFD           Price Method De
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ029
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C                     MOVEL'#1U9ST'  YPMTFD           Item Pricing Op
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1HICD'  YPMTFD           Quality Level
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE033
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1RBCD'  YPMTFD           Item Level
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#DSTAT'  YPMTFD           USR Prt on Real
     C                     END
      *
     C           ZHCSRW    IFEQ 016
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1SUST'  YPMTFD           Export/Domestic
     C                     END
      *
     C           ZHCSRW    IFEQ 017
     C           ZHCSCL    ANDEQ032
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1SVST'  YPMTFD           Print On Schedu
     C                     END
      *
     C           ZHCSRW    IFEQ 018
     C           ZHCSCL    ANDGE032
     C           ZHCSCL    ANDLE037
     C           @#DFMT    ANDEQ'#RCDDTL2'
     C                     MOVEL'#1XRCD'  YPMTFD           Primal Group Co
     C                     END
      *
     C           ZHCSRW    IFEQ 011
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1Q1CD'  YPMTFD           Default Warehou
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE032
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1R3CD'  YPMTFD           Department Code
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDGE027
     C           ZHCSCL    ANDLE034
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1AJC8'  YPMTFD           Vendor - Item D
     C                     END
      *
     C           ZHCSRW    IFEQ 015
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1PCCT'  YPMTFD           Piece Count Ite
     C                     END
      *
     C           ZHCSRW    IFEQ 019
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1SYST'  YPMTFD           Fresh Inv Alloc
     C                     END
      *
     C           ZHCSRW    IFEQ 020
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1SZST'  YPMTFD           Fresh Sched As
     C                     END
      *
     C           ZHCSRW    IFEQ 021
     C           ZHCSCL    ANDEQ027
     C           @#DFMT    ANDEQ'#RCDDTL3'
     C                     MOVEL'#1S1ST'  YPMTFD           Frozen Sched As
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Reclaim resources of called programs
     C                     CALL 'Y2RCRSC'
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P1AVNA           Description Lin
     C                     MOVEL*BLANK    P1L7NA           Item Label Line
     C                     MOVEL*BLANK    P1L8NA           Item Label Line
     C                     MOVEL*BLANK    P1L6NA           Item Label Line
     C                     MOVEL*BLANK    P1ADCD           U/M - Primary
     C                     Z-ADD*ZERO     P1AWPC           Conversion Fact
     C                     MOVEL*BLANK    P1AECD           U/M - Second
     C                     Z-ADD*ZERO     P1AXPC           Conversion Fact
     C                     MOVEL*BLANK    P1AFCD           U/M - Third
     C                     MOVEL*BLANK    P1AICD           U/M - Pricing
     C                     Z-ADD*ZERO     P1AIWG           Unit Weight
     C                     MOVEL*BLANK    P1FZST           Production Date
     C                     MOVEL*BLANK    P1AVST           Catch Weight St
     C                     Z-ADD*ZERO     P1CZWG           Minimum Weight
     C                     Z-ADD*ZERO     P1C0WG           Maximum Weight
     C                     Z-ADD*ZERO     P1URTN           Number Cases On
     C                     Z-ADD*ZERO     P1RINB           Item Structure
     C                     MOVEL*BLANK    P1LNCD           Default Commod
     C                     Z-ADD*ZERO     P1BLPR           Market Overage
     C                     Z-ADD*ZERO     P1BMPR           Standard Overag
     C                     MOVEL*BLANK    P1LRCD           Commodity Price
     C                     MOVEL*BLANK    P1U9ST           Item Pricing Op
     C                     Z-ADD*ZERO     P1CMCO           Item Pricing Co
     C                     MOVEL*BLANK    P1Q1CD           Default Warehou
     C                     Z-ADD*ZERO     P1CHTM           Fresh Chilling
     C                     Z-ADD*ZERO     P1SWGH           Std Weight/Head
     C                     Z-ADD*ZERO     P1A3WG           Misc Tare Weigh
     C                     MOVEL*BLANK    P1VSST           Record Status
     C                     MOVEL*BLANK    P2AJCD           Warehouse Code
     C                     MOVEL*BLANK    P2DNCD           Application Cod
     C                     MOVEL*BLANK    P2BCCD           Salesperson Cod
     C                     MOVEL*BLANK    P2B8NA           System Date For
     C                     MOVEL*BLANK    P2AJVN           User Profile Na
     C                     MOVEL*BLANK    P2I6ST           Allow Multi-Com
     C                     MOVEL*BLANK    P2MPNA           Default Printer
     C                     MOVEL*BLANK    P3LQCD           Commodity Marke
     C                     MOVEL*BLANK    P3YKST           USR Formula Met
     C                     MOVEL*BLANK    P3YLST           USR Market Meth
     C                     MOVEL*BLANK    P3YMST           USR Manual Meth
     C                     MOVEL*BLANK    P3YNST           USR Extend Meth
     C                     MOVEL*BLANK    P3V8ST           Price Method Ty
     C                     MOVEL*BLANK    P4ZQST           Change Plant Fl
     C                     MOVEL*BLANK    P5Y5ST           AS Add/Change/D
     C                     MOVEL*BLANK    P6GGST           USR Display fie
     C                     MOVEL*BLANK    P6ECST           Error Status
     C                     MOVEL*BLANK    P6H0CD           U/M - Catchweig
     C                     MOVEL*BLANK    P6BAST           Item Structure
     C                     MOVEL*BLANK    P6TIST           USR Display 1
      *
      * Setup job date/time
      *
     C                     Z-ADDUDATE     ##JDT
      * Set century digit (If YY prior to 1940 treat as 20YY)
     C           ##JYY     IFLT 40
     C                     Z-ADD1         ##JCC
     C                     ELSE
     C                     Z-ADD0         ##JCC
     C                     END
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Catch Weight Status
     C                     MOVEL*BLANK    WUAVST  1
      * Define work field BLANK 1               USR
     C                     MOVEL*BLANK    WUJ1TX 25
      * Define work field USR First Position
     C                     MOVEL*BLANK    WUI3ST  1
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field U/M - Pricing
     C                     MOVEL*BLANK    WUAICD  2
      * Define work field Alpha Zeros
     C                     MOVEL*BLANK    WUKTTX  2
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
      * Initialise error memories
     C                     MOVE *ZERO     @@I1
     C                     MOVE *ZERO     @@I2
     C                     MOVE *ZERO     @@I3
      * Select initial mode
     C           @1NROP    IFEQ *ZERO
      * Add mode
     C                     MOVEL'ADD'     W0PMD   3
     C                     ELSE
      * Change mode
     C                     MOVEL'CHG'     W0PMD
     C                     END
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR TSRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * Move Appl Desc to Co Head - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP
      * Force program into add mode if no item present
      * CASE: PAR.Item Code is Not Entered
     C           P1HGCD    IFEQ *ZERO                      *IF
     C                     MOVEL'ADD'     W0PMD            *Program mode
     C                     END                             *FI
      *================================================================
     CSR         ZZEXIT    ENDSR
** KEY Screen: Field position and name array
0104901561
**
0105101567
**
V1AIC3    V1HGCD
**
01056010880182402080028450288503101
03141036130386903872039070391004125
04136043810439204637046480489304931
0514905187054050540905443
**
01058010940185302109028450288503101
03141036250387003881039080391904127
04165043870442104639046770490504943
0516005198054050541505455
**
V1AIC3    V1HGCD    #1AVNA    #1AWNA    #1FZST    #1AVST    #1XXST
#1VMST    #1AIWG    #1ADCD    #DM4NA    #1AICD    #DM7NA    #1LNCD
#DJ3NA    #1LRCD    #DJ4NA    #1Q8CD    #DMLNA    #1TNVA    #1TMVA
#1BLPR    #1BMPR    #1U9ST    #DHUTX    #1CMCO
**
01046010640107201824018300208002086
02336023420259202598028480285403104
03110033600336603616036220387204128
04134043840464004650
**
01048010700110101826018540208002110
02337023710259202622028490288303106
03139033610339003616036460387204128
04143043840464504679
**
V1AIC3    V1HGCD    #1AVNA    #1N0CD    #DHLTX    #1X4ST    #DHMTX
#1HICD    #DJNNA    #1X5ST    #DGUTX    #1RBCD    #DDPNA    #1RINB
#DDETX    #1QZCD    #DHNTX    #1XWST    #DHOTX    #DSTAT    #1SUST
#DMRTX    #1SVST    #1XRCD    #DOJNA
**
01046010600106801819018590207502115
02331023710258702627026310284302854
03099031100335503366036110386704123
0437904891048960514705403
**
01048010660109701824018660208602126
02335023730259302627026390284502883
03104031390336203395036230386704130
0438504891049020514705403
**
V1AIC3    V1HGCD    #1AVNA    #1CHTM    #1PPHE    #1CZWG    #1C0WG
#1URTN    #1TFNB    #1A3WG    #1VSST    #DHKNA    #1Q1CD    #DF8NA
#1R3CD    #DMYNA    V1AJC8    #DBATX    #1SWGH    #1PCCT    #1BDNB
#1BJNB    #1SYST    #DMSTX    #1SZST    #1S1ST
