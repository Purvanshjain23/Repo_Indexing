     H/TITLE Prc Competitors Rpts  XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:36:18
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKARREL4IF  E           K        DISK
      * RSQ : Carcass Merit Program     CMP Competitors only
      *
     FPKA1CPLLIF  E           K        DISK
      * RSQ : Tattoo Header             Co/VchrDte/Vchr/Tto
      *
     FPKA8REL1IF  E           K        DISK
      * RTV : Hog Classification        Retrieval index
      *
     FPKDGCPL2IF  E           K        DISK
      * RSQ : Competitors Tattoo        Tattoo/Cmp
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKDEREL1IF  E           K        DISK
      * RTV : Competitors Commodity     Retrieval index
      *
     FPKARREL0IF  E           K        DISK
      * RTV : Carcass Merit Program     Retrieval index
      *
     FPKDGCPL0UF  E           K        DISK
      * UPD : Competitors Tattoo        Update index
      *
     I@ARRETN
      * Carcass Merit Program     CMP Competitors only
      * Renamed input format fields
     I              ARAMCD                          WAAMCD
     I              ARA3TX                          WAA3TX
     I              ARDLST                          WADLST
     I              ARDMST                          WADMST
     I              ARDOST                          WADOST
     I              ARDQST                          WADQST
     I              ARAZPC                          WAAZPC
     I              ARA0PC                          WAA0PC
     I              ARDTST                          WADTST
     I              ARF5ST                          WAF5ST
     I              ARI1PR                          WAI1PR
     I              ARVEPR                          WAVEPR
     I              ARVFPR                          WAVFPR
     I              ARVHPR                          WAVHPR
     I              ARVIPR                          WAVIPR
     I              ARVJPR                          WAVJPR
     I              ARZ2ST                          WAZ2ST
     I              ARZ3ST                          WAZ3ST
     I              ARZ4ST                          WAZ4ST
     I              ARAAVN                          WAAAVN
     I              ARAADT                          WAAADT
     I              ARAMTM                          WAAMTM
     I              ARAJST                          WAAJST
     I              ARAHVN                          WAAHVN
     I              ARAGVN                          WAAGVN
     I              ARABVN                          WAABVN
     I              ARABDT                          WAABDT
     I              ARABTM                          WAABTM
      *
     I@A1CPPF
      * Tattoo Header             Co/VchrDte/Vchr/Tto
      * Renamed input format fields
     I              A1HMNB                          WBHMNB
     I              A1BNNB                          WBBNNB
     I              A1BONB                          WBBONB
     I              A1CVNB                          WBCVNB
     I              A1B0DT                          WBB0DT
     I              A1AWDT                          WBAWDT
     I              A1BICD                          WBBICD
     I              A1CPST                          WBCPST
     I              A1ACPR                          WBACPR
     I              A1B9PR                          WBB9PR
     I              A1CAPR                          WBCAPR
     I              A1C4ST                          WBC4ST
     I              A1AIPR                          WBAIPR
     I              A1A6DT                          WBA6DT
     I              A1C2ST                          WBC2ST
     I              A1CXNB                          WBCXNB
     I              A1CWNB                          WBCWNB
     I              A1FCNB                          WBFCNB
     I              A1H9NB                          WBH9NB
     I              A1FDNB                          WBFDNB
     I              A1FENB                          WBFENB
     I              A1HENB                          WBHENB
     I              A1HFNB                          WBHFNB
     I              A1CYNB                          WBCYNB
     I              A1LRNB                          WBLRNB
     I              A1E0NB                          WBE0NB
     I              A1A5PC                          WBA5PC
     I              A1FBNB                          WBFBNB
     I              A1A4PC                          WBA4PC
     I              A1F7NB                          WBF7NB
     I              A1HDNB                          WBHDNB
     I              A1F5NB                          WBF5NB
     I              A1F4NB                          WBF4NB
     I              A1F3NB                          WBF3NB
     I              A1F2NB                          WBF2NB
     I              A1AVPC                          WBAVPC
     I              A1AWPC                          WBAWPC
     I              A1CWPC                          WBCWPC
     I              A1A8PC                          WBA8PC
     I              A1A7PC                          WBA7PC
     I              A1B8PR                          WBB8PR
     I              A1AMPR                          WBAMPR
     I              A1ANPR                          WBANPR
     I              A1AYVA                          WBAYVA
     I              A1AWVA                          WBAWVA
     I              A1AOPR                          WBAOPR
     I              A1AXVA                          WBAXVA
     I              A1APPR                          WBAPPR
     I              A1ASPR                          WBASPR
     I              A1A4VA                          WBA4VA
     I              A1ATPR                          WBATPR
     I              A1A5VA                          WBA5VA
     I              A1CBPR                          WBCBPR
     I              A1CCPR                          WBCCPR
     I              A1LPNB                          WBLPNB
     I              A1CDPR                          WBCDPR
     I              A1A7VA                          WBA7VA
     I              A1A2PR                          WBA2PR
     I              A1JWST                          WBJWST
     I              A1CWST                          WBCWST
     I              A1D7ST                          WBD7ST
     I              A1D8ST                          WBD8ST
     I              A1DWST                          WBDWST
     I              A1D6ST                          WBD6ST
     I              A1GHNB                          WBGHNB
     I              A1BYDT                          WBBYDT
     I              A1E0ST                          WBE0ST
     I              A1E1ST                          WBE1ST
     I              A1E2ST                          WBE2ST
     I              A1BSDT                          WBBSDT
     I              A1BTDT                          WBBTDT
     I              A1BUDT                          WBBUDT
     I              A1HGNB                          WBHGNB
     I              A1HHNB                          WBHHNB
     I              A1HINB                          WBHINB
     I              A1A3PR                          WBA3PR
     I              A1A4PR                          WBA4PR
     I              A1A6PR                          WBA6PR
     I              A1J9NB                          WBJ9NB
     I              A1D6PR                          WBD6PR
     I              A1D7PR                          WBD7PR
     I              A1D8PR                          WBD8PR
     I              A1D9PR                          WBD9PR
     I              A1EAPR                          WBEAPR
     I              A1EBPR                          WBEBPR
     I              A1ECPR                          WBECPR
     I              A1EDPR                          WBEDPR
     I              A1EEPR                          WBEEPR
     I              A1EFPR                          WBEFPR
     I              A1EGPR                          WBEGPR
     I              A1EHPR                          WBEHPR
     I              A1KAST                          WBKAST
     I              A1J7ST                          WBJ7ST
     I              A1J9ST                          WBJ9ST
     I              A1OXNB                          WBOXNB
     I              A1LKST                          WBLKST
     I              A1LLST                          WBLLST
     I              A1J8ST                          WBJ8ST
     I              A1LIST                          WBLIST
     I              A1LJST                          WBLJST
     I              A1NZTX                          WBNZTX
     I              A1HJCD                          WBHJCD
     I              A1R4ST                          WBR4ST
     I              A1R5ST                          WBR5ST
     I              A1R6ST                          WBR6ST
     I              A1R7ST                          WBR7ST
     I              A1THWT                          WBTHWT
     I              A1T2WT                          WBT2WT
     I              A1THHD                          WBTHHD
     I              A1T2HD                          WBT2HD
     I              A1OBPR                          WBOBPR
     I              A1KOER                          WBKOER
     I              A1OPIR                          WBOPIR
     I              A1OPEM                          WBOPEM
     I              A1IORP                          WBIORP
     I              A1OWEO                          WBOWEO
     I              A1OQET                          WBOQET
     I              A1URST                          WBURST
     I              A1USST                          WBUSST
     I              A1HHPC                          WBHHPC
     I              A1S9PR                          WBS9PR
     I              A1TAPR                          WBTAPR
     I              A1TBPR                          WBTBPR
     I              A1JFUR                          WBJFUR
     I              A1KRIF                          WBKRIF
     I              A1KORF                          WBKORF
     I              A1KAPR                          WBKAPR
     I              A1KROT                          WBKROT
     I              A1OTJG                          WBOTJG
     I              A1IRJG                          WBIRJG
     I              A1IMJF                          WBIMJF
     I              A1IRGF                          WBIRGF
     I              A1KRJF                          WBKRJF
     I              A1OJRF                          WBOJRF
     I              A1KFOR                          WBKFOR
     I              A1ORJK                          WBORJK
     I              A1OMVJ                          WBOMVJ
     I              A1MVNF                          WBMVNF
     I              A1MCNF                          WBMCNF
     I              A1NCNF                          WBNCNF
     I              A1NCHF                          WBNCHF
     I              A1IGIR                          WBIGIR
     I              A1KFJR                          WBKFJR
     I              A1EADT                          WBEADT
     I              A1EBDT                          WBEBDT
     I              A1ECDT                          WBECDT
     I              A1EDDT                          WBEDDT
     I              A1EEDT                          WBEEDT
     I              A1U4ST                          WBU4ST
     I              A1U5ST                          WBU5ST
     I              A1U6ST                          WBU6ST
     I              A1U7ST                          WBU7ST
     I              A1U8ST                          WBU8ST
     I              A1U9ST                          WBU9ST
     I              A1VAST                          WBVAST
     I              A1VBST                          WBVBST
     I              A1BDCD                          WBBDCD
     I              A1CSCD                          WBCSCD
     I              A1ABCD                          WBABCD
     I              A1AECD                          WBAECD
     I              A1ACCD                          WBACCD
     I              A1AGCD                          WBAGCD
     I              A1BECD                          WBBECD
     I              A1AAVN                          WBAAVN
     I              A1AADT                          WBAADT
     I              A1AMTM                          WBAMTM
     I              A1AJST                          WBAJST
     I              A1AHVN                          WBAHVN
     I              A1AGVN                          WBAGVN
     I              A1ABVN                          WBABVN
     I              A1ABDT                          WBABDT
     I              A1ABTM                          WBABTM
      *
     I@A8REDA
      * Hog Classification        Retrieval index
      * Renamed input format fields
     I              A8BECD                          WCBECD
     I              A8BDTX                          WCBDTX
     I              A8BXST                          WCBXST
     I              A8BYST                          WCBYST
     I              A8BITX                          WCBITX
     I              A8B0ST                          WCB0ST
     I              A8FBST                          WCFBST
     I              A8AAVN                          WCAAVN
     I              A8AADT                          WCAADT
     I              A8AMTM                          WCAMTM
     I              A8AJST                          WCAJST
     I              A8AHVN                          WCAHVN
     I              A8AGVN                          WCAGVN
     I              A8ABVN                          WCABVN
     I              A8ABDT                          WCABDT
     I              A8ABTM                          WCABTM
      *
     I@DGCPTP
      * Competitors Tattoo        Tattoo/Cmp
      * Renamed input format fields
     I              DGAMCD                          WDAMCD
     I              DGHMNB                          WDHMNB
     I              DGBNNB                          WDBNNB
     I              DGBONB                          WDBONB
     I              DGCVNB                          WDCVNB
     I              DGB0DT                          WDB0DT
     I              DGMHST                          WDMHST
     I              DGF4PC                          WDF4PC
     I              DGG5PR                          WDG5PR
     I              DGJPPR                          WDJPPR
     I              DGG6PR                          WDG6PR
     I              DGJQPR                          WDJQPR
     I              DGG7PR                          WDG7PR
     I              DGJRPR                          WDJRPR
     I              DGJUPR                          WDJUPR
     I              DGJVPR                          WDJVPR
     I              DGG8PR                          WDG8PR
     I              DGJSPR                          WDJSPR
     I              DGG9PR                          WDG9PR
     I              DGJTPR                          WDJTPR
     I              DGAAVN                          WDAAVN
     I              DGAADT                          WDAADT
     I              DGAMTM                          WDAMTM
     I              DGAJST                          WDAJST
     I              DGAHVN                          WDAHVN
     I              DGAGVN                          WDAGVN
     I              DGABVN                          WDABVN
     I              DGABDT                          WDABDT
     I              DGABTM                          WDABTM
      *
     I@DGCPTJ
      * Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WEAMCD
     I              DGHMNB                          WEHMNB
     I              DGBNNB                          WEBNNB
     I              DGBONB                          WEBONB
     I              DGCVNB                          WECVNB
     I              DGB0DT                          WEB0DT
     I              DGMHST                          WEMHST
     I              DGF4PC                          WEF4PC
     I              DGG5PR                          WEG5PR
     I              DGJPPR                          WEJPPR
     I              DGG6PR                          WEG6PR
     I              DGJQPR                          WEJQPR
     I              DGG7PR                          WEG7PR
     I              DGJRPR                          WEJRPR
     I              DGJUPR                          WEJUPR
     I              DGJVPR                          WEJVPR
     I              DGG8PR                          WEG8PR
     I              DGJSPR                          WEJSPR
     I              DGG9PR                          WEG9PR
     I              DGJTPR                          WEJTPR
     I              DGAAVN                          WEAAVN
     I              DGAADT                          WEAADT
     I              DGAMTM                          WEAMTM
     I              DGAJST                          WEAJST
     I              DGAHVN                          WEAHVN
     I              DGAGVN                          WEAGVN
     I              DGABVN                          WEABVN
     I              DGABDT                          WEABDT
     I              DGABTM                          WEABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WFHMNB
     I              AWBNNB                          WFBNNB
     I              AWARDT                          WFARDT
     I              AWASDT                          WFASDT
     I              AWA4ST                          WFA4ST
     I              AWA5ST                          WFA5ST
     I              AWAAPR                          WFAAPR
     I              AWA6ST                          WFA6ST
     I              AWA7ST                          WFA7ST
     I              AWB3ST                          WFB3ST
     I              AWALPR                          WFALPR
     I              AWETCD                          WFETCD
     I              AWEUCD                          WFEUCD
     I              AWJ5TX                          WFJ5TX
     I              AWD5DT                          WFD5DT
     I              AWD6DT                          WFD6DT
     I              AWD7DT                          WFD7DT
     I              AWD8DT                          WFD8DT
     I              AWD9DT                          WFD9DT
     I              AWJOEJ                          WFJOEJ
     I              AWKOFF                          WFKOFF
     I              AWKWPE                          WFKWPE
     I              AWIMBF                          WFIMBF
     I              AWOPTR                          WFOPTR
     I              AWOEJD                          WFOEJD
     I              AWIRMF                          WFIRMF
     I              AWJIRM                          WFJIRM
     I              AWJRKF                          WFJRKF
     I              AWKFIR                          WFKFIR
     I              AWUZST                          WFUZST
     I              AWU0ST                          WFU0ST
     I              AWU1ST                          WFU1ST
     I              AWU2ST                          WFU2ST
     I              AWU3ST                          WFU3ST
     I              AWHXNB                          WFHXNB
     I              AWGANB                          WFGANB
     I              AWGBNB                          WFGBNB
     I              AWABCD                          WFABCD
     I              AWAECD                          WFAECD
     I              AWAKCD                          WFAKCD
     I              AWALCD                          WFALCD
     I              AWAGCD                          WFAGCD
     I              AWAICD                          WFAICD
     I              AWAMCD                          WFAMCD
     I              AWACCD                          WFACCD
     I              AWAAVN                          WFAAVN
     I              AWAADT                          WFAADT
     I              AWAMTM                          WFAMTM
     I              AWAJST                          WFAJST
     I              AWAHVN                          WFAHVN
     I              AWAGVN                          WFAGVN
     I              AWABVN                          WFABVN
     I              AWABDT                          WFABDT
     I              AWABTM                          WFABTM
      *
     I@DERETE
      * Competitors Commodity     Retrieval index
      * Renamed input format fields
     I              DETNNB                          WGTNNB
     I              DEE5CD                          WGE5CD
     I              DEE6CD                          WGE6CD
     I              DEJ9TX                          WGJ9TX
     I              DEGAPR                          WGGAPR
     I              DEAAVN                          WGAAVN
     I              DEAADT                          WGAADT
     I              DEAMTM                          WGAMTM
     I              DEAJST                          WGAJST
     I              DEAHVN                          WGAHVN
     I              DEAGVN                          WGAGVN
     I              DEABVN                          WGABVN
     I              DEABDT                          WGABDT
     I              DEABTM                          WGABTM
      *
     I@ARREBF
      * Carcass Merit Program     Retrieval index
      * Renamed input format fields
     I              ARAMCD                          WHAMCD
     I              ARA3TX                          WHA3TX
     I              ARDLST                          WHDLST
     I              ARDMST                          WHDMST
     I              ARDOST                          WHDOST
     I              ARDQST                          WHDQST
     I              ARAZPC                          WHAZPC
     I              ARA0PC                          WHA0PC
     I              ARDTST                          WHDTST
     I              ARF5ST                          WHF5ST
     I              ARI1PR                          WHI1PR
     I              ARVEPR                          WHVEPR
     I              ARVFPR                          WHVFPR
     I              ARVHPR                          WHVHPR
     I              ARVIPR                          WHVIPR
     I              ARVJPR                          WHVJPR
     I              ARZ2ST                          WHZ2ST
     I              ARZ3ST                          WHZ3ST
     I              ARZ4ST                          WHZ4ST
     I              ARAAVN                          WHAAVN
     I              ARAADT                          WHAADT
     I              ARAMTM                          WHAMTM
     I              ARAJST                          WHAJST
     I              ARAHVN                          WHAHVN
     I              ARAGVN                          WHAGVN
     I              ARABVN                          WHABVN
     I              ARABDT                          WHABDT
     I              ARABTM                          WHABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKDG1    E DSPKDGCPL0
      * UPD : Competitors Tattoo        Update index
      * Renamed input format fields
     I              DGAMCD                          WEAMCD
     I              DGHMNB                          WEHMNB
     I              DGBNNB                          WEBNNB
     I              DGBONB                          WEBONB
     I              DGCVNB                          WECVNB
     I              DGB0DT                          WEB0DT
     I              DGMHST                          WEMHST
     I              DGF4PC                          WEF4PC
     I              DGG5PR                          WEG5PR
     I              DGJPPR                          WEJPPR
     I              DGG6PR                          WEG6PR
     I              DGJQPR                          WEJQPR
     I              DGG7PR                          WEG7PR
     I              DGJRPR                          WEJRPR
     I              DGJUPR                          WEJUPR
     I              DGJVPR                          WEJVPR
     I              DGG8PR                          WEG8PR
     I              DGJSPR                          WEJSPR
     I              DGG9PR                          WEG9PR
     I              DGJTPR                          WEJTPR
     I              DGAAVN                          WEAAVN
     I              DGAADT                          WEAADT
     I              DGAMTM                          WEAMTM
     I              DGAJST                          WEAJST
     I              DGAHVN                          WEAHVN
     I              DGAGVN                          WEAGVN
     I              DGABVN                          WEABVN
     I              DGABDT                          WEABDT
     I              DGABTM                          WEABTM
      *
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Company Control HPE
      * I : MAP CC Company Number
     I                                    P   1   20P1HONB
     IP2PARM      DS
      * I : MAP Pmt Current Payment Date
     I                                    P   1   40P2CKDT
     IP3PARM      DS
      * I : MAP Oms System Value Alpha
     I                                        1  40 P3EVTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HONB    PARM           WP0001  30       CC Company Numb
     C           P2CKDT    PARM           WP0002  70       Pmt Current Pay
     C           P3EVTX    PARM           WP0003 40        Oms System Valu
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prc Competitors Rpts  XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * Rtv the Competitors Carcass Merit codes only 3 allowed
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
     C                     EXSR SARVGN
      * Read each Tattoo for the passed in voucher date
      * and Build the Competitors file
      * Rtv Clc Competitors   RT - Tattoo Header  * 
     C                     EXSR SBRVGN
      * Do not print the reports by Mel/Jancie 4/6/00.  -Purva
      * Competitor reports
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Cmp Competitors   RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUP0NB           Count USR
     C                     MOVEL*BLANK    WUE7CD           Competitors Cod
     C                     MOVEL*BLANK    WUE8CD           Competitors Cod
     C                     MOVEL*BLANK    WUE9CD           Competitors Cod
      * Establish starting position
     C           *LOVAL    SETLL@ARRETN                    *
     C                     READ @ARRETN                  90*
      * Data record not found
     C   90                MOVEL'PRK0039' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  001       WUP0NB           Count USR
      * CASE: WRK.Count USR is One
     C           WUP0NB    IFEQ 1                          *IF
     C                     MOVELWAAMCD    WUE7CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Two
     C           WUP0NB    IFEQ 2                          *IF
     C                     MOVELWAAMCD    WUE8CD           Competitors Cod
     C                     ELSE
      * CASE: WRK.Count USR is Three
     C           WUP0NB    IFEQ 3                          *IF
     C                     MOVELWAAMCD    WUE9CD           Competitors Cod
     C                     GOTO SAEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @ARRETN                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Clc Competitors   RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUDUNB           Last BOH BuyOrd
     C                     Z-ADD*ZERO     WUDVNB           Last BOL Load n
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHMNB    WQSB01           BOH Company Num
     C           *LIKE     DEFN WBBYDT    WQSB02           TH Voucher Paym
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           BOH Company Num
     C                     KFLD           WQSB02           TH Voucher Paym
      * Setup key
     C                     Z-ADDP1HONB    WQSB01           BOH Company Num
     C                     Z-ADDP2CKDT    WQSB02           TH Voucher Paym
      * Establish starting position
     C           KRSSB     SETLL@A1CPPF                    *
     C           KRSSB     READE@A1CPPF                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.RS Record Status is Active
     C           WBAJST    IFEQ 'A'                        *IF
     C                     Z-ADDWBTAPR    YL0001           TH VC Gross Val
      * Clc Competitors Rpts  IF
      * Rtv Hog Class         RT - Hog Classification  * 
     C                     EXSR SCRVGN
      * Market and head kill greater then zero
      * Build Competitors file
      * CASE: WRK.HC Class Type is Market
     C           WUFBST    IFEQ 'M'                        *IF
      * Rtv/Dlt Comptitors Tat RT - Competitors Tattoo  * 
     C                     EXSR SDRVGN
      * *Retrieve Purchase Price calculation information.
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
     C                     EXSR SFRVGN
      * Competitors will be using CASH BASIC Pricing, and no pricing opit
      * Competitor 1
     C                     EXSR UBSUBR                     Competitor 1
      * Competitor 2
     C                     EXSR UCSUBR                     Competitor 2
      * Competitor 3
     C                     EXSR UDSUBR                     Competitor 3
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSB     READE@A1CPPF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Hog Class         RT - Hog Classification  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCBECD           HC Class Code
      * Setup key
     C                     MOVELWBBECD    WCBECD           HC Class Code
      * Establish starting position
     C           KRSSC     CHAIN@A8REDA              90    *
      * Data record not found
     C   90                MOVEL'PRK0075' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCBDTX    WUBDTX           HC Description
     C                     MOVELWCBXST    WUBXST           HC Defect Requi
     C                     MOVELWCBYST    WUBYST           HC Price Requir
     C                     MOVELWCBITX    WUBITX           HC Resolution
     C                     MOVELWCB0ST    WUB0ST           HC Qualificatio
     C                     MOVELWCFBST    WUFBST           HC Class Type
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Dlt Comptitors Tat RT - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQSD04           TH Tattoo Numbe
     C           *LIKE     DEFN WDB0DT    WQSD05           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
     C                     KFLD           WQSD05           TH Kill Date
      * Setup key
     C                     Z-ADDWBHMNB    WQSD01           BOH Company Num
     C                     Z-ADDWBBNNB    WQSD02           BOH Buy Order N
     C                     Z-ADDWBBONB    WQSD03           BOL Load Number
     C                     Z-ADDWBCVNB    WQSD04           TH Tattoo Numbe
     C                     Z-ADDWBB0DT    WQSD05           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@DGCPTP                    *
     C           KRSSD     READE@DGCPTP                  90*
      * Data record not found
     C   90                MOVEL'PRK0570' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Competitors Tattoo DO - Competitors Tattoo  * 
     C                     EXSR SEDLRC
     C           KRSSD     READE@DGCPTP                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SEDLRC    BEGSR
      *================================================================
      * Dlt Competitors Tattoo DO - Competitors Tattoo  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @DGCPTJ
     C                     MOVELWDAMCD    WEAMCD           CMP Program Cod
     C                     Z-ADDWDHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWDBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWDBONB    WEBONB           BOL Load Number
     C                     Z-ADDWDCVNB    WECVNB           TH Tattoo Numbe
     C                     Z-ADDWDB0DT    WEB0DT           TH Kill Date
      *
     C           KLDLSE    KLIST
     C                     KFLD           WEAMCD           CMP Program Cod
     C                     KFLD           WEHMNB           BOH Company Num
     C                     KFLD           WEBNNB           BOH Buy Order N
     C                     KFLD           WEBONB           BOL Load Number
     C                     KFLD           WECVNB           TH Tattoo Numbe
     C                     KFLD           WEB0DT           TH Kill Date
     C           KLDLSE    CHAIN@DGCPTJ              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKDGCPL0'MDACP
     C                     MOVEL'@DGCPTJ' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@DGCPTJ                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv PrchPrc Clc Info  RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWBHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WFBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSF     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * 1/28/08 SLM LEFT OVER INFORMATION MAY HAVE CAUSED ISSUES
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUAAPR           BOH Market Add/
     C                     MOVEL*BLANK    WUB3ST           BOH Quote Price
     C                     Z-ADD*ZERO     WUALPR           BOH Quoted Base
     C                     MOVEL*BLANK    WUETCD           BOH Commodity M
     C                     MOVEL*BLANK    WUEUCD           BOH Commodity P
     C                     MOVEL*BLANK    WUJ5TX           BOH Market Date
     C                     MOVEL*BLANK    WUAKCD           PC Contract Cod
     C                     MOVEL*BLANK    WUALCD           PSC Sub-Contrac
     C                     MOVEL*BLANK    WUAICD           PO Option Code
     C                     MOVEL*BLANK    WUAMCD           CMP Program Cod
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFAAPR    WUAAPR           BOH Market Add/
     C                     MOVELWFB3ST    WUB3ST           BOH Quote Price
     C                     Z-ADDWFALPR    WUALPR           BOH Quoted Base
     C                     MOVELWFETCD    WUETCD           BOH Commodity M
     C                     MOVELWFEUCD    WUEUCD           BOH Commodity P
     C                     MOVELWFJ5TX    WUJ5TX           BOH Market Date
     C                     MOVELWFAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWFALCD    WUALCD           PSC Sub-Contrac
     C                     MOVELWFAICD    WUAICD           PO Option Code
     C                     MOVELWFAMCD    WUAMCD           CMP Program Cod
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGTNNB           CCC Record
      * Setup key
     C                     Z-ADD00001     WGTNNB           CCC Record
      * Establish starting position
     C           KRSSG     CHAIN@DERETE              90    *
      * Data record not found
     C   90                MOVEL'PRK0566' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGE5CD    WUE5CD           CCC Commodity M
     C                     MOVELWGE6CD    WUE6CD           CCC Commodity P
     C                     MOVELWGJ9TX    WUJ9TX           CCC Market Date
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SHRVGN
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWUE7CD    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSH     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUA3TX           CMP Description
     C                     MOVELWHDLST    WUDLST           CMP Grading Typ
     C                     MOVELWHDMST    WUDMST           CMP Sort Basis
     C                     MOVELWHDQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWHDTST    WUDTST           CMP Optimal Row
     C                     MOVELWHF5ST    WUF5ST           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WGTNNB           CCC Record
      * Setup key
     C                     Z-ADD00001     WGTNNB           CCC Record
      * Establish starting position
     C           KRSSI     CHAIN@DERETE              90    *
      * Data record not found
     C   90                MOVEL'PRK0566' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGE5CD    WUE5CD           CCC Commodity M
     C                     MOVELWGE6CD    WUE6CD           CCC Commodity P
     C                     MOVELWGJ9TX    WUJ9TX           CCC Market Date
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SJRVGN
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWUE8CD    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSJ     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUA3TX           CMP Description
     C                     MOVELWHDLST    WUDLST           CMP Grading Typ
     C                     MOVELWHDMST    WUDMST           CMP Sort Basis
     C                     MOVELWHDQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWHDTST    WUDTST           CMP Optimal Row
     C                     MOVELWHF5ST    WUF5ST           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WGTNNB           CCC Record
      * Setup key
     C                     Z-ADD00001     WGTNNB           CCC Record
      * Establish starting position
     C           KRSSK     CHAIN@DERETE              90    *
      * Data record not found
     C   90                MOVEL'PRK0566' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWGE5CD    WUE5CD           CCC Commodity M
     C                     MOVELWGE6CD    WUE6CD           CCC Commodity P
     C                     MOVELWGJ9TX    WUJ9TX           CCC Market Date
      * Rtv CMP Info          RT - Carcass Merit Program  * 
     C                     EXSR SLRVGN
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv CMP Info          RT - Carcass Merit Program  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WHAMCD           CMP Program Cod
      * Setup key
     C                     MOVELWUE9CD    WHAMCD           CMP Program Cod
      * Establish starting position
     C           KRSSL     CHAIN@ARREBF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUA3TX           CMP Description
     C                     MOVEL*BLANK    WUDLST           CMP Grading Typ
     C                     MOVEL*BLANK    WUDMST           CMP Sort Basis
     C                     MOVEL*BLANK    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADD*ZERO     WUAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WUA0PC           CMP Lean Factor
     C                     MOVEL*BLANK    WUDTST           CMP Optimal Row
     C                     MOVEL*BLANK    WUF5ST           CMP Type
     C                     Z-ADD*ZERO     WUI1PR           CMP Market Add/
     C                     MOVEL*BLANK    WUAJST           RS Record Statu
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWHA3TX    WUA3TX           CMP Description
     C                     MOVELWHDLST    WUDLST           CMP Grading Typ
     C                     MOVELWHDMST    WUDMST           CMP Sort Basis
     C                     MOVELWHDQST    WUDQST           CMP Carc Wgt Ty
     C                     Z-ADDWHAZPC    WUAZPC           CMP Std Lean Pe
     C                     Z-ADDWHA0PC    WUA0PC           CMP Lean Factor
     C                     MOVELWHDTST    WUDTST           CMP Optimal Row
     C                     MOVELWHF5ST    WUF5ST           CMP Type
     C                     Z-ADDWHI1PR    WUI1PR           CMP Market Add/
     C                     MOVELWHAJST    WUAJST           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *  length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Competitor 1
      *================================================================
      * CASE: PAR.Competitors Code 1 Usr NE WRK.Blank USR
     C           WUE7CD    IFNE WUCRTX                     *IF
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
     C                     EXSR SGRVGN
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0001  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0002  50       BOL Load Number
     C                     PARM WBCVNB    WQ0003  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0004  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0005  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0006  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0007  70       TH Kill Date
     C                     PARM WBHMNB    WQ0008  30       BOH Company Num
     C                     PARM *ZERO     WQ0009  52       PSC Floor Price
     C                     PARM *ZERO     WQ0010  52       PSC Ceiling Pri
     C                     PARM *ZERO     WQ0011  30       PSC Market Perc
     C                     PARM *ZERO     WQ0012  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0013  52       Market Price US
     C                     PARM 'CBP'     WQ0014  3        PO Option Code
     C                     PARM *BLANK    WQ0015  5        PC Contract Cod
     C                     PARM *BLANK    WQ0016  5        PSC Sub-Contrac
     C                     PARM WUI1PR    WQ0017  52       BOH Market Add/
     C                     PARM WUE7CD    WQ0018  3        CMP Program Cod
     C                     PARM 'LP'      WQ0019  2        BOH Quote Price
     C                     PARM *ZERO     WQ0020  52       BOH Quoted Base
     C                     PARM WUE5CD    WQ0021  3        BOH Commodity M
     C                     PARM WUE6CD    WQ0022  7        BOH Commodity P
     C                     PARM WUJ9TX    WQ0023  3        BOH Market Date
     C                     PARM WBFENB    WQ0024  50       TH Head Killed
     C                     PARM WBHENB    WQ0025  50       TH Head Adds
     C                     PARM WBAWPC    WQ0026  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0027  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0028  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0029  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0030  50       TH Head Exclude
     C                     PARM WBKAST    WQ0031  1        TH Source Type
     C                     PARM WBJ9ST    WQ0032  1        TH Payment Type
     C                     PARM WBS9PR    WQ0033  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0034  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0035  52       TH PHA Sort Dis
     C                     PARM 'Y'       WQ0036  1        Competitors Pro
     C                     PARM 'P'       WQ0037  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Competitor 2
      *================================================================
      * CASE: PAR.Competitors Code 2 Usr NE WRK.Blank USR
     C           WUE8CD    IFNE WUCRTX                     *IF
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
     C                     EXSR SIRVGN
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0038  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0039  50       BOL Load Number
     C                     PARM WBCVNB    WQ0040  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0041  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0042  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0043  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0044  70       TH Kill Date
     C                     PARM WBHMNB    WQ0045  30       BOH Company Num
     C                     PARM *ZERO     WQ0046  52       PSC Floor Price
     C                     PARM *ZERO     WQ0047  52       PSC Ceiling Pri
     C                     PARM *ZERO     WQ0048  30       PSC Market Perc
     C                     PARM *ZERO     WQ0049  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0050  52       Market Price US
     C                     PARM 'CBP'     WQ0051  3        PO Option Code
     C                     PARM *BLANK    WQ0052  5        PC Contract Cod
     C                     PARM *BLANK    WQ0053  5        PSC Sub-Contrac
     C                     PARM WUI1PR    WQ0054  52       BOH Market Add/
     C                     PARM WUE8CD    WQ0055  3        CMP Program Cod
     C                     PARM 'LP'      WQ0056  2        BOH Quote Price
     C                     PARM *ZERO     WQ0057  52       BOH Quoted Base
     C                     PARM WUE5CD    WQ0058  3        BOH Commodity M
     C                     PARM WUE6CD    WQ0059  7        BOH Commodity P
     C                     PARM WUJ9TX    WQ0060  3        BOH Market Date
     C                     PARM WBFENB    WQ0061  50       TH Head Killed
     C                     PARM WBHENB    WQ0062  50       TH Head Adds
     C                     PARM WBAWPC    WQ0063  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0064  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0065  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0066  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0067  50       TH Head Exclude
     C                     PARM WBKAST    WQ0068  1        TH Source Type
     C                     PARM WBJ9ST    WQ0069  1        TH Payment Type
     C                     PARM WBS9PR    WQ0070  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0071  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0072  52       TH PHA Sort Dis
     C                     PARM 'Y'       WQ0073  1        Competitors Pro
     C                     PARM 'P'       WQ0074  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Competitor 3
      *================================================================
      * CASE: PAR.Competitors Code 3 Usr NE WRK.Blank USR
     C           WUE9CD    IFNE WUCRTX                     *IF
      * CASE: PAR.TH Head Killed is Not Zero
     C           WBFENB    IFNE 0                          *IF
      * Rtv Competitors Comm   RT - Competitors Commodity  * 
     C                     EXSR SKRVGN
      * Carcass Merit Process  XF - STR Batch Processing  * 
     C                     CALL 'PKXNXFR'              90  Carcass Merit P
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WBBNNB    WQ0075  70       BOH Buy Order N
     C                     PARM WBBONB    WQ0076  50       BOL Load Number
     C                     PARM WBCVNB    WQ0077  50       TH Tattoo Numbe
     C                     PARM WBAWDT    WQ0078  70       TH Purchase Dat
     C                     PARM WBCYNB    WQ0079  71       TH Live Wgt
     C           WUAMPR    PARM WUAMPR    WQ0080  52       TH CM Base Mkt
     C                     PARM WBB0DT    WQ0081  70       TH Kill Date
     C                     PARM WBHMNB    WQ0082  30       BOH Company Num
     C                     PARM *ZERO     WQ0083  52       PSC Floor Price
     C                     PARM *ZERO     WQ0084  52       PSC Ceiling Pri
     C                     PARM *ZERO     WQ0085  30       PSC Market Perc
     C                     PARM *ZERO     WQ0086  52       PSC Mkt Percent
     C           WUB8PR    PARM WUB8PR    WQ0087  52       Market Price US
     C                     PARM 'CBP'     WQ0088  3        PO Option Code
     C                     PARM *BLANK    WQ0089  5        PC Contract Cod
     C                     PARM *BLANK    WQ0090  5        PSC Sub-Contrac
     C                     PARM WUI1PR    WQ0091  52       BOH Market Add/
     C                     PARM WUE9CD    WQ0092  3        CMP Program Cod
     C                     PARM 'LP'      WQ0093  2        BOH Quote Price
     C                     PARM *ZERO     WQ0094  52       BOH Quoted Base
     C                     PARM WUE5CD    WQ0095  3        BOH Commodity M
     C                     PARM WUE6CD    WQ0096  7        BOH Commodity P
     C                     PARM WUJ9TX    WQ0097  3        BOH Market Date
     C                     PARM WBFENB    WQ0098  50       TH Head Killed
     C                     PARM WBHENB    WQ0099  50       TH Head Adds
     C                     PARM WBAWPC    WQ0100  52       TH Actual Yield
     C                     PARM WBCWPC    WQ0101  52       TH Adj Actual Y
     C                     PARM WBB8PR    WQ0102  52       TH CM Market Pr
     C                     PARM WBHHNB    WQ0103  71       TH Avg Hot Wgt
     C                     PARM WBJ9NB    WQ0104  50       TH Head Exclude
     C                     PARM WBKAST    WQ0105  1        TH Source Type
     C                     PARM WBJ9ST    WQ0106  1        TH Payment Type
     C                     PARM WBS9PR    WQ0107  52       TH PHA Lean Prm
     C           YL0001    PARM YL0001    WQ0108  52       TH VC Gross Val
     C                     PARM WBOMVJ    WQ0109  52       TH PHA Sort Dis
     C                     PARM 'Y'       WQ0110  1        Competitors Pro
     C                     PARM 'P'       WQ0111  1        CM Processing T
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKXNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Competitors Code 1 Usr
     C                     MOVEL*BLANK    WUE7CD  3
      * Define work field Competitors Code 2 Usr
     C                     MOVEL*BLANK    WUE8CD  3
      * Define work field Competitors Code 3 Usr
     C                     MOVEL*BLANK    WUE9CD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAZPC           CMP Std Lean Pe
     C                     Z-ADD*ZERO     WAA0PC           CMP Lean Factor
     C                     Z-ADD*ZERO     WAI1PR           CMP Market Add/
     C                     Z-ADD*ZERO     WAVEPR           CMP % of Carcas
     C                     Z-ADD*ZERO     WAVFPR           CMP Fixed Cost
     C                     Z-ADD*ZERO     WAVHPR           CMP Grade Type
     C                     Z-ADD*ZERO     WAVIPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAVJPR           CMP Unused Pric
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUP0NB  30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WBB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WBAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WBACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WBB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WBCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WBAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WBA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WBCXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WBCWNB           TH Head Receive
     C                     Z-ADD*ZERO     WBFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WBH9NB           TH Held Over
     C                     Z-ADD*ZERO     WBFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WBFENB           TH Head Killed
     C                     Z-ADD*ZERO     WBHENB           TH Head Adds
     C                     Z-ADD*ZERO     WBHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WBCYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WBLRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WBE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WBA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WBFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WBA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WBF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WBHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WBF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WBF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WBAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WBAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WBCWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WBA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WBA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WBB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WBAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WBAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WBAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WBAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WBAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WBAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WBASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WBA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WBATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WBA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WBCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WBCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WBLPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WBCDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WBA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WBA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WBGHNB           TH Commission A
     C                     Z-ADD*ZERO     WBBYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WBBSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WBBTDT           TH Commission P
     C                     Z-ADD*ZERO     WBBUDT           TH Actual Check
     C                     Z-ADD*ZERO     WBHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WBHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WBHINB           TH FFLI
     C                     Z-ADD*ZERO     WBA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WBA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WBA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WBJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WBD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WBD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WBD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WBD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WBEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WBEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WBECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WBEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WBEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WBEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WBEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WBOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WBTHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WBT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WBTHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WBT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WBOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WBKOER           TH Head Identif
     C                     Z-ADD*ZERO     WBOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WBOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WBIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WBOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WBHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WBS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WBTAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WBTBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WBJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WBKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WBKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WBKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WBKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WBOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WBIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WBIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WBIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WBKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WBKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WBORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WBOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WBMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WBMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WBNCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WBNCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WBIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WBKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WBEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WBECDT           TH Head LFT
     C                     Z-ADD*ZERO     WBEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WBEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field Last BOH BuyOrder Nbr USR
     C                     Z-ADD*ZERO     WUDUNB  70
      * Define work field Last BOL Load number  USR
     C                     Z-ADD*ZERO     WUDVNB  50
      * Define work field HC Description
     C                     MOVEL*BLANK    WUBDTX 25
      * Define work field HC Defect Required
     C                     MOVEL*BLANK    WUBXST  1
      * Define work field HC Price Required
     C                     MOVEL*BLANK    WUBYST  1
      * Define work field HC Resolution
     C                     MOVEL*BLANK    WUBITX 60
      * Define work field HC Qualification
     C                     MOVEL*BLANK    WUB0ST  1
      * Define work field HC Class Type
     C                     MOVEL*BLANK    WUFBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDF4PC           CCT Std Yield
     C                     Z-ADD*ZERO     WDG5PR           CCT Base /Live
     C                     Z-ADD*ZERO     WDJPPR           CCT Base /Carc
     C                     Z-ADD*ZERO     WDG6PR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WDJQPR           CCT Lean Prem /
     C                     Z-ADD*ZERO     WDG7PR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WDJRPR           CCT Yield G/L /
     C                     Z-ADD*ZERO     WDJUPR           CCT Carc Val /L
     C                     Z-ADD*ZERO     WDJVPR           CCT Carc Val /C
     C                     Z-ADD*ZERO     WDG8PR           CCT Sort Dsc /L
     C                     Z-ADD*ZERO     WDJSPR           CCT Sort Dsc /C
     C                     Z-ADD*ZERO     WDG9PR           CCT Gross /Live
     C                     Z-ADD*ZERO     WDJTPR           CCT Gross /Carc
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field BOH Market Add/Deduct
     C                     Z-ADD*ZERO     WUAAPR  52
      * Define work field BOH Quote Price Type
     C                     MOVEL*BLANK    WUB3ST  2
      * Define work field BOH Quoted Base Mkt Price
     C                     Z-ADD*ZERO     WUALPR  52
      * Define work field BOH Commodity Market Code
     C                     MOVEL*BLANK    WUETCD  3
      * Define work field BOH Commodity Price Group
     C                     MOVEL*BLANK    WUEUCD  7
      * Define work field BOH Market Date Method
     C                     MOVEL*BLANK    WUJ5TX  3
      * Define work field PC Contract Code
     C                     MOVEL*BLANK    WUAKCD  5
      * Define work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    WUALCD  5
      * Define work field PO Option Code
     C                     MOVEL*BLANK    WUAICD  3
      * Define work field CMP Program Code
     C                     MOVEL*BLANK    WUAMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WFASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WFAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WFALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WFD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WFD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WFD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WFD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WFD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WFJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WFKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WFKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WFIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WFHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WFGANB           CW Year
     C                     Z-ADD*ZERO     WFGBNB           CW Week Number
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field CCC Commodity Mrkt Code
     C                     MOVEL*BLANK    WUE5CD  3
      * Define work field CCC Commodity Price Group
     C                     MOVEL*BLANK    WUE6CD  7
      * Define work field CCC Market Date Method
     C                     MOVEL*BLANK    WUJ9TX  3
      * Define work field CMP Market Add/Deduct
     C                     Z-ADD*ZERO     WUI1PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGTNNB           CCC Record
     C                     Z-ADD*ZERO     WGGAPR           CCC +/- Market
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field CMP Description
     C                     MOVEL*BLANK    WUA3TX 25
      * Define work field CMP Grading Type
     C                     MOVEL*BLANK    WUDLST  1
      * Define work field CMP Sort Basis
     C                     MOVEL*BLANK    WUDMST  1
      * Define work field CMP Carc Wgt Type
     C                     MOVEL*BLANK    WUDQST  2
      * Define work field CMP Std Lean Percent
     C                     Z-ADD*ZERO     WUAZPC  31
      * Define work field CMP Lean Factor
     C                     Z-ADD*ZERO     WUA0PC  31
      * Define work field CMP Optimal Row Nbr f/srt
     C                     MOVEL*BLANK    WUDTST  1
      * Define work field CMP Type
     C                     MOVEL*BLANK    WUF5ST  1
      * Define work field RS Record Status
     C                     MOVEL*BLANK    WUAJST  1
      * Define work field TH CM Base Mkt Price
     C                     Z-ADD*ZERO     WUAMPR  52
      * Define work field TH CM Market Price
     C                     Z-ADD*ZERO     WUB8PR  52
     C                     MOVEL'N'       W0PMT   1
      * Define local work field TH VC Gross Value /HD
     C                     Z-ADD*ZERO     YL0001  52
      *================================================================
     CSR         ZZEXIT    ENDSR
