// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for POOCXFR
// ?Date: 14.08.2025 Time: 03:38:18
// ?------------------------------------------------------------------------------------------------

//?Execute user function

CASE;

// IF PAR.EDI Function Sts USR is Error
IF PAR.EDI_Function_Sts_USR = 'E';

//?RMC 12/20/19  move to NEW dist list EDIPOERR
EXECUTE FUNCTION(RTV Alpha Value W/O Co RT) TYPE(RTVOBJ) FILE(PDKMREP)          AC1754635;
PARAMETER('EDIPOERR');
PARAMETER(LCL.Email_Address);
{
 //?USER: Initialize routine

 // PAR.System Value Alpha = CON.*BLANK
 PAR.System_Value_Alpha = *BLANK;

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

 QUIT;

}


// Retrieve message - 'Error occured for Trading Partner &1 Transaction Set Control &2. Contact the
LCL.Office_Message_USR = RTVMSG(USR3137);
PARAMETER(PAR.EDI_Trading_Partner_No);
PARAMETER(PAR.TRANS_SET_CONTROL_APLHA);
PARAMETER(PAR.EDI_Function_Sts_USR);
PARAMETER(PAR.EDI_In_Process_Sts_USR);

// Execute command - 'ESNDMAIL'
EXECUTE COMMAND(USR3136);
PARAMETER(LCL.Email_Address);
PARAMETER(LCL.Office_Message_USR);

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.ST02-TRANS SET CONTROL NU = CVTVAR(PAR.TRANS SET CONTROL APLHA)
PAR.ST02_TRANS_SET_CONTROL_NU = CVTVAR(PAR.TRANS_SET_CONTROL_APLHA);

EXECUTE FUNCTION(Eml EDI Purchase Ords RT) TYPE(RTVOBJ) FILE(ECP004)            AC1638218;
PARAMETER(PAR.ST02_TRANS_SET_CONTROL_NU);
PARAMETER(LCL.Company_Number);
PARAMETER(PAR.EDI_Trading_Partner_No);
{
 //?USER: Initialize routine

 //?**2/15/18 SZ Added code to send Reinhart and WoodFrutticher to the
 //?          global FoodService email address.
 //?**12/20/17 SZ Added code to read ShipTo Interchange to get ShipTo cust
 //?          and the email address to go with that shipto. It was requested
 //?          That certain shipto 67th St BBQ orders be sent to a group
 //?          email addy.
 //?          Added ship to DUNS parm to the PRT Purchase Order PF
 //?**7/26/16 SZ Added code to block Dailys emails.  They do not want to see
 //?          any emails now that all POs are going to M3.
 //?**7/1/16 SZ Added code to send SYSCO foods emails to one global address
 //?**9/4/14 SZ Replaced email addys with EDI support email addy
 //?**9/4/14 SZ Added Trade Partner Code to subject line for EDI Support email
 //?**6/10/14 SZ Rmvd Scott Lam and added Leanne Ramsey to error messages.
 //?**6/02/14 SZ added the word TEST to the msg comment. Recompiled for fields
 //?**  added to ECP004
 //?**4/24/14 SZ Shortened Purchase order to PO in the error message email
 //?**9/23/13 SZ crt new err msg to show TP with Control #.
 //?**9/19/13 SZ Added Scott to the Purchase ord hdr not found message.
 //?**8/02/13 SZ Chgd company number parm in the record not found
 //?* routine from LCL to PAR.
 //?USER: Processing if Data record not found

 // LCL.Text Usr 50 = CONCAT(CON.edisupport@seaboardfoods.,CON.com,CON.*ZERO)
 LCL.Text_Usr_50 = 'edisupport@seaboardfoods.' + 'com' (*ZERO);

 // LCL.Email Address = LCL.Text Usr 50
 LCL.Email_Address = LCL.Text_Usr_50;

 // Retrieve message - 'EDI-Purchase Order Header not found for &1.'
 LCL.Office_Message_USR = RTVMSG(USR4421);
 PARAMETER(PAR.ST02_TRANS_SET_CONTROL_NU);

 // Execute command - 'ESNDMAIL'
 EXECUTE COMMAND(USR4641);
 PARAMETER(LCL.Email_Address);
 PARAMETER(LCL.Office_Message_USR);
 PARAMETER(PAR.EDI_Trading_Partner_No);

 //?USER: Process Data record

 // Call program Prt Purchase Order    PF.
 CALL PROGRAM(Prt Purchase Order    PF) ('PON7PFR');
 PARAMETER(DB1.ST02_TRANS_SET_CONTROL_NU);
 PARAMETER(DB1.G7601_QUANTITY_ORDERED);
 PARAMETER(DB1.G7603_WEIGHT_ORDERED);
 PARAMETER(DB1.G7608_ORDER_AMOUNT);
 PARAMETER(LCL.Email_Address);
 PARAMETER(LCL.Ship_To_Name);
 PARAMETER(LCL.Email_PO_Error);
 PARAMETER(LCL.EDI_Shipto_Duns_Number);

 //?Customer information not found send email to EDI Support
 CASE;

 // IF LCL.Email Address is Blank
 IF LCL.Email_Address = *BLANK;

 // LCL.Customer Comment Line = CONCAT(LCL.Ship To Name,CON.PO:,CON.1)
 LCL.Customer_Comment_Line = LCL.Ship_To_Name + 'PO:' (1);

 // LCL.Customer Comment Line = CONCAT(LCL.Customer Comment Line,DB1.G5003-PURCHASE ORDER NUMB,CON.1
 LCL.Customer_Comment_Line = LCL.Customer_Comment_Line + DB1.G5003_PURCHASE_ORDER_NUMB (1);

 // LCL.Customer Comment Line = CONCAT(LCL.Customer Comment Line,CON.CUSTOMER NOT FOUND,CON.1)
 LCL.Customer_Comment_Line = LCL.Customer_Comment_Line + 'CUSTOMER NOT FOUND' (1);

 EXECUTE FUNCTION(RTV Alpha Value W/O Co RT) TYPE(RTVOBJ) FILE(PDKMREP)          AC1754635;
 PARAMETER('EDIPOERR');
 PARAMETER(LCL.Text_Usr_50);
 {
  //?USER: Initialize routine

  // PAR.System Value Alpha = CON.*BLANK
  PAR.System_Value_Alpha = *BLANK;

  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

 }

 // Execute command - 'ESNDMAIL'
 EXECUTE COMMAND(USR3109);
 PARAMETER(LCL.Text_Usr_50);
 PARAMETER('PON7PFR$');
 PARAMETER(LCL.Customer_Comment_Line);
 PARAMETER(*YES);

 //?Customer information not found send email to EDI Support
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?E15257 JJH 07/24/19 - Add Gordon Foods to Group Email
 //?If Foods iTrade/SYSCO, or Frutticher, or Reinhar send to their group email
 CASE;

 // IF PAR.EDI Trading Partner No. is SYSCO Foods
 IF PAR.EDI_Trading_Partner_No = 'SYSCO';

 // OR PAR.EDI Trading Partner No. is Wood Frutticher
 OR PAR.EDI_Trading_Partner_No = 'WOODFR';

 // OR PAR.EDI Trading Partner No. is ReinhartFS
 OR PAR.EDI_Trading_Partner_No = 'REINHT';

 // OR PAR.EDI Trading Partner No. is Gordon Foods
 OR PAR.EDI_Trading_Partner_No = 'GORDON';

 // LCL.Customer Comment Line = CONCAT(LCL.Email Address,CON.PO:,CON.1)
 LCL.Customer_Comment_Line = LCL.Email_Address + 'PO:' (1);

 // LCL.Customer Comment Line = CONCAT(LCL.Customer Comment Line,DB1.G5003-PURCHASE ORDER NUMB,CON.*
 LCL.Customer_Comment_Line = LCL.Customer_Comment_Line + DB1.G5003_PURCHASE_ORDER_NUMB (0);

 // LCL.Customer Comment Line = CONCAT(LCL.Customer Comment Line,PAR.EDI Trading Partner No.,CON.1)
 LCL.Customer_Comment_Line = LCL.Customer_Comment_Line + PAR.EDI_Trading_Partner_No (1);

 // LCL.Text Usr 50 = CONCAT(CON.foodsvcorders@seaboardfoo,CON.ds.com,CON.*ZERO)
 LCL.Text_Usr_50 = 'foodsvcorders@seaboardfoo' + 'ds.com' (*ZERO);

 // Execute command - 'ESNDMAIL'
 EXECUTE COMMAND(USR3109);
 PARAMETER(LCL.Text_Usr_50);
 PARAMETER('PON7PFR$');
 PARAMETER(LCL.Customer_Comment_Line);
 PARAMETER(*NO);

 //?If Foods iTrade/SYSCO, or Frutticher, or Reinhar send to their group email
 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF PAR.EDI Trading Partner No. is SYSCO Dailys
 IF PAR.EDI_Trading_Partner_No = 'DSYSCO';

 // IF *OTHERWISE
 IF *OTHERWISE;

 //?Check to see if this is a 67th street BBQ customer.
 //?If there is an alternate customer #, need to send this email to the alt
 //?sales person that is not 67th BBQ. And also send to the 67th BBQ sales per
 // Call program Rtv ST Cust by DUNS   XF.
 CALL PROGRAM(Rtv ST Cust by DUNS   XF) ('PUC9XFR');
 PARAMETER(LCL.EDI_ShipTo_Customer);
 PARAMETER(LCL.EDI_Shipto_Duns_Number);
 PARAMETER(WRK.EDI_Alt_ST_Cust_Number);
 PARAMETER(NLL.EDI_Email_Address);

 CASE;

 // IF PGM.*Return code is *Record does not exist
 IF PGM.*Return_code = 'Y2U0005';

 // IF *OTHERWISE
 IF *OTHERWISE;

 CASE;

 // IF WRK.EDI Alt ST Cust Number is Greater than zero
 IF WRK.EDI_Alt_ST_Cust_Number > 0;

 EXECUTE FUNCTION(RTV Sales rte by Cust  RT) TYPE(RTVOBJ) FILE(CAEOREP)          AC2097992;
 PARAMETER(WRK.EDI_Alt_ST_Cust_Number);
 PARAMETER(WRK.Sales_Route_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(RTV Salesman Code      RT) TYPE(RTVOBJ) FILE(PDJEREP)          AC1284971;
 PARAMETER(WRK.Sales_Route_Code);
 PARAMETER(WRK.Salesperson_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv Email/EDI Sts 3    RT) TYPE(RTVOBJ) FILE(PDNFREP)          AC1644428;
 PARAMETER(WRK.Salesperson_Code);
 PARAMETER(WRK.Email_Address);
 PARAMETER(WRK.EDI_Status_3);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // LCL.Customer Comment Line = CONCAT(LCL.Ship To Name,CON.PO:,CON.1)
 LCL.Customer_Comment_Line = LCL.Ship_To_Name + 'PO:' (1);

 // LCL.Customer Comment Line = CONCAT(LCL.Customer Comment Line,DB1.G5003-PURCHASE ORDER NUMB,CON.1
 LCL.Customer_Comment_Line = LCL.Customer_Comment_Line + DB1.G5003_PURCHASE_ORDER_NUMB (1);

 // Execute command - 'ESNDMAIL'
 EXECUTE COMMAND(USR3109);
 PARAMETER(WRK.Email_Address);
 PARAMETER('PON7PFR$');
 PARAMETER(LCL.Customer_Comment_Line);
 PARAMETER(*NO);

 ENDIF;

 ENDIF;

 // LCL.Customer Comment Line = CONCAT(LCL.Ship To Name,CON.PO:,CON.1)
 LCL.Customer_Comment_Line = LCL.Ship_To_Name + 'PO:' (1);

 // LCL.Customer Comment Line = CONCAT(LCL.Customer Comment Line,DB1.G5003-PURCHASE ORDER NUMB,CON.1
 LCL.Customer_Comment_Line = LCL.Customer_Comment_Line + DB1.G5003_PURCHASE_ORDER_NUMB (1);

 // Execute command - 'ESNDMAIL'
 EXECUTE COMMAND(USR3109);
 PARAMETER(LCL.Email_Address);
 PARAMETER('PON7PFR$');
 PARAMETER(LCL.Customer_Comment_Line);
 PARAMETER(*NO);

 ENDIF;

 ENDIF;

 //?W82895 DN 08/18/21-Commented Out. EDI Support No Longer Needs It.
 ENDIF;

}


ENDIF;

