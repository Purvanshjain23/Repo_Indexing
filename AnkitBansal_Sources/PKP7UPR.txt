/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  PKP7UPR                                       */
/*  PROGRAM NAME:    ACCEPT BOL TRUCK SCALE WEIGHT FROM THE WEDGE  */
/*  PROGRAMMER:      ROSE CENTONZE                                 */
/*  CREATE DATE:     01/14/99                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL IS CALL FROM AN RPG PGM WHERE THE     */
/*                   USER ENTER THE IN/OUT AND THE MOVEMENT        */
/*                   NUMBER BEING PROCESSED.                       */
/*                                                                 */
/*  ##CMP  - COMPANY HEADING                                       */
/*  #1HONB - COMPANY NUMBER                                        */
/*  #1ABCD - PRODUCER CODE                                         */
/*  #1AECD - PRODUCER LOCATION CODE                                */
/*  #1BOMV - MOVEMENT NUMBER                                       */
/*  #1SRST - WEIGHT TYPE                                           */
/*  #DJPTX - WEIGHT TYPE DESCRIPTION                               */
/*  #1BOSW - SCALE WEIGHT -- NON DISPLAY, OUTPUT                   */
/*  WEIGHT - SCALE WEIGHT    I/O FROM THE WEDGE                    */
/*  EXTWGT - EXTERNAL WEIGHTMENT                                   */
/*  SCLWRK - SCALE WORKING STATUS                                  */
/*                                                                 */
/*******************************************************************/
/*  Modification History                                           */
/*                                                                 */
/* 01/26/04 PKD WE ARE GOING TO ACCEPT ZERO WEIGHT FROM THE SCALE. */
/*      PKD001  WE ARE NOT GOING TO WEIGH THE TRUCKS ON THE SCALE  */
/*              NOW, BUT WE STILL WANT TO KNOW WHEN THE TRUCK      */
/*              ARRIVES AND DEPARTS THE PLANT.                     */
/*                                                                 */
/* 03/19/04 SLM WE ARE GOING TO ACCEPT ZERO WEIGHT FROM THE SCALE. */
/*              IF SCALE IS NOT WORKING                            */
/*                                                                 */
/* 12/17/20 ISE H16853 - BUY ORDER NUMBER LENGTH CHANGES FROM 5 TO */
/*              7.                                                 */
/*                                                                 */
/*  3/10/21 JBB H16853 - Increase BOLW Movement Number field from  */
/*                       7 to 9 digits. Changed parameter &#DKVA1  */
/*                       to &#DB9NZ for increase in field size.    */
/*                                                                 */
/*******************************************************************/
             PGM        PARM(&#1HONB &#1ABCD &#1AECD &#1BOMV &#1SRST +
           &#DJPTX &#DB9NZ &XKILLDTE &CMP &STS &SRTYPE &SCLWRK)
/*  JBB        was &#DKVA1                                         */

             DCL        VAR(&CMP) TYPE(*CHAR) LEN(40)
             DCL        VAR(&SRTYPE) TYPE(*CHAR) LEN(1)
             DCL        VAR(&KILLDTE) TYPE(*DEC) LEN(7 0)
             DCL        VAR(&LDNUM) TYPE(*CHAR) LEN(5)
             DCL        VAR(&LDNUMN) TYPE(*DEC) LEN(5 0)
  /*         DCL        VAR(&ORNUM) TYPE(*CHAR) LEN(5)         H16853 */
  /*         DCL        VAR(&ORNUMN) TYPE(*DEC) LEN(5 0)       H16853 */
             DCL        VAR(&ORNUM) TYPE(*CHAR) LEN(7)      /* H16853 */
             DCL        VAR(&ORNUMN) TYPE(*DEC) LEN(7 0)    /* H16853 */
             DCL        VAR(&SCLWRK) TYPE(*CHAR) LEN(1)
             DCL        VAR(&STS) TYPE(*CHAR) LEN(1)
             DCL        VAR(&WGT) TYPE(*CHAR) LEN(8)
             DCL        VAR(&WGTN) TYPE(*DEC) LEN(7 1)
             DCL        VAR(&XKILLDTE) TYPE(*CHAR) LEN(7)
/*  JBB      DCL        VAR(&#1BOMV) TYPE(*DEC) LEN(7 0)       H16853 */
             DCL        VAR(&#1BOMV) TYPE(*DEC) LEN(9 0)    /* H16853 */

             DCLF       FILE(PKP7UPR#)

             CHGVAR     VAR(&KILLDTE) VALUE(&XKILLDTE)
             CHGVAR     VAR(&##CMP) VALUE(&CMP)
             CHGVAR     VAR(&##PGM) VALUE('PKP7UPR')

             RTVJOBA    JOB(&##JOB) USER(&##USR)

  RCVF:
             SNDRCVF    RCDFMT(#RCDDTL1) WAIT(*NO)
             WAIT
             MONMSG     MSGID(CPF0889) EXEC(DO)
                 GOTO       CMDLBL(ENDPGM)
             ENDDO
 /*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/
 /*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/
 /*               COMMAND KEY PROCESSING                           */
 /*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/
 /*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

     IF COND(&IN03 *EQ '1') THEN(DO)
             GOTO ENDPGM
     ENDDO

     IF COND(&IN22 *EQ '1') THEN(DO)
             CHGVAR     VAR(&WGT) VALUE(%SST(&WEIGHT 2 9))
             IF COND(&WGT *NE '    ') THEN(DO)
                  CHGVAR     VAR(&WGTN) VALUE(&WGT)
                  ENDDO
             ELSE DO
                  CHGVAR     VAR(&WGTN) VALUE(0)
             ENDDO

             /* PKD001 */
/*           IF COND(&WGTN *EQ 0) THEN(DO) */
/*              CHGVAR VAR(&STS) VALUE('Y') */
/*              GOTO ENDPGM */
/*           ENDDO */
             /* SLM001: SCALE IS WORKING - DO NOT ACCEPT ZERO WEIGHT */
             IF  COND(&SCLWRK *EQ 'Y') THEN(DO)
                 IF COND(&WGTN *EQ 0) THEN(DO)
                     /*-SET ERROR STATUS TO YES AND GOTO ENDPGM-*/
                     CHGVAR VAR(&STS) VALUE('Y')
                     GOTO ENDPGM
                 ENDDO
             ENDDO

             /* PROCESS WEIGHT */
             CALL       PGM(PKQBXFR) PARM(' ' &#1HONB &#1ABCD +
                          &#1AECD &#1BOMV &#1SRST &WGT &KILLDTE +
                          &ORNUMN &LDNUMN &SCLWRK &SRTYPE)
             CALL       PGM(PKQEUPC) PARM(&WGTN &ORNUMN &LDNUMN) /* +
                          Display Window "Weight has been accepted" */
             GOTO CMDLBL(ENDPGM)
        ENDDO
     ELSE DO
             CHGVAR     VAR(&STS) VALUE('Y')
             GOTO       CMDLBL(ENDPGM)
     ENDDO

     IF COND(&IN25 *EQ '1') THEN(DO)
             DSPDOC     DOC(TRKSCL) FLR('GUY.IS/DOCHPE')
             GOTO       CMDLBL(RCVF)
     ENDDO
 /*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/
 ENDPGM:     ENDPGM
