/********************************************************************/
/*                                                                  */
/*  SYNOPSIS - CL PROGRAM FOR PRINTING PARENT CREDIT LIMIT LISTING  */
/*                                                                  */
/*  SYSTEM    - CROSS APPLICATION                                   */
/*  DATE      - 12/09/96                                            */
/*                                                                  */
/*      PARAMETERS RECEIVED:                                        */
/*         &APPLIC        -  APPLICATION CODE                       */
/*         &OUTQ          -  OUTPUT QUEUE                           */
/*         &HOLD          -  HOLD STATUS                            */
/*         &SAVE          -  SAVE STATUS                            */
/*         &COPYN         -  PASSED NUMBER OF COPIES                */
/*         &NIGHTQ        -  NIGHT JOB QUEUE                        */
/*                                                                  */
/********************************************************************/
 PDTXPCLP:   PGM        PARM(&RPTTYP &DOC &PCFMT &APPLIC &OUTQ &HOLD +
                          &SAVE &COPYN &NIGHTQ)
        DCL    &RPTTYP      *CHAR  (1)
        DCL    &DOC         *CHAR  (8)
        DCL    &DOC2        *CHAR  (10)
        DCL    &PCFMT       *CHAR  (3)
        DCL    &PCFMT2      *CHAR  (4)
        DCL    &PCFILE      *CHAR  (32)
        DCL    &LIBEXIST    *CHAR  (1)
        DCL    &APPLIC      *CHAR  (06)
        DCL    &OUTQ        *CHAR  (10)
        DCL    &HOLD        *CHAR  (04)
        DCL    &SAVE        *CHAR  (04)
        DCL    &COPYN       *DEC
        DCL    &NIGHTQ      *CHAR  (10)

        DCL    &COPY        *DEC   (2 0)
        DCL    &COMMAND     *CHAR  (512)

/* CONVERT PARAMETERS TO REQUIRED SIZE FOR PRINT FUNCTION                  */

             CHGVAR     VAR(&COPY)     VALUE(&COPYN)

/* INITILIZATION FOR DOWNLOAD */
             IF         COND(&DOC *NE ' ') THEN(DO)
             CHGVAR     VAR(&LIBEXIST) VALUE('N')
             ADDLIBLE   LIB(SEQUEL) POSITION(*LAST)
             MONMSG     MSGID(CPF2103) EXEC(CHGVAR VAR(&LIBEXIST) +
                          VALUE('Y'))
             CHGVAR     VAR(&DOC2) VALUE(&DOC)
             IF         COND(&PCFMT *EQ 'WKS') THEN(DO)
             CHGVAR     VAR(&PCFILE) VALUE(&DOC *TCAT '.WK4')
             ENDDO
             ELSE (DO)
             CHGVAR     VAR(&PCFILE) VALUE(&DOC *TCAT '.XLS')
             ENDDO
             CHGVAR     VAR(&PCFMT2) VALUE('*' *CAT &PCFMT)
             CLRPFM     FILE(POAFCPP)
             ENDDO

/* CALL PRINT FUNCTION USING CONVERTED VARIABLES                           */
             SBDPRTOVR  CMDVAR(&COMMAND) FILE(PDTXPFR$) OUTQ(&OUTQ) +
                          COPIES(&COPY) HOLD(&HOLD) SAVE(&SAVE)

             CALL       PGM(QCMDEXC) PARM(&COMMAND 512)

 CALL:       CALL       PGM(PDTXPFR) PARM(' ' &RPTTYP &DOC)

/* CREATE DOWNLOAD FILE */
             IF         COND(&DOC *NE ' ') THEN(DO)
             EXECUTE SQL('SELECT +
                          AFBTC7 COLHDG("PARENT" "NUMBER"),+
                          AFSYTX COLHDG("PARENT" "NAME"),+
                          AFBAAA COLHDG("PARENT" "TYPE"),+
                          AFDUC7 COLHDG("A/R" "NUMBER"),+
                          AFAQTX COLHDG("A/R" "NAME"),+
                          AFBBAA COLHDG("A/R" "TYPE"),+
                          AFS2NB COLHDG("CREDIT" "LIMIT"),+
                          AFVPVA COLHDG("YTD" "NET SALES"),+
                          AFVQVA COLHDG("PRIOR YEAR" "NET SALES") +
                          FROM POAFCPP') +
                          TOFLR(GUY.IS) +
                          TODOC(&DOC) +
                          PCFMT(&PCFMT2) +
                          REPLACE(*YES)

             CALL       PGM(FTPCLAIMS) PARM(&DOC2 &PCFILE)

             IF COND(&LIBEXIST *EQ 'N') THEN(DO)
                RMVLIBLE LIB(SEQUEL)
             ENDDO
             ENDDO

 ENDPGM:     ENDPGM
