// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKIJXFR
// ?Date: 14.08.2025 Time: 02:49:37
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// WRK.PPWS Company Number = CVTVAR(PAR.Company Number Alpha Usr)
WRK.PPWS_Company_Number = CVTVAR(PAR.Company_Number_Alpha_Usr);

// WRK.CW Year = CVTVAR(PAR.Year Alpha Usr)
WRK.CW_Year = CVTVAR(PAR.Year_Alpha_Usr);

// WRK.CW Week Number = CVTVAR(PAR.Week Number Alpha Usr)
WRK.CW_Week_Number = CVTVAR(PAR.Week_Number_Alpha_Usr);

// WRK.Week Start USR = CVTVAR(PAR.Date Alpha USR)
WRK.Week_Start_USR = CVTVAR(PAR.Date_Alpha_USR);

EXECUTE FUNCTION(Rtv Std Delv Sched    RT) TYPE(RTVOBJ) FILE(PKAMCPP)           AB1122828;
PARAMETER(WRK.PPWS_Company_Number);
PARAMETER(WRK.CW_Year);
PARAMETER(WRK.CW_Week_Number);
PARAMETER(WRK.Week_Start_USR);
{
 //?USER: Initialize routine

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PD_Producer_Code = *BLANK;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PL_Location_Code = *BLANK;

 //?USER: Process Data record

 EXECUTE FUNCTION(Rtv Producer Record   RT) TYPE(RTVOBJ) FILE(PKACREP)           AB1119700;
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(WRK.PD_Name);
 PARAMETER(WRK.PD_Production_Capacity);
 PARAMETER(WRK.PD_Std_Delv_Time);
 PARAMETER(WRK.PD_Std_Truck_Size);
 PARAMETER(WRK.PD_Freight_Exp_Paid_By);
 PARAMETER(WRK.PD_Fax_Status);
 PARAMETER(WRK.PD_VND_Address_Number);
 PARAMETER(WRK.PD_EDI_Trading_Partner_#);
 PARAMETER(WRK.PD_VND_Category);
 PARAMETER(WRK.SR_Source_Code);
 PARAMETER(WRK.HB_Buyer_Code);
 PARAMETER(WRK.Commission_Producer_Payee);
 PARAMETER(WRK.RS_User_Changed);
 PARAMETER(WRK.RS_Date_Changed);
 PARAMETER(WRK.RS_Time_Changed);
 PARAMETER(WRK.RS_Record_Status);
 PARAMETER(WRK.RS_Job);
 PARAMETER(WRK.RS_Program);
 PARAMETER(WRK.RS_User_Added);
 PARAMETER(WRK.RS_Date_Added);
 PARAMETER(WRK.RS_Time_Added);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?Only on Active Producers
 CASE;

 // IF WRK.RS Record Status is Active
 IF WRK.RS_Record_Status = 'A';

 CASE;

 // IF DB1.RS Record Status is Active
 IF DB1.RS_Record_Status = 'A';

 //?Only on Active Producer's Std Delivery
 CASE;

 // IF DB1.PSDS Effective Kill Date LE PAR.Week Start USR
 IF DB1.PSDS_Effective_Kill_Date <= PAR.Week_Start_USR;

 CASE;

 // IF DB1.PD Producer Code NE WRK.PD Producer Code
 IF DB1.PD_Producer_Code <> WRK.PD_Producer_Code;

 // OR DB1.PL Location Code NE WRK.PL Location Code
 OR DB1.PL_Location_Code <> WRK.PL_Location_Code;

 //?Clear Work Fields
 // WRK.PPP Mon Plan Head = CON.*ZERO
 WRK.PPP_Mon_Plan_Head = *ZERO;

 // WRK.PPP Tue Plan Head = CON.*ZERO
 WRK.PPP_Tue_Plan_Head = *ZERO;

 // WRK.PPP Wed Plan Head = CON.*ZERO
 WRK.PPP_Wed_Plan_Head = *ZERO;

 // WRK.PPP Thu Plan Head = CON.*ZERO
 WRK.PPP_Thu_Plan_Head = *ZERO;

 // WRK.PPP Fri Plan Head = CON.*ZERO
 WRK.PPP_Fri_Plan_Head = *ZERO;

 // WRK.PPP Sat Plan Head = CON.*ZERO
 WRK.PPP_Sat_Plan_Head = *ZERO;

 // WRK.PPP Sun Plan Head = CON.*ZERO
 WRK.PPP_Sun_Plan_Head = *ZERO;

 // WRK.PPP Week Head Est = CON.*ZERO
 WRK.PPP_Week_Head_Est = *ZERO;

 // WRK.PPWS Plan Head = CON.*ZERO
 WRK.PPWS_Plan_Head = *ZERO;

 // WRK.PD Producer Code = DB1.PD Producer Code
 WRK.PD_Producer_Code = DB1.PD_Producer_Code;

 // WRK.PL Location Code = DB1.PL Location Code
 WRK.PL_Location_Code = DB1.PL_Location_Code;

 //?From the Period Code, calculate the Weekly & Daily Head Planned
 CASE;

 // IF DB1.CP Period Code is Weekly
 IF DB1.CP_Period_Code = 'WK';

 // WRK.PPP Week Head Est = DB1.PSDS Head Est
 WRK.PPP_Week_Head_Est = DB1.PSDS_Head_Est;

 //?From the Period Code, calculate the Weekly & Daily Head Planned
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?PPWS Plan Head will be accumulated later when the Buy Orders
 //?are actually created.  Even if the Delivery Schedule indicates
 //?a certain day for delivery or daily, that day may not
 //?be a Kill Day.  The Calendar file in Order Management System
 //?indicates if that day is a Kill Day. (Kill Day Status)
 //?If Period = Individual Days, Daily, or Other
 CASE;

 // IF DB1.CP Period Code is Individual Days
 IF DB1.CP_Period_Code = 'ID';

 EXECUTE FUNCTION(Rtv Std Dlv Days      RT) TYPE(RTVOBJ) FILE(PKANCPP)           AB1122837;
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(DB1.PSDS_Effective_Kill_Date);
 PARAMETER(WRK.PPP_Mon_Plan_Head);
 PARAMETER(WRK.PPP_Tue_Plan_Head);
 PARAMETER(WRK.PPP_Wed_Plan_Head);
 PARAMETER(WRK.PPP_Thu_Plan_Head);
 PARAMETER(WRK.PPP_Fri_Plan_Head);
 PARAMETER(WRK.PPP_Sat_Plan_Head);
 PARAMETER(WRK.PPP_Sun_Plan_Head);
 {
  //?USER: Process Data record

  //?Monday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Monday
  IF DB1.PSDD_Delv_Day_Of_Week = 'MON';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Mon_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

  //?Tuesday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Tuesday
  IF DB1.PSDD_Delv_Day_Of_Week = 'TUE';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Tue_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

  //?Wednesday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Wednesday
  IF DB1.PSDD_Delv_Day_Of_Week = 'WED';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Wed_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

  //?Thursday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Thursday
  IF DB1.PSDD_Delv_Day_Of_Week = 'THU';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Thu_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

  //?Friday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Friday
  IF DB1.PSDD_Delv_Day_Of_Week = 'FRI';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Fri_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

  //?Saturday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Saturday
  IF DB1.PSDD_Delv_Day_Of_Week = 'SAT';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Sat_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

  //?Sunday
  CASE;

  // IF DB1.PSDD Delv Day Of Week is Sunday
  IF DB1.PSDD_Delv_Day_Of_Week = 'SUN';

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.PPP_Sun_Plan_Head = DB1.PSDD_Head_Est;

  ENDIF;

 }

 // PPP Week Head Est
 WRK.PPP_Week_Head_Est = ( ( ( ( ( WRK.PPP_Mon_Plan_Head + WRK.PPP_Tue_Plan_Head )
 + WRK.PPP_Wed_Plan_Head ) + WRK.PPP_Thu_Plan_Head ) + WRK.PPP_Fri_Plan_Head )                     +
 + WRK.PPP_Sat_Plan_Head ) + WRK.PPP_Sun_Plan_Head;

 //?If Period = Individual Days, Daily, or Other
 // IF *OTHERWISE
 IF *OTHERWISE;

 //?If Period = Daily
 CASE;

 // IF DB1.CP Period Code is Daily
 IF DB1.CP_Period_Code = 'DA';

 // WRK.PPP Mon Plan Head = DB1.PSDS Head Est
 WRK.PPP_Mon_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Tue Plan Head = DB1.PSDS Head Est
 WRK.PPP_Tue_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Wed Plan Head = DB1.PSDS Head Est
 WRK.PPP_Wed_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Thu Plan Head = DB1.PSDS Head Est
 WRK.PPP_Thu_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Fri Plan Head = DB1.PSDS Head Est
 WRK.PPP_Fri_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Sat Plan Head = DB1.PSDS Head Est
 WRK.PPP_Sat_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Sun Plan Head = DB1.PSDS Head Est
 WRK.PPP_Sun_Plan_Head = DB1.PSDS_Head_Est;

 // WRK.PPP Week Head Est = DB1.PSDS Head Est * CON.7 *
 WRK.PPP_Week_Head_Est = DB1.PSDS_Head_Est * 7;

 //?If Period = Daily
 // IF *OTHERWISE
 IF *OTHERWISE;

 EXECUTE FUNCTION(Rtv Cal Period per Yr RT) TYPE(RTVOBJ) FILE(PKAJREP)           AB1122861;
 PARAMETER(DB1.CP_Period_Code);
 PARAMETER(WRK.CP_Period_Per_Year);
 {
  //?USER: Processing if Data record not found

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.CP_Period_Per_Year = *ZERO;

  //?USER: Process Data record

  // *MO.VE             1183529*Bu = ilt. in functions
  PAR.CP_Period_Per_Year = DB1.CP_Period_Per_Year;

 }

 // WRK.PPP Week Head Est = DB1.PSDS Head Est * WRK.CP Period Per Year *
 WRK.PPP_Week_Head_Est = DB1.PSDS_Head_Est * WRK.CP_Period_Per_Year;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est / CON.52 *
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est / 52;

 ENDIF;

 ENDIF;

 ENDIF;

 //?If Weekly Head Estimate is > 0, continue processing ...
 CASE;

 // IF WRK.PPP Week Head Est is Greater then Zero
 IF WRK.PPP_Week_Head_Est > *ZERO;

 //?Crt BOH/BOL if Period is Daily or Individual Days
 CASE;

 // IF DB1.CP Period Code is Daily or Individual Days
 IF DB1.CP_Period_Code = 'DA'/'ID';

 EXECUTE FUNCTION(Rtv Dates             RT) TYPE(RTVOBJ) FILE(PKCFREP)           AB1106521;
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(WRK.CW_Mon_Date);
 PARAMETER(WRK.CW_Tue_Date);
 PARAMETER(WRK.CW_Wed_Date);
 PARAMETER(WRK.CW_Thu_Date);
 PARAMETER(WRK.CW_Fri_Date);
 PARAMETER(WRK.CW_Sat_Date);
 PARAMETER(WRK.CW_Sun_Date);
 {
  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 // WRK.PPP Week Head Est = CON.*ZERO
 WRK.PPP_Week_Head_Est = *ZERO;

 //?If Monday Planned Head
 CASE;

 // IF WRK.PPP Mon Plan Head NE WRK.Zero USR
 IF WRK.PPP_Mon_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Mon_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Mon_Plan_Head);
 PARAMETER(WRK.CW_Mon_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Mon Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Mon_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Mon Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Mon_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // WRK.PPP Mon Plan Head = CON.*ZERO
 WRK.PPP_Mon_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 //?If Tuesday Planned Head
 CASE;

 // IF WRK.PPP Tue Plan Head NE WRK.Zero USR
 IF WRK.PPP_Tue_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Tue_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Tue_Plan_Head);
 PARAMETER(WRK.CW_Tue_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Tue Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Tue_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Tue Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Tue_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PPP_Tue_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 //?If Wednesday Planned Head
 CASE;

 // IF WRK.PPP Wed Plan Head NE WRK.Zero USR
 IF WRK.PPP_Wed_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Wed_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Wed_Plan_Head);
 PARAMETER(WRK.CW_Wed_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Wed Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Wed_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Wed Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Wed_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PPP_Wed_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 //?If Thursday Planned Head
 CASE;

 // IF WRK.PPP Thu Plan Head NE WRK.Zero USR
 IF WRK.PPP_Thu_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Thu_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Thu_Plan_Head);
 PARAMETER(WRK.CW_Thu_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Thu Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Thu_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Thu Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Thu_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PPP_Thu_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 //?If Friday Planned Head
 CASE;

 // IF WRK.PPP Fri Plan Head NE WRK.Zero USR
 IF WRK.PPP_Fri_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Fri_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Fri_Plan_Head);
 PARAMETER(WRK.CW_Fri_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Fri Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Fri_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Fri Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Fri_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PPP_Fri_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 //?If Saturday Planned Head
 CASE;

 // IF WRK.PPP Sat Plan Head NE WRK.Zero USR
 IF WRK.PPP_Sat_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Sat_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Sat_Plan_Head);
 PARAMETER(WRK.CW_Sat_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Sat Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Sat_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Sat Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Sat_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PPP_Sat_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 //?If Sunday Planned Head
 CASE;

 // IF WRK.PPP Sun Plan Head NE WRK.Zero USR
 IF WRK.PPP_Sun_Plan_Head <> WRK.Zero_USR;

 // Call program VAL Kill Day    2 OMS XF.
 CALL PROGRAM(VAL Kill Day    2 OMS XF) ('PDWBXFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(WRK.CW_Sun_Date);
 PARAMETER(WRK.Invalid_Y_N_USR);

 CASE;

 // IF WRK.Invalid Y/N USR is No
 IF WRK.Invalid_Y_N_USR = 'N';

 // Call program Zzz BOH/BOL f/Pch Pln XF.
 CALL PROGRAM(Zzz BOH/BOL f/Pch Pln XF) ('PKK9XFR');
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Sun_Plan_Head);
 PARAMETER(WRK.CW_Sun_Date);

 // WRK.PPWS Plan Head = WRK.PPWS Plan Head + WRK.PPP Sun Plan Head
 WRK.PPWS_Plan_Head = WRK.PPWS_Plan_Head + WRK.PPP_Sun_Plan_Head;

 // WRK.PPP Week Head Est = WRK.PPP Week Head Est + WRK.PPP Sun Plan Head
 WRK.PPP_Week_Head_Est = WRK.PPP_Week_Head_Est + WRK.PPP_Sun_Plan_Head;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // *MO.VE             1183529*Bu = ilt. in functions
 WRK.PPP_Sun_Plan_Head = *ZERO;

 ENDIF;

 ENDIF;

 ENDIF;

 EXECUTE FUNCTION(Chg Run Log Header    CH) TYPE(CRTOBJ) FILE(PKAVCPP)           AA1100470;
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(DB1.PD_Producer_Code);
 PARAMETER(DB1.PL_Location_Code);
 PARAMETER(WRK.PPP_Week_Head_Est);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Mon_Plan_Head);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Tue_Plan_Head);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Wed_Plan_Head);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Thu_Plan_Head);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Fri_Plan_Head);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Sat_Plan_Head);
 PARAMETER(*ZERO);
 PARAMETER(WRK.PPP_Sun_Plan_Head);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER('A');
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*BLANK);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 // WRK.PPWS Sts = CND.Plan Generated
 WRK.PPWS_Sts = 'G';

 EXECUTE FUNCTION(Rtv/Chg Purch Pln Wk  RT) TYPE(RTVOBJ) FILE(PKAUCPP)           AB1122901;
 PARAMETER(PAR.PPWS_Company_Number);
 PARAMETER(PAR.CW_Year);
 PARAMETER(PAR.CW_Week_Number);
 PARAMETER(WRK.PPWS_Plan_Head);
 PARAMETER(WRK.PPWS_Sts);
 {
  //?USER: Process Data record

  // PAR.PPWS Plan Head = PAR.PPWS Plan Head + DB1.PPWS Plan Head
  PAR.PPWS_Plan_Head = PAR.PPWS_Plan_Head + DB1.PPWS_Plan_Head;

  EXECUTE FUNCTION(Chg Purchase Plan Wk  CH) TYPE(CHGOBJ) FILE(PKAUCPP)           AB1100448;
  PARAMETER(DB1.PPWS_Company_Number);
  PARAMETER(DB1.CW_Year);
  PARAMETER(DB1.CW_Week_Number);
  PARAMETER(DB1.PPWS_Head_Est);
  PARAMETER(PAR.PPWS_Plan_Head);
  PARAMETER(PAR.PPWS_Sts);
  PARAMETER(DB1.RS_User_Changed);
  PARAMETER(DB1.RS_Date_Changed);
  PARAMETER(DB1.RS_Time_Changed);
  PARAMETER(DB1.RS_Record_Status);
  PARAMETER(DB1.RS_Job);
  PARAMETER(DB1.RS_Program);
  PARAMETER(DB1.RS_User_Added);
  PARAMETER(DB1.RS_Date_Added);
  PARAMETER(DB1.RS_Time_Added);
  {
   //?USER: Processing before Data update

   EXECUTE FUNCTION(Rtv Change Stamp      IF) TYPE(EXCINTFUN)                      AB1100934;
   PARAMETER(DB1.RS_User_Changed);
   PARAMETER(DB1.RS_Date_Changed);
   PARAMETER(DB1.RS_Time_Changed);
   PARAMETER(DB1.RS_Job);
   PARAMETER(DB1.RS_Program);
   {
    //?Execute internal function

    // PAR.RS User Changed = JOB.*USER
    PAR.RS_User_Changed = JOB.*USER;

    // PAR.RS Date Changed = JOB.*Job date
    PAR.RS_Date_Changed = JOB.*Job_date;

    // PAR.RS Time Changed = JOB.*Job time
    PAR.RS_Time_Changed = JOB.*Job_time;

    // PAR.RS Job = JOB.*JOB
    PAR.RS_Job = JOB.*JOB;

    // PAR.RS Program = JOB.*PROGRAM
    PAR.RS_Program = JOB.*PROGRAM;

   }

  }

 }

 ENDIF;

 ENDIF;

 ENDIF;

 ENDIF;

 ENDIF;

}


