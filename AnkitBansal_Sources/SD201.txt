      *****************  RPG PROGRAM HEADING  ************************
     h option(*SRCSTMT:*NODEBUGIO)
      *
      * ENVIRONMENT: Pork Division
      * SYSTEM:      Margin Management
      * PROGRAM:     SD201 - Signal Demand: Item
      * PROGRAMMER:  Alice
      * CREATED:     12/27/07
      *
      * FUNCTION: This program builds the Item Master file.
      *
      *           It processes all records in the Item Default file that
      *           are either a Finished Goods or a Raw Material item.
      *
      ****************************************************************
      * MODIFICATIONS:
      ****************************************************************
      * Date      Programmer
      *
      * 04/17/08  LeAnne Ramsey
      *           Per Bryan Erickson at Signal Demand, we will now send
      *           WP=Work In Process Items.
      /eject
      ****************************************************************
      * FILE SPECIFICATIONS
      ****************************************************************
      *
     Fombyrel1  if   e           k disk
      *   Item default
      *
      *
     Fpocnrel3  if   e           k disk
      *   Production line/Item structure
      *
      *
     Fsdp201    o    e           k disk
      *    Signal Demand: Item
      *
      /EJECT
      ****************************************************************
      * DEFINITION SPECIFICATIONS
      ****************************************************************
      *
      *---------------------------------------------------------------
      *  Named Constants
      *---------------------------------------------------------------
      *
     D yes             c                   'Y'
     D no              c                   'N'
      *
      *---------------------------------------------------------------
      * Standalone fields
      *---------------------------------------------------------------
      *
     D wkcono          s                   like(cnaic3) inz(360)
      *
      *
      ****************************************************************
      * Data Structures
      ****************************************************************
      *
      *---------------------------------------------------------------
      * Standard program status data structure
      *---------------------------------------------------------------
      *    externally defined as UTPGFR (record format: PGMDSR)
     D pgmds         esds                  extname(utpgfr)
      *
      * The following is a dummy C-spec to keep the D-specs from
      * running over into the C-specs on the compile listing. It
      * serves no other purpose and can be deleted at any time.
      *
     C                   if        sdpgm = *blank
     C                   endif
      /EJECT
      ***************************************************************************************
      * Mainline
      ***************************************************************************************
      *
      * Process records in the Item Default file that are:
      *  1) Finished Good or
      *  2) Raw Material or
      *  3) Work in Process
      *
     C     *loval        setll     ombyrel1
      *
     C                   dou       *in90 = *on                                  Main do loop
     C                   read      ombyrel1                               90
     C                   if        *in90 = *off and                             If not EOF
     C                             (byn0cd = 'FG ' or byn0cd = 'RM ' or
     C                              byn0cd = 'WP ')
      *
     C                   z-add     byhgcd        ithgcd
      *
     C                   move      byn0cd        itn0cd
     C                   move      byavna        itavna
     C                   move      byhicd        ithicd
     C                   move      byhhcd        ithhcd
     C                   move      bylicd        itlicd
     C                   move      byfzst        itfzst
     C                   move      byavst        itavst
      *
     C                   z-add     byczwg        itczwg
     C                   z-add     byc0wg        itc0wg
     C                   z-add     byrinb        itrinb
     C                   z-add     byrhnb        itrhnb
     C                   z-add     byrgnb        itrgnb
      *
     C                   z-add     bychtm        itchtm
      *
     C                   move      byqzcd        itqzcd
     C                   move      byxwst        itxwst
     C                   move      byvmst        itvmst
      *
     C                   z-add     byswgh        itswgh
     C                   z-add     bypphe        itpphe
     C                   z-add     byaiwg        itaiwg
     C                   z-add     bycsnb        itcsnb
     C                   z-add     bya3wg        ita3wg
     C                   z-add     bychnb        itchnb
      *
     C                   move      byx5st        itx5st
      *
     C                   z-add     byblpr        itblpr
     C                   z-add     bybmpr        itbmpr
      *
     C                   move      byq8cd        itq8cd
     C                   move      byxrcd        itxrcd
     C                   move      bypcct        itpcct
      *
     C                   z-add     bybdnb        itbdnb
      *
     C                   move      bysust        itsust
     C                   move      bysvst        itsvst
     C                   move      bys4st        its4st
     C                   move      bys6st        its6st
     C                   move      bytcst        ittcst
     C                   move      byvsst        itvsst
      *
     C                   move      byx6st        itx6st
     C                   move      bylncd        itlncd
     C                   move      bylrcd        itlrcd
      *
      * Retrieve Production Department/Line from Production Line/Item Structure file.
      * Key: Item Structure Type/Group/Class/Company
      *
     C     key01         chain     pocnrel3                           92
     C                   if        *in92 = *off
     C                   move      cnr3cd        itr3cd
     C                   move      cnewaa        itewaa
     C                   else
     C                   move      byr3cd        itr3cd
     C                   endif
      *
     C                   write     itrec
     C                   clear                   itrec
      *
     C                   endif                                                  If not EOF
     C                   enddo                                                  Main do loop
      *
     C                   seton                                        lr
      /EJECT
      *---------------------------------------------------------------
      * Initialization subroutine
      *---------------------------------------------------------------
      *
     C     *inzsr        begsr
      *
      * Key lists
      *
     C     key01         klist
     C                   kfld                    itrgnb
     C                   kfld                    itrhnb
     C                   kfld                    itrinb
     C                   kfld                    wkcono
      *
     C                   endsr
      /EJECT
