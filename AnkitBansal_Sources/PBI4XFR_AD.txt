// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PBI4XFR
// ?Date: 14.08.2025 Time: 03:48:11
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?WI464 added od pallet type parm to get pallet wt for order's type
EXECUTE FUNCTION(RTV Itm BxID & Tares  RT) TYPE(RTVOBJ) FILE(PDIOREP)           AC1939974;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Item_Code);
PARAMETER(PAR.Box_Weight);
PARAMETER(PAR.Number_Cases_On_A_Pallet);
PARAMETER(PAR.Pallet_Tare_Weight);
PARAMETER(PAR.Box_iD);
{
 //?USER: Initialize routine

 // PAR.Unit Weight = CON.*ZERO
 PAR.Unit_Weight = *ZERO;

 // PAR.Pallet Tare Weight = CON.*ZERO
 PAR.Pallet_Tare_Weight = *ZERO;

 // PAR.Number Cases On A Pallet = CON.*ZERO
 PAR.Number_Cases_On_A_Pallet = *ZERO;

 // PAR.Box iD = CON.*ZERO
 PAR.Box_iD = *ZERO;

 //?USER: Process Data record

 // PAR.Unit Weight = CON.*ZERO
 PAR.Unit_Weight = *ZERO;

 EXECUTE FUNCTION(RTV Typ/Pk/UntWgt/Plt RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1601775;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Component_Item_Code);
 PARAMETER(PAR.Unit_Weight);
 PARAMETER(PAR.Number_Cases_On_A_Pallet);
 PARAMETER(PAR.Item_Type_Code);
 PARAMETER(PAR.Package_Type_Code);
 PARAMETER(PAR.Pallet_Tare_Weight);
 {
  //?USER: Processing if Data record not found

  // PGM.*Return code = CND.*Record does not exist
  PGM.*Return_code = 'Y2U0005';

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

  // PGM.*Return code = CND.*Normal
  PGM.*Return_code = *BLANK;

 }

 CASE;

 // IF PAR.Item Type Code is Packaging and Supplies
 IF PAR.Item_Type_Code = 'PS';

 // AND PAR.Package Type Code is Box
 AND PAR.Package_Type_Code = 'B';

 // PAR.Box iD = DB1.Component Item Code
 PAR.Box_iD = DB1.Component_Item_Code;

 QUIT;

 // IF *OTHERWISE
 IF *OTHERWISE;

 // PAR.Unit Weight = CON.*ZERO
 PAR.Unit_Weight = *ZERO;

 ENDIF;

}


CASE;

// IF PAR.OD Pallet Type is Blank
IF PAR.OD_Pallet_Type = *BLANK;

// IF *OTHERWISE
IF *OTHERWISE;

EXECUTE FUNCTION(Rtv Pallet Weight     RT) TYPE(RTVOBJ) FILE(PUB6CPP)           AC2209418;
PARAMETER(PAR.OD_Pallet_Type);
PARAMETER(PAR.Pallet_Tare_Weight);
{
 //?USER: Processing if Data record not found

 MOVE *ALL (To: PAR From: CON);

 //?USER: Process Data record

 MOVE *ALL (To: PAR From: DB1);

}


ENDIF;

