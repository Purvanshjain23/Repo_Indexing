     H/TITLE Prt Ord Prod Schedule PF  Print file
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Print report of file contents
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Print file
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISJHIGH
     H* Date          : 02/11/15  Time  : 15:42:07
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FPMEUCPL5IF  E           K        DISK
      * RSQ : WF OrderProd Schedule    PrG/Shp/Ddl/DdlT/Ld/Or/It
      *
     FPMEUCPL4IF  E           K        DISK
      * RSQ : WF OrderProd Schedule     PrGrp/Itm
      *
     FCAB0RELCIF  E           K        DISK
      * RSQ : Item Balance              Co/Whse/Item
      *
     FOPCOCPL1IF  E           K        DISK
      * RTV : Order Comment             Retrieval index       NV
      *
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FPMAYPFR$O   E             97     PRINTER
     F                                              KINFDS INFDS$
      * PRT: Prt Ord Prod Schedule PF  Print file
      *
     E                    UCT        40  1               CENTER TABLE
     E                    #L3         3  1
     E                    #L7         7  1
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@EUCPXV
      * WF OrderProd Schedule     PrGrp/Itm
      * Renamed input format fields
     I              EUNINY                          WANINY
     I              EUKEAA                          WAKEAA
     I              EUCOC3                          WACOC3
     I              EUKDAA                          WAKDAA
     I              EUSPDT                          WASPDT
     I              EUVQDT                          WAVQDT
     I              EUAPST                          WAAPST
     I              EUEXC7                          WAEXC7
     I              EUNJNY                          WANJNY
     I              EUTUT1                          WATUT1
     I              EUNKNY                          WANKNY
     I              EUSODT                          WASODT
     I              EUNLNY                          WANLNY
     I              EUEYC7                          WAEYC7
     I              EUS1NA                          WAS1NA
     I              EUPIQT                          WAPIQT
     I              EUTWT1                          WATWT1
     I              EURINY                          WARINY
     I              EUTIDT                          WATIDT
     I              EUTJDT                          WATJDT
     I              EUTNDT                          WATNDT
     I              EUTODT                          WATODT
     I              EUOLST                          WAOLST
     I              EUPLAA                          WAPLAA
     I              EUVTNY                          WAVTNY
     I              EUOQST                          WAOQST
     I              EUOSST                          WAOSST
     I              EUICN6                          WAICN6
     I              EUS0CD                          WAS0CD
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IINFDS$    E DSY2I$DSP
      * Printer file information data structure
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXDEX        DS
      * External date
     I                                        1   80XDEXDT
     I                                        1   40XDEY01
     I                                        1   20XDEX01
     I                                        3   40XDEX02
     I                                        5   80XDEY02
     I                                        5   60XDEX03
     I                                        7   80XDEX04
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: *Arrays
      * I :  Warehouse Code
     I                                        1   3 P1AJCD
      * I :  Company Number
     I                                    P   4   50P1AIC3
      * I :  Scheduled Ship Date
     I                                    P   6   90P1AODT
      * I :  Print Comments Usr
     I                                       10  10 P1ARST
      * I :  Report TypeSchWTrm/Bel SR
     I                                       11  11 P1ASST
     IP2PARM      DS
      * I :  Print HoldOvers Usr
     I                                        1   1 P2BLST
     IP3PARM      DS
      * I :  Next Production Day Usr
     I                                    P   1   40P3SRDT
     IP4PARM      DS
      * I :  Next Production Day Usr2
     I                                    P   1   40P4T3DT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AJCD    PARM           WP0001  3        Warehouse Code
     C           P1AIC3    PARM           WP0002  30       Company Number
     C           P1AODT    PARM           WP0003  70       Scheduled Ship
     C           P1ARST    PARM           WP0004  1        Print Comments
     C           P1ASST    PARM           WP0005  1        Report TypeSchW
     C           P2BLST    PARM           WP0006  1        Print HoldOvers
     C           P3SRDT    PARM           WP0007  70       Next Production
     C           P4T3DT    PARM           WP0008  70       Next Production
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Prt Ord Prod Schedule PF: Mainline
     C                     EXSR A0MAIN
      * Print headers then End of report format
     C                     EXSR Q0PRNT
     C                     WRITE$MENDRPT
      * Exit program
     C                     EXSR ZXEXPG
      * ------------------------------------------------------
      /EJECT
     CSR         A0MAIN    BEGSR
      *================================================================
      * Prt Ord Prod Schedule PF: Mainline
      *================================================================
      * Establish starting position
     C           *LOVAL    SETLL@EUCPX4                    *
      * Read first record with user selection
     C                     EXSR A3READ
     C           W0EOFA    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0AL1P  1        First page
     C                     MOVEL'Y'       W0AL00  1        OPS Company Num
     C                     MOVEL'Y'       W0AL01  1        OPS Warehouse
     C                     MOVEL'Y'       W0AL02  1        OPS Primal Grou
     C                     MOVEL'Y'       W0AL03  1        OPS Schedule Sh
     C                     MOVEL'Y'       W0AL04  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL05  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL06  1        OPS Load Id
     C                     MOVEL'Y'       W0AL07  1        OPS Order Numbe
     C                     MOVEL'Y'       W0AL08  1        OPS Item Code
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      * Print report body
     C           W0EOFA    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR A1PHDR
      * Print report detail line
     C                     EXSR A2PDTL
      * Read next record with user selection
     C                     EXSR A3READ
      * Print totals
     C                     EXSR A4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         A0EXIT    ENDSR
      /EJECT
     CSR         A1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0AL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP1P  1
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP00  1
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP01  1
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * Load key header format
     C                     MOVELEUKEAA    $CKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $CCOC3           OPS Company Num
     C                     MOVELEUKDAA    $CKDAA           OPS Warehouse
      * Load related totals format
     C                     MOVELEUKEAA    $LKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $LCOC3           OPS Company Num
     C                     MOVELEUKDAA    $LKDAA           OPS Warehouse
      * USER: Process before print of OPS Primal Group Code format
     C           8         MULT 1         WUXGNX           Count Records
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP02  1
      * PRTOBJ calls after print of OPS Primal Group Code format
      * Embedded PRTOBJ : Prt Sel Prod SchItmTotPO
     C                     EXSR UBSUBR                     Embedded PRTOBJ
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP03  1
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP04  1
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP05  1
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP06  1
     C                     END
      *
     C           W0AL07    IFEQ 'Y'
      * Load key header format
     C                     Z-ADDEUNINY    $ININY           OPS Sequence No
     C                     MOVEL*BLANK    $IT3T1           Usr Text 70 A
     C                     MOVELEUTUT1    $ITUT1           OPS Customer Na
     C                     Z-ADD*ZERO     $IJKNX           Count Ahead USR
     C                     MOVELEUKEAA    $IKEAA           OPS Primal Grou
     C                     Z-ADDEUNKNY    $INKNY           OPS Load Schedu
     C                     Z-ADDEUCOC3    $ICOC3           OPS Company Num
     C                     MOVELEUKDAA    $IKDAA           OPS Warehouse
     C                     Z-ADDEUSPDT    $ISPDT           OPS Schedule Sh
     C                     MOVELEUAPST    $IAPST           OPS Report Type
     C                     Z-ADDEUEXC7    $IEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $INJNY           OPS Load Id
     C                     Z-ADDEUSODT    $ISODT           OPS Deadline De
     C                     Z-ADDEUNLNY    $INLNY           OPS Deadline De
     C                     Z-ADDEUEYC7    $IEYC7           OPS Item Code
     C                     MOVELEUS1NA    $IS1NA           OPS Item Descri
     C                     Z-ADDEUPIQT    $IPIQT           OPS Quantity Or
     C                     MOVELEUTWT1    $ITWT1           OPS Sort Break
      * Load related totals format
     C                     MOVEL*BLANK    $KVTT1           Est Prd Ready T
     C                     Z-ADD*ZERO     $KK0DT           Product Complet
     C                     MOVEL*BLANK    $KT6T1           Flag Held Over
     C                     MOVEL*BLANK    $KULTX           Day of the Week
     C                     MOVELEUKEAA    $KKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $KCOC3           OPS Company Num
     C                     MOVELEUKDAA    $KKDAA           OPS Warehouse
     C                     Z-ADDEUEXC7    $KEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $KNJNY           OPS Load Id
     C                     Z-ADDEUNKNY    $KNKNY           OPS Load Schedu
     C                     Z-ADDEUSODT    $KSODT           OPS Deadline De
     C                     Z-ADD*ZERO     $KYBNB           Deadline Depart
     C                     Z-ADDEUNLNY    $KNLNY           OPS Deadline De
     C                     MOVEL*BLANK    $KUITX           USR Text 70
      * USER: Process before print of OPS Order Number format
      * Figure out the breaking on look ahead lines
     C                     Z-ADDWUXGNX    WUJKNX           Count Ahead USR
      * Susan mason check count ahead totals
      * Count the number of items for this break
     C                     Z-ADD00000     WUNVNY           Count Items Rec
      * Cnt Ord Prd Schedule  XF - WF OrderProd Schedule  * 
     C                     CALL 'PMA6XFR'              90  Cnt Ord Prd Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $IKEAA    WQ0001  6        OPS Primal Grou
     C                     PARM $ICOC3    WQ0002  30       OPS Company Num
     C                     PARM $IKDAA    WQ0003  3        OPS Warehouse
     C                     PARM $ISPDT    WQ0004  70       OPS Schedule Sh
     C                     PARM $IEXC7    WQ0005  70       OPS Order Numbe
     C                     PARM $INJNY    WQ0006  70       OPS Load Id
     C                     PARM $INKNY    WQ0007  50       OPS Load Schedu
     C                     PARM $ISODT    WQ0008  70       OPS Deadline De
     C                     PARM $INLNY    WQ0009  60       OPS Deadline De
     C           WUNVNY    PARM WUNVNY    WQ0010  50       Count Items Rec
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMA6XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  WUNVNY    WUJKNX           Count Ahead USR
      * order comments on invoice 1 line  if found
      * RTV First 70char       RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$ICOC3    WL0001           Company Number
     C                     Z-ADD$IEXC7    WL0002           Order Number
     C                     MOVEL'IN'      WL0003    P      Comment Type
     C                     MOVELYL0001    WL0004    P      USR Text 70
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    YL0001    P      USR Text 70
      * CASE: LCL.USR Text 70 is Blank
     C           YL0001    IFEQ *BLANK                     *IF
      * Do not count the invoice comment line field is blank
     C                     ELSE
      * CASE: *OTHERWISE
      * Do count the invoice comment line
     C                     ADD  00001     WUJKNX           Count Ahead USR
     C                     END                             *FI
      * Add 2 lines for total   data line and dash
     C                     ADD  00002     WUJKNX           Count Ahead USR
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Count Ahead USR is GT 80
      *   |- c2    : WRK.Page Control Usr is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUJKNX    IFGT 80                         *IF
     C           WUPGST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       W0NEWP           *new page flag
     C                     END                             *FI
     C                     Z-ADDWUJKNX    $IJKNX           Count Ahead USR
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP07  1
     C                     END
      *
     C           W0AL08    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0AP08  1
     C                     END
      *
      *================================================================
     CSR         A1EXIT    ENDSR
      /EJECT
     CSR         A2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADDEUNINY    $JNINY           OPS Sequence No
     C                     MOVELEUKEAA    $JKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $JCOC3           OPS Company Num
     C                     MOVELEUKDAA    $JKDAA           OPS Warehouse
     C                     MOVELEUAPST    $JAPST           OPS Report Type
     C                     Z-ADDEUEXC7    $JEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $JNJNY           OPS Load Id
     C                     MOVELEUTUT1    $JTUT1           OPS Customer Na
     C                     Z-ADDEUNKNY    $JNKNY           OPS Load Schedu
     C                     Z-ADDEUSODT    $JSODT           OPS Deadline De
     C                     Z-ADDEUNLNY    $JNLNY           OPS Deadline De
     C                     Z-ADDEUEYC7    $JEYC7           OPS Item Code
     C                     MOVELEUS1NA    $JS1NA           OPS Item Descri
     C                     Z-ADDEUSPDT    $JSPDT           OPS Schedule Sh
     C                     Z-ADDEUVQDT    $JVQDT           OPS Requested S
     C                     Z-ADDEUPIQT    $JPIQT           OPS Quantity Or
     C                     Z-ADD*ZERO     $JN1NY           OPS QTY SHIP PR
     C                     Z-ADDEUTNDT    $JTNDT           Production AgeD
     C                     MOVELEUTWT1    $JTWT1           OPS Sort Break
     C                     Z-ADDEURINY    $JRINY           Item Age Days
     C                     Z-ADDEUTIDT    $JTIDT           Production Ovr
     C                     Z-ADDEUTJDT    $JTJDT           Production Ovr
     C                     Z-ADDEUTODT    $JTODT           Production AgeD
     C                     MOVELEUOLST    $JOLST           OPS Print on De
     C                     MOVELEUPLAA    $JPLAA           OPS U/M Primary
     C                     Z-ADDEUVTNY    $JVTNY           OPS U/M Sequenc
     C                     MOVELEUOQST    $JOQST           OPS Status 1
     C                     MOVELEUOSST    $JOSST           OPS Status 2
     C                     Z-ADDEUICN6    $JICN6           Item Category N
     C                     MOVELEUS0CD    $JS0CD           Item Primal Sch
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0APDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         A2EXIT    ENDSR
      /EJECT
     CSR         A3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN EUCOC3    WZA001           OPS Company Num
     C                     Z-ADDEUCOC3    WZA001
     C           *LIKE     DEFN EUKDAA    WZA002           OPS Warehouse
     C                     MOVELEUKDAA    WZA002
     C           *LIKE     DEFN EUKEAA    WZA003           OPS Primal Grou
     C                     MOVELEUKEAA    WZA003
     C           *LIKE     DEFN EUSPDT    WZA004           OPS Schedule Sh
     C                     Z-ADDEUSPDT    WZA004
     C           *LIKE     DEFN EUSODT    WZA005           OPS Deadline De
     C                     Z-ADDEUSODT    WZA005
     C           *LIKE     DEFN EUNLNY    WZA006           OPS Deadline De
     C                     Z-ADDEUNLNY    WZA006
     C           *LIKE     DEFN EUNJNY    WZA007           OPS Load Id
     C                     Z-ADDEUNJNY    WZA007
     C           *LIKE     DEFN EUEXC7    WZA008           OPS Order Numbe
     C                     Z-ADDEUEXC7    WZA008
     C           *LIKE     DEFN EUEYC7    WZA009           OPS Item Code
     C                     Z-ADDEUEYC7    WZA009
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFA    OREQ '1'
     C                     READ @EUCPX4                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFA  1
      * Quit if no record read
     C           W0EOFA    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0AL00  1        OPS Company Num
     C                     MOVEL*BLANK    W0AL01  1        OPS Warehouse
     C                     MOVEL*BLANK    W0AL02  1        OPS Primal Grou
     C                     MOVEL*BLANK    W0AL03  1        OPS Schedule Sh
     C                     MOVEL*BLANK    W0AL04  1        OPS Deadline De
     C                     MOVEL*BLANK    W0AL05  1        OPS Deadline De
     C                     MOVEL*BLANK    W0AL06  1        OPS Load Id
     C                     MOVEL*BLANK    W0AL07  1        OPS Order Numbe
     C                     MOVEL*BLANK    W0AL08  1        OPS Item Code
     C           W0EOFA    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0AL00  1        OPS Company Num
     C                     MOVEL'Y'       W0AL01  1        OPS Warehouse
     C                     MOVEL'Y'       W0AL02  1        OPS Primal Grou
     C                     MOVEL'Y'       W0AL03  1        OPS Schedule Sh
     C                     MOVEL'Y'       W0AL04  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL05  1        OPS Deadline De
     C                     MOVEL'Y'       W0AL06  1        OPS Load Id
     C                     MOVEL'Y'       W0AL07  1        OPS Order Numbe
     C                     MOVEL'Y'       W0AL08  1        OPS Item Code
     C                     ELSE
      * Next record - Detect level breaks
     C           EUCOC3    IFNE WZA001                     OPS Company Num
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL00
     C                     END
     C           EUKDAA    IFNE WZA002                     OPS Warehouse
     C           W0AL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL01
     C                     END
     C           EUKEAA    IFNE WZA003                     OPS Primal Grou
     C           W0AL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL02
     C                     END
     C           EUSPDT    IFNE WZA004                     OPS Schedule Sh
     C           W0AL02    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL03
     C                     END
     C           EUSODT    IFNE WZA005                     OPS Deadline De
     C           W0AL03    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL04
     C                     END
     C           EUNLNY    IFNE WZA006                     OPS Deadline De
     C           W0AL04    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL05
     C                     END
     C           EUNJNY    IFNE WZA007                     OPS Load Id
     C           W0AL05    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL06
     C                     END
     C           EUEXC7    IFNE WZA008                     OPS Order Numbe
     C           W0AL06    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL07
     C                     END
     C           EUEYC7    IFNE WZA009                     OPS Item Code
     C           W0AL07    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0AL08
     C                     END
     C                     END
      *================================================================
     CSR         A3EXIT    ENDSR
      /EJECT
     CSR         A4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0AL08    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP08
     C                     END
      *
     C           W0AL07    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Order Number format
      * CASE: PAR.Scheduled Ship Date GT JOB.*Job date
     C           P1AODT    IFGT ##JDT                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * Order break add 1 to line counter
     C                     ADD  1         WUXGNX           Count Records
     C                     MOVELWUULTX    $KULTX           Day of the Week
     C                     Z-ADDWUYBNB    $KYBNB           Deadline Depart
     C                     MOVELWUT6T1    $KT6T1           Flag Held Over
      * RTV First 70char       RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD$KCOC3    WL0001           Company Number
     C                     Z-ADD$KEXC7    WL0002           Order Number
     C                     MOVEL'IN'      WL0003    P      Comment Type
     C                     MOVEL$KUITX    WL0004    P      USR Text 70
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $KUITX    P      USR Text 70
      * If comments  will be printed then add 1 line
      * CASE: CUR.USR Text 70 is Blank
     C           $KUITX    IFEQ *BLANK                     *IF
     C                     MOVEL'N'       WUHDSX           Display Ord Dtl
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUHDSX           Display Ord Dtl
     C                     ADD  1         WUXGNX           Count Records
     C                     END                             *FI
      * Print Order information add 1 to line counter
     C                     ADD  1         WUXGNX           Count Records
      * Print Order information dash line
     C                     ADD  1         WUXGNX           Count Records
     C                     MOVEL*BLANK    $KVTT1           Est Prd Ready T
      * Rtv ProdInfm          Rt - Load Header  * 
     C                     EXSR SERVGN
      * Build Est Product Ready Time from Product Completed Date
      * CASE: LCL.Product Complete Date is Entered
     C           YL0003    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    YL0005           Date (Alpha) US
     C                     MOVELYL0003    YL0005           Date (Alpha) US
     C                     MOVEL*BLANK    YL0006           Time Alpha usr
     C                     MOVELYL0004    YL0006           Time Alpha usr
      * Mov DteTme MM dd YY.etcXF - /UT Functions  * 
     C                     CALL 'PNI4XFR'              90  Mov DteTme MM d
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0005    WQ0015  7        Date (Alpha) US
     C                     PARM YL0006    WQ0016  6        Time Alpha usr
     C           WUT5TX    PARM *BLANK    WQ0017  2        Month (Char) US
     C           WUT6TX    PARM *BLANK    WQ0018  2        Day   (Char) US
     C           WUVQT1    PARM *BLANK    WQ0019  2        Century Usr TXT
     C           WUT4TX    PARM *BLANK    WQ0020  2        Year  (Char) US
     C           WUVDCD    PARM *BLANK    WQ0021  2        Hours  2A
     C           WUVECD    PARM *BLANK    WQ0022  2        Minutes  2A
     C           WUY6CD    PARM *BLANK    WQ0023  2        Seconds 2A
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PNI4XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * format date to field and underline field
      * mm/
     C                     Z-ADD*ZERO     ZQ      50
     C           WUT5TX    CAT  '/':ZQ    $KVTT1    P      Est Prd Ready T
      * dd
     C                     Z-ADD*ZERO     ZQ      50
     C           $KVTT1    CAT  WUT6TX:ZQ $KVTT1    P      Est Prd Ready T
      * /
     C                     Z-ADD*ZERO     ZQ      50
     C           $KVTT1    CAT  '/':ZQ    $KVTT1    P      Est Prd Ready T
      * year
     C                     Z-ADD*ZERO     ZQ      50
     C           $KVTT1    CAT  WUT4TX:ZQ $KVTT1    P      Est Prd Ready T
      * /
     C                     Z-ADD1         ZQ      50
     C           $KVTT1    CAT  '/':ZQ    $KVTT1    P      Est Prd Ready T
      * Hours
     C                     Z-ADD1         ZQ      50
     C           $KVTT1    CAT  WUVDCD:ZQ $KVTT1    P      Est Prd Ready T
      * :
     C                     Z-ADD*ZERO     ZQ      50
     C           $KVTT1    CAT  ':':ZQ    $KVTT1    P      Est Prd Ready T
      * min
     C                     Z-ADD*ZERO     ZQ      50
     C           $KVTT1    CAT  WUVECD:ZQ $KVTT1    P      Est Prd Ready T
     C                     END                             *FI
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert OPS Deadline Depart Date to display format
      * Convert date
     C           1000000   ADD  $KSODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VKSODT
     C                     MOVEL'0'       *IN79
     C           WUHDSX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$KKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP07
     C                     END
      *
     C           W0AL06    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP06
     C                     END
      *
     C           W0AL05    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP05
     C                     END
      *
     C           W0AL04    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP04
     C                     END
      *
     C           W0AL03    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP03
     C                     END
      *
     C           W0AL02    IFEQ 'Y'
      * USER: Process before print of OPS Primal Group Code format
     C                     Z-ADD*ZERO     WUNXNY           Count BrkItems
      * Cnt Ord Prd SchBreak  XF - WF OrderProd Schedule  * 
     C                     CALL 'PMA7XFR'              90  Cnt Ord Prd Sch
     C                     PARM *BLANK    W0RTN   7
     C                     PARM $LKEAA    WQ0024  6        OPS Primal Grou
     C           WUNXNY    PARM WUNXNY    WQ0025  50       Count BrkItems
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMA7XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     Z-ADDWUXGNX    WUJKNX           Count Ahead USR
     C                     ADD  WUNXNY    WUJKNX           Count Ahead USR
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$LKEYTTL
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP02
     C                     END
      *
     C           W0AL01    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP01
     C                     END
      *
     C           W0AL00    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0AP00
     C                     END
      *
     C           W0EOFA    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         A4EXIT    ENDSR
      /EJECT
     CSR         B0MAIN    BEGSR
      *================================================================
      * Prt Sel Prod SchItmTotPO: Mainline
      *================================================================
      * Prt Sel Prod SchItmTotPO: Initialise
     C                     EXSR ZBINIT
      * Declare restrictor key work fields
     C           *LIKE     DEFN WAKEAA    WQKB01           OPS Primal Grou
      * Define keylist
     C           KRSB      KLIST
     C                     KFLD           WQKB01           OPS Primal Grou
      * Setup key
     C                     MOVEL$CKEAA    WQKB01           OPS Primal Grou
      * Establish starting position
     C           KRSB      SETLL@EUCPXV                    *
      * Read first record with user selection
     C                     EXSR B3READ
     C           W0EOFB    IFNE '0'                        IF
     C                     ELSE
      * Request all headings
     C                     MOVEL'Y'       W0BL1P  1        First page
     C                     MOVEL'Y'       W0BL00  1        OPS Primal Grou
     C                     MOVEL'Y'       W0BL01  1        OPS Item Code
     C                     MOVEL'Y'       W0BL02  1        OPS Sequence No
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
      * Print report body
     C           W0EOFB    DOWEQ'0'                        DOW
      * Prepare heading formats for printing
     C                     EXSR B1PHDR
      * Print report detail line
     C                     EXSR B2PDTL
      * Read next record with user selection
     C                     EXSR B3READ
      * Print totals
     C                     EXSR B4PTOT
     C                     END                             WOD
     C                     END                             FI
      *================================================================
     CSR         B0EXIT    ENDSR
      /EJECT
     CSR         B1PHDR    BEGSR
      *================================================================
      * Prepare heading formats for printing
      *================================================================
     C           W0BL1P    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP1P  1
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
      * Load key header format
     C                     MOVELWAKEAA    $EKEAA           OPS Primal Grou
      * Load related totals format
     C                     MOVELWAKEAA    $HKEAA           OPS Primal Grou
     C                     MOVEL*BLANK    $HTCTX           Byte
     C                     Z-ADD*ZERO     $HXGNX           Count Records
     C                     Z-ADD*ZERO     $HPUQT           Total Amount 1
     C                     Z-ADD*ZERO     $HPVQT           Total Amount 2
     C                     Z-ADD*ZERO     $HPWQT           Total Amount 3
     C                     Z-ADD*ZERO     $HPXQT           Total Amount 4
     C                     Z-ADD*ZERO     $HQHQT           Total Amount 5
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP00  1
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
      * Load related totals format
     C                     MOVELWAKEAA    $GKEAA           OPS Primal Grou
     C                     MOVEL*BLANK    $GT6T1           Flag Held Over
     C                     Z-ADDWAEYC7    $GEYC7           OPS Item Code
     C                     MOVELWAS1NA    $GS1NA           OPS Item Descri
     C                     Z-ADD*ZERO     $GPYQT           Total Qty 1 3/0
     C                     Z-ADD*ZERO     $GPZQT           Total Qty 2 3/0
     C                     Z-ADD*ZERO     $GP0QT           Total Qty 3 3/0
     C                     Z-ADD*ZERO     $GP1QT           Total Qty 4 3/0
     C                     Z-ADD*ZERO     $GQGQT           Total Qty 5 3/0
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP01  1
     C                     END
      *
     C           W0BL02    IFEQ 'Y'
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BP02  1
     C                     END
      *
      *================================================================
     CSR         B1EXIT    ENDSR
      /EJECT
     CSR         B2PDTL    BEGSR
      *================================================================
      * Process detail record
      *================================================================
      * Load details format
     C                     Z-ADD*ZERO     $FZ7VA           Total Inv for C
     C                     Z-ADD*ZERO     $FMEQT           Total Quantity
     C                     Z-ADDWANINY    $FNINY           OPS Sequence No
     C                     MOVELWAKEAA    $FKEAA           OPS Primal Grou
     C                     Z-ADDWACOC3    $FCOC3           OPS Company Num
     C                     MOVELWAKDAA    $FKDAA           OPS Warehouse
     C                     Z-ADDWASPDT    $FSPDT           OPS Schedule Sh
     C                     Z-ADDWAVQDT    $FVQDT           OPS Requested S
     C                     MOVELWAAPST    $FAPST           OPS Report Type
     C                     Z-ADDWAEXC7    $FEXC7           OPS Order Numbe
     C                     Z-ADDWANJNY    $FNJNY           OPS Load Id
     C                     MOVELWATUT1    $FTUT1           OPS Customer Na
     C                     Z-ADDWANKNY    $FNKNY           OPS Load Schedu
     C                     Z-ADDWASODT    $FSODT           OPS Deadline De
     C                     Z-ADDWANLNY    $FNLNY           OPS Deadline De
     C                     Z-ADDWAEYC7    $FEYC7           OPS Item Code
     C                     MOVELWAS1NA    $FS1NA           OPS Item Descri
     C                     Z-ADDWAPIQT    $FPIQT           OPS Quantity Or
     C                     MOVELWATWT1    $FTWT1           OPS Sort Break
     C                     Z-ADDWARINY    $FRINY           Item Age Days
     C                     Z-ADDWATIDT    $FTIDT           Production Ovr
     C                     Z-ADDWATJDT    $FTJDT           Production Ovr
     C                     Z-ADDWATNDT    $FTNDT           Production AgeD
     C                     Z-ADDWATODT    $FTODT           Production AgeD
     C                     MOVELWAOLST    $FOLST           OPS Print on De
     C                     MOVELWAPLAA    $FPLAA           OPS U/M Primary
     C                     Z-ADDWAVTNY    $FVTNY           OPS U/M Sequenc
     C                     MOVELWAOQST    $FOQST           OPS Status 1
     C                     MOVELWAOSST    $FOSST           OPS Status 2
     C                     Z-ADDWAICN6    $FICN6           Item Category N
     C                     MOVELWAS0CD    $FS0CD           Item Primal Sch
      * Signal that format is now ready to print
     C                     MOVE 'Y'       W0BPDT  1
      * Call print routine
     C                     EXSR Q0PRNT
      *
      *================================================================
     CSR         B2EXIT    ENDSR
      /EJECT
     CSR         B3READ    BEGSR
      *================================================================
      * Read next record
      *================================================================
      * Hold current values
     C           *LIKE     DEFN WAKEAA    WZB001           OPS Primal Grou
     C                     MOVELWAKEAA    WZB001
     C           *LIKE     DEFN WAEYC7    WZB002           OPS Item Code
     C                     Z-ADDWAEYC7    WZB002
     C           *LIKE     DEFN WANINY    WZB003           OPS Sequence No
     C                     Z-ADDWANINY    WZB003
      * Read next record
     C           W0RSL     DOUEQ'Y'                        DOU
     C           W0EOFB    OREQ '1'
     C           KRSB      READE@EUCPXV                  90*
      * Transfer error indicator to EOF flag
     C                     MOVEL*IN90     W0EOFB  1
      * Quit if no record read
     C           W0EOFB    IFNE '1'                        IF
      * Select record unless user action states otherwise
     C                     MOVEL'Y'       W0RSL   1
     C                     END                             FI
     C                     END                             UOD
      *
      * Reset key level breaks
     C                     MOVEL*BLANK    W0BL00  1        OPS Primal Grou
     C                     MOVEL*BLANK    W0BL01  1        OPS Item Code
     C                     MOVEL*BLANK    W0BL02  1        OPS Sequence No
     C           W0EOFB    IFEQ '1'
      * End of file - Signal all level breaks
     C                     MOVEL'Y'       W0BL00  1        OPS Primal Grou
     C                     MOVEL'Y'       W0BL01  1        OPS Item Code
     C                     MOVEL'Y'       W0BL02  1        OPS Sequence No
     C                     ELSE
      * Next record - Detect level breaks
     C           WAKEAA    IFNE WZB001                     OPS Primal Grou
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL00
     C                     END
     C           WAEYC7    IFNE WZB002                     OPS Item Code
     C           W0BL00    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL01
     C                     END
     C           WANINY    IFNE WZB003                     OPS Sequence No
     C           W0BL01    OREQ 'Y'
      * Set on level break indicator
     C                     MOVEL'Y'       W0BL02
     C                     END
     C                     END
      *================================================================
     CSR         B3EXIT    ENDSR
      /EJECT
     CSR         B4PTOT    BEGSR
      *================================================================
      * Print report Totals
      *================================================================
      * Print level break totals as required
     C           W0BL02    IFEQ 'Y'
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP02
     C                     END
      *
     C           W0BL01    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Item Code format
      * add 2 lines
     C                     ADD  2         WUXGNX           Count Records
      * Susan mason check item totals
     C                     MOVELWUT6T1    $GT6T1           Flag Held Over
     C           WUZ7VA    ADD  *ZERO     $GPYQT           Total Qty 1 3/0
     C           WUMEQT    ADD  *ZERO     $GPZQT           Total Qty 2 3/0
      * this is the Make
      * This make is calculated
      * Calculate the make based on the sum of the item
      * CASE: WRK.Total Inv for Chk     USR LT WRK.Total Quantity Ship  U
     C           WUZ7VA    IFLT WUMEQT                     *IF
     C           WUMEQT    SUB  WUZ7VA    WUPJQT           Total Quantity
     C           WUPJQT    ADD  *ZERO     $GP0QT           Total Qty 3 3/0
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     $GP0QT           Total Qty 3 3/0
     C                     Z-ADD*ZERO     WUPJQT           Total Quantity
     C                     END                             *FI
     C           WUP2QT    ADD  *ZERO     $GP1QT           Total Qty 4 3/0
     C           WUQIQT    ADD  *ZERO     $GQGQT           Total Qty 5 3/0
      * Missi reported issue and found that we change the formula
      * but there is no formula on Day1 or Day2 just on the make
      * so the day 1 and da2 are summary totals only
     C                     ADD  WUP2QT    WUPXQT           Total Amount 4
     C                     ADD  WUQIQT    WUQHQT           Total Amount 5
      * Now accumulate to totals
     C                     ADD  WUZ7VA    WUPUQT           Total Amount 1
     C                     ADD  WUMEQT    WUPVQT           Total Amount 2
     C                     ADD  WUPJQT    WUPWQT           Total Amount 3
      * NOW ZERO OUT THE DETAIL ACCUMULATIONS
     C                     Z-ADD*ZERO     WUZ7VA           Total Inv for C
     C                     Z-ADD*ZERO     WUMEQT           Total Quantity
     C                     Z-ADD*ZERO     WUPJQT           Total Quantity
     C                     Z-ADD*ZERO     WUDWNX           Quantity Prod A
     C                     Z-ADD*ZERO     WUP2QT           Total Work Ahea
     C                     Z-ADD*ZERO     WUQIQT           Total Work Ahea
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 2
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Convert fields to external form
      * Convert OPS Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $GEYC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$GEYC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VGEYC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VGEYC7           CD7 Ext Numeric
     C                     END                             *FI
      * Print format
     C                     WRITE$GKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP01
      * USER: Process after print of OPS Item Code format
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     END
      *
     C           W0BL00    IFEQ 'Y'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Primal Group Code format
     C                     Z-ADDWUPUQT    $HPUQT           Total Amount 1
     C                     Z-ADDWUPVQT    $HPVQT           Total Amount 2
     C                     Z-ADDWUPWQT    $HPWQT           Total Amount 3
     C                     Z-ADDWUPXQT    $HPXQT           Total Amount 4
     C                     Z-ADDWUQHQT    $HQHQT           Total Amount 5
     C                     Z-ADD*ZERO     WUPUQT           Total Amount 1
     C                     Z-ADD*ZERO     WUPVQT           Total Amount 2
     C                     Z-ADD*ZERO     WUPWQT           Total Amount 3
     C                     Z-ADD*ZERO     WUPXQT           Total Amount 4
     C                     Z-ADD*ZERO     WUQHQT           Total Amount 5
      * Add 2 to count
     C                     ADD  2         WUXGNX           Count Records
      * Susan mason check primal group totals on print object
     C                     Z-ADDWUXGNX    $HXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * If there is not enough space on the
      * physical page for this format:
     C           @$PGL     SUB  @$CLN     @$WRK
     C           @$WRK     IFLE 4
      * Signal new page required
     C                     MOVE 'Y'       W0NEWP
      * Start new page
     C                     EXSR Q0PRNT
     C                     END
      * Print format
     C                     WRITE$HKEYTTL
     C                     END
      * Signal header format is no longer ready
     C                     MOVEL*BLANK    W0BP00
     C                     END
      *
     C           W0EOFB    IFEQ '1'
     C                     END
      *
      *================================================================
     CSR         B4EXIT    ENDSR
      /EJECT
     CSR         Q0PRNT    BEGSR
      *================================================================
      * Print report formats
      *================================================================
      * Select formats to print
     C                     EXSR Q1FSEL
      * Calculate length of formats selected for printing
     C                     EXSR Q2PLEN
      * Add column heading length to print length
     C                     ADD  W0COLN    W0FSUM
     C           W0NEWP    IFNE 'Y'
      * Signal overflow if requested headings would cause
      * detail format to start past the overflow line
     C           W0FSUM    IFGT W0OFL
     C                     MOVE 'Y'       W0NEWP
     C                     ELSE
      * Signal overflow if requested headings would cause
      * Detail format to be printed past end of page
     C                     ADD  W0DTLN    W0FSUM
     C           W0FSUM    IFGT W0PGL
     C                     MOVE 'Y'       W0NEWP
     C                     END
     C                     END
     C                     END
      * Print Standard report header of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
     C           W0NEWP    IFEQ 'Y'                        IF
     C                     EXSR Q3PTNP
     C                     END                             FI
      *
      * Print First Page Format of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP1P    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0AL1P
     C                     END                             FI
      * Print OPS Company Number of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP00    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP00
     C                     END                             FI
      * Print OPS Warehouse of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP01    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP01
     C                     END                             FI
      * Print OPS Primal Group Code of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP02    ANDEQ'P'
      * Print format
     C                     WRITE$CKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP02
     C                     END                             FI
      * Print First Page Format of Prt Sel Prod SchItmTotPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP1P    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP1P    ANDEQ'P'
      * Mention hidden format
     C   99N99             WRITE$D1STPAG
      * Reset format print flag
     C                     MOVE *BLANK    W0BP1P
      * Clear first page flag.
     C                     MOVE *BLANK    W0BL1P
     C                     END                             FI
      * Print OPS Primal Group Code of Prt Sel Prod SchItmTotPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP00    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP00    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Primal Group Code format
      * Line 12
     C           12        MULT 1         WUXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * Print format
     C                     WRITE$EKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0BCDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0BP00
     C                     END                             FI
      * Print OPS Item Code of Prt Sel Prod SchItmTotPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP01    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP01    ANDEQ'P'
      * USER: On print of OPS Item Code format
      * CASE: PAR.Scheduled Ship Date NE PAR.Next Production Day Usr
     C           P1AODT    IFNE P3SRDT                     *IF
      * on hand
      * RTV On Hand Qty       RT - Item Balance  * 
     C                     EXSR SCRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUDDQT           On Hand U/M1 Su
     C                     END                             *FI
     C                     Z-ADDWUDDQT    WUZ7VA           Total Inv for C
      * Reset format print flag
     C                     MOVE *BLANK    W0BP01
     C                     END                             FI
      * Print OPS Sequence No of Prt Sel Prod SchItmTotPO
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BP02    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BP02    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0BP02
     C                     END                             FI
      * Print Detail line. of Prt Sel Prod SchItmTotPO
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0BCDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0BPDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0BPDT    ANDEQ'P'
      * USER: On print of detail format
      * CASE: DB1.OPS Schedule Ship Date EQ PAR.Next Production Day Usr
     C           WASPDT    IFEQ P3SRDT                     *IF
     C                     ADD  WAPIQT    WUP2QT           Total Work Ahea
     C                     ELSE
      * CASE: DB1.OPS Schedule Ship Date EQ PAR.Next Production Day Usr2
     C           WASPDT    IFEQ P4T3DT                     *IF
     C                     ADD  WAPIQT    WUQIQT           Total Work Ahea
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WAPIQT    WUMEQT           Total Quantity
     C                     END                             *FI
     C                     END                             *FI
      * ship
      * was ne to ship date but now that future date is allowed must be l
      * CASE: DB1.OPS Schedule Ship Date LT PAR.Scheduled Ship Date
     C           WASPDT    IFLT P1AODT                     *IF
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     MOVEL'HO'      WUT6T1           Flag Held Over
      * Set On Indicator 03    US - /UT User Source  * 
     C                     SETON                     03    SETON INDICATOR
     C                     END                             *FI
      * Mention hidden format
     C   99N99             WRITE$FDTLRCD
      * Reset format print flag
     C                     MOVE *BLANK    W0BPDT
     C                     END                             FI
      * Print OPS Schedule Ship Date of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP03    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP03    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP03
     C                     END                             FI
      * Print OPS Deadline Depart Date of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP04    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP04    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP04
     C                     END                             FI
      * Print OPS Deadline Depart Time of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP05    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP05    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP05
     C                     END                             FI
      * Print OPS Load Id of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP06    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP06    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP06
     C                     END                             FI
      * Print OPS Order Number of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP07    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP07    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of OPS Order Number format
      * CASE: PAR.Scheduled Ship Date GT JOB.*Job date
     C           P1AODT    IFGT ##JDT                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * CLC Day of Week        XF - /UT Functions  * 
     C                     CALL 'PDXIXFR'              90  CLC Day of Week
     C                     PARM *BLANK    W0RTN   7
     C                     PARM EUSPDT    WQ0011  70       Date In
     C           WUULTX    PARM *BLANK    WQ0012  9        Day of the Week
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C           EUNLNY    DIV  100       WUYBNB           Deadline Depart
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
      * CASE: DB1.OPS Schedule Ship Date LT PAR.Scheduled Ship Date
     C           EUSPDT    IFLT P1AODT                     *IF
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
     C                     MOVEL'HO'      WUT6T1           Flag Held Over
      * Set On Indicator 02    US - /UT User Source  * 
     C                     SETON                     02    SETON INDICATOR
     C                     END                             *FI
      * CASE: PAR.Print Comments Usr is yes
     C           P1ARST    IFEQ 'Y'                        *IF
      * RTV First 70char       RT - Order Comment  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDEUCOC3    WL0001           Company Number
     C                     Z-ADDEUEXC7    WL0002           Order Number
     C                     MOVEL'PS'      WL0003    P      Comment Type
     C                     MOVEL$IT3T1    WL0004    P      USR Text 70
     C                     EXSR SDRVGN
      * Move subroutine local variables to output parameters.
     C                     MOVELWL0004    $IT3T1    P      USR Text 70
     C                     ADD  00001     WUXGNX           Count Records
     C                     END                             *FI
     C                     ADD  00002     WUXGNX           Count Records
     C                     ADD  00002     WUXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OPS Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $IEXC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$IEXC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VIEXC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VIEXC7           CD7 Ext Numeric
     C                     END                             *FI
     C                     MOVEL'0'       *IN79
     C           P1ARST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print format
     C                     WRITE$IKEYHDR
      * Set column headings flag
     C                     MOVE 'Y'       W0ACDT
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0AP07
     C                     END                             FI
      * Print OPS Item Code of Prt Ord Prod Schedule PF
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0AP08    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0AP08    ANDEQ'P'
      * Reset format print flag
     C                     MOVE *BLANK    W0AP08
     C                     END                             FI
      * Print Detail line. of Prt Ord Prod Schedule PF
      * If new page then set column headings active
     C           W0NEWP    IFEQ 'Y'
     C                     MOVE 'Y'       W0ACDT  1
     C                     END
      * If it is ready to print, then do so,
      * or if new page & print on new page selected &
      * active then set print format flag
     C           W0APDT    IFEQ 'Y'                        IF
     C           W0NEWP    OREQ 'Y'
     C           W0APDT    ANDEQ'P'
     C                     MOVEL'Y'       W0PFM
      * USER: On print of detail format
      * CASE: PAR.Scheduled Ship Date GT JOB.*Job date
     C           P1AODT    IFGT ##JDT                      *IF
     C                     MOVEL'N'       W0PFM            *Print format
     C                     END                             *FI
      * CUR = DB1 By name
     C                     Z-ADDEUNINY    $JNINY           OPS Sequence No
     C                     MOVELEUKEAA    $JKEAA           OPS Primal Grou
     C                     Z-ADDEUCOC3    $JCOC3           OPS Company Num
     C                     MOVELEUKDAA    $JKDAA           OPS Warehouse
     C                     MOVELEUAPST    $JAPST           OPS Report Type
     C                     Z-ADDEUEXC7    $JEXC7           OPS Order Numbe
     C                     Z-ADDEUNJNY    $JNJNY           OPS Load Id
     C                     MOVELEUTUT1    $JTUT1           OPS Customer Na
     C                     Z-ADDEUNKNY    $JNKNY           OPS Load Schedu
     C                     Z-ADDEUSODT    $JSODT           OPS Deadline De
     C                     Z-ADDEUNLNY    $JNLNY           OPS Deadline De
     C                     Z-ADDEUEYC7    $JEYC7           OPS Item Code
     C                     MOVELEUS1NA    $JS1NA           OPS Item Descri
     C                     Z-ADDEUSPDT    $JSPDT           OPS Schedule Sh
     C                     Z-ADDEUVQDT    $JVQDT           OPS Requested S
     C                     Z-ADDEUPIQT    $JPIQT           OPS Quantity Or
     C                     Z-ADDEUTNDT    $JTNDT           Production AgeD
     C                     MOVELEUTWT1    $JTWT1           OPS Sort Break
     C                     Z-ADDEURINY    $JRINY           Item Age Days
     C                     Z-ADDEUTIDT    $JTIDT           Production Ovr
     C                     Z-ADDEUTJDT    $JTJDT           Production Ovr
     C                     Z-ADDEUTODT    $JTODT           Production AgeD
     C                     MOVELEUOLST    $JOLST           OPS Print on De
     C                     MOVELEUPLAA    $JPLAA           OPS U/M Primary
     C                     Z-ADDEUVTNY    $JVTNY           OPS U/M Sequenc
     C                     MOVELEUOQST    $JOQST           OPS Status 1
     C                     MOVELEUOSST    $JOSST           OPS Status 2
     C                     Z-ADDEUICN6    $JICN6           Item Category N
     C                     MOVELEUS0CD    $JS0CD           Item Primal Sch
     C           EUPIQT    MULT 1         $JN1NY           OPS QTY SHIP PR
      * CLC Day of Week        XF - /UT Functions  * 
     C                     CALL 'PDXIXFR'              90  CLC Day of Week
     C                     PARM *BLANK    W0RTN   7
     C                     PARM EUSPDT    WQ0013  70       Date In
     C           WUULTX    PARM *BLANK    WQ0014  9        Day of the Week
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDXIXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     ADD  1         WUXGNX           Count Records
     C           W0PFM     IFEQ 'Y'
      * Convert fields to external form
      * Convert OPS Item Code to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           $JEYC7    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL$JEYC7    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    VJEYC7           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VJEYC7           CD7 Ext Numeric
     C                     END                             *FI
      * Convert OPS Schedule Ship Date to display format
      * Convert date
     C           1000000   ADD  $JSPDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VJSPDT
      * Convert Production AgeDte Fr to display format
      * Convert date
     C           1000000   ADD  $JTNDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VJTNDT
     C                     MOVEL'0'       *IN79
     C           ##USR     IFEQ @CN,001                    *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      * Print column headings if required
     C           W0ACDT    IFEQ 'Y'
     C                     WRITE$JCOLHDG
      * Clear column headings control flag
     C                     MOVE *BLANK    W0ACDT
     C                     END                             FI
      * Print format
     C                     WRITE$JDTLRCD
     C                     END                             FI
      *
      * Reset format print flag
     C                     MOVE *BLANK    W0APDT
     C                     END                             FI
      * Clear new page flag
     C                     MOVE *BLANK    W0NEWP
      *================================================================
     CSR         Q0EXIT    ENDSR
      /EJECT
     CSR         Q1FSEL    BEGSR
      *================================================================
      * Format select
      *================================================================
     C                     MOVEL*BLANK    W0SKP   1
      * Cascade skip to new page requests upwards
     C           W0AP02    IFEQ 'Y'
     C                     MOVEL'Y'       W0SKP
     C                     END
      * Request new page if required
     C           W0SKP     IFEQ 'Y'                        IF
     C                     MOVE 'Y'       W0NEWP
     C                     END                             FI
      *================================================================
     CSR         Q1EXIT    ENDSR
      /EJECT
     CSR         Q2PLEN    BEGSR
      *================================================================
      * Evaluate print length
      *================================================================
     C           *LIKE     DEFN @$CLN     W0FSUM
     C           *LIKE     DEFN @$CLN     W0DTLN
     C           *LIKE     DEFN @$CLN     W0COLN
     C                     Z-ADD@$CLN     W0FSUM
     C                     Z-ADD*ZERO     W0DTLN
     C                     Z-ADD*ZERO     W0COLN
      * * First Page Format of Prt Ord Prod Schedule PF
     C           W0AP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Company Number of Prt Ord Prod Schedule PF
     C           W0AP00    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Warehouse of Prt Ord Prod Schedule PF
     C           W0AP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Primal Group Code of Prt Ord Prod Schedule PF
     C           W0AP02    IFEQ 'Y'
     C                     ADD  1         W0FSUM
     C                     END                             FI
      *
      * * OPS Schedule Ship Date of Prt Ord Prod Schedule PF
     C           W0AP03    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Deadline Depart Date of Prt Ord Prod Schedule PF
     C           W0AP04    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Deadline Depart Time of Prt Ord Prod Schedule PF
     C           W0AP05    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Load Id of Prt Ord Prod Schedule PF
     C           W0AP06    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Order Number of Prt Ord Prod Schedule PF
     C           W0AP07    IFEQ 'Y'
     C                     ADD  3         W0FSUM
     C                     END                             FI
      *
      * * OPS Item Code of Prt Ord Prod Schedule PF
     C           W0AP08    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Ord Prod Schedule PF
     C           W0APDT    IFEQ 'Y'
     C                     Z-ADD1         W0DTLN
     C           W0ACDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      * * First Page Format of Prt Sel Prod SchItmTotPO
     C           W0BP1P    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Primal Group Code of Prt Sel Prod SchItmTotPO
     C           W0BP00    IFEQ 'Y'
     C                     ADD  4         W0FSUM
     C                     END                             FI
      *
      * * OPS Item Code of Prt Sel Prod SchItmTotPO
     C           W0BP01    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * OPS Sequence No of Prt Sel Prod SchItmTotPO
     C           W0BP02    IFEQ 'Y'
     C                     ADD  0         W0FSUM
     C                     END                             FI
      *
      * * Detail line. of Prt Sel Prod SchItmTotPO
     C           W0BPDT    IFEQ 'Y'
     C                     Z-ADD0         W0DTLN
     C           W0BCDT    IFEQ 'Y'
     C                     Z-ADD0         W0COLN
     C                     END                             FI
     C                     END                             FI
      *
      *================================================================
     CSR         Q2EXIT    ENDSR
      /EJECT
     CSR         Q3PTNP    BEGSR
      *================================================================
      * Format select
      *================================================================
      * USER: Process top of page
      * Top of page should be  6 print lines
      * Set On Indicator 01    US - /UT User Source  * 
     C                     SETON                     01    SETON INDICATOR
     C           6         MULT 1         WUXGNX           Count Records
      * TOP.Prd Schedule Addit TitUsr = Condition name of PAR.Report Type
     C                     CALL 'CARVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1905464   Y2LSNO  70       List number
     C                     PARM P1ASST    W0INVL 25        Report TypeSchW
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           $BT2T1    PARM           W0CNNM 25        Prd Schedule Ad
      *
     C                     Z-ADDP1AIC3    $BBNC3           Company
     C                     MOVELP1AJCD    $BAJCD           Warehouse Code
     C                     Z-ADDP1AODT    $BAODT           Scheduled Ship
     C                     Z-ADDP3SRDT    $BSRDT           Next Production
     C                     Z-ADDP4T3DT    $BT3DT           Next Production
      * Convert fields to external form
      * Convert Company to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           $BBNC3    IFNE 0                          *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL$BBNC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    VBBNC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    VBBNC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Scheduled Ship Date to display format
      * Convert date
     C           1000000   ADD  $BAODT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBAODT
      * Convert Next Production Day Usr to display format
      * Convert date
     C           1000000   ADD  $BSRDT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBSRDT
      * Convert Next Production Day Usr2 to display format
      * Convert date
     C           1000000   ADD  $BT3DT    XDINDT
     C                     EXSR XDVC2T
     C                     Z-ADDXDEXDT    VBT3DT
     C                     MOVEL'0'       *IN79
     C           WUB2SX    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     WRITE$APAGHDR
      * Clear page overflow indicator
     C                     SETOF                     97    *
      *================================================================
     CSR         Q3EXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSA01           Application Cod
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSA01           Application Cod
     C                     MOVEL'OMS'     WQSA01           Application Cod
      * Establish starting position
     C           KRSSA     SETLL@DNRESF                    *
     C           KRSSA     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           DNRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
     C           KRSSA     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN DNDNCD    WQSB01           Application Cod
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB01           Application Cod
      * Setup key
     C                     MOVELDNRSCD    WQSB01           Application Cod
      * Establish starting position
     C           KRSSB     SETLL@DNRESF                    *
     C           KRSSB     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELDNAUNA    WUAUNA           Description
     C           KRSSB     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV On Hand Qty       RT - Item Balance  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUDDQT           On Hand U/M1 Su
      * Declare restrictor key work fields
     C           *LIKE     DEFN B0AIC3    WQSC01           Company Number
     C           *LIKE     DEFN B0AJCD    WQSC02           Warehouse Code
     C           *LIKE     DEFN B0HGCD    WQSC03           Item Code
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
     C                     KFLD           WQSC02           Warehouse Code
     C                     KFLD           WQSC03           Item Code
      * Setup key
     C                     Z-ADDWACOC3    WQSC01           Company Number
     C                     MOVELWAKDAA    WQSC02           Warehouse Code
     C                     Z-ADDWAEYC7    WQSC03           Item Code
      * Establish starting position
     C           KRSSC     SETLL@B0REHD                    *
     C           KRSSC     READE@B0REHD                  90*
      * Data record not found
     C   90                MOVEL'USR0328' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  B0DDQT    WUDDQT           On Hand U/M1 Su
     C           KRSSC     READE@B0REHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV First 70char       RT - Order Comment  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Count USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL*BLANK    WL0004           USR Text 70
     C                     Z-ADD0         WN0001           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN COAIC3    WQSD01           Company Number
     C           *LIKE     DEFN COC4NB    WQSD02           Order Number
     C           *LIKE     DEFN COI1SX    WQSD03           Comment Type
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           Company Number
     C                     KFLD           WQSD02           Order Number
     C                     KFLD           WQSD03           Comment Type
      * Setup key
     C                     Z-ADDWL0001    WQSD01           Company Number
     C                     Z-ADDWL0002    WQSD02           Order Number
     C                     MOVELWL0003    WQSD03           Comment Type
      * Establish starting position
     C           KRSSD     SETLL@COCPNU                    *
     C           KRSSD     READE@COCPNU                  90*
      * Data record not found
     C   90                MOVEL'USR0486' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         WN0001           Count USR
      * CASE: PAR.Count USR is One
     C           WN0001    IFEQ 1                          *IF
     C                     MOVEL*BLANK    WL0004           USR Text 70
     C                     MOVELCOG4NA    WL0004           USR Text 70
     C                     ELSE
      * CASE: PAR.Count USR is LE 3
     C           WN0001    IFLE 3                          *IF
     C                     Z-ADD1         ZQ      50
     C           WL0004    CAT  COG4NA:ZQ WL0004    P      USR Text 70
     C                     ELSE
      * CASE: *OTHERWISE
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSD     READE@COCPNU                  90*
     C                     ENDDO
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv ProdInfm          Rt - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           FJRMNB           Load ID
      * Setup key
     C                     Z-ADD$KNJNY    FJRMNB           Load ID
      * Establish starting position
     C           KRSSE     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           Product Tempera
     C                     Z-ADD*ZERO     YL0003           Product Complet
     C                     Z-ADD*ZERO     YL0004           Product Complet
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDFJPRTM    YL0002           Product Tempera
     C                     Z-ADDFJK0DT    YL0003           Product Complet
     C                     Z-ADDFJAYTM    YL0004           Product Complet
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modification History
      *================================================================
      * S00806 slm 5/22/2009 Misc Changes
      * Print the Product Completed Date & Time and Underline
      * If zero then don't print the editing
      * This is being formatted to the Text Est Product Ready Time
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule - Recompiled with no logic changes.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Embedded PRTOBJ : Prt Sel Prod SchItmTotPO
      *================================================================
      * Prt Sel Prod SchItmTotPO: Mainline
     C                     EXSR B0MAIN
     C                     ADD  4         WUXGNX           Count Records
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * E3796 JJH 02/11/15 - Add OPS Requested Ship Date to WF OrderProd
      *  Schedule - Recompiled with no logic changes.
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         XDVC2T    BEGSR
      *================================================================
      * Convert internal to external date format
      *================================================================
      * Map according to date format
     C                     Z-ADD0         XDEX01           CC
     C           XDDTFM    IFEQ 'DMY'
     C                     Z-ADDXDINDD    XDEX02           DD
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
     C           XDDTFM    IFEQ 'MDY'
     C                     Z-ADDXDINMM    XDEX02           MM
     C                     Z-ADDXDINDD    XDEX03           DD
     C                     Z-ADDXDINYY    XDEX04           YY
     C                     ELSE
      * YMD format
     C                     Z-ADDXDINYY    XDEX02           YY
     C                     Z-ADDXDINMM    XDEX03           MM
     C                     Z-ADDXDINDD    XDEX04           DD
     C                     END
     C                     END
      *================================================================
     CSR         XDVC2E    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZBINIT    BEGSR
      *================================================================
      * Prt Sel Prod SchItmTotPO: Initialise
      *================================================================
      * USER: Initialize program
      * Modifications and Comments
     C                     EXSR UCSUBR                     Modifications a
     C                     MOVEL*BLANK    WUT6T1           Flag Held Over
      *================================================================
     CSR         ZBEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Define work field Count USR
     C                     Z-ADD*ZERO     WUCNTU  50
      * Define work field Count 2 USR
     C                     Z-ADD*ZERO     WUA7NX  50
      * Define work field Count USR 3
     C                     Z-ADD*ZERO     WUNLNX  50
      * Define work field Print Date            USR
     C                     MOVEL*BLANK    WUB2SX  1
      * Define work field Page Control Usr
     C                     MOVEL*BLANK    WUPGST  1
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    EUCOC3           OPS Company Num
     C                     MOVEL*LOVAL    EUKDAA           OPS Warehouse
     C                     MOVEL*LOVAL    EUKEAA           OPS Primal Grou
     C                     MOVEL*LOVAL    EUSPDT           OPS Schedule Sh
     C                     MOVEL*LOVAL    EUSODT           OPS Deadline De
     C                     MOVEL*LOVAL    EUNLNY           OPS Deadline De
     C                     MOVEL*LOVAL    EUNJNY           OPS Load Id
     C                     MOVEL*LOVAL    EUEXC7           OPS Order Numbe
     C                     MOVEL*LOVAL    EUEYC7           OPS Item Code
      * Define work field Count Records        USR
     C                     Z-ADD*ZERO     WUXGNX  50
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WANINY           OPS Sequence No
     C                     Z-ADD*ZERO     WACOC3           OPS Company Num
     C                     Z-ADD*ZERO     WASPDT           OPS Schedule Sh
     C                     Z-ADD*ZERO     WAVQDT           OPS Requested S
     C                     Z-ADD*ZERO     WAEXC7           OPS Order Numbe
     C                     Z-ADD*ZERO     WANJNY           OPS Load Id
     C                     Z-ADD*ZERO     WANKNY           OPS Load Schedu
     C                     Z-ADD*ZERO     WASODT           OPS Deadline De
     C                     Z-ADD*ZERO     WANLNY           OPS Deadline De
     C                     Z-ADD*ZERO     WAEYC7           OPS Item Code
     C                     Z-ADD*ZERO     WAPIQT           OPS Quantity Or
     C                     Z-ADD*ZERO     WARINY           Item Age Days
     C                     Z-ADD*ZERO     WATIDT           Production Ovr
     C                     Z-ADD*ZERO     WATJDT           Production Ovr
     C                     Z-ADD*ZERO     WATNDT           Production AgeD
     C                     Z-ADD*ZERO     WATODT           Production AgeD
     C                     Z-ADD*ZERO     WAVTNY           OPS U/M Sequenc
     C                     Z-ADD*ZERO     WAICN6           Item Category N
      * Define work field Flag Held Over Usr
     C                     MOVEL*BLANK    WUT6T1  3
      * Initialize KEY fields.
     C                     MOVEL*LOVAL    WAKEAA           OPS Primal Grou
     C                     MOVEL*LOVAL    WAEYC7           OPS Item Code
     C                     MOVEL*LOVAL    WANINY           OPS Sequence No
      * Define work field On Hand U/M1 Summary
     C                     Z-ADD*ZERO     WUDDQT 112
      * Define work field Total Inv for Chk     USR
     C                     Z-ADD*ZERO     WUZ7VA 112
      * Define work field Total Work Ahead Usr
     C                     Z-ADD*ZERO     WUP2QT 112
      * Define work field Total Work Ahead Usr2
     C                     Z-ADD*ZERO     WUQIQT 112
      * Define work field Total Quantity Ship  USR
     C                     Z-ADD*ZERO     WUMEQT 112
      * Define work field Total Quantity to MakeUsr
     C                     Z-ADD*ZERO     WUPJQT 112
      * Define work field Total Amount 4 3/0 Usr
     C                     Z-ADD*ZERO     WUPXQT  30
      * Define work field Total Amount 5 3/0 Usr
     C                     Z-ADD*ZERO     WUQHQT  30
      * Define work field Total Amount 1 3/0 Usr
     C                     Z-ADD*ZERO     WUPUQT  30
      * Define work field Total Amount 2 3/0 Usr
     C                     Z-ADD*ZERO     WUPVQT  30
      * Define work field Total Amount 3 3/0 Usr
     C                     Z-ADD*ZERO     WUPWQT  30
      * Define work field Quantity Prod Avail USR
     C                     Z-ADD*ZERO     WUDWNX  61
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Count Ahead USR
     C                     Z-ADD*ZERO     WUJKNX  50
      * Define work field Count Items Records Usr
     C                     Z-ADD*ZERO     WUNVNY  50
      * Define work field Day of the Week USR
     C                     MOVEL*BLANK    WUULTX  9
      * Define work field Deadline Depart Time 4,0
     C                     Z-ADD*ZERO     WUYBNB  40
      * Define work field Display Ord Dtl Cmnts USR
     C                     MOVEL*BLANK    WUHDSX  1
      * Define work field Month (Char) USR
     C                     MOVEL*BLANK    WUT5TX  2
      * Define work field Day   (Char) USR
     C                     MOVEL*BLANK    WUT6TX  2
      * Define work field Century Usr TXT
     C                     MOVEL*BLANK    WUVQT1  2
      * Define work field Year  (Char) USR
     C                     MOVEL*BLANK    WUT4TX  2
      * Define work field Hours  2A            USR
     C                     MOVEL*BLANK    WUVDCD  2
      * Define work field Minutes  2A          USR
     C                     MOVEL*BLANK    WUVECD  2
      * Define work field Seconds 2A            USR
     C                     MOVEL*BLANK    WUY6CD  2
      * Define work field Count BrkItems Usr
     C                     Z-ADD*ZERO     WUNXNY  50
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SDRVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     MOVEL*BLANK    WL0003  2
     C                     MOVEL*BLANK    WL0004 70
      * Define local work field USR Text 70
     C                     MOVEL*BLANK    YL0001 70
      * Define local work field Product Temperature
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field Product Complete Date
     C                     Z-ADD*ZERO     YL0003  70
      * Define local work field Product Complete Time
     C                     Z-ADD*ZERO     YL0004  60
      * Define local work field Date (Alpha) USR
     C                     MOVEL*BLANK    YL0005  7
      * Define local work field Time Alpha usr 6
     C                     MOVEL*BLANK    YL0006  6
      * Declare initial value data areas
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   $ACMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL##PGM     $APGM
     C                     MOVEL##USR     $AUSR
     C                     MOVEL*BLANK    W0PFM   1
     C                     Z-ADD*ZERO     @$WRK   40
     C                     Z-ADD*ZERO     @$HDL   40
     C                     Z-ADD*ZERO     @$CLN
     C                     Z-ADD*ZERO     @$PGN
      * Adjust page length and overflow as necessary
     C           @$PGL     SUB  2         W0PGL   40
     C           @$OFL     IFGE W0PGL
     C           W0PGL     SUB  2         W0OFL   40
     C                     ELSE
     C                     Z-ADD@$OFL     W0OFL
     C                     END
      * Clear overflow indicator
     C                     SETOF                     97
      * Request new page
     C                     MOVEL'Y'       W0NEWP  1
      * USER: Initialize program
      * Modification History
     C                     EXSR UASUBR                     Modification Hi
      * VAL Rtv & Ctr Prt Hdg  IF
      * SET Setup Prt Headings IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SARVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * Center Txt String 40 - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc to PrtCo US - /UT User Source  * 
     C                     MOVE WUDE40    $ACMP
     C                     Z-ADD*ZERO     WUCNTU           Count USR
     C                     Z-ADD*ZERO     WUA7NX           Count 2 USR
     C                     Z-ADD*ZERO     WUNLNX           Count USR 3
     C                     MOVEL'Y'       WUB2SX           Print Date
     C                     MOVEL'Y'       WUPGST           Page Control Us
      * CASE: PAR.Scheduled Ship Date EQ PAR.Next Production Day Usr
     C           P1AODT    IFEQ P3SRDT                     *IF
      * User has selected date in the future
     C                     MOVEL'N'       WUB2SX           Print Date
      * Will only be printing the summary no need for page control
     C                     MOVEL'N'       WUPGST           Page Control Us
     C                     ELSE
      * CASE: *OTHERWISE
     C                     END                             *FI
      * Obtain system date format
     C           *NAMVAR   DEFN Y2DTFMA   XDDTFM  3
     C                     IN   XDDTFM
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 ISSUSANM
