     H/TITLE BPS Order Det Bld InitXF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 01/19/23  Time  : 14:37:34
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPDKMREL1IF  E           K        DISK
      * RTV : Company Values            Retrieval index
      *
     FPDKNCPL1IF  E           K        DISK
      * RTV : Order Detail Schedule     Retrieval index
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPOB6CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Consmd Retrieval index
      *
     FPOB5CPL1IF  E           K        DISK
      * RTV : Order Detail Sched-Inv    Retrieval index
      *
     FPOCWCPL1IF  E           K        DISK
      * RTV : PS Prod Item Inventory    Retrieval index
      *
     FPDKMREL0UF  E           K        DISK
      * UPD : Company Values            Update index
      *
     FPDKNCPL0UF  E           K        DISK
      * UPD : Order Detail Schedule     Update index
      *
     FPOB6CPL0UF  E           K        DISK
      * UPD : Order Detail Sched-Consmd Update index
      *
     FPOB5CPL0UF  E           K        DISK
      * UPD : Order Detail Sched-Inv    Update index
      *
     FPOCWCPL0UF  E           K        DISK
      * UPD : PS Prod Item Inventory    Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@KMREHC
      * Company Values            Retrieval index
      * Renamed input format fields
     I              KMAIC3                          WAAIC3
     I              KMV8CD                          WAV8CD
     I              KMAUNA                          WAAUNA
     I              KMI5ST                          WAI5ST
     I              KMBXTX                          WABXTX
     I              KMM8NB                          WAM8NB
     I              KMUVST                          WAUVST
     I              KMUWST                          WAUWST
     I              KMUXST                          WAUXST
     I              KMVSST                          WAVSST
     I              KMAATM                          WAAATM
     I              KMAYNA                          WAAYNA
     I              KMA0NA                          WAA0NA
     I              KMAXDT                          WAAXDT
      *
     I@KMREHB
      * Company Values            Update index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     I@KNCPHO
      * Order Detail Schedule     Retrieval index
      * Renamed input format fields
     I              KNAIC3                          WCAIC3
     I              KNC4NB                          WCC4NB
     I              KNDPNB                          WCDPNB
     I              KNUENB                          WCUENB
     I              KNJGDT                          WCJGDT
     I              KNAODT                          WCAODT
     I              KNAJCD                          WCAJCD
     I              KNAYAA                          WCAYAA
     I              KNHGCD                          WCHGCD
     I              KNIGQT                          WCIGQT
     I              KNFLWG                          WCFLWG
     I              KNIUQT                          WCIUQT
     I              KNF3WG                          WCF3WG
     I              KNIVQT                          WCIVQT
     I              KNF4WG                          WCF4WG
     I              KNP7ST                          WCP7ST
     I              KNP8ST                          WCP8ST
     I              KNQAST                          WCQAST
     I              KNUVST                          WCUVST
     I              KNUWST                          WCUWST
     I              KNUXST                          WCUXST
     I              KNVSST                          WCVSST
     I              KNAATM                          WCAATM
     I              KNAYNA                          WCAYNA
     I              KNA0NA                          WCA0NA
     I              KNAXDT                          WCAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WDAIC3
     I              BEC4NB                          WDC4NB
     I              BEJNCD                          WDJNCD
     I              BEANC7                          WDANC7
     I              BEBKC7                          WDBKC7
     I              BEBRTX                          WDBRTX
     I              BEHMNA                          WDHMNA
     I              BEHONA                          WDHONA
     I              BEHPNA                          WDHPNA
     I              BEHNNA                          WDHNNA
     I              BEDBCD                          WDDBCD
     I              BECKTX                          WDCKTX
     I              BEB0C7                          WDB0C7
     I              BEAETX                          WDAETX
     I              BEB1NA                          WDB1NA
     I              BEB3NA                          WDB3NA
     I              BEB4NA                          WDB4NA
     I              BEB2NA                          WDB2NA
     I              BEBHCD                          WDBHCD
     I              BEC8TX                          WDC8TX
     I              BEBCNA                          WDBCNA
     I              BEA0DT                          WDA0DT
     I              BEA5DT                          WDA5DT
     I              BEGNDT                          WDGNDT
     I              BEACDT                          WDACDT
     I              BEAQCD                          WDAQCD
     I              BEB6NA                          WDB6NA
     I              BEBYNA                          WDBYNA
     I              BEBZNA                          WDBZNA
     I              BEGTST                          WDGTST
     I              BEGVST                          WDGVST
     I              BEGUST                          WDGUST
     I              BEQFST                          WDQFST
     I              BECQCD                          WDCQCD
     I              BEGJST                          WDGJST
     I              BEGWST                          WDGWST
     I              BEGXST                          WDGXST
     I              BEGYST                          WDGYST
     I              BEAODT                          WDAODT
     I              BEAIVN                          WDAIVN
     I              BECXDT                          WDCXDT
     I              BEJZVA                          WDJZVA
     I              BEA1WG                          WDA1WG
     I              BEXIST                          WDXIST
     I              BEXJST                          WDXJST
     I              BEXKST                          WDXKST
     I              BEEIDT                          WDEIDT
     I              BEAFTM                          WDAFTM
     I              BEE8CD                          WDE8CD
     I              BEE9CD                          WDE9CD
     I              BERMNB                          WDRMNB
     I              BETBNB                          WDTBNB
     I              BER1NB                          WDR1NB
     I              BEPJST                          WDPJST
     I              BEU0ST                          WDU0ST
     I              BEU1ST                          WDU1ST
     I              BEQ2CD                          WDQ2CD
     I              BEU2ST                          WDU2ST
     I              BEVEST                          WDVEST
     I              BEVFST                          WDVFST
     I              BEVGST                          WDVGST
     I              BERPCD                          WDRPCD
     I              BERNNB                          WDRNNB
     I              BEVDST                          WDVDST
     I              BEATIN                          WDATIN
     I              BEU4ST                          WDU4ST
     I              BEU5ST                          WDU5ST
     I              BERSRN                          WDRSRN
     I              BEMHNA                          WDMHNA
     I              BEMINA                          WDMINA
     I              BEWBST                          WDWBST
     I              BER4CD                          WDR4CD
     I              BEBFCD                          WDBFCD
     I              BEQ4CD                          WDQ4CD
     I              BET3NB                          WDT3NB
     I              BESICD                          WDSICD
     I              BECONB                          WDCONB
     I              BECEST                          WDCEST
     I              BEAWDT                          WDAWDT
     I              BEJPCD                          WDJPCD
     I              BEXUST                          WDXUST
     I              BEZ1ST                          WDZ1ST
     I              BEVRVA                          WDVRVA
     I              BEOBST                          WDOBST
     I              BEBCST                          WDBCST
     I              BEBDST                          WDBDST
     I              BEB7VL                          WDB7VL
     I              BEGASX                          WDGASX
     I              BEGBSX                          WDGBSX
     I              BEGCSX                          WDGCSX
     I              BEGDSX                          WDGDSX
     I              BEFNSX                          WDFNSX
     I              BEFOSX                          WDFOSX
     I              BEFPSX                          WDFPSX
     I              BEFQSX                          WDFQSX
     I              BEFRSX                          WDFRSX
     I              BEFSSX                          WDFSSX
     I              BEFTSX                          WDFTSX
     I              BEFUSX                          WDFUSX
     I              BEFVSX                          WDFVSX
     I              BEFWSX                          WDFWSX
     I              BEFXSX                          WDFXSX
     I              BEFYSX                          WDFYSX
     I              BENODT                          WDNODT
     I              BENPDT                          WDNPDT
     I              BENQDT                          WDNQDT
     I              BENRDT                          WDNRDT
     I              BENSDT                          WDNSDT
     I              BEBPTM                          WDBPTM
     I              BEBQTM                          WDBQTM
     I              BEBRTM                          WDBRTM
     I              BEBSTM                          WDBSTM
     I              BEBTTM                          WDBTTM
     I              BEH0NX                          WDH0NX
     I              BEH1NX                          WDH1NX
     I              BEH2NX                          WDH2NX
     I              BEH3NX                          WDH3NX
     I              BEH4NX                          WDH4NX
     I              BEC0C7                          WDC0C7
     I              BEUVST                          WDUVST
     I              BEUWST                          WDUWST
     I              BEUXST                          WDUXST
     I              BEAATM                          WDAATM
     I              BEAYNA                          WDAYNA
     I              BEA0NA                          WDA0NA
     I              BEAXDT                          WDAXDT
      *
     I@KNCPHN
      * Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     I@B6CPNB
      * Order Detail Sched-Consmd Retrieval index
      * Renamed input format fields
     I              B6AIC3                          WFAIC3
     I              B6C4NB                          WFC4NB
     I              B6DPNB                          WFDPNB
     I              B6UENB                          WFUENB
     I              B6JGDT                          WFJGDT
     I              B6OONY                          WFOONY
     I              B6AODT                          WFAODT
     I              B6AJCD                          WFAJCD
     I              B6NUDT                          WFNUDT
     I              B6HGCD                          WFHGCD
     I              B6IGQT                          WFIGQT
     I              B6FLWG                          WFFLWG
     I              B6NSQT                          WFNSQT
     I              B6JQWG                          WFJQWG
     I              B6NVDT                          WFNVDT
     I              B6BUTM                          WFBUTM
     I              B6UVST                          WFUVST
     I              B6UWST                          WFUWST
     I              B6UXST                          WFUXST
     I              B6VSST                          WFVSST
     I              B6AATM                          WFAATM
     I              B6AYNA                          WFAYNA
     I              B6A0NA                          WFA0NA
     I              B6AXDT                          WFAXDT
      *
     I@B6CPNA
      * Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     I@B5CPM2
      * Order Detail Sched-Inv    Retrieval index
      * Renamed input format fields
     I              B5AIC3                          WHAIC3
     I              B5C4NB                          WHC4NB
     I              B5DPNB                          WHDPNB
     I              B5UENB                          WHUENB
     I              B5JGDT                          WHJGDT
     I              B5AODT                          WHAODT
     I              B5AJCD                          WHAJCD
     I              B5HGCD                          WHHGCD
     I              B5IUQT                          WHIUQT
     I              B5F3WG                          WHF3WG
     I              B5UVST                          WHUVST
     I              B5UWST                          WHUWST
     I              B5UXST                          WHUXST
     I              B5VSST                          WHVSST
     I              B5AATM                          WHAATM
     I              B5AYNA                          WHAYNA
     I              B5A0NA                          WHA0NA
     I              B5AXDT                          WHAXDT
      *
     I@B5CPM1
      * Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WIAIC3
     I              B5C4NB                          WIC4NB
     I              B5DPNB                          WIDPNB
     I              B5UENB                          WIUENB
     I              B5JGDT                          WIJGDT
     I              B5AODT                          WIAODT
     I              B5AJCD                          WIAJCD
     I              B5HGCD                          WIHGCD
     I              B5IUQT                          WIIUQT
     I              B5F3WG                          WIF3WG
     I              B5UVST                          WIUVST
     I              B5UWST                          WIUWST
     I              B5UXST                          WIUXST
     I              B5VSST                          WIVSST
     I              B5AATM                          WIAATM
     I              B5AYNA                          WIAYNA
     I              B5A0NA                          WIA0NA
     I              B5AXDT                          WIAXDT
      *
     I@CWCPQW
      * PS Prod Item Inventory    Retrieval index
      * Renamed input format fields
     I              CWAIC3                          WJAIC3
     I              CWHGCD                          WJHGCD
     I              CWAJCD                          WJAJCD
     I              CWELDT                          WJELDT
     I              CWACWG                          WJACWG
     I              CWARQT                          WJARQT
     I              CWK7DT                          WJK7DT
     I              CWUVST                          WJUVST
     I              CWUWST                          WJUWST
     I              CWUXST                          WJUXST
     I              CWVSST                          WJVSST
     I              CWAATM                          WJAATM
     I              CWAYNA                          WJAYNA
     I              CWA0NA                          WJA0NA
     I              CWAXDT                          WJAXDT
      *
     I@CWCPQV
      * PS Prod Item Inventory    Update index
      * Renamed input format fields
     I              CWAIC3                          WKAIC3
     I              CWHGCD                          WKHGCD
     I              CWAJCD                          WKAJCD
     I              CWELDT                          WKELDT
     I              CWACWG                          WKACWG
     I              CWARQT                          WKARQT
     I              CWK7DT                          WKK7DT
     I              CWUVST                          WKUVST
     I              CWUWST                          WKUWST
     I              CWUXST                          WKUXST
     I              CWVSST                          WKVSST
     I              CWAATM                          WKAATM
     I              CWAYNA                          WKAYNA
     I              CWA0NA                          WKA0NA
     I              CWAXDT                          WKAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPDKM1    E DSPDKMREL0
      * UPD : Company Values            Update index
      * Renamed input format fields
     I              KMAIC3                          WBAIC3
     I              KMV8CD                          WBV8CD
     I              KMAUNA                          WBAUNA
     I              KMI5ST                          WBI5ST
     I              KMBXTX                          WBBXTX
     I              KMM8NB                          WBM8NB
     I              KMUVST                          WBUVST
     I              KMUWST                          WBUWST
     I              KMUXST                          WBUXST
     I              KMVSST                          WBVSST
     I              KMAATM                          WBAATM
     I              KMAYNA                          WBAYNA
     I              KMA0NA                          WBA0NA
     I              KMAXDT                          WBAXDT
      *
     IYARDCS      DS                            123
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPDKN1    E DSPDKNCPL0
      * UPD : Order Detail Schedule     Update index
      * Renamed input format fields
     I              KNAIC3                          WEAIC3
     I              KNC4NB                          WEC4NB
     I              KNDPNB                          WEDPNB
     I              KNUENB                          WEUENB
     I              KNJGDT                          WEJGDT
     I              KNAODT                          WEAODT
     I              KNAJCD                          WEAJCD
     I              KNAYAA                          WEAYAA
     I              KNHGCD                          WEHGCD
     I              KNIGQT                          WEIGQT
     I              KNFLWG                          WEFLWG
     I              KNIUQT                          WEIUQT
     I              KNF3WG                          WEF3WG
     I              KNIVQT                          WEIVQT
     I              KNF4WG                          WEF4WG
     I              KNP7ST                          WEP7ST
     I              KNP8ST                          WEP8ST
     I              KNQAST                          WEQAST
     I              KNUVST                          WEUVST
     I              KNUWST                          WEUWST
     I              KNUXST                          WEUXST
     I              KNVSST                          WEVSST
     I              KNAATM                          WEAATM
     I              KNAYNA                          WEAYNA
     I              KNA0NA                          WEA0NA
     I              KNAXDT                          WEAXDT
      *
     IYBRDCS      DS                            100
     IQPOB61    E DSPOB6CPL0
      * UPD : Order Detail Sched-Consmd Update index
      * Renamed input format fields
     I              B6AIC3                          WGAIC3
     I              B6C4NB                          WGC4NB
     I              B6DPNB                          WGDPNB
     I              B6UENB                          WGUENB
     I              B6JGDT                          WGJGDT
     I              B6OONY                          WGOONY
     I              B6AODT                          WGAODT
     I              B6AJCD                          WGAJCD
     I              B6NUDT                          WGNUDT
     I              B6HGCD                          WGHGCD
     I              B6IGQT                          WGIGQT
     I              B6FLWG                          WGFLWG
     I              B6NSQT                          WGNSQT
     I              B6JQWG                          WGJQWG
     I              B6NVDT                          WGNVDT
     I              B6BUTM                          WGBUTM
     I              B6UVST                          WGUVST
     I              B6UWST                          WGUWST
     I              B6UXST                          WGUXST
     I              B6VSST                          WGVSST
     I              B6AATM                          WGAATM
     I              B6AYNA                          WGAYNA
     I              B6A0NA                          WGA0NA
     I              B6AXDT                          WGAXDT
      *
     IQPOB51    E DSPOB5CPL0
      * UPD : Order Detail Sched-Inv    Update index
      * Renamed input format fields
     I              B5AIC3                          WIAIC3
     I              B5C4NB                          WIC4NB
     I              B5DPNB                          WIDPNB
     I              B5UENB                          WIUENB
     I              B5JGDT                          WIJGDT
     I              B5AODT                          WIAODT
     I              B5AJCD                          WIAJCD
     I              B5HGCD                          WIHGCD
     I              B5IUQT                          WIIUQT
     I              B5F3WG                          WIF3WG
     I              B5UVST                          WIUVST
     I              B5UWST                          WIUWST
     I              B5UXST                          WIUXST
     I              B5VSST                          WIVSST
     I              B5AATM                          WIAATM
     I              B5AYNA                          WIAYNA
     I              B5A0NA                          WIA0NA
     I              B5AXDT                          WIAXDT
      *
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IQPOCW1    E DSPOCWCPL0
      * UPD : PS Prod Item Inventory    Update index
      * Renamed input format fields
     I              CWAIC3                          WKAIC3
     I              CWHGCD                          WKHGCD
     I              CWAJCD                          WKAJCD
     I              CWELDT                          WKELDT
     I              CWACWG                          WKACWG
     I              CWARQT                          WKARQT
     I              CWK7DT                          WKK7DT
     I              CWUVST                          WKUVST
     I              CWUWST                          WKUWST
     I              CWUXST                          WKUXST
     I              CWVSST                          WKVSST
     I              CWAATM                          WKAATM
     I              CWAYNA                          WKAYNA
     I              CWA0NA                          WKA0NA
     I              CWAXDT                          WKAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * I :  PPS Process STS
     I                                        1   1 P1MWSX
     IP2PARM      DS
      * N :  Company Number
     I                                    P   1   20P2AIC3
     IP3PARM      DS
      * N :  Scheduled Ship Date USR
     I                                    P   1   40P3HODT
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1MWSX    PARM           WP0001  1        PPS Process STS
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * BPS Order Det Bld InitXF
      * ********************
      * RMC 9/30/2021
      * Do initial steps for the schedule only here
      *   Subsequent XF will process the order allocation interations
      * ********************
      * E3188 RMC SET COMPANY VALUE TO YES WHEN PPS BUILD IS IN PROGRESS
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'Y'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * Rtv Chg Comp Val Alpha RT - Company Values  * Company 440
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'Y'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0001           Company Number
     C                     MOVEL@CN,001   WL0002    P      Company Value C
     C                     MOVEL'Y'       WL0003    P      System Value Al
     C                     EXSR SARVGN
      * ********************
      * CASE: PAR.PPS Process STS is Realc by SDte Mid Day
     C           P1MWSX    IFEQ '2'                        *IF
      * UPS Realc Ord Init    XF - PS Prod Schedule  * 
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0001  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Realc Ord Init    XF - PS Prod Schedule  * Company 440
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 440       WQ0002  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * UPS Realc Ord Init    XF - PS Prod Schedule  * 
     C                     CALL 'POQXXFR'              90  UPS Realc Ord I
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0003  30       Company Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'POQXXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Del Order Detail Sched, Cnsmd, Inv for shipped orders
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0004           Company Number
     C                     EXSR SCRVGN
      * Upd Reallocate Sts    RT - Order Detail Schedule  * Company 440
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0004           Company Number
     C                     EXSR SCRVGN
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0004           Company Number
     C                     EXSR SCRVGN
      * Delete Order Detail Schedule for orders older than 3 days ago
      *   They wont be reallocated in the following routines
      *   To Remove the detail record, set report typ = "D"
      * E3031 2/27/14 RMC Rail orders can be 30 days old
      * E3031 1/10/23 RMC chg LF to DESC on sch ship dt, & POS on sched s
      * PAR.Scheduled Ship Date USR = JOB.*Job date + CON.-11 *DAYS
     C           ##JDT     ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C                     Z-ADD-11       XDURR   80
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C                     EXSR XDADY
     C                     EXSR XCVFA
     C           XDINDT    IFLT 010101
     C           XDINDT    ORGT 4000000
     C                     Z-ADD*ZERO     P3HODT
     C                     ELSE
     C           XDINDT    SUB  1000000   P3HODT
     C                     END
      * PrtRmv OrddtlSch-NAllcPF - Order Detail Schedule  * 
     C                     CALL 'PMFPPFR'              90  PrtRmv OrddtlSc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0004  30       Company Number
     C                     PARM P3HODT    WQ0005  70       Scheduled Ship
     C                     PARM 'D'       WQ0006  1        Report Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFPPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PrtRmv OrddtlSch-NAllcPF - Order Detail Schedule  * Company 440
     C                     CALL 'PMFPPFR'              90  PrtRmv OrddtlSc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 440       WQ0007  30       Company Number
     C                     PARM P3HODT    WQ0008  70       Scheduled Ship
     C                     PARM 'D'       WQ0009  1        Report Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFPPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * PrtRmv OrddtlSch-NAllcPF - Order Detail Schedule  * 
     C                     CALL 'PMFPPFR'              90  PrtRmv OrddtlSc
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0010  30       Company Number
     C                     PARM P3HODT    WQ0011  70       Scheduled Ship
     C                     PARM 'D'       WQ0012  1        Report Type USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMFPPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Update Consumed Item Code in Order Detail due to possible BOM Chg
      * commenting this for now  9-30-2021
      * *----------------  CAPTURE INVENTORY --------------------*
      *  *note - cant clrpfm pocwcpp in CL because it could be locked
      * Del Item Inventory-allRT - PS Prod Item Inventory  * ---360---
      * Move input parameters to subroutine local variables.
     C                     Z-ADD360       WL0005           Company Number
     C                     EXSR SKRVGN
      * BPS Capture Inv OnHnd PF - Item Balance  * ---360---
     C                     CALL 'PDBHPFR'              90  BPS Capture Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 360       WQ0013  30       Company Number
     C                     PARM *BLANK    WQ0014  3        Warehouse Code
     C                     PARM ##JDT     WQ0015  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Del Item Inventory-allRT - PS Prod Item Inventory  * ---360---
      * Move input parameters to subroutine local variables.
     C                     Z-ADD440       WL0005           Company Number
     C                     EXSR SKRVGN
      * BPS Capture Inv OnHnd PF - Item Balance  * ---440---
     C                     CALL 'PDBHPFR'              90  BPS Capture Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 440       WQ0016  30       Company Number
     C                     PARM *BLANK    WQ0017  3        Warehouse Code
     C                     PARM ##JDT     WQ0018  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Del Item Inventory-allRT - PS Prod Item Inventory  * ---360---
      * Move input parameters to subroutine local variables.
     C                     Z-ADD960       WL0005           Company Number
     C                     EXSR SKRVGN
      * BPS Capture Inv OnHnd PF - Item Balance  * ---960---
     C                     CALL 'PDBHPFR'              90  BPS Capture Inv
     C                     PARM *BLANK    W0RTN   7
     C                     PARM 960       WQ0019  30       Company Number
     C                     PARM *BLANK    WQ0020  3        Warehouse Code
     C                     PARM ##JDT     WQ0021  70       Production Date
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDBHPFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * *------------------------------------------------------------*
      * S16603 05/28/20 DN-Call the Informatica Restoration Javascript.
      * CASE: *OTHERWISE
      * Exc Copy /SBM Qsh Call CL - Order Detail Schedule  * 
     C                     CALL 'PUUZUPC'              90  Exc Copy /SBM Q
     C                     PARM 'R'       WQ0022  1        Call Job USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PUUZUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Rtv Chg Comp Val Alpha RT - Company Values  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAAIC3           Company Number
     C                     KFLD           WAV8CD           Company Value C
      * Setup key
     C                     Z-ADDWL0001    WAAIC3           Company Number
     C                     MOVELWL0002    WAV8CD           Company Value C
      * Establish starting position
     C           KRSSA     CHAIN@KMREHC              90    *
      * Data record not found
     C   90                MOVEL'USR2221' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CHG Company Values     CH - Company Values  * 
     C                     EXSR SBCHRC
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Company Values     CH - Company Values  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  60       Job Time
     C                     MOVEL*BLANK    WN0002 10        User Id
     C                     MOVEL*BLANK    WN0003 10        Job Name
     C                     Z-ADD*ZERO     WN0004  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @KMREHB
     C                     Z-ADDWAAIC3    WBAIC3           Company Number
     C                     MOVELWAV8CD    WBV8CD    P      Company Value C
      *
     C           KLCHSB    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBV8CD           Company Value C
     C           KLCHSB    CHAIN@KMREHB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKMREL0'MDACP
     C                     MOVEL'@KMREHB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKM1    YARDCS
      * Move non-key fields to @KMREHB
     C                     MOVELWAAUNA    WBAUNA    P      Description
     C                     MOVELWAI5ST    WBI5ST    P      System Value Ty
     C                     MOVELWL0003    WBBXTX    P      System Value Al
     C                     Z-ADDWAM8NB    WBM8NB           System Value Nu
     C                     MOVELWAUVST    WBUVST    P      EDI Status 1
     C                     MOVELWAUWST    WBUWST    P      EDI Status 2
     C                     MOVELWAUXST    WBUXST    P      EDI Status 3
     C                     MOVELWAVSST    WBVSST    P      Record Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp 2 IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##PGM     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKM1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@KMREHB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Upd Reallocate Sts    RT - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     YL0001           Order Number
      * Declare restrictor key work fields
     C           *LIKE     DEFN WCAIC3    WQSC01           Company Number
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WQSC01           Company Number
      * Setup key
     C                     Z-ADDWL0004    WQSC01           Company Number
      * Establish starting position
     C           KRSSC     SETLL@KNCPHO                    *
     C           KRSSC     READE@KNCPHO                  90*
      * Data record not found
     C   90                MOVEL'USR2238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: LCL.Order Number NE DB1.Order Number
     C           YL0001    IFNE WCC4NB                     *IF
     C                     Z-ADDWCC4NB    YL0001           Order Number
      * RTV Header Status      RT - Order Header TRG  * 
     C                     EXSR SDRVGN
     C                     END                             *FI
      * CASE: LCL.Header Status is Avail/Alloc/Enter/Hold
     C           YL0002    IFEQ 'L'                        *IF
     C           YL0002    OREQ 'A'
     C           YL0002    OREQ 'E'
     C           YL0002    OREQ 'H'
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
     C                     EXSR SECHRC
     C                     ELSE
      * CASE: *OTHERWISE
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
     C                     EXSR SFDLRC
      * Del OrdDtl Sch-ConsDT RT - Order Detail Sched-Consmd  * 
     C                     EXSR SGRVGN
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
     C                     EXSR SIRVGN
     C                     END                             *FI
     C           KRSSC     READE@KNCPHO                  90*
     C                     ENDDO
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Header Status      RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDAIC3           Company Number
     C                     KFLD           WDC4NB           Order Number
      * Setup key
     C                     Z-ADDWCAIC3    WDAIC3           Company Number
     C                     Z-ADDWCC4NB    WDC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDGWST    YL0002           Header Status
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SECHRC    BEGSR
      *================================================================
      * Chg Reallocate Sts    CH - Order Detail Schedule  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0005  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0006  3        Warehouse Code
     C                     MOVEL*BLANK    WN0007  3        Order From Ware
     C                     Z-ADD*ZERO     WN0008  70       Item Code
     C                     Z-ADD*ZERO     WN0009 112       OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WN0010 112       OD Weight Sched
     C                     Z-ADD*ZERO     WN0011 112       OD Quantity Inv
     C                     Z-ADD*ZERO     WN0012 112       OD Weight Inv S
     C                     Z-ADD*ZERO     WN0013 112       OD Quantity Unu
     C                     Z-ADD*ZERO     WN0014 112       OD Unused weigh
     C                     MOVEL*BLANK    WN0015  1        OD Added to Sch
     C                     MOVEL*BLANK    WN0016  2        OD Status Unuse
     C                     MOVEL*BLANK    WN0017  1        EDI Status 1
     C                     MOVEL*BLANK    WN0018  1        EDI Status 2
     C                     MOVEL*BLANK    WN0019  1        EDI Status 3
     C                     MOVEL*BLANK    WN0020  1        Record Status
     C                     Z-ADD*ZERO     WN0021  60       Job Time
     C                     MOVEL*BLANK    WN0022 10        User Id
     C                     MOVEL*BLANK    WN0023 10        Job Name
     C                     Z-ADD*ZERO     WN0024  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
     C                     Z-ADDWCJGDT    WEJGDT           OD Production D
      *
     C           KLCHSE    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLCHSE    CHAIN@KNCPHN              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPDKN1    YBRDCS
      * Move non-key fields to @KNCPHN
     C                     MOVEL'Y'       WEP8ST    P      OD Reallocate S
      *
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Record Stamp CHGOB IF
     C                     Z-ADD##JTM     WEAATM           Job Time
     C                     MOVEL##USR     WEAYNA           User Id
     C                     MOVEL##PGM     WEA0NA           Job Name
     C                     Z-ADD##JDT     WEAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QPDKN1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@KNCPHN                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPDKNCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFDLRC    BEGSR
      *================================================================
      * DLT Ord Detail Sched   DL - Order Detail Schedule  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @KNCPHN
     C                     Z-ADDWCAIC3    WEAIC3           Company Number
     C                     Z-ADDWCC4NB    WEC4NB           Order Number
     C                     Z-ADDWCDPNB    WEDPNB           Order Sequence
     C                     Z-ADDWCUENB    WEUENB           Order Secondary
     C                     Z-ADDWCJGDT    WEJGDT           OD Production D
      *
     C           KLDLSF    KLIST
     C                     KFLD           WEAIC3           Company Number
     C                     KFLD           WEC4NB           Order Number
     C                     KFLD           WEDPNB           Order Sequence
     C                     KFLD           WEUENB           Order Secondary
     C                     KFLD           WEJGDT           OD Production D
     C           KLDLSF    CHAIN@KNCPHN              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PDKNCPL0'MDACP
     C                     MOVEL'@KNCPHN' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SFEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@KNCPHN                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Del OrdDtl Sch-ConsDT RT - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFAIC3    WQSG01           Company Number
     C           *LIKE     DEFN WFC4NB    WQSG02           Order Number
     C           *LIKE     DEFN WFDPNB    WQSG03           Order Sequence
     C           *LIKE     DEFN WFUENB    WQSG04           Order Secondary
     C           *LIKE     DEFN WFJGDT    WQSG05           OD Production D
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WQSG01           Company Number
     C                     KFLD           WQSG02           Order Number
     C                     KFLD           WQSG03           Order Sequence
     C                     KFLD           WQSG04           Order Secondary
     C                     KFLD           WQSG05           OD Production D
      * Setup key
     C                     Z-ADDWCAIC3    WQSG01           Company Number
     C                     Z-ADDWCC4NB    WQSG02           Order Number
     C                     Z-ADDWCDPNB    WQSG03           Order Sequence
     C                     Z-ADDWCUENB    WQSG04           Order Secondary
     C                     Z-ADDWCJGDT    WQSG05           OD Production D
      * Establish starting position
     C           KRSSG     SETLL@B6CPNB                    *
     C           KRSSG     READE@B6CPNB                  90*
      * Data record not found
     C   90                MOVEL'USR3152' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
     C                     EXSR SHDLRC
     C           KRSSG     READE@B6CPNB                  90*
     C                     ENDDO
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHDLRC    BEGSR
      *================================================================
      * Del OrdDtl Sch-Consmd DL - Order Detail Sched-Consmd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B6CPNA
     C                     Z-ADDWFAIC3    WGAIC3           Company Number
     C                     Z-ADDWFC4NB    WGC4NB           Order Number
     C                     Z-ADDWFDPNB    WGDPNB           Order Sequence
     C                     Z-ADDWFUENB    WGUENB           Order Secondary
     C                     Z-ADDWFJGDT    WGJGDT           OD Production D
     C                     Z-ADDWFOONY    WGOONY           ODS Sequence Nu
      *
     C           KLDLSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C                     KFLD           WGDPNB           Order Sequence
     C                     KFLD           WGUENB           Order Secondary
     C                     KFLD           WGJGDT           OD Production D
     C                     KFLD           WGOONY           ODS Sequence Nu
     C           KLDLSH    CHAIN@B6CPNA              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB6CPL0'MDACP
     C                     MOVEL'@B6CPNA' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SHEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B6CPNA                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   RT - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSI01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSI02           Order Number
     C           *LIKE     DEFN WHDPNB    WQSI03           Order Sequence
     C           *LIKE     DEFN WHUENB    WQSI04           Order Secondary
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Company Number
     C                     KFLD           WQSI02           Order Number
     C                     KFLD           WQSI03           Order Sequence
     C                     KFLD           WQSI04           Order Secondary
      * Setup key
     C                     Z-ADDWCAIC3    WQSI01           Company Number
     C                     Z-ADDWCC4NB    WQSI02           Order Number
     C                     Z-ADDWCDPNB    WQSI03           Order Sequence
     C                     Z-ADDWCUENB    WQSI04           Order Secondary
      * Establish starting position
     C           KRSSI     SETLL@B5CPM2                    *
     C           KRSSI     READE@B5CPM2                  90*
      * Data record not found
     C   90                MOVEL'USR3150' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
     C                     EXSR SJDLRC
     C           KRSSI     READE@B5CPM2                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJDLRC    BEGSR
      *================================================================
      * Del Ord Dtl Sch-Inv   DL - Order Detail Sched-Inv  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @B5CPM1
     C                     Z-ADDWHAIC3    WIAIC3           Company Number
     C                     Z-ADDWHC4NB    WIC4NB           Order Number
     C                     Z-ADDWHDPNB    WIDPNB           Order Sequence
     C                     Z-ADDWHUENB    WIUENB           Order Secondary
     C                     Z-ADDWHJGDT    WIJGDT           OD Production D
      *
     C           KLDLSJ    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIDPNB           Order Sequence
     C                     KFLD           WIUENB           Order Secondary
     C                     KFLD           WIJGDT           OD Production D
     C           KLDLSJ    CHAIN@B5CPM1              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POB5CPL0'MDACP
     C                     MOVEL'@B5CPM1' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SJEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@B5CPM1                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Del Item Inventory-allRT - PS Prod Item Inventory  * ---360---
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSK01           Company Number
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK01           Company Number
      * Setup key
     C                     Z-ADDWL0005    WQSK01           Company Number
      * Establish starting position
     C           KRSSK     SETLL@CWCPQW                    *
     C           KRSSK     READE@CWCPQW                  90*
      * Data record not found
     C   90                MOVEL'USR3238' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Del Item Inventory    DL - PS Prod Item Inventory  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWJAIC3    WL0006           Company Number
     C                     Z-ADDWJHGCD    WL0007           Item Code
     C                     MOVELWJAJCD    WL0008    P      Warehouse Code
     C                     Z-ADDWJELDT    WL0009           Production Date
     C                     EXSR SLDLRC
     C           KRSSK     READE@CWCPQW                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLDLRC    BEGSR
      *================================================================
      * Del Item Inventory    DL - PS Prod Item Inventory  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @CWCPQV
     C                     Z-ADDWL0006    WKAIC3           Company Number
     C                     Z-ADDWL0007    WKHGCD           Item Code
     C                     MOVELWL0008    WKAJCD           Warehouse Code
     C                     Z-ADDWL0009    WKELDT           Production Date
      *
     C           KLDLSL    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKHGCD           Item Code
     C                     KFLD           WKAJCD           Warehouse Code
     C                     KFLD           WKELDT           Production Date
     C           KLDLSL    CHAIN@CWCPQV              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'POCWCPL0'MDACP
     C                     MOVEL'@CWCPQV' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SLEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@CWCPQV                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         XCVFA     BEGSR
      *================================================================
      * Convert absolute day to date
      *================================================================
     C           XDAY1     IFGT 109267
     C                     ADD  2         XDAY1
     C                     ELSE
     C           XDAY1     IFGT 36218
     C                     ADD  1         XDAY1
     C                     END
     C                     END
      * Full years (up to the date)
     C           XDAY1     DIV  365.25    XDWK1   80
     C                     MVR            XDWK3   71
     C                     Z-ADDXDWK1     XDINYY
     C           XDWK3     IFEQ 0
      * The date is the end of a year
     C                     Z-ADD12        XDINMM
     C                     Z-ADD31        XDINDD
     C                     ELSE
      * Year days up to the date
     C           XDWK1     MULT 365.25    XDWK2   60
     C                     SUB  XDWK2     XDAY1
     C                     ADD  1         XDINYY
      * Leap year ?
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
      * March 1 (relative day of the year)
     C           XDWK1     IFEQ 0
     C                     Z-ADD60        XDWK1
     C                     ELSE
     C                     Z-ADD59        XDWK1
     C                     END
      * Define date base month and offset day -
     C           XDAY1     IFLE XDWK1
      *  - January (thru February)
     C                     Z-ADD1         XDINMM
     C                     ELSE
     C                     SUB  XDWK1     XDAY1
     C           XDAY1     IFLE 153
      *  - March (thru July)
     C                     Z-ADD3         XDINMM
     C                     ELSE
      *  - August (thru December)
     C                     Z-ADD8         XDINMM
     C                     SUB  153       XDAY1
     C                     END
      * Calculate 2 month base and offset day
     C           XDAY1     SUB  1         XDWK1
     C                     DIV  61        XDWK1
     C                     MVR            XDAY1
     C                     ADD  1         XDAY1
     C                     MULT 2         XDWK1
     C                     ADD  XDWK1     XDINMM
     C                     END
      * Calculate date increment,
     C           XDAY1     IFGT 31
     C                     ADD  1         XDINMM
     C                     SUB  31        XDAY1
     C                     END
     C                     Z-ADDXDAY1     XDINDD
     C                     END
      *================================================================
     CSR         XCVFAE    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDADY     BEGSR
      *================================================================
      * Calculate date increment, *DAYS
      *================================================================
     C           XDURR     IFEQ 0
     C           XDWSL     OREQ 0
      * None days of week selected
     C                     Z-ADDXDAY2     XDAY1
     C           XDURR     IFNE *ZERO
      * Return Code: Unable to increment date.
     C                     MOVEL'Y2U0059' W0RTN   7
     C                     ENDIF
     C                     GOTO XDADYE
     C                     ENDIF
     C           XDWSL     IFEQ 7
      * All days of week selected
     C           XDAY2     ADD  XDURR     XDAY1
     C                     GOTO XDADYM
     C                     ENDIF
      * Some days of week selected
     C           XDURR     IFGE 0
     C                     Z-ADD1         XDSTP   10
     C                     ELSE
     C                     Z-ADD-1        XDSTP
     C                     ENDIF
      * Get number of full weeks in the duration
     C           XDURR     DIV  XDWSL     XDWNB   60
      * Isolate the last week
     C                     MVR            XDLSW   10
     C           XDLSW     IFEQ 0
     C           XDWSL     MULT XDSTP     XDLSW
     C                     SUB  XDSTP     XDWNB
     C                     ENDIF
      * Increment the date by the full weeks
     C           XDWNB     MULT 7         XDWK1   80
     C           XDAY2     ADD  XDWK1     XDAY1   60
      * Determine day of week of the beginning date
     C           XDAY2     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ENDIF
      * Loop: Increment the date by the last week
     C           XDLSW     DOWNE0
      * Increment the date
     C                     ADD  XDSTP     XDAY1
      * Increment the day of week
     C                     ADD  XDSTP     YY
      * Put day of week into the range 1-7
     C           YY        IFEQ 0
     C                     Z-ADD7         YY
     C                     ELSE
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     ELSE
     C           YY        IFEQ -1
     C                     Z-ADD6         YY
     C                     ENDIF
     C                     ENDIF
     C                     ENDIF
     C           YDOW,YY   IFEQ XDSEL
      * Selected day of the last week has been processed
     C                     SUB  XDSTP     XDLSW
     C                     ENDIF
      * End of loop
     C                     ENDDO
     C           XDADYM    TAG
     C           XDINDD    IFLT 1
     C                     Z-ADD1         XDINDD
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         XDADYE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P2AIC3           Company Number
     C                     Z-ADD*ZERO     P3HODT           Scheduled Ship
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAM8NB           System Value Nu
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCDPNB           Order Sequence
     C                     Z-ADD*ZERO     WCUENB           Order Secondary
     C                     Z-ADD*ZERO     WCJGDT           OD Production D
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCHGCD           Item Code
     C                     Z-ADD*ZERO     WCIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WCFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WCIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WCF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WCIVQT           OD Quantity Unu
     C                     Z-ADD*ZERO     WCF4WG           OD Unused weigh
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WDBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WDB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WDA0DT           Order Date
     C                     Z-ADD*ZERO     WDA5DT           Requested Ship
     C                     Z-ADD*ZERO     WDGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WDACDT           Cancel Date
     C                     Z-ADD*ZERO     WDAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WDCXDT           Date of Origina
     C                     Z-ADD*ZERO     WDJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WDA1WG           Order Weight To
     C                     Z-ADD*ZERO     WDEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WDAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WDATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WDRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WDT3NB           Attach to Order
     C                     Z-ADD*ZERO     WDCONB           Invoice Number
     C                     Z-ADD*ZERO     WDAWDT           Invoice Date
     C                     Z-ADD*ZERO     WDVRVA           A/R order Value
     C                     Z-ADD*ZERO     WDB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WDNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WDNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WDNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WDNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WDNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WDBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WDBQTM           Time of Origina
     C                     Z-ADD*ZERO     WDBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WDBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WDBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WDH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WDH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WDH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WDH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WDH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WDC0C7           Claim Number
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFC4NB           Order Number
     C                     Z-ADD*ZERO     WFDPNB           Order Sequence
     C                     Z-ADD*ZERO     WFUENB           Order Secondary
     C                     Z-ADD*ZERO     WFJGDT           OD Production D
     C                     Z-ADD*ZERO     WFOONY           ODS Sequence Nu
     C                     Z-ADD*ZERO     WFAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WFNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WFHGCD           Item Code
     C                     Z-ADD*ZERO     WFIGQT           OD Qty/Cnsmd Pi
     C                     Z-ADD*ZERO     WFFLWG           OD Weight Sched
     C                     Z-ADD*ZERO     WFNSQT           ODS Quantity Sh
     C                     Z-ADD*ZERO     WFJQWG           ODS Weight Shor
     C                     Z-ADD*ZERO     WFNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WFBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHDPNB           Order Sequence
     C                     Z-ADD*ZERO     WHUENB           Order Secondary
     C                     Z-ADD*ZERO     WHJGDT           OD Production D
     C                     Z-ADD*ZERO     WHAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WHHGCD           Item Code
     C                     Z-ADD*ZERO     WHIUQT           OD Quantity Inv
     C                     Z-ADD*ZERO     WHF3WG           OD Weight Inv S
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJELDT           Production Date
     C                     Z-ADD*ZERO     WJACWG           Quantity on Han
     C                     Z-ADD*ZERO     WJARQT           Quantity on Han
     C                     Z-ADD*ZERO     WJK7DT           Label Date
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SARVGN.
     C                     Z-ADD*ZERO     WL0001  30
     C                     MOVEL*BLANK    WL0002 10
     C                     MOVEL*BLANK    WL0003 40
      * Define local variables for subroutine SCRVGN.
     C                     Z-ADD*ZERO     WL0004  30
      * Define local variables for subroutine SKRVGN.
     C                     Z-ADD*ZERO     WL0005  30
      * Define local variables for subroutine SLDLRC.
     C                     Z-ADD*ZERO     WL0006  30
     C                     Z-ADD*ZERO     WL0007  70
     C                     MOVEL*BLANK    WL0008  3
     C                     Z-ADD*ZERO     WL0009  70
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field Header Status
     C                     MOVEL*BLANK    YL0002  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 PPSBUILD
