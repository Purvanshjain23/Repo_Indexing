// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PDYLXFR
// ?Date: 14.08.2025 Time: 03:33:38
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?Check other customer records
// WRK.USR Count = CND.EQ 0
WRK.USR_Count = *ZERO;

EXECUTE FUNCTION(VAL Parent B4 Delete   RT) TYPE(RTVOBJ) FILE(CABBREP)          AC1463214;
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(WRK.USR_Count);
{
 //?USER: Initialize routine

 // PAR.USR Count = CND.EQ 0
 PAR.USR_Count = *ZERO;

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 // PAR.USR Count = PAR.USR Count + CON.1
 PAR.USR_Count = PAR.USR_Count + 1;

 CASE;

 // IF PAR.USR Count is GT 1
 IF PAR.USR_Count > 1;

 // PGM.*Return code = CND.*Record already exists
 PGM.*Return_code = 'Y2U0003';

 QUIT;

 ENDIF;

}


CASE;

// IF WRK.USR Count is GT 1
IF WRK.USR_Count > 1;

// PAR.USR Return Code = CND.Exists
PAR.USR_Return_Code = 'E';

QUIT;

ENDIF;

//?Check for $ owed
// Call program CLC Contr.Tot Sum Inq  XF.
CALL PROGRAM(CLC Contr.Tot Sum Inq  XF) ('PDLZXFR');
PARAMETER(PAR.Ship_To_Customer);
PARAMETER(WRK.USR_Value_Open_Orders);
PARAMETER(WRK.USR_Parent_Current_Due);
PARAMETER(WRK.USR_Parent_Past_Due);
PARAMETER(WRK.USR_Parent_Total_Due);
PARAMETER(PAR.Company_Number);

CASE;

// IF WRK.USR Parent Total Due is Greater than zero
IF WRK.USR_Parent_Total_Due > *ZERO;

// PAR.USR Return Code = CND.$ Owed
PAR.USR_Return_Code = '$';

QUIT;

ENDIF;

// PAR.USR Return Code = CND.Does Not Exist
PAR.USR_Return_Code = 'N';

