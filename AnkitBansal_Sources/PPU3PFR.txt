// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPU3PFR
// ?Date: 14.08.2025 Time: 12:06:41
// ?------------------------------------------------------------------------------------------------

//?USER: Initialize program

EXECUTE FUNCTION(VAL Rtv & Ctr Prt Hdg  IF) TYPE(EXCINTFUN)                     AC1258755;
PARAMETER('OMS');

// WRK.First Time Flag = CND.Yes
WRK.First_Time_Flag = 'Y';

// WRK.Record Processed Usr = CND.No
WRK.Record_Processed_Usr = 'N';

//?USER: Record selection processing

CASE;

// IF DB1.Header Status is Cancelled
IF DB1.Header_Status = 'X';

// PGM.*Record selected = CND.*NO
PGM.*Record_selected = 'N';

ENDIF;

//?USER: Print required level headings

// SUPPRESSED PRINT Company Number header format

// SUPPRESSED PRINT Ship To Customer header format

// SUPPRESSED PRINT Order Date header format

//?USER: On print of detail format

//?** Default print values
// PGM.*Print format = CND.Print format
PGM.*Print_format = 'Y';

// WRK.Record Selected       USR = CND.no
WRK.Record_Selected_USR = 'N';

// WRK.From City = CON.*BLANK
WRK.From_City = *BLANK;

// WRK.From State = CON.*BLANK
WRK.From_State = *BLANK;

// WRK.To City = CON.*BLANK
WRK.To_City = *BLANK;

// WRK.To State State Code = CON.*BLANK
WRK.To_State_State_Code = *BLANK;

//?** See if there is a "Ship From City" and a "Ship To City" in
//?** the Mileage Between Cities file.
//?** See if city and state are in from context
// Call program Zzz Str to Upper Alpha XF.
CALL PROGRAM(Zzz Str to Upper Alpha XF) ('PMNAXFR');
PARAMETER(DB1.Ship_To_City);
PARAMETER(WRK.Ship_To_City);

// Call program Zzz Str to Upper Alpha XF.
CALL PROGRAM(Zzz Str to Upper Alpha XF) ('PMNAXFR');
PARAMETER(DB1.Ship_To_State_Code);
PARAMETER(WRK.Ship_To_State_Code);

EXECUTE FUNCTION(VAL MBC Exists-From CtyRT) TYPE(RTVOBJ) FILE(PDLFREP)          AC1856409;
PARAMETER(WRK.Ship_To_City);
PARAMETER(WRK.Ship_To_State_Code);

CASE;

// IF PGM.*Return code is *Record does not exist
IF PGM.*Return_code = 'Y2U0005';

// CUR.From City = WRK.Ship To City
CUR.From_City = WRK.Ship_To_City;

// CUR.From State = WRK.Ship To State Code
CUR.From_State = WRK.Ship_To_State_Code;

// WRK.Record Selected       USR = CND.yes
WRK.Record_Selected_USR = 'Y';

ENDIF;

//?** See if city and state are in to context
EXECUTE FUNCTION(Val Mileage Existance RT) TYPE(RTVOBJ) FILE(PDLFREP)           AC1557065;
PARAMETER(WRK.Ship_To_City);
PARAMETER(WRK.Ship_To_State_Code);
PARAMETER(WRK.Record_Found_USR);

CASE;

// IF WRK.Record Found USR is Record Not Found
IF WRK.Record_Found_USR = 'N';

// CUR.To City = WRK.Ship To City
CUR.To_City = WRK.Ship_To_City;

// CUR.To State State Code = WRK.Ship To State Code
CUR.To_State_State_Code = WRK.Ship_To_State_Code;

// WRK.Record Selected       USR = CND.yes
WRK.Record_Selected_USR = 'Y';

ENDIF;

CASE;

// IF WRK.Record Selected       USR is yes
IF WRK.Record_Selected_USR = 'Y';

EXECUTE FUNCTION(CRT From/To City Array CR) TYPE(CRTOBJ) ARRAY(ARY_From_To_City_AC1867689;
PARAMETER(CUR.From_City);
PARAMETER(CUR.From_State);
PARAMETER(CUR.To_City);
PARAMETER(CUR.To_State_State_Code);

CASE;

// IF PGM.*Return code is *Record already exists
IF PGM.*Return_code = 'Y2U0003';

// PGM.*Print format = CND.Do not print format
PGM.*Print_format = 'N';

ENDIF;

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Print format = CND.Do not print format
PGM.*Print_format = 'N';

ENDIF;

//?USER: Print required level totals

// SUPPRESSED PRINT Order Date totals format

// SUPPRESSED PRINT Ship To Customer totals format

// SUPPRESSED PRINT Company Number totals format

//?USER: On print of final totals format

EXECUTE FUNCTION(RTV From/To City Array RT) TYPE(RTVOBJ) ARRAY(ARY_From_To_City_AC1867690;
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(*BLANK);
PARAMETER(*BLANK);

