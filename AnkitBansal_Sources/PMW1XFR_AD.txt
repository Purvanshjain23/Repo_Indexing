// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PMW1XFR
// ?Date: 14.08.2025 Time: 03:44:23
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?*NOTE:  This must be compiled with Reclaim Resources = Yes
EXECUTE FUNCTION(RTV BOL-INV Email/Fax RT) TYPE(RTVOBJ) FILE(PDJ4CPP)           AC1892858;
PARAMETER(PAR.Job_Name_CDE);
PARAMETER(PAR.AR_Customer_Number);
PARAMETER(PAR.Company_Number);
PARAMETER(*BLANK);
PARAMETER(LCL.Use_Credit_Contact_Info);
PARAMETER(PAR.Spool_File_Selection_2);
{
 //?USER: Initialize routine

 EXECUTE FUNCTION(Rtv Plant Co/Org      RT) TYPE(RTVOBJ) FILE(PDJYREP)           AC1826265;
 PARAMETER(PAR.Company_Number);
 PARAMETER(NLL.Plant_Company_Sts);
 PARAMETER(LCL.Company_Organization);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 //?USER: Processing if Data record not found

 // PGM.*Return code = CND.*Record does not exist
 PGM.*Return_code = 'Y2U0005';

 //?USER: Process Data record

 //?FT1110 - If Company Org is "H"igh Plains, get BOL type from whse
 CASE;

 // IF LCL.Company Organization is High Plains Biodiesel
 IF LCL.Company_Organization = 'H';

 EXECUTE FUNCTION(RTV Whse/Non Cancelled RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1428700;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(LCL.Warehouse_Code);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  //?C2748:  Changed RTV Warehouse Code RT to exclude Cancelled lines.
  CASE;

  // IF DB1.Detail Line Status is Cancelled
  IF DB1.Detail_Line_Status = 'X';

  // IF *OTHERWISE
  IF *OTHERWISE;

  MOVE *ALL (To: PAR From: DB1);

  QUIT;

  ENDIF;

 }

 EXECUTE FUNCTION(RTV Load ID            RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1384375;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(LCL.Load_ID);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.Load ID is GT Zero
 IF LCL.Load_ID > *ZERO;

 EXECUTE FUNCTION(RTV HPB Transload Stn RT) TYPE(RTVOBJ) FILE(OMFLCPP)           AC1870349;
 PARAMETER(LCL.Load_ID);
 PARAMETER(DB1.Order_Number);
 PARAMETER(LCL.HPB_Transload_Station);
 {
  //?USER: Initialize routine

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(Rtv HPB fields        RT) TYPE(RTVOBJ) FILE(CAADREP)           AC1855470;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Production_Warehouse_Code);
 PARAMETER(LCL.Warehouse_Location);
 PARAMETER(LCL.WHS_Req_Meter_Reading_Shp);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 CASE;

 // IF LCL.WHS Req Meter Reading Shp is Yes
 IF LCL.WHS_Req_Meter_Reading_Shp = 'Y';

 // LCL.CDD Type = CND.Bill of Lading
 LCL.CDD_Type = 'BL';

 // Call program PRT Bill of Ld-HPB fax PF.
 CALL PROGRAM(PRT Bill of Ld-HPB fax PF) ('PMUCPFR');
 PARAMETER(LCL.Load_ID);
 PARAMETER(DB1.Company_Number);
 PARAMETER('N');

 //?output spool file name if any printed
 // PAR.Spool File Selection 2 = CON.PMUCPFR$
 PAR.Spool_File_Selection_2 = 'PMUCPFR$';

 // IF *OTHERWISE
 IF *OTHERWISE;

 ENDIF;

 ENDIF;

 ENDIF;

}


