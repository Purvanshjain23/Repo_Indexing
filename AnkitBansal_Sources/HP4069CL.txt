/***************************************************************** */
/*                                                                 */
/*  PROGRAM NUMBER:  HP4069CL                                      */
/*  PROGRAM NAME:    UC: CLEAR CULLSALE INTERFACE FILES TO ALLOW   */
/*                   A REDO                                        */
/*  PROGRAMMER:      LEANNE RAMSEY                                 */
/*  CREATE DATE:     08/18/09                                      */
/*                                                                 */
/*  FUNCTION:        THIS CL IS SUBMITTED WITH QCMDEXC FROM        */
/*                   HP4069.                                       */
/*                                                                 */
/*=================================================================*/
/*  Modification History:                                          */
/*                                                                 */
/*  01/19/2017 JBB E7986  Add Business Office as a parameter.  If  */
/*                        Business Office is 'OKLIV', set files to */
/*                        HSP2066 and HSP2068.  If Business Office */
/*                        is 'IFLIV', set files to HSP2067 and     */
/*                        HSP2069.                                 */
/*                                                                 */
/*******************************************************************/

             PGM        PARM(&BUSOFC)

             DCL        VAR(&USER) TYPE(*CHAR) LEN(10)
             DCL        VAR(&BUSOFC) TYPE(*CHAR) LEN(5)
             DCL        VAR(&RCVFILE) TYPE(*CHAR) LEN(10)
             DCL        VAR(&EDITFILE) TYPE(*CHAR) LEN(10)

/* SET FILE NAMES BASED ON BUSINESS OFFICE PARAMETER              */
             IF         COND(&BUSOFC = 'OKLIV') THEN(DO)
             CHGVAR     VAR(&RCVFILE) VALUE('HSP2066')
             CHGVAR     VAR(&EDITFILE) VALUE('HSP2067')
             ENDDO

             IF         COND(&BUSOFC = 'IFLIV') THEN(DO)
             CHGVAR     VAR(&RCVFILE) VALUE('HSP2068')
             CHGVAR     VAR(&EDITFILE) VALUE('HSP2069')
             ENDDO

/* RECEIVING FILE                                                  */

             ALCOBJ     OBJ((&RCVFILE *FILE *EXCL))
             MONMSG     MSGID(CPF0000) EXEC(DO)
             RTVJOBA    USER(&USER)
             SNDMSG     MSG('***** The Cull Sale Receiving File +
                          could not be cleared...the file is in +
                          use. *****') TOUSR(&USER)
             GOTO       CMDLBL(EDITING)
                        ENDDO

             CLRPFM     FILE(&RCVFILE)
             MONMSG     MSGID(CPF0000)

             DLCOBJ     OBJ((&RCVFILE *FILE *EXCL))
             MONMSG     MSGID(CPF0000)

EDITING:

             ALCOBJ     OBJ((&EDITFILE *FILE *EXCL))
             MONMSG     MSGID(CPF0000) EXEC(DO)
             RTVJOBA    USER(&USER)
             SNDMSG     MSG('***** The Cull Sale Editing File could +
                          not be cleared...the file is in use. +
                          *****') TOUSR(&USER)
             GOTO       CMDLBL(EXIT)
                        ENDDO

             CLRPFM     FILE(&EDITFILE)
             MONMSG     MSGID(CPF0000)

             DLCOBJ     OBJ((&EDITFILE *FILE *EXCL))
             MONMSG     MSGID(CPF0000)
EXIT:
             ENDPGM

