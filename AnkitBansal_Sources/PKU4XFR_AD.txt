// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PKU4XFR
// ?Date: 14.08.2025 Time: 02:53:00
// ?------------------------------------------------------------------------------------------------

//?Execute user function

// Call program Val Application/User  XF.
CALL PROGRAM(Val Application/User  XF) ('PDGXXFR');
PARAMETER(PAR.Oms_Warehouse_Code);
PARAMETER(PAR.CC_Company_Number);
PARAMETER('HPE');
PARAMETER(PAR.Oms_SalesPerson_Code);
PARAMETER(PAR.Oms_Allow_Multi_Company);
PARAMETER(PAR.Oms_Default_Printer);
PARAMETER(PAR.Oms_Name);
PARAMETER(PAR.Oms_System_Value_Alpha);
PARAMETER(PAR.Oms_Access_Denied_Y_N);

// Call program Rtv Prior Sunday      XF.
CALL PROGRAM(Rtv Prior Sunday      XF) ('PDLNXFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(JOB.*Job_date);
PARAMETER(LCL.Date_To_USR);

//?Saturday
// LCL.Date To   USR = LCL.Date To   USR + CON.-1 *DAYS
LCL.Date_To_USR = DATEINCR(LCL.Date_To_USR '-1' 'DY' 1111111 'NONE' 'N' 1);

//?Sunday
// LCL.Date From USR = LCL.Date To   USR + CON.-6 *DAYS
LCL.Date_From_USR = DATEINCR(LCL.Date_To_USR '-6' 'DY' 1111111 'NONE' 'N' 1);

// Call program Rtv Week Number       XF.
CALL PROGRAM(Rtv Week Number       XF) ('POEPXFR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Year_USR);
PARAMETER(LCL.Week_Number_USR);

// Call program Crt Std Deviation     UP.
CALL PROGRAM(Crt Std Deviation     UP) ('PKUUUPR');
PARAMETER(PAR.CC_Company_Number);
PARAMETER('W');
PARAMETER(LCL.Date_From_USR);
PARAMETER(LCL.Date_To_USR);
PARAMETER(*ZERO);
PARAMETER(LCL.Week_Number_USR);

