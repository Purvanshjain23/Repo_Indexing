     H/TITLE PMT Copy Order to Load PV Prompt & validate record
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Prompts fields, allowing user changes
     H* - Validates fields
     H* - If valid, performs an action
      *
     H* Generated by AllFusion 2E release 8.1SP2 (1250)
     H* Function type : Prompt & validate record
      *
     H* Company       : OMS Development Model         lopment-
     H* System        : OMS Development Model
     H* User name     : ISLBUSE
     H* Date          : 01/14/09  Time  : 18:00:29
     H* Copyright     : OMS Development Model         lopment-
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPMPAPVR#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: PMT Copy Order to Load PV Prompt & validate record
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPMAMREL1IF  E           K        DISK
      * RTV : Order Header Extension    Retrieval index
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOMFLCPL5IF  E           K        DISK
      * RSQ : Load Detail               Co/Load/Order
      *
     FOPEYCPL1IF  E           K        DISK
      * RTV : Order Events              Retrieval index       NV
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMCAREL1IF  E           K        DISK
      * RTV : COA Property Define Hdr   Retrieval index
      *
     FPMCCCPL3IF  E           K        DISK
      * RSQ : COA Batch Header          Comp, Whse, Batch Hdr St
      *
     FCAABREL1IF  E           K        DISK
      * RTV : Company Name and Address  Retrieval index       V
      *
     FPMCCCPL1IF  E           K        DISK
      * RTV : COA Batch Header          Retrieval index
      *
     FCAADREL3IF  E           K        DISK
      * RTV : Warehouse                 Active records only
      *
     FCADNREL2IF  E           K        DISK
      * RSQ : Application               RSQ Application Code
      *
     FCAASREL2IF  E           K        DISK
      * RTV : Company Control           Retrieval index       NV
      *
     FCAASREL0UF  E           K        DISK
      * UPD : Company Control           Update index
      *
     FOPBFCPL0IF  E           K        DISK                      A
      * UPD : Order Header TRG          Update index
      *
     FOMFLCPL0IF  E           K        DISK                      A
      * UPD : Load Detail               Update index
      *
     FPMAMREL0UF  E           K        DISK                      A
      * UPD : Order Header Extension    Update index
      *
     FOPEYCPL0IF  E           K        DISK                      A
      * UPD : Order Events              Update index
      *
     FOPBGWKL0IF  E           K        DISK                      A
      * UPD : Order Detail              Update index
      *
     E                    #L3         3  1
     E                    #L7         7  1
     E                    UCT        40  1               CENTER TABLE
      * DETAIL Screen: Field position and name array
     E                    W0BEG   7 014  5 0A
     E                    W0END   7 014  5 0A
     E                    W0NAM   7 014 10
     I@ASRECB
      * Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WAAIC3
     I              ASAXNB                          WAAXNB
     I              ASNGNB                          WANGNB
     I              ASBZNB                          WABZNB
     I              ASC5NB                          WAC5NB
     I              ASC3NB                          WAC3NB
     I              ASCYNB                          WACYNB
     I              ASIONB                          WAIONB
     I              ASI6NB                          WAI6NB
     I              ASDCNB                          WADCNB
     I              ASC7NB                          WAC7NB
     I              ASC2NB                          WAC2NB
     I              ASC1NB                          WAC1NB
     I              ASL8NB                          WAL8NB
     I              ASBANB                          WABANB
     I              ASCHST                          WACHST
     I              ASCKST                          WACKST
     I              ASCIST                          WACIST
     I              ASCGST                          WACGST
     I              ASAIPC                          WAAIPC
     I              ASASPC                          WAASPC
     I              ASA2VA                          WAA2VA
     I              ASC2ST                          WAC2ST
     I              ASD8ST                          WAD8ST
     I              ASD7ST                          WAD7ST
     I              ASA8NA                          WAA8NA
     I              ASA9NA                          WAA9NA
     I              ASBANA                          WABANA
     I              ASBBNA                          WABBNA
     I              ASEUST                          WAEUST
     I              ASAADY                          WAAADY
     I              ASABDY                          WAABDY
     I              ASACDY                          WAACDY
     I              ASADDY                          WAADDY
     I              ASAEDY                          WAAEDY
     I              ASAFDY                          WAAFDY
     I              ASAGDY                          WAAGDY
     I              ASAHDY                          WAAHDY
     I              ASAENB                          WAAENB
     I              ASALNB                          WAALNB
     I              ASEVNB                          WAEVNB
     I              ASRPOP                          WARPOP
     I              ASDWNB                          WADWNB
     I              ASR3NB                          WAR3NB
     I              ASPNST                          WAPNST
     I              ASR4NB                          WAR4NB
     I              ASPOST                          WAPOST
     I              ASSCNB                          WASCNB
     I              ASVIST                          WAVIST
     I              ASVJST                          WAVJST
     I              ASBVVN                          WABVVN
     I              ASUVST                          WAUVST
     I              ASUWST                          WAUWST
     I              ASUXST                          WAUXST
     I              ASVSST                          WAVSST
     I              ASAATM                          WAAATM
     I              ASAYNA                          WAAYNA
     I              ASA0NA                          WAA0NA
     I              ASAXDT                          WAAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     I@AMREJF
      * Order Header Extension    Retrieval index
      * Renamed input format fields
     I              AMAIC3                          WCAIC3
     I              AMC4NB                          WCC4NB
     I              AMRMNB                          WCRMNB
     I              AMRUNB                          WCRUNB
     I              AMXACD                          WCXACD
     I              AMOANA                          WCOANA
     I              AMHBAA                          WCHBAA
     I              AMJ0T1                          WCJ0T1
     I              AMGENY                          WCGENY
     I              AMJ1T1                          WCJ1T1
     I              AMHCAA                          WCHCAA
     I              AMQWDT                          WCQWDT
     I              AMQXDT                          WCQXDT
     I              AMQYDT                          WCQYDT
     I              AMHDAA                          WCHDAA
     I              AMCCTX                          WCCCTX
     I              AMJ2T1                          WCJ2T1
     I              AMRLNA                          WCRLNA
     I              AMRMNA                          WCRMNA
     I              AMGINY                          WCGINY
     I              AMGFNY                          WCGFNY
     I              AMGGNY                          WCGGNY
     I              AMGHNY                          WCGHNY
     I              AMHEVL                          WCHEVL
     I              AMHFVL                          WCHFVL
     I              AMHGVL                          WCHGVL
     I              AMQZDT                          WCQZDT
     I              AMQ0DT                          WCQ0DT
     I              AMQ1DT                          WCQ1DT
     I              AMQ2DT                          WCQ2DT
     I              AMC2TX                          WCC2TX
     I              AMC3TX                          WCC3TX
     I              AMC6TX                          WCC6TX
     I              AMCHTX                          WCCHTX
     I              AMCITX                          WCCITX
     I              AMCLTX                          WCCLTX
     I              AMB4TX                          WCB4TX
     I              AMCUTX                          WCCUTX
     I              AMCVTX                          WCCVTX
     I              AMB9TX                          WCB9TX
     I              AMITNY                          WCITNY
     I              AMLMT1                          WCLMT1
     I              AMUVST                          WCUVST
     I              AMUWST                          WCUWST
     I              AMUXST                          WCUXST
     I              AMVSST                          WCVSST
     I              AMAATM                          WCAATM
     I              AMAYNA                          WCAYNA
     I              AMA0NA                          WCA0NA
     I              AMAXDT                          WCAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WDRMNB
     I              FLRUNB                          WDRUNB
     I              FLRVNB                          WDRVNB
     I              FLDQTX                          WDDQTX
     I              FLRWNB                          WDRWNB
     I              FLRXNB                          WDRXNB
     I              FLSQNB                          WDSQNB
     I              FLT0NB                          WDT0NB
     I              FLT1NB                          WDT1NB
     I              FLR1NB                          WDR1NB
     I              FLAIC3                          WDAIC3
     I              FLC4NB                          WDC4NB
     I              FLVCST                          WDVCST
     I              FLKEDT                          WDKEDT
     I              FLSXNB                          WDSXNB
     I              FLKFDT                          WDKFDT
     I              FLACTM                          WDACTM
     I              FLK5TX                          WDK5TX
     I              FLW5CD                          WDW5CD
     I              FLEJDT                          WDEJDT
     I              FLAGTM                          WDAGTM
     I              FLKJDT                          WDKJDT
     I              FLATTM                          WDATTM
     I              FLHDDT                          WDHDDT
     I              FLAUTM                          WDAUTM
     I              FLKKDT                          WDKKDT
     I              FLAVTM                          WDAVTM
     I              FLZ4NB                          WDZ4NB
     I              FLY7ST                          WDY7ST
     I              FLY2ST                          WDY2ST
     I              FLWHTX                          WDWHTX
     I              FLWITX                          WDWITX
     I              FLWJTX                          WDWJTX
     I              FLWKTX                          WDWKTX
     I              FLWLTX                          WDWLTX
     I              FLN7DT                          WDN7DT
     I              FLN8DT                          WDN8DT
     I              FLN9DT                          WDN9DT
     I              FLB3TM                          WDB3TM
     I              FLB4TM                          WDB4TM
     I              FLB5TM                          WDB5TM
     I              FLIASX                          WDIASX
     I              FLIBSX                          WDIBSX
     I              FLICSX                          WDICSX
     I              FLWVTX                          WDWVTX
     I              FLWWTX                          WDWWTX
     I              FLWXTX                          WDWXTX
     I              FLUVST                          WDUVST
     I              FLUWST                          WDUWST
     I              FLUXST                          WDUXST
     I              FLAATM                          WDAATM
     I              FLAYNA                          WDAYNA
     I              FLA0NA                          WDA0NA
     I              FLAXDT                          WDAXDT
      *
     I@FLCPKF
      * Load Detail               Co/Load/Order
      * Renamed input format fields
     I              FLRMNB                          WERMNB
     I              FLRUNB                          WERUNB
     I              FLRVNB                          WERVNB
     I              FLDQTX                          WEDQTX
     I              FLRWNB                          WERWNB
     I              FLRXNB                          WERXNB
     I              FLSQNB                          WESQNB
     I              FLT0NB                          WET0NB
     I              FLT1NB                          WET1NB
     I              FLR1NB                          WER1NB
     I              FLAIC3                          WEAIC3
     I              FLC4NB                          WEC4NB
     I              FLVCST                          WEVCST
     I              FLKEDT                          WEKEDT
     I              FLSXNB                          WESXNB
     I              FLKFDT                          WEKFDT
     I              FLACTM                          WEACTM
     I              FLK5TX                          WEK5TX
     I              FLW5CD                          WEW5CD
     I              FLEJDT                          WEEJDT
     I              FLAGTM                          WEAGTM
     I              FLKJDT                          WEKJDT
     I              FLATTM                          WEATTM
     I              FLHDDT                          WEHDDT
     I              FLAUTM                          WEAUTM
     I              FLKKDT                          WEKKDT
     I              FLAVTM                          WEAVTM
     I              FLZ4NB                          WEZ4NB
     I              FLY7ST                          WEY7ST
     I              FLY2ST                          WEY2ST
     I              FLWHTX                          WEWHTX
     I              FLWITX                          WEWITX
     I              FLWJTX                          WEWJTX
     I              FLWKTX                          WEWKTX
     I              FLWLTX                          WEWLTX
     I              FLN7DT                          WEN7DT
     I              FLN8DT                          WEN8DT
     I              FLN9DT                          WEN9DT
     I              FLB3TM                          WEB3TM
     I              FLB4TM                          WEB4TM
     I              FLB5TM                          WEB5TM
     I              FLIASX                          WEIASX
     I              FLIBSX                          WEIBSX
     I              FLICSX                          WEICSX
     I              FLWVTX                          WEWVTX
     I              FLWWTX                          WEWWTX
     I              FLWXTX                          WEWXTX
     I              FLUVST                          WEUVST
     I              FLUWST                          WEUWST
     I              FLUXST                          WEUXST
     I              FLAATM                          WEAATM
     I              FLAYNA                          WEAYNA
     I              FLA0NA                          WEA0NA
     I              FLAXDT                          WEAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     I@AMREJE
      * Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     I@EYCPY2
      * Order Events              Retrieval index       NV
      * Renamed input format fields
     I              EYAIC3                          WHAIC3
     I              EYC4NB                          WHC4NB
     I              EYQ2NB                          WHQ2NB
     I              EYJPCD                          WHJPCD
     I              EYAUC3                          WHAUC3
     I              EYQ7NB                          WHQ7NB
     I              EYOMST                          WHOMST
     I              EYD2DT                          WHD2DT
     I              EYONST                          WHONST
     I              EYOOST                          WHOOST
     I              EYOPST                          WHOPST
     I              EYAWC3                          WHAWC3
     I              EYQ8NB                          WHQ8NB
     I              EYQ9NB                          WHQ9NB
     I              EYBKC7                          WHBKC7
     I              EYUVST                          WHUVST
     I              EYUWST                          WHUWST
     I              EYUXST                          WHUXST
     I              EYAATM                          WHAATM
     I              EYAYNA                          WHAYNA
     I              EYA0NA                          WHA0NA
     I              EYAXDT                          WHAXDT
      *
     I@EYCPY3
      * Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WJAIC3
     I              OMC4NB                          WJC4NB
     I              OMDPNB                          WJDPNB
     I              OMUENB                          WJUENB
     I              OMHGCD                          WJHGCD
     I              OMAJCD                          WJAJCD
     I              OMBKC7                          WJBKC7
     I              OMCFC7                          WJCFC7
     I              OMGMST                          WJGMST
     I              OMGNST                          WJGNST
     I              OMMAVA                          WJMAVA
     I              OMKDVA                          WJKDVA
     I              OML8VA                          WJL8VA
     I              OML9VA                          WJL9VA
     I              OMGTST                          WJGTST
     I              OMGVST                          WJGVST
     I              OMGUST                          WJGUST
     I              OMQFST                          WJQFST
     I              OMAYVA                          WJAYVA
     I              OMEXDT                          WJEXDT
     I              OMLQCD                          WJLQCD
     I              OMRDCD                          WJRDCD
     I              OMQ7CD                          WJQ7CD
     I              OMBZPR                          WJBZPR
     I              OML6NB                          WJL6NB
     I              OMU1ST                          WJU1ST
     I              OMGIDT                          WJGIDT
     I              OMCRCD                          WJCRCD
     I              OMAGCD                          WJAGCD
     I              OMRZST                          WJRZST
     I              OMR0ST                          WJR0ST
     I              OMR1ST                          WJR1ST
     I              OMG7NA                          WJG7NA
     I              OMG8NA                          WJG8NA
     I              OMRPCD                          WJRPCD
     I              OMVEST                          WJVEST
     I              OMVGST                          WJVGST
     I              OMAVST                          WJAVST
     I              OMU0ST                          WJU0ST
     I              OMRFCD                          WJRFCD
     I              OMFZST                          WJFZST
     I              OMR1NB                          WJR1NB
     I              OMAVQT                          WJAVQT
     I              OMD0WG                          WJD0WG
     I              OMCCQT                          WJCCQT
     I              OMAUWG                          WJAUWG
     I              OMCBQT                          WJCBQT
     I              OMATWG                          WJATWG
     I              OMAQCS                          WJAQCS
     I              OMAGCS                          WJAGCS
     I              OMAKPR                          WJAKPR
     I              OMALPR                          WJALPR
     I              OMAUPR                          WJAUPR
     I              OMAVWG                          WJAVWG
     I              OMA4WG                          WJA4WG
     I              OMA5DT                          WJA5DT
     I              OMAODT                          WJAODT
     I              OMGNDT                          WJGNDT
     I              OMAMST                          WJAMST
     I              OMANST                          WJANST
     I              OMVAST                          WJVAST
     I              OMRGNB                          WJRGNB
     I              OMRHNB                          WJRHNB
     I              OMRINB                          WJRINB
     I              OMRBCD                          WJRBCD
     I              OMHICD                          WJHICD
     I              OMRNCD                          WJRNCD
     I              OMROCD                          WJROCD
     I              OMCXDT                          WJCXDT
     I              OMAJVN                          WJAJVN
     I              OMKXCD                          WJKXCD
     I              OMJPCD                          WJJPCD
     I              OMCQCD                          WJCQCD
     I              OMR4CD                          WJR4CD
     I              OMZ1ST                          WJZ1ST
     I              OMZ3ST                          WJZ3ST
     I              OMZ4ST                          WJZ4ST
     I              OMDUPR                          WJDUPR
     I              OMB6VL                          WJB6VL
     I              OMA1AA                          WJA1AA
     I              OMFZSX                          WJFZSX
     I              OMF0SX                          WJF0SX
     I              OMF1SX                          WJF1SX
     I              OMF2SX                          WJF2SX
     I              OMF3SX                          WJF3SX
     I              OMF4SX                          WJF4SX
     I              OMF5SX                          WJF5SX
     I              OMF6SX                          WJF6SX
     I              OMF7SX                          WJF7SX
     I              OMNTDT                          WJNTDT
     I              OMNUDT                          WJNUDT
     I              OMNVDT                          WJNVDT
     I              OMNWDT                          WJNWDT
     I              OMNXDT                          WJNXDT
     I              OMBUTM                          WJBUTM
     I              OMBVTM                          WJBVTM
     I              OMBWTM                          WJBWTM
     I              OMBXTM                          WJBXTM
     I              OMBYTM                          WJBYTM
     I              OMH5NX                          WJH5NX
     I              OMH6NX                          WJH6NX
     I              OMH7NX                          WJH7NX
     I              OMH8NX                          WJH8NX
     I              OMH9NX                          WJH9NX
     I              OMDVPR                          WJDVPR
     I              OMDWPR                          WJDWPR
     I              OMDXPR                          WJDXPR
     I              OMDYPR                          WJDYPR
     I              OMDZPR                          WJDZPR
     I              OMUVST                          WJUVST
     I              OMUWST                          WJUWST
     I              OMUXST                          WJUXST
     I              OMAATM                          WJAATM
     I              OMAYNA                          WJAYNA
     I              OMA0NA                          WJA0NA
     I              OMAXDT                          WJAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WLAJCD
     I              ADF8NA                          WLF8NA
     I              ADACNA                          WLACNA
     I              ADADNA                          WLADNA
     I              ADAENA                          WLAENA
     I              ADAJNA                          WLAJNA
     I              ADBTTX                          WLBTTX
     I              ADAOCD                          WLAOCD
     I              ADBGCD                          WLBGCD
     I              ADVHST                          WLVHST
     I              ADMPNA                          WLMPNA
     I              ADWPST                          WLWPST
     I              ADXUST                          WLXUST
     I              ADT0ST                          WLT0ST
     I              ADT1ST                          WLT1ST
     I              ADDBNB                          WLDBNB
     I              ADT2ST                          WLT2ST
     I              ADT3ST                          WLT3ST
     I              ADT4ST                          WLT4ST
     I              ADT6ST                          WLT6ST
     I              ADBWC3                          WLBWC3
     I              ADBTC3                          WLBTC3
     I              ADBUC3                          WLBUC3
     I              ADBVC3                          WLBVC3
     I              ADFCAA                          WLFCAA
     I              ADRQSX                          WLRQSX
     I              ADRRSX                          WLRRSX
     I              ADRSSX                          WLRSSX
     I              ADRTSX                          WLRTSX
     I              ADT7ST                          WLT7ST
     I              ADT8ST                          WLT8ST
     I              ADRNSX                          WLRNSX
     I              ADROSX                          WLROSX
     I              ADRPSX                          WLRPSX
     I              ADUVST                          WLUVST
     I              ADUWST                          WLUWST
     I              ADUXST                          WLUXST
     I              ADVSST                          WLVSST
     I              ADAATM                          WLAATM
     I              ADAYNA                          WLAYNA
     I              ADA0NA                          WLA0NA
     I              ADAXDT                          WLAXDT
      *
     I@CAREOB
      * COA Property Define Hdr   Retrieval index
      * Renamed input format fields
     I              CAAIC3                          WMAIC3
     I              CAIDAA                          WMIDAA
     I              CAR2NA                          WMR2NA
     I              CAL2T1                          WML2T1
     I              CAL3T1                          WML3T1
     I              CAL4T1                          WML4T1
     I              CAL5T1                          WML5T1
     I              CAL6T1                          WML6T1
     I              CAL7T1                          WML7T1
     I              CAL8T1                          WML8T1
     I              CAL9T1                          WML9T1
     I              CAMAT1                          WMMAT1
     I              CAJCNY                          WMJCNY
     I              CAJDNY                          WMJDNY
     I              CAJENY                          WMJENY
     I              CAJFNY                          WMJFNY
     I              CAGMPC                          WMGMPC
     I              CAMBT1                          WMMBT1
     I              CAIEAA                          WMIEAA
     I              CAIFAA                          WMIFAA
     I              CAIGAA                          WMIGAA
     I              CAIHAA                          WMIHAA
     I              CAIIAA                          WMIIAA
     I              CAIJAA                          WMIJAA
     I              CAJQNY                          WMJQNY
     I              CALXST                          WMLXST
     I              CAJRNY                          WMJRNY
     I              CALYST                          WMLYST
     I              CAIMTX                          WMIMTX
     I              CAFEDS                          WMFEDS
     I              CAIBAA                          WMIBAA
     I              CAI1NY                          WMI1NY
     I              CAHCTU                          WMHCTU
     I              CAMCT1                          WMMCT1
     I              CAVSST                          WMVSST
     I              CAMJDT                          WMMJDT
     I              CABETM                          WMBETM
     I              CACCVN                          WMCCVN
     I              CACDVN                          WMCDVN
     I              CAMKDT                          WMMKDT
     I              CABFTM                          WMBFTM
     I              CACEVN                          WMCEVN
     I              CACFVN                          WMCFVN
      *
     I@CCCPPD
      * COA Batch Header          Comp, Whse, Batch Hdr St
      * Renamed input format fields
     I              CCAIC3                          WOAIC3
     I              CCI3NY                          WOI3NY
     I              CCIKAA                          WOIKAA
     I              CCIDAA                          WOIDAA
     I              CCRFDT                          WORFDT
     I              CCC2TM                          WOC2TM
     I              CCMHT1                          WOMHT1
     I              CCRGDT                          WORGDT
     I              CCC3TM                          WOC3TM
     I              CCMKT1                          WOMKT1
     I              CCJHNY                          WOJHNY
     I              CCR1NA                          WOR1NA
     I              CCRHDT                          WORHDT
     I              CCC4TM                          WOC4TM
     I              CCMIT1                          WOMIT1
     I              CCMJT1                          WOMJT1
     I              CCHXTX                          WOHXTX
     I              CCHJTX                          WOHJTX
     I              CCHYTX                          WOHYTX
     I              CCJENY                          WOJENY
     I              CCJVNY                          WOJVNY
     I              CCJWNY                          WOJWNY
     I              CCIMTX                          WOIMTX
     I              CCFEDS                          WOFEDS
     I              CCMTT1                          WOMTT1
     I              CCJXNY                          WOJXNY
     I              CCJ1NY                          WOJ1NY
     I              CCJCNY                          WOJCNY
     I              CCJDNY                          WOJDNY
     I              CCJ3NY                          WOJ3NY
     I              CCRLDT                          WORLDT
     I              CCVSST                          WOVSST
     I              CCMJDT                          WOMJDT
     I              CCBETM                          WOBETM
     I              CCCCVN                          WOCCVN
     I              CCCDVN                          WOCDVN
     I              CCMKDT                          WOMKDT
     I              CCBFTM                          WOBFTM
     I              CCCEVN                          WOCEVN
     I              CCCFVN                          WOCFVN
      *
     I@ABREAK
      * Company Name and Address  Retrieval index       V
      * Renamed input format fields
     I              ABAIC3                          WRAIC3
     I              ABADTX                          WRADTX
     I              ABACNA                          WRACNA
     I              ABADNA                          WRADNA
     I              ABAENA                          WRAENA
     I              ABAJNA                          WRAJNA
     I              ABBTTX                          WRBTTX
     I              ABBVTX                          WRBVTX
     I              ABBWTX                          WRBWTX
     I              ABA2NA                          WRA2NA
     I              ABABTX                          WRABTX
     I              ABBGCD                          WRBGCD
     I              ABKXCD                          WRKXCD
     I              ABUVST                          WRUVST
     I              ABUWST                          WRUWST
     I              ABUXST                          WRUXST
     I              ABVSST                          WRVSST
     I              ABAATM                          WRAATM
     I              ABAYNA                          WRAYNA
     I              ABA0NA                          WRA0NA
     I              ABAXDT                          WRAXDT
      *
     I@CCCPOH
      * COA Batch Header          Retrieval index
      * Renamed input format fields
     I              CCAIC3                          WSAIC3
     I              CCI3NY                          WSI3NY
     I              CCIKAA                          WSIKAA
     I              CCIDAA                          WSIDAA
     I              CCRFDT                          WSRFDT
     I              CCC2TM                          WSC2TM
     I              CCMHT1                          WSMHT1
     I              CCRGDT                          WSRGDT
     I              CCC3TM                          WSC3TM
     I              CCMKT1                          WSMKT1
     I              CCJHNY                          WSJHNY
     I              CCR1NA                          WSR1NA
     I              CCRHDT                          WSRHDT
     I              CCC4TM                          WSC4TM
     I              CCMIT1                          WSMIT1
     I              CCMJT1                          WSMJT1
     I              CCHXTX                          WSHXTX
     I              CCHJTX                          WSHJTX
     I              CCHYTX                          WSHYTX
     I              CCJENY                          WSJENY
     I              CCJVNY                          WSJVNY
     I              CCJWNY                          WSJWNY
     I              CCIMTX                          WSIMTX
     I              CCFEDS                          WSFEDS
     I              CCMTT1                          WSMTT1
     I              CCJXNY                          WSJXNY
     I              CCJ1NY                          WSJ1NY
     I              CCJCNY                          WSJCNY
     I              CCJDNY                          WSJDNY
     I              CCJ3NY                          WSJ3NY
     I              CCRLDT                          WSRLDT
     I              CCVSST                          WSVSST
     I              CCMJDT                          WSMJDT
     I              CCBETM                          WSBETM
     I              CCCCVN                          WSCCVN
     I              CCCDVN                          WSCDVN
     I              CCMKDT                          WSMKDT
     I              CCBFTM                          WSBFTM
     I              CCCEVN                          WSCEVN
     I              CCCFVN                          WSCFVN
      *
     I@ADRET1
      * Warehouse                 Active records only
      * Renamed input format fields
     I              ADAJCD                          WTAJCD
     I              ADF8NA                          WTF8NA
     I              ADACNA                          WTACNA
     I              ADADNA                          WTADNA
     I              ADAENA                          WTAENA
     I              ADAJNA                          WTAJNA
     I              ADBTTX                          WTBTTX
     I              ADAOCD                          WTAOCD
     I              ADBGCD                          WTBGCD
     I              ADVHST                          WTVHST
     I              ADMPNA                          WTMPNA
     I              ADWPST                          WTWPST
     I              ADXUST                          WTXUST
     I              ADT0ST                          WTT0ST
     I              ADT1ST                          WTT1ST
     I              ADDBNB                          WTDBNB
     I              ADT2ST                          WTT2ST
     I              ADT3ST                          WTT3ST
     I              ADT4ST                          WTT4ST
     I              ADT6ST                          WTT6ST
     I              ADBWC3                          WTBWC3
     I              ADBTC3                          WTBTC3
     I              ADBUC3                          WTBUC3
     I              ADBVC3                          WTBVC3
     I              ADFCAA                          WTFCAA
     I              ADRQSX                          WTRQSX
     I              ADRRSX                          WTRRSX
     I              ADRSSX                          WTRSSX
     I              ADRTSX                          WTRTSX
     I              ADT7ST                          WTT7ST
     I              ADT8ST                          WTT8ST
     I              ADRNSX                          WTRNSX
     I              ADROSX                          WTROSX
     I              ADRPSX                          WTRPSX
     I              ADUVST                          WTUVST
     I              ADUWST                          WTUWST
     I              ADUXST                          WTUXST
     I              ADVSST                          WTVSST
     I              ADAATM                          WTAATM
     I              ADAYNA                          WTAYNA
     I              ADA0NA                          WTA0NA
     I              ADAXDT                          WTAXDT
      *
     I@DNRESF
      * Application               RSQ Application Code
      * Renamed input format fields
     I              DNDNCD                          WVDNCD
     I              DNAUNA                          WVAUNA
     I              DNVKST                          WVVKST
     I              DNRSCD                          WVRSCD
     I              DNUVST                          WVUVST
     I              DNUWST                          WVUWST
     I              DNUXST                          WVUXST
     I              DNAATM                          WVAATM
     I              DNAYNA                          WVAYNA
     I              DNA0NA                          WVA0NA
     I              DNAXDT                          WVAXDT
      *
     I@ASREGT
      * Company Control           Retrieval index       NV
      * Renamed input format fields
     I              ASAIC3                          WWAIC3
     I              ASAXNB                          WWAXNB
     I              ASNGNB                          WWNGNB
     I              ASBZNB                          WWBZNB
     I              ASC5NB                          WWC5NB
     I              ASC3NB                          WWC3NB
     I              ASCYNB                          WWCYNB
     I              ASIONB                          WWIONB
     I              ASI6NB                          WWI6NB
     I              ASDCNB                          WWDCNB
     I              ASC7NB                          WWC7NB
     I              ASC2NB                          WWC2NB
     I              ASC1NB                          WWC1NB
     I              ASL8NB                          WWL8NB
     I              ASBANB                          WWBANB
     I              ASCHST                          WWCHST
     I              ASCKST                          WWCKST
     I              ASCIST                          WWCIST
     I              ASCGST                          WWCGST
     I              ASAIPC                          WWAIPC
     I              ASASPC                          WWASPC
     I              ASA2VA                          WWA2VA
     I              ASC2ST                          WWC2ST
     I              ASD8ST                          WWD8ST
     I              ASD7ST                          WWD7ST
     I              ASA8NA                          WWA8NA
     I              ASA9NA                          WWA9NA
     I              ASBANA                          WWBANA
     I              ASBBNA                          WWBBNA
     I              ASEUST                          WWEUST
     I              ASAADY                          WWAADY
     I              ASABDY                          WWABDY
     I              ASACDY                          WWACDY
     I              ASADDY                          WWADDY
     I              ASAEDY                          WWAEDY
     I              ASAFDY                          WWAFDY
     I              ASAGDY                          WWAGDY
     I              ASAHDY                          WWAHDY
     I              ASAENB                          WWAENB
     I              ASALNB                          WWALNB
     I              ASEVNB                          WWEVNB
     I              ASRPOP                          WWRPOP
     I              ASDWNB                          WWDWNB
     I              ASR3NB                          WWR3NB
     I              ASPNST                          WWPNST
     I              ASR4NB                          WWR4NB
     I              ASPOST                          WWPOST
     I              ASSCNB                          WWSCNB
     I              ASVIST                          WWVIST
     I              ASVJST                          WWVJST
     I              ASBVVN                          WWBVVN
     I              ASUVST                          WWUVST
     I              ASUWST                          WWUWST
     I              ASUXST                          WWUXST
     I              ASVSST                          WWVSST
     I              ASAATM                          WWAATM
     I              ASAYNA                          WWAYNA
     I              ASA0NA                          WWA0NA
     I              ASAXDT                          WWAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IQCAAS1    E DSCAASREL0
      * UPD : Company Control           Update index
      * Renamed input format fields
     I              ASAIC3                          WAAIC3
     I              ASAXNB                          WAAXNB
     I              ASNGNB                          WANGNB
     I              ASBZNB                          WABZNB
     I              ASC5NB                          WAC5NB
     I              ASC3NB                          WAC3NB
     I              ASCYNB                          WACYNB
     I              ASIONB                          WAIONB
     I              ASI6NB                          WAI6NB
     I              ASDCNB                          WADCNB
     I              ASC7NB                          WAC7NB
     I              ASC2NB                          WAC2NB
     I              ASC1NB                          WAC1NB
     I              ASL8NB                          WAL8NB
     I              ASBANB                          WABANB
     I              ASCHST                          WACHST
     I              ASCKST                          WACKST
     I              ASCIST                          WACIST
     I              ASCGST                          WACGST
     I              ASAIPC                          WAAIPC
     I              ASASPC                          WAASPC
     I              ASA2VA                          WAA2VA
     I              ASC2ST                          WAC2ST
     I              ASD8ST                          WAD8ST
     I              ASD7ST                          WAD7ST
     I              ASA8NA                          WAA8NA
     I              ASA9NA                          WAA9NA
     I              ASBANA                          WABANA
     I              ASBBNA                          WABBNA
     I              ASEUST                          WAEUST
     I              ASAADY                          WAAADY
     I              ASABDY                          WAABDY
     I              ASACDY                          WAACDY
     I              ASADDY                          WAADDY
     I              ASAEDY                          WAAEDY
     I              ASAFDY                          WAAFDY
     I              ASAGDY                          WAAGDY
     I              ASAHDY                          WAAHDY
     I              ASAENB                          WAAENB
     I              ASALNB                          WAALNB
     I              ASEVNB                          WAEVNB
     I              ASRPOP                          WARPOP
     I              ASDWNB                          WADWNB
     I              ASR3NB                          WAR3NB
     I              ASPNST                          WAPNST
     I              ASR4NB                          WAR4NB
     I              ASPOST                          WAPOST
     I              ASSCNB                          WASCNB
     I              ASVIST                          WAVIST
     I              ASVJST                          WAVJST
     I              ASBVVN                          WABVVN
     I              ASUVST                          WAUVST
     I              ASUWST                          WAUWST
     I              ASUXST                          WAUXST
     I              ASVSST                          WAVSST
     I              ASAATM                          WAAATM
     I              ASAYNA                          WAAYNA
     I              ASA0NA                          WAA0NA
     I              ASAXDT                          WAAXDT
      *
     IYARDCS      DS                            278
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WBAIC3
     I              BEC4NB                          WBC4NB
     I              BEJNCD                          WBJNCD
     I              BEANC7                          WBANC7
     I              BEBKC7                          WBBKC7
     I              BEBRTX                          WBBRTX
     I              BEHMNA                          WBHMNA
     I              BEHONA                          WBHONA
     I              BEHPNA                          WBHPNA
     I              BEHNNA                          WBHNNA
     I              BEDBCD                          WBDBCD
     I              BECKTX                          WBCKTX
     I              BEB0C7                          WBB0C7
     I              BEAETX                          WBAETX
     I              BEB1NA                          WBB1NA
     I              BEB3NA                          WBB3NA
     I              BEB4NA                          WBB4NA
     I              BEB2NA                          WBB2NA
     I              BEBHCD                          WBBHCD
     I              BEC8TX                          WBC8TX
     I              BEBCNA                          WBBCNA
     I              BEA0DT                          WBA0DT
     I              BEA5DT                          WBA5DT
     I              BEGNDT                          WBGNDT
     I              BEACDT                          WBACDT
     I              BEAQCD                          WBAQCD
     I              BEB6NA                          WBB6NA
     I              BEBYNA                          WBBYNA
     I              BEBZNA                          WBBZNA
     I              BEGTST                          WBGTST
     I              BEGVST                          WBGVST
     I              BEGUST                          WBGUST
     I              BEQFST                          WBQFST
     I              BECQCD                          WBCQCD
     I              BEGJST                          WBGJST
     I              BEGWST                          WBGWST
     I              BEGXST                          WBGXST
     I              BEGYST                          WBGYST
     I              BEAODT                          WBAODT
     I              BEAIVN                          WBAIVN
     I              BECXDT                          WBCXDT
     I              BEJZVA                          WBJZVA
     I              BEA1WG                          WBA1WG
     I              BEXIST                          WBXIST
     I              BEXJST                          WBXJST
     I              BEXKST                          WBXKST
     I              BEEIDT                          WBEIDT
     I              BEAFTM                          WBAFTM
     I              BEE8CD                          WBE8CD
     I              BEE9CD                          WBE9CD
     I              BERMNB                          WBRMNB
     I              BETBNB                          WBTBNB
     I              BER1NB                          WBR1NB
     I              BEPJST                          WBPJST
     I              BEU0ST                          WBU0ST
     I              BEU1ST                          WBU1ST
     I              BEQ2CD                          WBQ2CD
     I              BEU2ST                          WBU2ST
     I              BEVEST                          WBVEST
     I              BEVFST                          WBVFST
     I              BEVGST                          WBVGST
     I              BERPCD                          WBRPCD
     I              BERNNB                          WBRNNB
     I              BEVDST                          WBVDST
     I              BEATIN                          WBATIN
     I              BEU4ST                          WBU4ST
     I              BEU5ST                          WBU5ST
     I              BERSRN                          WBRSRN
     I              BEMHNA                          WBMHNA
     I              BEMINA                          WBMINA
     I              BEWBST                          WBWBST
     I              BER4CD                          WBR4CD
     I              BEBFCD                          WBBFCD
     I              BEQ4CD                          WBQ4CD
     I              BET3NB                          WBT3NB
     I              BESICD                          WBSICD
     I              BECONB                          WBCONB
     I              BECEST                          WBCEST
     I              BEAWDT                          WBAWDT
     I              BEJPCD                          WBJPCD
     I              BEXUST                          WBXUST
     I              BEZ1ST                          WBZ1ST
     I              BEVRVA                          WBVRVA
     I              BEOBST                          WBOBST
     I              BEBCST                          WBBCST
     I              BEBDST                          WBBDST
     I              BEB7VL                          WBB7VL
     I              BEGASX                          WBGASX
     I              BEGBSX                          WBGBSX
     I              BEGCSX                          WBGCSX
     I              BEGDSX                          WBGDSX
     I              BEFNSX                          WBFNSX
     I              BEFOSX                          WBFOSX
     I              BEFPSX                          WBFPSX
     I              BEFQSX                          WBFQSX
     I              BEFRSX                          WBFRSX
     I              BEFSSX                          WBFSSX
     I              BEFTSX                          WBFTSX
     I              BEFUSX                          WBFUSX
     I              BEFVSX                          WBFVSX
     I              BEFWSX                          WBFWSX
     I              BEFXSX                          WBFXSX
     I              BEFYSX                          WBFYSX
     I              BENODT                          WBNODT
     I              BENPDT                          WBNPDT
     I              BENQDT                          WBNQDT
     I              BENRDT                          WBNRDT
     I              BENSDT                          WBNSDT
     I              BEBPTM                          WBBPTM
     I              BEBQTM                          WBBQTM
     I              BEBRTM                          WBBRTM
     I              BEBSTM                          WBBSTM
     I              BEBTTM                          WBBTTM
     I              BEH0NX                          WBH0NX
     I              BEH1NX                          WBH1NX
     I              BEH2NX                          WBH2NX
     I              BEH3NX                          WBH3NX
     I              BEH4NX                          WBH4NX
     I              BEC0C7                          WBC0C7
     I              BEUVST                          WBUVST
     I              BEUWST                          WBUWST
     I              BEUXST                          WBUXST
     I              BEAATM                          WBAATM
     I              BEAYNA                          WBAYNA
     I              BEA0NA                          WBA0NA
     I              BEAXDT                          WBAXDT
      *
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WFRMNB
     I              FLRUNB                          WFRUNB
     I              FLRVNB                          WFRVNB
     I              FLDQTX                          WFDQTX
     I              FLRWNB                          WFRWNB
     I              FLRXNB                          WFRXNB
     I              FLSQNB                          WFSQNB
     I              FLT0NB                          WFT0NB
     I              FLT1NB                          WFT1NB
     I              FLR1NB                          WFR1NB
     I              FLAIC3                          WFAIC3
     I              FLC4NB                          WFC4NB
     I              FLVCST                          WFVCST
     I              FLKEDT                          WFKEDT
     I              FLSXNB                          WFSXNB
     I              FLKFDT                          WFKFDT
     I              FLACTM                          WFACTM
     I              FLK5TX                          WFK5TX
     I              FLW5CD                          WFW5CD
     I              FLEJDT                          WFEJDT
     I              FLAGTM                          WFAGTM
     I              FLKJDT                          WFKJDT
     I              FLATTM                          WFATTM
     I              FLHDDT                          WFHDDT
     I              FLAUTM                          WFAUTM
     I              FLKKDT                          WFKKDT
     I              FLAVTM                          WFAVTM
     I              FLZ4NB                          WFZ4NB
     I              FLY7ST                          WFY7ST
     I              FLY2ST                          WFY2ST
     I              FLWHTX                          WFWHTX
     I              FLWITX                          WFWITX
     I              FLWJTX                          WFWJTX
     I              FLWKTX                          WFWKTX
     I              FLWLTX                          WFWLTX
     I              FLN7DT                          WFN7DT
     I              FLN8DT                          WFN8DT
     I              FLN9DT                          WFN9DT
     I              FLB3TM                          WFB3TM
     I              FLB4TM                          WFB4TM
     I              FLB5TM                          WFB5TM
     I              FLIASX                          WFIASX
     I              FLIBSX                          WFIBSX
     I              FLICSX                          WFICSX
     I              FLWVTX                          WFWVTX
     I              FLWWTX                          WFWWTX
     I              FLWXTX                          WFWXTX
     I              FLUVST                          WFUVST
     I              FLUWST                          WFUWST
     I              FLUXST                          WFUXST
     I              FLAATM                          WFAATM
     I              FLAYNA                          WFAYNA
     I              FLA0NA                          WFA0NA
     I              FLAXDT                          WFAXDT
      *
     IQPMAM1    E DSPMAMREL0
      * UPD : Order Header Extension    Update index
      * Renamed input format fields
     I              AMAIC3                          WGAIC3
     I              AMC4NB                          WGC4NB
     I              AMRMNB                          WGRMNB
     I              AMRUNB                          WGRUNB
     I              AMXACD                          WGXACD
     I              AMOANA                          WGOANA
     I              AMHBAA                          WGHBAA
     I              AMJ0T1                          WGJ0T1
     I              AMGENY                          WGGENY
     I              AMJ1T1                          WGJ1T1
     I              AMHCAA                          WGHCAA
     I              AMQWDT                          WGQWDT
     I              AMQXDT                          WGQXDT
     I              AMQYDT                          WGQYDT
     I              AMHDAA                          WGHDAA
     I              AMCCTX                          WGCCTX
     I              AMJ2T1                          WGJ2T1
     I              AMRLNA                          WGRLNA
     I              AMRMNA                          WGRMNA
     I              AMGINY                          WGGINY
     I              AMGFNY                          WGGFNY
     I              AMGGNY                          WGGGNY
     I              AMGHNY                          WGGHNY
     I              AMHEVL                          WGHEVL
     I              AMHFVL                          WGHFVL
     I              AMHGVL                          WGHGVL
     I              AMQZDT                          WGQZDT
     I              AMQ0DT                          WGQ0DT
     I              AMQ1DT                          WGQ1DT
     I              AMQ2DT                          WGQ2DT
     I              AMC2TX                          WGC2TX
     I              AMC3TX                          WGC3TX
     I              AMC6TX                          WGC6TX
     I              AMCHTX                          WGCHTX
     I              AMCITX                          WGCITX
     I              AMCLTX                          WGCLTX
     I              AMB4TX                          WGB4TX
     I              AMCUTX                          WGCUTX
     I              AMCVTX                          WGCVTX
     I              AMB9TX                          WGB9TX
     I              AMITNY                          WGITNY
     I              AMLMT1                          WGLMT1
     I              AMUVST                          WGUVST
     I              AMUWST                          WGUWST
     I              AMUXST                          WGUXST
     I              AMVSST                          WGVSST
     I              AMAATM                          WGAATM
     I              AMAYNA                          WGAYNA
     I              AMA0NA                          WGA0NA
     I              AMAXDT                          WGAXDT
      *
     IYBRDCS      DS                            427
     IQOPEY1    E DSOPEYCPL0
      * UPD : Order Events              Update index
      * Renamed input format fields
     I              EYAIC3                          WIAIC3
     I              EYC4NB                          WIC4NB
     I              EYQ2NB                          WIQ2NB
     I              EYJPCD                          WIJPCD
     I              EYAUC3                          WIAUC3
     I              EYQ7NB                          WIQ7NB
     I              EYOMST                          WIOMST
     I              EYD2DT                          WID2DT
     I              EYONST                          WIONST
     I              EYOOST                          WIOOST
     I              EYOPST                          WIOPST
     I              EYAWC3                          WIAWC3
     I              EYQ8NB                          WIQ8NB
     I              EYQ9NB                          WIQ9NB
     I              EYBKC7                          WIBKC7
     I              EYUVST                          WIUVST
     I              EYUWST                          WIUWST
     I              EYUXST                          WIUXST
     I              EYAATM                          WIAATM
     I              EYAYNA                          WIAYNA
     I              EYA0NA                          WIA0NA
     I              EYAXDT                          WIAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WKAIC3
     I              OMC4NB                          WKC4NB
     I              OMDPNB                          WKDPNB
     I              OMUENB                          WKUENB
     I              OMHGCD                          WKHGCD
     I              OMAJCD                          WKAJCD
     I              OMBKC7                          WKBKC7
     I              OMCFC7                          WKCFC7
     I              OMGMST                          WKGMST
     I              OMGNST                          WKGNST
     I              OMMAVA                          WKMAVA
     I              OMKDVA                          WKKDVA
     I              OML8VA                          WKL8VA
     I              OML9VA                          WKL9VA
     I              OMGTST                          WKGTST
     I              OMGVST                          WKGVST
     I              OMGUST                          WKGUST
     I              OMQFST                          WKQFST
     I              OMAYVA                          WKAYVA
     I              OMEXDT                          WKEXDT
     I              OMLQCD                          WKLQCD
     I              OMRDCD                          WKRDCD
     I              OMQ7CD                          WKQ7CD
     I              OMBZPR                          WKBZPR
     I              OML6NB                          WKL6NB
     I              OMU1ST                          WKU1ST
     I              OMGIDT                          WKGIDT
     I              OMCRCD                          WKCRCD
     I              OMAGCD                          WKAGCD
     I              OMRZST                          WKRZST
     I              OMR0ST                          WKR0ST
     I              OMR1ST                          WKR1ST
     I              OMG7NA                          WKG7NA
     I              OMG8NA                          WKG8NA
     I              OMRPCD                          WKRPCD
     I              OMVEST                          WKVEST
     I              OMVGST                          WKVGST
     I              OMAVST                          WKAVST
     I              OMU0ST                          WKU0ST
     I              OMRFCD                          WKRFCD
     I              OMFZST                          WKFZST
     I              OMR1NB                          WKR1NB
     I              OMAVQT                          WKAVQT
     I              OMD0WG                          WKD0WG
     I              OMCCQT                          WKCCQT
     I              OMAUWG                          WKAUWG
     I              OMCBQT                          WKCBQT
     I              OMATWG                          WKATWG
     I              OMAQCS                          WKAQCS
     I              OMAGCS                          WKAGCS
     I              OMAKPR                          WKAKPR
     I              OMALPR                          WKALPR
     I              OMAUPR                          WKAUPR
     I              OMAVWG                          WKAVWG
     I              OMA4WG                          WKA4WG
     I              OMA5DT                          WKA5DT
     I              OMAODT                          WKAODT
     I              OMGNDT                          WKGNDT
     I              OMAMST                          WKAMST
     I              OMANST                          WKANST
     I              OMVAST                          WKVAST
     I              OMRGNB                          WKRGNB
     I              OMRHNB                          WKRHNB
     I              OMRINB                          WKRINB
     I              OMRBCD                          WKRBCD
     I              OMHICD                          WKHICD
     I              OMRNCD                          WKRNCD
     I              OMROCD                          WKROCD
     I              OMCXDT                          WKCXDT
     I              OMAJVN                          WKAJVN
     I              OMKXCD                          WKKXCD
     I              OMJPCD                          WKJPCD
     I              OMCQCD                          WKCQCD
     I              OMR4CD                          WKR4CD
     I              OMZ1ST                          WKZ1ST
     I              OMZ3ST                          WKZ3ST
     I              OMZ4ST                          WKZ4ST
     I              OMDUPR                          WKDUPR
     I              OMB6VL                          WKB6VL
     I              OMA1AA                          WKA1AA
     I              OMFZSX                          WKFZSX
     I              OMF0SX                          WKF0SX
     I              OMF1SX                          WKF1SX
     I              OMF2SX                          WKF2SX
     I              OMF3SX                          WKF3SX
     I              OMF4SX                          WKF4SX
     I              OMF5SX                          WKF5SX
     I              OMF6SX                          WKF6SX
     I              OMF7SX                          WKF7SX
     I              OMNTDT                          WKNTDT
     I              OMNUDT                          WKNUDT
     I              OMNVDT                          WKNVDT
     I              OMNWDT                          WKNWDT
     I              OMNXDT                          WKNXDT
     I              OMBUTM                          WKBUTM
     I              OMBVTM                          WKBVTM
     I              OMBWTM                          WKBWTM
     I              OMBXTM                          WKBXTM
     I              OMBYTM                          WKBYTM
     I              OMH5NX                          WKH5NX
     I              OMH6NX                          WKH6NX
     I              OMH7NX                          WKH7NX
     I              OMH8NX                          WKH8NX
     I              OMH9NX                          WKH9NX
     I              OMDVPR                          WKDVPR
     I              OMDWPR                          WKDWPR
     I              OMDXPR                          WKDXPR
     I              OMDYPR                          WKDYPR
     I              OMDZPR                          WKDZPR
     I              OMUVST                          WKUVST
     I              OMUWST                          WKUWST
     I              OMUXST                          WKUXST
     I              OMAATM                          WKAATM
     I              OMAYNA                          WKAYNA
     I              OMA0NA                          WKA0NA
     I              OMAXDT                          WKAXDT
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Order Header TRG
      * I : MAP Company Number
     I                                    P   1   20P1AIC3
      * I : MAP Order Number
     I                                    P   3   60P1C4NB
      * I : MAP Load ID
     I                                    P   7  100P1RMNB
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Order created for shippi'
      * USR Next Order Number
     I                                    P   1   40ZA0001
      * COA Active Whse/Tank
     I                                        5   7 ZA0002
      * Message data for 'Order number already exi'
      * USR Next Order Number
     I                                    P   1   40ZA0003
      * Message data for 'Warehouse must be differ'
      * COA Active Whse/Tank
     I                                        1   3 ZA0004
      * Message data for 'Warehouse cant ship f/co'
      * Warehouse Code
     I                                        1   3 ZA0005
      * Company Number
     I                                        4   6 ZA0006
      * Message data for 'Warehouse entered is not'
      * COA Active Whse/Tank
     I                                        1   3 ZA0007
      * Message data for 'Bio-diesel fuel code mus'
      * COA Active Whse/Tank
     I                                        1   3 ZA0008
      * COA Bio-diesel Fuel Code
     I                                        4   9 ZA0009
      * Message data for 'The Warehouse must be 'O'
      * COA Active Whse/Tank
     I                                        1   3 ZA0010
      * Message data for 'Warehouse              NF'
      * Warehouse Code
     I                                        1   3 ZA0011
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1AIC3    PARM           WP0001  30       Company Number
     C           P1C4NB    PARM           WP0002  70       Order Number
     C           P1RMNB    PARM           WP0003  70       Load ID
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Conduct screen conversation
     C                     DO   *HIVAL
      * Start new transaction
     C                     MOVEL'Y'       W0TRN   1
      * Process current transaction
     C           W0TRN     DOWEQ'Y'
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Display screen
     C                     EXSR CAEXFM
      * Process response
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * HOME: Reset screen fields
     C   30                CAS            MALDSC
      * Process screen input
     C                     CAS            DAPRSC
     C                     END
      *
     C                     END
      *
     C                     END
      *****************************************************************
      /EJECT
     CSR         CAEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         DAPRSC    BEGSR
      *================================================================
      * Process screen input
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate screen input
     C                     EXSR DBVLSC
      * If error, exit
     C           *IN99     CABEQ'1'       DAEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       DAEXIT
      * Prompt for confirmation
     C                     EXSR DHPMCF
      * Quit if not confirmed
     C           *IN99     CABEQ'1'       DAEXIT
      * USER: User defined action
     C                     Z-ADD#DM1NB    YL0001           USR Next Order
      * RTV for crt from cpy   RT - Order Header TRG  * 
     C                     EXSR SARVGN
      * EDT Post Open Orders   XF - Order Header TRG  * 
     C                     CALL 'PDHRXFR'              90  EDT Post Open O
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1AIC3    WQ0003  30       Company Number
     C                     PARM YL0001    WQ0004  70       Order Number
     C                     PARM YL0005    WQ0005  70       Ship To Custome
     C           YL0006    PARM YL0006    WQ0006 112       Order Value Tot
     C                     PARM *ZERO     WQ0007 112       Order Weight To
     C                     PARM 'SHP'     WQ0008  3        Pricing Event C
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHRXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Setup message data for message
     C                     Z-ADDYL0001    ZA0001           USR Next Order
     C                     MOVEL#DIEAA    ZA0002           COA Active Whse
      * Send message 'Order created for shippi'
     C                     MOVEL'USR3836' ZAMSID
     C                     MOVEL'*INFO  ' ZAMSTP           Message type
     C                     EXSR ZASNMS
      *
      * Exit program
     C                     EXSR ZXEXPG
      *================================================================
     CSR         DAEXIT    ENDSR
      /EJECT
     CSR         DBVLSC    BEGSR
      *================================================================
      * Validate screen input
      *================================================================
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate fields
      * Prompt on Warehouse
      * CASE: DTL.*CMD key is *Prompt
     C           *IN04     IFEQ '1'                        *IF
      * CASE: PGM.*Cursor field <IS> DTL.COA Active Whse/Tank 1
     C           W0CFL     IFEQ '#DIEAA'                   *IF
      * SEL ShipCo/Warehouse   SR - Warehouse  * 
     C                     CALL 'PPHQSRR'              90  SEL ShipCo/Ware
     C                     PARM *BLANK    W0RTN   7
     C           #DIEAA    PARM #DIEAA    WQ0009  3        Warehouse Code
     C                     PARM #1AIC3    WQ0010  30       Shipping Compan
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PPHQSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     9932  *
     C                     END
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * Bypass ref file checks if error already detected
     C   99                GOTO DBEXIT
      * Select existing record
     C                     EXSR VACKRL
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate relations
      * Validate new order number if entered
      * CASE: DTL.USR Next Order Number is Not equal to zeros
     C           #DM1NB    IFNE *ZERO                      *IF
      * RTV Chk Order Exist    RT - Order Header TRG  * 
     C                     EXSR SNRVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     Z-ADD#DM1NB    ZA0003           USR Next Order
      * Send message 'Order number already exi'
     C                     MOVEL'USR3835' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * Can't enter the same warehouse
      * CASE: DTL.COA Active Whse/Tank EQ DTL.COA Active Whse/Tank 1
     C           #DIKAA    IFEQ #DIEAA                     *IF
      * Setup message data for message
     C                     MOVEL#DIEAA    ZA0004           COA Active Whse
      * Send message 'Warehouse must be differ'
     C                     MOVEL'USR3837' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     GOTO DBEXIT                     *QUIT
     C                     END                             *FI
      * Validate Warehouse
      * CASE: DTL.COA Active Whse/Tank 1 is Warehouse Code not Blank
     C           #DIEAA    IFNE *BLANK                     *IF
      * RTV Shipping Co,Desc   RT - Warehouse  * 
     C                     EXSR SORVGN
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
      * Error if Company can't ship from this warehouse
      * CASE: DTL.Company Number NE LCL.Shipping Company
     C           #1AIC3    IFNE YL0007                     *IF
      * Setup message data for message
     C                     MOVEL#DIEAA    ZA0005           COA Active Whse
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    ZA0006           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    ZA0006           CD3 Ext Numeric
     C                     END                             *FI
      * Send message 'Warehouse cant ship f/co'
     C                     MOVEL'USR3362' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
      * RTV Bio-d Code for Whs RT - COA Property Define Hdr  * 
     C                     EXSR SPRVGN
      * Error if Warehouse not on COA Prop Def Hdr
      * CASE: DTL.USR Bio-diesel fuel code is Not entered
     C           #DILAA    IFEQ *BLANK                     *IF
      * Setup message data for message
     C                     MOVEL#DIEAA    ZA0007           COA Active Whse
      * Send message 'Warehouse entered is not'
     C                     MOVEL'USR3814' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DTL.COA Bio-diesel Fuel Code NE DTL.USR Bio-diesel fuel cod
     C           #DIDAA    IFNE #DILAA                     *IF
      * Setup message data for message
     C                     MOVEL#DIEAA    ZA0008           COA Active Whse
     C                     MOVEL#DILAA    ZA0009           USR Bio-diesel
      * Send message 'Bio-diesel fuel code mus'
     C                     MOVEL'USR3834' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * RTV Check for Warehse  RT - COA Batch Header  * 
     C                     EXSR SQRVGN
      * Error if Warehouse is not 'Open' for shipping
      * CASE: PGM.*Return code is *Normal
     C           W0RTN     IFEQ *BLANK                     *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DIEAA    ZA0010           COA Active Whse
      * Send message 'The Warehouse must be 'O'
     C                     MOVEL'USR3832' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Setup message data for message
     C                     MOVEL#DIEAA    ZA0011           COA Active Whse
      * Send message 'Warehouse              NF'
     C                     MOVEL'USR0007' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9932  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END
      * COA Active Whse/Tank 1 required
     C           #DIEAA    IFEQ *BLANK                     IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DBEXIT    ENDSR
      /EJECT
     CSR         DHPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Convert fields to external form
     C                     EXSR MNCV#1
      * Set screen conditioning indicators
     C                     EXSR GADSA1
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO DHEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'CAVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         DHEXIT    ENDSR
      /EJECT
     CSR         GADSA1    BEGSR
      *================================================================
      * Set display attributes for screen
      *================================================================
     C                     MOVEL'0'       *IN79
     C           YL0008    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         MALDSC    BEGSR
      *================================================================
      * Load screen from passed parameters
      *================================================================
     C                     Z-ADDP1AIC3    #1AIC3           Company Number
      * Clear external version also
     C                     MOVEL*BLANK    V1AIC3
     C                     MOVEL*BLANK    #DADTX           Name
     C                     Z-ADDP1C4NB    #1C4NB           Order Number
      * Clear external version also
     C                     MOVEL*BLANK    V1C4NB
     C                     MOVEL*BLANK    #DIKAA           COA Active Whse
     C                     MOVEL*BLANK    #DAVNA           Description Lin
     C                     MOVEL*BLANK    #DIDAA           COA Bio-diesel
     C                     MOVEL*BLANK    #DR2NA           COA Bio-dsl Fue
     C                     Z-ADD*ZERO     #DI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     #DM1NB           USR Next Order
     C                     MOVEL*BLANK    #DIEAA           COA Active Whse
     C                     MOVEL*BLANK    #DAUNA           Description
     C                     MOVEL*BLANK    #DILAA           USR Bio-diesel
     C                     MOVEL*BLANK    #DP9NA           Description USR
     C                     Z-ADD*ZERO     #DJINY           Batch Number 5.
      * USER: Load screen
      * RTV Company Name Only  RT - Company Name and Address  * 
     C                     EXSR SRRVGN
      * RTV Ship Cust,Ordr Typ RT - Order Header TRG  * 
     C                     EXSR SSRVGN
      * RTV HPB fields         RT - Order Header Extension  * 
     C                     EXSR STRVGN
      * RTV all used fields    RT - COA Batch Header  * 
     C                     EXSR SURVGN
      * RTV Description        RT - COA Property Define Hdr  * 
     C                     EXSR SVRVGN
      * RTV Whse Descrip       RT - Warehouse  * 
     C                     EXSR SWRVGN
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MNCV#1    BEGSR
      *================================================================
      * Convert fields into external form
      *================================================================
      * Convert Company Number to external.
      * CD3 Int/Ext
      * CASE: PAR.CD3 Int Numeric Key is not equal zero
     C           #1AIC3    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUDMCD           CD3 Ext Numeric
     C                     MOVEL#1AIC3    WUDMCD           CD3 Ext Numeric
      * CD3 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUDMCD    #L3              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   3
     C           #L3,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L3,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L3       WUDMCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUDMCD    V1AIC3           CD3 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1AIC3           CD3 Ext Numeric
     C                     END                             *FI
      * Convert Order Number to external.
      * CD7 Int/Ext
      * CASE: PAR.CD7 Int Numeric Key is not equal zero
     C           #1C4NB    IFNE *ZERO                      *IF
     C                     MOVEL*BLANK    WUEOCD           CD7 Ext Numeric
     C                     MOVEL#1C4NB    WUEOCD           CD7 Ext Numeric
      * CD7 Int/Ext EXCUSRSRC - *Field attribute types  * 
     C                     MOVEAWUEOCD    #L7              EDIT ARRAY
     C                     Z-ADD1         #E      30
     C                     MOVE *IN61     UUIN61  1
     C                     SETOF                     61
     C                     DO   7
     C           #L7,#E    IFEQ '0'                        ZERO VALUE
     C           *IN61     IFEQ '0'
     C                     MOVE ' '       #L7,#E
     C                     ADD  1         #E
     C                     END
     C                     ELSE
     C                     SETON                     61
     C                     END
     C                     END
     C                     MOVEA#L7       WUEOCD
     C                     MOVE UUIN61    *IN61
     C                     MOVELWUEOCD    V1C4NB           CD7 Ext Numeric
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL*BLANK    V1C4NB           CD7 Ext Numeric
     C                     END                             *FI
      *================================================================
     CSR         MNEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV for crt from cpy   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSA     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: PAR.USR Next Order Number is Equal to zeros
     C           YL0001    IFEQ *ZERO                      *IF
      * CHG Next Order Number  CH - Company Control  * 
     C                     EXSR SBCHRC
     C                     Z-ADDYL0002    YL0001           USR Next Order
     C                     END                             *FI
      * CRT Order Header       CR - Order Header TRG  * 
     C                     EXSR SCCRRC
      * RTV for crt from cpy   RT - Order Header Extension  * 
     C                     EXSR SDRVGN
      * RTV for crt from cpy   RT - Order Events  * 
     C                     EXSR SJRVGN
      * RTV for crt from cpy   RT - Order Detail  * 
     C                     EXSR SLRVGN
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBCHRC    BEGSR
      *================================================================
      * CHG Next Order Number  CH - Company Control  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  40       Current Account
     C                     Z-ADD*ZERO     WN0002  20       Current Account
     C                     Z-ADD*ZERO     WN0003  30       OM Week
     C                     Z-ADD*ZERO     WN0004  70       Next Order Numb
     C                     Z-ADD*ZERO     WN0005  70       Next Invoice Nu
     C                     Z-ADD*ZERO     WN0006  70       Next Credit Mem
     C                     Z-ADD*ZERO     WN0007  70       Next Late Charg
     C                     Z-ADD*ZERO     WN0008  70       Next On Acct Ca
     C                     Z-ADD*ZERO     WN0009  70       Next Voucher Nu
     C                     Z-ADD*ZERO     WN0010  70       Next Customer #
     C                     Z-ADD*ZERO     WN0011  70       Next Inventory
     C                     Z-ADD*ZERO     WN0012  80       Next PFS Batch
     C                     Z-ADD*ZERO     WN0013  70       Next Contract/P
     C                     Z-ADD*ZERO     WN0014  60       Next HPB Batch
     C                     MOVEL*BLANK    WN0015  1        Auto Order Numb
     C                     MOVEL*BLANK    WN0016  1        Auto Voucher Nu
     C                     MOVEL*BLANK    WN0017  1        Auto Customers
     C                     MOVEL*BLANK    WN0018  1        Auto Inv. Ref.
     C                     Z-ADD*ZERO     WN0019  52       Manual Price Ac
     C                     Z-ADD*ZERO     WN0020  52       CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WN0021 112       Late Charge Min
     C                     MOVEL*BLANK    WN0022  1        Print Co Addr o
     C                     MOVEL*BLANK    WN0023  1        Credit Hold Sta
     C                     MOVEL*BLANK    WN0024  1        Allocate Credit
     C                     MOVEL*BLANK    WN0025 30        Message Line 1
     C                     MOVEL*BLANK    WN0026 30        Message Line 2
     C                     MOVEL*BLANK    WN0027 30        Message Line 3
     C                     MOVEL*BLANK    WN0028 30        Message Line 4
     C                     MOVEL*BLANK    WN0029  1        Age by Trans or
     C                     Z-ADD*ZERO     WN0030  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0031  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0032  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0033  30       A/P Aging Days
     C                     Z-ADD*ZERO     WN0034  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0035  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0036  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0037  30       A/R Aging Days
     C                     Z-ADD*ZERO     WN0038  30       Retention Perio
     C                     Z-ADD*ZERO     WN0039  30       Retention Perio
     C                     Z-ADD*ZERO     WN0040  30       Retention Perio
     C                     Z-ADD*ZERO     WN0041  30       Retention Perio
     C                     Z-ADD*ZERO     WN0042  30       Retention Perio
     C                     Z-ADD*ZERO     WN0043  70       Next Load ID
     C                     MOVEL*BLANK    WN0044  1        Auto Load Numbe
     C                     Z-ADD*ZERO     WN0045  70       Next Item Numbe
     C                     MOVEL*BLANK    WN0046  1        G/L Posted Code
     C                     Z-ADD*ZERO     WN0047  30       Production Numb
     C                     MOVEL*BLANK    WN0048  1        Freight by Poun
     C                     MOVEL*BLANK    WN0049  1        Price Audit Act
     C                     MOVEL*BLANK    WN0050 10        PRT Night Queue
     C                     MOVEL*BLANK    WN0051  1        EDI Status 1
     C                     MOVEL*BLANK    WN0052  1        EDI Status 2
     C                     MOVEL*BLANK    WN0053  1        EDI Status 3
     C                     MOVEL*BLANK    WN0054  1        Record Status
     C                     Z-ADD*ZERO     WN0055  60       Job Time
     C                     MOVEL*BLANK    WN0056 10        User Id
     C                     MOVEL*BLANK    WN0057 10        Job Name
     C                     Z-ADD*ZERO     WN0058  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ASRECB
     C                     Z-ADD0         WAAIC3           Company Number
      *
     C           KLCHSB    KLIST
     C                     KFLD           WAAIC3           Company Number
     C           KLCHSB    CHAIN@ASRECB              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'CAASREL0'MDACP
     C                     MOVEL'@ASRECB' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QCAAS1    YARDCS
      *
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Assumes Credit memo numbers always automatically assigned
     C                     MOVEL'Y'       YARDC            *Record Data Ch
     C                     Z-ADDWAC5NB    YL0002           USR Next Order
     C                     ADD  1         WAC5NB           Next Order Numb
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WAAATM           Job Time
     C                     MOVEL##USR     WAAYNA           User Id
     C                     MOVEL##JOB     WAA0NA           Job Name
     C                     Z-ADD##JDT     WAAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QCAAS1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ASRECB                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKCAASREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * CRT Order Header       CR - Order Header TRG  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0059  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0060 12        Accounts Receiv
     C                     MOVEL*BLANK    WN0061  1        EDI Status 1
     C                     MOVEL*BLANK    WN0062  1        EDI Status 2
     C                     MOVEL*BLANK    WN0063  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0064  60       Job Time
     C                     MOVEL*BLANK    WN0065 10        User Id
     C                     MOVEL*BLANK    WN0066 10        Job Name
     C                     Z-ADD*ZERO     WN0067  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BECPFJ
     C                     Z-ADDBEAIC3    WBAIC3           Company Number
     C                     Z-ADDYL0002    WBC4NB           Order Number
     C                     MOVELBEJNCD    WBJNCD           Order Type - Sa
     C                     Z-ADDBEANC7    WBANC7           A/R Customer Nu
     C                     Z-ADDBEBKC7    WBBKC7           Ship To Custome
     C                     MOVELBEBRTX    WBBRTX           Ship To Name
     C                     MOVELBEHMNA    WBHMNA           Ship To Address
     C                     MOVELBEHONA    WBHONA           Ship To Address
     C                     MOVELBEHPNA    WBHPNA           Ship To Address
     C                     MOVELBEHNNA    WBHNNA           Ship To City
     C                     MOVELBEDBCD    WBDBCD           Ship To State C
     C                     MOVELBECKTX    WBCKTX           Ship To Zip/Pos
     C                     Z-ADDBEB0C7    WBB0C7           Bill to Custome
     C                     MOVELBEAETX    WBAETX           Bill to Name
     C                     MOVELBEB1NA    WBB1NA           Bill to Address
     C                     MOVELBEB3NA    WBB3NA           Bill to Address
     C                     MOVELBEB4NA    WBB4NA           Bill to Address
     C                     MOVELBEB2NA    WBB2NA           Bill to City
     C                     MOVELBEBHCD    WBBHCD           Bill to State C
     C                     MOVELBEC8TX    WBC8TX           Bill to Zip/Pos
     C                     MOVELBEBCNA    WBBCNA           Customer Purcha
     C                     Z-ADDBEA0DT    WBA0DT           Order Date
     C                     Z-ADDBEA5DT    WBA5DT           Requested Ship
     C                     Z-ADDBEGNDT    WBGNDT           Actual Shipped
     C                     Z-ADDBEACDT    WBACDT           Cancel Date
     C                     MOVELBEAQCD    WBAQCD           Terms Code
     C                     MOVELBEB6NA    WBB6NA           Special Instruc
     C                     MOVELBEBYNA    WBBYNA           Special Instruc
     C                     MOVELBEBZNA    WBBZNA           Carrier Code
     C                     MOVELBEGTST    WBGTST           Comment Print A
     C                     MOVELBEGVST    WBGVST           Comment Print I
     C                     MOVELBEGUST    WBGUST           Comment Print P
     C                     MOVELBEQFST    WBQFST           Comment Print S
     C                     MOVELBECQCD    WBCQCD           Reason Code
     C                     MOVELBEGJST    WBGJST           Order in Use
     C                     MOVELBEGWST    WBGWST           Header Status
     C                     MOVELBEGXST    WBGXST           Header Status L
     C                     MOVELBEGYST    WBGYST           Order Type Prin
     C                     Z-ADDBEAODT    WBAODT           Scheduled Ship
     C                     MOVELBEAIVN    WBAIVN           User Original E
     C                     Z-ADDBECXDT    WBCXDT           Date of Origina
     C                     Z-ADDBEJZVA    WBJZVA           Order Value Tot
     C                     Z-ADDBEA1WG    WBA1WG           Order Weight To
     C                     MOVELBEXIST    WBXIST           Credit Hold
     C                     MOVELBEXJST    WBXJST           Production Hold
     C                     MOVELBEXKST    WBXKST           New Customer Ho
     C                     Z-ADDBEEIDT    WBEIDT           Requested Deliv
     C                     Z-ADDBEAFTM    WBAFTM           Requested Deliv
     C                     Z-ADDBERMNB    WBRMNB           Load ID
     C                     Z-ADDBETBNB    WBTBNB           Absorbed Freigh
     C                     Z-ADDBER1NB    WBR1NB           Rated Freight
     C                     MOVELBEPJST    WBPJST           LTL Flag
     C                     MOVELBEU0ST    WBU0ST           Price Audit
     C                     MOVELBEU1ST    WBU1ST           Price Status
     C                     MOVELBEQ2CD    WBQ2CD           Shipping Method
     C                     MOVELBEU2ST    WBU2ST           Export Status
     C                     MOVELBEVEST    WBVEST           Palletize
     C                     MOVELBEVFST    WBVFST           Shrink Wrap
     C                     MOVELBEVGST    WBVGST           Slip Sheet
     C                     MOVELBERPCD    WBRPCD           Age Code
     C                     Z-ADDBERNNB    WBRNNB           Reefer Temperat
     C                     MOVELBEVDST    WBVDST           Load Type
     C                     Z-ADDBEATIN    WBATIN           Attach to Invoi
     C                     MOVELBEU4ST    WBU4ST           Load Plan Order
     C                     MOVELBEU5ST    WBU5ST           Print Pick Slip
     C                     Z-ADDBERSRN    WBRSRN           Resell Referenc
     C                     MOVELBEMHNA    WBMHNA           Special Comment
     C                     MOVELBEMINA    WBMINA           Special Comment
     C                     MOVELBEWBST    WBWBST           Affect Auto Acc
     C                     MOVELBER4CD    WBR4CD           Sales Route Cod
     C                     MOVELBEBFCD    WBBFCD           Manager Level C
     C                     MOVELBEQ4CD    WBQ4CD           VP Level Code
     C                     Z-ADDBET3NB    WBT3NB           Attach to Order
     C                     MOVELBESICD    WBSICD           Reason for Pric
     C                     Z-ADDBECONB    WBCONB           Invoice Number
     C                     MOVELBECEST    WBCEST           Invoice Suffix
     C                     Z-ADDBEAWDT    WBAWDT           Invoice Date
     C                     MOVEL'02'      WBJPCD           Event Code
     C                     MOVELBEXUST    WBXUST           Trans Contol AS
     C                     MOVELBEZ1ST    WBZ1ST           Modified Flag
     C                     Z-ADDBEVRVA    WBVRVA           A/R order Value
     C                     MOVELBEOBST    WBOBST           Billing Activit
     C                     MOVELBEBCST    WBBCST           Block Order Fla
     C                     MOVELBEBDST    WBBDST           Order Certifica
     C                     Z-ADDBEB7VL    WBB7VL           Invoice Order V
     C                     MOVELBEGASX    WBGASX           Invoice Price T
     C                     MOVELBEGBSX    WBGBSX           Order Conf Fax
     C                     MOVELBEGCSX    WBGCSX           Manifest Fax St
     C                     MOVELBEGDSX    WBGDSX           Invoice Fax Sts
     C                     MOVELBEFNSX    WBFNSX           Transfer in Sto
     C                     MOVELBEFOSX    WBFOSX           Email Cust On O
     C                     MOVELBEFPSX    WBFPSX           Order Emailed
     C                     MOVELBEFQSX    WBFQSX           Export Docs Go
     C                     MOVELBEFRSX    WBFRSX           Shipping Temp C
     C                     MOVELBEFSSX    WBFSSX           Broker Order St
     C                     MOVELBEFTSX    WBFTSX           Air Freight Ord
     C                     MOVELBEFUSX    WBFUSX           Signal Demand S
     C                     MOVELBEFVSX    WBFVSX           EDI Nistevo Sel
     C                     MOVELBEFWSX    WBFWSX           Export USDA App
     C                     MOVELBEFXSX    WBFXSX           Unused Code
     C                     MOVELBEFYSX    WBFYSX           OH TF Exempt Co
     C                     Z-ADDBENODT    WBNODT           OH Unused Date
     C                     Z-ADDBENPDT    WBNPDT           OH Unused Date
     C                     Z-ADDBENQDT    WBNQDT           OH Unused Date
     C                     Z-ADDBENRDT    WBNRDT           OH Unused Date
     C                     Z-ADDBENSDT    WBNSDT           OH Unused Date
     C                     Z-ADDBEBPTM    WBBPTM           Maximum Gross W
     C                     Z-ADDBEBQTM    WBBQTM           Time of Origina
     C                     Z-ADDBEBRTM    WBBRTM           OH Unused Time
     C                     Z-ADDBEBSTM    WBBSTM           OH Unused Time
     C                     Z-ADDBEBTTM    WBBTTM           OH Unused Time
     C                     Z-ADDBEH0NX    WBH0NX           Act Frt Referen
     C                     Z-ADDBEH1NX    WBH1NX           Act Non-Ref Frt
     C                     Z-ADDBEH2NX    WBH2NX           OH Fuel Surchar
     C                     Z-ADDBEH3NX    WBH3NX           OH Total Non-Re
     C                     Z-ADDBEH4NX    WBH4NX           OH Total Ref Fr
     C                     Z-ADDBEC0C7    WBC0C7           Claim Number
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WBAATM' defaulted for 'Job Time'.
      * Field '(DB1) WBAYNA' defaulted for 'User Id'.
      * Field '(DB1) WBA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WBAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WBAATM           Job Time
     C                     MOVEL##USR     WBAYNA           User Id
     C                     MOVEL##JOB     WBA0NA           Job Name
     C                     Z-ADD##JDT     WBAXDT           Job Date
      * RTV System Date/Time   UP - /UT User Programs  * 
     C                     CALL 'PDGFUPC'              90  RTV System Date
     C           WBCXDT    PARM *ZERO     WQ0001 155       Current System
     C           WBBQTM    PARM *ZERO     WQ0002 155       Current System
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGFUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C           KLCRSC    KLIST
     C                     KFLD           WBAIC3           Company Number
     C                     KFLD           WBC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSC    SETLL@BECPFJ                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR0177' W0RTN   7
      * USER: Processing if Data record already exists
      * ** Set flag so it can be tested on the return    T075 03/28/2006
     C                     MOVEL'Y2U0003' P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@BECPFJ                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV for crt from cpy   RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WCAIC3           Company Number
     C                     Z-ADDBEC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSD     CHAIN@AMREJF              90    *
      * Data record not found
     C   90                MOVEL'USR3697' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Need to create Load Detail first to get the next Stop/Drop Seq #
      * RTV high Stp/Drp Seq # RT - Load Detail  * 
     C                     EXSR SERVGN
      * Then duplicate the Load detail adding new Stop/Drop Seq & Ord #
     C                     ADD  1         YL0003           Stop/Drop Seque
      * RTV for crt from cpy   RT - Load Detail  * 
     C                     EXSR SFRVGN
      * CRT Order Header Exten CR - Order Header Extension  * 
     C                     EXSR SHCRRC
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV high Stp/Drp Seq # RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0003           Stop/Drop Seque
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDRMNB    WQSE01           Load ID
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WQSE01           Load ID
      * Setup key
     C                     Z-ADDWCRMNB    WQSE01           Load ID
      * Establish starting position
     C           KRSSE     SETLL@FLCPBW                    *
     C           KRSSE     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWDRUNB    YL0003           Stop/Drop Seque
     C           KRSSE     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV for crt from cpy   RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WERMNB    WQSF02           Load ID
     C           *LIKE     DEFN WEC4NB    WQSF03           Order Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF02           Load ID
     C                     KFLD           WQSF03           Order Number
      * Setup key
     C                     Z-ADDWCRMNB    WQSF02           Load ID
     C                     Z-ADDWCC4NB    WQSF03           Order Number
      * Establish starting position
     C           KRSSF     SETLL@FLCPKF                    *
     C           KRSSF     READE@FLCPKF                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Load Detail        CR - Load Detail  * 
     C                     EXSR SGCRRC
     C                     GOTO SFEXIT                     *QUIT
     C           KRSSF     READE@FLCPKF                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * CRT Load Detail        CR - Load Detail  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0068  1        EDI Status 1
     C                     MOVEL*BLANK    WN0069  1        EDI Status 2
     C                     MOVEL*BLANK    WN0070  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0071  60       Job Time
     C                     MOVEL*BLANK    WN0072 10        User Id
     C                     MOVEL*BLANK    WN0073 10        Job Name
     C                     Z-ADD*ZERO     WN0074  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @FLCPBM
     C                     Z-ADDWERMNB    WFRMNB           Load ID
     C                     Z-ADDYL0003    WFRUNB           Stop/Drop Seque
     C                     Z-ADDWERVNB    WFRVNB           Stop/Drop
     C                     MOVELWEDQTX    WFDQTX           Comments for Pi
     C                     Z-ADDWERWNB    WFRWNB           Miles to next s
     C                     Z-ADDWERXNB    WFRXNB           Freight Charge
     C                     Z-ADDWESQNB    WFSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADDWET0NB    WFT0NB           Freight Misc. C
     C                     Z-ADDWET1NB    WFT1NB           Freight Stop Ch
     C                     Z-ADDWER1NB    WFR1NB           Rated Freight
     C                     Z-ADDWEAIC3    WFAIC3           Company Number
     C                     Z-ADDYL0002    WFC4NB           Order Number
     C                     MOVELWEVCST    WFVCST           Ship Status
     C                     Z-ADDWEKEDT    WFKEDT           Estimated Arriv
     C                     Z-ADDWESXNB    WFSXNB           Estimated Arriv
     C                     Z-ADDWEKFDT    WFKFDT           Appointment Con
     C                     Z-ADDWEACTM    WFACTM           Appointment Con
     C                     MOVELWEK5TX    WFK5TX           Confirmation Ma
     C                     MOVELWEW5CD    WFW5CD           Confirmation Nu
     C                     Z-ADDWEEJDT    WFEJDT           Actual Delivery
     C                     Z-ADDWEAGTM    WFAGTM           Actual Delivery
     C                     Z-ADDWEKJDT    WFKJDT           Scheduled Deliv
     C                     Z-ADDWEATTM    WFATTM           Scheduled Deliv
     C                     Z-ADDWEHDDT    WFHDDT           Deadline Depart
     C                     Z-ADDWEAUTM    WFAUTM           Deadline Depart
     C                     Z-ADDWEKKDT    WFKKDT           On Yard Date
     C                     Z-ADDWEAVTM    WFAVTM           On Yard Time
     C                     Z-ADDWEZ4NB    WFZ4NB           MPC Number
     C                     MOVELWEY7ST    WFY7ST           Load Dtl On Tim
     C                     MOVELWEY2ST    WFY2ST           On Time Add'l R
     C                     MOVELWEWHTX    WFWHTX           Seal Nbr 1
     C                     MOVELWEWITX    WFWITX           Seal Nbr 2
     C                     MOVELWEWJTX    WFWJTX           Seal Nbr 3
     C                     MOVELWEWKTX    WFWKTX           Seal Nbr 4
     C                     MOVELWEWLTX    WFWLTX           Seal Nbr 5
     C                     Z-ADDWEN7DT    WFN7DT           LD Carrier Appt
     C                     Z-ADDWEN8DT    WFN8DT           LD Unused Date
     C                     Z-ADDWEN9DT    WFN9DT           LD Unused Date
     C                     Z-ADDWEB3TM    WFB3TM           LD Carrier Appt
     C                     Z-ADDWEB4TM    WFB4TM           LD Unused Time
     C                     Z-ADDWEB5TM    WFB5TM           LD Unused Time
     C                     MOVELWEIASX    WFIASX           Miles Error Sts
     C                     MOVELWEIBSX    WFIBSX           LD Unused Sts 2
     C                     MOVELWEICSX    WFICSX           HPB Transload S
     C                     MOVELWEWVTX    WFWVTX           LD Unused Txt 1
     C                     MOVELWEWWTX    WFWWTX           LD Unused Txt 2
     C                     MOVELWEWXTX    WFWXTX           LD Unused Txt 3
      *
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WFAATM' defaulted for 'Job Time'.
      * Field '(DB1) WFAYNA' defaulted for 'User Id'.
      * Field '(DB1) WFA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WFAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WFAATM           Job Time
     C                     MOVEL##USR     WFAYNA           User Id
     C                     MOVEL##JOB     WFA0NA           Job Name
     C                     Z-ADD##JDT     WFAXDT           Job Date
     C           KLCRSG    KLIST
     C                     KFLD           WFRMNB           Load ID
     C                     KFLD           WFRUNB           Stop/Drop Seque
      * Check for duplicate primary key
     C           KLCRSG    SETLL@FLCPBM                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1193' W0RTN   7
      * Send message 'Load Detail            EX'
     C                     MOVEL'USR1193' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@FLCPBM                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHCRRC    BEGSR
      *================================================================
      * CRT Order Header Exten CR - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AMREJE
     C                     Z-ADDWCAIC3    WGAIC3           Company Number
     C                     Z-ADDYL0002    WGC4NB           Order Number
     C                     Z-ADDWCRMNB    WGRMNB           Load ID
     C                     Z-ADDYL0003    WGRUNB           Stop/Drop Seque
     C                     MOVELWCXACD    WGXACD           Shipping Line
     C                     MOVELWCOANA    WGOANA           Port Delv Termi
     C                     MOVELWCHBAA    WGHBAA           OHE City
     C                     MOVELWCJ0T1    WGJ0T1           OHE Vessel/Airl
     C                     Z-ADDWCGENY    WGGENY           OHE Voyage/Flig
     C                     MOVELWCJ1T1    WGJ1T1           OHE Booking Num
     C                     MOVELWCHCAA    WGHCAA           OHE Discharge P
     C                     Z-ADDWCQWDT    WGQWDT           OHE Sail/Flight
     C                     Z-ADDWCQXDT    WGQXDT           OHE Actual Depa
     C                     Z-ADDWCQYDT    WGQYDT           OHE Arrival Dat
     C                     MOVELWCHDAA    WGHDAA           OHE Unused Code
     C                     MOVELWCCCTX    WGCCTX           OHE Ship Status
     C                     MOVELWCJ2T1    WGJ2T1           OHE Container N
     C                     MOVELWCRLNA    WGRLNA           OHE Comment 1
     C                     MOVELWCRMNA    WGRMNA           OHE Comment 2
     C                     Z-ADDWCGINY    WGGINY           OHE Unused Numb
     C                     Z-ADDWCGFNY    WGGFNY           OHE Unused Numb
     C                     Z-ADDWCGGNY    WGGGNY           OHE Unused Numb
     C                     Z-ADDWCGHNY    WGGHNY           OHE Unused Numb
     C                     Z-ADDWCHEVL    WGHEVL           OHE Unused Valu
     C                     Z-ADDWCHFVL    WGHFVL           OHE Unused Valu
     C                     Z-ADDWCHGVL    WGHGVL           OHE Unused Valu
     C                     Z-ADDWCQZDT    WGQZDT           OHE Unused Date
     C                     Z-ADDWCQ0DT    WGQ0DT           OHE Unused Date
     C                     Z-ADDWCQ1DT    WGQ1DT           OHE Unused Date
     C                     Z-ADDWCQ2DT    WGQ2DT           OHE Unused Date
     C                     MOVELWCC2TX    WGC2TX           OHE unused stat
     C                     MOVELWCC3TX    WGC3TX           OHE unused stat
     C                     MOVELWCC6TX    WGC6TX           OHE unused stat
     C                     MOVELWCCHTX    WGCHTX           OHE Unused Stat
     C                     MOVELWCCITX    WGCITX           OHE Unused Stat
     C                     MOVELWCCLTX    WGCLTX           OHE Unused Stat
     C                     MOVELWCB4TX    WGB4TX           OHE Unused Stat
     C                     MOVELWCCUTX    WGCUTX           OHE Unused Stat
     C                     MOVELWCCVTX    WGCVTX           OHE Unused Stat
     C                     MOVELWCB9TX    WGB9TX           OHE Unused Stat
     C                     Z-ADD#DJINY    WGITNY           HPB COA Batch N
     C                     MOVELWCLMT1    WGLMT1           Delivery P.O. N
     C                     MOVELWCUVST    WGUVST           EDI Status 1
     C                     MOVELWCUWST    WGUWST           EDI Status 2
     C                     MOVELWCUXST    WGUXST           EDI Status 3
     C                     MOVELWCVSST    WGVSST           Record Status
     C                     Z-ADDWCAATM    WGAATM           Job Time
     C                     MOVELWCAYNA    WGAYNA           User Id
     C                     MOVELWCA0NA    WGA0NA           Job Name
     C                     Z-ADDWCAXDT    WGAXDT           Job Date
      *
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     MOVEL##USR     WGAYNA           User Id
     C           KLCRSH    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
      * Check for duplicate primary key
     C           KLCRSH    SETLL@AMREJE                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR3698' W0RTN   7
      * USER: Processing if Data record already exists
      * CHG Existing OHE       CH - Order Header Extension  * 
     C                     EXSR SICHRC
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C                     WRITE@AMREJE                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICHRC    BEGSR
      *================================================================
      * CHG Existing OHE       CH - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AMREJE
     C                     Z-ADDWCAIC3    WGAIC3           Company Number
     C                     Z-ADDYL0002    WGC4NB           Order Number
      *
     C           KLCHSI    KLIST
     C                     KFLD           WGAIC3           Company Number
     C                     KFLD           WGC4NB           Order Number
     C           KLCHSI    CHAIN@AMREJE              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PMAMREL0'MDACP
     C                     MOVEL'@AMREJE' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPMAM1    YBRDCS
      * Move non-key fields to @AMREJE
     C                     Z-ADDWCRMNB    WGRMNB           Load ID
     C                     Z-ADDYL0003    WGRUNB           Stop/Drop Seque
     C                     MOVELWCXACD    WGXACD    P      Shipping Line
     C                     MOVELWCOANA    WGOANA    P      Port Delv Termi
     C                     MOVELWCHBAA    WGHBAA    P      OHE City
     C                     MOVELWCJ0T1    WGJ0T1    P      OHE Vessel/Airl
     C                     Z-ADDWCGENY    WGGENY           OHE Voyage/Flig
     C                     MOVELWCJ1T1    WGJ1T1    P      OHE Booking Num
     C                     MOVELWCHCAA    WGHCAA    P      OHE Discharge P
     C                     Z-ADDWCQWDT    WGQWDT           OHE Sail/Flight
     C                     Z-ADDWCQXDT    WGQXDT           OHE Actual Depa
     C                     Z-ADDWCQYDT    WGQYDT           OHE Arrival Dat
     C                     MOVELWCHDAA    WGHDAA    P      OHE Unused Code
     C                     MOVELWCCCTX    WGCCTX    P      OHE Ship Status
     C                     MOVELWCJ2T1    WGJ2T1    P      OHE Container N
     C                     MOVELWCRLNA    WGRLNA    P      OHE Comment 1
     C                     MOVELWCRMNA    WGRMNA    P      OHE Comment 2
     C                     Z-ADDWCGINY    WGGINY           OHE Unused Numb
     C                     Z-ADDWCGFNY    WGGFNY           OHE Unused Numb
     C                     Z-ADDWCGGNY    WGGGNY           OHE Unused Numb
     C                     Z-ADDWCGHNY    WGGHNY           OHE Unused Numb
     C                     Z-ADDWCHEVL    WGHEVL           OHE Unused Valu
     C                     Z-ADDWCHFVL    WGHFVL           OHE Unused Valu
     C                     Z-ADDWCHGVL    WGHGVL           OHE Unused Valu
     C                     Z-ADDWCQZDT    WGQZDT           OHE Unused Date
     C                     Z-ADDWCQ0DT    WGQ0DT           OHE Unused Date
     C                     Z-ADDWCQ1DT    WGQ1DT           OHE Unused Date
     C                     Z-ADDWCQ2DT    WGQ2DT           OHE Unused Date
     C                     MOVELWCC2TX    WGC2TX    P      OHE unused stat
     C                     MOVELWCC3TX    WGC3TX    P      OHE unused stat
     C                     MOVELWCC6TX    WGC6TX    P      OHE unused stat
     C                     MOVELWCCHTX    WGCHTX    P      OHE Unused Stat
     C                     MOVELWCCITX    WGCITX    P      OHE Unused Stat
     C                     MOVELWCCLTX    WGCLTX    P      OHE Unused Stat
     C                     MOVELWCB4TX    WGB4TX    P      OHE Unused Stat
     C                     MOVELWCCUTX    WGCUTX    P      OHE Unused Stat
     C                     MOVELWCCVTX    WGCVTX    P      OHE Unused Stat
     C                     MOVELWCB9TX    WGB9TX    P      OHE Unused Stat
     C                     Z-ADD#DJINY    WGITNY           HPB COA Batch N
     C                     MOVELWCLMT1    WGLMT1    P      Delivery P.O. N
     C                     MOVELWCUVST    WGUVST    P      EDI Status 1
     C                     MOVELWCUWST    WGUWST    P      EDI Status 2
     C                     MOVELWCUXST    WGUXST    P      EDI Status 3
     C                     MOVELWCVSST    WGVSST    P      Record Status
     C                     Z-ADDWCAATM    WGAATM           Job Time
     C                     MOVELWCAYNA    WGAYNA    P      User Id
     C                     MOVELWCA0NA    WGA0NA    P      Job Name
     C                     Z-ADDWCAXDT    WGAXDT           Job Date
      *
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     C                     Z-ADD##JTM     WGAATM           Job Time
     C                     Z-ADD##JDT     WGAXDT           Job Date
     C                     MOVEL##PGM     WGA0NA           Job Name
     C                     MOVEL##USR     WGAYNA           User Id
      * Set PGM.*Record Data Changed flag
     C           QPMAM1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AMREJE                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPMAMREL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * RTV for crt from cpy   RT - Order Events  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WHAIC3    WQSJ01           Company Number
     C           *LIKE     DEFN WHC4NB    WQSJ02           Order Number
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WQSJ01           Company Number
     C                     KFLD           WQSJ02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSJ01           Company Number
     C                     Z-ADDBEC4NB    WQSJ02           Order Number
      * Establish starting position
     C           KRSSJ     SETLL@EYCPY2                    *
     C           KRSSJ     READE@EYCPY2                  90*
      * Data record not found
     C   90                MOVEL'USR1074' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Event Code is Open Orders
     C           WHJPCD    IFLT '04'                       *IF
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0001           Company Number
     C                     Z-ADDYL0002    WL0002           Order Number
     C                     Z-ADDWHQ2NB    WL0003           Event Number
     C                     MOVELWHJPCD    WL0004    P      Event Code
     C                     Z-ADDWHAUC3    WL0005           Invoice/Memo Co
     C                     Z-ADDWHQ7NB    WL0006           Invoice/Memo Nu
     C                     MOVELWHOMST    WL0007    P      Invoice/Memo Su
     C                     Z-ADDWHD2DT    WL0008           Event Date
     C                     MOVELWHONST    WL0009    P      Activity Comple
     C                     MOVELWHOOST    WL0010    P      Activity Hold
     C                     MOVELWHOPST    WL0011    P      Post Cash Compl
     C                     Z-ADDWHAWC3    WL0012           Cross Event Ref
     C                     Z-ADDWHQ8NB    WL0013           Cross Event Ref
     C                     Z-ADDWHQ9NB    WL0014           Cross Event Ref
     C                     Z-ADDWHBKC7    WL0015           Ship To Custome
     C                     EXSR SKCRRC
     C                     END                             *FI
     C                     MOVELWHJPCD    YL0004           Event Code
     C           KRSSJ     READE@EYCPY2                  90*
     C                     ENDDO
      * USER: Exit processing
      * Create the picked event if necessary
      * CASE: LCL.Event Code is 02 Load Planned
     C           YL0004    IFEQ '02'                       *IF
      * CRT OP Order Events    CR - Order Events  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWHAIC3    WL0001           Company Number
     C                     Z-ADDYL0002    WL0002           Order Number
     C                     Z-ADD3         WL0003           Event Number
     C                     MOVEL'03'      WL0004    P      Event Code
     C                     Z-ADDWHAUC3    WL0005           Invoice/Memo Co
     C                     Z-ADDWHQ7NB    WL0006           Invoice/Memo Nu
     C                     MOVELWHOMST    WL0007    P      Invoice/Memo Su
     C                     Z-ADDWHD2DT    WL0008           Event Date
     C                     MOVELWHONST    WL0009    P      Activity Comple
     C                     MOVELWHOOST    WL0010    P      Activity Hold
     C                     MOVELWHOPST    WL0011    P      Post Cash Compl
     C                     Z-ADDWHAWC3    WL0012           Cross Event Ref
     C                     Z-ADDWHQ8NB    WL0013           Cross Event Ref
     C                     Z-ADDWHQ9NB    WL0014           Cross Event Ref
     C                     Z-ADDWHBKC7    WL0015           Ship To Custome
     C                     EXSR SKCRRC
     C                     END                             *FI
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * CRT OP Order Events    CR - Order Events  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0075  1        EDI Status 1
     C                     MOVEL*BLANK    WN0076  1        EDI Status 2
     C                     MOVEL*BLANK    WN0077  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0078  60       Job Time
     C                     MOVEL*BLANK    WN0079 10        User Id
     C                     MOVEL*BLANK    WN0080 10        Job Name
     C                     Z-ADD*ZERO     WN0081  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EYCPY3
     C                     Z-ADDWL0001    WIAIC3           Company Number
     C                     Z-ADDWL0002    WIC4NB           Order Number
     C                     Z-ADDWL0003    WIQ2NB           Event Number
     C                     MOVELWL0004    WIJPCD           Event Code
     C                     Z-ADDWL0005    WIAUC3           Invoice/Memo Co
     C                     Z-ADDWL0006    WIQ7NB           Invoice/Memo Nu
     C                     MOVELWL0007    WIOMST           Invoice/Memo Su
     C                     Z-ADDWL0008    WID2DT           Event Date
     C                     MOVELWL0009    WIONST           Activity Comple
     C                     MOVELWL0010    WIOOST           Activity Hold
     C                     MOVELWL0011    WIOPST           Post Cash Compl
     C                     Z-ADDWL0012    WIAWC3           Cross Event Ref
     C                     Z-ADDWL0013    WIQ8NB           Cross Event Ref
     C                     Z-ADDWL0014    WIQ9NB           Cross Event Ref
     C                     Z-ADDWL0015    WIBKC7           Ship To Custome
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WIAATM           Job Time
     C                     MOVEL##USR     WIAYNA           User Id
     C                     MOVEL##JOB     WIA0NA           Job Name
     C                     Z-ADD##JDT     WIAXDT           Job Date
     C           KLCRSK    KLIST
     C                     KFLD           WIAIC3           Company Number
     C                     KFLD           WIC4NB           Order Number
     C                     KFLD           WIQ2NB           Event Number
      * Check for duplicate primary key
     C           KLCRSK    SETLL@EYCPY3                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1075' W0RTN   7
      * Send message 'Order Events           EX'
     C                     MOVEL'USR1075' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@EYCPY3                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * RTV for crt from cpy   RT - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSL01           Company Number
     C           *LIKE     DEFN WJC4NB    WQSL02           Order Number
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           Company Number
     C                     KFLD           WQSL02           Order Number
      * Setup key
     C                     Z-ADDBEAIC3    WQSL01           Company Number
     C                     Z-ADDBEC4NB    WQSL02           Order Number
      * Establish starting position
     C           KRSSL     SETLL@BGWKL1                    *
     C           KRSSL     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CRT Order Detail       CR - Order Detail  * 
     C                     EXSR SMCRRC
     C           KRSSL     READE@BGWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMCRRC    BEGSR
      *================================================================
      * CRT Order Detail       CR - Order Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BGWKL0
     C                     Z-ADDWJAIC3    WKAIC3           Company Number
     C                     Z-ADDYL0002    WKC4NB           Order Number
     C                     Z-ADDWJDPNB    WKDPNB           Order Sequence
     C                     Z-ADDWJUENB    WKUENB           Order Secondary
     C                     Z-ADDWJHGCD    WKHGCD           Item Code
     C                     MOVEL#DIEAA    WKAJCD           Warehouse Code
     C                     Z-ADDWJBKC7    WKBKC7           Ship To Custome
     C                     Z-ADDWJCFC7    WKCFC7           Order Group Cod
     C                     MOVEL'A'       WKGMST           Detail Line Sta
     C                     MOVELWJGNST    WKGNST           Detail Line Sta
     C                     Z-ADDWJMAVA    WKMAVA           Billing Detail
     C                     Z-ADDWJKDVA    WKKDVA           Billing Detail
     C                     Z-ADDWJL8VA    WKL8VA           Billing Detail
     C                     Z-ADDWJL9VA    WKL9VA           Quantity to Sub
     C                     MOVELWJGTST    WKGTST           Comment Print A
     C                     MOVELWJGVST    WKGVST           Comment Print I
     C                     MOVELWJGUST    WKGUST           Comment Print P
     C                     MOVELWJQFST    WKQFST           Comment Print S
     C                     Z-ADDWJAYVA    WKAYVA           Extended Amount
     C                     Z-ADDWJEXDT    WKEXDT           Market Pricing
     C                     MOVELWJLQCD    WKLQCD           Commodity Marke
     C                     MOVELWJRDCD    WKRDCD           Date Method Cod
     C                     MOVELWJQ7CD    WKQ7CD           Price Method Co
     C                     Z-ADDWJBZPR    WKBZPR           Price Overage O
     C                     Z-ADDWJL6NB    WKL6NB           Contract Number
     C                     MOVELWJU1ST    WKU1ST           Price Status
     C                     Z-ADDWJGIDT    WKGIDT           Pricing Date Us
     C                     MOVELWJCRCD    WKCRCD           U/M - Base Pric
     C                     MOVELWJAGCD    WKAGCD           U/M - Ordered
     C                     MOVELWJRZST    WKRZST           Work Confirm St
     C                     MOVELWJR0ST    WKR0ST           Work Over/Short
     C                     MOVELWJR1ST    WKR1ST           Work Extra Stat
     C                     MOVELWJG7NA    WKG7NA           Order Desc. Lin
     C                     MOVELWJG8NA    WKG8NA           Order Desc. Lin
     C                     MOVELWJRPCD    WKRPCD           Age Code
     C                     MOVELWJVEST    WKVEST           Palletize
     C                     MOVELWJVGST    WKVGST           Slip Sheet
     C                     MOVELWJAVST    WKAVST           Catch Weight St
     C                     MOVELWJU0ST    WKU0ST           Price Audit
     C                     MOVELWJRFCD    WKRFCD           Price Audit Rea
     C                     MOVELWJFZST    WKFZST           Production Date
     C                     Z-ADDWJR1NB    WKR1NB           Rated Freight
     C                     Z-ADDWJAVQT    WKAVQT           Quantity Ordere
     C                     Z-ADDWJD0WG    WKD0WG           Weight Ordered
     C                     Z-ADDWJCCQT    WKCCQT           Quantity Schedu
     C                     Z-ADDWJAUWG    WKAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WKCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WKATWG           Weight Shipped
     C                     Z-ADDWJAQCS    WKAQCS           Unit Cost Prici
     C                     Z-ADDWJAGCS    WKAGCS           Unit Cost Per P
     C                     Z-ADDWJAKPR    WKAKPR           Unit Price
     C                     Z-ADDWJALPR    WKALPR           Unit Price - Cr
     C                     Z-ADDWJAUPR    WKAUPR           Unit Price Orde
     C                     Z-ADDWJAVWG    WKAVWG           Unit Weight Ord
     C                     Z-ADDWJA4WG    WKA4WG           Tare Weight Tot
     C                     Z-ADDWJA5DT    WKA5DT           Requested Ship
     C                     Z-ADDWJAODT    WKAODT           Scheduled Ship
     C                     Z-ADDWJGNDT    WKGNDT           Actual Shipped
     C                     MOVELWJAMST    WKAMST           Affect Inventor
     C                     MOVELWJANST    WKANST           Affect Sales Do
     C                     MOVELWJVAST    WKVAST           Affect Sales Pn
     C                     Z-ADDWJRGNB    WKRGNB           Item Structure
     C                     Z-ADDWJRHNB    WKRHNB           Item Structure
     C                     Z-ADDWJRINB    WKRINB           Item Structure
     C                     MOVELWJRBCD    WKRBCD           Item Level
     C                     MOVELWJHICD    WKHICD           Quality Level
     C                     MOVELWJRNCD    WKRNCD           Pricing Product
     C                     MOVELWJROCD    WKROCD           Season Product
     C                     Z-ADD##JDT     WKCXDT           Date of Origina
     C                     MOVEL##USR     WKAJVN           User Profile Na
     C                     MOVELWJKXCD    WKKXCD           Country Code
     C                     MOVEL'03'      WKJPCD           Event Code
     C                     MOVELWJCQCD    WKCQCD           Reason Code
     C                     MOVELWJR4CD    WKR4CD           Sales Route Cod
     C                     MOVELWJZ1ST    WKZ1ST           Modified Flag
     C                     MOVELWJZ3ST    WKZ3ST           Substituted Fla
     C                     MOVELWJZ4ST    WKZ4ST           Order Detail St
     C                     Z-ADDWJDUPR    WKDUPR           Invoice Unit Pr
     C                     Z-ADDWJB6VL    WKB6VL           Invoice Extende
     C                     Z-ADDWJA1AA    WKA1AA           Ham Group Numbe
     C                     MOVELWJFZSX    WKFZSX           OD Schedule Sho
     C                     MOVELWJF0SX    WKF0SX           Affect Trade Fu
     C                     MOVELWJF1SX    WKF1SX           Affect Commissi
     C                     MOVELWJF2SX    WKF2SX           Affect Pricing
     C                     MOVELWJF3SX    WKF3SX           OD Unused Statu
     C                     MOVELWJF4SX    WKF4SX           Ord TF Exempt C
     C                     MOVELWJF5SX    WKF5SX           OD Pallet Type
     C                     MOVELWJF6SX    WKF6SX           OD Unused Sts 8
     C                     MOVELWJF7SX    WKF7SX           OD Price Type
     C                     Z-ADDWJNTDT    WKNTDT           Warehouse Palle
     C                     Z-ADDWJNUDT    WKNUDT           Consumed Item C
     C                     Z-ADDWJNVDT    WKNVDT           Deadline Depart
     C                     Z-ADDWJNWDT    WKNWDT           OD Price Type R
     C                     Z-ADDWJNXDT    WKNXDT           OD Unused Date
     C                     Z-ADDWJBUTM    WKBUTM           Deadline Depart
     C                     Z-ADDWJBVTM    WKBVTM           Price Code
     C                     Z-ADDWJBWTM    WKBWTM           Maximum Net Wei
     C                     Z-ADDWJBXTM    WKBXTM           Substitution Li
     C                     Z-ADDWJBYTM    WKBYTM           OD Quantity Pro
     C                     Z-ADDWJH5NX    WKH5NX           Warehouse Palle
     C                     Z-ADDWJH6NX    WKH6NX           Warehouse Avg P
     C                     Z-ADDWJH7NX    WKH7NX           OD Item Target
     C                     Z-ADDWJH8NX    WKH8NX           OD Minimum Unit
     C                     Z-ADDWJH9NX    WKH9NX           OD Maximum Unit
     C                     Z-ADDWJDVPR    WKDVPR           Order Gate Pric
     C                     Z-ADDWJDWPR    WKDWPR           OD Unused Prc 2
     C                     Z-ADDWJDXPR    WKDXPR           OD Unused Prc 3
     C                     Z-ADDWJDYPR    WKDYPR           OD Unused Prc 4
     C                     Z-ADDWJDZPR    WKDZPR           OD Unused Prc 5
     C                     MOVELWJUVST    WKUVST           EDI Status 1
     C                     MOVELWJUWST    WKUWST           EDI Status 2
     C                     MOVELWJUXST    WKUXST           EDI Status 3
     C                     Z-ADDWJAATM    WKAATM           Job Time
     C                     MOVELWJAYNA    WKAYNA           User Id
     C                     MOVELWJA0NA    WKA0NA           Job Name
     C                     Z-ADDWJAXDT    WKAXDT           Job Date
      *
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WKAATM           Job Time
     C                     MOVEL##USR     WKAYNA           User Id
     C                     MOVEL##PGM     WKA0NA           Job Name
     C                     Z-ADD##JDT     WKAXDT           Job Date
     C           KLCRSM    KLIST
     C                     KFLD           WKAIC3           Company Number
     C                     KFLD           WKC4NB           Order Number
     C                     KFLD           WKDPNB           Order Sequence
     C                     KFLD           WKUENB           Order Secondary
      * Check for duplicate primary key
     C           KLCRSM    SETLL@BGWKL0                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR1310' W0RTN   7
      * Send message 'Order Detail           EX'
     C                     MOVEL'USR1310' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C                     WRITE@BGWKL0                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Chk Order Exist    RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#DM1NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSN     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL*BLANK    YN0003           Reason Code
     C                     MOVEL'N'       YN0004           Order in Use
     C                     MOVEL*BLANK    YN0005           Header Status
     C                     MOVEL*BLANK    YN0008           User Id
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Shipping Co,Desc   RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WLAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DIEAA    WLAJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAUNA           Warehouse Descr
     C                     Z-ADD*ZERO     YL0007           Shipping Compan
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWLF8NA    #DAUNA           Warehouse Descr
     C                     Z-ADDWLBWC3    YL0007           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * RTV Bio-d Code for Whs RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #DILAA           COA Bio-diesel
     C                     MOVEL*BLANK    #DP9NA           COA Bio-dsl Fue
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMAIC3    WQSP01           Company Number
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WQSP01           Company Number
      * Establish starting position
     C           KRSSP     SETLL@CAREOB                    *
     C           KRSSP     READE@CAREOB                  90*
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Record Status is Active
     C           WMVSST    IFEQ 'A'                        *IF
      * CASE:
      *  - c1 OR c2 OR c3 OR c4 OR c5 OR c6
      *   |- c1    : DB1.COA Active Whse/Tank 1 EQ PAR.COA Active Whse/Ta
      *   |- c2    : DB1.COA Active Whse/Tank 2 EQ PAR.COA Active Whse/Ta
      *   |- c3    : DB1.COA Active Whse/Tank 3 EQ PAR.COA Active Whse/Ta
      *   |- c4    : DB1.COA Active Whse/Tank 4 EQ PAR.COA Active Whse/Ta
      *   |- c5    : DB1.COA Active Whse/Tank 5 EQ PAR.COA Active Whse/Ta
      *   |- c6    : DB1.COA Active Whse/Tank 6 EQ PAR.COA Active Whse/Ta
      *   '-
     C           WMIEAA    IFEQ #DIEAA                     *IF
     C           WMIFAA    OREQ #DIEAA                     *OR
     C           WMIGAA    OREQ #DIEAA                     *OR
     C           WMIHAA    OREQ #DIEAA                     *OR
     C           WMIIAA    OREQ #DIEAA                     *OR
     C           WMIJAA    OREQ #DIEAA                     *OR
      * PAR = DB1 By name
     C                     MOVELWMIDAA    #DILAA           COA Bio-diesel
     C                     MOVELWMR2NA    #DP9NA           COA Bio-dsl Fue
     C                     GOTO SPEXIT                     *QUIT
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSP     READE@CAREOB                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * RTV Check for Warehse  RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DJINY           COA Batch Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOAIC3    WQSQ01           Company Number
     C           *LIKE     DEFN WOIKAA    WQSQ02           COA Active Whse
     C           *LIKE     DEFN WOHXTX    WQSQ03           COA Batch Heade
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ01           Company Number
     C                     KFLD           WQSQ02           COA Active Whse
     C                     KFLD           WQSQ03           COA Batch Heade
      * Setup key
     C                     Z-ADD#1AIC3    WQSQ01           Company Number
     C                     MOVEL#DIEAA    WQSQ02           COA Active Whse
     C                     MOVEL'O'       WQSQ03           COA Batch Heade
      * Establish starting position
     C           KRSSQ     SETLL@CCCPPD                    *
     C           KRSSQ     READE@CCCPPD                  90*
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWOI3NY    #DJINY           COA Batch Numbe
      * There should only ever be one record found, but quit just in case
     C                     GOTO SQEXIT                     *QUIT
     C           KRSSQ     READE@CCCPPD                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Company Name Only  RT - Company Name and Address  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WRAIC3           Company Number
      * Setup key
     C                     Z-ADD#1AIC3    WRAIC3           Company Number
      * Establish starting position
     C           KRSSR     CHAIN@ABREAK              90    *
      * Data record not found
     C   90                MOVEL'USR0003' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWRADTX    #DADTX           Name
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Ship Cust,Ordr Typ RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           BEAIC3           Company Number
     C                     KFLD           BEC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    BEAIC3           Company Number
     C                     Z-ADD#1C4NB    BEC4NB           Order Number
      * Establish starting position
     C           KRSSS     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0005           Ship To Custome
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDBEBKC7    YL0005           Ship To Custome
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STRVGN    BEGSR
      *================================================================
      * RTV HPB fields         RT - Order Header Extension  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSST     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADD#1AIC3    WCAIC3           Company Number
     C                     Z-ADD#1C4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSST     CHAIN@AMREJF              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3697' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DI3NY           HPB COA Batch N
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCITNY    #DI3NY           HPB COA Batch N
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * RTV all used fields    RT - COA Batch Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     MOVEL*BLANK    #DIKAA           COA Active Whse
     C                     MOVEL*BLANK    #DIDAA           COA Bio-diesel
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WSAIC3           Company Number
     C                     KFLD           WSI3NY           COA Batch Numbe
      * Setup key
     C                     Z-ADD#1AIC3    WSAIC3           Company Number
     C                     Z-ADD#DI3NY    WSI3NY           COA Batch Numbe
      * Establish starting position
     C           KRSSU     CHAIN@CCCPOH              90    *
      * Data record not found
     C   90                MOVEL'USR3803' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWSIKAA    #DIKAA           COA Active Whse
     C                     MOVELWSIDAA    #DIDAA           COA Bio-diesel
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * RTV Description        RT - COA Property Define Hdr  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WMAIC3           Company Number
     C                     KFLD           WMIDAA           COA Bio-diesel
      * Setup key
     C                     Z-ADD#1AIC3    WMAIC3           Company Number
     C                     MOVEL#DIDAA    WMIDAA           COA Bio-diesel
      * Establish starting position
     C           KRSSV     CHAIN@CAREOB              90    *
      * Data record not found
     C   90                MOVEL'USR3799' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMR2NA    #DR2NA           COA Bio-dsl Fue
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * RTV Whse Descrip       RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WTAJCD           Warehouse Code
      * Setup key
     C                     MOVEL#DIKAA    WTAJCD           Warehouse Code
      * Establish starting position
     C           KRSSW     CHAIN@ADRET1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
      * PAR = CON By name
     C                     MOVEL*BLANK    #DAVNA           Warehouse Descr
     C                     GOTO SWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWTF8NA    #DAVNA           Warehouse Descr
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * RTV Applic. Group Desc RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVDNCD    WQSX01           Application Cod
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Application Cod
      * Setup key
     C                     MOVE *BLANK    WQSX01           Application Cod
     C                     MOVEL'SHP'     WQSX01           Application Cod
      * Establish starting position
     C           KRSSX     SETLL@DNRESF                    *
     C           KRSSX     READE@DNRESF                  90*
      * Data record not found
     C   90                MOVEL'USR0755' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Application Group is Blank
     C           WVRSCD    IFEQ *BLANK                     *IF
      * PAR = DB1 By name
     C                     MOVELWVAUNA    WUAUNA           Description
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Application Desc   RT - Application  * 
     C                     EXSR SYRVGN
     C                     END                             *FI
     C           KRSSX     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * RTV Application Desc   RT - Application  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVDNCD    WQSY01           Application Cod
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WQSY01           Application Cod
      * Setup key
     C                     MOVELWVRSCD    WQSY01           Application Cod
      * Establish starting position
     C           KRSSY     SETLL@DNRESF                    *
     C           KRSSY     READE@DNRESF                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0755' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUAUNA           Description
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWVAUNA    WUAUNA           Description
     C           KRSSY     READE@DNRESF                  90*
     C                     ENDDO
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * RTV OP status          RT - Company Control  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WWAIC3           Company Number
      * Setup key
     C                     Z-ADD*ZERO     WWAIC3           Company Number
      * Establish starting position
     C           KRSSZ     CHAIN@ASREGT              90    *
      * Data record not found
     C   90                MOVEL'USR0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWWCHST    YL0008           Auto Order Numb
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * ***** CHANGE LOG and comments
      *================================================================
      * 01/14/09 LJB FP1303  Recompile for changes to OHE file
      * 10/31/07 TPA
      * Notes: This program is called from PDL6DFR-WW Orders for Shipment
      * and will initially be used by Biodiesel companies for the situati
      * when they need to add an order to a load at the time the load
      * is being filled. The user only has to select a Warehouse from whi
      * the second batch will be drawn.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C                     MOVELV1AIC3    WK1X01  1
     C                     MOVELV1C4NB    WK1X02  1
     C           WK1X01    IFEQ '?'                        Company Number
     C           YPMTFD    OREQ '#1AIC3'
     C           WK1X02    OREQ '?'                        Order Number
     C           YPMTFD    OREQ '#1C4NB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1AIC3' defaulted for 'Company Number'.
      * Field '(DTL) #1C4NB' defaulted for 'Order Number'.
     C                     CALL 'PDPCSRR'              90  SEL Order
     C                     PARM *BLANK    W0RTN   7
     C           #1AIC3    PARM #1AIC3    WQ0011  30       Company Number
     C           #1C4NB    PARM #1C4NB    WQ0012  70       Order Number
      *
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDPCSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1AIC3    IFNE *ZERO                      Company Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1C4NB    IFNE *ZERO                      Order Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     MOVE *BLANK    W0CFL
     C                     Z-ADD1         F       30
     C           ZINPOS    LOKUPW0END,F              96  96LE
     C           *IN96     IFEQ '1'
     C           ZINPOS    ANDGEW0BEG,F
     C                     MOVELW0NAM,F   W0CFL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM ##PGM     W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM *ZERO     YYLGCT  50       # of grps
     C                     PARM *BLANK    YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel & exit program
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAXNB           Current Account
     C                     Z-ADD*ZERO     WANGNB           Current Account
     C                     Z-ADD*ZERO     WABZNB           OM Week
     C                     Z-ADD*ZERO     WAC5NB           Next Order Numb
     C                     Z-ADD*ZERO     WAC3NB           Next Invoice Nu
     C                     Z-ADD*ZERO     WACYNB           Next Credit Mem
     C                     Z-ADD*ZERO     WAIONB           Next Late Charg
     C                     Z-ADD*ZERO     WAI6NB           Next On Acct Ca
     C                     Z-ADD*ZERO     WADCNB           Next Voucher Nu
     C                     Z-ADD*ZERO     WAC7NB           Next Customer #
     C                     Z-ADD*ZERO     WAC2NB           Next Inventory
     C                     Z-ADD*ZERO     WAC1NB           Next PFS Batch
     C                     Z-ADD*ZERO     WAL8NB           Next Contract/P
     C                     Z-ADD*ZERO     WABANB           Next HPB Batch
     C                     Z-ADD*ZERO     WAAIPC           Manual Price Ac
     C                     Z-ADD*ZERO     WAASPC           CoPk/FdSrv ManP
     C                     Z-ADD*ZERO     WAA2VA           Late Charge Min
     C                     Z-ADD*ZERO     WAAADY           A/P Aging Days
     C                     Z-ADD*ZERO     WAABDY           A/P Aging Days
     C                     Z-ADD*ZERO     WAACDY           A/P Aging Days
     C                     Z-ADD*ZERO     WAADDY           A/P Aging Days
     C                     Z-ADD*ZERO     WAAEDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAFDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAGDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAHDY           A/R Aging Days
     C                     Z-ADD*ZERO     WAAENB           Retention Perio
     C                     Z-ADD*ZERO     WAALNB           Retention Perio
     C                     Z-ADD*ZERO     WAEVNB           Retention Perio
     C                     Z-ADD*ZERO     WARPOP           Retention Perio
     C                     Z-ADD*ZERO     WADWNB           Retention Perio
     C                     Z-ADD*ZERO     WAR3NB           Next Load ID
     C                     Z-ADD*ZERO     WAR4NB           Next Item Numbe
     C                     Z-ADD*ZERO     WASCNB           Production Numb
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WBBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WBB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WBA0DT           Order Date
     C                     Z-ADD*ZERO     WBA5DT           Requested Ship
     C                     Z-ADD*ZERO     WBGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WBACDT           Cancel Date
     C                     Z-ADD*ZERO     WBAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WBCXDT           Date of Origina
     C                     Z-ADD*ZERO     WBJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WBA1WG           Order Weight To
     C                     Z-ADD*ZERO     WBEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WBAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WBATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WBRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WBT3NB           Attach to Order
     C                     Z-ADD*ZERO     WBCONB           Invoice Number
     C                     Z-ADD*ZERO     WBAWDT           Invoice Date
     C                     Z-ADD*ZERO     WBVRVA           A/R order Value
     C                     Z-ADD*ZERO     WBB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WBNODT           OH Unused Date
     C                     Z-ADD*ZERO     WBNPDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNQDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNRDT           OH Unused Date
     C                     Z-ADD*ZERO     WBNSDT           OH Unused Date
     C                     Z-ADD*ZERO     WBBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WBBQTM           Time of Origina
     C                     Z-ADD*ZERO     WBBRTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBSTM           OH Unused Time
     C                     Z-ADD*ZERO     WBBTTM           OH Unused Time
     C                     Z-ADD*ZERO     WBH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WBH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WBH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WBH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WBH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WBC0C7           Claim Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WCGENY           OHE Voyage/Flig
     C                     Z-ADD*ZERO     WCQWDT           OHE Sail/Flight
     C                     Z-ADD*ZERO     WCQXDT           OHE Actual Depa
     C                     Z-ADD*ZERO     WCQYDT           OHE Arrival Dat
     C                     Z-ADD*ZERO     WCGINY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGFNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGGNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCGHNY           OHE Unused Numb
     C                     Z-ADD*ZERO     WCHEVL           OHE Unused Valu
     C                     Z-ADD*ZERO     WCHFVL           OHE Unused Valu
     C                     Z-ADD*ZERO     WCHGVL           OHE Unused Valu
     C                     Z-ADD*ZERO     WCQZDT           OHE Unused Date
     C                     Z-ADD*ZERO     WCQ0DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCQ1DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCQ2DT           OHE Unused Date
     C                     Z-ADD*ZERO     WCITNY           HPB COA Batch N
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDRMNB           Load ID
     C                     Z-ADD*ZERO     WDRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WDRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WDRWNB           Miles to next s
     C                     Z-ADD*ZERO     WDRXNB           Freight Charge
     C                     Z-ADD*ZERO     WDSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WDT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WDT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WDR1NB           Rated Freight
     C                     Z-ADD*ZERO     WDAIC3           Company Number
     C                     Z-ADD*ZERO     WDC4NB           Order Number
     C                     Z-ADD*ZERO     WDKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WDSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WDKFDT           Appointment Con
     C                     Z-ADD*ZERO     WDACTM           Appointment Con
     C                     Z-ADD*ZERO     WDEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WDAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WDKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WDATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WDHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WDAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WDKKDT           On Yard Date
     C                     Z-ADD*ZERO     WDAVTM           On Yard Time
     C                     Z-ADD*ZERO     WDZ4NB           MPC Number
     C                     Z-ADD*ZERO     WDN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WDN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WDN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WDB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WDB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WDB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Clear all neither parameters
      * CRT Load Detail        CR - Load Detail  * 
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Obtain default message file
     C           *NAMVAR   DEFN CAMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHAIC3           Company Number
     C                     Z-ADD*ZERO     WHC4NB           Order Number
     C                     Z-ADD*ZERO     WHQ2NB           Event Number
     C                     Z-ADD*ZERO     WHAUC3           Invoice/Memo Co
     C                     Z-ADD*ZERO     WHQ7NB           Invoice/Memo Nu
     C                     Z-ADD*ZERO     WHD2DT           Event Date
     C                     Z-ADD*ZERO     WHAWC3           Cross Event Ref
     C                     Z-ADD*ZERO     WHQ8NB           Cross Event Ref
     C                     Z-ADD*ZERO     WHQ9NB           Cross Event Ref
     C                     Z-ADD*ZERO     WHBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Clear all neither parameters
      * CRT OP Order Events    CR - Order Events  * 
     C                     Z-ADD*ZERO     WIAATM           Job Time
     C                     Z-ADD*ZERO     WIAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJAIC3           Company Number
     C                     Z-ADD*ZERO     WJC4NB           Order Number
     C                     Z-ADD*ZERO     WJDPNB           Order Sequence
     C                     Z-ADD*ZERO     WJUENB           Order Secondary
     C                     Z-ADD*ZERO     WJHGCD           Item Code
     C                     Z-ADD*ZERO     WJBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WJCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WJMAVA           Billing Detail
     C                     Z-ADD*ZERO     WJKDVA           Billing Detail
     C                     Z-ADD*ZERO     WJL8VA           Billing Detail
     C                     Z-ADD*ZERO     WJL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WJAYVA           Extended Amount
     C                     Z-ADD*ZERO     WJEXDT           Market Pricing
     C                     Z-ADD*ZERO     WJBZPR           Price Overage O
     C                     Z-ADD*ZERO     WJL6NB           Contract Number
     C                     Z-ADD*ZERO     WJGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WJR1NB           Rated Freight
     C                     Z-ADD*ZERO     WJAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WJD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WJCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WJAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WJCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WJATWG           Weight Shipped
     C                     Z-ADD*ZERO     WJAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WJAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WJAKPR           Unit Price
     C                     Z-ADD*ZERO     WJALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WJAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WJAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WJA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WJA5DT           Requested Ship
     C                     Z-ADD*ZERO     WJAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WJGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WJRGNB           Item Structure
     C                     Z-ADD*ZERO     WJRHNB           Item Structure
     C                     Z-ADD*ZERO     WJRINB           Item Structure
     C                     Z-ADD*ZERO     WJCXDT           Date of Origina
     C                     Z-ADD*ZERO     WJDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WJB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WJA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WJNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WJNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WJNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WJNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WJNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WJBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WJBVTM           Price Code
     C                     Z-ADD*ZERO     WJBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WJBXTM           Substitution Li
     C                     Z-ADD*ZERO     WJBYTM           OD Quantity Pro
     C                     Z-ADD*ZERO     WJH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WJH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WJH7NX           OD Item Target
     C                     Z-ADD*ZERO     WJH8NX           OD Minimum Unit
     C                     Z-ADD*ZERO     WJH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WJDVPR           Order Gate Pric
     C                     Z-ADD*ZERO     WJDWPR           OD Unused Prc 2
     C                     Z-ADD*ZERO     WJDXPR           OD Unused Prc 3
     C                     Z-ADD*ZERO     WJDYPR           OD Unused Prc 4
     C                     Z-ADD*ZERO     WJDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WJAATM           Job Time
     C                     Z-ADD*ZERO     WJAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WLDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WLBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WLBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WLBUC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WLBVC3           WHS Unused Comp
     C                     Z-ADD*ZERO     WLAATM           Job Time
     C                     Z-ADD*ZERO     WLAXDT           Job Date
      * Define work field CD3 Ext Numeric Key
     C                     MOVEL*BLANK    WUDMCD  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMAIC3           Company Number
     C                     Z-ADD*ZERO     WMJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WMJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WMJENY           COA Temperature
     C                     Z-ADD*ZERO     WMJFNY           COA Temperature
     C                     Z-ADD*ZERO     WMGMPC           COA BOL Percent
     C                     Z-ADD*ZERO     WMJQNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WMJRNY           COA Temp Conv F
     C                     Z-ADD*ZERO     WMI1NY           COA Unused Numb
     C                     Z-ADD*ZERO     WMMJDT           Create Date
     C                     Z-ADD*ZERO     WMBETM           Create Time
     C                     Z-ADD*ZERO     WMMKDT           Change Date
     C                     Z-ADD*ZERO     WMBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WOAIC3           Company Number
     C                     Z-ADD*ZERO     WOI3NY           COA Batch Numbe
     C                     Z-ADD*ZERO     WORFDT           COA Date Open f
     C                     Z-ADD*ZERO     WOC2TM           COA Time Open f
     C                     Z-ADD*ZERO     WORGDT           COA Date Close
     C                     Z-ADD*ZERO     WOC3TM           COA Time Close
     C                     Z-ADD*ZERO     WOJHNY           COA Gallons Use
     C                     Z-ADD*ZERO     WORHDT           COA Batch Produ
     C                     Z-ADD*ZERO     WOC4TM           COA Batch Unuse
     C                     Z-ADD*ZERO     WOJENY           COA Temperature
     C                     Z-ADD*ZERO     WOJVNY           COA Batch Volum
     C                     Z-ADD*ZERO     WOJWNY           COA Batch Denat
     C                     Z-ADD*ZERO     WOJXNY           COA Batch Expor
     C                     Z-ADD*ZERO     WOJ1NY           COA Last RIN EE
     C                     Z-ADD*ZERO     WOJCNY           COA Density Loa
     C                     Z-ADD*ZERO     WOJDNY           COA Density Ref
     C                     Z-ADD*ZERO     WOJ3NY           COA Batch Unuse
     C                     Z-ADD*ZERO     WORLDT           COA Batch Unuse
     C                     Z-ADD*ZERO     WOMJDT           Create Date
     C                     Z-ADD*ZERO     WOBETM           Create Time
     C                     Z-ADD*ZERO     WOMKDT           Change Date
     C                     Z-ADD*ZERO     WOBFTM           Change Time
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WRAIC3           Company Number
     C                     Z-ADD*ZERO     WRAATM           Job Time
     C                     Z-ADD*ZERO     WRAXDT           Job Date
      * Define work field CD7 Ext Numeric Key
     C                     MOVEL*BLANK    WUEOCD  7
      * Define work field Description
     C                     MOVEL*BLANK    WUAUNA 30
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field USR Description 40
     C                     MOVEL*BLANK    WUDSC4 40
      * Define work field USR Description 40   2
     C                     MOVEL*BLANK    WUDE40 40
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     MOVE ZZFFL     @1FFL  10
     C                     MOVE ZZFLB     @1FLB  10
     C                     MOVE ZZFMB     @1FMB  10
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
     C                     MOVEL'Y'       W0PMT   1
      * Define local variables for subroutine SKCRRC.
     C                     Z-ADD*ZERO     WL0001  30
     C                     Z-ADD*ZERO     WL0002  70
     C                     Z-ADD*ZERO     WL0003  50
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005  30
     C                     Z-ADD*ZERO     WL0006  70
     C                     MOVEL*BLANK    WL0007  2
     C                     Z-ADD*ZERO     WL0008  70
     C                     MOVEL*BLANK    WL0009  1
     C                     MOVEL*BLANK    WL0010  1
     C                     MOVEL*BLANK    WL0011  1
     C                     Z-ADD*ZERO     WL0012  30
     C                     Z-ADD*ZERO     WL0013  70
     C                     Z-ADD*ZERO     WL0014  50
     C                     Z-ADD*ZERO     WL0015  70
      * Define local work field USR Next Order Number
     C                     Z-ADD*ZERO     YL0001  70
      * Define local work field USR Next Order Number
     C                     Z-ADD*ZERO     YL0002  70
      * Define local work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YL0003  50
      * Define local work field Event Code
     C                     MOVEL*BLANK    YL0004  2
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Order Value Total
     C                     Z-ADD*ZERO     YL0006 112
      * Define null work field Order Weight Total
     C                     Z-ADD*ZERO     YN0001 112
      * Define null work field Customer Purchase Order #
     C                     MOVEL*BLANK    YN0002 15
      * Define null work field Reason Code
     C                     MOVEL*BLANK    YN0003  3
      * Define null work field Order in Use
     C                     MOVEL*BLANK    YN0004  1
      * Define null work field Header Status
     C                     MOVEL*BLANK    YN0005  1
      * Define null work field Accounts Receiv. Ent 1
     C                     MOVEL*BLANK    YN0006  4
      * Define null work field Accounts Receiv. Ent 2
     C                     MOVEL*BLANK    YN0007 12
      * Define null work field User Id
     C                     MOVEL*BLANK    YN0008 10
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0007  30
      * Define local work field Auto Order Numbering?
     C                     MOVEL*BLANK    YL0008  1
      * Define null work field Order Type - Sales
     C                     MOVEL*BLANK    YN0009  2
      * Define null work field COA Date Open for Ship
     C                     Z-ADD*ZERO     YN0010  70
      * Define null work field COA Time Open for Ship
     C                     Z-ADD*ZERO     YN0011  60
      * Define null work field COA Open for Ship Inits
     C                     MOVEL*BLANK    YN0012  3
      * Define null work field COA Date Close from Ship
     C                     Z-ADD*ZERO     YN0013  70
      * Define null work field COA Time Close from Ship
     C                     Z-ADD*ZERO     YN0014  60
      * Define null work field COA Close from Ship Inits
     C                     MOVEL*BLANK    YN0015  3
      * Define null work field COA Gallons Used
     C                     Z-ADD*ZERO     YN0016  70
      * Define null work field COA Comment
     C                     MOVEL*BLANK    YN0017 30
      * Define null work field COA Batch Header Sts
     C                     MOVEL*BLANK    YN0018  1
      * Define null work field COA Batch Properties Cmpl
     C                     MOVEL*BLANK    YN0019  1
      * Define null work field Record Status
     C                     MOVEL*BLANK    YN0020  1
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * ***** CHANGE LOG and comments
     C                     EXSR UASUBR                     ***** CHANGE LO
      * VAL Rtv and Center Hdg IF
      * SET Screen Headings    IF
      * RTV Applic. Group Desc RT - Application  * 
     C                     EXSR SXRVGN
     C                     MOVEL*BLANK    WUDSC4           USR Description
     C                     MOVELWUAUNA    WUDSC4           USR Description
      * CLC Center Txt Str 40  US - /UT User Source  * 
     C                     MOVEAWUDSC4    UCT              LOAD ARRAY
     C                     Z-ADD40        UX      20       SET COUNTER
     C           UX        DOWGT0
     C           UCT,UX    IFEQ ' '
     C                     SUB  1         UX
     C                     ELSE
     C                     Z-ADDUX        UXH     20
     C                     Z-ADD0         UX
     C                     END
     C                     END
     C           40        SUB  UXH       UX
     C           UX        DIV  2         UX
     C           UX        IFGT 0
     C                     MOVE *BLANKS   UCT
     C                     MOVEAWUDSC4    UCT,UX
     C                     END
     C                     MOVEAUCT       WUDE40           LOAD OUTPUT
      * MOV Appl Desc-Co Head  US - /UT User Source  * 
     C                     MOVE WUDE40    ##CMP  40
      * Get the auto-generation of order numbers flag
      * RTV OP status          RT - Company Control  * 
     C                     EXSR SZRVGN
      * Load screen
     C                     EXSR MALDSC
      *================================================================
     CSR         ZZEXIT    ENDSR
** W0BEG
01056010640182702083020910233902347
02595036190387503883041310413904387
** W0END
01058010930183302085021200234402376
02599036250387703912041360416804391
** W0NAM
V1AIC3    #DADTX    V1C4NB    #DIKAA    #DAVNA    #DIDAA    #DR2NA
#DI3NY    #DM1NB    #DIEAA    #DAUNA    #DILAA    #DP9NA    #DJINY
