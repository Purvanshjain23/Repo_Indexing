// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPTNXFR
// ?Date: 14.08.2025 Time: 03:41:54
// ?------------------------------------------------------------------------------------------------

//?Execute user function

EXECUTE FUNCTION(FIX Load Status       RT) TYPE(RTVOBJ) FILE(OMFJCPP)           AC1754258;
{
 //?USER: Process Data record

 EXECUTE FUNCTION(RTV Ld Orders Invoiced RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1377315;
 PARAMETER(DB1.Load_ID);
 PARAMETER(LCL.Invoiced_Flag_USR);
 {
  //?USER: Initialize routine

  //?05/12/04 SLM PKTR01 Multi-Company - Function was changed
  //?                                    to remove Company RST or Pos
  // PAR.Invoiced Flag USR = CND.Invoiced
  PAR.Invoiced_Flag_USR = 'Y';

  //?USER: Process Data record

  CASE;

  // IF DB1.Header Status is Complete
  IF ( ( DB1.Header_Status = 'C';

  // AND DB1.Event Code is 07 Written to History
  AND DB1.Event_Code = '07' );

  // OR DB1.Header Status is Cancelled
  OR DB1.Header_Status = 'X' );

  // IF *OTHERWISE
  IF *OTHERWISE;

  // PAR.Invoiced Flag USR = CND.Not Invoiced
  PAR.Invoiced_Flag_USR = 'N';

  QUIT;

  ENDIF;

 }

 CASE;

 // IF LCL.Invoiced Flag USR is Invoiced
 IF LCL.Invoiced_Flag_USR = 'Y';

 EXECUTE FUNCTION(CHG Load Status        CH) TYPE(CHGOBJ) FILE(OMFJCPP)          AC1197977;
 PARAMETER(DB1.Load_ID);
 PARAMETER(DB1.Scheduled_Ship_Date);
 PARAMETER('I');
 {
  //?USER: Processing before Data update

  // DB1.Job Time = JOB.*Job time
  DB1.Job_Time = JOB.*Job_time;

  // DB1.User Id = JOB.*USER
  DB1.User_Id = JOB.*USER;

  // DB1.Job Name = JOB.*JOB
  DB1.Job_Name = JOB.*JOB;

  // DB1.Job Date = JOB.*Job date
  DB1.Job_Date = JOB.*Job_date;

 }

 ENDIF;

}


