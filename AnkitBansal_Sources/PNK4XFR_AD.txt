// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PNK4XFR
// ?Date: 14.08.2025 Time: 03:45:27
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?crt history detl accr, and fix sales hist amts
EXECUTE FUNCTION(Rtv Crt Hist Dtl Accr  RT) TYPE(RTVOBJ) FILE(OMHRCPP)          AC1949358;
PARAMETER(PAR.Company_Number);
PARAMETER(PAR.Order_Number);
{
 //?USER: Process Data record

 // LCL.Order Number = DB1.Order Number
 LCL.Order_Number = DB1.Order_Number;

 // LCL.Company Number = DB1.Company Number
 LCL.Company_Number = DB1.Company_Number;

 EXECUTE FUNCTION(RTV 1st Warehouse      RT) TYPE(RTVOBJ) FILE(OPBGWKP)          AC1575817;
 PARAMETER(DB1.Company_Number);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(LCL.Warehouse_Code);
 {
  //?USER: Process Data record

  // PAR.Warehouse Code = DB1.Warehouse Code
  PAR.Warehouse_Code = DB1.Warehouse_Code;

  QUIT;

 }

 EXECUTE FUNCTION(Rtv Acct Co          RT) TYPE(RTVOBJ) FILE(CAADREP)            AC1802492;
 PARAMETER(LCL.Warehouse_Code);
 PARAMETER(LCL.Accounting_Company);
 {
  //?USER: Processing if Data record not found

  MOVE *ALL (To: PAR From: CON);

  //?USER: Process Data record

  MOVE *ALL (To: PAR From: DB1);

 }

 EXECUTE FUNCTION(CRT PD History Dtl Acc CO) TYPE(CRTOBJ) FILE(PDICCPP)          AC1255124;
 PARAMETER(LCL.Accounting_Company);
 PARAMETER(DB1.Order_Number);
 PARAMETER(DB1.Order_Sequence_Number);
 PARAMETER(DB1.Order_Secondary_Line_Seq);
 PARAMETER(DB1.Sequence_Number);
 PARAMETER(DB1.Accrual_Rate);
 PARAMETER(DB1.Extended_Amount);
 PARAMETER(DB1.Item_Accrual_Amt);
 PARAMETER(DB1.Item_Code);
 PARAMETER(DB1.Ship_To_Customer);
 PARAMETER(DB1.SDA_Actual_Ship_Date);
 PARAMETER(DB1.Weight_Billed);
 PARAMETER('Y');
 PARAMETER(DB1.Retro_Comm_Calculated);
 PARAMETER(DB1.Accrual_Type);
 PARAMETER(DB1.SDA_Affect_Sales_Realz);
 PARAMETER(DB1.SDA_Affect_Invoice_Price);
 PARAMETER(DB1.SDA_Print_on_Invoice);
 PARAMETER(DB1.SDA_Invoice_Print_Type);
 PARAMETER(*ZERO);
 PARAMETER(DB1.SDA_Ord_Dtl_Acrl_Seq);
 PARAMETER(*ZERO);
 PARAMETER(*ZERO);
 PARAMETER(DB1.SH_Expense_Bucket);
 PARAMETER(DB1.G_L_Sub_Account);
 PARAMETER(DB1.SDA_Post_to_G_L_Y_N);
 PARAMETER(DB1.SDA_Accrual_Rate_Type);
 PARAMETER(DB1.SDA_Invoice_Date);
 PARAMETER(DB1.SDA_Sub_Ledger_Code);
 PARAMETER(DB1.SDA_G_L_Sub_Ledger);
 PARAMETER(DB1.SDA_G_L_Code_Dr);
 PARAMETER(DB1.SDA_G_L_Code_Cr);
 PARAMETER(DB1.SDA_JDE_Account_ID_Dr);
 PARAMETER(DB1.SDA_JDE_Account_ID_Cr);
 PARAMETER(DB1.Broker_Code);
 PARAMETER(DB1.Accrual_Code);
 PARAMETER(JOB.*Job_time);
 PARAMETER(JOB.*USER);
 PARAMETER(JOB.*JOB);
 PARAMETER(JOB.*Job_date);
 {
  //?USER: Processing after Data update

  //?08/09/2007 Todd Johnson
  //?Based on EIS Specifications - FDD Accruals
  EXECUTE FUNCTION(Rtv Plant Co/Org      RT) TYPE(RTVOBJ) FILE(PDJYREP)           AC1826265;
  PARAMETER(DB1.Company_Number);
  PARAMETER(NLL.Plant_Company_Sts);
  PARAMETER(LCL.Company_Organization);
  {
   //?USER: Processing if Data record not found

   MOVE *ALL (To: PAR From: CON);

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  CASE;

  // IF LCL.Company Organization is Daily's
  IF LCL.Company_Organization = 'D';

  //?If Accrual Type is TF
  CASE;

  // IF DB1.Accrual Type is Trade Fund/Marketing
  IF DB1.Accrual_Type = 'TF';

  EXECUTE FUNCTION(Rtv Descriptions      RT) TYPE(RTVOBJ) FILE(CABZREP)           AC1140665;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Item_Code);
  PARAMETER(LCL.Description_Line_One);
  PARAMETER(NLL.Description_Line_Two);
  PARAMETER(NLL.UOM_Primary);
  PARAMETER(NLL.UOM_Second);
  PARAMETER(NLL.UOM_Third);
  {
   //?USER: Processing if Data record not found

   // PGM.*Return code = CND.*Record does not exist
   PGM.*Return_code = 'Y2U0005';

   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  EXECUTE FUNCTION(RTV All Header Fields  RT) TYPE(RTVOBJ) FILE(OPBFCPP)          AC1326885;
  PARAMETER(DB1.Company_Number);
  PARAMETER(DB1.Order_Number);
  PARAMETER(NLL.Order_Type_Sales);
  PARAMETER(NLL.AR_Customer_Number);
  PARAMETER(NLL.Ship_To_Customer);
  PARAMETER(NLL.Ship_To_Name);
  PARAMETER(NLL.Ship_To_Address_Line_1);
  PARAMETER(NLL.Ship_To_Address_Line_2);
  PARAMETER(NLL.Ship_To_Address_Line_3);
  PARAMETER(NLL.Ship_To_City);
  PARAMETER(NLL.Ship_To_State_Code);
  PARAMETER(NLL.Ship_To_Zip_Postal_Code);
  PARAMETER(NLL.Bill_to_Customer);
  PARAMETER(NLL.Bill_to_Name);
  PARAMETER(NLL.Bill_to_Address_Line_1);
  PARAMETER(NLL.Bill_to_Address_Line_2);
  PARAMETER(NLL.Bill_to_Address_Line_3);
  PARAMETER(NLL.Bill_to_City);
  PARAMETER(NLL.Bill_to_State_Code);
  PARAMETER(NLL.Bill_to_Zip_Postal_Code);
  PARAMETER(NLL.Customer_Purchase_Order_#);
  PARAMETER(NLL.Order_Date);
  PARAMETER(NLL.Requested_Ship_Date);
  PARAMETER(NLL.Actual_Shipped_Date);
  PARAMETER(NLL.Cancel_Date);
  PARAMETER(NLL.Terms_Code);
  PARAMETER(NLL.Special_Instructions);
  PARAMETER(NLL.Special_Instructions_2);
  PARAMETER(NLL.Carrier_Code);
  PARAMETER(NLL.Comment_Print_Acknowledge);
  PARAMETER(NLL.Comment_Print_Inv_Cr_Memo);
  PARAMETER(NLL.Comment_Print_Pick_Slip);
  PARAMETER(NLL.Comment_Print_Ship_Doc);
  PARAMETER(NLL.Reason_Code);
  PARAMETER(NLL.Order_in_Use);
  PARAMETER(NLL.Header_Status);
  PARAMETER(NLL.Header_Status_Last);
  PARAMETER(NLL.Order_Type_Print_Status);
  PARAMETER(NLL.Scheduled_Ship_Date);
  PARAMETER(NLL.User_Original_Entry);
  PARAMETER(NLL.Date_of_Original_Entry);
  PARAMETER(NLL.Order_Value_Total);
  PARAMETER(NLL.Order_Weight_Total);
  PARAMETER(NLL.Credit_Hold);
  PARAMETER(NLL.Production_Hold);
  PARAMETER(NLL.New_Customer_Hold);
  PARAMETER(NLL.Requested_Delivery_Date);
  PARAMETER(NLL.Requested_Delivery_Time);
  PARAMETER(NLL.Accounts_Receiv_Ent_1);
  PARAMETER(NLL.Accounts_Receiv_Ent_2);
  PARAMETER(NLL.Load_ID);
  PARAMETER(NLL.Absorbed_Freight_Rate_CWT);
  PARAMETER(NLL.Rated_Freight);
  PARAMETER(NLL.LTL_Flag);
  PARAMETER(NLL.Price_Audit);
  PARAMETER(NLL.Price_Status);
  PARAMETER(NLL.Shipping_Method);
  PARAMETER(NLL.Export_Status);
  PARAMETER(NLL.Palletize);
  PARAMETER(NLL.Shrink_Wrap);
  PARAMETER(NLL.Slip_Sheet);
  PARAMETER(NLL.Age_Code);
  PARAMETER(NLL.Reefer_Temperature);
  PARAMETER(NLL.Load_Type);
  PARAMETER(NLL.Attach_to_Invoice_Number);
  PARAMETER(NLL.Load_Plan_Order);
  PARAMETER(NLL.Print_Pick_Slip);
  PARAMETER(NLL.Resell_Reference_Number);
  PARAMETER(NLL.Special_Comment_1);
  PARAMETER(NLL.Special_Comment_2);
  PARAMETER(NLL.Affect_Auto_Accruals);
  PARAMETER(NLL.Sales_Route_Code);
  PARAMETER(NLL.Manager_Level_Code);
  PARAMETER(NLL.VP_Level_Code);
  PARAMETER(NLL.Attach_to_Order_Number);
  PARAMETER(NLL.Reason_for_Price_Audit);
  PARAMETER(LCL.Invoice_Number);
  PARAMETER(NLL.Invoice_Suffix);
  PARAMETER(LCL.Invoice_Date);
  PARAMETER(NLL.Event_Code);
  PARAMETER(NLL.Trans_Contol_AS400_Plant);
  PARAMETER(NLL.Modified_Flag);
  PARAMETER(NLL.A_R_order_Value_Total);
  PARAMETER(NLL.Billing_Activity_Type);
  PARAMETER(NLL.Block_Order_Flag);
  PARAMETER(NLL.Order_Certification_Flag);
  PARAMETER(NLL.EDI_Status_1);
  PARAMETER(NLL.EDI_Status_2);
  PARAMETER(NLL.EDI_Status_3);
  {
   //?USER: Process Data record

   MOVE *ALL (To: PAR From: DB1);

  }

  //?Convert fields first
  CASE;

  // IF *OTHERWISE
  IF *OTHERWISE;

  //?Invoice date to YYYYMMDD
  // LCL.USR Internal D8# YYYYMMDD = LCL.Invoice Date
  LCL.USR_Internal_D8#_YYYYMMDD = LCL.Invoice_Date;

  //?Sub Ledger to Char
  // LCL.USR Work Field 5,0 = DB1.HDA G/L Sub Ledger
  LCL.USR_Work_Field_50 = DB1.HDA_G_L_Sub_Ledger;

  // LCL.Text USR 5 = CVTVAR(LCL.USR Work Field 5,0)
  LCL.Text_USR_5 = CVTVAR(LCL.USR_Work_Field_50);

  //?Invoice Number to Char
  // LCL.USR number = LCL.Invoice Number
  LCL.USR_number = LCL.Invoice_Number;

  // LCL.Invoice Number 6 USR = CVTVAR(LCL.USR number)
  LCL.Invoice_Number_6_USR = CVTVAR(LCL.USR_number);

  ENDIF;

  // Call program Zzz Crt ACCR TRANS RCD.
  CALL PROGRAM(Zzz Crt ACCR TRANS RCD) ('PMLQUPR');
  PARAMETER(DB1.Accrual_Rate);
  PARAMETER(DB1.Extended_Amount);
  PARAMETER(DB1.Item_Code);
  PARAMETER(DB1.Ship_To_Customer);
  PARAMETER(DB1.Weight_Billed);
  PARAMETER(LCL.Description_Line_One);
  PARAMETER(LCL.USR_Internal_D8#_YYYYMMDD);
  PARAMETER(LCL.Text_USR_5);
  PARAMETER(LCL.Invoice_Number_6_USR);

  ENDIF;

  ENDIF;

 }

}


