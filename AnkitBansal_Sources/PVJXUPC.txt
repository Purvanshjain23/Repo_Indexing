/**************************************************************************/
/*‚ PROGRAM:       PVJXUPC                                                */
/*‚ PROGRAM DESC:  APPLY TRIGGER TO Load Order Change Log (PDLHCPP) FILE. */
/*‚ PROGRAMMER:    Jagdish Mistry                                         */
/*‚ CREATE DATE:   02/19/2025                                             */
/*‚ PROJECT:       WI 642                                                 */
/*                                                                        */
/*‚ PURPOSE:       THIS WILL APPLY PHYSICAL FILE TRIGGER TO THE LOAD ORDER*/
/*‚                CHANGE LOG   (PDLHCPP) FILE FOR ALL TRIGGER            */
/*‚                DATABASE EVENTS:                                       */
/*‚                  INSERT, UPDATE & DELETE.                             */
/* -----------------------------------------------------------------------*/
/*‚ PARMS:                                                                */
/*‚                &ADDRMV = 'A' (ADD) OR 'R' (REMOVE)                    */
/*‚                &OBJLIB = OBJECT LIBRARY                               */
/**************************************************************************/
/* MODIFICATION HISTORY                                                   */
/**************************************************************************/
/* DATE     INT  PROJECT DESCRIPTION                                      */
/* -------- ---- ------- -------------------------------------------------*/
/*                                                                        */
/**************************************************************************/

             PGM        PARM(&ADDRMV &OBJLIB)

             DCL        VAR(&ADDRMV) TYPE(*CHAR) LEN(1)
             DCL        VAR(&OBJLIB) TYPE(*CHAR) LEN(10)

/* ADD TRIGGER */
             IF         COND(&ADDRMV *EQ 'A') THEN(DO)
/* ADD TRIGGER FOR INSERT */
             ADDPFTRG   FILE(&OBJLIB/PDLHCPP) TRGTIME(*AFTER) +
                          TRGEVENT(*INSERT) PGM(PVJVUPR) +
                          RPLTRG(*YES) +
                          TRG(TRG_LOAD_ORDER_CHANGE_LOG_INSERT)
             MONMSG     MSGID(CPF32C6)      /* NOT SUCCESSFUL */

/* ADD TRIGGER FOR UPDATE */
             ADDPFTRG   FILE(&OBJLIB/PDLHCPP) TRGTIME(*AFTER) +
                          TRGEVENT(*UPDATE) PGM(PVJVUPR) +
                          RPLTRG(*YES) +
                          TRG(TRG_LOAD_ORDER_CHANGE_LOG_UPDATE) +
                          TRGUPDCND(*CHANGE)
             MONMSG     MSGID(CPF32C6)      /* NOT SUCCESSFUL */

/* ADD TRIGGER FOR DELETE */
             ADDPFTRG   FILE(&OBJLIB/PDLHCPP) TRGTIME(*AFTER) +
                          TRGEVENT(*DELETE) PGM(PVJVUPR) +
                          RPLTRG(*YES) +
                          TRG(TRG_LOAD_ORDER_CHANGE_LOG_DELETE)
             MONMSG     MSGID(CPF32C6)      /* NOT SUCCESSFUL */
             ENDDO      /* &ADDRMV = 'A' */


/* REMOVE TRIGGER */
             IF         COND(&ADDRMV *EQ 'R') THEN(DO)
             RMVPFTRG   FILE(&OBJLIB/PDLHCPP) TRGEVENT(*ALL)
             MONMSG     MSGID(CPF32C6)      /* NOT SUCCESSFUL */
             ENDDO

 END:        ENDPGM
