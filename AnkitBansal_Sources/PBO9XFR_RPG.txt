     H/TITLE Exc Crt from Actual   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISRCENT
     H* Date          : 09/15/14  Time  : 15:20:43
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FCAEOREL5IF  E           K        DISK
      * RSQ : Company Customer          Customer
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FPBBOREL2IF  E           K        DISK
      * RSQ : DP Location               DP Location
      *
     FCABBREL1IF  E           K        DISK
      * RTV : Customer                  Retrieval index       NV
      *
     FPDNIREL3IF  E           K        DISK
      * RSQ : Company Customer EXT      Customer/Company
      *
     FPBBPREL0IF  E           K        DISK                      A
      * UPD : DP Product Location       Update index
      *
     FPBBOREL0IF  E           K        DISK                      A
      * UPD : DP Location               Update index
      *
      * Long constants
     E                    @CN#    1  02  6   @CN    25
     I@EOREIQ
      * Company Customer          Customer
      * Renamed input format fields
     I              EOAIC3                          WAAIC3
     I              EOBKC7                          WABKC7
     I              EOAQCD                          WAAQCD
     I              EOR4CD                          WAR4CD
     I              EOBYNA                          WABYNA
     I              EOB6NA                          WAB6NA
     I              EOBZNA                          WABZNA
     I              EOLLST                          WALLST
     I              EOPPST                          WAPPST
     I              EOR5NB                          WAR5NB
     I              EOR6NB                          WAR6NB
     I              EOQGST                          WAQGST
     I              EOBOCD                          WABOCD
     I              EOTBNB                          WATBNB
     I              EOMTCU                          WAMTCU
     I              EOW2NB                          WAW2NB
     I              EORPCD                          WARPCD
     I              EOAJCD                          WAAJCD
     I              EOX9ST                          WAX9ST
     I              EOT9CD                          WAT9CD
     I              EOUBCD                          WAUBCD
     I              EOISTX                          WAISTX
     I              EOLQCD                          WALQCD
     I              EONJNA                          WANJNA
     I              EOI0TX                          WAI0TX
     I              EONKNA                          WANKNA
     I              EOI1TX                          WAI1TX
     I              EOVLST                          WAVLST
     I              EORLST                          WARLST
     I              EOMMTX                          WAMMTX
     I              EOOHNA                          WAOHNA
     I              EOQ6ST                          WAQ6ST
     I              EOQ8ST                          WAQ8ST
     I              EORBST                          WARBST
     I              EOREST                          WAREST
     I              EOUVST                          WAUVST
     I              EOUWST                          WAUWST
     I              EOUXST                          WAUXST
     I              EOVSST                          WAVSST
     I              EOAATM                          WAAATM
     I              EOAYNA                          WAAYNA
     I              EOA0NA                          WAA0NA
     I              EOAXDT                          WAAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WBBCCD
     I              APALTX                          WBALTX
     I              APACNA                          WBACNA
     I              APADNA                          WBADNA
     I              APAENA                          WBAENA
     I              APAJNA                          WBAJNA
     I              APBGCD                          WBBGCD
     I              APBTTX                          WBBTTX
     I              APBVTX                          WBBVTX
     I              APBWTX                          WBBWTX
     I              APDZTX                          WBDZTX
     I              APD0TX                          WBD0TX
     I              APD1TX                          WBD1TX
     I              APLVCD                          WBLVCD
     I              APKZCD                          WBKZCD
     I              APAIC3                          WBAIC3
     I              APAVNB                          WBAVNB
     I              APDSCD                          WBDSCD
     I              APUVST                          WBUVST
     I              APUWST                          WBUWST
     I              APUXST                          WBUXST
     I              APVSST                          WBVSST
     I              APAATM                          WBAATM
     I              APAYNA                          WBAYNA
     I              APA0NA                          WBA0NA
     I              APAXDT                          WBAXDT
      *
     I@BPRES9
      * DP Product Location       Update index
      * Renamed input format fields
     I              BPTAAA                          WCTAAA
     I              BPTBAA                          WCTBAA
     I              BPFWC7                          WCFWC7
     I              BPTEAA                          WCTEAA
     I              BPCLU1                          WCCLU1
     I              BPCMU1                          WCCMU1
     I              BPZVNY                          WCZVNY
     I              BPZWNY                          WCZWNY
     I              BPZYNY                          WCZYNY
     I              BPZZNY                          WCZZNY
     I              BPZ1NY                          WCZ1NY
     I              BPZ2NY                          WCZ2NY
     I              BPZ3NY                          WCZ3NY
     I              BPTHAA                          WCTHAA
     I              BPZ4NY                          WCZ4NY
     I              BPZ5NY                          WCZ5NY
     I              BPZ6NY                          WCZ6NY
     I              BPTIAA                          WCTIAA
     I              BPCWU1                          WCCWU1
     I              BPS9AA                          WCS9AA
     I              BPANDX                          WCANDX
      *
     I@BORETN
      * DP Location               DP Location
      * Renamed input format fields
     I              BOTAAA                          WDTAAA
     I              BOTBAA                          WDTBAA
     I              BOTEAA                          WDTEAA
     I              BOCKU1                          WDCKU1
     I              BOATSC                          WDATSC
     I              BOS9AA                          WDS9AA
     I              BOANDX                          WDANDX
      *
     I@BBREE9
      * Customer                  Retrieval index       NV
      * Renamed input format fields
     I              BBBKC7                          WEBKC7
     I              BBAYTX                          WEAYTX
     I              BBACNA                          WEACNA
     I              BBADNA                          WEADNA
     I              BBAENA                          WEAENA
     I              BBAJNA                          WEAJNA
     I              BBBGCD                          WEBGCD
     I              BBG5CD                          WEG5CD
     I              BBBTTX                          WEBTTX
     I              BBBVTX                          WEBVTX
     I              BBBWTX                          WEBWTX
     I              BBABTX                          WEABTX
     I              BBA2NA                          WEA2NA
     I              BBCBST                          WECBST
     I              BBB0NA                          WEB0NA
     I              BBP3NB                          WEP3NB
     I              BBAXNA                          WEAXNA
     I              BBI6DT                          WEI6DT
     I              BBAYDT                          WEAYDT
     I              BBANC7                          WEANC7
     I              BBBTC7                          WEBTC7
     I              BBK6ST                          WEK6ST
     I              BBUZST                          WEUZST
     I              BBKXCD                          WEKXCD
     I              BBLTCD                          WELTCD
     I              BBQNST                          WEQNST
     I              BBS2NB                          WES2NB
     I              BBVHVA                          WEVHVA
     I              BBI7DT                          WEI7DT
     I              BBRJST                          WERJST
     I              BBRKST                          WERKST
     I              BBQWST                          WEQWST
     I              BBQXST                          WEQXST
     I              BBQYST                          WEQYST
     I              BBUNCS                          WEUNCS
     I              BBUVST                          WEUVST
     I              BBUWST                          WEUWST
     I              BBUXST                          WEUXST
     I              BBVSST                          WEVSST
     I              BBAATM                          WEAATM
     I              BBAYNA                          WEAYNA
     I              BBA0NA                          WEA0NA
     I              BBAXDT                          WEAXDT
      *
     I@NIRETO
      * Company Customer EXT      Customer/Company
      * Renamed input format fields
     I              NIAIC3                          WFAIC3
     I              NIBKC7                          WFBKC7
     I              NIUFTX                          WFUFTX
     I              NIUGTX                          WFUGTX
     I              NIPFNA                          WFPFNA
     I              NIJ5NX                          WFJ5NX
     I              NIU5TX                          WFU5TX
     I              NIU6TX                          WFU6TX
     I              NIW0TX                          WFW0TX
     I              NIKSNX                          WFKSNX
     I              NIPENX                          WFPENX
     I              NIHSSX                          WFHSSX
     I              NIHTSX                          WFHTSX
     I              NIHUSX                          WFHUSX
     I              NIHVSX                          WFHVSX
     I              NINCT1                          WFNCT1
     I              NIM9T1                          WFM9T1
     I              NINAT1                          WFNAT1
     I              NIL9AA                          WFL9AA
     I              NIWJT1                          WFWJT1
     I              NIHLST                          WFHLST
     I              NIHMST                          WFHMST
     I              NINBT1                          WFNBT1
     I              NIWKT1                          WFWKT1
     I              NIJ7NY                          WFJ7NY
     I              NIRJNY                          WFRJNY
     I              NIRKNY                          WFRKNY
     I              NIH9ST                          WFH9ST
     I              NIAATM                          WFAATM
     I              NIAYNA                          WFAYNA
     I              NIA0NA                          WFA0NA
     I              NIAXDT                          WFAXDT
      *
     I@BORES6
      * DP Location               Update index
      * Renamed input format fields
     I              BOTAAA                          WGTAAA
     I              BOTBAA                          WGTBAA
     I              BOTEAA                          WGTEAA
     I              BOCKU1                          WGCKU1
     I              BOATSC                          WGATSC
     I              BOS9AA                          WGS9AA
     I              BOANDX                          WGANDX
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPBBP1    E DSPBBPREL0
      * UPD : DP Product Location       Update index
      * Renamed input format fields
     I              BPTAAA                          WCTAAA
     I              BPTBAA                          WCTBAA
     I              BPFWC7                          WCFWC7
     I              BPTEAA                          WCTEAA
     I              BPCLU1                          WCCLU1
     I              BPCMU1                          WCCMU1
     I              BPZVNY                          WCZVNY
     I              BPZWNY                          WCZWNY
     I              BPZYNY                          WCZYNY
     I              BPZZNY                          WCZZNY
     I              BPZ1NY                          WCZ1NY
     I              BPZ2NY                          WCZ2NY
     I              BPZ3NY                          WCZ3NY
     I              BPTHAA                          WCTHAA
     I              BPZ4NY                          WCZ4NY
     I              BPZ5NY                          WCZ5NY
     I              BPZ6NY                          WCZ6NY
     I              BPTIAA                          WCTIAA
     I              BPCWU1                          WCCWU1
     I              BPS9AA                          WCS9AA
     I              BPANDX                          WCANDX
      *
     IQPBBO1    E DSPBBOREL0
      * UPD : DP Location               Update index
      * Renamed input format fields
     I              BOTAAA                          WGTAAA
     I              BOTBAA                          WGTBAA
     I              BOTEAA                          WGTEAA
     I              BOCKU1                          WGCKU1
     I              BOATSC                          WGATSC
     I              BOS9AA                          WGS9AA
     I              BOANDX                          WGANDX
      *
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: DP Product Location
      * I :  DP Product
     I                                    P   1   40P1FWC7
      * I :  DP Location
     I                                        5  24 P1TEAA
     IP2PARM      DS
      * I :  Parent Customer
     I                                    P   1   40P2BTC7
     IP3PARM      DS
      * I :  Text USR 6
     I                                        1   6 P3XLTX
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1FWC7    PARM           WP0001  70       DP Product
     C           P1TEAA    PARM           WP0002 20        DP Location
     C           P2BTC7    PARM           WP0003  70       Parent Customer
     C           P3XLTX    PARM           WP0004  6        Text USR 6
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Exc Crt from Actual   XF
      * CASE: PAR.Parent Customer is Parent C Class
     C           P2BTC7    IFEQ 99999                      *IF
     C                     Z-ADD1         ZQ      50
     C           @CN,001   CAT  P3XLTX:ZQ YL0001    P      DP Parent Custo
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Sales rte by Cust  RT - Company Customer  * 
     C                     EXSR SARVGN
      * RTV Salesperson NmeOnlyRT - Salesperson  * 
     C                     EXSR SBRVGN
     C                     END                             *FI
      * RTV Sys Dt yyyymmddtm UP - /UT User Programs  * 
     C                     CALL 'PBN2UPC'              90  RTV Sys Dt yyyy
     C           YL0004    PARM YL0004    WQ0001 140       DP Date Time St
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PBN2UPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * Create Product Location if new
      * Crt DP Prod Location  CR - DP Product Location  * 
     C                     EXSR SCCRRC
      * Create Location if it is new too
      * Rtv/Crt Location      RT - DP Location  * 
     C                     EXSR SDRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV Sales rte by Cust  RT - Company Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WABKC7    WQSA01           Ship To Custome
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           Ship To Custome
      * Setup key
     C                     Z-ADDP2BTC7    WQSA01           Ship To Custome
      * Establish starting position
     C           KRSSA     SETLL@EOREIQ                    *
     C           KRSSA     READE@EOREIQ                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0002           Sales Route Cod
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAR4CD    YL0002           Sales Route Cod
     C           KRSSA     READE@EOREIQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Salesperson NmeOnlyRT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0002    WBBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSB     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Salesperson Nam
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBALTX    YL0003           Salesperson Nam
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCRRC    BEGSR
      *================================================================
      * Crt DP Prod Location  CR - DP Product Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BPRES9
     C                     MOVEL@CN,002   WCTAAA           DP Profile
     C                     MOVE *BLANK    WCTBAA           DP Scenario
     C                     MOVEL'Base'    WCTBAA           DP Scenario
     C                     Z-ADDP1FWC7    WCFWC7           DP Product
     C                     MOVELP1TEAA    WCTEAA           DP Location
     C                     MOVEL*BLANK    WCCLU1           DP Local Code
     C                     MOVEL*BLANK    WCCMU1           DP Local Descri
     C                     Z-ADD1         WCZVNY           DP Sell Price
     C                     Z-ADD1         WCZWNY           DP Standard Cos
     C                     Z-ADD1         WCZYNY           DP Supply Lead
     C                     Z-ADD1         WCZZNY           DP Preferred Lo
     C                     Z-ADD1         WCZ1NY           DP Replenish Pe
     C                     Z-ADD1         WCZ2NY           DP Planning Fre
     C                     Z-ADD1         WCZ3NY           DP Replenish Le
     C                     MOVEL*BLANK    WCTHAA           DP Supplier Cod
     C                     Z-ADD1         WCZ4NY           DP Minimum Lot
     C                     Z-ADD1         WCZ5NY           DP Order Multip
     C                     Z-ADD1         WCZ6NY           DP Open Stock
     C                     MOVELYL0002    WCTIAA           DP Salesperson
     C                     MOVELYL0003    WCCWU1           DP Salesperson
     C                     MOVE *BLANK    WCS9AA           DP System of Re
     C                     MOVEL'AS400'   WCS9AA           DP System of Re
     C                     Z-ADDYL0004    WCANDX           DP Date Time St
      *
     C           KLCRSC    KLIST
     C                     KFLD           WCTAAA           DP Profile
     C                     KFLD           WCTBAA           DP Scenario
     C                     KFLD           WCFWC7           DP Product
     C                     KFLD           WCTEAA           DP Location
      * Check for duplicate primary key
     C           KLCRSC    SETLL@BPRES9                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4733' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C                     WRITE@BPRES9                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv/Crt Location      RT - DP Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDTEAA    WQSD01           DP Location
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           DP Location
      * Setup key
     C                     MOVELP1TEAA    WQSD01           DP Location
      * Establish starting position
     C           KRSSD     SETLL@BORETN                    *
     C           KRSSD     READE@BORETN                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR4730' W0RTN   7
      * USER: Processing if Data record not found
      * CASE: PAR.Parent Customer is Parent C Class
     C           P2BTC7    IFEQ 99999                      *IF
     C                     MOVELYL0001    YL0006           DP Parent Custo
     C                     MOVEL'C'       YL0007           DP Classificati
     C                     ELSE
      * CASE: *OTHERWISE
      * RTV Name Only          RT - Customer  * 
     C                     EXSR SERVGN
      * Rtv CCE Class ABC-DP  RT - Company Customer EXT  * 
     C                     EXSR SFRVGN
     C                     END                             *FI
      * Crt DP Location       CR - DP Location  * 
     C                     EXSR SGCRRC
     C                     GOTO SDEXIT
     C                     ENDIF
      *
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Name Only          RT - Customer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBKC7           Ship To Custome
      * Setup key
     C                     Z-ADDP2BTC7    WEBKC7           Ship To Custome
      * Establish starting position
     C           KRSSE     CHAIN@BBREE9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0170' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0006           Customer Name
     C                     GOTO SEEXIT                     *QUIT
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEAYTX    YL0006           Customer Name
     C                     GOTO SEEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv CCE Class ABC-DP  RT - Company Customer EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WFBKC7    WQSF01           Ship To Custome
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           Ship To Custome
      * Setup key
     C                     Z-ADDP2BTC7    WQSF01           Ship To Custome
      * Establish starting position
     C           KRSSF     SETLL@NIRETO                    *
     C           KRSSF     READE@NIRETO                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2904' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFH9ST    YL0007           CCE Classificat
     C           KRSSF     READE@NIRETO                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGCRRC    BEGSR
      *================================================================
      * Crt DP Location       CR - DP Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @BORES6
     C                     MOVE *BLANK    WGTAAA           DP Profile
     C                     MOVEL'Demand'  WGTAAA           DP Profile
     C                     MOVE *BLANK    WGTBAA           DP Scenario
     C                     MOVEL'Base'    WGTBAA           DP Scenario
     C                     MOVELP1TEAA    WGTEAA           DP Location
     C                     MOVELYL0006    WGCKU1           DP Parent Custo
     C                     MOVELYL0007    WGATSC           DP Classificati
     C                     MOVE *BLANK    WGS9AA           DP System of Re
     C                     MOVEL'AS400'   WGS9AA           DP System of Re
     C                     Z-ADDYL0004    WGANDX           DP Date Time St
      *
     C           KLCRSG    KLIST
     C                     KFLD           WGTAAA           DP Profile
     C                     KFLD           WGTBAA           DP Scenario
     C                     KFLD           WGTEAA           DP Location
      * Check for duplicate primary key
     C           KLCRSG    SETLL@BORES6                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'USR4731' W0RTN   7
      * USER: Processing if Data record already exists
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C                     WRITE@BORES6                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WABKC7           Ship To Custome
     C                     Z-ADD*ZERO     WAR5NB           Deliver after t
     C                     Z-ADD*ZERO     WAR6NB           Deliver before
     C                     Z-ADD*ZERO     WATBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WAMTCU           Mileage To Cust
     C                     Z-ADD*ZERO     WAW2NB           Co/Cust Overage
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCFWC7           DP Product
     C                     Z-ADD*ZERO     WCZVNY           DP Sell Price
     C                     Z-ADD*ZERO     WCZWNY           DP Standard Cos
     C                     Z-ADD*ZERO     WCZYNY           DP Supply Lead
     C                     Z-ADD*ZERO     WCZZNY           DP Preferred Lo
     C                     Z-ADD*ZERO     WCZ1NY           DP Replenish Pe
     C                     Z-ADD*ZERO     WCZ2NY           DP Planning Fre
     C                     Z-ADD*ZERO     WCZ3NY           DP Replenish Le
     C                     Z-ADD*ZERO     WCZ4NY           DP Minimum Lot
     C                     Z-ADD*ZERO     WCZ5NY           DP Order Multip
     C                     Z-ADD*ZERO     WCZ6NY           DP Open Stock
     C                     Z-ADD*ZERO     WCANDX           DP Date Time St
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDANDX           DP Date Time St
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WEP3NB           D & B Number
     C                     Z-ADD*ZERO     WEI6DT           Date of D & B R
     C                     Z-ADD*ZERO     WEAYDT           Credit Line Exp
     C                     Z-ADD*ZERO     WEANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WEBTC7           Parent Customer
     C                     Z-ADD*ZERO     WES2NB           Parent Credit L
     C                     Z-ADD*ZERO     WEVHVA           A/R Credit Limi
     C                     Z-ADD*ZERO     WEI7DT           Order Entry Hol
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFAIC3           Company Number
     C                     Z-ADD*ZERO     WFBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WFKSNX           Additional Rout
     C                     Z-ADD*ZERO     WFPENX           Cust Shipping T
     C                     Z-ADD*ZERO     WFJ7NY           CCE Last ABS Fr
     C                     Z-ADD*ZERO     WFRJNY           Item Age Days F
     C                     Z-ADD*ZERO     WFRKNY           Item Age Days F
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field DP Parent Customer Name
     C                     MOVEL*BLANK    YL0001 30
      * Define local work field DP Salesperson Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field DP Salesperson Name
     C                     MOVEL*BLANK    YL0003 30
      * Define local work field DP Date Time Stamp
     C                     Z-ADD*ZERO     YL0004 140
      * Define local work field DP Classification ABC
     C                     MOVEL*BLANK    YL0005  1
      * Define local work field DP Parent Customer Name
     C                     MOVEL*BLANK    YL0006 30
      * Define local work field DP Classification ABC
     C                     MOVEL*BLANK    YL0007  1
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 C CUSTOMER
00002 Demand
