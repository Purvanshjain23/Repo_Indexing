     H/TITLE Edt Buy Order Load    E1  Edit record(1 screen)
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H* - Maintain DBF file records, one at a time
     H* - Existing records may be updated or deleted
     H* - New records may be added
     H* - Key changes are not allowed
      *
     H* Generated by CA 2E release 8.7 (1632)
     H* Function type : Edit record(1 screen)
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISJBADE
     H* Date          : 03/23/21  Time  : 08:52:26
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKVLLSL0IF  E           K        DISK
      * Values list details file
      *
     FPKLZE1R#CF  E                    WORKSTN
     F                                              KINFDS INFDS#
      * DSP: Edt Buy Order Load    E1  Edit record(1 screen)
      *
     FPKAXCPL0IF  E           K        DISK
     F                                              KINFDS INFDS1
      * RTV : Buy Order Load            Retrieval index
      *
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBAREL0IF  E           K        DISK
      * RTV : Trucker                   Retrieval index
      *
     FPKACREL1IF  E           K        DISK
      * RTV : Producer                  Retrieval index
      *
     FPKAFREL0IF  E           K        DISK
      * RTV : Producer Location         Retrieval index
      *
     FPKEJCPL2IF  E           K        DISK
      * RSQ : Buy Order Load Weight     Co/BOL
      *
     FPWACCPL1IF  E           K        DISK
      * RTV : Buy Order Load Reference  Retrieval index
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKEJCPL1IF  E           K        DISK
      * RTV : Buy Order Load Weight     Retrieval index
      *
     FPLAFCPL2IF  E           K        DISK
      * RSQ : Delivery Tracking         BOH CO/BO/BOL/KillDt
      *
     FPLB4REL1IF  E           K        DISK
      * RTV : Producer EXT2             Retrieval index
      *
     FPKAAREL0IF  E           K        DISK
      * RTV : Source                    Retrieval index
      *
     FPKAXCPL1UF  E           K        DISK                      A
      * UPD : Buy Order Load            Update index
      *
     FPWACCPL0UF  E           K        DISK                      A
      * UPD : Buy Order Load Reference  Update index
      *
     FPKEJCPL0UF  E           K        DISK                      A
      * UPD : Buy Order Load Weight     Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@ACCPW8
      * Buy Order Load Reference  Retrieval index
      * Renamed input format fields
     I              ACHMNB                          WAHMNB
     I              ACBNNB                          WABNNB
     I              ACBONB                          WABONB
     I              ACDIT1                          WADIT1
     I              ACDJT1                          WADJT1
     I              ACIJSS                          WAIJSS
     I              ACAAVN                          WAAAVN
     I              ACAADT                          WAAADT
     I              ACAMTM                          WAAMTM
     I              ACAJST                          WAAJST
     I              ACAHVN                          WAAHVN
     I              ACAGVN                          WAAGVN
     I              ACABVN                          WAABVN
     I              ACABDT                          WAABDT
     I              ACABTM                          WAABTM
      *
     I@EJCPBI
      * Buy Order Load Weight     Retrieval index
      * Renamed input format fields
     I              EJHONB                          WBHONB
     I              EJABCD                          WBABCD
     I              EJAECD                          WBAECD
     I              EJBOMV                          WBBOMV
     I              EJSRST                          WBSRST
     I              EJBOSW                          WBBOSW
     I              EJDQDT                          WBDQDT
     I              EJA2TM                          WBA2TM
     I              EJSSST                          WBSSST
     I              EJSTST                          WBSTST
     I              EJSUST                          WBSUST
     I              EJHMNB                          WBHMNB
     I              EJBNNB                          WBBNNB
     I              EJBONB                          WBBONB
     I              EJAAVN                          WBAAVN
     I              EJAADT                          WBAADT
     I              EJAMTM                          WBAMTM
     I              EJAJST                          WBAJST
     I              EJAHVN                          WBAHVN
     I              EJAGVN                          WBAGVN
     I              EJABVN                          WBABVN
     I              EJABDT                          WBABDT
     I              EJABTM                          WBABTM
      *
     I@ACCPW7
      * Buy Order Load Reference  Update index
      * Renamed input format fields
     I              ACHMNB                          WCHMNB
     I              ACBNNB                          WCBNNB
     I              ACBONB                          WCBONB
     I              ACDIT1                          WCDIT1
     I              ACDJT1                          WCDJT1
     I              ACIJSS                          WCIJSS
     I              ACAAVN                          WCAAVN
     I              ACAADT                          WCAADT
     I              ACAMTM                          WCAMTM
     I              ACAJST                          WCAJST
     I              ACAHVN                          WCAHVN
     I              ACAGVN                          WCAGVN
     I              ACABVN                          WCABVN
     I              ACABDT                          WCABDT
     I              ACABTM                          WCABTM
      *
     I@AFCPI4
      * Delivery Tracking         BOH CO/BO/BOL/KillDt
      * Renamed input format fields
     I              AFHONB                          WDHONB
     I              AFE0DT                          WDE0DT
     I              AFE9DT                          WDE9DT
     I              AFAJTH                          WDAJTH
     I              AFH4A1                          WDH4A1
     I              AFFXDT                          WDFXDT
     I              AFJIA1                          WDJIA1
     I              AFIBA1                          WDIBA1
     I              AFW5ST                          WDW5ST
     I              AFICA1                          WDICA1
     I              AFK0CD                          WDK0CD
     I              AFK1CD                          WDK1CD
     I              AFLFCD                          WDLFCD
     I              AFLGCD                          WDLGCD
     I              AFIDA1                          WDIDA1
     I              AFIPA1                          WDIPA1
     I              AFLICD                          WDLICD
     I              AFJ8CD                          WDJ8CD
     I              AFJ9CD                          WDJ9CD
     I              AFMGCD                          WDMGCD
     I              AFXHST                          WDXHST
     I              AFXIST                          WDXIST
     I              AFIEA1                          WDIEA1
     I              AFKBCD                          WDKBCD
     I              AFKZCD                          WDKZCD
     I              AFLHCD                          WDLHCD
     I              AFFADT                          WDFADT
     I              AFAKTH                          WDAKTH
     I              AFBYTH                          WDBYTH
     I              AFW6ST                          WDW6ST
     I              AFXXST                          WDXXST
     I              AFFBDT                          WDFBDT
     I              AFALTH                          WDALTH
     I              AFBVTH                          WDBVTH
     I              AFAMTH                          WDAMTH
     I              AFFCDT                          WDFCDT
     I              AFANTH                          WDANTH
     I              AFBHTH                          WDBHTH
     I              AFFDDT                          WDFDDT
     I              AFAOTH                          WDAOTH
     I              AFBWTH                          WDBWTH
     I              AFAPTH                          WDAPTH
     I              AFFEDT                          WDFEDT
     I              AFAQTH                          WDAQTH
     I              AFARTH                          WDARTH
     I              AFFFDT                          WDFFDT
     I              AFASTH                          WDASTH
     I              AFATTH                          WDATTH
     I              AFFGDT                          WDFGDT
     I              AFAUTH                          WDAUTH
     I              AFFHDT                          WDFHDT
     I              AFAVTH                          WDAVTH
     I              AFAWTH                          WDAWTH
     I              AFBKTH                          WDBKTH
     I              AFBLTH                          WDBLTH
     I              AFXJST                          WDXJST
     I              AFK3CD                          WDK3CD
     I              AFFIDT                          WDFIDT
     I              AFAXTH                          WDAXTH
     I              AFAYTH                          WDAYTH
     I              AFFJDT                          WDFJDT
     I              AFAZTH                          WDAZTH
     I              AFA0TH                          WDA0TH
     I              AFFKDT                          WDFKDT
     I              AFA1TH                          WDA1TH
     I              AFA2TH                          WDA2TH
     I              AFFLDT                          WDFLDT
     I              AFA3TH                          WDA3TH
     I              AFA4TH                          WDA4TH
     I              AFBTTH                          WDBTTH
     I              AFFMDT                          WDFMDT
     I              AFA5TH                          WDA5TH
     I              AFA6TH                          WDA6TH
     I              AFBXTH                          WDBXTH
     I              AFXKST                          WDXKST
     I              AFYDST                          WDYDST
     I              AFFYDT                          WDFYDT
     I              AFB0TH                          WDB0TH
     I              AFBZTH                          WDBZTH
     I              AFH2A1                          WDH2A1
     I              AFJ2A1                          WDJ2A1
     I              AFJ3A1                          WDJ3A1
     I              AFKMA1                          WDKMA1
     I              AFJ4A1                          WDJ4A1
     I              AFJ5A1                          WDJ5A1
     I              AFJ6A1                          WDJ6A1
     I              AFJ7A1                          WDJ7A1
     I              AFJ8A1                          WDJ8A1
     I              AFJ9A1                          WDJ9A1
     I              AFKAA1                          WDKAA1
     I              AFKBA1                          WDKBA1
     I              AFKCA1                          WDKCA1
     I              AFKDA1                          WDKDA1
     I              AFKEA1                          WDKEA1
     I              AFKFA1                          WDKFA1
     I              AFKNA1                          WDKNA1
     I              AFKGA1                          WDKGA1
     I              AFKHA1                          WDKHA1
     I              AFKOA1                          WDKOA1
     I              AFKIA1                          WDKIA1
     I              AFKJA1                          WDKJA1
     I              AFKKA1                          WDKKA1
     I              AFKLA1                          WDKLA1
     I              AFYNST                          WDYNST
     I              AFYOST                          WDYOST
     I              AFABCD                          WDABCD
     I              AFAECD                          WDAECD
     I              AFAACD                          WDAACD
     I              AFHMNB                          WDHMNB
     I              AFBNNB                          WDBNNB
     I              AFBONB                          WDBONB
     I              AFAAVN                          WDAAVN
     I              AFAADT                          WDAADT
     I              AFAMTM                          WDAMTM
     I              AFAJST                          WDAJST
     I              AFAHVN                          WDAHVN
     I              AFAGVN                          WDAGVN
     I              AFABVN                          WDABVN
     I              AFABDT                          WDABDT
     I              AFABTM                          WDABTM
      *
     I@EJCPBH
      * Buy Order Load Weight     Update index
      * Renamed input format fields
     I              EJHONB                          WEHONB
     I              EJABCD                          WEABCD
     I              EJAECD                          WEAECD
     I              EJBOMV                          WEBOMV
     I              EJSRST                          WESRST
     I              EJBOSW                          WEBOSW
     I              EJDQDT                          WEDQDT
     I              EJA2TM                          WEA2TM
     I              EJSSST                          WESSST
     I              EJSTST                          WESTST
     I              EJSUST                          WESUST
     I              EJHMNB                          WEHMNB
     I              EJBNNB                          WEBNNB
     I              EJBONB                          WEBONB
     I              EJAAVN                          WEAAVN
     I              EJAADT                          WEAADT
     I              EJAMTM                          WEAMTM
     I              EJAJST                          WEAJST
     I              EJAHVN                          WEAHVN
     I              EJAGVN                          WEAGVN
     I              EJABVN                          WEABVN
     I              EJABDT                          WEABDT
     I              EJABTM                          WEABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
      * ABO DEFINE LARGE STRING FOR CL CMD
     IYARTCM      DS                            512
     I                                        1   1 DUMMY1
     IINFDS#    E DSY2I#DSP
      * Display file information data structure
      *
     IINFDS1    E DSY2I1DSP
      * File information data structure
      *
     I@1DBRC    E DSPKAXCPL1
      * UPD : Buy Order Load            Update index
      * Current/previous master file format fields for change control
      *
     I#1DBRC      DS                            237
      * Stored master file format fields
     I                                        1   1 #1DB1
      *
     IQPWAC1    E DSPWACCPL0
      * UPD : Buy Order Load Reference  Update index
      * Renamed input format fields
     I              ACHMNB                          WCHMNB
     I              ACBNNB                          WCBNNB
     I              ACBONB                          WCBONB
     I              ACDIT1                          WCDIT1
     I              ACDJT1                          WCDJT1
     I              ACIJSS                          WCIJSS
     I              ACAAVN                          WCAAVN
     I              ACAADT                          WCAADT
     I              ACAMTM                          WCAMTM
     I              ACAJST                          WCAJST
     I              ACAHVN                          WCAHVN
     I              ACAGVN                          WCAGVN
     I              ACABVN                          WCABVN
     I              ACABDT                          WCABDT
     I              ACABTM                          WCABTM
      *
     IYARDCS      DS                             88
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IYBRDCS      DS                            237
     IQPKEJ1    E DSPKEJCPL0
      * UPD : Buy Order Load Weight     Update index
      * Renamed input format fields
     I              EJHONB                          WEHONB
     I              EJABCD                          WEABCD
     I              EJAECD                          WEAECD
     I              EJBOMV                          WEBOMV
     I              EJSRST                          WESRST
     I              EJBOSW                          WEBOSW
     I              EJDQDT                          WEDQDT
     I              EJA2TM                          WEA2TM
     I              EJSSST                          WESSST
     I              EJSTST                          WESTST
     I              EJSUST                          WESUST
     I              EJHMNB                          WEHMNB
     I              EJBNNB                          WEBNNB
     I              EJBONB                          WEBONB
     I              EJAAVN                          WEAAVN
     I              EJAADT                          WEAADT
     I              EJAMTM                          WEAMTM
     I              EJAJST                          WEAJST
     I              EJAHVN                          WEAHVN
     I              EJAGVN                          WEAGVN
     I              EJABVN                          WEABVN
     I              EJABDT                          WEABDT
     I              EJABTM                          WEABTM
      *
     IYCRDCS      DS                             88
      /EJECT
      * Parameter declarations
     IP1PARM      DS                              9
      * KEY: Buy Order Load            Retrieval index
      * I : RST BOH Company Number
     I                                    P   1   20P1HMNB
      * I : RST BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I : RST BOL Load Number
     I                                    P   7   90P1BONB
     IP2PARM      DS
      * FLD: Buy Order Load
      * N :  PD Producer Code
     I                                        1   6 P2ABCD
     IP3PARM      DS
      * I :  Oms System Value Alpha
     I                                        1  40 P3EVTX
     IP4PARM      DS
      * I : MAP Name USR
     I                                        1  40 P4BSTX
     IP5PARM      DS
      * N :  SR Type
     I                                        1   1 P5IXST
     I            DS
     I                                        1 132 ZAMSDA
      * Message data for 'Trucker Is Required'
      * TRK Trucker Code
     I                                        1   3 ZA0001
      * Message data for 'Trucker Sts is Inactive'
      * TRK Trucker Code
     I                                        1   3 ZA0002
      * Message data for 'Trucker Is Required'
      * TRK Trucker Code
     I                                        1   3 ZA0003
      * Message data for 'Trucker Is Required'
      * TRK Trucker Code
     I                                        1   3 ZA0004
      * Message data for 'Movement # is not valid'
      * BOLW Movement Number
     I                                    P   1   50ZA0005
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C                     PARM           P1PARM           KEY: Buy Order
     C           P3EVTX    PARM           WP0001 40        Oms System Valu
     C           P4BSTX    PARM           WP0002 40        Name USR
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Check passed parameters
     C                     EXSR FACKPM
      * Perform once if all passed, else repeat
     C           W0RPT     DOUEQ'N'
      * Display and process key screen
     C                     EXSR BADSKY
     C                     END
      * Terminate program
     C                     EXSR ZXEXPG
      *****************************************************************
      /EJECT
     CSR         BADSKY    BEGSR
      *================================================================
      * Display and process key screen
      *================================================================
      * Bypass first display of key screen is possible
     C                     MOVEL'Y'       W0BYP   1
      * Initialize key screen
     C                     EXSR MDIZ#K
      * Signal start of transaction
     C                     MOVEL'Y'       W0TRN   1
     C           W0TRN     DOWEQ'Y'
     C           W0TRN     OREQ 'K'
      * Ensure transaction continues (if reset)
     C                     MOVEL'Y'       W0TRN   1
      * Conduct screen conversation
     C           W0TRN     DOWEQ'Y'
      * Is bypass key screen still viable?
     C           W0BYP     IFEQ 'Y'
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           #1BONB    OREQ *ZERO                      BOL Load Number
      * One or more key fields is blank
     C           *IN30     OREQ '1'
      * HOME: Reset screen fields
     C                     MOVEL'N'       W0BYP
     C                     END
     C                     END
      * Bypass key screen
     C           W0BYP     IFEQ 'N'
      * Display key screen
     C                     EXSR BBEXFM
     C                     END
      * Cancel key screen bypass
     C                     MOVEL'N'       W0BYP
      * Process response to key screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Switch between *ADD/*CHANGE modes
     C   09                CAS            BCCHMD
      * HOME: Reset screen fields
     C   30                CAS            BDHMKY
      * Process key screen input
     C                     CAS            BEPRKY
     C                     END
     C           W0TRN     DOWEQ'R'
     C                     MOVEL'Y'       W0TRN
     C                     EXSR BEPRKY
     C                     END
      *
     C                     END
     C                     END
      *================================================================
     CSR         BAEXIT    ENDSR
      /EJECT
     CSR         BBEXFM    BEGSR
      *================================================================
      * Display key screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GADSAK
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE BBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     BBIN89  1
     C                     MOVEL'K'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y0SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT1
     C                     EXFMT#RCDKEY
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         BBEXIT    ENDSR
      /EJECT
     CSR         BCCHMD    BEGSR
      *================================================================
      * Switch between *ADD/*CHANGE modes
      *================================================================
     C           W0PMD     IFEQ 'ADD'
     C                     MOVEL'CHG'     W0PMD   3
     C                     ELSE
     C                     MOVEL'ADD'     W0PMD
     C                     END
      *================================================================
     CSR         BCEXIT    ENDSR
      /EJECT
     CSR         BDHMKY    BEGSR
      *================================================================
      * Process HOME key
      *================================================================
     C                     MOVEL'N'       W0TRN
      *================================================================
     CSR         BDEXIT    ENDSR
      /EJECT
     CSR         BEPRKY    BEGSR
      *================================================================
      * Process key screen input
      *================================================================
      * Initialise detail screen
     C                     EXSR MAIZ#1
      * Validate key fields
     C                     EXSR BFVLKY
     C           *IN99     CABEQ'1'       BEEXIT
     C           YPMTFD    CABNE*BLANKS   BEEXIT
      * Check for existing record
     C           KRTV      KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    AXHMNB
     C                     Z-ADD#1BNNB    AXBNNB
     C                     Z-ADD#1BONB    AXBONB
     C           KRTV      CHAIN@AXCPBX              9091  *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     GOTO BEEXIT
     C                     END                             FI 91
      *
      * Verify record existence against program mode
     C           W0PMD     IFNE 'ADD'
      * If record does not exist, error
     C           *IN90     IFEQ '1'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Buy Order Load         NF'
     C                     MOVEL'PRK0051' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
     C                     EXSR MBFL#1
      * CALC: Detail screen function fields
      * DTL.BOL Freight UOM  Usr = Condition name of DTL.BOL Freight UOM
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CMST    W0INVL 25        BOL Freight UOM
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEOTX    PARM           W0CNNM 25        BOL Freight UOM
      *
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR SARVGN
      * CASE: DTL.BOL Trucker Payment Sts is Paid Trucker
     C           #1CNST    IFEQ 'PT'                       *IF
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1I1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc Freight Amt       XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ5XFR'              90  Clc Freight Amt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0001  30       BOH Company Num
     C                     PARM #1BNNB    WQ0002  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0003  50       BOL Load Number
     C                     PARM #1CMST    WQ0004  2        BOL Freight UOM
     C                     PARM #1AGPR    WQ0005  72       BOL Freight Uni
     C           #1ATVA    PARM #1ATVA    WQ0006  72       BOL Freight Amt
     C                     PARM #1I1ST    WQ0007  1        BOL Freight All
     C                     PARM #1DHNB    WQ0008  70       BOL Head Receiv
     C                     PARM #1DINB    WQ0009  71       BOL Live Wgt Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993433*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Freight Amt is Not Zeros
      *   |- c2    : DTL.BOL Trucker Payment Sts is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1ATVA    IFNE *ZERO                      *IF
     C           #1CNST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ST'      WUCNST           BOL Trucker Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1CNST    WUCNST           BOL Trucker Pay
      * Reset status to blanks if freight was zeroed out.
      * CASE: DTL.BOL Freight Amt is Zeros
     C           #1ATVA    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    WUCNST           BOL Trucker Pay
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Trucker Record    RT - Trucker  * 
     C                     EXSR SBRVGN
     C                     MOVEL*BLANK    #DA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SCRVGN
     C                     MOVEL*BLANK    #DA9TX           Pdctn Loc Name
      * Pdctn Loc Name DRV
      * Rtv Pdctn Loc Name    RT - Production Location  * 
     C                     EXSR SDRVGN
      * USER: Initialize detail screen (existing record)
      * DTL.Frt Exp Pay By Desc Usr = Condition name of DB1.BOL Freight E
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1191734   Y2LSNO  70       List number
     C                     PARM AXO8ST    W0INVL 25        BOL Freight Exp
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DLVTX    PARM           W0CNNM 25        Frt Exp Pay By
      *
      * DTL.BOL Freight UOM  Usr = Condition name of DB1.BOL Freight UOM
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM AXCMST    W0INVL 25        BOL Freight UOM
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEOTX    PARM           W0CNNM 25        BOL Freight UOM
      *
      * Rtv Trucker Name - Trucker  * 
     C                     EXSR SERVGN
     C                     MOVELP4BSTX    #PBSTX           Name USR
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR SFRVGN
      * No fields may be changed if frt has been allocated or paid.
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1I1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUI4ST           Payments Proces
     C                     ELSE
      * CASE: DTL.BOL Trucker Payment Sts is Paid Trucker
     C           #1CNST    IFEQ 'PT'                       *IF
     C                     MOVEL'Y'       WUI4ST           Payments Proces
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUI4ST           Payments Proces
     C                     END                             *FI
     C                     END                             *FI
      * E10812 - If No Gate, Get Movement Number from Buy Order Load
      * CASE: LCL.No Gate Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * Rtv BOL Movment NumberRT - Buy Order Load  * 
     C                     EXSR SGRVGN
      * CASE: WRK.Payments Processed  USR is Yes
     C           WUI4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUSYST           Protect Movemen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUSYST           Protect Movemen
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR SHRVGN
      * Protect Movement Number because of bolw sts
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.BOL Truck Scale Weigh Sts is In
      *   |- c2    : DB1.BOL Truck Scale Weigh Sts is Out
      *   |- c3    : DB1.BOL Truck Scale Weigh Sts is No Spread
      *   '-
     C           AXPAST    IFEQ 'I'                        *IF
     C           AXPAST    OREQ 'O'                        *OR
     C           AXPAST    OREQ 'N'                        *OR
     C                     MOVEL'N'       WUABST           @Status (Yes/No
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WUABST           @Status (Yes/No
     C                     END                             *FI
      * Protect Movement Number because of payment or bolw sts or it's 0
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : WRK.Payments Processed  USR is Yes
      *   |- c2    : WRK.@Status (Yes/No) is Yes
      *   |- c3    : DTL.BOLW Movement Number EQ WRK.Zero USR
      *   '-
     C           WUI4ST    IFEQ 'Y'                        *IF
     C           WUABST    OREQ 'Y'                        *OR
     C           #DBOMV    OREQ WUE9NB                     *OR
     C                     MOVEL'Y'       WUSYST           Protect Movemen
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUSYST           Protect Movemen
     C                     END                             *FI
     C                     END                             *FI
      * E10812 - Move Protected field Logic for Movement Number in Case
      *          Statement above.
      * see if this should be wrk.movement number old
     C                     Z-ADD#DBOMV    WUMVOL           Movement number
      * E10812 - Save intial values of Ref 1, Ref 2. Ref Status
     C                     MOVEL#DDIT1    YL0003           BOL Ref 1 Old
     C                     MOVEL#DDJT1    YL0004           BOL Ref 2 Old
     C                     MOVEL#DIJSS    YL0005           BOL Ref Status
      * E10812 - Retreive and display Ref1, Ref2, Ref Status from Buy Ord
      *          Load Reference
      * Rtv Buy Order Load Ref RT - Buy Order Load Reference  * 
     C                     EXSR SIRVGN
     C                     END
      *
     C                     ELSE
      * If record already exists, error
     C           *IN90     IFEQ '0'
     C                     SETON                     993132*
     C                     SETON                     33    *
      * Send message 'Buy Order Load         EX'
     C                     MOVEL'PRK0052' ZAMSID
     C                     EXSR ZASNMS
     C                     ELSE
      * USER: Initialize detail screen (new record)
     C                     MOVEL'N'       WUI4ST           Payments Proces
      * Rtv Producer TrkSz,Src RT - Producer  * 
     C                     EXSR SJRVGN
     C                     MOVEL'Y'       WUSYST           Protect Movemen
      * 04/13/17 JBB C9426 - Condition Ref fields input capable
     C                     MOVEL'N'       YL0006           Protect Ref fie
     C                     END
     C                     END
      *..................................................
     C   99                GOTO BEEXIT
      *
     C           YPMTFD    IFEQ *BLANK
      * No error: Display and process details
     C                     EXSR CADSDA
     C                     END
      *
      *================================================================
     CSR         BEEXIT    ENDSR
      /EJECT
     CSR         BFVLKY    BEGSR
      *================================================================
      * Validate key fields
      *================================================================
     C           W0PMD     IFNE 'ADD'
     C           YPMTFD    ORNE *BLANK
      * Select existing record
     C                     EXSR VACKRL
     C                     END
      * Check relations
      * Check reference to Buy Order Header
     C                     EXSR VBCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993132*
     C                     END
      * BOH Company Number required
     C           #1HMNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9931  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * BOH Buy Order Number required
     C           #1BNNB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9932  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      * BOL Load Number required
     C           #1BONB    IFEQ *ZERO                      IF
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9933  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         BFEXIT    ENDSR
      /EJECT
     CSR         CADSDA    BEGSR
      *================================================================
      * Display and process detail screen
      *================================================================
      * Conduct detail screen conversation
      * - repeat until screen control flag is reset:
     C           W0TRN     DOWEQ'Y'
      * Display detail screen
     C                     EXSR CBEXFM
      * Process response to detail screen
      * Cancel & exit program
     C   03                CAS            ZXEXPG
      * Redisplay previous screen
     C   12                CAS            CCDSPV
      * HOME: Reset screen fields
     C   30                CAS            CCDSPV
      * Process detail screen input
     C                     CAS            CFPRSC
     C                     END
     C           W0TRN     IFEQ 'R'
     C           W0PMD     IFEQ 'ADD'
     C                     EXSR MAIZ#1
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         CAEXIT    ENDSR
      /EJECT
     CSR         CBEXFM    BEGSR
      *================================================================
      * Display screen and process HELP requests
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Update screen time
     C                     TIME           ##TME
     C           W0HLP     DOUEQ'N'
     C                     MOVEL'N'       W0HLP   1
     C                     MOVE *IN04     YPMT04  1
     C                     MOVE *IN25     HELP25  1
     C                     MOVE *ALL'0'   ##OFF  30
     C                     MOVEA##OFF     *IN,1
     C                     MOVE YPMT04    *IN04
     C                     MOVE HELP25    *IN25
      * PUTOVR unless conditioned fields change
     C                     SETON                         86*
     C           *IN89     IFNE CBIN89
     C                     SETOF                         86*
     C                     END
     C                     MOVE *IN89     CBIN89  1
     C                     MOVEL'1'       W0GRP   1
      * Set cursor by *SET CURSOR data
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y1SET
     C                     END
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     EXFMT#RCDDTL1
      * Test cursor
     C                     EXSR Y8TST
      * Check if prompt requested
     C                     EXSR ZDVPMT
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
     C                     END
      * Update job time
     C                     TIME           ##JTM
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1
      * Reset global error indicator
     C                     SETOF                         99*
     C           YSETCS    IFEQ 'Y'
     C                     EXSR Y9CLR
     C                     END
      *================================================================
     CSR         CBEXIT    ENDSR
      /EJECT
     CSR         CCDSPV    BEGSR
      *================================================================
      * Redisplay previous screen
      *================================================================
     C   30                MOVEL'R'       W0TRN
     C   12                MOVEL'K'       W0TRN
      *================================================================
     CSR         CCEXIT    ENDSR
      /EJECT
     CSR         CFPRSC    BEGSR
      *================================================================
      * Validate record
      *================================================================
      * Confirm/update is not deferred
     C                     MOVEL'N'       W0DCF   1
      * Validate details
     C                     EXSR DCVLDL
      * QUIT if error:
     C   99                GOTO CFEXIT
      * Defer confirm/update requested
     C           W0DCF     CABEQ'Y'       CFEXIT
      * Prompt for confirmation
     C                     EXSR EAPMCF
      * Quit if not confirmed
     C           *IN99     IFEQ '1'
     C                     SETOF                     99
     C                     GOTO CFEXIT
     C                     END
      * No error: update record
     C                     EXSR EBPR##
      *================================================================
     CSR         CFEXIT    ENDSR
      /EJECT
     CSR         DCVLDL    BEGSR
      *================================================================
      * Validate details
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
     C           YPMTFD    IFEQ *BLANKS
      * Initialise derived fields
     C                     EXSR MFIZ#2
     C                     END
      * Validate BOL Freight UOM
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1CMST'  IFEQ YPMTFD
      * BOL Freight UOM
     C                     MOVEL#1CMST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHCMST
     C                     SELEC
     C           W0INVL    WHEQ 'FL'                       FL
     C                     Z-ADD1         ZHCMST
     C           W0INVL    WHEQ 'RH'                       RH
     C                     Z-ADD2         ZHCMST
     C           W0INVL    WHEQ 'LW'                       LW
     C                     Z-ADD3         ZHCMST
     C                     ENDSL
     C                     EXFMTZGCMST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHCMST    WHEQ 1
     C                     MOVEL'FL'      W0INVL           FL
     C           ZHCMST    WHEQ 2
     C                     MOVEL'RH'      W0INVL           RH
     C           ZHCMST    WHEQ 3
     C                     MOVEL'LW'      W0INVL           LW
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1CMST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
      * Validate BOL Freight Exp Paid By
     C                     MOVEL*BLANK    W0RTN
      * Name search required?
     C           '#1O8ST'  IFEQ YPMTFD
      * BOL Freight Exp Paid By
     C                     MOVEL#1O8ST    W0INVL 25
      * Set current value in drop down list.
     C                     MOVEL*ZEROS    ZHO8ST
     C                     SELEC
     C           W0INVL    WHEQ 'P'                        P
     C                     Z-ADD1         ZHO8ST
     C           W0INVL    WHEQ 'S'                        S
     C                     Z-ADD2         ZHO8ST
     C                     ENDSL
     C                     EXFMTZGO8ST
      * Set selected value from drop down list.
     C                     MOVEL*BLANKS   W0INVL
     C                     SELEC
     C           ZHO8ST    WHEQ 1
     C                     MOVEL'P'       W0INVL           P
     C           ZHO8ST    WHEQ 2
     C                     MOVEL'S'       W0INVL           S
     C                     ENDSL
     C                     SETOF                     90    *
     C                     MOVELW0INVL    #1O8ST
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           YPMTFD    IFEQ *BLANKS
      * USER: Validate detail screen fields
      * Validate truck in relationship to freight
      * CASE: DTL.TRK Trucker Code EQ WRK.Blank USR
     C           #1BNCD    IFEQ WUCRTX                     *IF
      * CASE: DTL.BOL Freight Unit Amt NE WRK.Zero USR
     C           #1AGPR    IFNE WUE9NB                     *IF
      * Setup message data for message
     C                     MOVEL#1BNCD    ZA0001           TRK Trucker Cod
      * Send message 'Trucker Is Required'
     C                     MOVEL'PRK0665' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Rtv Trucker Record    RT - Trucker  * 
     C                     EXSR SKRVGN
      * If Trucker status is not Active, send error message
      * CASE:
      *  - NOTc1
      *   |- c1    : LCL.RS Record Status is Active
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0001    IFEQ 'A'                        *IF
     C                     ELSE
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Setup message data for message
     C                     MOVEL#1BNCD    ZA0002           TRK Trucker Cod
      * Send message 'Trucker Sts is Inactive'
     C                     MOVEL'PRK1543' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Payments Processed  USR is Yes
     C           WUI4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       W0DCF            *Defer confirm
     C                     GOTO DCEXIT                     *QUIT
     C                     END                             *FI
      * Validate frt unit amt and freight uom
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DTL.BOL Freight UOM NE WRK.Blank USR
      *   |- c2    : DTL.BOL Freight Unit Amt NE WRK.Zero USR
      *   '-
     C           #1CMST    IFNE WUCRTX                     *IF
     C           #1AGPR    ORNE WUE9NB                     *OR
      * CASE: DTL.BOL Freight Unit Amt EQ WRK.Zero USR
     C           #1AGPR    IFEQ WUE9NB                     *IF
      * Send message 'Freight amt req if UOM'
     C                     MOVEL'PRK0500' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Trucker
      * CASE: DTL.TRK Trucker Code EQ WRK.Blank USR
     C           #1BNCD    IFEQ WUCRTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BNCD    ZA0003           TRK Trucker Cod
      * Send message 'Trucker Is Required'
     C                     MOVEL'PRK0665' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DTL.BOL Freight UOM EQ WRK.Blank USR
     C           #1CMST    IFEQ WUCRTX                     *IF
      * Send message 'Freight UOM req if amt'
     C                     MOVEL'PRK0501' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     ELSE
      * CASE: *OTHERWISE
      * Validate Trucker
      * CASE: DTL.TRK Trucker Code EQ WRK.Blank USR
     C           #1BNCD    IFEQ WUCRTX                     *IF
      * Setup message data for message
     C                     MOVEL#1BNCD    ZA0004           TRK Trucker Cod
      * Send message 'Trucker Is Required'
     C                     MOVEL'PRK0665' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9931  *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * E10812 - Validation of Movment Number with NOGATE logic
      * CASE: LCL.No Gate Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
      * No validation is required, because validation will be performed
      * on the Work With Delivery Receiving
     C                     ELSE
      * CASE: *OTHERWISE
      * VAL - MOVEMENT - MTECH not live with HPS and Live witho HPS
      * CASE: DTL.BOLW Movement Number NE WRK.Zero USR
     C           #DBOMV    IFNE WUE9NB                     *IF
      * CASE: DTL.BOLW Movement Number NE WRK.Movement number old  USR
     C           #DBOMV    IFNE WUMVOL                     *IF
      * Not Live with Mtech Validate, and Live Nothing
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is No MTech not Live
      *   |- c2    : WRK.SR Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'N'                        *IF
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Z1l HPS Movement Rfrn UP - STR HPS Interface  * 
     C                     CALL 'HP251'                90  Z1l HPS Movemen
     C           WULMST    PARM WULMST    WQ0017  7        Return Code USR
     C                     PARM #DBOMV    WQ0018  70       TH HPS Movement
     C           WUSHDT    PARM *ZERO     WQ0019  80       Scheduled Kill
     C           YL0008    PARM *ZERO     WQ0020  50       Scheduled Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP251'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
     C                     END
      * Movement not found in the HPS System.
      * CASE: WRK.Return Code USR is HPS Movement Rfrnc Err 1
     C           WULMST    IFEQ 'HPSM1'                    *IF
      * Setup message data for message
     C                     Z-ADD#DBOMV    ZA0005           BOLW Movement N
      * Send message 'Movement # is not valid'
     C                     MOVEL'PRK0868' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
      *
     C                     END                             *FI
      * Val Movement Number   RT - Buy Order Load Weight  * 
     C                     EXSR SLRVGN
      * CASE: WRK.Record Found USR is Record Found
     C           WUH7ST    IFEQ 'Y'                        *IF
      * Send message 'Buy Order Load Weight  EX'
     C                     MOVEL'PRK0842' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.MTech Live Yes or No is Yes MTech is Live
      *   |- c2    : WRK.SR Type is Internal
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0007    IFEQ 'Y'                        *IF
     C           WUIXST    IFEQ 'I'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * E2423 Mtech Live will not use this HPS program
      * There will be no validation on movement due to the movement
      * is in the MTech application
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Movement number old  USR NE WRK.Zero USR
     C           WUMVOL    IFNE WUE9NB                     *IF
     C                     Z-ADDWUMVOL    #DBOMV           BOLW Movement N
      * Send message 'Cannot remove movement #'
     C                     MOVEL'PRK0869' ZAMSID
     C                     EXSR ZASNMS
     C                     SETON                     99    *
      *
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * e2423 Movement Number is now on the Buy Order Load.
     C                     Z-ADD#DBOMV    #1JKRU           BOL HPS Movemen
     C                     END
      * Check relations
      * Check reference to Trucker
     C                     EXSR VCCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     9931  *
     C                     END
      * Check reference to Producer Location
     C                     EXSR VDCKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     99    *
     C                     END
     C           YPMTFD    IFEQ *BLANKS
      * CALC: Detail screen function fields
      * DTL.BOL Freight UOM  Usr = Condition name of DTL.BOL Freight UOM
     C                     CALL 'PKRVC2R'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1100063   Y2LSNO  70       List number
     C                     PARM #1CMST    W0INVL 25        BOL Freight UOM
     C                     PARM ' '       W0VLMP  1        Value mapped
     C           #DEOTX    PARM           W0CNNM 25        BOL Freight UOM
      *
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
     C                     EXSR SMRVGN
      * CASE: DTL.BOL Trucker Payment Sts is Paid Trucker
     C           #1CNST    IFEQ 'PT'                       *IF
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Freight Allocation is Freight is Allocated
      *   |- c2    : WRK.Tattoo is paid Usr is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1I1ST    IFEQ 'Y'                        *IF
     C           WUNPST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * Clc Freight Amt       XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKQ5XFR'              90  Clc Freight Amt
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0024  30       BOH Company Num
     C                     PARM #1BNNB    WQ0025  70       BOH Buy Order N
     C                     PARM #1BONB    WQ0026  50       BOL Load Number
     C                     PARM #1CMST    WQ0027  2        BOL Freight UOM
     C                     PARM #1AGPR    WQ0028  72       BOL Freight Uni
     C           #1ATVA    PARM #1ATVA    WQ0029  72       BOL Freight Amt
     C                     PARM #1I1ST    WQ0030  1        BOL Freight All
     C                     PARM #1DHNB    WQ0031  70       BOL Head Receiv
     C                     PARM #1DINB    WQ0032  71       BOL Live Wgt Re
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQ5XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     993433*
     C                     END
     C                     END                             *FI
     C                     END                             *FI
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DTL.BOL Freight Amt is Not Zeros
      *   |- c2    : DTL.BOL Trucker Payment Sts is Blank
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           #1ATVA    IFNE *ZERO                      *IF
     C           #1CNST    IFEQ *BLANK                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'ST'      WUCNST           BOL Trucker Pay
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL#1CNST    WUCNST           BOL Trucker Pay
      * Reset status to blanks if freight was zeroed out.
      * CASE: DTL.BOL Freight Amt is Zeros
     C           #1ATVA    IFEQ *ZERO                      *IF
     C                     MOVEL*BLANK    WUCNST           BOL Trucker Pay
     C                     END                             *FI
     C                     END                             *FI
      * Rtv Trucker Record    RT - Trucker  * 
     C                     EXSR SNRVGN
     C                     MOVEL*BLANK    #DA4TX           Producer Name
      * Producer Name         DRV
      * Rtv Producer Name     RT - Producer  * 
     C                     EXSR SORVGN
     C                     MOVEL*BLANK    #DA9TX           Pdctn Loc Name
      * Pdctn Loc Name DRV
      * Rtv Pdctn Loc Name    RT - Production Location  * 
     C                     EXSR SPRVGN
     C                     END
      * BOL Freight Exp Paid By required
     C           #1O8ST    IFEQ *BLANK                     IF
     C           *IN79     ANDEQ'0'
     C           YPMTFD    ANDEQ*BLANKS
     C                     SETON                     9935  *
      * Send message '*Value required'
     C                     MOVEL'Y2U0001' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END                             FI
      *================================================================
     CSR         DCEXIT    ENDSR
      /EJECT
     CSR         EAPMCF    BEGSR
      *================================================================
      * Prompt for confirmation
      *================================================================
      * Set screen conditioning indicators
     C                     EXSR GBDSAD
      * Force PUTOVR
     C                     SETON                         86*
      * Update screen time
     C                     TIME           ##TME
      * Refresh screen
     C                     MOVEL*BLANK    ##CFCD
     C                     MOVEL'N'       ##CFCD
      * Save CMD keys
     C                     MOVEA*IN       WN30   30
     C                     SETOF                     29    *
      * Generate internal/external key list
     C           KINEX     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2INVL
      * Convert *CONFIRM to external value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2INVL
     C                     MOVEL##CFCD    Y2INVL           *CONFIRM
     C           KINEX     CHAIN@Y2INEX              90    *
     C  N90                MOVELY2EXVL    V#CFCD           *CONFIRM
      *
     C           W0HLP     DOUEQ'N'
     C           *IN29     ANDEQ'0'
     C                     WRITE#MSGCTL
     C                     WRITE#CMDTXT2
     C                     WRITE#RCDDTL1
     C                     EXFMT#CONFIRM
     C           *IN29     IFEQ '1'
     C                     SETON                     99
     C                     GOTO EAEXIT
     C                     END
      * Clear set cursor DDS indicator
     C           WCSRLC    IFEQ 'OFF'
     C                     SETOF                     94    *
     C                     END
     C                     MOVE *BLANK    WCSRLC
      * If help requested, display help text
     C   25                EXSR ZHHPKY
      * Validate *CONFIRM
     C                     MOVEL*BLANK    W0RTN
     C                     MOVELV#CFCD    W0NSRQ  1        *CONFIRM
      * Name search required?
     C           W0NSRQ    IFEQ '?'
     C           'V#CFCD'  OREQ YPMTFD
     C                     CALL 'PKVLLSR'              90  *
     C                     PARM           W0RTN   7
     C                     PARM 1001713   Y2LSNO  70
     C           V#CFCD    PARM V#CFCD    W0EXVL 25        *CONFIRM
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C           W0NSRQ    IFNE '?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
     C                     END
      * Check external value of *CONFIRM
      * Generate internal/external key list
     C           KEXIN     KLIST
     C                     KFLD           Y2LSNO
     C                     KFLD           Y2EXVL
      * Convert *CONFIRM to internal value
     C                     Z-ADD1001713   Y2LSNO
     C                     MOVEL*BLANK    Y2EXVL
     C                     MOVELV#CFCD    Y2EXVL           *CONFIRM
     C           KEXIN     CHAIN@Y2EXIN              90    *
     C           *IN90     IFEQ '1'
     C                     MOVEL*BLANK    ##CFCD
     C           YPMTFD    IFEQ *BLANK
     C                     SETON                     96    *
     C                     WRITE#CONFIRM
     C                     SETOF                     96    *
     C                     END
     C                     ELSE
     C                     MOVELY2INVL    ##CFCD           *CONFIRM
     C                     END
      *
     C   90                SETON                     29    *
     C  N90                SETOF                     29    *
     C                     END
      * Restore CMD keys
     C                     MOVEAWN30      *IN
      * Update job time
     C                     TIME           ##JTM
     C           ##CFCD    IFEQ 'Y'
      * Clear messages from program message queue
     C                     CALL 'Y2CLMSC'
     C                     PARM ##PGM     ZAPGMQ 10
     C                     PARM '*SAME'   ZAPGRL  5
      * Reset first message only flag
     C                     MOVEL'Y'       ZAFSMS  1      99*
     C                     END
     C           ##CFCD    COMP 'Y'                  9999  *
      * Not confirmed
      *================================================================
     CSR         EAEXIT    ENDSR
      /EJECT
     CSR         EBPR##    BEGSR
      *================================================================
      * Process record:
      *================================================================
      * Process add request
     C           W0PMD     CASEQ'ADD'     ECADRQ
      * Process update request
     C           W0PMD     CASNE'ADD'     EECHRQ
     C                     END
     C           W0RTN     IFEQ *BLANK
      * USER: Process command keys
      * CASE: PGM.*Program mode is *CHANGE
     C           W0PMD     IFEQ 'CHG'                      *IF
     C                     MOVELW0RTN     P0RTN            *Return code
     C                     EXSR ZYEXPG
     C                     END                             *FI
     C           W0PMD     IFEQ 'ADD'
      * Exit after successful add
     C                     MOVEL'N'       W0RPT
     C                     END
      * Restart program for next record
     C                     MOVEL'N'       W0TRN
     C                     END
      *================================================================
     CSR         EBEXIT    ENDSR
      /EJECT
     CSR         ECADRQ    BEGSR
      *================================================================
      * Process add request
      *================================================================
      * USER: Create DBF record
      * Crt Buy Order/BOL Ref IF
      * Crt Buy Order Detail  CR - Buy Order Load  * 
     C                     EXSR SQCRRC
      *
     C                     MOVEL*BLANK    WN0001 10        RS User Changed
     C                     Z-ADD*ZERO     WN0002  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0003  60       RS Time Changed
     C                     MOVEL*BLANK    WN0004  1        RS Record Statu
     C                     MOVEL*BLANK    WN0005 10        RS Job
     C                     MOVEL*BLANK    WN0006 10        RS Program
     C                     MOVEL*BLANK    WN0007 10        RS User Added
     C                     Z-ADD*ZERO     WN0008  70       RS Date Added
     C                     Z-ADD*ZERO     WN0009  60       RS Time Added
      *
      * Crt/Upd BO Load Ref   IF
      * C9426 032217 slm
      * C9426 use the BOL Referene to store the Ref1,Ref2 and Ref Status
      * Crt/Chg BO Load Ref   RT - Buy Order Load Reference  * 
     C                     EXSR SRRVGN
     C           W0RTN     IFEQ *BLANK
      * Send message '*Record added'
     C                     MOVEL'Y2U0011' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
      *================================================================
     CSR         ECEXIT    ENDSR
      /EJECT
     CSR         EECHRQ    BEGSR
      *================================================================
      * Process update request
      *================================================================
      * USER: Change DBF record
      * Chg Buy Ord Dtl/WFrt  CH - Buy Order Load  * 
     C                     EXSR SUCHRC
     C           W0RTN     IFNE *BLANK
      * Data update error
      * Reset screen fields if changed record
     C           W0RTN     CASEQ'Y2U0007' MBFL#1
     C                     END
     C                     ELSE
     C           YBRDC     IFEQ 'Y'
      * Send message '*Record changed'
     C                     MOVEL'Y2U0012' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *================================================================
     CSR         EEEXIT    ENDSR
      /EJECT
     CSR         FACKPM    BEGSR
      *================================================================
      * Check passed parameters
      *================================================================
      * Is full key present?
     C           P1HMNB    IFEQ *ZERO                      BOH Company Num
     C           P1BNNB    OREQ *ZERO                      BOH Buy Order N
     C           P1BONB    OREQ *ZERO                      BOL Load Number
      * Not every key field passed - loop program
     C                     MOVEL'Y'       W0RPT   1
     C                     ELSE
      * Full key passed, so single shot program
     C                     MOVEL'N'       W0RPT
     C                     END
      *================================================================
     CSR         FAEXIT    ENDSR
      /EJECT
     CSR         GADSAK    BEGSR
      *================================================================
      * Set key screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      *================================================================
     CSR         GAEXIT    ENDSR
      /EJECT
     CSR         GBDSAD    BEGSR
      *================================================================
      * Set detail screen conditioning indicators
      *================================================================
     C           W0PMD     COMP 'ADD'                    89*
      * Protect key fields on detail screen
     C                     SETON                     88    *
     C                     MOVEL'0'       *IN79
     C           WUI4ST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN79
     C                     END                             *FI
     C                     MOVEL'0'       *IN78
     C           WUSYST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       *IN78
     C                     END                             *FI
     C                     MOVEL'0'       *IN77
     C           WUI4ST    IFEQ 'N'                        *IF
     C                     MOVEL'1'       *IN77
     C                     END                             *FI
     C           W0RPT     IFEQ 'N'
      * Disable key screen - not applicable
     C                     SETOF                     87    *
     C                     ELSE
      * Enable key screen
     C                     SETON                     87    *
     C                     END
      *================================================================
     CSR         GBEXIT    ENDSR
      /EJECT
     CSR         MAIZ#1    BEGSR
      *================================================================
      * Initialise record - except for key fields and "neither" paramete
      *================================================================
     C                     MOVEL*BLANK    #1PDST           BOL Violated Au
     C                     MOVEL*BLANK    #1O9ST           BOL Scheduled K
     C                     MOVEL*BLANK    #1PAST           BOL Truck Scale
     C                     Z-ADD*ZERO     #1LDSH           BOL Shipped Hea
     C                     MOVEL*BLANK    #1PBST           Reported to USD
     C                     MOVEL*BLANK    #1PCST           BOL MPR Prior D
     C                     MOVEL*BLANK    #1UWST           BOL Status 5
     C                     MOVEL*BLANK    #1UXST           BOL Status 6
     C                     MOVEL*BLANK    #1UYST           BOL Status 7
     C                     Z-ADD*ZERO     #1JKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     #1KEOR           BOL Head LFT
     C                     Z-ADD*ZERO     #1IOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     #1KJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     #1IOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     #1EIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     #1ITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     #1ODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     #1RJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     #1OEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     #1D0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     #1D1DT           BOL Unused Date
     C                     Z-ADD*ZERO     #1D2DT           BOL Unused Date
     C                     Z-ADD*ZERO     #1D3DT           BOL Unused Date
     C                     Z-ADD*ZERO     #1D4DT           BOL Unused Date
     C                     Z-ADD*ZERO     #1CQDT           BOL Kill Date
     C                     Z-ADD*ZERO     #1ABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     #1ACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     #1BPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     #1AUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     #1ATVA           BOL Freight Amt
     C                     MOVEL*BLANK    #1I1ST           BOL Freight All
     C                     Z-ADD*ZERO     #1DHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     #1DINB           BOL Live Wgt Re
     C                     MOVEL*BLANK    #1CNST           BOL Trucker Pay
     C                     Z-ADD*ZERO     #1GINB           BOL Trucker Che
     C                     Z-ADD*ZERO     #1BZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     #1LSNB           BOL AP Voucher
     C                     MOVEL*BLANK    #1AAVN           RS User Changed
     C                     Z-ADD*ZERO     #1AADT           RS Date Changed
     C                     Z-ADD*ZERO     #1AMTM           RS Time Changed
     C                     MOVEL*BLANK    #1AJST           RS Record Statu
     C                     MOVEL*BLANK    #1AHVN           RS Job
     C                     MOVEL*BLANK    #1AGVN           RS Program
     C                     MOVEL*BLANK    #1ABVN           RS User Added
     C                     Z-ADD*ZERO     #1ABDT           RS Date Added
     C                     Z-ADD*ZERO     #1ABTM           RS Time Added
     C                     MOVELP4BSTX    #PBSTX           Name USR
     C                     MOVEL*BLANK    #1ABCD           PD Producer Cod
     C                     MOVEL*BLANK    #DA4TX           Producer Name
     C                     MOVEL*BLANK    #1AECD           PL Location Cod
     C                     MOVEL*BLANK    #DA9TX           Pdctn Loc Name
     C                     MOVEL*BLANK    #1BNCD           TRK Trucker Cod
     C                     MOVEL*BLANK    #DBJTX           TRK Name
     C                     MOVEL*BLANK    #1F3TX           BOL Trailer
     C                     Z-ADD*ZERO     #1AGPR           BOL Freight Uni
     C                     MOVEL*BLANK    #1CMST           BOL Freight UOM
     C                     MOVEL*BLANK    #DEOTX           BOL Freight UOM
     C                     MOVEL*BLANK    #1O8ST           BOL Freight Exp
     C                     MOVEL*BLANK    #DLVTX           Frt Exp Pay By
     C                     Z-ADD*ZERO     #1CSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     #DBOMV           BOLW Movement N
     C                     MOVEL*BLANK    #DDIT1           BOL Ref 1
     C                     MOVEL*BLANK    #DDJT1           BOL Ref 2
     C                     MOVEL*BLANK    #DIJSS           BOL Ref Status
      *================================================================
     CSR         MAEXIT    ENDSR
      /EJECT
     CSR         MBFL#1    BEGSR
      *================================================================
      * Move @AXCPBX fields to screen
      *================================================================
     C                     MOVELAXPDST    #1PDST           BOL Violated Au
     C                     MOVELAXO9ST    #1O9ST           BOL Scheduled K
     C                     MOVELAXPAST    #1PAST           BOL Truck Scale
     C                     Z-ADDAXLDSH    #1LDSH           BOL Shipped Hea
     C                     MOVELAXPBST    #1PBST           Reported to USD
     C                     MOVELAXPCST    #1PCST           BOL MPR Prior D
     C                     MOVELAXUWST    #1UWST           BOL Status 5
     C                     MOVELAXUXST    #1UXST           BOL Status 6
     C                     MOVELAXUYST    #1UYST           BOL Status 7
     C                     Z-ADDAXJKRU    #1JKRU           BOL HPS Movemen
     C                     Z-ADDAXKEOR    #1KEOR           BOL Head LFT
     C                     Z-ADDAXIOEW    #1IOEW           BOL Head EUT/KO
     C                     Z-ADDAXKJIO    #1KJIO           BOL Auth Gate E
     C                     Z-ADDAXIOJR    #1IOJR           BOL Head Receiv
     C                     Z-ADDAXEIRR    #1EIRR           BOL Unused Wgt
     C                     Z-ADDAXITMF    #1ITMF           BOL Unused Wgt
     C                     Z-ADDAXODJE    #1ODJE           BOL Unused Wgt
     C                     Z-ADDAXRJIF    #1RJIF           BOL Unused Wgt
     C                     Z-ADDAXOEJF    #1OEJF           BOL Unused Wgt
     C                     Z-ADDAXD0DT    #1D0DT           BOL Auth Gate E
     C                     Z-ADDAXD1DT    #1D1DT           BOL Unused Date
     C                     Z-ADDAXD2DT    #1D2DT           BOL Unused Date
     C                     Z-ADDAXD3DT    #1D3DT           BOL Unused Date
     C                     Z-ADDAXD4DT    #1D4DT           BOL Unused Date
     C                     Z-ADDAXCQDT    #1CQDT           BOL Kill Date
     C                     Z-ADDAXABTH    #1ABTH           BOL Pln Delv St
     C                     Z-ADDAXACTH    #1ACTH           BOL Pln Delv En
     C                     Z-ADDAXBPNB    #1BPNB           BOL Pln Head De
     C                     Z-ADDAXAUDT    #1AUDT           BOL Pln Delv Da
     C                     Z-ADDAXATVA    #1ATVA           BOL Freight Amt
     C                     MOVELAXI1ST    #1I1ST           BOL Freight All
     C                     Z-ADDAXDHNB    #1DHNB           BOL Head Receiv
     C                     Z-ADDAXDINB    #1DINB           BOL Live Wgt Re
     C                     MOVELAXCNST    #1CNST           BOL Trucker Pay
     C                     Z-ADDAXGINB    #1GINB           BOL Trucker Che
     C                     Z-ADDAXBZDT    #1BZDT           BOL Trucker Che
     C                     Z-ADDAXLSNB    #1LSNB           BOL AP Voucher
     C                     MOVELAXAAVN    #1AAVN           RS User Changed
     C                     Z-ADDAXAADT    #1AADT           RS Date Changed
     C                     Z-ADDAXAMTM    #1AMTM           RS Time Changed
     C                     MOVELAXAJST    #1AJST           RS Record Statu
     C                     MOVELAXAHVN    #1AHVN           RS Job
     C                     MOVELAXAGVN    #1AGVN           RS Program
     C                     MOVELAXABVN    #1ABVN           RS User Added
     C                     Z-ADDAXABDT    #1ABDT           RS Date Added
     C                     Z-ADDAXABTM    #1ABTM           RS Time Added
     C                     Z-ADDAXHMNB    #1HMNB           BOH Company Num
     C                     MOVELAXABCD    #1ABCD           PD Producer Cod
     C                     MOVELAXAECD    #1AECD           PL Location Cod
     C                     Z-ADDAXBNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    #1BONB           BOL Load Number
     C                     MOVELAXBNCD    #1BNCD           TRK Trucker Cod
     C                     MOVELAXF3TX    #1F3TX           BOL Trailer
     C                     Z-ADDAXAGPR    #1AGPR           BOL Freight Uni
     C                     MOVELAXCMST    #1CMST           BOL Freight UOM
     C                     MOVELAXO8ST    #1O8ST           BOL Freight Exp
     C                     Z-ADDAXCSNB    #1CSNB           BOL Shipped Wgt
      * Hold existing record image
     C                     MOVEL@1DBRC    #1DBRC
      *================================================================
     CSR         MBEXIT    ENDSR
      /EJECT
     CSR         MDIZ#K    BEGSR
      *================================================================
      * Initialize key screen
      *================================================================
     C                     MOVELP4BSTX    #PBSTX           Name USR
     C                     Z-ADDP1HMNB    #1HMNB           BOH Company Num
     C                     Z-ADDP1BNNB    #1BNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    #1BONB           BOL Load Number
      * Check reference to Buy Order Header
     C                     EXSR VECKRL
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     SETON                     993132*
     C                     END
      *================================================================
     CSR         MDEXIT    ENDSR
      /EJECT
     CSR         MFIZ#2    BEGSR
      *================================================================
      * Initialise derived fields
      *================================================================
     C                     MOVEL*BLANK    #DA4TX           Producer Name
     C                     MOVEL*BLANK    #DA9TX           Pdctn Loc Name
      *================================================================
     CSR         MFEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSA01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSA02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSA03           BOL Load Number
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WQSA01           BOH Company Num
     C                     KFLD           WQSA02           BOH Buy Order N
     C                     KFLD           WQSA03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSA01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSA02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSA03           BOL Load Number
      * Establish starting position
     C           KRSSA     SETLL@A1CPC4                    *
     C           KRSSA     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT 0                          *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSA     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Trucker Record    RT - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVEL#1BNCD    BABNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSB     CHAIN@BAREDS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBJTX           TRK Name
     C                     MOVEL*BLANK    YL0001           RS Record Statu
     C                     GOTO SBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBABJTX    #DBJTX           TRK Name
     C                     MOVELBAAJST    YL0001           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSC     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    #DA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Name    RT - Production Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    AFABCD           PD Producer Cod
     C                     MOVEL#1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSD     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    #DA9TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Trucker Name - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVELAXBNCD    BABNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSE     CHAIN@BAREDS              90    *
      * Data record not found
     C   90                MOVEL'PRK0079' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBABJTX    #DBJTX           TRK Name
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSF01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSF02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSF03           BOL Load Number
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WQSF01           BOH Company Num
     C                     KFLD           WQSF02           BOH Buy Order N
     C                     KFLD           WQSF03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQSF01           BOH Company Num
     C                     Z-ADDAXBNNB    WQSF02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQSF03           BOL Load Number
      * Establish starting position
     C           KRSSF     SETLL@A1CPC4                    *
     C           KRSSF     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT 0                          *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSF     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv BOL Movment NumberRT - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    AXHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    AXBONB           BOL Load Number
      * Establish starting position
     C           KRSSG     CHAIN@AXCPBX              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0051' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DBOMV           BOL HPS Movemen
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDAXJKRU    #DBOMV           BOL HPS Movemen
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Rtv Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN EJHONB    WQSH01           CC Company Numb
     C           *LIKE     DEFN EJBNNB    WQSH02           BOH Buy Order N
     C           *LIKE     DEFN EJBONB    WQSH03           BOL Load Number
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WQSH01           CC Company Numb
     C                     KFLD           WQSH02           BOH Buy Order N
     C                     KFLD           WQSH03           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WQSH01           CC Company Numb
     C                     Z-ADDAXBNNB    WQSH02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQSH03           BOL Load Number
      * Establish starting position
     C           KRSSH     SETLL@EJCPBK                    *
     C           KRSSH     READE@EJCPBK                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     #DBOMV           BOLW Movement N
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDEJBOMV    #DBOMV           BOLW Movement N
     C                     GOTO SHEXIT                     *QUIT
     C           KRSSH     READE@EJCPBK                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Load Ref RT - Buy Order Load Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WABONB           BOL Load Number
      * Establish starting position
     C           KRSSI     CHAIN@ACCPW8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1418' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DDIT1           BOL Ref 1
     C                     MOVEL*BLANK    #DDJT1           BOL Ref 2
     C                     MOVEL*BLANK    #DIJSS           BOL Ref Status
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWADIT1    #DDIT1           BOL Ref 1
     C                     MOVELWADJT1    #DDJT1           BOL Ref 2
     C                     MOVELWAIJSS    #DIJSS           BOL Ref Status
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Producer TrkSz,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSJ     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACAMNB    WUAMNB           PD Std Truck Si
     C                     MOVELACIWST    #1O8ST           PD Freight Exp
     C                     MOVELACAACD    WUAACD           SR Source Code
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * Rtv Trucker Record    RT - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVEL#1BNCD    BABNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSK     CHAIN@BAREDS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           RS Record Statu
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBAAJST    YL0001           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Val Movement Number   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WBHONB           CC Company Numb
     C                     KFLD           WBABCD           PD Producer Cod
     C                     KFLD           WBAECD           PL Location Cod
     C                     KFLD           WBBOMV           BOLW Movement N
     C                     KFLD           WBSRST           BOLW Weight Typ
      * Setup key
     C                     Z-ADD#1HMNB    WBHONB           CC Company Numb
     C                     MOVEL#1ABCD    WBABCD           PD Producer Cod
     C                     MOVEL#1AECD    WBAECD           PL Location Cod
     C                     Z-ADD#DBOMV    WBBOMV           BOLW Movement N
     C                     MOVEL'I'       WBSRST           BOLW Weight Typ
      * Establish starting position
     C           KRSSL     CHAIN@EJCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0841' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'N'       WUH7ST           Record Found US
     C                     GOTO SLEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVEL'Y'       WUH7ST           Record Found US
     C                     ENDIF
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Chk tatto Paid for Bol RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUK4PR           Tot Frt Spdb af
     C                     MOVEL'N'       WUNFST           Held Over Recor
     C                     MOVEL'N'       WUNPST           Tattoo is paid
      * Declare restrictor key work fields
     C           *LIKE     DEFN A1HMNB    WQSM01           BOH Company Num
     C           *LIKE     DEFN A1BNNB    WQSM02           BOH Buy Order N
     C           *LIKE     DEFN A1BONB    WQSM03           BOL Load Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           BOH Company Num
     C                     KFLD           WQSM02           BOH Buy Order N
     C                     KFLD           WQSM03           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WQSM01           BOH Company Num
     C                     Z-ADD#1BNNB    WQSM02           BOH Buy Order N
     C                     Z-ADD#1BONB    WQSM03           BOL Load Number
      * Establish starting position
     C           KRSSM     SETLL@A1CPC4                    *
     C           KRSSM     READE@A1CPC4                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * If one tattoo is paid but freight was spread then accumulate
      * what is paid, for held over respread problem
      * when this probelm goes away, then just flag that there is one pai
      * CASE: DB1.TH Payment Sts is Paid Anything
     C           A1CWST    IFEQ 'PL'                       *IF
     C           A1CWST    OREQ 'PC'
     C           A1CWST    OREQ 'NC'
     C           A1CWST    OREQ 'NL'
      * CHECK IF FREIGHT AMOUNT IS IN RECORD
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           A1CDPR    IFNE 0                          *IF
     C                     MOVEL'Y'       WUNPST           Tattoo is paid
     C                     END                             *FI
     C                     ADD  A1CDPR    WUK4PR           Tot Frt Spdb af
     C                     ELSE
      * CASE: *OTHERWISE
      * CHECK FOR HELD OVER RECORD
      * CASE:
      *  - c1 OR c2
      *   |- c1    : DB1.TH Held Over Record is Yes
      *   |- c2    : DB1.TH Held Over is greater than 0
      *   '-
     C           A1E1ST    IFEQ 'Y'                        *IF
     C           A1H9NB    ORGT 0                          *OR
     C                     MOVEL'Y'       WUNFST           Held Over Recor
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSM     READE@A1CPC4                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Trucker Record    RT - Trucker  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVEL#1BNCD    BABNCD           TRK Trucker Cod
      * Establish starting position
     C           KRSSN     CHAIN@BAREDS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0079' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    #DBJTX           TRK Name
     C                     MOVEL*BLANK    YL0001           RS Record Statu
     C                     GOTO SNEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELBABJTX    #DBJTX           TRK Name
     C                     MOVELBAAJST    YL0001           RS Record Statu
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * Rtv Producer Name     RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVEL#1ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSSO     CHAIN@ACREAI              90    *
      * Data record not found
     C   90                MOVEL'PRK0009' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELACAGTX    #DA4TX           PD Name
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv Pdctn Loc Name    RT - Production Location  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    AFABCD           PD Producer Cod
     C                     MOVEL#1AECD    AFAECD           PL Location Cod
      * Establish starting position
     C           KRSSP     CHAIN@AFREAR              90    *
      * Data record not found
     C   90                MOVEL'PRK0015' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAFA8TX    #DA9TX           PL Name
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCRRC    BEGSR
      *================================================================
      * Crt Buy Order Detail  CR - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @AXCPBY
     C                     Z-ADD#1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AXBONB           BOL Load Number
     C                     Z-ADD#1CQDT    AXCQDT           BOL Kill Date
     C                     Z-ADD#1ABTH    AXABTH           BOL Pln Delv St
     C                     Z-ADD#1ACTH    AXACTH           BOL Pln Delv En
     C                     Z-ADD#1BPNB    AXBPNB           BOL Pln Head De
     C                     Z-ADD#1CSNB    AXCSNB           BOL Shipped Wgt
     C                     Z-ADD#1AUDT    AXAUDT           BOL Pln Delv Da
     C                     MOVEL#1CMST    AXCMST           BOL Freight UOM
     C                     Z-ADD#1AGPR    AXAGPR           BOL Freight Uni
     C                     Z-ADD#1ATVA    AXATVA           BOL Freight Amt
     C                     MOVEL#1I1ST    AXI1ST           BOL Freight All
     C                     Z-ADD#1DHNB    AXDHNB           BOL Head Receiv
     C                     Z-ADD#1DINB    AXDINB           BOL Live Wgt Re
     C                     MOVEL#1CNST    AXCNST           BOL Trucker Pay
     C                     Z-ADD#1GINB    AXGINB           BOL Trucker Che
     C                     Z-ADD#1BZDT    AXBZDT           BOL Trucker Che
     C                     Z-ADD#1LSNB    AXLSNB           BOL AP Voucher
     C                     MOVEL#1F3TX    AXF3TX           BOL Trailer
     C                     MOVEL#1O8ST    AXO8ST           BOL Freight Exp
     C                     MOVEL#1O9ST    AXO9ST           BOL Scheduled K
     C                     MOVEL#1PAST    AXPAST           BOL Truck Scale
     C                     Z-ADD#1LDSH    AXLDSH           BOL Shipped Hea
     C                     MOVEL#1PBST    AXPBST           Reported to USD
     C                     MOVEL#1PCST    AXPCST           BOL MPR Prior D
     C                     MOVEL#1PDST    AXPDST           BOL Violated Au
     C                     MOVEL#1UWST    AXUWST           BOL Status 5
     C                     MOVEL#1UXST    AXUXST           BOL Status 6
     C                     MOVEL#1UYST    AXUYST           BOL Status 7
     C                     Z-ADD#1JKRU    AXJKRU           BOL HPS Movemen
     C                     Z-ADD#1KEOR    AXKEOR           BOL Head LFT
     C                     Z-ADD#1IOEW    AXIOEW           BOL Head EUT/KO
     C                     Z-ADD#1KJIO    AXKJIO           BOL Auth Gate E
     C                     Z-ADD#1IOJR    AXIOJR           BOL Head Receiv
     C                     Z-ADD#1EIRR    AXEIRR           BOL Unused Wgt
     C                     Z-ADD#1ITMF    AXITMF           BOL Unused Wgt
     C                     Z-ADD#1ODJE    AXODJE           BOL Unused Wgt
     C                     Z-ADD#1RJIF    AXRJIF           BOL Unused Wgt
     C                     Z-ADD#1OEJF    AXOEJF           BOL Unused Wgt
     C                     Z-ADD#1D0DT    AXD0DT           BOL Auth Gate E
     C                     Z-ADD#1D1DT    AXD1DT           BOL Unused Date
     C                     Z-ADD#1D2DT    AXD2DT           BOL Unused Date
     C                     Z-ADD#1D3DT    AXD3DT           BOL Unused Date
     C                     Z-ADD#1D4DT    AXD4DT           BOL Unused Date
     C                     MOVEL#1BNCD    AXBNCD           TRK Trucker Cod
     C                     MOVEL#1ABCD    AXABCD           PD Producer Cod
     C                     MOVEL#1AECD    AXAECD           PL Location Cod
     C                     MOVEL#1AAVN    AXAAVN           RS User Changed
     C                     Z-ADD#1AADT    AXAADT           RS Date Changed
     C                     Z-ADD#1AMTM    AXAMTM           RS Time Changed
     C                     MOVEL#1AJST    AXAJST           RS Record Statu
     C                     MOVEL#1AHVN    AXAHVN           RS Job
     C                     MOVEL#1AGVN    AXAGVN           RS Program
     C                     MOVEL#1ABVN    AXABVN           RS User Added
     C                     Z-ADD#1ABDT    AXABDT           RS Date Added
     C                     Z-ADD#1ABTM    AXABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       AXAJST           RS Record Statu
     C                     MOVEL##USR     AXABVN           RS User Added
     C                     Z-ADD##JDT     AXABDT           RS Date Added
     C                     Z-ADD##JTM     AXABTM           RS Time Added
     C                     MOVEL##PGM     AXAGVN           RS Program
     C                     MOVEL##JOB     AXAHVN           RS Job
     C           KLCRSQ    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
      * Check for duplicate primary key
     C           KLCRSQ    SETLL@AXCPBY                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0052' W0RTN   7
      * Send message 'Buy Order Load         EX'
     C                     MOVEL'PRK0052' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C                     WRITE@AXCPBY                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Crt/Chg BO Load Ref   RT - Buy Order Load Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
      * Setup key
     C                     Z-ADD#1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WABONB           BOL Load Number
      * Establish starting position
     C           KRSSR     CHAIN@ACCPW8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1418' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
     C                     EXSR SSCRRC
     C                     GOTO SREXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Buy Order Load Ref CH - Buy Order Load Reference  * 
     C                     EXSR STCHRC
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSCRRC    BEGSR
      *================================================================
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0010 10        RS User Changed
     C                     Z-ADD*ZERO     WN0011  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0012  60       RS Time Changed
     C                     MOVEL*BLANK    WN0013  1        RS Record Statu
     C                     MOVEL*BLANK    WN0014 10        RS Job
     C                     MOVEL*BLANK    WN0015 10        RS Program
     C                     MOVEL*BLANK    WN0016 10        RS User Added
     C                     Z-ADD*ZERO     WN0017  70       RS Date Added
     C                     Z-ADD*ZERO     WN0018  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ACCPW7
     C                     Z-ADD#1HMNB    WCHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    WCBONB           BOL Load Number
     C                     MOVEL#DDIT1    WCDIT1           BOL Ref 1
     C                     MOVEL#DDJT1    WCDJT1           BOL Ref 2
     C                     MOVEL#DIJSS    WCIJSS           BOL Ref Status
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WCABDT    PARM *ZERO     WQ0033  70       *DATE
     C           WCABTM    PARM *ZERO     WQ0034  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRSS    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
      * Check for duplicate primary key
     C           KLCRSS    SETLL@ACCPW7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1419' W0RTN   7
      * Send message 'Buy Order Load Referen EX'
     C                     MOVEL'PRK1419' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C                     WRITE@ACCPW7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * Chg Buy Order Load Ref CH - Buy Order Load Reference  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0019 10        RS User Changed
     C                     Z-ADD*ZERO     WN0020  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0021  60       RS Time Changed
     C                     MOVEL*BLANK    WN0022  1        RS Record Statu
     C                     MOVEL*BLANK    WN0023 10        RS Job
     C                     MOVEL*BLANK    WN0024 10        RS Program
     C                     MOVEL*BLANK    WN0025 10        RS User Added
     C                     Z-ADD*ZERO     WN0026  70       RS Date Added
     C                     Z-ADD*ZERO     WN0027  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @ACCPW7
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
      *
     C           KLCHST    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C           KLCHST    CHAIN@ACCPW7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PWACCPL0'MDACP
     C                     MOVEL'@ACCPW7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPWAC1    YARDCS
      * Move non-key fields to @ACCPW7
     C                     MOVEL#DDIT1    WCDIT1    P      BOL Ref 1
     C                     MOVEL#DDJT1    WCDJT1    P      BOL Ref 2
     C                     MOVEL#DIJSS    WCIJSS    P      BOL Ref Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPWAC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WCAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WCAADT    PARM *ZERO     WQ0035  70       *DATE
     C           WCAMTM    PARM *ZERO     WQ0036  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPWAC1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@ACCPW7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPWACCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * Chg Buy Ord Dtl/WFrt  CH - Buy Order Load  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0028  50       BOL Shipped Hea
     C                     MOVEL*BLANK    WN0029  1        Reported to USD
     C                     MOVEL*BLANK    WN0030  1        BOL MPR Prior D
     C                     MOVEL*BLANK    WN0031  2        BOL Status 5
     C                     MOVEL*BLANK    WN0032  2        BOL Status 6
     C                     MOVEL*BLANK    WN0033  3        BOL Status 7
     C                     Z-ADD*ZERO     WN0034  70       BOL Head LFT
     C                     Z-ADD*ZERO     WN0035  70       BOL Head EUT/KO
     C                     Z-ADD*ZERO     WN0036  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0037  70       BOL Head Receiv
     C                     Z-ADD*ZERO     WN0038 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0039 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0040 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0041 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0042 111       BOL Unused Wgt
     C                     Z-ADD*ZERO     WN0043  70       BOL Auth Gate E
     C                     Z-ADD*ZERO     WN0044  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0045  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0046  70       BOL Unused Date
     C                     Z-ADD*ZERO     WN0047  70       BOL Unused Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Processing before Data read
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * E2423 Mtech Live extra review with Purva and Susan
      * Get the MTech Live Yes or No
     C                     EXSR UASUBR                     Get the MTech L
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @AXCPBY
     C                     Z-ADD#1HMNB    AXHMNB           BOH Company Num
     C                     Z-ADD#1BNNB    AXBNNB           BOH Buy Order N
     C                     Z-ADD#1BONB    AXBONB           BOL Load Number
      *
     C           KLCHSU    KLIST
     C                     KFLD           AXHMNB           BOH Company Num
     C                     KFLD           AXBNNB           BOH Buy Order N
     C                     KFLD           AXBONB           BOL Load Number
     C           KLCHSU    CHAIN@AXCPBY              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKAXCPL1'MDACP
     C                     MOVEL'@AXCPBY' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Check for changed record
     C           #1DBRC    IFNE @1DBRC                     IF
     C                     MOVEL'Y2U0007' W0RTN   7
      * Send message '*Update not accepted'
     C                     MOVEL'Y2U0007' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     GOTO SUEXIT
     C                     ENDIF                           FI #1DBRC
      * Store record data for null update check
     C                     MOVE @1DBRC    YBRDCS
      * USER: Processing after Data read
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.BOL Freight UOM NE DB1.BOL Freight UOM
      *   |- c2    : PAR.BOL Freight Unit Amt EQ DB1.BOL Freight Unit Amt
      *   |- c3    : PAR.BOL Freight Amt EQ PAR.BOL Freight Amt
      *   '-
     C           #1CMST    IFNE AXCMST                     *IF
     C           #1AGPR    OREQ AXAGPR                     *OR
     C           #1ATVA    OREQ #1ATVA                     *OR
      * Chg Cal Net Pay       XF - Tattoo Header  * 
     C                     CALL 'PKTEXFR'              90  Chg Cal Net Pay
     C                     PARM *BLANK    W0RTN   7
     C                     PARM AXHMNB    WQ0040  30       BOH Company Num
     C                     PARM AXBNNB    WQ0041  70       BOH Buy Order N
     C                     PARM AXBONB    WQ0042  50       BOL Load Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKTEXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
      * Move non-key fields to @AXCPBY
     C                     Z-ADD#1CQDT    AXCQDT           BOL Kill Date
     C                     Z-ADD#1ABTH    AXABTH           BOL Pln Delv St
     C                     Z-ADD#1ACTH    AXACTH           BOL Pln Delv En
     C                     Z-ADD#1BPNB    AXBPNB           BOL Pln Head De
     C                     Z-ADD#1CSNB    AXCSNB           BOL Shipped Wgt
     C                     Z-ADD#1AUDT    AXAUDT           BOL Pln Delv Da
     C                     MOVEL#1CMST    AXCMST    P      BOL Freight UOM
     C                     Z-ADD#1AGPR    AXAGPR           BOL Freight Uni
     C                     Z-ADD#1ATVA    AXATVA           BOL Freight Amt
     C                     MOVEL#1I1ST    AXI1ST    P      BOL Freight All
     C                     Z-ADD#1DHNB    AXDHNB           BOL Head Receiv
     C                     Z-ADD#1DINB    AXDINB           BOL Live Wgt Re
     C                     MOVELWUCNST    AXCNST    P      BOL Trucker Pay
     C                     Z-ADD#1GINB    AXGINB           BOL Trucker Che
     C                     Z-ADD#1BZDT    AXBZDT           BOL Trucker Che
     C                     Z-ADD#1LSNB    AXLSNB           BOL AP Voucher
     C                     MOVEL#1F3TX    AXF3TX    P      BOL Trailer
     C                     MOVEL#1O8ST    AXO8ST    P      BOL Freight Exp
     C                     MOVEL#1O9ST    AXO9ST    P      BOL Scheduled K
     C                     MOVEL#1PAST    AXPAST    P      BOL Truck Scale
     C                     MOVEL#1PDST    AXPDST    P      BOL Violated Au
     C                     Z-ADD#DBOMV    AXJKRU           BOL HPS Movemen
     C                     MOVEL#1BNCD    AXBNCD    P      TRK Trucker Cod
     C                     MOVEL#1ABCD    AXABCD    P      PD Producer Cod
     C                     MOVEL#1AECD    AXAECD    P      PL Location Cod
     C                     MOVEL#1AAVN    AXAAVN    P      RS User Changed
     C                     Z-ADD#1AADT    AXAADT           RS Date Changed
     C                     Z-ADD#1AMTM    AXAMTM           RS Time Changed
     C                     MOVEL#1AJST    AXAJST    P      RS Record Statu
     C                     MOVEL#1AHVN    AXAHVN    P      RS Job
     C                     MOVEL#1AGVN    AXAGVN    P      RS Program
     C                     MOVEL#1ABVN    AXABVN    P      RS User Added
     C                     Z-ADD#1ABDT    AXABDT           RS Date Added
     C                     Z-ADD#1ABTM    AXABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     AXAAVN           RS User Changed
     C                     Z-ADD##JDT     AXAADT           RS Date Changed
     C                     Z-ADD##JTM     AXAMTM           RS Time Changed
     C                     MOVEL##JOB     AXAHVN           RS Job
     C                     MOVEL##PGM     AXAGVN           RS Program
      * E10812 JJH 01/29/18 - New Logic with No Gate Flag
      * If Movement Number Changed
      * CASE: PAR.Movement number new usr NE PAR.Movement number old  USR
     C           #DBOMV    IFNE WUMVOL                     *IF
      * CASE: PAR.No Gate Flag is Yes
     C           YL0002    IFEQ 'Y'                        *IF
     C                     MOVEL*BLANK    AXPAST           BOL Truck Scale
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: LCL.MTech Live Yes or No is No MTech not Live
     C           YL0009    IFEQ 'N'                        *IF
      * Z1v HPS Farm Info     UP - STR HPS Interface  * 
     C                     CALL 'HP249'                90  Z1v HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0043  7        *Return code
     C                     PARM #DBOMV    WQ0044  70       TH HPS Movement
     C           WUKQTX    PARM *BLANK    WQ0045 25        Farm site Name
     C           WUETNB    PARM *ZERO     WQ0046  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0047  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0048  3        State
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP249'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     9937  *
     C                     END
     C                     ELSE
      * CASE: LCL.MTech Live Yes or No is Yes MTech is Live
     C           YL0009    IFEQ 'Y'                        *IF
      * e2423 get the farm site from the delivery tracking
      * get the farm site and pull back farm site information
      * Rtv Farm Site Only    RT - Delivery Tracking  * 
     C                     EXSR SVRVGN
      * Rtv HPS Farm Inf-Mtech UP - STR HPS Interface  * 
     C                     CALL 'HP293'                90  Rtv HPS Farm In
     C           W0RTN     PARM W0RTN     WQ0049  7        *Return code
     C           WUKQTX    PARM *BLANK    WQ0050 25        Farm site Name
     C                     PARM WUETNB    WQ0051  50       Farm Site USR
     C           WUG4CD    PARM *BLANK    WQ0052  5        HPS FS Comp Rel
     C           WUDRTX    PARM *BLANK    WQ0053  3        State
     C                     PARM *BLANK    WQ0054 25        HPS Farm County
     C                     PARM *BLANK    WQ0055  5        HPS Cell Manage
     C                     PARM *BLANK    WQ0056 25        HPS Cell Manage
     C                     PARM *BLANK    WQ0057 20        MTech Farm Site
     C                     PARM *BLANK    WQ0058 20        MTech Cell Mana
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'HP293'   W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.HPS FS Comp Relation USR is Contract
     C           WUG4CD    IFEQ 'CON'                      *IF
     C                     MOVEL'N'       AXPAST           BOL Truck Scale
     C                     ELSE
      * CASE: *OTHERWISE
      * Make BOL Sts = In/Out depending on BOLW records found
      * CASE: DB1.BOL Truck Scale Weigh Sts is No Spread
     C           AXPAST    IFEQ 'N'                        *IF
      * Rtv f/ Edit BOL       RT - Buy Order Load Weight  * 
     C                     EXSR SWRVGN
      * CASE: WRK.BOL OUT record found  USR is Yes
     C           WUSXST    IFEQ 'Y'                        *IF
     C                     MOVEL'O'       AXPAST           BOL Truck Scale
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.BOL IN  record found  USR is Yes
     C           WUSWST    IFEQ 'Y'                        *IF
     C                     MOVEL'I'       AXPAST           BOL Truck Scale
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Rtv to Change Mvmnt   RT - Buy Order Load Weight  * 
     C                     EXSR SXRVGN
     C                     END                             *FI
      * E10812 JJH 01/29/18 - Update Buy Order Load Reference
      * If Ref 1, or Ref2, or Ref Status changed
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : PAR.BOL Ref 1 NE PAR.BOL Ref 1 Old
      *   |- c2    : PAR.BOL Ref 2 NE PAR.BOL Ref 2 Old
      *   |- c3    : PAR.BOL Ref Status NE PAR.BOL Ref Status Old
      *   '-
     C           #DDIT1    IFNE YL0003                     *IF
     C           #DDJT1    ORNE YL0004                     *OR
     C           #DIJSS    ORNE YL0005                     *OR
      *
     C                     MOVEL*BLANK    WN0048 10        RS User Changed
     C                     Z-ADD*ZERO     WN0049  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0050  60       RS Time Changed
     C                     MOVEL*BLANK    WN0051  1        RS Record Statu
     C                     MOVEL*BLANK    WN0052 10        RS Job
     C                     MOVEL*BLANK    WN0053 10        RS Program
     C                     MOVEL*BLANK    WN0054 10        RS User Added
     C                     Z-ADD*ZERO     WN0055  70       RS Date Added
     C                     Z-ADD*ZERO     WN0056  60       RS Time Added
      *
      * Crt/Upd BO Load Ref   IF
      * C9426 032217 slm
      * C9426 use the BOL Referene to store the Ref1,Ref2 and Ref Status
      * Crt/Chg BO Load Ref   RT - Buy Order Load Reference  * 
     C                     EXSR TARVGN
     C                     END                             *FI
      * Set PGM.*Record Data Changed flag
     C           @1DBRC    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@AXCPBY                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKAXCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * Update saved record image
     C                     MOVEL@1DBRC    #1DBRC
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * Rtv Farm Site Only    RT - Delivery Tracking  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSV01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSV02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSV03           BOL Load Number
     C           *LIKE     DEFN WDE0DT    WQSV04           DSH Kill Date
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           BOH Company Num
     C                     KFLD           WQSV02           BOH Buy Order N
     C                     KFLD           WQSV03           BOL Load Number
     C                     KFLD           WQSV04           DSH Kill Date
      * Setup key
     C                     Z-ADDAXHMNB    WQSV01           BOH Company Num
     C                     Z-ADDAXBNNB    WQSV02           BOH Buy Order N
     C                     Z-ADDAXBONB    WQSV03           BOL Load Number
     C                     Z-ADDAXCQDT    WQSV04           DSH Kill Date
      * Establish starting position
     C           KRSSV     SETLL@AFCPI4                    *
     C           KRSSV     READE@AFCPI4                  90*
      * Data record not found
     C   90                MOVEL'PRK1030' W0RTN   7
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv f/ Edit BOL       RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WUSWST           BOL IN  record
     C                     MOVEL'N'       WUSXST           BOL OUT record
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSW01           CC Company Numb
     C           *LIKE     DEFN WBABCD    WQSW02           PD Producer Cod
     C           *LIKE     DEFN WBAECD    WQSW03           PL Location Cod
     C           *LIKE     DEFN WBBOMV    WQSW04           BOLW Movement N
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW01           CC Company Numb
     C                     KFLD           WQSW02           PD Producer Cod
     C                     KFLD           WQSW03           PL Location Cod
     C                     KFLD           WQSW04           BOLW Movement N
      * Setup key
     C                     Z-ADDAXHMNB    WQSW01           CC Company Numb
     C                     MOVELAXABCD    WQSW02           PD Producer Cod
     C                     MOVELAXAECD    WQSW03           PL Location Cod
     C                     Z-ADDWUMVOL    WQSW04           BOLW Movement N
      * Establish starting position
     C           KRSSW     SETLL@EJCPBI                    *
     C           KRSSW     READE@EJCPBI                  90*
      * Data record not found
     C   90                MOVEL'PRK0841' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.BOLW Weight Type is In(En)
     C           WBSRST    IFEQ 'I'                        *IF
     C                     MOVEL'Y'       WUSWST           BOL IN  record
     C                     ELSE
      * CASE: DB1.BOLW Weight Type is Out(Fuera)
     C           WBSRST    IFEQ 'O'                        *IF
     C                     MOVEL'Y'       WUSXST           BOL OUT record
     C                     END                             *FI
     C                     END                             *FI
     C           KRSSW     READE@EJCPBI                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * Rtv to Change Mvmnt   RT - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBHONB    WQSX01           CC Company Numb
     C           *LIKE     DEFN WBABCD    WQSX02           PD Producer Cod
     C           *LIKE     DEFN WBAECD    WQSX03           PL Location Cod
     C           *LIKE     DEFN WBBOMV    WQSX04           BOLW Movement N
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           CC Company Numb
     C                     KFLD           WQSX02           PD Producer Cod
     C                     KFLD           WQSX03           PL Location Cod
     C                     KFLD           WQSX04           BOLW Movement N
      * Setup key
     C                     Z-ADDAXHMNB    WQSX01           CC Company Numb
     C                     MOVELAXABCD    WQSX02           PD Producer Cod
     C                     MOVELAXAECD    WQSX03           PL Location Cod
     C                     Z-ADDWUMVOL    WQSX04           BOLW Movement N
      * Establish starting position
     C           KRSSX     SETLL@EJCPBI                    *
     C           KRSSX     READE@EJCPBI                  90*
      * Data record not found
     C   90                MOVEL'PRK0841' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Dlt Buy Order Load Wt DO - Buy Order Load Weight  * 
     C                     EXSR SYDLRC
      * Crt Buy Order Load Wt CR - Buy Order Load Weight  * 
     C                     EXSR SZCRRC
     C           KRSSX     READE@EJCPBI                  90*
     C                     ENDDO
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYDLRC    BEGSR
      *================================================================
      * Dlt Buy Order Load Wt DO - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move key fields to @EJCPBH
     C                     Z-ADDWBHONB    WEHONB           CC Company Numb
     C                     MOVELWBABCD    WEABCD           PD Producer Cod
     C                     MOVELWBAECD    WEAECD           PL Location Cod
     C                     Z-ADDWBBOMV    WEBOMV           BOLW Movement N
     C                     MOVELWBSRST    WESRST           BOLW Weight Typ
      *
     C           KLDLSY    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEABCD           PD Producer Cod
     C                     KFLD           WEAECD           PL Location Cod
     C                     KFLD           WEBOMV           BOLW Movement N
     C                     KFLD           WESRST           BOLW Weight Typ
     C           KLDLSY    CHAIN@EJCPBH              9091  *
     C           *IN90     IFEQ '1'
      * Record already deleted
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKEJCPL0'MDACP
     C                     MOVEL'@EJCPBH' MDFMT
     C                     MOVEL'*DLT'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      *................................................................
     C                     DELET@EJCPBH                91  *
     C           *IN91     IFEQ '1'
      * Delete error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZCRRC    BEGSR
      *================================================================
      * Crt Buy Order Load Wt CR - Buy Order Load Weight  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @EJCPBH
     C                     Z-ADDWBHONB    WEHONB           CC Company Numb
     C                     MOVELWBABCD    WEABCD           PD Producer Cod
     C                     MOVELWBAECD    WEAECD           PL Location Cod
     C                     Z-ADD#DBOMV    WEBOMV           BOLW Movement N
     C                     MOVELWBSRST    WESRST           BOLW Weight Typ
     C                     Z-ADDWBBOSW    WEBOSW           BOLW Scale Weig
     C                     Z-ADDWBDQDT    WEDQDT           BOLW Scale Weig
     C                     Z-ADDWBA2TM    WEA2TM           BOLW Scale Weig
     C                     MOVELWBSSST    WESSST           BOLW Spread Sta
     C                     MOVELWBSTST    WESTST           BOLW Unused Sts
     C                     MOVELWBSUST    WESUST           BOLW Unused Sts
     C                     Z-ADDWBHMNB    WEHMNB           BOH Company Num
     C                     Z-ADDWBBNNB    WEBNNB           BOH Buy Order N
     C                     Z-ADDWBBONB    WEBONB           BOL Load Number
     C                     MOVELWBAAVN    WEAAVN           RS User Changed
     C                     Z-ADDWBAADT    WEAADT           RS Date Changed
     C                     Z-ADDWBAMTM    WEAMTM           RS Time Changed
     C                     MOVELWBAJST    WEAJST           RS Record Statu
     C                     MOVELWBAHVN    WEAHVN           RS Job
     C                     MOVELWBAGVN    WEAGVN           RS Program
     C                     MOVELWBABVN    WEABVN           RS User Added
     C                     Z-ADDWBABDT    WEABDT           RS Date Added
     C                     Z-ADDWBABTM    WEABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WEAJST           RS Record Statu
     C                     MOVEL##USR     WEABVN           RS User Added
     C                     Z-ADD##JDT     WEABDT           RS Date Added
     C                     Z-ADD##JTM     WEABTM           RS Time Added
     C                     MOVEL##PGM     WEAGVN           RS Program
     C                     MOVEL##JOB     WEAHVN           RS Job
     C           KLCRSZ    KLIST
     C                     KFLD           WEHONB           CC Company Numb
     C                     KFLD           WEABCD           PD Producer Cod
     C                     KFLD           WEAECD           PL Location Cod
     C                     KFLD           WEBOMV           BOLW Movement N
     C                     KFLD           WESRST           BOLW Weight Typ
      * Check for duplicate primary key
     C           KLCRSZ    SETLL@EJCPBH                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0842' W0RTN   7
      * Send message 'Buy Order Load Weight  EX'
     C                     MOVEL'PRK0842' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C                     WRITE@EJCPBH                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * Crt/Chg BO Load Ref   RT - Buy Order Load Reference  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
      * Setup key
     C                     Z-ADDAXHMNB    WAHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WABONB           BOL Load Number
      * Establish starting position
     C           KRSTA     CHAIN@ACCPW8              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1418' W0RTN   7
      * USER: Processing if Data record not found
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
     C                     EXSR TBCRRC
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * Chg Buy Order Load Ref CH - Buy Order Load Reference  * 
     C                     EXSR TCCHRC
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBCRRC    BEGSR
      *================================================================
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0057 10        RS User Changed
     C                     Z-ADD*ZERO     WN0058  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0059  60       RS Time Changed
     C                     MOVEL*BLANK    WN0060  1        RS Record Statu
     C                     MOVEL*BLANK    WN0061 10        RS Job
     C                     MOVEL*BLANK    WN0062 10        RS Program
     C                     MOVEL*BLANK    WN0063 10        RS User Added
     C                     Z-ADD*ZERO     WN0064  70       RS Date Added
     C                     Z-ADD*ZERO     WN0065  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @ACCPW7
     C                     Z-ADDAXHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDAXBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDAXBONB    WCBONB           BOL Load Number
     C                     MOVEL#DDIT1    WCDIT1           BOL Ref 1
     C                     MOVEL#DDJT1    WCDJT1           BOL Ref 2
     C                     MOVEL#DIJSS    WCIJSS           BOL Ref Status
      *
      * USER: Processing before Data update
      * Rtv Add Stamp-Sys Dt  IF
     C                     MOVEL'A'       WCAJST           RS Record Statu
     C                     MOVEL##USR     WCABVN           RS User Added
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WCABDT    PARM *ZERO     WQ0059  70       *DATE
     C           WCABTM    PARM *ZERO     WQ0060  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##PGM     WCAGVN           RS Program
     C                     MOVEL##JOB     WCAHVN           RS Job
     C           KLCRTB    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
      * Check for duplicate primary key
     C           KLCRTB    SETLL@ACCPW7                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK1419' W0RTN   7
      * Send message 'Buy Order Load Referen EX'
     C                     MOVEL'PRK1419' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C                     WRITE@ACCPW7                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCHRC    BEGSR
      *================================================================
      * Chg Buy Order Load Ref CH - Buy Order Load Reference  * 
      *================================================================
      *
     C                     MOVEL*BLANK    WN0066 10        RS User Changed
     C                     Z-ADD*ZERO     WN0067  70       RS Date Changed
     C                     Z-ADD*ZERO     WN0068  60       RS Time Changed
     C                     MOVEL*BLANK    WN0069  1        RS Record Statu
     C                     MOVEL*BLANK    WN0070 10        RS Job
     C                     MOVEL*BLANK    WN0071 10        RS Program
     C                     MOVEL*BLANK    WN0072 10        RS User Added
     C                     Z-ADD*ZERO     WN0073  70       RS Date Added
     C                     Z-ADD*ZERO     WN0074  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @ACCPW7
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
      *
     C           KLCHTC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C           KLCHTC    CHAIN@ACCPW7              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PWACCPL0'MDACP
     C                     MOVEL'@ACCPW7' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPWAC1    YCRDCS
      * Move non-key fields to @ACCPW7
     C                     MOVEL#DDIT1    WCDIT1    P      BOL Ref 1
     C                     MOVEL#DDJT1    WCDJT1    P      BOL Ref 2
     C                     MOVEL#DIJSS    WCIJSS    P      BOL Ref Status
      *
      * Set PGM.*Record Data Changed flag
     C           QPWAC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp-SysDtIF
     C                     MOVEL##USR     WCAAVN           RS User Changed
      * Rtv System Date & Tim UP - STR User Source Functions  * 
     C                     CALL 'PKWDUPC'              90  Rtv System Date
     C           WCAADT    PARM *ZERO     WQ0061  70       *DATE
     C           WCAMTM    PARM *ZERO     WQ0062  60       *TIME
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKWDUPC' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPWAC1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@ACCPW7                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPWACCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           ACABCD           PD Producer Cod
      * Setup key
     C                     MOVELP2ABCD    ACABCD           PD Producer Cod
      * Establish starting position
     C           KRSTD     CHAIN@ACREAI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0009' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WUGCNB           PD VND Address
     C                     MOVEL*BLANK    WUAACD           SR Source Code
     C                     GOTO TDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDACGCNB    WUGCNB           PD VND Address
     C                     MOVELACAACD    WUAACD           SR Source Code
      * CASE: DB1.PD VND Address Number is Zero
     C           ACGCNB    IFEQ 0                          *IF
      * Rtv Producer EXT2     RT - Producer EXT2  * 
     C                     EXSR TERVGN
     C                     Z-ADD7         YRSW00
     C                     Z-ADD4         ZQ      50
     C           YRSW00    IFLT 1
     C           ZQ        ORLT 1
     C           YRSW00    ORGT 00010
     C           ZQ        ORGT 00010
     C                     MOVEL'Y2U0510' W0RTN
     C                     ELSE
     C           YRSW00    SUBSTWUQHCD:ZQ YL0010    P  90  Text 7 USR
     C   90                MOVEL'Y2U0510' W0RTN
     C                     END
     C                     MOVE YL0010    YL0011           Amount USR
     C                     Z-ADDYL0011    WUGCNB           PD VND Address
     C                     END                             *FI
     C                     GOTO TDEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TERVGN    BEGSR
      *================================================================
      * Rtv Producer EXT2     RT - Producer EXT2  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTE     KLIST
     C                     KFLD           B4ABCD           PD Producer Cod
      * Setup key
     C                     MOVELACABCD    B4ABCD           PD Producer Cod
      * Establish starting position
     C           KRSTE     CHAIN@B4RET4              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1329' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = PAR By name
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELB4QHCD    WUQHCD           M3 Supplier ID
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFRVGN    BEGSR
      *================================================================
      * Rtv Source Type       RT - Source  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTF     KLIST
     C                     KFLD           AAAACD           SR Source Code
      * Setup key
     C                     MOVELWUAACD    AAAACD           SR Source Code
      * Establish starting position
     C           KRSTF     CHAIN@AAREAC              90    *
      * Data record not found
     C   90                MOVEL'PRK0005' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELAAIXST    P5IXST           SR Type
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0037  30       BOH Company Num
     C                     PARM @CN,001   WQ0038 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0039 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0009           MTech Live Yes
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * History changes
      *================================================================
      * E15107 JJB  6/10/19 - Inactive Trucker records
      * - Validate the Trucker Code the user enters is Active.  Send erro
      *   message if the record is inactive.
      * E10812 JJH 01/29/18 - Market Hog Order To Cash (OTC)
      * - At this date, Sioux City does not have a Gate for the Truckers
      *   to enter Plant. Therfore, there is no Buy Order Load Weight
      *   PKEJCPP file for 440 and 961.
      * - Therefore, the current logic which gets the Movment Number from
      *   from the Buy Order Load Weight file will not work for 440 and 9
      * - Add new Company Value = NOGATE with values of Y or N
      * - If Company Value NOGATE = Y, then get the Movement Number from
      *   the Buy Order Load (PKAXCPP) file.
      * - Allow entry for Buy Order Load Ref1, Ref2, and Ref Status at
      *   all times.
      * - Add logic to display and update the Buy Order Load Refernce fil
      *   for the Buy Order Load Ref 1, Ref 2 and Ref Status fields.
      * e2473 slm 02202013
      * e2473 slm Mtech check new field internal load type
      * also review all of hps interfaces
      * Make changes to Trucker validation per Alice HPE046
      *      Trucker is only required on Freight
      *      slm 100496
      * H16853 ISE 01/23/21 - Increased the length from 5 to 7 and correc
      *                       alignment of Buy Order Number field.
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * Get the MTech Live Yes or No
      *================================================================
      * Mtech Live Yes or no
      * Rtv Company Values    XF - STR Order Management Sys  * 
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0065  30       BOH Company Num
     C                     PARM @CN,001   WQ0066 10        Company Value C
     C           WUKBTX    PARM *BLANK    WQ0067 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
     C                     MOVELWUKBTX    YL0007           MTech Live Yes
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         VACKRL    BEGSR
      *================================================================
      * Select existing record
      *================================================================
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     C           YPMTFD    OREQ '#1BONB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
      * Field '(KEY) #1BONB' defaulted for 'BOL Load Number'.
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) P2ABCD' defaulted for 'PD Producer Code'.
     W* Y2W0052 - One or more arguments defaulted to WRK/CON context.
      * Field '(CON) *BLANK' defaulted for 'PL Location Code'.
     C                     CALL 'PKQJSRR'              90  Sel Producer BO
     C                     PARM *BLANK    W0RTN   7
     C                     PARM #1HMNB    WQ0010  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0011  70       BOH Buy Order N
     C           #1BONB    PARM #1BONB    WQ0012  50       BOL Load Number
     C                     PARM P2ABCD    WQ0013  6        PD Producer Cod
     C                     PARM *BLANK    WQ0014  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKQJSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     SETON                     33    *
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BONB    IFNE *ZERO                      BOL Load Number
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
     C                     END
      *================================================================
     CSR         VAEXIT    ENDSR
      /EJECT
     CSR         VBCKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
     C                     CALL 'PKLTSRR'              90  Tst Select kill
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0015  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0016  70       BOH Buy Order N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VBEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C                     GOTO VBEXIT
     C                     END
      *
     C           KLVBAW    KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    AWHMNB
     C                     Z-ADD#1BNNB    AWBNNB
     C           KLVBAW    CHAIN@AWCPBI              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VBEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VBEXIT
     C                     END
      * Send message 'Buy Order Header       NF'
     C                     MOVEL'PRK0049' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0049' W0RTN
      *================================================================
     CSR         VBEXIT    ENDSR
      /EJECT
     CSR         VCCKRL    BEGSR
      *================================================================
      * Check reference to Trucker
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1BNCD    WK1X01  1
     C           WK1X01    IFEQ '?'                        TRK Trucker Cod
     C           YPMTFD    OREQ '#1BNCD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1BNCD' defaulted for 'TRK Trucker Code'.
     C                     CALL 'PKDLSRR'              90  Sel Trucker
     C                     PARM *BLANK    W0RTN   7
     C           #1BNCD    PARM #1BNCD    WQ0021  3        TRK Trucker Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKDLSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     9931  *
     C                     END
      *
     C           #1BNCD    IFNE *BLANK                     TRK Trucker Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VCEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1BNCD    IFEQ *BLANK                     TRK Trucker Cod
     C                     GOTO VCEXIT
     C                     END
      *
     C           KLVCBA    KLIST
     C                     KFLD           BABNCD           TRK Trucker Cod
      * Setup key
     C                     MOVEL#1BNCD    BABNCD
     C           KLVCBA    CHAIN@BAREDS              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VCEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VCEXIT
     C                     END
      * Send message 'Trucker                NF'
     C                     MOVEL'PRK0079' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0079' W0RTN
      *================================================================
     CSR         VCEXIT    ENDSR
      /EJECT
     CSR         VDCKRL    BEGSR
      *================================================================
      * Check reference to Producer Location
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C                     MOVEL#1ABCD    WK1X01  1
     C                     MOVEL#1AECD    WK1X02  1
     C           WK1X01    IFEQ '?'                        PD Producer Cod
     C           YPMTFD    OREQ '#1ABCD'
     C           WK1X02    OREQ '?'                        PL Location Cod
     C           YPMTFD    OREQ '#1AECD'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DTL) #1ABCD' defaulted for 'PD Producer Code'.
      * Field '(DTL) #1AECD' defaulted for 'PL Location Code'.
     C                     CALL 'PWF5SRR'              90  Sel Prod Loc by
     C                     PARM *BLANK    W0RTN   7
     C           #1ABCD    PARM #1ABCD    WQ0022  6        PD Producer Cod
     C           #1AECD    PARM #1AECD    WQ0023  6        PL Location Cod
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PWF5SRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     99    *
     C                     END
      *
     C           #1ABCD    IFNE *BLANK                     PD Producer Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X01    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1AECD    IFNE *BLANK                     PL Location Cod
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C           WK1X02    ANDNE'?'
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VDEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1ABCD    IFEQ *BLANK                     PD Producer Cod
     C           #1AECD    ANDEQ*BLANK                     PL Location Cod
     C                     GOTO VDEXIT
     C                     END
      *
     C           KLVDAF    KLIST
     C                     KFLD           AFABCD           PD Producer Cod
     C                     KFLD           AFAECD           PL Location Cod
      * Setup key
     C                     MOVEL#1ABCD    AFABCD
     C                     MOVEL#1AECD    AFAECD
     C           KLVDAF    CHAIN@AFREAR              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VDEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VDEXIT
     C                     END
      * Send message 'Producer Location      NF'
     C                     MOVEL'PRK0015' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0015' W0RTN
      *================================================================
     CSR         VDEXIT    ENDSR
      /EJECT
     CSR         VECKRL    BEGSR
      *================================================================
      * Check reference to Buy Order Header
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Name search required?
     C           YPMTFD    IFEQ '#1HMNB'
     C           YPMTFD    OREQ '#1BNNB'
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(KEY) #1HMNB' defaulted for 'BOH Company Number'.
      * Field '(KEY) #1BNNB' defaulted for 'BOH Buy Order Number'.
     C                     CALL 'PKLTSRR'              90  Tst Select kill
     C                     PARM *BLANK    W0RTN   7
     C           #1HMNB    PARM #1HMNB    WQ0063  30       BOH Company Num
     C           #1BNNB    PARM #1BNNB    WQ0064  70       BOH Buy Order N
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKLTSRR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C           W0RTN     ANDNE'Y2U0016'
     C                     SETON                     993132*
     C                     END
      *
     C           #1HMNB    IFNE *ZERO                      BOH Company Num
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      *
     C           #1BNNB    IFNE *ZERO                      BOH Buy Order N
     C           YPMTFD    ANDNE*BLANK
     C           W0RTN     ANDEQ*BLANK
     C                     MOVEL'*DONE'   YPMTFD
     C                     END
      * Defer confirm
     C                     MOVEL'Y'       W0DCF   1
      * No value selected, exit
     C           W0RTN     IFNE *BLANK
     C           YPMTFD    ANDEQ*BLANK
     C                     GOTO VEEXIT
     C                     END
     C                     END
      *................................................................
      * If all low order keys not entered, exit
     C           #1HMNB    IFEQ *ZERO                      BOH Company Num
     C           #1BNNB    ANDEQ*ZERO                      BOH Buy Order N
     C                     GOTO VEEXIT
     C                     END
      *
     C           KLVEAW    KLIST
     C                     KFLD           AWHMNB           BOH Company Num
     C                     KFLD           AWBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADD#1HMNB    AWHMNB
     C                     Z-ADD#1BNNB    AWBNNB
     C           KLVEAW    CHAIN@AWCPBI              9091  *
     C           *IN90     IFEQ '0'
      * Record found - move back any virtuals
     C                     GOTO VEEXIT
     C                     END
     C           YPMTFD    IFNE *BLANK
     C                     SETOF                     9091
     C                     GOTO VEEXIT
     C                     END
      * Send message 'Buy Order Header       NF'
     C                     MOVEL'PRK0049' ZAMSID
     C                     EXSR ZASNMS
     C                     MOVEL'PRK0049' W0RTN
      *================================================================
     CSR         VEEXIT    ENDSR
      /EJECT
     CSR         Y0SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y0EXIT    ENDSR
      /EJECT
     CSR         Y1SET     BEGSR
      *================================================================
      * Set cursor by *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y1EXIT    ENDSR
      /EJECT
     CSR         Y8TST     BEGSR
      *================================================================
      * Test cursor
      *================================================================
     C           @#DFMT    IFEQ '#RCDKEY'
      * KEY Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
     C           @#DFMT    IFEQ '#RCDDTL1'
      * DETAIL Screen
     C                     Z-ADD@#RWCL    ZINPOS  50
     C           ZINPOS    DIV  256       W0CRW
     C                     MVR            W0CCL
     C                     ENDIF
      *================================================================
     CSR         Y8EXIT    ENDSR
      /EJECT
     CSR         Y9CLR     BEGSR
      *================================================================
      * Clear *SET CURSOR data
      *================================================================
      *================================================================
     CSR         Y9EXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZDVPMT    BEGSR
      *================================================================
      * Process prompt request
      *================================================================
      *
      * Initialise prompt workfields
     C                     MOVEL*BLANK    YPMTFD 10
     C                     Z-ADD*ZERO     YAFSCH  40
     C                     Z-ADD*ZERO     YPMRRN  40
      *
     C           *IN04     IFEQ '1'
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50
     C                     MVR            ZHCSCL  50
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
     C           ZHCSRW    IFEQ 004
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE027
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1HMNB'  YPMTFD           BOH Company Num
     C                     END
      *
     C           ZHCSRW    IFEQ 005
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1BNNB'  YPMTFD           BOH Buy Order N
     C                     END
      *
     C           ZHCSRW    IFEQ 006
     C           ZHCSCL    ANDGE025
     C           ZHCSCL    ANDLE029
     C           @#DFMT    ANDEQ'#RCDKEY'
     C                     MOVEL'#1BONB'  YPMTFD           BOL Load Number
     C                     END
      *
     C           ZHCSRW    IFEQ 009
     C           ZHCSCL    ANDGE030
     C           ZHCSCL    ANDLE032
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1BNCD'  YPMTFD           TRK Trucker Cod
     C                     END
      *
     C           ZHCSRW    IFEQ 012
     C           ZHCSCL    ANDGE030
     C           ZHCSCL    ANDLE031
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1CMST'  YPMTFD           BOL Freight UOM
     C                     END
      *
     C           ZHCSRW    IFEQ 013
     C           ZHCSCL    ANDEQ030
     C           @#DFMT    ANDEQ'#RCDDTL1'
     C           *IN79     ANDEQ'0'
     C                     MOVEL'#1O8ST'  YPMTFD           BOL Freight Exp
     C                     END
      *
     C           YPMTFD    IFEQ *BLANK
      * Error if user defined prompting is not specified.
     C           W0PMT     IFEQ 'N'
     C                     MOVEL'*NONE'   YPMTFD
     C                     MOVEL'Y'       W0HLP   1
     C                     MOVEL'Y'       ZAFSMS
      * Send error message.
     C                     MOVEL'Y2U0101' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     END
     C                     END
      *
     C                     END
      *================================================================
     CSR         ZDEXIT    ENDSR
      /EJECT
     CSR         ZHHPKY    BEGSR
      *================================================================
      * Display HELP text
      *================================================================
      * Signal help request
     C                     MOVEL'Y'       W0HLP   1
      *
      * Extract cursor row and column
     C           @#RWCL    DIV  256       ZHCSRW  50       Row
     C                     MVR            ZHCSCL  50       Column
      *
      * Save cursor position for redisplay
     C                     Z-ADDZHCSRW    ZZCSRW  30       Row
     C                     Z-ADDZHCSCL    ZZCSCL  30       Column
      *
      *
     C                     CALL 'YDDSHPR'
     C                     PARM 'PKLZE1RH'W0HPMB 10        Help text sourc
     C                     PARM *BLANK    YYHPFL 10        Help text file
     C                     PARM *BLANK    YYHPLB 10        Help text libra
     C                     PARM           W0RTN   7
     C                     PARM '*CSRLOC' YYHLVN 10        Help label
     C                     PARM '*NORMAL' YYUSOP 10        Options
     C                     PARM ZHCSRW    YYRW    50       Row
     C                     PARM ZHCSCL    YYCL    50       Column
     C                     PARM 1         YYLGCT  50       # of grps
     C                     PARM W0GRP     YYLGVN 10        Label grps
      *
      * Clear set cursor DDS indicator
     C  N94                MOVEL'OFF'     WCSRLC
     C  N94                SETON                     94    *
      *================================================================
     CSR         ZHEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Cancel and exit from key screen
      *================================================================
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     MOVEL*BLANK    P2ABCD           PD Producer Cod
     C                     MOVEL*BLANK    P5IXST           SR Type
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field Tattoo is paid Usr
     C                     MOVEL*BLANK    WUNPST  1
      * Define work field Held Over Records Y/N
     C                     MOVEL*BLANK    WUNFST  1
      * Define work field Tot Frt Spdb aft pay Usr
     C                     Z-ADD*ZERO     WUK4PR  72
      * Define work field BOL Trucker Payment Sts
     C                     MOVEL*BLANK    WUCNST  2
      * Define work field Payments Processed  USR
     C                     MOVEL*BLANK    WUI4ST  1
      * Define work field Protect Movement Nbr  usr
     C                     MOVEL*BLANK    WUSYST  1
      * Define work field @Status (Yes/No)
     C                     MOVEL*BLANK    WUABST  1
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Movement number old  USR
     C                     Z-ADD*ZERO     WUMVOL  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field PD Std Truck Size
     C                     Z-ADD*ZERO     WUAMNB  50
      * Define work field SR Source Code
     C                     MOVEL*BLANK    WUAACD  3
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field SR Type
     C                     MOVEL*BLANK    WUIXST  1
      * Define work field Return Code USR
     C                     MOVEL*BLANK    WULMST  7
      * Define work field Scheduled Kill Dt 8.0 USR
     C                     Z-ADD*ZERO     WUSHDT  80
      * Define work field Record Found USR
     C                     MOVEL*BLANK    WUH7ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBHONB           CC Company Numb
     C                     Z-ADD*ZERO     WBBOMV           BOLW Movement N
     C                     Z-ADD*ZERO     WBBOSW           BOLW Scale Weig
     C                     Z-ADD*ZERO     WBDQDT           BOLW Scale Weig
     C                     Z-ADD*ZERO     WBA2TM           BOLW Scale Weig
     C                     Z-ADD*ZERO     WBHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WBBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WBBONB           BOL Load Number
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Clear all neither parameters
      * Crt Buy Order Load Ref CR - Buy Order Load Reference  * 
     C                     Z-ADD*ZERO     WCAADT           RS Date Changed
     C                     Z-ADD*ZERO     WCAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WCABDT           RS Date Added
     C                     Z-ADD*ZERO     WCABTM           RS Time Added
      * Define work field System Value Alpha    USR
     C                     MOVEL*BLANK    WUKBTX 40
      * Define work field Farm site Name f/ HPS USR
     C                     MOVEL*BLANK    WUKQTX 25
      * Define work field Farm Site USR
     C                     Z-ADD*ZERO     WUETNB  50
      * Define work field HPS FS Comp Relation USR
     C                     MOVEL*BLANK    WUG4CD  5
      * Define work field State
     C                     MOVEL*BLANK    WUDRTX  3
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHONB           CC Company Numb
     C                     Z-ADD*ZERO     WDE0DT           DSH Kill Date
     C                     Z-ADD*ZERO     WDE9DT           DT Delivery Dat
     C                     Z-ADD*ZERO     WDAJTH           DT Delivery Tim
     C                     Z-ADD*ZERO     WDH4A1           DT Delivery Tim
     C                     Z-ADD*ZERO     WDFXDT           DT Actual Kill
     C                     Z-ADD*ZERO     WDJIA1           DT Actual Deliv
     C                     Z-ADD*ZERO     WDIBA1           DT Scheduled Ho
     C                     Z-ADD*ZERO     WDICA1           DT Farm Site Co
     C                     Z-ADD*ZERO     WDIDA1           DT Delivered He
     C                     Z-ADD*ZERO     WDIPA1           DT Delivered We
     C                     Z-ADD*ZERO     WDIEA1           DT Movement Num
     C                     Z-ADD*ZERO     WDFADT           DT Transprtn Of
     C                     Z-ADD*ZERO     WDAKTH           DT Transprtn Of
     C                     Z-ADD*ZERO     WDBYTH           DT Arrive@Frm v
     C                     Z-ADD*ZERO     WDFBDT           DT Route Start
     C                     Z-ADD*ZERO     WDALTH           DT Route Start
     C                     Z-ADD*ZERO     WDBVTH           DT Route Start
     C                     Z-ADD*ZERO     WDAMTH           DT Wait @ Trans
     C                     Z-ADD*ZERO     WDFCDT           DT Arrive @ Far
     C                     Z-ADD*ZERO     WDANTH           DT Arrive @ Far
     C                     Z-ADD*ZERO     WDBHTH           DT Drive Time T
     C                     Z-ADD*ZERO     WDFDDT           DT Start Loadin
     C                     Z-ADD*ZERO     WDAOTH           DT Start Loadin
     C                     Z-ADD*ZERO     WDBWTH           DT Start Loadin
     C                     Z-ADD*ZERO     WDAPTH           DT Wait @ Farm
     C                     Z-ADD*ZERO     WDFEDT           DT Frm End Load
     C                     Z-ADD*ZERO     WDAQTH           DT Frm End Load
     C                     Z-ADD*ZERO     WDARTH           DT Load Time
     C                     Z-ADD*ZERO     WDFFDT           DT Leave Farm D
     C                     Z-ADD*ZERO     WDASTH           DT Leave Farm T
     C                     Z-ADD*ZERO     WDATTH           DT Wait-Depart
     C                     Z-ADD*ZERO     WDFGDT           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WDAUTH           DT Plt TrkWsh A
     C                     Z-ADD*ZERO     WDFHDT           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WDAVTH           DT Arrive @ Pla
     C                     Z-ADD*ZERO     WDAWTH           DT Wait @ TrkWs
     C                     Z-ADD*ZERO     WDBKTH           DT Drive Time T
     C                     Z-ADD*ZERO     WDBLTH           DT Delv Time Va
     C                     Z-ADD*ZERO     WDFIDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WDAXTH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WDAYTH           DT Wait @ TrkSc
     C                     Z-ADD*ZERO     WDFJDT           DT To Recv Dock
     C                     Z-ADD*ZERO     WDAZTH           DT To Recv Dock
     C                     Z-ADD*ZERO     WDA0TH           DT Wait-Rcv Doc
     C                     Z-ADD*ZERO     WDFKDT           DT Start Unload
     C                     Z-ADD*ZERO     WDA1TH           DT Start Unload
     C                     Z-ADD*ZERO     WDA2TH           DT Wait @ Rcv D
     C                     Z-ADD*ZERO     WDFLDT           DT End Unload D
     C                     Z-ADD*ZERO     WDA3TH           DT End Unload T
     C                     Z-ADD*ZERO     WDA4TH           DT Unload Time
     C                     Z-ADD*ZERO     WDBTTH           DT Unload Varia
     C                     Z-ADD*ZERO     WDFMDT           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WDA5TH           DT TrkScl Weigh
     C                     Z-ADD*ZERO     WDA6TH           DT Wait Time @
     C                     Z-ADD*ZERO     WDBXTH           DT Formula Wait
     C                     Z-ADD*ZERO     WDFYDT           DT Unused Date
     C                     Z-ADD*ZERO     WDB0TH           DT Unused Time
     C                     Z-ADD*ZERO     WDBZTH           DT Unused Wait
     C                     Z-ADD*ZERO     WDH2A1           DSD Scheduled D
     C                     Z-ADD*ZERO     WDJ2A1           DT Head Receive
     C                     Z-ADD*ZERO     WDJ3A1           DT Weight Recei
     C                     Z-ADD*ZERO     WDKMA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WDJ4A1           DT Head DOA
     C                     Z-ADD*ZERO     WDJ5A1           DT Weight DOA
     C                     Z-ADD*ZERO     WDJ6A1           DT Head Yard De
     C                     Z-ADD*ZERO     WDJ7A1           DT Weight Yard
     C                     Z-ADD*ZERO     WDJ8A1           DT Head Condemn
     C                     Z-ADD*ZERO     WDJ9A1           DT Weight Conde
     C                     Z-ADD*ZERO     WDKAA1           DT Head Held Ov
     C                     Z-ADD*ZERO     WDKBA1           DT Weight Held
     C                     Z-ADD*ZERO     WDKCA1           DT Head Killed
     C                     Z-ADD*ZERO     WDKDA1           DT Weight Kille
     C                     Z-ADD*ZERO     WDKEA1           DT Head Market
     C                     Z-ADD*ZERO     WDKFA1           DT Weight Marke
     C                     Z-ADD*ZERO     WDKNA1           DT Avg Weight M
     C                     Z-ADD*ZERO     WDKGA1           DT Head Resale
     C                     Z-ADD*ZERO     WDKHA1           DT Weight Resal
     C                     Z-ADD*ZERO     WDKOA1           DT Avg Weight R
     C                     Z-ADD*ZERO     WDKIA1           DT Head Unused
     C                     Z-ADD*ZERO     WDKJA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WDKKA1           DT Head Unused
     C                     Z-ADD*ZERO     WDKLA1           DT Weight Unuse
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Define work field BOL IN  record found  USR
     C                     MOVEL*BLANK    WUSWST  1
      * Define work field BOL OUT record found  USR
     C                     MOVEL*BLANK    WUSXST  1
      * Define work field PD VND Address Number
     C                     Z-ADD*ZERO     WUGCNB  80
      * Define work field M3 Supplier ID
     C                     MOVEL*BLANK    WUQHCD 10
      * Flag no *SET CURSOR in the program
     C                     MOVE 'N'       YSETCS  1
     C                     MOVE *BLANK    WCSRLC  3
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    YRSW00  50       *Synon (5,0) wo
     C                     Z-ADD*ZEROS    YRSW01  50       *Synon (5,0) wo
     C                     MOVEL*BLANKS   W0CFL  10        *Cursor field
     C                     Z-ADD*ZEROS    W0CRW   50       *Cursor row
     C                     Z-ADD*ZEROS    W0CCL   50       *Cursor column
      * Move main file information to JOB context
     C                     MOVE @1FFL     ZZFFL  10        Main file name
     C                     MOVE @1FLB     ZZFLB  10        Main file lib
     C                     MOVE @1FMB     ZZFMB  10        Main file mbr
     C                     CALL 'Y2QLVNR'
     C                     PARM           ZZFFL  10
     C                     PARM           ZZFLB  10
     C                     PARM           ZZFQL  21        LIBRARY/FILE
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define null work field TRK Sts
     C                     MOVEL*BLANK    YN0001  1
      * Define null work field TRK VND Address Number
     C                     Z-ADD*ZERO     YN0002  80
      * Define null work field TRK M3 Supplier Id
     C                     MOVEL*BLANK    YN0003 10
      * Define local work field RS Record Status
     C                     MOVEL*BLANK    YL0001  1
      * Define local work field No Gate Flag
     C                     MOVEL*BLANK    YL0002 40
      * Define local work field BOL Ref 1 Old
     C                     MOVEL*BLANK    YL0003 10
      * Define local work field BOL Ref 2 Old
     C                     MOVEL*BLANK    YL0004 10
      * Define local work field BOL Ref Status Old
     C                     MOVEL*BLANK    YL0005  2
      * Define null work field RS Record Status
     C                     MOVEL*BLANK    YN0004  1
      * Define local work field Protect Ref fields
     C                     MOVEL*BLANK    YL0006  1
      * Define null work field TRK Name
     C                     MOVEL*BLANK    YN0005 40
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0007  1
      * Define local work field Scheduled Head USR
     C                     Z-ADD*ZERO     YL0008  50
      * Define local work field MTech Live Yes or No
     C                     MOVEL*BLANK    YL0009  1
      * Define null work field HPS Farm County
     C                     MOVEL*BLANK    YN0006 25
      * Define null work field HPS Cell Manager Code USR
     C                     MOVEL*BLANK    YN0007  5
      * Define null work field HPS Cell Manager Nm USR
     C                     MOVEL*BLANK    YN0008 25
      * Define null work field MTech Farm Site Ref
     C                     MOVEL*BLANK    YN0009 20
      * Define null work field MTech Cell Manager Ref
     C                     MOVEL*BLANK    YN0010 20
      * Define local work field Text 7 USR
     C                     MOVEL*BLANK    YL0010  7
      * Define local work field Amount USR
     C                     Z-ADD*ZERO     YL0011  70
      * *DTAARA = *COMPANY N
     C           *NAMVAR   DEFN YYCOTXA   ##CMP
     C                     IN   *NAMVAR
      *................................................................
     C                     MOVEL'CHG'     W0PMD   3
     C                     MOVEL*BLANK    W0GRP   1
      * USER: Initialize program
      * History changes
     C                     EXSR UBSUBR                     History changes
      * Mov ApplN to Company  US - STR User Source Functions  * 
     C***   MOVE USER SOURCE                      ***
     C                     MOVELP3EVTX    ##CMP
      * E2423 Mtech Live or Not Live *** Interfaces to HPS ***
      * Get the MTech Live Yes or No
     C                     EXSR UCSUBR                     Get the MTech L
      * E10812 - Get Company Value NOGATE
      * Rtv Company Values    XF - STR Order Management Sys  * NOGATE
     C                     CALL 'PDGKXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM P1HMNB    WQ0068  30       BOH Company Num
     C                     PARM 'NOGATE'  WQ0069 10        Company Value C
     C           YL0002    PARM *BLANK    WQ0070 40        System Value Al
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDGKXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Rtv Prdcr Vendor#,Src RT - Producer  * 
     C                     EXSR TDRVGN
      * Rtv Source Type       RT - Source  * 
     C                     EXSR TFRVGN
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 MTECHLIVE
