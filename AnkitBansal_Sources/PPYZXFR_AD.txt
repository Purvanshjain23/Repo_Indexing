// ?------------------------------------------------------------------------------------------------
// ?Synon action diagram for PPYZXFR
// ?Date: 14.08.2025 Time: 03:42:23
// ?------------------------------------------------------------------------------------------------

//?Execute user function

//?** Company Number is NOT passed in - this program loops thru all comps
//?03/29/17 DN R9700-Will Now Read All Company by Inter Company Group.
// LCL.Company Number ReadW UsR = CON.*ZERO
LCL.Company_Number_ReadW_UsR = *ZERO;

// LCL.Company Number ProcW Usr = CON.*ZERO
LCL.Company_Number_ProcW_Usr = *ZERO;

//?03/29/17 DN R9700-Commented out & Moved/Changed Below to Support IC Group.
//?03/29/17 DN R9700-Process by Inter Company Group.
CASE;

// IF *OTHERWISE
IF *OTHERWISE;

// LCL.End of IC Grp Process USR = CND.Blank
LCL.End_of_IC_Grp_Process_USR = *BLANK;

// Call program Rtv Next IC Group Cmp XF.
CALL PROGRAM(Rtv Next IC Group Cmp XF) ('PUBPXFR');
PARAMETER(PAR.Inter_Company_Group_USR);
PARAMETER(LCL.Company_Number_ReadW_UsR);
PARAMETER(LCL.Company_Number_ProcW_Usr);
PARAMETER(LCL.End_of_IC_Grp_Process_USR);

//?** Loop Through All Plant Companies By Inter Company Group.
// DOW NOT LCL.End of IC Grp Process USR is Yes
DOW ! LCL.End_of_IC_Grp_Process_USR = 'Y';

//?Build Parameters and Submit the IC Exception Report.
CASE;

// IF *OTHERWISE
IF *OTHERWISE;

// PAR.Company Number Pass   USR = LCL.Company Number ProcW Usr
PAR.Company_Number_Pass_USR = LCL.Company_Number_ProcW_Usr;

// Call program PRT Invoice Excpt Rpt  UP.
CALL PROGRAM(PRT Invoice Excpt Rpt  UP) ('PPXZUPC');
PARAMETER(PGM.*Return_code);
PARAMETER(PAR.Application_Code);
PARAMETER(PAR.Billing_Activity_Type);
PARAMETER(PAR.PRT_Description);
PARAMETER(PAR.PRT_Printer_Device);
PARAMETER(PAR.PRT_Hold_Output_Sts);
PARAMETER(PAR.PRT_Save_Output_Sts);
PARAMETER(PAR.PRT_Night_Queue_Run_Sts);
PARAMETER(PAR.PRT_Night_Queue);
PARAMETER(PAR.Company_Number_Pass_USR);
PARAMETER(PAR.Thru_Date_Pass_USR);
PARAMETER(PAR.Order_Number_1_PASS_USR);
PARAMETER(PAR.Order_Number_2_PASS_USR);
PARAMETER(PAR.System_Value_Numeric);
PARAMETER(PAR.Status_Y_or_N);
PARAMETER(PAR.Process_Cust_Types_Usr);
PARAMETER(PAR.Job_Name);

CASE;

// IF PGM.*Return code is *Normal
IF PGM.*Return_code = *BLANK;

// Send information message - 'Print has been submitted.'
MESSAGE(USR1832 *INFO);

// IF *OTHERWISE
IF *OTHERWISE;

// PGM.*Return code = CND.*Normal
PGM.*Return_code = *BLANK;

ENDIF;

ENDIF;

// LCL.Company Number ReadW UsR = LCL.Company Number ProcW Usr
LCL.Company_Number_ReadW_UsR = LCL.Company_Number_ProcW_Usr;

// Call program Rtv Next IC Group Cmp XF.
CALL PROGRAM(Rtv Next IC Group Cmp XF) ('PUBPXFR');
PARAMETER(PAR.Inter_Company_Group_USR);
PARAMETER(LCL.Company_Number_ReadW_UsR);
PARAMETER(LCL.Company_Number_ProcW_Usr);
PARAMETER(LCL.End_of_IC_Grp_Process_USR);

ENDDO;

ENDIF;

