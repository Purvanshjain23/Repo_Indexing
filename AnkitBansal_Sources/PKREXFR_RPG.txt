     H/TITLE Clc Ded/Add/Net Pay   XF  Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : HPEDEVMDL
     H* System        : HPEDEVMDL
     H* User name     : ISDREDD
     H* Date          : 12/17/20  Time  : 00:47:26
     H* Copyright     : HPEDEVMDL
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FPKA1CPL0IF  E           K        DISK
      * RTV : Tattoo Header             Retrieval index
      *
     FPKBBREL0IF  E           K        DISK
      * RTV : Deduction/Addition        Retrieval index
      *
     FPKDZREL1IF  E           K        DISK
      * RTV : Tattoo Defect             Retrieval index
      *
     FPKA7REL1IF  E           K        DISK
      * RTV : Hog Defect                Retrieval index
      *
     FPKDNCPL1IF  E           K        DISK
      * RTV : Tattoo Header EXT         Retrieval index
      *
     FPLASREL1IF  E           K        DISK
      * RTV : Producer Site Mileage     Retrieval index
      *
     FPKBBREL3IF  E           K        DISK
      * RTV : Deduction/Addition        Plant Trans Active Only
      *
     FPKAXCPL0IF  E           K        DISK
      * RTV : Buy Order Load            Retrieval index
      *
     FPKBEREL2IF  E           K        DISK
      * RSQ : Producer Std D/A          Active Std D/A only
      *
     FPKBBREL2IF  E           K        DISK
      * RTV : Deduction/Addition        Active Codes only
      *
     FPKAWCPL1IF  E           K        DISK
      * RTV : Buy Order Header          Retrieval index
      *
     FPKA1CPLFIF  E           K        DISK
      * RSQ : Tattoo Header             Co/BOL/Kill/Ttt
      *
     FPKCDCPL5IF  E           K        DISK
      * RSQ : Tattoo Ded/Add            Co/BOL, reimb hd>0
      *
     FPKA1CPNDIF  E           K        DISK
      * RTV : Tattoo Header             Retrieval Index 2
      *
     FPKAQCPL0IF  E           K        DISK
      * RTV : Producer Sub-Contract     Retrieval index
      *
     FPKECCPL1IF  E           K        DISK
      * RTV : Producer SC Floor Price   Retrieval index
      *
     FPKEECPL0IF  E           K        DISK
      * RTV : Producer Cntrct RsvAct Hd Retrieval index
      *
     FPLAPREL2IF  E           K        DISK
      * RSQ : Producer Loc Std D/A      Active Std D/A only
      *
     FPKCDCPL1IF  E           K        DISK
      * RTV : Tattoo Ded/Add            Retrieval index
      *
     FPKA1CPL1UF  E           K        DISK
      * UPD : Tattoo Header             Update index
      *
     FPKCDCPL0IF  E           K        DISK                      A
      * UPD : Tattoo Ded/Add            Update index
      *
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     E                    YDOW        7  1               *Days of week
     I@A1CPC4
      * Tattoo Header             Retrieval index
      * Renamed input format fields
     I              A1HMNB                          WAHMNB
     I              A1BNNB                          WABNNB
     I              A1BONB                          WABONB
     I              A1CVNB                          WACVNB
     I              A1B0DT                          WAB0DT
     I              A1AWDT                          WAAWDT
     I              A1BICD                          WABICD
     I              A1CPST                          WACPST
     I              A1ACPR                          WAACPR
     I              A1B9PR                          WAB9PR
     I              A1CAPR                          WACAPR
     I              A1C4ST                          WAC4ST
     I              A1AIPR                          WAAIPR
     I              A1A6DT                          WAA6DT
     I              A1C2ST                          WAC2ST
     I              A1CXNB                          WACXNB
     I              A1CWNB                          WACWNB
     I              A1FCNB                          WAFCNB
     I              A1H9NB                          WAH9NB
     I              A1FDNB                          WAFDNB
     I              A1FENB                          WAFENB
     I              A1HENB                          WAHENB
     I              A1HFNB                          WAHFNB
     I              A1CYNB                          WACYNB
     I              A1LRNB                          WALRNB
     I              A1E0NB                          WAE0NB
     I              A1A5PC                          WAA5PC
     I              A1FBNB                          WAFBNB
     I              A1A4PC                          WAA4PC
     I              A1F7NB                          WAF7NB
     I              A1HDNB                          WAHDNB
     I              A1F5NB                          WAF5NB
     I              A1F4NB                          WAF4NB
     I              A1F3NB                          WAF3NB
     I              A1F2NB                          WAF2NB
     I              A1AVPC                          WAAVPC
     I              A1AWPC                          WAAWPC
     I              A1CWPC                          WACWPC
     I              A1A8PC                          WAA8PC
     I              A1A7PC                          WAA7PC
     I              A1B8PR                          WAB8PR
     I              A1AMPR                          WAAMPR
     I              A1ANPR                          WAANPR
     I              A1AYVA                          WAAYVA
     I              A1AWVA                          WAAWVA
     I              A1AOPR                          WAAOPR
     I              A1AXVA                          WAAXVA
     I              A1APPR                          WAAPPR
     I              A1ASPR                          WAASPR
     I              A1A4VA                          WAA4VA
     I              A1ATPR                          WAATPR
     I              A1A5VA                          WAA5VA
     I              A1CBPR                          WACBPR
     I              A1CCPR                          WACCPR
     I              A1LPNB                          WALPNB
     I              A1CDPR                          WACDPR
     I              A1A7VA                          WAA7VA
     I              A1A2PR                          WAA2PR
     I              A1JWST                          WAJWST
     I              A1CWST                          WACWST
     I              A1D7ST                          WAD7ST
     I              A1D8ST                          WAD8ST
     I              A1DWST                          WADWST
     I              A1D6ST                          WAD6ST
     I              A1GHNB                          WAGHNB
     I              A1BYDT                          WABYDT
     I              A1E0ST                          WAE0ST
     I              A1E1ST                          WAE1ST
     I              A1E2ST                          WAE2ST
     I              A1BSDT                          WABSDT
     I              A1BTDT                          WABTDT
     I              A1BUDT                          WABUDT
     I              A1HGNB                          WAHGNB
     I              A1HHNB                          WAHHNB
     I              A1HINB                          WAHINB
     I              A1A3PR                          WAA3PR
     I              A1A4PR                          WAA4PR
     I              A1A6PR                          WAA6PR
     I              A1J9NB                          WAJ9NB
     I              A1D6PR                          WAD6PR
     I              A1D7PR                          WAD7PR
     I              A1D8PR                          WAD8PR
     I              A1D9PR                          WAD9PR
     I              A1EAPR                          WAEAPR
     I              A1EBPR                          WAEBPR
     I              A1ECPR                          WAECPR
     I              A1EDPR                          WAEDPR
     I              A1EEPR                          WAEEPR
     I              A1EFPR                          WAEFPR
     I              A1EGPR                          WAEGPR
     I              A1EHPR                          WAEHPR
     I              A1KAST                          WAKAST
     I              A1J7ST                          WAJ7ST
     I              A1J9ST                          WAJ9ST
     I              A1OXNB                          WAOXNB
     I              A1LKST                          WALKST
     I              A1LLST                          WALLST
     I              A1J8ST                          WAJ8ST
     I              A1LIST                          WALIST
     I              A1LJST                          WALJST
     I              A1NZTX                          WANZTX
     I              A1HJCD                          WAHJCD
     I              A1R4ST                          WAR4ST
     I              A1R5ST                          WAR5ST
     I              A1R6ST                          WAR6ST
     I              A1R7ST                          WAR7ST
     I              A1THWT                          WATHWT
     I              A1T2WT                          WAT2WT
     I              A1THHD                          WATHHD
     I              A1T2HD                          WAT2HD
     I              A1OBPR                          WAOBPR
     I              A1KOER                          WAKOER
     I              A1OPIR                          WAOPIR
     I              A1OPEM                          WAOPEM
     I              A1IORP                          WAIORP
     I              A1OWEO                          WAOWEO
     I              A1OQET                          WAOQET
     I              A1URST                          WAURST
     I              A1USST                          WAUSST
     I              A1HHPC                          WAHHPC
     I              A1S9PR                          WAS9PR
     I              A1TAPR                          WATAPR
     I              A1TBPR                          WATBPR
     I              A1JFUR                          WAJFUR
     I              A1KRIF                          WAKRIF
     I              A1KORF                          WAKORF
     I              A1KAPR                          WAKAPR
     I              A1KROT                          WAKROT
     I              A1OTJG                          WAOTJG
     I              A1IRJG                          WAIRJG
     I              A1IMJF                          WAIMJF
     I              A1IRGF                          WAIRGF
     I              A1KRJF                          WAKRJF
     I              A1OJRF                          WAOJRF
     I              A1KFOR                          WAKFOR
     I              A1ORJK                          WAORJK
     I              A1OMVJ                          WAOMVJ
     I              A1MVNF                          WAMVNF
     I              A1MCNF                          WAMCNF
     I              A1NCNF                          WANCNF
     I              A1NCHF                          WANCHF
     I              A1IGIR                          WAIGIR
     I              A1KFJR                          WAKFJR
     I              A1EADT                          WAEADT
     I              A1EBDT                          WAEBDT
     I              A1ECDT                          WAECDT
     I              A1EDDT                          WAEDDT
     I              A1EEDT                          WAEEDT
     I              A1U4ST                          WAU4ST
     I              A1U5ST                          WAU5ST
     I              A1U6ST                          WAU6ST
     I              A1U7ST                          WAU7ST
     I              A1U8ST                          WAU8ST
     I              A1U9ST                          WAU9ST
     I              A1VAST                          WAVAST
     I              A1VBST                          WAVBST
     I              A1BDCD                          WABDCD
     I              A1CSCD                          WACSCD
     I              A1ABCD                          WAABCD
     I              A1AECD                          WAAECD
     I              A1ACCD                          WAACCD
     I              A1AGCD                          WAAGCD
     I              A1BECD                          WABECD
     I              A1AAVN                          WAAAVN
     I              A1AADT                          WAAADT
     I              A1AMTM                          WAAMTM
     I              A1AJST                          WAAJST
     I              A1AHVN                          WAAHVN
     I              A1AGVN                          WAAGVN
     I              A1ABVN                          WAABVN
     I              A1ABDT                          WAABDT
     I              A1ABTM                          WAABTM
      *
     I@BBRED5
      * Deduction/Addition        Retrieval index
      * Renamed input format fields
     I              BBBQCD                          WBBQCD
     I              BBBLTX                          WBBLTX
     I              BBB9ST                          WBB9ST
     I              BBCAST                          WBCAST
     I              BBAEPR                          WBAEPR
     I              BBI9ST                          WBI9ST
     I              BBCBST                          WBCBST
     I              BBI2ST                          WBI2ST
     I              BBF7TX                          WBF7TX
     I              BBE2CD                          WBE2CD
     I              BBOTNB                          WBOTNB
     I              BBNSST                          WBNSST
     I              BBNTST                          WBNTST
     I              BBNUST                          WBNUST
     I              BBNVST                          WBNVST
     I              BBNWST                          WBNWST
     I              BBNXST                          WBNXST
     I              BBNYST                          WBNYST
     I              BBNZST                          WBNZST
     I              BBN1ST                          WBN1ST
     I              BBN0ST                          WBN0ST
     I              BBRICD                          WBRICD
     I              BBRJCD                          WBRJCD
     I              BBBAT1                          WBBAT1
     I              BBBBT1                          WBBBT1
     I              BBAAVN                          WBAAVN
     I              BBAADT                          WBAADT
     I              BBAMTM                          WBAMTM
     I              BBAJST                          WBAJST
     I              BBAHVN                          WBAHVN
     I              BBAGVN                          WBAGVN
     I              BBABVN                          WBABVN
     I              BBABDT                          WBABDT
     I              BBABTM                          WBABTM
      *
     I@A1CPC5
      * Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     I@DZREX3
      * Tattoo Defect             Retrieval index
      * Renamed input format fields
     I              DZHMNB                          WDHMNB
     I              DZBNNB                          WDBNNB
     I              DZBONB                          WDBONB
     I              DZCVNB                          WDCVNB
     I              DZB0DT                          WDB0DT
     I              DZBDCD                          WDBDCD
     I              DZLJNB                          WDLJNB
     I              DZBECD                          WDBECD
     I              DZB7SS                          WDB7SS
     I              DZB8SS                          WDB8SS
     I              DZB9SS                          WDB9SS
     I              DZCASS                          WDCASS
     I              DZNXA1                          WDNXA1
     I              DZNYA1                          WDNYA1
     I              DZNZA1                          WDNZA1
     I              DZAAVN                          WDAAVN
     I              DZAADT                          WDAADT
     I              DZAMTM                          WDAMTM
     I              DZAJST                          WDAJST
     I              DZAHVN                          WDAHVN
     I              DZAGVN                          WDAGVN
     I              DZABVN                          WDABVN
     I              DZABDT                          WDABDT
     I              DZABTM                          WDABTM
      *
     I@A7REC1
      * Hog Defect                Retrieval index
      * Renamed input format fields
     I              A7BDCD                          WEBDCD
     I              A7BCTX                          WEBCTX
     I              A7RXST                          WERXST
     I              A7R2ST                          WER2ST
     I              A7RYST                          WERYST
     I              A7RZST                          WERZST
     I              A7R0ST                          WER0ST
     I              A7R1ST                          WER1ST
     I              A7HYCD                          WEHYCD
     I              A7HZCD                          WEHZCD
     I              A7VYST                          WEVYST
     I              A7AEA1                          WEAEA1
     I              A7UOPR                          WEUOPR
     I              A7UPPR                          WEUPPR
     I              A7UQPR                          WEUQPR
     I              A7AAVN                          WEAAVN
     I              A7AADT                          WEAADT
     I              A7AMTM                          WEAMTM
     I              A7AJST                          WEAJST
     I              A7AHVN                          WEAHVN
     I              A7AGVN                          WEAGVN
     I              A7ABVN                          WEABVN
     I              A7ABDT                          WEABDT
     I              A7ABTM                          WEABTM
      *
     I@DNCPUY
      * Tattoo Header EXT         Retrieval index
      * Renamed input format fields
     I              DNHMNB                          WFHMNB
     I              DNBNNB                          WFBNNB
     I              DNBONB                          WFBONB
     I              DNCVNB                          WFCVNB
     I              DNB0DT                          WFB0DT
     I              DNI5PR                          WFI5PR
     I              DNJBPR                          WFJBPR
     I              DNI6PR                          WFI6PR
     I              DNI7PR                          WFI7PR
     I              DNI8PR                          WFI8PR
     I              DNI9PR                          WFI9PR
     I              DNJAPR                          WFJAPR
     I              DNJCPR                          WFJCPR
     I              DNJDPR                          WFJDPR
     I              DNJEPR                          WFJEPR
     I              DNJFPR                          WFJFPR
     I              DNJGPR                          WFJGPR
     I              DNJHPR                          WFJHPR
     I              DNJIPR                          WFJIPR
     I              DNJJPR                          WFJJPR
     I              DNJKPR                          WFJKPR
     I              DNJLPR                          WFJLPR
     I              DNJMPR                          WFJMPR
     I              DNJNPR                          WFJNPR
     I              DNJOPR                          WFJOPR
     I              DNLTBF                          WFLTBF
     I              DNHZPC                          WFHZPC
     I              DNLTHW                          WFLTHW
     I              DNH0PC                          WFH0PC
     I              DNGTBF                          WFGTBF
     I              DNH1PC                          WFH1PC
     I              DNGTHW                          WFGTHW
     I              DNH2PC                          WFH2PC
     I              DNHLBF                          WFHLBF
     I              DNHLLE                          WFHLLE
     I              DNHLHW                          WFHLHW
     I              DNHLLP                          WFHLLP
     I              DNHGBF                          WFHGBF
     I              DNHGLE                          WFHGLE
     I              DNHGHW                          WFHGHW
     I              DNHFLP                          WFHFLP
     I              DNSNA1                          WFSNA1
     I              DNSOA1                          WFSOA1
     I              DNSPA1                          WFSPA1
     I              DNDGSS                          WFDGSS
     I              DNDHSS                          WFDHSS
     I              DNDISS                          WFDISS
     I              DNABCD                          WFABCD
     I              DNNYCD                          WFNYCD
     I              DNOVCD                          WFOVCD
     I              DNAAVN                          WFAAVN
     I              DNAADT                          WFAADT
     I              DNAMTM                          WFAMTM
     I              DNAJST                          WFAJST
     I              DNAHVN                          WFAHVN
     I              DNAGVN                          WFAGVN
     I              DNABVN                          WFABVN
     I              DNABDT                          WFABDT
     I              DNABTM                          WFABTM
      *
     I@ASREK9
      * Producer Site Mileage     Retrieval index
      * Renamed input format fields
     I              ASABCD                          WGABCD
     I              ASNYCD                          WGNYCD
     I              ASLKA1                          WGLKA1
     I              ASLLA1                          WGLLA1
     I              ASTITX                          WGTITX
     I              ASA0SS                          WGA0SS
     I              ASA1SS                          WGA1SS
     I              ASAAVN                          WGAAVN
     I              ASAADT                          WGAADT
     I              ASAMTM                          WGAMTM
     I              ASAJST                          WGAJST
     I              ASAHVN                          WGAHVN
     I              ASAGVN                          WGAGVN
     I              ASABVN                          WGABVN
     I              ASABDT                          WGABDT
     I              ASABTM                          WGABTM
      *
     I@BBREN3
      * Deduction/Addition        Plant Trans Active Only
      * Renamed input format fields
     I              BBBQCD                          WHBQCD
     I              BBBLTX                          WHBLTX
     I              BBB9ST                          WHB9ST
     I              BBCAST                          WHCAST
     I              BBAEPR                          WHAEPR
     I              BBI9ST                          WHI9ST
     I              BBCBST                          WHCBST
     I              BBI2ST                          WHI2ST
     I              BBF7TX                          WHF7TX
     I              BBE2CD                          WHE2CD
     I              BBOTNB                          WHOTNB
     I              BBNSST                          WHNSST
     I              BBNTST                          WHNTST
     I              BBNUST                          WHNUST
     I              BBNVST                          WHNVST
     I              BBNWST                          WHNWST
     I              BBNXST                          WHNXST
     I              BBNYST                          WHNYST
     I              BBNZST                          WHNZST
     I              BBN1ST                          WHN1ST
     I              BBN0ST                          WHN0ST
     I              BBRICD                          WHRICD
     I              BBRJCD                          WHRJCD
     I              BBBAT1                          WHBAT1
     I              BBBBT1                          WHBBT1
     I              BBAAVN                          WHAAVN
     I              BBAADT                          WHAADT
     I              BBAMTM                          WHAMTM
     I              BBAJST                          WHAJST
     I              BBAHVN                          WHAHVN
     I              BBAGVN                          WHAGVN
     I              BBABVN                          WHABVN
     I              BBABDT                          WHABDT
     I              BBABTM                          WHABTM
      *
     I@CDCPIT
      * Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WIHMNB
     I              CDBNNB                          WIBNNB
     I              CDBONB                          WIBONB
     I              CDCVNB                          WICVNB
     I              CDB0DT                          WIB0DT
     I              CDBQCD                          WIBQCD
     I              CDAZVA                          WIAZVA
     I              CDA0VA                          WIA0VA
     I              CDJBST                          WIJBST
     I              CDEIST                          WIEIST
     I              CDJDST                          WIJDST
     I              CDDPCD                          WIDPCD
     I              CDE3CD                          WIE3CD
     I              CDAQNB                          WIAQNB
     I              CDOCST                          WIOCST
     I              CDPEST                          WIPEST
     I              CDPFST                          WIPFST
     I              CDPGST                          WIPGST
     I              CDPIST                          WIPIST
     I              CDPJST                          WIPJST
     I              CDPKST                          WIPKST
     I              CDPLST                          WIPLST
     I              CDAAVN                          WIAAVN
     I              CDAADT                          WIAADT
     I              CDAMTM                          WIAMTM
     I              CDAJST                          WIAJST
     I              CDAHVN                          WIAHVN
     I              CDAGVN                          WIAGVN
     I              CDABVN                          WIABVN
     I              CDABDT                          WIABDT
     I              CDABTM                          WIABTM
      *
     I@AXCPBX
      * Buy Order Load            Retrieval index
      * Renamed input format fields
     I              AXHMNB                          WJHMNB
     I              AXBNNB                          WJBNNB
     I              AXBONB                          WJBONB
     I              AXCQDT                          WJCQDT
     I              AXABTH                          WJABTH
     I              AXACTH                          WJACTH
     I              AXBPNB                          WJBPNB
     I              AXCSNB                          WJCSNB
     I              AXAUDT                          WJAUDT
     I              AXCMST                          WJCMST
     I              AXAGPR                          WJAGPR
     I              AXATVA                          WJATVA
     I              AXI1ST                          WJI1ST
     I              AXDHNB                          WJDHNB
     I              AXDINB                          WJDINB
     I              AXCNST                          WJCNST
     I              AXGINB                          WJGINB
     I              AXBZDT                          WJBZDT
     I              AXLSNB                          WJLSNB
     I              AXF3TX                          WJF3TX
     I              AXO8ST                          WJO8ST
     I              AXO9ST                          WJO9ST
     I              AXPAST                          WJPAST
     I              AXLDSH                          WJLDSH
     I              AXPBST                          WJPBST
     I              AXPCST                          WJPCST
     I              AXPDST                          WJPDST
     I              AXUWST                          WJUWST
     I              AXUXST                          WJUXST
     I              AXUYST                          WJUYST
     I              AXJKRU                          WJJKRU
     I              AXKEOR                          WJKEOR
     I              AXIOEW                          WJIOEW
     I              AXKJIO                          WJKJIO
     I              AXIOJR                          WJIOJR
     I              AXEIRR                          WJEIRR
     I              AXITMF                          WJITMF
     I              AXODJE                          WJODJE
     I              AXRJIF                          WJRJIF
     I              AXOEJF                          WJOEJF
     I              AXD0DT                          WJD0DT
     I              AXD1DT                          WJD1DT
     I              AXD2DT                          WJD2DT
     I              AXD3DT                          WJD3DT
     I              AXD4DT                          WJD4DT
     I              AXBNCD                          WJBNCD
     I              AXABCD                          WJABCD
     I              AXAECD                          WJAECD
     I              AXAAVN                          WJAAVN
     I              AXAADT                          WJAADT
     I              AXAMTM                          WJAMTM
     I              AXAJST                          WJAJST
     I              AXAHVN                          WJAHVN
     I              AXAGVN                          WJAGVN
     I              AXABVN                          WJABVN
     I              AXABDT                          WJABDT
     I              AXABTM                          WJABTM
      *
     I@BERELS
      * Producer Std D/A          Active Std D/A only
      * Renamed input format fields
     I              BEABCD                          WKABCD
     I              BEZCA1                          WKZCA1
     I              BEBQCD                          WKBQCD
     I              BEEVST                          WKEVST
     I              BEA1VA                          WKA1VA
     I              BEJAST                          WKJAST
     I              BEC0DT                          WKC0DT
     I              BEC1DT                          WKC1DT
     I              BEN2ST                          WKN2ST
     I              BEN3ST                          WKN3ST
     I              BEN4ST                          WKN4ST
     I              BEN5ST                          WKN5ST
     I              BEN6ST                          WKN6ST
     I              BEN7ST                          WKN7ST
     I              BEN8ST                          WKN8ST
     I              BEN9ST                          WKN9ST
     I              BEOAST                          WKOAST
     I              BEOBST                          WKOBST
     I              BEAAVN                          WKAAVN
     I              BEAADT                          WKAADT
     I              BEAMTM                          WKAMTM
     I              BEAJST                          WKAJST
     I              BEAHVN                          WKAHVN
     I              BEAGVN                          WKAGVN
     I              BEABVN                          WKABVN
     I              BEABDT                          WKABDT
     I              BEABTM                          WKABTM
      *
     I@BBRELJ
      * Deduction/Addition        Active Codes only
      * Renamed input format fields
     I              BBBQCD                          WLBQCD
     I              BBBLTX                          WLBLTX
     I              BBB9ST                          WLB9ST
     I              BBCAST                          WLCAST
     I              BBAEPR                          WLAEPR
     I              BBI9ST                          WLI9ST
     I              BBCBST                          WLCBST
     I              BBI2ST                          WLI2ST
     I              BBF7TX                          WLF7TX
     I              BBE2CD                          WLE2CD
     I              BBOTNB                          WLOTNB
     I              BBNSST                          WLNSST
     I              BBNTST                          WLNTST
     I              BBNUST                          WLNUST
     I              BBNVST                          WLNVST
     I              BBNWST                          WLNWST
     I              BBNXST                          WLNXST
     I              BBNYST                          WLNYST
     I              BBNZST                          WLNZST
     I              BBN1ST                          WLN1ST
     I              BBN0ST                          WLN0ST
     I              BBRICD                          WLRICD
     I              BBRJCD                          WLRJCD
     I              BBBAT1                          WLBAT1
     I              BBBBT1                          WLBBT1
     I              BBAAVN                          WLAAVN
     I              BBAADT                          WLAADT
     I              BBAMTM                          WLAMTM
     I              BBAJST                          WLAJST
     I              BBAHVN                          WLAHVN
     I              BBAGVN                          WLAGVN
     I              BBABVN                          WLABVN
     I              BBABDT                          WLABDT
     I              BBABTM                          WLABTM
      *
     I@AWCPBI
      * Buy Order Header          Retrieval index
      * Renamed input format fields
     I              AWHMNB                          WMHMNB
     I              AWBNNB                          WMBNNB
     I              AWARDT                          WMARDT
     I              AWASDT                          WMASDT
     I              AWA4ST                          WMA4ST
     I              AWA5ST                          WMA5ST
     I              AWAAPR                          WMAAPR
     I              AWA6ST                          WMA6ST
     I              AWA7ST                          WMA7ST
     I              AWB3ST                          WMB3ST
     I              AWALPR                          WMALPR
     I              AWETCD                          WMETCD
     I              AWEUCD                          WMEUCD
     I              AWJ5TX                          WMJ5TX
     I              AWD5DT                          WMD5DT
     I              AWD6DT                          WMD6DT
     I              AWD7DT                          WMD7DT
     I              AWD8DT                          WMD8DT
     I              AWD9DT                          WMD9DT
     I              AWJOEJ                          WMJOEJ
     I              AWKOFF                          WMKOFF
     I              AWKWPE                          WMKWPE
     I              AWIMBF                          WMIMBF
     I              AWOPTR                          WMOPTR
     I              AWOEJD                          WMOEJD
     I              AWIRMF                          WMIRMF
     I              AWJIRM                          WMJIRM
     I              AWJRKF                          WMJRKF
     I              AWKFIR                          WMKFIR
     I              AWUZST                          WMUZST
     I              AWU0ST                          WMU0ST
     I              AWU1ST                          WMU1ST
     I              AWU2ST                          WMU2ST
     I              AWU3ST                          WMU3ST
     I              AWHXNB                          WMHXNB
     I              AWGANB                          WMGANB
     I              AWGBNB                          WMGBNB
     I              AWABCD                          WMABCD
     I              AWAECD                          WMAECD
     I              AWAKCD                          WMAKCD
     I              AWALCD                          WMALCD
     I              AWAGCD                          WMAGCD
     I              AWAICD                          WMAICD
     I              AWAMCD                          WMAMCD
     I              AWACCD                          WMACCD
     I              AWAAVN                          WMAAVN
     I              AWAADT                          WMAADT
     I              AWAMTM                          WMAMTM
     I              AWAJST                          WMAJST
     I              AWAHVN                          WMAHVN
     I              AWAGVN                          WMAGVN
     I              AWABVN                          WMABVN
     I              AWABDT                          WMABDT
     I              AWABTM                          WMABTM
      *
     I@A1CPOC
      * Tattoo Header             Co/BOL/Kill/Ttt
      * Renamed input format fields
     I              A1HMNB                          WOHMNB
     I              A1BNNB                          WOBNNB
     I              A1BONB                          WOBONB
     I              A1CVNB                          WOCVNB
     I              A1B0DT                          WOB0DT
     I              A1AWDT                          WOAWDT
     I              A1BICD                          WOBICD
     I              A1CPST                          WOCPST
     I              A1ACPR                          WOACPR
     I              A1B9PR                          WOB9PR
     I              A1CAPR                          WOCAPR
     I              A1C4ST                          WOC4ST
     I              A1AIPR                          WOAIPR
     I              A1A6DT                          WOA6DT
     I              A1C2ST                          WOC2ST
     I              A1CXNB                          WOCXNB
     I              A1CWNB                          WOCWNB
     I              A1FCNB                          WOFCNB
     I              A1H9NB                          WOH9NB
     I              A1FDNB                          WOFDNB
     I              A1FENB                          WOFENB
     I              A1HENB                          WOHENB
     I              A1HFNB                          WOHFNB
     I              A1CYNB                          WOCYNB
     I              A1LRNB                          WOLRNB
     I              A1E0NB                          WOE0NB
     I              A1A5PC                          WOA5PC
     I              A1FBNB                          WOFBNB
     I              A1A4PC                          WOA4PC
     I              A1F7NB                          WOF7NB
     I              A1HDNB                          WOHDNB
     I              A1F5NB                          WOF5NB
     I              A1F4NB                          WOF4NB
     I              A1F3NB                          WOF3NB
     I              A1F2NB                          WOF2NB
     I              A1AVPC                          WOAVPC
     I              A1AWPC                          WOAWPC
     I              A1CWPC                          WOCWPC
     I              A1A8PC                          WOA8PC
     I              A1A7PC                          WOA7PC
     I              A1B8PR                          WOB8PR
     I              A1AMPR                          WOAMPR
     I              A1ANPR                          WOANPR
     I              A1AYVA                          WOAYVA
     I              A1AWVA                          WOAWVA
     I              A1AOPR                          WOAOPR
     I              A1AXVA                          WOAXVA
     I              A1APPR                          WOAPPR
     I              A1ASPR                          WOASPR
     I              A1A4VA                          WOA4VA
     I              A1ATPR                          WOATPR
     I              A1A5VA                          WOA5VA
     I              A1CBPR                          WOCBPR
     I              A1CCPR                          WOCCPR
     I              A1LPNB                          WOLPNB
     I              A1CDPR                          WOCDPR
     I              A1A7VA                          WOA7VA
     I              A1A2PR                          WOA2PR
     I              A1JWST                          WOJWST
     I              A1CWST                          WOCWST
     I              A1D7ST                          WOD7ST
     I              A1D8ST                          WOD8ST
     I              A1DWST                          WODWST
     I              A1D6ST                          WOD6ST
     I              A1GHNB                          WOGHNB
     I              A1BYDT                          WOBYDT
     I              A1E0ST                          WOE0ST
     I              A1E1ST                          WOE1ST
     I              A1E2ST                          WOE2ST
     I              A1BSDT                          WOBSDT
     I              A1BTDT                          WOBTDT
     I              A1BUDT                          WOBUDT
     I              A1HGNB                          WOHGNB
     I              A1HHNB                          WOHHNB
     I              A1HINB                          WOHINB
     I              A1A3PR                          WOA3PR
     I              A1A4PR                          WOA4PR
     I              A1A6PR                          WOA6PR
     I              A1J9NB                          WOJ9NB
     I              A1D6PR                          WOD6PR
     I              A1D7PR                          WOD7PR
     I              A1D8PR                          WOD8PR
     I              A1D9PR                          WOD9PR
     I              A1EAPR                          WOEAPR
     I              A1EBPR                          WOEBPR
     I              A1ECPR                          WOECPR
     I              A1EDPR                          WOEDPR
     I              A1EEPR                          WOEEPR
     I              A1EFPR                          WOEFPR
     I              A1EGPR                          WOEGPR
     I              A1EHPR                          WOEHPR
     I              A1KAST                          WOKAST
     I              A1J7ST                          WOJ7ST
     I              A1J9ST                          WOJ9ST
     I              A1OXNB                          WOOXNB
     I              A1LKST                          WOLKST
     I              A1LLST                          WOLLST
     I              A1J8ST                          WOJ8ST
     I              A1LIST                          WOLIST
     I              A1LJST                          WOLJST
     I              A1NZTX                          WONZTX
     I              A1HJCD                          WOHJCD
     I              A1R4ST                          WOR4ST
     I              A1R5ST                          WOR5ST
     I              A1R6ST                          WOR6ST
     I              A1R7ST                          WOR7ST
     I              A1THWT                          WOTHWT
     I              A1T2WT                          WOT2WT
     I              A1THHD                          WOTHHD
     I              A1T2HD                          WOT2HD
     I              A1OBPR                          WOOBPR
     I              A1KOER                          WOKOER
     I              A1OPIR                          WOOPIR
     I              A1OPEM                          WOOPEM
     I              A1IORP                          WOIORP
     I              A1OWEO                          WOOWEO
     I              A1OQET                          WOOQET
     I              A1URST                          WOURST
     I              A1USST                          WOUSST
     I              A1HHPC                          WOHHPC
     I              A1S9PR                          WOS9PR
     I              A1TAPR                          WOTAPR
     I              A1TBPR                          WOTBPR
     I              A1JFUR                          WOJFUR
     I              A1KRIF                          WOKRIF
     I              A1KORF                          WOKORF
     I              A1KAPR                          WOKAPR
     I              A1KROT                          WOKROT
     I              A1OTJG                          WOOTJG
     I              A1IRJG                          WOIRJG
     I              A1IMJF                          WOIMJF
     I              A1IRGF                          WOIRGF
     I              A1KRJF                          WOKRJF
     I              A1OJRF                          WOOJRF
     I              A1KFOR                          WOKFOR
     I              A1ORJK                          WOORJK
     I              A1OMVJ                          WOOMVJ
     I              A1MVNF                          WOMVNF
     I              A1MCNF                          WOMCNF
     I              A1NCNF                          WONCNF
     I              A1NCHF                          WONCHF
     I              A1IGIR                          WOIGIR
     I              A1KFJR                          WOKFJR
     I              A1EADT                          WOEADT
     I              A1EBDT                          WOEBDT
     I              A1ECDT                          WOECDT
     I              A1EDDT                          WOEDDT
     I              A1EEDT                          WOEEDT
     I              A1U4ST                          WOU4ST
     I              A1U5ST                          WOU5ST
     I              A1U6ST                          WOU6ST
     I              A1U7ST                          WOU7ST
     I              A1U8ST                          WOU8ST
     I              A1U9ST                          WOU9ST
     I              A1VAST                          WOVAST
     I              A1VBST                          WOVBST
     I              A1BDCD                          WOBDCD
     I              A1CSCD                          WOCSCD
     I              A1ABCD                          WOABCD
     I              A1AECD                          WOAECD
     I              A1ACCD                          WOACCD
     I              A1AGCD                          WOAGCD
     I              A1BECD                          WOBECD
     I              A1AAVN                          WOAAVN
     I              A1AADT                          WOAADT
     I              A1AMTM                          WOAMTM
     I              A1AJST                          WOAJST
     I              A1AHVN                          WOAHVN
     I              A1AGVN                          WOAGVN
     I              A1ABVN                          WOABVN
     I              A1ABDT                          WOABDT
     I              A1ABTM                          WOABTM
      *
     I@CDCPV4
      * Tattoo Ded/Add            Co/BOL, reimb hd>0
      * Renamed input format fields
     I              CDHMNB                          WRHMNB
     I              CDBNNB                          WRBNNB
     I              CDBONB                          WRBONB
     I              CDCVNB                          WRCVNB
     I              CDB0DT                          WRB0DT
     I              CDBQCD                          WRBQCD
     I              CDAZVA                          WRAZVA
     I              CDA0VA                          WRA0VA
     I              CDJBST                          WRJBST
     I              CDEIST                          WREIST
     I              CDJDST                          WRJDST
     I              CDDPCD                          WRDPCD
     I              CDE3CD                          WRE3CD
     I              CDAQNB                          WRAQNB
     I              CDOCST                          WROCST
     I              CDPEST                          WRPEST
     I              CDPFST                          WRPFST
     I              CDPGST                          WRPGST
     I              CDPIST                          WRPIST
     I              CDPJST                          WRPJST
     I              CDPKST                          WRPKST
     I              CDPLST                          WRPLST
     I              CDAAVN                          WRAAVN
     I              CDAADT                          WRAADT
     I              CDAMTM                          WRAMTM
     I              CDAJST                          WRAJST
     I              CDAHVN                          WRAHVN
     I              CDAGVN                          WRAGVN
     I              CDABVN                          WRABVN
     I              CDABDT                          WRABDT
     I              CDABTM                          WRABTM
      *
     I@A1CPC7
      * Tattoo Header             Retrieval Index 2
      * Renamed input format fields
     I              A1HMNB                          WSHMNB
     I              A1BNNB                          WSBNNB
     I              A1BONB                          WSBONB
     I              A1CVNB                          WSCVNB
     I              A1B0DT                          WSB0DT
     I              A1AWDT                          WSAWDT
     I              A1BICD                          WSBICD
     I              A1CPST                          WSCPST
     I              A1ACPR                          WSACPR
     I              A1B9PR                          WSB9PR
     I              A1CAPR                          WSCAPR
     I              A1C4ST                          WSC4ST
     I              A1AIPR                          WSAIPR
     I              A1A6DT                          WSA6DT
     I              A1C2ST                          WSC2ST
     I              A1CXNB                          WSCXNB
     I              A1CWNB                          WSCWNB
     I              A1FCNB                          WSFCNB
     I              A1H9NB                          WSH9NB
     I              A1FDNB                          WSFDNB
     I              A1FENB                          WSFENB
     I              A1HENB                          WSHENB
     I              A1HFNB                          WSHFNB
     I              A1CYNB                          WSCYNB
     I              A1LRNB                          WSLRNB
     I              A1E0NB                          WSE0NB
     I              A1A5PC                          WSA5PC
     I              A1FBNB                          WSFBNB
     I              A1A4PC                          WSA4PC
     I              A1F7NB                          WSF7NB
     I              A1HDNB                          WSHDNB
     I              A1F5NB                          WSF5NB
     I              A1F4NB                          WSF4NB
     I              A1F3NB                          WSF3NB
     I              A1F2NB                          WSF2NB
     I              A1AVPC                          WSAVPC
     I              A1AWPC                          WSAWPC
     I              A1CWPC                          WSCWPC
     I              A1A8PC                          WSA8PC
     I              A1A7PC                          WSA7PC
     I              A1B8PR                          WSB8PR
     I              A1AMPR                          WSAMPR
     I              A1ANPR                          WSANPR
     I              A1AYVA                          WSAYVA
     I              A1AWVA                          WSAWVA
     I              A1AOPR                          WSAOPR
     I              A1AXVA                          WSAXVA
     I              A1APPR                          WSAPPR
     I              A1ASPR                          WSASPR
     I              A1A4VA                          WSA4VA
     I              A1ATPR                          WSATPR
     I              A1A5VA                          WSA5VA
     I              A1CBPR                          WSCBPR
     I              A1CCPR                          WSCCPR
     I              A1LPNB                          WSLPNB
     I              A1CDPR                          WSCDPR
     I              A1A7VA                          WSA7VA
     I              A1A2PR                          WSA2PR
     I              A1JWST                          WSJWST
     I              A1CWST                          WSCWST
     I              A1D7ST                          WSD7ST
     I              A1D8ST                          WSD8ST
     I              A1DWST                          WSDWST
     I              A1D6ST                          WSD6ST
     I              A1GHNB                          WSGHNB
     I              A1BYDT                          WSBYDT
     I              A1E0ST                          WSE0ST
     I              A1E1ST                          WSE1ST
     I              A1E2ST                          WSE2ST
     I              A1BSDT                          WSBSDT
     I              A1BTDT                          WSBTDT
     I              A1BUDT                          WSBUDT
     I              A1HGNB                          WSHGNB
     I              A1HHNB                          WSHHNB
     I              A1HINB                          WSHINB
     I              A1A3PR                          WSA3PR
     I              A1A4PR                          WSA4PR
     I              A1A6PR                          WSA6PR
     I              A1J9NB                          WSJ9NB
     I              A1D6PR                          WSD6PR
     I              A1D7PR                          WSD7PR
     I              A1D8PR                          WSD8PR
     I              A1D9PR                          WSD9PR
     I              A1EAPR                          WSEAPR
     I              A1EBPR                          WSEBPR
     I              A1ECPR                          WSECPR
     I              A1EDPR                          WSEDPR
     I              A1EEPR                          WSEEPR
     I              A1EFPR                          WSEFPR
     I              A1EGPR                          WSEGPR
     I              A1EHPR                          WSEHPR
     I              A1KAST                          WSKAST
     I              A1J7ST                          WSJ7ST
     I              A1J9ST                          WSJ9ST
     I              A1OXNB                          WSOXNB
     I              A1LKST                          WSLKST
     I              A1LLST                          WSLLST
     I              A1J8ST                          WSJ8ST
     I              A1LIST                          WSLIST
     I              A1LJST                          WSLJST
     I              A1NZTX                          WSNZTX
     I              A1HJCD                          WSHJCD
     I              A1R4ST                          WSR4ST
     I              A1R5ST                          WSR5ST
     I              A1R6ST                          WSR6ST
     I              A1R7ST                          WSR7ST
     I              A1THWT                          WSTHWT
     I              A1T2WT                          WST2WT
     I              A1THHD                          WSTHHD
     I              A1T2HD                          WST2HD
     I              A1OBPR                          WSOBPR
     I              A1KOER                          WSKOER
     I              A1OPIR                          WSOPIR
     I              A1OPEM                          WSOPEM
     I              A1IORP                          WSIORP
     I              A1OWEO                          WSOWEO
     I              A1OQET                          WSOQET
     I              A1URST                          WSURST
     I              A1USST                          WSUSST
     I              A1HHPC                          WSHHPC
     I              A1S9PR                          WSS9PR
     I              A1TAPR                          WSTAPR
     I              A1TBPR                          WSTBPR
     I              A1JFUR                          WSJFUR
     I              A1KRIF                          WSKRIF
     I              A1KORF                          WSKORF
     I              A1KAPR                          WSKAPR
     I              A1KROT                          WSKROT
     I              A1OTJG                          WSOTJG
     I              A1IRJG                          WSIRJG
     I              A1IMJF                          WSIMJF
     I              A1IRGF                          WSIRGF
     I              A1KRJF                          WSKRJF
     I              A1OJRF                          WSOJRF
     I              A1KFOR                          WSKFOR
     I              A1ORJK                          WSORJK
     I              A1OMVJ                          WSOMVJ
     I              A1MVNF                          WSMVNF
     I              A1MCNF                          WSMCNF
     I              A1NCNF                          WSNCNF
     I              A1NCHF                          WSNCHF
     I              A1IGIR                          WSIGIR
     I              A1KFJR                          WSKFJR
     I              A1EADT                          WSEADT
     I              A1EBDT                          WSEBDT
     I              A1ECDT                          WSECDT
     I              A1EDDT                          WSEDDT
     I              A1EEDT                          WSEEDT
     I              A1U4ST                          WSU4ST
     I              A1U5ST                          WSU5ST
     I              A1U6ST                          WSU6ST
     I              A1U7ST                          WSU7ST
     I              A1U8ST                          WSU8ST
     I              A1U9ST                          WSU9ST
     I              A1VAST                          WSVAST
     I              A1VBST                          WSVBST
     I              A1BDCD                          WSBDCD
     I              A1CSCD                          WSCSCD
     I              A1ABCD                          WSABCD
     I              A1AECD                          WSAECD
     I              A1ACCD                          WSACCD
     I              A1AGCD                          WSAGCD
     I              A1BECD                          WSBECD
     I              A1AAVN                          WSAAVN
     I              A1AADT                          WSAADT
     I              A1AMTM                          WSAMTM
     I              A1AJST                          WSAJST
     I              A1AHVN                          WSAHVN
     I              A1AGVN                          WSAGVN
     I              A1ABVN                          WSABVN
     I              A1ABDT                          WSABDT
     I              A1ABTM                          WSABTM
      *
     I@AQCPA0
      * Producer Sub-Contract     Retrieval index
      * Renamed input format fields
     I              AQAKCD                          WTAKCD
     I              AQALCD                          WTALCD
     I              AQAHDT                          WTAHDT
     I              AQA2ST                          WTA2ST
     I              AQAZPR                          WTAZPR
     I              AQA0PR                          WTA0PR
     I              AQA9PC                          WTA9PC
     I              AQA7PR                          WTA7PR
     I              AQA8PR                          WTA8PR
     I              AQF3ST                          WTF3ST
     I              AQA9PR                          WTA9PR
     I              AQERCD                          WTERCD
     I              AQESCD                          WTESCD
     I              AQF6PR                          WTF6PR
     I              AQJ3TX                          WTJ3TX
     I              AQABCD                          WTABCD
     I              AQAECD                          WTAECD
     I              AQAGCD                          WTAGCD
     I              AQAICD                          WTAICD
     I              AQAMCD                          WTAMCD
     I              AQAAVN                          WTAAVN
     I              AQAADT                          WTAADT
     I              AQAMTM                          WTAMTM
     I              AQAJST                          WTAJST
     I              AQAHVN                          WTAHVN
     I              AQAGVN                          WTAGVN
     I              AQABVN                          WTABVN
     I              AQABDT                          WTABDT
     I              AQABTM                          WTABTM
      *
     I@ECCPAG
      * Producer SC Floor Price   Retrieval index
      * Renamed input format fields
     I              ECAKCD                          WVAKCD
     I              ECALCD                          WVALCD
     I              ECDJDT                          WVDJDT
     I              ECOCPR                          WVOCPR
     I              ECODPR                          WVODPR
     I              ECOEPR                          WVOEPR
     I              ECOFPR                          WVOFPR
     I              ECOGPR                          WVOGPR
     I              ECOHPR                          WVOHPR
     I              ECOIPR                          WVOIPR
      *
     I@EECPAP
      * Producer Cntrct RsvAct Hd Retrieval index
      * Renamed input format fields
     I              EEAKCD                          WWAKCD
     I              EEEJVA                          WWEJVA
     I              EEDLDT                          WWDLDT
     I              EEAAVN                          WWAAVN
     I              EEAADT                          WWAADT
     I              EEAMTM                          WWAMTM
     I              EEAJST                          WWAJST
     I              EEAHVN                          WWAHVN
     I              EEAGVN                          WWAGVN
     I              EEABVN                          WWABVN
     I              EEABDT                          WWABDT
     I              EEABTM                          WWABTM
      *
     I@APREKQ
      * Producer Loc Std D/A      Active Std D/A only
      * Renamed input format fields
     I              APABCD                          WXABCD
     I              APAECD                          WXAECD
     I              APZDA1                          WXZDA1
     I              APBQCD                          WXBQCD
     I              APEVST                          WXEVST
     I              APA1VA                          WXA1VA
     I              APJAST                          WXJAST
     I              APC0DT                          WXC0DT
     I              APC1DT                          WXC1DT
     I              APN2ST                          WXN2ST
     I              APN3ST                          WXN3ST
     I              APN4ST                          WXN4ST
     I              APN5ST                          WXN5ST
     I              APN6ST                          WXN6ST
     I              APN7ST                          WXN7ST
     I              APN8ST                          WXN8ST
     I              APN9ST                          WXN9ST
     I              APOAST                          WXOAST
     I              APOBST                          WXOBST
     I              APAAVN                          WXAAVN
     I              APAADT                          WXAADT
     I              APAMTM                          WXAMTM
     I              APAJST                          WXAJST
     I              APAHVN                          WXAHVN
     I              APAGVN                          WXAGVN
     I              APABVN                          WXABVN
     I              APABDT                          WXABDT
     I              APABTM                          WXABTM
      *
     I@CDCPIU
      * Tattoo Ded/Add            Retrieval index
      * Renamed input format fields
     I              CDHMNB                          WYHMNB
     I              CDBNNB                          WYBNNB
     I              CDBONB                          WYBONB
     I              CDCVNB                          WYCVNB
     I              CDB0DT                          WYB0DT
     I              CDBQCD                          WYBQCD
     I              CDAZVA                          WYAZVA
     I              CDA0VA                          WYA0VA
     I              CDJBST                          WYJBST
     I              CDEIST                          WYEIST
     I              CDJDST                          WYJDST
     I              CDDPCD                          WYDPCD
     I              CDE3CD                          WYE3CD
     I              CDAQNB                          WYAQNB
     I              CDOCST                          WYOCST
     I              CDPEST                          WYPEST
     I              CDPFST                          WYPFST
     I              CDPGST                          WYPGST
     I              CDPIST                          WYPIST
     I              CDPJST                          WYPJST
     I              CDPKST                          WYPKST
     I              CDPLST                          WYPLST
     I              CDAAVN                          WYAAVN
     I              CDAADT                          WYAADT
     I              CDAMTM                          WYAMTM
     I              CDAJST                          WYAJST
     I              CDAHVN                          WYAHVN
     I              CDAGVN                          WYAGVN
     I              CDABVN                          WYABVN
     I              CDABDT                          WYABDT
     I              CDABTM                          WYABTM
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQPKA11    E DSPKA1CPL1
      * UPD : Tattoo Header             Update index
      * Renamed input format fields
     I              A1HMNB                          WCHMNB
     I              A1BNNB                          WCBNNB
     I              A1BONB                          WCBONB
     I              A1CVNB                          WCCVNB
     I              A1B0DT                          WCB0DT
     I              A1AWDT                          WCAWDT
     I              A1BICD                          WCBICD
     I              A1CPST                          WCCPST
     I              A1ACPR                          WCACPR
     I              A1B9PR                          WCB9PR
     I              A1CAPR                          WCCAPR
     I              A1C4ST                          WCC4ST
     I              A1AIPR                          WCAIPR
     I              A1A6DT                          WCA6DT
     I              A1C2ST                          WCC2ST
     I              A1CXNB                          WCCXNB
     I              A1CWNB                          WCCWNB
     I              A1FCNB                          WCFCNB
     I              A1H9NB                          WCH9NB
     I              A1FDNB                          WCFDNB
     I              A1FENB                          WCFENB
     I              A1HENB                          WCHENB
     I              A1HFNB                          WCHFNB
     I              A1CYNB                          WCCYNB
     I              A1LRNB                          WCLRNB
     I              A1E0NB                          WCE0NB
     I              A1A5PC                          WCA5PC
     I              A1FBNB                          WCFBNB
     I              A1A4PC                          WCA4PC
     I              A1F7NB                          WCF7NB
     I              A1HDNB                          WCHDNB
     I              A1F5NB                          WCF5NB
     I              A1F4NB                          WCF4NB
     I              A1F3NB                          WCF3NB
     I              A1F2NB                          WCF2NB
     I              A1AVPC                          WCAVPC
     I              A1AWPC                          WCAWPC
     I              A1CWPC                          WCCWPC
     I              A1A8PC                          WCA8PC
     I              A1A7PC                          WCA7PC
     I              A1B8PR                          WCB8PR
     I              A1AMPR                          WCAMPR
     I              A1ANPR                          WCANPR
     I              A1AYVA                          WCAYVA
     I              A1AWVA                          WCAWVA
     I              A1AOPR                          WCAOPR
     I              A1AXVA                          WCAXVA
     I              A1APPR                          WCAPPR
     I              A1ASPR                          WCASPR
     I              A1A4VA                          WCA4VA
     I              A1ATPR                          WCATPR
     I              A1A5VA                          WCA5VA
     I              A1CBPR                          WCCBPR
     I              A1CCPR                          WCCCPR
     I              A1LPNB                          WCLPNB
     I              A1CDPR                          WCCDPR
     I              A1A7VA                          WCA7VA
     I              A1A2PR                          WCA2PR
     I              A1JWST                          WCJWST
     I              A1CWST                          WCCWST
     I              A1D7ST                          WCD7ST
     I              A1D8ST                          WCD8ST
     I              A1DWST                          WCDWST
     I              A1D6ST                          WCD6ST
     I              A1GHNB                          WCGHNB
     I              A1BYDT                          WCBYDT
     I              A1E0ST                          WCE0ST
     I              A1E1ST                          WCE1ST
     I              A1E2ST                          WCE2ST
     I              A1BSDT                          WCBSDT
     I              A1BTDT                          WCBTDT
     I              A1BUDT                          WCBUDT
     I              A1HGNB                          WCHGNB
     I              A1HHNB                          WCHHNB
     I              A1HINB                          WCHINB
     I              A1A3PR                          WCA3PR
     I              A1A4PR                          WCA4PR
     I              A1A6PR                          WCA6PR
     I              A1J9NB                          WCJ9NB
     I              A1D6PR                          WCD6PR
     I              A1D7PR                          WCD7PR
     I              A1D8PR                          WCD8PR
     I              A1D9PR                          WCD9PR
     I              A1EAPR                          WCEAPR
     I              A1EBPR                          WCEBPR
     I              A1ECPR                          WCECPR
     I              A1EDPR                          WCEDPR
     I              A1EEPR                          WCEEPR
     I              A1EFPR                          WCEFPR
     I              A1EGPR                          WCEGPR
     I              A1EHPR                          WCEHPR
     I              A1KAST                          WCKAST
     I              A1J7ST                          WCJ7ST
     I              A1J9ST                          WCJ9ST
     I              A1OXNB                          WCOXNB
     I              A1LKST                          WCLKST
     I              A1LLST                          WCLLST
     I              A1J8ST                          WCJ8ST
     I              A1LIST                          WCLIST
     I              A1LJST                          WCLJST
     I              A1NZTX                          WCNZTX
     I              A1HJCD                          WCHJCD
     I              A1R4ST                          WCR4ST
     I              A1R5ST                          WCR5ST
     I              A1R6ST                          WCR6ST
     I              A1R7ST                          WCR7ST
     I              A1THWT                          WCTHWT
     I              A1T2WT                          WCT2WT
     I              A1THHD                          WCTHHD
     I              A1T2HD                          WCT2HD
     I              A1OBPR                          WCOBPR
     I              A1KOER                          WCKOER
     I              A1OPIR                          WCOPIR
     I              A1OPEM                          WCOPEM
     I              A1IORP                          WCIORP
     I              A1OWEO                          WCOWEO
     I              A1OQET                          WCOQET
     I              A1URST                          WCURST
     I              A1USST                          WCUSST
     I              A1HHPC                          WCHHPC
     I              A1S9PR                          WCS9PR
     I              A1TAPR                          WCTAPR
     I              A1TBPR                          WCTBPR
     I              A1JFUR                          WCJFUR
     I              A1KRIF                          WCKRIF
     I              A1KORF                          WCKORF
     I              A1KAPR                          WCKAPR
     I              A1KROT                          WCKROT
     I              A1OTJG                          WCOTJG
     I              A1IRJG                          WCIRJG
     I              A1IMJF                          WCIMJF
     I              A1IRGF                          WCIRGF
     I              A1KRJF                          WCKRJF
     I              A1OJRF                          WCOJRF
     I              A1KFOR                          WCKFOR
     I              A1ORJK                          WCORJK
     I              A1OMVJ                          WCOMVJ
     I              A1MVNF                          WCMVNF
     I              A1MCNF                          WCMCNF
     I              A1NCNF                          WCNCNF
     I              A1NCHF                          WCNCHF
     I              A1IGIR                          WCIGIR
     I              A1KFJR                          WCKFJR
     I              A1EADT                          WCEADT
     I              A1EBDT                          WCEBDT
     I              A1ECDT                          WCECDT
     I              A1EDDT                          WCEDDT
     I              A1EEDT                          WCEEDT
     I              A1U4ST                          WCU4ST
     I              A1U5ST                          WCU5ST
     I              A1U6ST                          WCU6ST
     I              A1U7ST                          WCU7ST
     I              A1U8ST                          WCU8ST
     I              A1U9ST                          WCU9ST
     I              A1VAST                          WCVAST
     I              A1VBST                          WCVBST
     I              A1BDCD                          WCBDCD
     I              A1CSCD                          WCCSCD
     I              A1ABCD                          WCABCD
     I              A1AECD                          WCAECD
     I              A1ACCD                          WCACCD
     I              A1AGCD                          WCAGCD
     I              A1BECD                          WCBECD
     I              A1AAVN                          WCAAVN
     I              A1AADT                          WCAADT
     I              A1AMTM                          WCAMTM
     I              A1AJST                          WCAJST
     I              A1AHVN                          WCAHVN
     I              A1AGVN                          WCAGVN
     I              A1ABVN                          WCABVN
     I              A1ABDT                          WCABDT
     I              A1ABTM                          WCABTM
      *
     IYARDCS      DS                            583
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQPKCD1    E DSPKCDCPL0
      * UPD : Tattoo Ded/Add            Update index
      * Renamed input format fields
     I              CDHMNB                          WIHMNB
     I              CDBNNB                          WIBNNB
     I              CDBONB                          WIBONB
     I              CDCVNB                          WICVNB
     I              CDB0DT                          WIB0DT
     I              CDBQCD                          WIBQCD
     I              CDAZVA                          WIAZVA
     I              CDA0VA                          WIA0VA
     I              CDJBST                          WIJBST
     I              CDEIST                          WIEIST
     I              CDJDST                          WIJDST
     I              CDDPCD                          WIDPCD
     I              CDE3CD                          WIE3CD
     I              CDAQNB                          WIAQNB
     I              CDOCST                          WIOCST
     I              CDPEST                          WIPEST
     I              CDPFST                          WIPFST
     I              CDPGST                          WIPGST
     I              CDPIST                          WIPIST
     I              CDPJST                          WIPJST
     I              CDPKST                          WIPKST
     I              CDPLST                          WIPLST
     I              CDAAVN                          WIAAVN
     I              CDAADT                          WIAADT
     I              CDAMTM                          WIAMTM
     I              CDAJST                          WIAJST
     I              CDAHVN                          WIAHVN
     I              CDAGVN                          WIAGVN
     I              CDABVN                          WIABVN
     I              CDABDT                          WIABDT
     I              CDABTM                          WIABTM
      *
     IYBRDCS      DS                            583
      /EJECT
     IXDINT       DS
      * Internal date
     I                                        1   70XDINDT
     I                                        1   30XDINYY
     I                                        4   50XDINMM
     I                                        6   70XDINDD
      /EJECT
     IXD2T        DS
      * Internal date
     I                                        1   70XDINT2
     I                                        1   30XDINY2
     I                                        4   50XDINM2
     I                                        6   70XDIND2
     IYCRDCS      DS                            583
     IYDRDCS      DS                            583
     IYERDCS      DS                            583
     IYFRDCS      DS                            583
     IYGRDCS      DS                            583
     IYHRDCS      DS                            583
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Tattoo Header
      * I :  BOH Company Number
     I                                    P   1   20P1HMNB
      * I :  BOH Buy Order Number
     I                                    P   3   60P1BNNB
      * I :  BOL Load Number
     I                                    P   7   90P1BONB
      * I :  TH Tattoo Number
     I                                    P  10  120P1CVNB
      * I :  TH Kill Date
     I                                    P  13  160P1B0DT
     IP2PARM      DS
      * I : MAP Ded/Add/Net Pay Usr
     I                                        1   1 P2JGST
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1HMNB    PARM           WP0001  30       BOH Company Num
     C           P1BNNB    PARM           WP0002  70       BOH Buy Order N
     C           P1BONB    PARM           WP0003  50       BOL Load Number
     C           P1CVNB    PARM           WP0004  50       TH Tattoo Numbe
     C           P1B0DT    PARM           WP0005  70       TH Kill Date
     C           P2JGST    PARM           WP0006  1        Ded/Add/Net Pay
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * Clc Ded/Add/Net Pay   XF
      * Modifications and Comments
     C                     EXSR UASUBR                     Modifications a
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * This option will calculate live gross, ded/add live net
      * This option will calculate  ded/add carcass net
      * This option will calculate  Payment Gross ded/add Payment net
      * Clc Tattoo Dadd/nt    RT - Tattoo Header  * 
     C                     EXSR SARVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         NARVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQNA01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQNA02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQNA03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQNA04           TH Kill Date
     C           *LIKE     DEFN WOCVNB    WQNA05           TH Tattoo Numbe
      * Define keylist
     C           KRSNA     KLIST
     C                     KFLD           WQNA01           BOH Company Num
     C                     KFLD           WQNA02           BOH Buy Order N
     C                     KFLD           WQNA03           BOL Load Number
     C                     KFLD           WQNA04           TH Kill Date
     C                     KFLD           WQNA05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQNA01           BOH Company Num
     C                     Z-ADDWABNNB    WQNA02           BOH Buy Order N
     C                     Z-ADDWABONB    WQNA03           BOL Load Number
     C                     Z-ADDWAB0DT    WQNA04           TH Kill Date
     C                     Z-ADDWACVNB    WQNA05           TH Tattoo Numbe
      * Establish starting position
     C           KRSNA     SETLL@A1CPOC                    *
     C           KRSNA     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR NBCHRC
     C           KRSNA     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         NAEXIT    ENDSR
      /EJECT
     CSR         NBCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0799  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0800 10        TH Group Refere
     C                     MOVEL*BLANK    WN0801  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0802  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0803  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0804  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0805  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0806  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0807  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0808  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0809  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0810  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0811  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0812  50       TH Held Over
     C                     Z-ADD*ZERO     WN0813  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0814  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0815  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0816  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0817  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0818  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0819  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0820  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0821  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0822  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0823  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0824  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0825  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0826  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0827  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0828  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0829  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0830  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0831  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0832  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0833  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0834  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0835  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0836  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0837  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0838  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0839  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0840  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0841  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0842  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0843  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0844  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0845  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0846  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0847  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0848  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0849  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0850  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0851  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0852  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0853  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0854  1        TH Header Error
     C                     MOVEL*BLANK    WN0855  1        TH Detail Error
     C                     MOVEL*BLANK    WN0856  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0857  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0858  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0859  1        TH User Error O
     C                     MOVEL*BLANK    WN0860  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0861  1        TH Sex
     C                     Z-ADD*ZERO     WN0862  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0863  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0864  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0865  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0866  31       TH FFLI
     C                     Z-ADD*ZERO     WN0867  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0868  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0869  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0870  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0871  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0872  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0873  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0874  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0875  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0876  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0877  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0878  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0879  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0880  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0881  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0882  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0883  1        TH Source Type
     C                     MOVEL*BLANK    WN0884  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0885  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0886  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0887  3        TH Source Code
     C                     MOVEL*BLANK    WN0888  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0889  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0890  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0891  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0892  3        TH State
     C                     MOVEL*BLANK    WN0893  3        TH Unused Code
     C                     MOVEL*BLANK    WN0894  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0895  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0896  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0897  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0898  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0899  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0900  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0901  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0902  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0903  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0904  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0905  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0906  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0907  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0908  3        TH PHA Average
     C                     MOVEL*BLANK    WN0909  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0910  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0911  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0912  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0913  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0914  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0915  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0916  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0917  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0918  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0919  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0920  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0921  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0922 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0923 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0924 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0925 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0926  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0927  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0928  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0929  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0930  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0931  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0932  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0933  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0934  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0935  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0936  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0937  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0938  70       TH Unused Date
     C                     MOVEL*BLANK    WN0939  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0940  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0941  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0942  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0943  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0944  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0945  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0946  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0947  6        DF Defect Code
     C                     MOVEL*BLANK    WN0948  6        THP Process Cod
     C                     MOVEL*BLANK    WN0949  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0950  6        PL Location Cod
     C                     MOVEL*BLANK    WN0951  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0952  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0953  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YFRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WCBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHNB    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHNB    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL006.
     C                     MOVEL'LBL006'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NBEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NBEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YFRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     MOVEL'C'       WCR5ST    P      TH Commission S
     C                     MOVELWOAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWOAADT    WCAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WCAMTM           RS Time Changed
     C                     MOVELWOAJST    WCAJST    P      RS Record Statu
     C                     MOVELWOAHVN    WCAHVN    P      RS Job
     C                     MOVELWOAGVN    WCAGVN    P      RS Program
     C                     MOVELWOABVN    WCABVN    P      RS User Added
     C                     Z-ADDWOABDT    WCABDT           RS Date Added
     C                     Z-ADDWOABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YFRDCS
     C           YFRDC     ANDNE'N'
     C                     MOVE 'Y'       YFRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YFRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NBEXIT    ENDSR
      /EJECT
     CSR         NCCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWXA1VA    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWXJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWXEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVELWUPIST    WIPIST           THD Commission
     C                     MOVELWUPJST    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRNC    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRNC    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO NCEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         NCEXIT    ENDSR
      /EJECT
     CSR         NDRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQND01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQND02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQND03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQND04           TH Kill Date
     C           *LIKE     DEFN WOCVNB    WQND05           TH Tattoo Numbe
      * Define keylist
     C           KRSND     KLIST
     C                     KFLD           WQND01           BOH Company Num
     C                     KFLD           WQND02           BOH Buy Order N
     C                     KFLD           WQND03           BOL Load Number
     C                     KFLD           WQND04           TH Kill Date
     C                     KFLD           WQND05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQND01           BOH Company Num
     C                     Z-ADDWABNNB    WQND02           BOH Buy Order N
     C                     Z-ADDWABONB    WQND03           BOL Load Number
     C                     Z-ADDWAB0DT    WQND04           TH Kill Date
     C                     Z-ADDWACVNB    WQND05           TH Tattoo Numbe
      * Establish starting position
     C           KRSND     SETLL@A1CPOC                    *
     C           KRSND     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR NECHRC
     C           KRSND     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         NDEXIT    ENDSR
      /EJECT
     CSR         NECHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0954  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0955 10        TH Group Refere
     C                     MOVEL*BLANK    WN0956  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0957  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0958  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0959  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0960  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0961  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0962  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0963  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0964  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0965  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0966  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0967  50       TH Held Over
     C                     Z-ADD*ZERO     WN0968  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0969  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0970  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0971  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0972  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0973  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0974  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0975  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0976  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0977  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0978  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0979  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0980  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0981  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0982  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0983  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0984  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0985  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0986  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0987  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0988  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0989  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0990  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0991  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0992  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0993  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0994  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0995  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0996  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0997  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0998  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0999  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN1000  72       TH Additions Am
     C                     Z-ADD*ZERO     WN1001  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN1002  72       Th Payment Net
     C                     Z-ADD*ZERO     WN1003  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN1004  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN1005  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN1006  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN1007  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN1008  2        TH Payment Sts
     C                     MOVEL*BLANK    WN1009  1        TH Header Error
     C                     MOVEL*BLANK    WN1010  1        TH Detail Error
     C                     MOVEL*BLANK    WN1011  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN1012  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN1013  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN1014  1        TH User Error O
     C                     MOVEL*BLANK    WN1015  1        TH Held Over Re
     C                     MOVEL*BLANK    WN1016  1        TH Sex
     C                     Z-ADD*ZERO     WN1017  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN1018  70       TH Actual Check
     C                     Z-ADD*ZERO     WN1019  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN1020  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1021  31       TH FFLI
     C                     Z-ADD*ZERO     WN1022  72       TH Kill Product
     C                     Z-ADD*ZERO     WN1023  72       TH Cut Product
     C                     Z-ADD*ZERO     WN1024  72       TH Render Produ
     C                     Z-ADD*ZERO     WN1025  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN1026  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN1027  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN1028  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN1029  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN1030  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN1031  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN1032  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN1033  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN1034  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1035  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1036  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN1037  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN1038  1        TH Source Type
     C                     MOVEL*BLANK    WN1039  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN1040  1        TH Payment Type
     C                     Z-ADD*ZERO     WN1041  70       TH HPS Movement
     C                     MOVEL*BLANK    WN1042  3        TH Source Code
     C                     MOVEL*BLANK    WN1043  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN1044  1        TH Posted to HP
     C                     MOVEL*BLANK    WN1045  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN1046  1        TH Shift Held O
     C                     MOVEL*BLANK    WN1047  3        TH State
     C                     MOVEL*BLANK    WN1048  3        TH Unused Code
     C                     MOVEL*BLANK    WN1049  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1050  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN1051  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN1052  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN1053  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN1054  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN1055  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN1056  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN1057  50       TH Head Identif
     C                     Z-ADD*ZERO     WN1058  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN1059  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN1060  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN1061  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN1062  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN1063  3        TH PHA Average
     C                     MOVEL*BLANK    WN1064  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN1065  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN1066  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN1067  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN1068  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN1069  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN1070  50       TH Broken Back
     C                     Z-ADD*ZERO     WN1071  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN1072  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN1073  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN1074  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN1075  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN1076  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN1077 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN1078 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1079 112       TH Break Even P
     C                     Z-ADD*ZERO     WN1080 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN1081  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN1082  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN1083  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1084  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1085  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN1086  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN1087  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1088  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN1089  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1090  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1091  70       TH Head LFT
     C                     Z-ADD*ZERO     WN1092  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN1093  70       TH Unused Date
     C                     MOVEL*BLANK    WN1094  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN1095  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1096  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN1097  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN1098  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1099  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1100  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1101  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1102  6        DF Defect Code
     C                     MOVEL*BLANK    WN1103  6        THP Process Cod
     C                     MOVEL*BLANK    WN1104  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1105  6        PL Location Cod
     C                     MOVEL*BLANK    WN1106  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1107  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1108  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YGRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WCBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHNE    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHNE    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL007.
     C                     MOVEL'LBL007'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YGRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     MOVEL'C'       WCR5ST    P      TH Commission S
     C                     MOVELWOAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWOAADT    WCAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WCAMTM           RS Time Changed
     C                     MOVELWOAJST    WCAJST    P      RS Record Statu
     C                     MOVELWOAHVN    WCAHVN    P      RS Job
     C                     MOVELWOAGVN    WCAGVN    P      RS Program
     C                     MOVELWOABVN    WCABVN    P      RS User Added
     C                     Z-ADDWOABDT    WCABDT           RS Date Added
     C                     Z-ADDWOABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YGRDCS
     C           YGRDC     ANDNE'N'
     C                     MOVE 'Y'       YGRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YGRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NEEXIT    ENDSR
      /EJECT
     CSR         NFRVGN    BEGSR
      *================================================================
      * Rtv Tattoo Hdr Totls RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD*ZERO     WUASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WUA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WUMCPR           Freight Tot Ded
      * Declare restrictor key work fields
     C           *LIKE     DEFN WYHMNB    WQNF01           BOH Company Num
     C           *LIKE     DEFN WYBNNB    WQNF02           BOH Buy Order N
     C           *LIKE     DEFN WYBONB    WQNF03           BOL Load Number
     C           *LIKE     DEFN WYCVNB    WQNF04           TH Tattoo Numbe
     C           *LIKE     DEFN WYB0DT    WQNF05           TH Kill Date
      * Define keylist
     C           KRSNF     KLIST
     C                     KFLD           WQNF01           BOH Company Num
     C                     KFLD           WQNF02           BOH Buy Order N
     C                     KFLD           WQNF03           BOL Load Number
     C                     KFLD           WQNF04           TH Tattoo Numbe
     C                     KFLD           WQNF05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQNF01           BOH Company Num
     C                     Z-ADDWABNNB    WQNF02           BOH Buy Order N
     C                     Z-ADDWABONB    WQNF03           BOL Load Number
     C                     Z-ADDWACVNB    WQNF04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQNF05           TH Kill Date
      * Establish starting position
     C           KRSNF     SETLL@CDCPIU                    *
     C           KRSNF     READE@CDCPIU                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Status Include Dead Hd is No, dont include Dead
      *   |- c2    : DB1.THD UOM is Dead Head UOM
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           'Y'       IFEQ 'N'                        *IF
     C           WYEIST    IFEQ 'CH'                       *IF
     C           WYEIST    OREQ 'DH'
     C           WYEIST    OREQ 'DY'
     C           WYEIST    OREQ 'YH'
     C           WYEIST    OREQ 'KH'
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.THD Expense Paid by is Producer
     C           WYPEST    IFEQ 'P'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WYJBST    IFEQ '+'                        *IF
     C                     ADD  WYA0VA    WUA5VA           TH Additions Am
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WYA0VA    WUASPR           TH Deduction Am
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Paid by is Seaboard
     C           WYPEST    IFEQ 'S'                        *IF
      * CASE: DB1.THD Expense Type is Freight
     C           WYPFST    IFEQ 'F'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WYJBST    IFEQ '+'                        *IF
     C                     ADD  WYA0VA    WUMCPR           Freight Tot Ded
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WYA0VA    WUMCPR           Freight Tot Ded
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.THD Expense Type is Other
     C           WYPFST    IFEQ 'O'                        *IF
      * CASE: DB1.THD Unit Amt Sign is Add
     C           WYJBST    IFEQ '+'                        *IF
     C                     ADD  WYA0VA    WUA7VA           TH Accrual Amou
     C                     ELSE
      * CASE: *OTHERWISE
     C                     SUB  WYA0VA    WUA7VA           TH Accrual Amou
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           KRSNF     READE@CDCPIU                  90*
     C                     ENDDO
      *================================================================
     CSR         NFEXIT    ENDSR
      /EJECT
     CSR         NGCHRC    BEGSR
      *================================================================
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN1109  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN1110 10        TH Group Refere
     C                     MOVEL*BLANK    WN1111  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN1112  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN1113  70       TH Pricing Date
     C                     MOVEL*BLANK    WN1114  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN1115  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN1116  50       TH Head Receive
     C                     Z-ADD*ZERO     WN1117  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN1118  50       TH Held Over
     C                     Z-ADD*ZERO     WN1119  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN1120  50       TH Head Killed
     C                     Z-ADD*ZERO     WN1121  50       TH Head Adds
     C                     Z-ADD*ZERO     WN1122  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN1123  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN1124  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN1125  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN1126  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN1127  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN1128  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN1129  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN1130  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1131  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN1132  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN1133  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1134  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1135  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN1136  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN1137  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN1138  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN1139  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN1140  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN1141  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN1142  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN1143  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN1144  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN1145  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN1146  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN1147  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN1148  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN1149  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN1150  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN1151  2        TH Payment Sts
     C                     MOVEL*BLANK    WN1152  1        TH Header Error
     C                     MOVEL*BLANK    WN1153  1        TH Detail Error
     C                     MOVEL*BLANK    WN1154  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN1155  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN1156  80       TH Commission A
     C                     Z-ADD*ZERO     WN1157  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN1158  1        TH User Error O
     C                     MOVEL*BLANK    WN1159  1        TH Held Over Re
     C                     MOVEL*BLANK    WN1160  1        TH Sex
     C                     Z-ADD*ZERO     WN1161  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN1162  70       TH Commission P
     C                     Z-ADD*ZERO     WN1163  70       TH Actual Check
     C                     Z-ADD*ZERO     WN1164  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN1165  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN1166  31       TH FFLI
     C                     Z-ADD*ZERO     WN1167  72       TH Kill Product
     C                     Z-ADD*ZERO     WN1168  72       TH Cut Product
     C                     Z-ADD*ZERO     WN1169  72       TH Render Produ
     C                     Z-ADD*ZERO     WN1170  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN1171  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN1172  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN1173  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN1174  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN1175  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN1176  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN1177  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN1178  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN1179  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1180  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN1181  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN1182  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN1183  1        TH Source Type
     C                     MOVEL*BLANK    WN1184  1        TH Scale Ticket
     C                     Z-ADD*ZERO     WN1185  70       TH HPS Movement
     C                     MOVEL*BLANK    WN1186  3        TH Source Code
     C                     MOVEL*BLANK    WN1187  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN1188  1        TH Posted to HP
     C                     MOVEL*BLANK    WN1189  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN1190  1        TH Shift Held O
     C                     MOVEL*BLANK    WN1191  3        TH State
     C                     MOVEL*BLANK    WN1192  3        TH Unused Code
     C                     MOVEL*BLANK    WN1193  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1194  1        TH Commission S
     C                     MOVEL*BLANK    WN1195  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN1196  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN1197  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN1198  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN1199  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN1200  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN1201  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN1202  50       TH Head Identif
     C                     Z-ADD*ZERO     WN1203  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN1204  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN1205  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN1206  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN1207  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN1208  3        TH PHA Average
     C                     MOVEL*BLANK    WN1209  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN1210  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN1211  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN1212  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN1213  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN1214  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN1215  50       TH Broken Back
     C                     Z-ADD*ZERO     WN1216  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN1217  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN1218  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN1219  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN1220  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN1221  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN1222 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN1223 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1224 112       TH Break Even P
     C                     Z-ADD*ZERO     WN1225 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN1226  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN1227  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN1228  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN1229  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN1230  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN1231  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN1232  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN1233  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN1234  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1235  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN1236  70       TH Head LFT
     C                     Z-ADD*ZERO     WN1237  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN1238  70       TH Unused Date
     C                     MOVEL*BLANK    WN1239  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN1240  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN1241  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN1242  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN1243  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN1244  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN1245  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN1246  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN1247  6        DF Defect Code
     C                     MOVEL*BLANK    WN1248  6        THP Process Cod
     C                     MOVEL*BLANK    WN1249  6        PD Producer Cod
     C                     MOVEL*BLANK    WN1250  6        PL Location Cod
     C                     MOVEL*BLANK    WN1251  3        HB Buyer Code
     C                     MOVEL*BLANK    WN1252  5        GN Genetic Code
     C                     MOVEL*BLANK    WN1253  3        HC Class Code
     C                     MOVEL*BLANK    WN1254 10        RS User Added
     C                     Z-ADD*ZERO     WN1255  70       RS Date Added
     C                     Z-ADD*ZERO     WN1256  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YHRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHNG    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHNG    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL008.
     C                     MOVEL'LBL008'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO NGEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO NGEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YHRDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELYL0001    WCCPST    P      TH Live Purchas
     C                     Z-ADDYL0002    WCACPR           TH Live Purchas
     C                     Z-ADDWUB9PR    WCB9PR           TH Live Gross A
     C                     Z-ADDWUCAPR    WCCAPR           TH LIve Net Amt
     C                     Z-ADDWUASPR    WCASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WCA4VA           TH Total Net WO
     C                     Z-ADDWUATPR    WCATPR           TH Carcass Net
     C                     Z-ADDWUA5VA    WCA5VA           TH Additions Am
     C                     Z-ADDWUCBPR    WCCBPR           TH Payment Gros
     C                     Z-ADDWUCCPR    WCCCPR           Th Payment Net
     C                     Z-ADDWUA7VA    WCA7VA           TH Accrual Amou
     C                     MOVELWUJWST    WCJWST    P      TH Calc Net Sts
     C                     MOVELWUJ9ST    WCJ9ST    P      TH Payment Type
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YHRDCS
     C           YHRDC     ANDNE'N'
     C                     MOVE 'Y'       YHRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YHRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         NGEXIT    ENDSR
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * Clc Tattoo Dadd/nt    RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Rtv Ded GL Code       RT - Deduction/Addition  * 
     C                     EXSR SBRVGN
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WAHMNB           BOH Company Num
     C                     KFLD           WABNNB           BOH Buy Order N
     C                     KFLD           WABONB           BOL Load Number
     C                     KFLD           WACVNB           TH Tattoo Numbe
     C                     KFLD           WAB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDP1HMNB    WAHMNB           BOH Company Num
     C                     Z-ADDP1BNNB    WABNNB           BOH Buy Order N
     C                     Z-ADDP1BONB    WABONB           BOL Load Number
     C                     Z-ADDP1CVNB    WACVNB           TH Tattoo Numbe
     C                     Z-ADDP1B0DT    WAB0DT           TH Kill Date
      * Establish starting position
     C           KRSSA     CHAIN@A1CPC4              90    *
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
      * CASE: PAR.Ded/Add/Net Pay Usr is Paid no del or Create
     C           P2JGST    IFEQ 'P'                        *IF
      * Accumulate any da's and net pay
      * CASE: DB1.TH Payment Sts is Live anything
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'PL'
     C           WACWST    OREQ 'NL'
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
      * Set Live Gross and Payment Gross to Zeros and all net's to zero
     C                     EXSR UBSUBR                     Set Live Gross
     C                     MOVEL'C'       WUJWST           TH Calc Net Sts
      * accumulate d/a and accumulate tattoo header totals
      * CASE:
      *  - c1 OR c2 OR c3
      *   |- c1    : DB1.TH Payment Gross is Not Zeros
      *   |- c2    : DB1.TH Deduction Amt is Not Zeros
      *   |- c3    : DB1.TH Additions Amt is Not Zeros
      *   '-
     C           WACBPR    IFNE 0                          *IF
     C           WAASPR    ORNE 0                          *OR
     C           WAA5VA    ORNE 0                          *OR
      * If live and paid then calculate carcass net pay
     C                     EXSR UCSUBR                     If live and pai
     C                     END                             *FI
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WACPST' defaulted for 'TH Live Purchase UOM'.
      * Field '(DB1) WAACPR' defaulted for 'TH Live Purchase Price'.
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
     C                     EXSR SCCHRC
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Not paid
      * Create d/a for live or carcass unpaid
      * CASE: Live Payments or Carcass Payments
      *  - c1 OR c2
      *   |- c1    : DB1.TH Payment Sts is Live Payment
      *   |- c2    : DB1.TH Payment Sts is Carcass Merit Payment
      *   '-
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C           WACWST    OREQ 'NL'
     C           WACWST    OREQ 'SC'                       *OR
     C           WACWST    OREQ 'IC'
      * Set Live Gross and Payment Gross to Zeros and all net's to zero
     C                     EXSR UESUBR                     Set Live Gross
      * Create D/A and calculate Net Pay, or Delete D/A and cal Net Pay
      * CASE: PAR.Ded/Add/Net Pay Usr is Create ded/Add/Net Pay
     C           P2JGST    IFEQ 'C'                        *IF
     C                     MOVEL'C'       WUJWST           TH Calc Net Sts
      * Clc Live Gross and Payment Gross
     C                     EXSR UFSUBR                     Clc Live Gross
      * Routine to create any D/A's
      * Rtv Site ID            RT - Tattoo Header EXT  * 
     C                     EXSR SFRVGN
      * Rtv Prod Loc Dlv CoMilRT - Producer Site Mileage  * 
     C                     EXSR SGRVGN
      * If any plant transaction then create them
      * Clc Plant Ded/Add     RT - Deduction/Addition  * 
     C                     EXSR SHRVGN
      * Freight Transaction
      * CASE: DB1.TH Freight Amount is Not Zeros
     C           WACDPR    IFNE 0                          *IF
     C                     MOVEL'F'       WUPFST           THD Expense Typ
      * Rtv Exp Paid By Who - Buy Order Load  * 
     C                     EXSR SJRVGN
     C                     MOVELWUO8ST    WUPEST           THD Expense Pai
      * CASE: WRK.BOL Freight Exp Paid By is Seaboard
     C           WUO8ST    IFEQ 'S'                        *IF
     C                     MOVEL'+'       WUJBST           THD Unit Amt Si
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'-'       WUJBST           THD Unit Amt Si
     C                     END                             *FI
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SKCRRC
     C                     END                             *FI
      * Process Producer D/A for Fixed and Variable
      * Clc a Tattoo Prod D/A RT - Producer Std D/A  * 
     C                     EXSR SLRVGN
      * Clc a Tatt Prd/Lc D/A RT - Producer Loc Std D/A  * 
     C                     EXSR TIRVGN
      * Accumulate d/a and calculate net pay
     C                     EXSR UHSUBR                     Accumulate d/a
     C                     END                             *FI
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
     C                     EXSR NGCHRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * Rtv Ded GL Code       RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WBBQCD           DED D/A Code
      * Setup key
     C                     MOVE *BLANK    WBBQCD           DED D/A Code
     C                     MOVEL'FRT'     WBBQCD           DED D/A Code
      * Establish starting position
     C           KRSSB     CHAIN@BBRED5              90    *
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWBF7TX    WUDQCD           DED Gl Code
     C                     MOVELWBE2CD    WUE4CD           DED Contra Gl C
     C                     ENDIF
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCCHRC    BEGSR
      *================================================================
      * Chg Tto Ded/Add/Net   CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0002 10        TH Group Refere
     C                     MOVEL*BLANK    WN0003  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0004  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0005  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0006  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0007  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0008  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0009  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0010  50       TH Held Over
     C                     Z-ADD*ZERO     WN0011  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0012  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0013  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0014  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0015  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0016  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0017  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0018  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0019  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0020  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0021  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0022  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0023  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0024  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0025  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0026  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0027  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0028  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0029  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0030  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0031  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0032  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0033  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0034  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0035  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0036  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0037  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0038  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0039  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0040  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0041  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0042  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0043  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0044  1        TH Header Error
     C                     MOVEL*BLANK    WN0045  1        TH Detail Error
     C                     MOVEL*BLANK    WN0046  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0047  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0048  80       TH Commission A
     C                     Z-ADD*ZERO     WN0049  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0050  1        TH User Error O
     C                     MOVEL*BLANK    WN0051  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0052  1        TH Sex
     C                     Z-ADD*ZERO     WN0053  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0054  70       TH Commission P
     C                     Z-ADD*ZERO     WN0055  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0056  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0057  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0058  31       TH FFLI
     C                     Z-ADD*ZERO     WN0059  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0060  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0061  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0062  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0063  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0064  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0065  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0066  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0067  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0068  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0069  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0070  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0071  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0072  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0073  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0074  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0075  1        TH Source Type
     C                     MOVEL*BLANK    WN0076  1        TH Scale Ticket
     C                     Z-ADD*ZERO     WN0077  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0078  3        TH Source Code
     C                     MOVEL*BLANK    WN0079  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0080  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0081  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0082  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0083  3        TH State
     C                     MOVEL*BLANK    WN0084  3        TH Unused Code
     C                     MOVEL*BLANK    WN0085  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0086  1        TH Commission S
     C                     MOVEL*BLANK    WN0087  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0088  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0089  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0090  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0091  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0092  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0093  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0094  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0095  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0096  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0097  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0098  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0099  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0100  3        TH PHA Average
     C                     MOVEL*BLANK    WN0101  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0102  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0103  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0104  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0105  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0106  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0107  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0108  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0109  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0110  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0111  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0112  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0113  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0114 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0115 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0116 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0117 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0118  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0119  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0120  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0121  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0122  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0123  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0124  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0125  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0126  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0127  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0128  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0129  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0130  70       TH Unused Date
     C                     MOVEL*BLANK    WN0131  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0132  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0133  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0134  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0135  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0136  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0137  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0138  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0139  6        DF Defect Code
     C                     MOVEL*BLANK    WN0140  6        THP Process Cod
     C                     MOVEL*BLANK    WN0141  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0142  6        PL Location Cod
     C                     MOVEL*BLANK    WN0143  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0144  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0145  3        HC Class Code
     C                     MOVEL*BLANK    WN0146 10        RS User Added
     C                     Z-ADD*ZERO     WN0147  70       RS Date Added
     C                     Z-ADD*ZERO     WN0148  60       RS Time Added
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWAHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WCBONB           BOL Load Number
     C                     Z-ADDWACVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSC    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSC    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SCEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SCEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YARDCS
      * Move non-key fields to @A1CPC5
     C                     MOVELWACPST    WCCPST    P      TH Live Purchas
     C                     Z-ADDWAACPR    WCACPR           TH Live Purchas
     C                     Z-ADDWAB9PR    WCB9PR           TH Live Gross A
     C                     Z-ADDWACAPR    WCCAPR           TH LIve Net Amt
     C                     Z-ADDWAASPR    WCASPR           TH Deduction Am
     C                     Z-ADDWUA4VA    WCA4VA           TH Total Net WO
     C                     Z-ADDWUATPR    WCATPR           TH Carcass Net
     C                     Z-ADDWAA5VA    WCA5VA           TH Additions Am
     C                     Z-ADDWACBPR    WCCBPR           TH Payment Gros
     C                     Z-ADDWACCPR    WCCCPR           Th Payment Net
     C                     Z-ADDWAA7VA    WCA7VA           TH Accrual Amou
     C                     MOVELWUJWST    WCJWST    P      TH Calc Net Sts
     C                     MOVELWAJ9ST    WCJ9ST    P      TH Payment Type
     C                     MOVEL##USR     WCAAVN    P      RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVELWAAJST    WCAJST    P      RS Record Statu
     C                     MOVEL##JOB     WCAHVN    P      RS Job
     C                     MOVEL##PGM     WCAGVN    P      RS Program
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
      * Rtv Change Stamp      IF
     C                     MOVEL##USR     WCAAVN           RS User Changed
     C                     Z-ADD##JDT     WCAADT           RS Date Changed
     C                     Z-ADD##JTM     WCAMTM           RS Time Changed
     C                     MOVEL##JOB     WCAHVN           RS Job
     C                     MOVEL##PGM     WCAGVN           RS Program
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * Clc Live Price        RT - Tattoo Defect  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0149  72       TH Live Gross A
     C                     MOVEL*BLANK    WN0150  3        DF Commodity Ma
     C                     MOVEL*BLANK    WN0151  7        DF Commodity Gr
     C                     MOVEL*BLANK    WN0152  3        DF Market Date
     C                     Z-ADD*ZERO     WN0153  52       DF Market Perce
     C                     MOVEL*BLANK    WN0154  2        Pricing UOM USR
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0002           TH Live Purchas
     C                     Z-ADD*ZERO     WN0149           TH Live Gross A
     C                     MOVEL*BLANK    WN0150           DF Commodity Ma
     C                     MOVEL*BLANK    WN0151           DF Commodity Gr
     C                     MOVEL*BLANK    WN0152           DF Market Date
     C                     Z-ADD*ZERO     WN0153           DF Market Perce
     C                     MOVEL*BLANK    WN0154           Pricing UOM USR
     C                     Z-ADD*ZERO     YL0003           Count USR
      * Declare restrictor key work fields
     C           *LIKE     DEFN WDHMNB    WQSD01           BOH Company Num
     C           *LIKE     DEFN WDBNNB    WQSD02           BOH Buy Order N
     C           *LIKE     DEFN WDBONB    WQSD03           BOL Load Number
     C           *LIKE     DEFN WDCVNB    WQSD04           TH Tattoo Numbe
     C           *LIKE     DEFN WDB0DT    WQSD05           TH Kill Date
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WQSD01           BOH Company Num
     C                     KFLD           WQSD02           BOH Buy Order N
     C                     KFLD           WQSD03           BOL Load Number
     C                     KFLD           WQSD04           TH Tattoo Numbe
     C                     KFLD           WQSD05           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WQSD01           BOH Company Num
     C                     Z-ADDWABNNB    WQSD02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSD03           BOL Load Number
     C                     Z-ADDWACVNB    WQSD04           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WQSD05           TH Kill Date
      * Establish starting position
     C           KRSSD     SETLL@DZREX3                    *
     C           KRSSD     READE@DZREX3                  90*
      * Data record not found
     C   90                MOVEL'PRK0738' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  1         YL0003           Count USR
      * Rtv Defect Price Info RT - Hog Defect  * 
     C                     EXSR SERVGN
      * CASE: PAR.DF Market Percent is Entered
     C           WN0153    IFGT 0                          *IF
      * RTV Market Price      XF - STR Order Management Sys  * 
     C                     CALL 'PDMWXFR'              90  RTV Market Pric
     C                     PARM W0RTN     WQ0001  7        *Return code
     C                     PARM WN0150    WQ0002  3        PSC Commodity M
     C                     PARM WN0151    WQ0003  7        PSC Commodity P
     C                     PARM WDB0DT    WQ0004  70       TH Purchase Dat
     C                     PARM *ZERO     WQ0005  70       Date To   USR
     C           YL0004    PARM *ZERO     WQ0006 114       OMS Market Pric
     C           YL0005    PARM *ZERO     WQ0007  70       Pricing Date US
     C                     PARM WDHMNB    WQ0008  30       BOH Company Num
     C                     PARM WN0152    WQ0009  3        BOH Market Date
     C                     PARM 'H'       WQ0010  1        System Used
     C           YL0006    PARM *BLANK    WQ0011  5        OMS Error Retur
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDMWXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.OMS Market Price Amt Usr NE LCL.Zero USR
     C           YL0004    IFNE YL0007                     *IF
      * Rtv Commod Group U/M  XF - STR Order Management Sys  * 
     C                     CALL 'PDUVXFR'              90  Rtv Commod Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0151    WQ0012  7        BOH Commodity P
     C           WN0154    PARM *BLANK    WQ0013  2        Pricing UOM USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           WN0154    IFEQ 'CW'                       *IF
      * Process special Hog CUTOUT price group      slm 05/3/2013
      * CASE: Hard Code for hog cutout and will stay as such
      *  - c1 AND c2
      *   |- c1    : PAR.DF Commodity Group is CUTOUT
      *   |- c2    : PAR.DF Commodity Market is Hog Purchasing
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0151    IFEQ @CN,001                    *IF
     C           WN0150    IFEQ 'HOG'                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Hog Cutout - Hard code for special features.
     C                     EXSR UGSUBR                     Hog Cutout - Ha
      * Rtv Company Value Nbr XF - STR Order Management Sys  * 
     C                     CALL 'PDHGXFR'              90  Rtv Company Val
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0014  30       BOH Company Num
     C                     PARM @CN,001   WQ0015 10        Company Value C
     C           YL0008    PARM *ZERO     WQ0016 155       System Value Nu
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDHGXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: LCL.System Value Numeric  USR GT WRK.Zero USR
     C           YL0008    IFGT WUE9NB                     *IF
     C           YL0008    DIV  100       YL0009           Percent Decimal
     C           YL0009    MULT YL0004    YL0004           OMS Market Pric
     C                     END                             *FI
     C                     END                             *FI
      * Live Price
      * PAR.TH Live Purchase Price =
      *    *COMPUTE ((x1 * x4) * (x2 / x3))
      * x1    : LCL.OMS Market Price Amt Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x4    : CON..74
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.DF Market Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           YL0004    MULT .74       W0WA01    H      *Synon (15,2) w
     C           WN0153    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0002           TH Live Purchas
     C                     ELSE
      * CASE: PAR.Pricing UOM USR is Live Hundred Weight
     C           WN0154    IFEQ 'LW'                       *IF
      * Live Price
      * PAR.TH Live Purchase Price =
      *    *COMPUTE (x1 * (x2 / x3))
      * x1    : LCL.OMS Market Price Amt Usr
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.DF Market Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WN0153    DIV  100       W0WB01    H      *Synon (15,5) w
     C           YL0004    MULT W0WB01    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0002           TH Live Purchas
     C                     END                             *FI
     C                     END                             *FI
      * Live Gross Amount
      * PAR.TH Live Gross Amt =
      *    *COMPUTE (x1 + (x2 * ((x3 / x4) * x5)))
      * x1    : PAR.TH Live Gross Amt
      * +     : PGM.*Synon (15,2) work field
      * x2    : PAR.TH Live Purchase Price
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Avg Live Wgt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x5    : DB1.TDF Head Defect
     C           WAF7NB    DIV  100       W0WB03    H      *Synon (15,5) w
     C           W0WB03    MULT WDLJNB    W0WB02           *Synon (15,5) w
     C           YL0002    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           WN0149    ADD  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WN0149           TH Live Gross A
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0002           TH Live Purchas
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0002           TH Live Purchas
     C                     GOTO SDEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSD     READE@DZREX3                  90*
     C                     ENDDO
      * USER: Exit processing
      * CASE: LCL.Count USR is Greater than 1
     C           YL0003    IFGT 1                          *IF
      * Average Live Price
      * PAR.TH Live Purchase Price =
      *    *COMPUTE ((x1 / x2) * x3)
      * x1    : PAR.TH Live Gross Amt
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.TH Live Wgt
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : CON.100
     C           WN0149    DIV  WACYNB    W0WB01    H      *Synon (15,5) w
     C           W0WB01    MULT 100       W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0002           TH Live Purchas
     C                     END                             *FI
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * Rtv Defect Price Info RT - Hog Defect  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBDCD           DF Defect Code
      * Setup key
     C                     MOVELWDBDCD    WEBDCD           DF Defect Code
      * Establish starting position
     C           KRSSE     CHAIN@A7REC1              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0073' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0150           DF Commodity Ma
     C                     MOVEL*BLANK    WN0151           DF Commodity Gr
     C                     MOVEL*BLANK    WN0152           DF Market Date
     C                     Z-ADD*ZERO     WN0153           DF Market Perce
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEHYCD    WN0150           DF Commodity Ma
     C                     MOVELWEHZCD    WN0151           DF Commodity Gr
     C                     MOVELWEVYST    WN0152           DF Market Date
     C                     Z-ADDWEAEA1    WN0153           DF Market Perce
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * Rtv Site ID            RT - Tattoo Header EXT  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WFHMNB           BOH Company Num
     C                     KFLD           WFBNNB           BOH Buy Order N
     C                     KFLD           WFBONB           BOL Load Number
     C                     KFLD           WFCVNB           TH Tattoo Numbe
     C                     KFLD           WFB0DT           TH Kill Date
      * Setup key
     C                     Z-ADDWAHMNB    WFHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WFBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WFBONB           BOL Load Number
     C                     Z-ADDWACVNB    WFCVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WFB0DT           TH Kill Date
      * Establish starting position
     C           KRSSF     CHAIN@DNCPUY              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0637' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WUNYCD           PS Site ID
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFNYCD    WUNYCD           PS Site ID
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * Rtv Prod Loc Dlv CoMilRT - Producer Site Mileage  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WGABCD           PD Producer Cod
     C                     KFLD           WGNYCD           PS Site ID
     C                     KFLD           WGLKA1           PSM Company Num
      * Setup key
     C                     MOVELWAABCD    WGABCD           PD Producer Cod
     C                     MOVELWUNYCD    WGNYCD           PS Site ID
     C                     Z-ADDWAHMNB    WGLKA1           PSM Company Num
      * Establish starting position
     C           KRSSG     CHAIN@ASREK9              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK1132' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0010           PSM Miles to Co
     C                     GOTO SGEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGLLA1    YL0010           PSM Miles to Co
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * Clc Plant Ded/Add     RT - Deduction/Addition  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Establish starting position
     C           *LOVAL    SETLL@BBREN3                    *
     C                     READ @BBREN3                  90*
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.DED Plant Deduction is Plant Transaction
      *   |- c2    : DB1.DED Fix/Var/Sys is Fixed
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WHI2ST    IFEQ 'Y'                        *IF
     C           WHB9ST    IFEQ 'F'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : PAR.TH Hog Class Type is Resale
      *   |- c2    : DB1.DED Include Resale is Yes
      *   |- c3    : PAR.TH Hog Class Type is Market
      *   |- c4    : DB1.DED Include Market is Yes
      *   |- c5    : PAR.TH Hog Class Type is Subject
      *   |- c6    : DB1.DED Include Subject is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WALLST    IFEQ 'R'                        *IF
     C           WHNSST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'M'                        *IF
     C           WHNUST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'S'                        *IF
     C           WHNTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WHCAST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WHCAST    IFEQ 'FL'                       *IF
     C           WHAEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WHCAST    IFEQ 'DH'                       *IF
     C           WHCAST    OREQ 'RH'
     C           WHCAST    OREQ 'YH'
     C           WHCAST    OREQ 'CH'
     C           WHCAST    OREQ 'KH'
     C           WHCAST    OREQ 'NH'
     C           WHCAST    OREQ 'DY'
     C           WHCAST    OREQ 'RX'
     C           WHCAST    OREQ 'HM'
     C           WHCAST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WHCAST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WHCAST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WHCAST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WHCAST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WHCAST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WHCAST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WHCAST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WHCAST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WHCAST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WHAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WHCAST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WHAEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WHCAST    IFEQ 'CW'                       *IF
     C           WHCAST    OREQ 'LW'
     C           WHCAST    OREQ 'NL'
     C           WHCAST    OREQ 'SW'
     C           WHCAST    OREQ 'LX'
     C           WHCAST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WHCAST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WHAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WHCAST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WHAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WHCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WHAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WHCAST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WHAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WHCAST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WHAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WHCAST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WHAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WHCAST    IFEQ 'GV'                       *IF
     C           WHCAST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WHCAST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WHAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WHCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WHAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WHCAST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0022  30       BOH Company Num
     C                     PARM WAAWDT    WQ0023  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0024  71       TH Live Wgt
     C                     PARM WHBQCD    WQ0025  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0026  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WHAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WHCAST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WHCAST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WHAEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SICRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     READ @BBREN3                  90*
     C                     ENDDO
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SICRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWHBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWHAEPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWHI9ST    WIJBST           THD Unit Amt Si
     C                     MOVELWHCAST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWHF7TX    WIDPCD           THD GL Code
     C                     MOVELWHE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVEL'P'       WIPEST           THD Expense Pai
     C                     MOVEL'O'       WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL*BLANK    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSI    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSI    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Exp Paid By Who - Buy Order Load  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WJHMNB           BOH Company Num
     C                     KFLD           WJBNNB           BOH Buy Order N
     C                     KFLD           WJBONB           BOL Load Number
      * Setup key
     C                     Z-ADDWAHMNB    WJHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WJBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WJBONB           BOL Load Number
      * Establish starting position
     C           KRSSJ     CHAIN@AXCPBX              90    *
      * Data record not found
     C   90                MOVEL'PRK0051' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWJO8ST    WUO8ST           BOL Freight Exp
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVE *BLANK    WIBQCD           DED D/A Code
     C                     MOVEL'FRT'     WIBQCD           DED D/A Code
     C                     Z-ADD*ZERO     WIAZVA           THD Unit Amt
     C                     Z-ADDWACDPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWUJBST    WIJBST           THD Unit Amt Si
     C                     MOVEL'FL'      WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWUDQCD    WIDPCD           THD GL Code
     C                     MOVELWUE4CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL*BLANK    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSK    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSK    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SKEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Clc a Tattoo Prod D/A RT - Producer Std D/A  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKABCD    WQSL01           PD Producer Cod
     C           *LIKE     DEFN WKZCA1    WQSL02           PSDP Company Nu
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL01           PD Producer Cod
     C                     KFLD           WQSL02           PSDP Company Nu
      * Setup key
     C                     MOVELWAABCD    WQSL01           PD Producer Cod
     C                     Z-ADDP1HMNB    WQSL02           PSDP Company Nu
      * Establish starting position
     C           KRSSL     SETLL@BERELS                    *
     C           KRSSL     READE@BERELS                  90*
      * Data record not found
     C   90                MOVEL'PRK0087' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Date 03/24/2004 slm - Add logic for TFM Release 01 for all Ded/Ad
      *                       to verify the accept date and the decline d
      *                       before the creations of the D/A
     C                     MOVEL'Y'       WUYUST           Process Flag Us
     C                     Z-ADD*ZERO     WUE9NB           Zero USR
      * CASE: DB1.PSD Accept Date GT WRK.Zero USR
     C           WKC0DT    IFGT WUE9NB                     *IF
      * CASE: PAR.TH Purchase Date LT DB1.PSD Accept Date
     C           WAAWDT    IFLT WKC0DT                     *IF
     C                     MOVEL'N'       WUYUST           Process Flag Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.PSD Decline Date GT WRK.Zero USR
     C           WKC1DT    IFGT WUE9NB                     *IF
      * CASE: PAR.TH Purchase Date GT DB1.PSD Decline Date
     C           WAAWDT    IFGT WKC1DT                     *IF
     C                     MOVEL'N'       WUYUST           Process Flag Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Process Flag User is Yes
     C           WUYUST    IFEQ 'Y'                        *IF
      * Clc Prd Ded/Add       Rt - Deduction/Addition  * 
     C                     EXSR SMRVGN
     C                     END                             *FI
     C           KRSSL     READE@BERELS                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Clc Prd Ded/Add       Rt - Deduction/Addition  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0155  72       Var Net Pay Usr
     C                     Z-ADD*ZERO     WN0156  52       Tot Cost Live C
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WLBQCD           DED D/A Code
      * Setup key
     C                     MOVELWKBQCD    WLBQCD           DED D/A Code
      * Establish starting position
     C           KRSSM     CHAIN@BBRELJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     MOVEL'N'       WUMXST           Record was sele
      * Valid selection on weither to create the record
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : DB1.DED Plant Deduction is Not Yes
      *   |- c2    : DB1.DED Fix/Var/Sys is Fixed
      *   |- c3    : DB1.DED Fix/Var/Sys is Variable
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WLI2ST    IFEQ *BLANK                     *IF
     C           WLI2ST    OREQ 'N'
     C                     MOVEL'0'       Y0CX02  1
     C           WLB9ST    IFEQ 'F'                        *IF
     C           WLB9ST    OREQ 'V'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : PAR.TH Hog Class Type is Resale
      *   |- c2    : DB1.DED Include Resale is Yes
      *   |- c3    : PAR.TH Hog Class Type is Market
      *   |- c4    : DB1.DED Include Market is Yes
      *   |- c5    : PAR.TH Hog Class Type is Subject
      *   |- c6    : DB1.DED Include Subject is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WALLST    IFEQ 'R'                        *IF
     C           WLNSST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'M'                        *IF
     C           WLNUST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'S'                        *IF
     C           WLNTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUMXST           Record was sele
     C                     END                             *FI
     C                     END                             *FI
      * 41404 slm add PC Contract code and PSC subcontract code
      * Rtv Buy Order Type - Buy Order Header  * 
     C                     EXSR SNRVGN
      * Validate to create tattoo ded/add based on Buy Order Type
      * CASE: WRK.Record was selected usr is *YES
     C           WUMXST    IFEQ 'Y'                        *IF
      * CASE: WRK.BOH Buy Order Type is Contract
     C           WUA5ST    IFEQ 'C'                        *IF
      * CASE: DB1.DED Valid BO Type is Contract List
     C           WLNZST    IFEQ 'C'                        *IF
     C           WLNZST    OREQ '1'
     C           WLNZST    OREQ '2'
     C           WLNZST    OREQ *BLANK
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
      * CASE: DB1.DED Valid BO Type is Internal List
     C           WLNZST    IFEQ '1'                        *IF
     C           WLNZST    OREQ *BLANK
     C           WLNZST    OREQ 'I'
     C           WLNZST    OREQ '3'
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.BOH Buy Order Type is Open Market
     C           WUA5ST    IFEQ 'O'                        *IF
      * CASE: DB1.DED Valid BO Type is Open List
     C           WLNZST    IFEQ '2'                        *IF
     C           WLNZST    OREQ *BLANK
     C           WLNZST    OREQ 'O'
     C           WLNZST    OREQ '3'
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create the Tattoo Ded/Add
      * CASE: WRK.Record was selected usr is *YES
     C           WUMXST    IFEQ 'Y'                        *IF
     C                     MOVEL'O'       WUPFST           THD Expense Typ
     C                     MOVEL'N'       WUPIST           THD Commission
      * CASE: DB1.DED Commission Deduction is Yes
     C           WLN1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUPIST           THD Commission
     C                     END                             *FI
     C                     MOVELWKN2ST    WUPEST           THD Expense Pai
      * CASE: DB1.DED Fix/Var/Sys is Fixed
     C           WLB9ST    IFEQ 'F'                        *IF
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WLCAST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WLCAST    IFEQ 'FL'                       *IF
     C           WLAEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WLCAST    IFEQ 'DH'                       *IF
     C           WLCAST    OREQ 'RH'
     C           WLCAST    OREQ 'YH'
     C           WLCAST    OREQ 'CH'
     C           WLCAST    OREQ 'KH'
     C           WLCAST    OREQ 'NH'
     C           WLCAST    OREQ 'DY'
     C           WLCAST    OREQ 'RX'
     C           WLCAST    OREQ 'HM'
     C           WLCAST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WLCAST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WLCAST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WLCAST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WLCAST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WLCAST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WLCAST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WLCAST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WLCAST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WLCAST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WLCAST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WLAEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WLCAST    IFEQ 'CW'                       *IF
     C           WLCAST    OREQ 'LW'
     C           WLCAST    OREQ 'NL'
     C           WLCAST    OREQ 'SW'
     C           WLCAST    OREQ 'LX'
     C           WLCAST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WLCAST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WLCAST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WLCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WLCAST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WLCAST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WLCAST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WLCAST    IFEQ 'GV'                       *IF
     C           WLCAST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WLCAST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WLAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WLCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WLAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WLCAST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0027  30       BOH Company Num
     C                     PARM WAAWDT    WQ0028  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0029  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0030  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0031  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WLAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WLCAST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WLCAST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WLAEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr is Not Zeros
     C           WUCFPR    IFNE 0                          *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SOCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR SPRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.DED Fix/Var/Sys is Variable
     C           WLB9ST    IFEQ 'V'                        *IF
      * Create the D/A for Special Proc and Normal Proc
      * CASE: DB1.DED Prdcr Special Proc NE WRK.Blank USR
     C           WLNXST    IFNE WUCRTX                     *IF
      *
     C                     MOVEL*BLANK    WN0312  2        Pricing UOM USR
      *
      * Clc D/A f/Prdcr Spcl  IF
      * Insurance Reimbursement Hd calculation
      * CASE: PAR.DED Prdcr Special Proc is Insurance Reimbursement
     C           WLNXST    IFEQ 'I'                        *IF
      * Retrieve Reimb. hd total for paid tattoos on the BOL
      * Rtv BOL Reimb hd sum  RT - Tattoo Ded/Add  * 
     C                     EXSR SRRVGN
     C                     Z-ADD*ZERO     WUDENB           Re-imbursement
     C                     Z-ADD*ZERO     WULLPR           Re-imbursement
     C                     Z-ADD*ZERO     WUDWNB           Re-imbursement
      * Move the correct head into work field to calc head to be paid ful
      * CASE: PAR.PSD Variable UOM is Head UOM
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WKEVST    OREQ 'RH'
     C           WKEVST    OREQ 'YH'
     C           WKEVST    OREQ 'CH'
     C           WKEVST    OREQ 'KH'
     C           WKEVST    OREQ 'NH'
     C           WKEVST    OREQ 'DY'
     C           WKEVST    OREQ 'RX'
     C           WKEVST    OREQ 'HM'
     C           WKEVST    OREQ 'DE'
      * CASE: PAR.PSD Variable UOM is Condemned Head
     C           WKEVST    IFEQ 'CH'                       *IF
     C                     Z-ADDWAFDNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA Head
     C           WKEVST    IFEQ 'DH'                       *IF
     C                     Z-ADDWACXNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Yard Deads Head
     C           WKEVST    IFEQ 'YH'                       *IF
     C                     Z-ADDWAFCNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA Head + Yard Dead Head
     C           WKEVST    IFEQ 'DY'                       *IF
     C           WAFCNB    ADD  WACXNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA HD + Yard Dead + EUT
     C           WKEVST    IFEQ 'DE'                       *IF
     C           WAFCNB    ADD  WACXNB    WUDENB           Re-imbursement
     C                     ADD  WAEDDT    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Killed Head
     C           WKEVST    IFEQ 'KH'                       *IF
     C                     Z-ADDWAFENB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Net Head
     C           WKEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move the correct Price and Wgt into work fields
      * CASE: PAR.THD Payment Sts is Live anything
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'PL'
     C           WACWST    OREQ 'NL'
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C                     Z-ADDYL0002    WULLPR           Re-imbursement
      * CASE: PAR.TH Live Purchase UOM is Shipped Weight List
     C           YL0001    IFEQ 'SW'                       *IF
     C           YL0001    OREQ 'SX'
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is Not Zero
     C           WUEXNB    IFNE 0                          *IF
     C           WAHGNB    DIV  WUEXNB    WUDWNB           Re-imbursement
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAF7NB    WUDWNB           Re-imbursement
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.THD Payment Sts is Carcass anything
     C           WACWST    IFEQ 'PC'                       *IF
     C           WACWST    OREQ 'NC'
     C           WACWST    OREQ 'SC'
     C           WACWST    OREQ 'IC'
     C                     Z-ADDWAF7NB    WUDWNB           Re-imbursement
      *
     C                     MOVEL*BLANK    WN0313  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0314  7        BOH Commodity P
      *
      * Rtv comm grp/OMS Uom   IF
      * Rtv Comm/Group        RT - Buy Order Header  * 
     C                     EXSR SSRVGN
      * Rtv Commod Group U/M  XF - STR Order Management Sys  * 
     C                     CALL 'PDUVXFR'              90  Rtv Commod Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0314    WQ0032  7        BOH Commodity P
     C           WN0312    PARM *BLANK    WQ0033  2        Pricing UOM USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           WN0312    IFEQ 'CW'                       *IF
      * Convert the Meat price to a Live Price
     C           .74       MULT WAAMPR    WULLPR           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAAMPR    WULLPR           Re-imbursement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calculate if there are Head and the limit hasnt already been reac
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Re-imbursement hd NEW USR is Greater than 0
      *   |- c2    : WRK.Re-imbursement head totl is Less than upper limi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDENB    IFGT 0                          *IF
     C           WUDDNB    IFLT 4                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WUDFNB           Re-imbursement
     C                     Z-ADD*ZERO     WUDGNB           Re-imbursement
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     Z-ADD*ZERO     WUCEPR           Trans Unit Amt
      * Reduce the Tattoos head count as head are accumed either full or
      * DO WHILE: WRK.Re-imbursement hd NEW USR is Greater than 0
     C           WUDENB    DOWGT0                          *DOW
     C                     SUB  1         WUDENB           Re-imbursement
     C                     ADD  1         WUDDNB           Re-imbursement
      * Accum hd to be paid full and head to be paid half value.
      * CASE: WRK.Re-imbursement head totl is Less than/eq full limit 2
     C           WUDDNB    IFLE 4                          *IF
     C                     ADD  1         WUDFNB           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Re-imbursement head totl is Less than/eq half limit 4
     C           WUDDNB    IFLE 0                          *IF
     C                     ADD  1         WUDGNB           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
      * Fall-out because the limit has been reached.
     C                     Z-ADD*ZERO     WUDENB           Re-imbursement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *ITR
      * CASE: WRK.Re-imbursement full   USR is Greater than 0
     C           WUDFNB    IFGT 0                          *IF
      * Compute: Paid Full value
      * WRK.Trans Extended Amt Usr =
      *    *COMPUTE ((x1 * (x2 / x3)) * x4)
      * x1    : WRK.Re-imbursement Price  USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Re-imbursement Wgt    USR
      * /     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Re-imbursement full   USR
     C           WUDWNB    DIV  100       W0WA02           *Synon (15,2) w
     C           WULLPR    MULT W0WA02    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUDFNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
      * CASE: WRK.Re-imbursement half   USR is Greater than 0
     C           WUDGNB    IFGT 0                          *IF
      * Compute: Paid Half value
      * WRK.Trans Unit Amt Usr =
      *    *COMPUTE (((x1 * (x2 / x3)) / x5) * x4)
      * x1    : WRK.Re-imbursement Price  USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Re-imbursement Wgt    USR
      * /     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
      * /     : PGM.*Synon (15,2) work field *
      * x5    : CON.2
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Re-imbursement half   USR
     C           WUDWNB    DIV  100       W0WA03           *Synon (15,2) w
     C           WULLPR    MULT W0WA03    W0WA02    H      *Synon (15,2) w
     C           W0WA02    DIV  2         W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WUDGNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCEPR           Trans Unit Amt
      * Add calc'd half value to calc'd full value
     C                     ADD  WUCEPR    WUCFPR           Trans Extended
     C                     END                             *FI
      * Add calc'd half hd & calc'd full hd  to total re-imb hd for new r
     C           WUDFNB    ADD  WUDGNB    WUAQNB           THD Re-imbursem
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR STCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.DED Prdcr Special Proc is Yard Dead Reimbursement
     C           WLNXST    IFEQ 'Y'                        *IF
      * If the Tattoo is hold over.
      * CASE:
      *  - c2 AND c3
      *   |- c2    : PAR.TH Held Over Record is Yes
      *   |- c3    : PAR.TH Yard Deads is Not Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAE1ST    IFEQ 'Y'                        *IF
     C           WAFCNB    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Held Over KillDts RT - Tattoo Header  * 
     C                     EXSR SURVGN
      * LCL.Held Over Days USR = PAR.TH Kill Date - LCL.Kill Date Usr *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0011    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WAB0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0012
     C                     ELSE
     C           XDURR     MULT -1        YL0012
     C                     END
      * CASE: LCL.Held Over Days USR is GT 1
     C           YL0012    IFGT 1                          *IF
      * Do not send in miles, this is yard reim.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
     C           WATAPR    MULT 1         YL0013           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WKEVST    OREQ 'RH'
     C           WKEVST    OREQ 'YH'
     C           WKEVST    OREQ 'CH'
     C           WKEVST    OREQ 'KH'
     C           WKEVST    OREQ 'NH'
     C           WKEVST    OREQ 'DY'
     C           WKEVST    OREQ 'RX'
     C           WKEVST    OREQ 'HM'
     C           WKEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WKEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WKEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WKEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WKEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WKEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WKEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WKEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WKEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WKEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WATAPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WKEVST    IFEQ 'CW'                       *IF
     C           WKEVST    OREQ 'LW'
     C           WKEVST    OREQ 'NL'
     C           WKEVST    OREQ 'SW'
     C           WKEVST    OREQ 'LX'
     C           WKEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WKEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WKEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WKEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WKEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WKEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WKEVST    IFEQ 'GV'                       *IF
     C           WKEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WKEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WKEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0034  30       BOH Company Num
     C                     PARM WAAWDT    WQ0035  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0036  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0037  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0038  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WKEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WKEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WATAPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Trans Extended Amt Usr NE WRK.Zero USR
     C           YL0013    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SVCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.DED Prdcr Special Proc is Deferred Payment
     C           WLNXST    IFEQ 'D'                        *IF
      * 41404 slm add for deferred payment TFM
      * Retrieve BREAK EVEN % from producer sub contract
      * Rtv PurchPrc Clc BrkEORT - Producer Sub-Contract  * 
     C                     EXSR SWRVGN
     C                     Z-ADD*ZERO     WUU5PR           Deferred Price
      * Deferred Price
      * WRK.Deferred Price Usr =
      *    *COMPUTE (x4 - (x1 * (x2 / x3)))
      * x4    : PAR.TH CM Base Mkt Price
      * -     : PGM.*Synon (15,2) work field
      * x1    : PAR.TH CM Market Price
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.PSC Break Even Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUA7PR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WAB8PR    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           WAAMPR    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUU5PR           Deferred Price
     C                     Z-ADDWUU5PR    WUCEPR           Trans Unit Amt
      * PLD miles = zero
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WAEDDT' defaulted for 'TH Head EUT/KOA'.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
     C           WUCEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WKEVST    OREQ 'RH'
     C           WKEVST    OREQ 'YH'
     C           WKEVST    OREQ 'CH'
     C           WKEVST    OREQ 'KH'
     C           WKEVST    OREQ 'NH'
     C           WKEVST    OREQ 'DY'
     C           WKEVST    OREQ 'RX'
     C           WKEVST    OREQ 'HM'
     C           WKEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WKEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WKEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WKEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WKEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WKEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WKEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WKEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WKEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WKEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WUCEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WKEVST    IFEQ 'CW'                       *IF
     C           WKEVST    OREQ 'LW'
     C           WKEVST    OREQ 'NL'
     C           WKEVST    OREQ 'SW'
     C           WKEVST    OREQ 'LX'
     C           WKEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WKEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WKEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WKEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WKEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WKEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WKEVST    IFEQ 'GV'                       *IF
     C           WKEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WKEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WKEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0039  30       BOH Company Num
     C                     PARM WAAWDT    WQ0040  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0041  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0042  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0043  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WKEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WKEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WUCEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR SXCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.DED Reserve Account Upd is Yes
     C           WLNWST    IFEQ 'Y'                        *IF
      * CASE: PAR.TH Payment Type is Live
     C           WAJ9ST    IFEQ 'L'                        *IF
     C                     Z-ADDYL0002    WN0156           Tot Cost Live C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAEGPR    WN0156           Tot Cost Live C
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0315  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0316  1        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0317  70       PFP Week Ending
     C                     Z-ADD*ZERO     WN0318  52       PFP Adjusted Fl
     C                     MOVEL*BLANK    WN0319  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0320  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0321  1        Balance Exists
      *
      * Clc Reserve Amount    IF
     C                     Z-ADD*ZERO     WN0155           Var Net Pay Usr
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
     C                     EXSR SYRVGN
      * Rtv Prior Sunday      XF - STR Order Management Sys  * 
     C                     CALL 'PDLNXFR'              90  Rtv Prior Sunda
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0044  30       Company Number
     C                     PARM WAAWDT    WQ0045  70       Kill Date Usr
     C           WN0317    PARM *ZERO     WQ0046  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Floor Price       RT - Producer SC Floor Price  * 
     C                     EXSR TARVGN
      * Val Reserv Acct Exists RT - Producer Cntrct RsvAct Hd  * 
     C                     EXSR TBRVGN
      * Calculate the unit price
      * CASE: PAR.Balance Exists USR is Yes
     C           WN0321    IFEQ 'Y'                        *IF
     C           WN0318    ADD  WN0315    W0WA             *Synon (15,2) w
      * Determine unit price if there is a reserve account balance
      * CASE: PAR.TH CM Gross Live /CWT GT PGM.*Synon (15,2) work field
     C           WN0156    IFGT W0WA                       *IF
     C                     Z-ADDW0WA      WN0155           Var Net Pay Usr
     C                     ELSE
      * CASE: PAR.TH CM Gross Live /CWT GT PAR.PFP Adjusted Floor Price
     C           WN0156    IFGT WN0318                     *IF
     C                     Z-ADDWN0156    WN0155           Var Net Pay Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0318    WN0155           Var Net Pay Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Determine unit price if there is no reserve account balance
      * CASE: PAR.TH CM Gross Live /CWT GT PAR.PFP Adjusted Floor Price
     C           WN0156    IFGT WN0318                     *IF
     C                     Z-ADDWN0156    WN0155           Var Net Pay Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0318    WN0155           Var Net Pay Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WN0156    WN0155           Var Net Pay Usr
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
     C           WN0155    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WKEVST    OREQ 'RH'
     C           WKEVST    OREQ 'YH'
     C           WKEVST    OREQ 'CH'
     C           WKEVST    OREQ 'KH'
     C           WKEVST    OREQ 'NH'
     C           WKEVST    OREQ 'DY'
     C           WKEVST    OREQ 'RX'
     C           WKEVST    OREQ 'HM'
     C           WKEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WKEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WKEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WKEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WKEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WKEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WKEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WKEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WKEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0155    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WKEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WN0155    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WKEVST    IFEQ 'CW'                       *IF
     C           WKEVST    OREQ 'LW'
     C           WKEVST    OREQ 'NL'
     C           WKEVST    OREQ 'SW'
     C           WKEVST    OREQ 'LX'
     C           WKEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WKEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0155    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WKEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0155    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0155    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WKEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0155    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WKEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0155    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WKEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0155    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WKEVST    IFEQ 'GV'                       *IF
     C           WKEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WKEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0155    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0155    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WKEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0047  30       BOH Company Num
     C                     PARM WAAWDT    WQ0048  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0049  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0050  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0051  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0155    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WKEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WKEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WN0155    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TCCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR TDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Normal processing for the d/a code
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WKEVST    IFEQ 'FL'                       *IF
     C           WKA1VA    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WKEVST    OREQ 'RH'
     C           WKEVST    OREQ 'YH'
     C           WKEVST    OREQ 'CH'
     C           WKEVST    OREQ 'KH'
     C           WKEVST    OREQ 'NH'
     C           WKEVST    OREQ 'DY'
     C           WKEVST    OREQ 'RX'
     C           WKEVST    OREQ 'HM'
     C           WKEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WKEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WKEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WKEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WKEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WKEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WKEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WKEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WKEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WKEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WKA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WKEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WKA1VA    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WKEVST    IFEQ 'CW'                       *IF
     C           WKEVST    OREQ 'LW'
     C           WKEVST    OREQ 'NL'
     C           WKEVST    OREQ 'SW'
     C           WKEVST    OREQ 'LX'
     C           WKEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WKEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WKA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WKEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WKA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WKA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WKEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WKA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WKEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WKA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WKEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WKA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WKEVST    IFEQ 'GV'                       *IF
     C           WKEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WKEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WKA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WKEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WKA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WKEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0052  30       BOH Company Num
     C                     PARM WAAWDT    WQ0053  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0054  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0055  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0056  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WKA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WKEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WKEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WKA1VA    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TFCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR TGRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Type - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WMBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSN     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMA5ST    WUA5ST           BOH Buy Order T
     C                     MOVELWMAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWMALCD    WUALCD           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SOCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWLAEPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWLI9ST    WIJBST           THD Unit Amt Si
     C                     MOVELWLCAST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVELWUPIST    WIPIST           THD Commission
     C                     MOVELWUPJST    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSO    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSO    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQSP01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQSP02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQSP03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQSP04           TH Kill Date
     C           *LIKE     DEFN WOCVNB    WQSP05           TH Tattoo Numbe
      * Define keylist
     C           KRSSP     KLIST
     C                     KFLD           WQSP01           BOH Company Num
     C                     KFLD           WQSP02           BOH Buy Order N
     C                     KFLD           WQSP03           BOL Load Number
     C                     KFLD           WQSP04           TH Kill Date
     C                     KFLD           WQSP05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSP01           BOH Company Num
     C                     Z-ADDWABNNB    WQSP02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSP03           BOL Load Number
     C                     Z-ADDWAB0DT    WQSP04           TH Kill Date
     C                     Z-ADDWACVNB    WQSP05           TH Tattoo Numbe
      * Establish starting position
     C           KRSSP     SETLL@A1CPOC                    *
     C           KRSSP     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR SQCHRC
     C           KRSSP     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0157  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0158 10        TH Group Refere
     C                     MOVEL*BLANK    WN0159  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0160  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0161  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0162  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0163  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0164  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0165  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0166  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0167  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0168  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0169  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0170  50       TH Held Over
     C                     Z-ADD*ZERO     WN0171  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0172  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0173  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0174  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0175  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0176  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0177  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0178  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0179  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0180  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0181  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0182  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0183  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0184  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0185  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0186  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0187  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0188  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0189  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0190  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0191  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0192  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0193  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0194  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0195  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0196  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0197  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0198  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0199  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0200  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0201  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0202  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0203  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0204  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0205  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0206  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0207  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0208  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0209  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0210  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0211  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0212  1        TH Header Error
     C                     MOVEL*BLANK    WN0213  1        TH Detail Error
     C                     MOVEL*BLANK    WN0214  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0215  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0216  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0217  1        TH User Error O
     C                     MOVEL*BLANK    WN0218  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0219  1        TH Sex
     C                     Z-ADD*ZERO     WN0220  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0221  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0222  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0223  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0224  31       TH FFLI
     C                     Z-ADD*ZERO     WN0225  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0226  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0227  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0228  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0229  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0230  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0231  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0232  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0233  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0234  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0235  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0236  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0237  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0238  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0239  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0240  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0241  1        TH Source Type
     C                     MOVEL*BLANK    WN0242  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0243  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0244  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0245  3        TH Source Code
     C                     MOVEL*BLANK    WN0246  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0247  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0248  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0249  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0250  3        TH State
     C                     MOVEL*BLANK    WN0251  3        TH Unused Code
     C                     MOVEL*BLANK    WN0252  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0253  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0254  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0255  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0256  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0257  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0258  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0259  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0260  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0261  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0262  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0263  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0264  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0265  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0266  3        TH PHA Average
     C                     MOVEL*BLANK    WN0267  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0268  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0269  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0270  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0271  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0272  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0273  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0274  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0275  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0276  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0277  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0278  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0279  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0280 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0281 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0282 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0283 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0284  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0285  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0286  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0287  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0288  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0289  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0290  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0291  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0292  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0293  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0294  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0295  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0296  70       TH Unused Date
     C                     MOVEL*BLANK    WN0297  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0298  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0299  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0300  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0301  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0302  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0303  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0304  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0305  6        DF Defect Code
     C                     MOVEL*BLANK    WN0306  6        THP Process Cod
     C                     MOVEL*BLANK    WN0307  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0308  6        PL Location Cod
     C                     MOVEL*BLANK    WN0309  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0310  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0311  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WCBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHSQ    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHSQ    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SQEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SQEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YBRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     MOVEL'C'       WCR5ST    P      TH Commission S
     C                     MOVELWOAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWOAADT    WCAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WCAMTM           RS Time Changed
     C                     MOVELWOAJST    WCAJST    P      RS Record Statu
     C                     MOVELWOAHVN    WCAHVN    P      RS Job
     C                     MOVELWOAGVN    WCAGVN    P      RS Program
     C                     MOVELWOABVN    WCABVN    P      RS User Added
     C                     Z-ADDWOABDT    WCABDT           RS Date Added
     C                     Z-ADDWOABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * Rtv BOL Reimb hd sum  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWUE9NB    WUDDNB           Re-imbursement
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRHMNB    WQSR01           BOH Company Num
     C           *LIKE     DEFN WRBNNB    WQSR02           BOH Buy Order N
     C           *LIKE     DEFN WRBONB    WQSR03           BOL Load Number
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WQSR01           BOH Company Num
     C                     KFLD           WQSR02           BOH Buy Order N
     C                     KFLD           WQSR03           BOL Load Number
      * Setup key
     C                     Z-ADDWAHMNB    WQSR01           BOH Company Num
     C                     Z-ADDWABNNB    WQSR02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSR03           BOL Load Number
      * Establish starting position
     C           KRSSR     SETLL@CDCPV4                    *
     C           KRSSR     READE@CDCPV4                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WRAQNB    WUDDNB           Re-imbursement
     C           KRSSR     READE@CDCPV4                  90*
     C                     ENDDO
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * Rtv Comm/Group        RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WMBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSS     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0313           BOH Commodity M
     C                     MOVEL*BLANK    WN0314           BOH Commodity P
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMETCD    WN0313           BOH Commodity M
     C                     MOVELWMEUCD    WN0314           BOH Commodity P
     C                     GOTO SSEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWULLPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWKJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWKEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUAQNB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL*BLANK    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRST    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRST    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SURVGN    BEGSR
      *================================================================
      * Rtv Held Over KillDts RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSHMNB    WQSU01           BOH Company Num
     C           *LIKE     DEFN WSBNNB    WQSU02           BOH Buy Order N
     C           *LIKE     DEFN WSBONB    WQSU03           BOL Load Number
     C           *LIKE     DEFN WSCVNB    WQSU04           TH Tattoo Numbe
      * Define keylist
     C           KRSSU     KLIST
     C                     KFLD           WQSU01           BOH Company Num
     C                     KFLD           WQSU02           BOH Buy Order N
     C                     KFLD           WQSU03           BOL Load Number
     C                     KFLD           WQSU04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQSU01           BOH Company Num
     C                     Z-ADDWABNNB    WQSU02           BOH Buy Order N
     C                     Z-ADDWABONB    WQSU03           BOL Load Number
     C                     Z-ADDWACVNB    WQSU04           TH Tattoo Numbe
      * Establish starting position
     C           KRSSU     SETLL@A1CPC7                    *
     C           KRSSU     READE@A1CPC7                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           WSB0DT    IFNE WAB0DT                     *IF
     C                     Z-ADDWSB0DT    YL0011           Kill Date Usr
     C                     GOTO SUEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSU     READE@A1CPC7                  90*
     C                     ENDDO
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWATAPR    WIAZVA           THD Unit Amt
     C                     Z-ADDYL0013    WIA0VA           THD Ded/Add Amo
     C                     MOVELWKJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWKEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWAFCNB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL*BLANK    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSV    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSV    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SVEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc BrkEORT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WTAKCD           PC Contract Cod
     C                     KFLD           WTALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    WTAKCD           PC Contract Cod
     C                     MOVELWUALCD    WTALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSW     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTA7PR    WUA7PR           PSC Break Even
     C                     ENDIF
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWUCEPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWKJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWKEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADD*ZERO     WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL'Y'       WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRSX    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRSX    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO SXEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYRVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSY     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WMBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSSY     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAKCD    WN0319           PC Contract Cod
     C                     MOVELWMALCD    WN0320           PSC Sub-Contrac
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
     C                     EXSR SZRVGN
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         SZRVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSZ     KLIST
     C                     KFLD           WTAKCD           PC Contract Cod
     C                     KFLD           WTALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWMAKCD    WTAKCD           PC Contract Cod
     C                     MOVELWMALCD    WTALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSSZ     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0315           PSC FLoor Price
     C                     MOVEL*BLANK    WN0316           PSC Sub-Contrac
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SZEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTA8PR    WN0315           PSC FLoor Price
     C                     MOVELWTF3ST    WN0316           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         SZEXIT    ENDSR
      /EJECT
     CSR         TARVGN    BEGSR
      *================================================================
      * RTV Floor Price       RT - Producer SC Floor Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTA     KLIST
     C                     KFLD           WVAKCD           PC Contract Cod
     C                     KFLD           WVALCD           PSC Sub-Contrac
     C                     KFLD           WVDJDT           PFP Week Ending
      * Setup key
     C                     MOVELWN0319    WVAKCD           PC Contract Cod
     C                     MOVELWN0320    WVALCD           PSC Sub-Contrac
     C                     Z-ADDWN0317    WVDJDT           PFP Week Ending
      * Establish starting position
     C           KRSTA     CHAIN@ECCPAG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0816' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0318           PFP Adjusted Fl
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWVODPR    WN0318           PFP Adjusted Fl
     C                     ENDIF
      *================================================================
     CSR         TAEXIT    ENDSR
      /EJECT
     CSR         TBRVGN    BEGSR
      *================================================================
      * Val Reserv Acct Exists RT - Producer Cntrct RsvAct Hd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0321           Balance Exists
      * Define keylist
     C           KRSTB     KLIST
     C                     KFLD           WWAKCD           PC Contract Cod
      * Setup key
     C                     MOVELWN0319    WWAKCD           PC Contract Cod
      * Establish starting position
     C           KRSTB     CHAIN@EECPAP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0820' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TBEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.PAH Account Balance GT WRK.Zero USR
     C           WWEJVA    IFGT WUE9NB                     *IF
     C                     MOVEL'Y'       WN0321           Balance Exists
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TBEXIT    ENDSR
      /EJECT
     CSR         TCCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWKA1VA    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWKJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWKEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVELWLNWST    WIPGST           THD Reserve Acc
     C                     MOVELWUPIST    WIPIST           THD Commission
     C                     MOVELWUPJST    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTC    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTC    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TCEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TCEXIT    ENDSR
      /EJECT
     CSR         TDRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQTD01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQTD02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQTD03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQTD04           TH Kill Date
     C           *LIKE     DEFN WOCVNB    WQTD05           TH Tattoo Numbe
      * Define keylist
     C           KRSTD     KLIST
     C                     KFLD           WQTD01           BOH Company Num
     C                     KFLD           WQTD02           BOH Buy Order N
     C                     KFLD           WQTD03           BOL Load Number
     C                     KFLD           WQTD04           TH Kill Date
     C                     KFLD           WQTD05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQTD01           BOH Company Num
     C                     Z-ADDWABNNB    WQTD02           BOH Buy Order N
     C                     Z-ADDWABONB    WQTD03           BOL Load Number
     C                     Z-ADDWAB0DT    WQTD04           TH Kill Date
     C                     Z-ADDWACVNB    WQTD05           TH Tattoo Numbe
      * Establish starting position
     C           KRSTD     SETLL@A1CPOC                    *
     C           KRSTD     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR TECHRC
     C           KRSTD     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         TDEXIT    ENDSR
      /EJECT
     CSR         TECHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0322  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0323 10        TH Group Refere
     C                     MOVEL*BLANK    WN0324  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0325  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0326  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0327  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0328  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0329  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0330  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0331  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0332  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0333  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0334  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0335  50       TH Held Over
     C                     Z-ADD*ZERO     WN0336  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0337  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0338  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0339  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0340  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0341  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0342  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0343  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0344  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0345  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0346  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0347  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0348  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0349  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0350  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0351  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0352  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0353  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0354  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0355  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0356  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0357  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0358  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0359  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0360  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0361  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0362  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0363  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0364  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0365  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0366  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0367  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0368  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0369  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0370  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0371  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0372  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0373  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0374  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0375  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0376  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0377  1        TH Header Error
     C                     MOVEL*BLANK    WN0378  1        TH Detail Error
     C                     MOVEL*BLANK    WN0379  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0380  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0381  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0382  1        TH User Error O
     C                     MOVEL*BLANK    WN0383  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0384  1        TH Sex
     C                     Z-ADD*ZERO     WN0385  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0386  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0387  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0388  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0389  31       TH FFLI
     C                     Z-ADD*ZERO     WN0390  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0391  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0392  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0393  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0394  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0395  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0396  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0397  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0398  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0399  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0400  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0401  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0402  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0403  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0404  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0405  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0406  1        TH Source Type
     C                     MOVEL*BLANK    WN0407  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0408  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0409  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0410  3        TH Source Code
     C                     MOVEL*BLANK    WN0411  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0412  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0413  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0414  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0415  3        TH State
     C                     MOVEL*BLANK    WN0416  3        TH Unused Code
     C                     MOVEL*BLANK    WN0417  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0418  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0419  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0420  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0421  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0422  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0423  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0424  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0425  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0426  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0427  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0428  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0429  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0430  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0431  3        TH PHA Average
     C                     MOVEL*BLANK    WN0432  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0433  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0434  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0435  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0436  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0437  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0438  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0439  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0440  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0441  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0442  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0443  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0444  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0445 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0446 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0447 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0448 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0449  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0450  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0451  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0452  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0453  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0454  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0455  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0456  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0457  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0458  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0459  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0460  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0461  70       TH Unused Date
     C                     MOVEL*BLANK    WN0462  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0463  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0464  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0465  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0466  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0467  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0468  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0469  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0470  6        DF Defect Code
     C                     MOVEL*BLANK    WN0471  6        THP Process Cod
     C                     MOVEL*BLANK    WN0472  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0473  6        PL Location Cod
     C                     MOVEL*BLANK    WN0474  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0475  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0476  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WCBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHTE    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHTE    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TEEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TEEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YCRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     MOVEL'C'       WCR5ST    P      TH Commission S
     C                     MOVELWOAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWOAADT    WCAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WCAMTM           RS Time Changed
     C                     MOVELWOAJST    WCAJST    P      RS Record Statu
     C                     MOVELWOAHVN    WCAHVN    P      RS Job
     C                     MOVELWOAGVN    WCAGVN    P      RS Program
     C                     MOVELWOABVN    WCABVN    P      RS User Added
     C                     Z-ADDWOABDT    WCABDT           RS Date Added
     C                     Z-ADDWOABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TEEXIT    ENDSR
      /EJECT
     CSR         TFCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWKA1VA    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWKJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWKEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVELWUPIST    WIPIST           THD Commission
     C                     MOVELWUPJST    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTF    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTF    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TFEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TFEXIT    ENDSR
      /EJECT
     CSR         TGRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQTG01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQTG02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQTG03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQTG04           TH Kill Date
     C           *LIKE     DEFN WOCVNB    WQTG05           TH Tattoo Numbe
      * Define keylist
     C           KRSTG     KLIST
     C                     KFLD           WQTG01           BOH Company Num
     C                     KFLD           WQTG02           BOH Buy Order N
     C                     KFLD           WQTG03           BOL Load Number
     C                     KFLD           WQTG04           TH Kill Date
     C                     KFLD           WQTG05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQTG01           BOH Company Num
     C                     Z-ADDWABNNB    WQTG02           BOH Buy Order N
     C                     Z-ADDWABONB    WQTG03           BOL Load Number
     C                     Z-ADDWAB0DT    WQTG04           TH Kill Date
     C                     Z-ADDWACVNB    WQTG05           TH Tattoo Numbe
      * Establish starting position
     C           KRSTG     SETLL@A1CPOC                    *
     C           KRSTG     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR THCHRC
     C           KRSTG     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         TGEXIT    ENDSR
      /EJECT
     CSR         THCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0477  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0478 10        TH Group Refere
     C                     MOVEL*BLANK    WN0479  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0480  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0481  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0482  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0483  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0484  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0485  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0486  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0487  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0488  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0489  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0490  50       TH Held Over
     C                     Z-ADD*ZERO     WN0491  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0492  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0493  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0494  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0495  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0496  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0497  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0498  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0499  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0500  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0501  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0502  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0503  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0504  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0505  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0506  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0507  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0508  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0509  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0510  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0511  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0512  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0513  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0514  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0515  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0516  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0517  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0518  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0519  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0520  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0521  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0522  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0523  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0524  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0525  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0526  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0527  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0528  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0529  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0530  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0531  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0532  1        TH Header Error
     C                     MOVEL*BLANK    WN0533  1        TH Detail Error
     C                     MOVEL*BLANK    WN0534  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0535  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0536  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0537  1        TH User Error O
     C                     MOVEL*BLANK    WN0538  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0539  1        TH Sex
     C                     Z-ADD*ZERO     WN0540  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0541  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0542  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0543  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0544  31       TH FFLI
     C                     Z-ADD*ZERO     WN0545  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0546  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0547  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0548  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0549  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0550  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0551  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0552  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0553  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0554  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0555  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0556  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0557  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0558  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0559  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0560  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0561  1        TH Source Type
     C                     MOVEL*BLANK    WN0562  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0563  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0564  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0565  3        TH Source Code
     C                     MOVEL*BLANK    WN0566  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0567  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0568  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0569  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0570  3        TH State
     C                     MOVEL*BLANK    WN0571  3        TH Unused Code
     C                     MOVEL*BLANK    WN0572  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0573  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0574  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0575  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0576  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0577  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0578  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0579  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0580  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0581  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0582  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0583  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0584  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0585  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0586  3        TH PHA Average
     C                     MOVEL*BLANK    WN0587  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0588  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0589  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0590  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0591  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0592  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0593  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0594  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0595  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0596  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0597  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0598  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0599  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0600 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0601 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0602 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0603 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0604  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0605  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0606  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0607  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0608  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0609  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0610  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0611  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0612  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0613  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0614  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0615  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0616  70       TH Unused Date
     C                     MOVEL*BLANK    WN0617  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0618  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0619  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0620  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0621  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0622  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0623  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0624  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0625  6        DF Defect Code
     C                     MOVEL*BLANK    WN0626  6        THP Process Cod
     C                     MOVEL*BLANK    WN0627  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0628  6        PL Location Cod
     C                     MOVEL*BLANK    WN0629  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0630  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0631  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WCBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHTH    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHTH    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO THEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO THEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YDRDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     MOVEL'C'       WCR5ST    P      TH Commission S
     C                     MOVELWOAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWOAADT    WCAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WCAMTM           RS Time Changed
     C                     MOVELWOAJST    WCAJST    P      RS Record Statu
     C                     MOVELWOAHVN    WCAHVN    P      RS Job
     C                     MOVELWOAGVN    WCAGVN    P      RS Program
     C                     MOVELWOABVN    WCABVN    P      RS User Added
     C                     Z-ADDWOABDT    WCABDT           RS Date Added
     C                     Z-ADDWOABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         THEXIT    ENDSR
      /EJECT
     CSR         TIRVGN    BEGSR
      *================================================================
      * Clc a Tatt Prd/Lc D/A RT - Producer Loc Std D/A  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WXABCD    WQTI01           PD Producer Cod
     C           *LIKE     DEFN WXAECD    WQTI02           PL Location Cod
     C           *LIKE     DEFN WXZDA1    WQTI03           PSDL Company Nu
      * Define keylist
     C           KRSTI     KLIST
     C                     KFLD           WQTI01           PD Producer Cod
     C                     KFLD           WQTI02           PL Location Cod
     C                     KFLD           WQTI03           PSDL Company Nu
      * Setup key
     C                     MOVELWAABCD    WQTI01           PD Producer Cod
     C                     MOVELWAAECD    WQTI02           PL Location Cod
     C                     Z-ADDP1HMNB    WQTI03           PSDL Company Nu
      * Establish starting position
     C           KRSTI     SETLL@APREKQ                    *
     C           KRSTI     READE@APREKQ                  90*
      * Data record not found
     C   90                MOVEL'PRK1103' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Date 03/24/2004 slm - Add logic for TFM Release 01 for all Ded/Ad
      *                       to verify the accept date and the decline d
      *                       before the creations of the D/A
     C                     MOVEL'Y'       WUYUST           Process Flag Us
     C                     Z-ADD*ZERO     WUE9NB           Zero USR
      * CASE: DB1.PSD Accept Date GT WRK.Zero USR
     C           WXC0DT    IFGT WUE9NB                     *IF
      * CASE: PAR.TH Purchase Date LT DB1.PSD Accept Date
     C           WAAWDT    IFLT WXC0DT                     *IF
     C                     MOVEL'N'       WUYUST           Process Flag Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.PSD Decline Date GT WRK.Zero USR
     C           WXC1DT    IFGT WUE9NB                     *IF
      * CASE: PAR.TH Purchase Date GT DB1.PSD Decline Date
     C           WAAWDT    IFGT WXC1DT                     *IF
     C                     MOVEL'N'       WUYUST           Process Flag Us
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Process Flag User is Yes
     C           WUYUST    IFEQ 'Y'                        *IF
      * Clc Prd Ded/Add       Rt - Deduction/Addition  * 
     C                     EXSR TJRVGN
     C                     END                             *FI
     C           KRSTI     READE@APREKQ                  90*
     C                     ENDDO
      *================================================================
     CSR         TIEXIT    ENDSR
      /EJECT
     CSR         TJRVGN    BEGSR
      *================================================================
      * Clc Prd Ded/Add       Rt - Deduction/Addition  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0632  72       Var Net Pay Usr
     C                     Z-ADD*ZERO     WN0633  52       Tot Cost Live C
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTJ     KLIST
     C                     KFLD           WLBQCD           DED D/A Code
      * Setup key
     C                     MOVELWXBQCD    WLBQCD           DED D/A Code
      * Establish starting position
     C           KRSTJ     CHAIN@BBRELJ              90    *
      * Data record not found
     C   90                MOVEL'PRK0081' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * HPE063 Frt Exp/Accruals
      * 2/26/96  HPE063   Allow the expense for freight to be paid
      *                   by either Seaboard(us) or the producer
      *                   Allow the system to process accruals thru
      *                   the General Ledger.
     C                     MOVEL'N'       WUMXST           Record was sele
      * Valid selection on weither to create the record
      * CASE:
      *  - c1 AND (c2 OR c3)
      *   |- c1    : DB1.DED Plant Deduction is Not Yes
      *   |- c2    : DB1.DED Fix/Var/Sys is Fixed
      *   |- c3    : DB1.DED Fix/Var/Sys is Variable
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WLI2ST    IFEQ *BLANK                     *IF
     C           WLI2ST    OREQ 'N'
     C                     MOVEL'0'       Y0CX02  1
     C           WLB9ST    IFEQ 'F'                        *IF
     C           WLB9ST    OREQ 'V'                        *OR
     C                     MOVEL'1'       Y0CX02
     C                     END                             *FI
     C           Y0CX02    IFEQ '1'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * CASE:
      *  - (c1 AND c2) OR (c3 AND c4) OR (c5 AND c6)
      *   |- c1    : PAR.TH Hog Class Type is Resale
      *   |- c2    : DB1.DED Include Resale is Yes
      *   |- c3    : PAR.TH Hog Class Type is Market
      *   |- c4    : DB1.DED Include Market is Yes
      *   |- c5    : PAR.TH Hog Class Type is Subject
      *   |- c6    : DB1.DED Include Subject is Yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WALLST    IFEQ 'R'                        *IF
     C           WLNSST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'M'                        *IF
     C           WLNUST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFNE '1'                        *IF
     C           WALLST    IFEQ 'S'                        *IF
     C           WLNTST    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'Y'       WUMXST           Record was sele
     C                     END                             *FI
     C                     END                             *FI
      * 41404 slm add PC Contract code and PSC subcontract code
      * Rtv Buy Order Type - Buy Order Header  * 
     C                     EXSR TKRVGN
      * Validate to create tattoo ded/add based on Buy Order Type
      * CASE: WRK.Record was selected usr is *YES
     C           WUMXST    IFEQ 'Y'                        *IF
      * CASE: WRK.BOH Buy Order Type is Contract
     C           WUA5ST    IFEQ 'C'                        *IF
      * CASE: DB1.DED Valid BO Type is Contract List
     C           WLNZST    IFEQ 'C'                        *IF
     C           WLNZST    OREQ '1'
     C           WLNZST    OREQ '2'
     C           WLNZST    OREQ *BLANK
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.BOH Buy Order Type is Internal
     C           WUA5ST    IFEQ 'I'                        *IF
      * CASE: DB1.DED Valid BO Type is Internal List
     C           WLNZST    IFEQ '1'                        *IF
     C           WLNZST    OREQ *BLANK
     C           WLNZST    OREQ 'I'
     C           WLNZST    OREQ '3'
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     ELSE
      * CASE: WRK.BOH Buy Order Type is Open Market
     C           WUA5ST    IFEQ 'O'                        *IF
      * CASE: DB1.DED Valid BO Type is Open List
     C           WLNZST    IFEQ '2'                        *IF
     C           WLNZST    OREQ *BLANK
     C           WLNZST    OREQ 'O'
     C           WLNZST    OREQ '3'
      * Still the value of Yes
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'N'       WUMXST           Record was sele
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Create the Tattoo Ded/Add
      * CASE: WRK.Record was selected usr is *YES
     C           WUMXST    IFEQ 'Y'                        *IF
     C                     MOVEL'O'       WUPFST           THD Expense Typ
     C                     MOVEL'N'       WUPIST           THD Commission
      * CASE: DB1.DED Commission Deduction is Yes
     C           WLN1ST    IFEQ 'Y'                        *IF
     C                     MOVEL'Y'       WUPIST           THD Commission
     C                     END                             *FI
     C                     MOVELWXN2ST    WUPEST           THD Expense Pai
      * CASE: DB1.DED Fix/Var/Sys is Fixed
     C           WLB9ST    IFEQ 'F'                        *IF
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WLCAST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WLCAST    IFEQ 'FL'                       *IF
     C           WLAEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WLCAST    IFEQ 'DH'                       *IF
     C           WLCAST    OREQ 'RH'
     C           WLCAST    OREQ 'YH'
     C           WLCAST    OREQ 'CH'
     C           WLCAST    OREQ 'KH'
     C           WLCAST    OREQ 'NH'
     C           WLCAST    OREQ 'DY'
     C           WLCAST    OREQ 'RX'
     C           WLCAST    OREQ 'HM'
     C           WLCAST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WLCAST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WLCAST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WLCAST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WLCAST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WLCAST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WLCAST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WLCAST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WLCAST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WLCAST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WLAEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WLCAST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WLAEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WLCAST    IFEQ 'CW'                       *IF
     C           WLCAST    OREQ 'LW'
     C           WLCAST    OREQ 'NL'
     C           WLCAST    OREQ 'SW'
     C           WLCAST    OREQ 'LX'
     C           WLCAST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WLCAST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WLCAST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WLCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WLCAST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WLCAST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WLCAST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WLAEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WLCAST    IFEQ 'GV'                       *IF
     C           WLCAST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WLCAST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WLAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WLCAST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WLAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WLCAST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0057  30       BOH Company Num
     C                     PARM WAAWDT    WQ0058  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0059  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0060  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0061  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WLAEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WLCAST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WLCAST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WLAEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr is Not Zeros
     C           WUCFPR    IFNE 0                          *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TLCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR TMRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.DED Fix/Var/Sys is Variable
     C           WLB9ST    IFEQ 'V'                        *IF
      * Create the D/A for Special Proc and Normal Proc
      * CASE: DB1.DED Prdcr Special Proc NE WRK.Blank USR
     C           WLNXST    IFNE WUCRTX                     *IF
      *
     C                     MOVEL*BLANK    WN0789  2        Pricing UOM USR
      *
      * Clc D/A f/Prdcr Spcl  IF
      * Insurance Reimbursement Hd calculation
      * CASE: PAR.DED Prdcr Special Proc is Insurance Reimbursement
     C           WLNXST    IFEQ 'I'                        *IF
      * Retrieve Reimb. hd total for paid tattoos on the BOL
      * Rtv BOL Reimb hd sum  RT - Tattoo Ded/Add  * 
     C                     EXSR TORVGN
     C                     Z-ADD*ZERO     WUDENB           Re-imbursement
     C                     Z-ADD*ZERO     WULLPR           Re-imbursement
     C                     Z-ADD*ZERO     WUDWNB           Re-imbursement
      * Move the correct head into work field to calc head to be paid ful
      * CASE: PAR.PSD Variable UOM is Head UOM
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WXEVST    OREQ 'RH'
     C           WXEVST    OREQ 'YH'
     C           WXEVST    OREQ 'CH'
     C           WXEVST    OREQ 'KH'
     C           WXEVST    OREQ 'NH'
     C           WXEVST    OREQ 'DY'
     C           WXEVST    OREQ 'RX'
     C           WXEVST    OREQ 'HM'
     C           WXEVST    OREQ 'DE'
      * CASE: PAR.PSD Variable UOM is Condemned Head
     C           WXEVST    IFEQ 'CH'                       *IF
     C                     Z-ADDWAFDNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA Head
     C           WXEVST    IFEQ 'DH'                       *IF
     C                     Z-ADDWACXNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Yard Deads Head
     C           WXEVST    IFEQ 'YH'                       *IF
     C                     Z-ADDWAFCNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA Head + Yard Dead Head
     C           WXEVST    IFEQ 'DY'                       *IF
     C           WAFCNB    ADD  WACXNB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is DOA HD + Yard Dead + EUT
     C           WXEVST    IFEQ 'DE'                       *IF
     C           WAFCNB    ADD  WACXNB    WUDENB           Re-imbursement
     C                     ADD  WAEDDT    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Killed Head
     C           WXEVST    IFEQ 'KH'                       *IF
     C                     Z-ADDWAFENB    WUDENB           Re-imbursement
     C                     ELSE
      * CASE: PAR.PSD Variable UOM is Net Head
     C           WXEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Move the correct Price and Wgt into work fields
      * CASE: PAR.THD Payment Sts is Live anything
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'PL'
     C           WACWST    OREQ 'NL'
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C                     Z-ADDYL0002    WULLPR           Re-imbursement
      * CASE: PAR.TH Live Purchase UOM is Shipped Weight List
     C           YL0001    IFEQ 'SW'                       *IF
     C           YL0001    OREQ 'SX'
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is Not Zero
     C           WUEXNB    IFNE 0                          *IF
     C           WAHGNB    DIV  WUEXNB    WUDWNB           Re-imbursement
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAF7NB    WUDWNB           Re-imbursement
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.THD Payment Sts is Carcass anything
     C           WACWST    IFEQ 'PC'                       *IF
     C           WACWST    OREQ 'NC'
     C           WACWST    OREQ 'SC'
     C           WACWST    OREQ 'IC'
     C                     Z-ADDWAF7NB    WUDWNB           Re-imbursement
      *
     C                     MOVEL*BLANK    WN0790  3        BOH Commodity M
     C                     MOVEL*BLANK    WN0791  7        BOH Commodity P
      *
      * Rtv comm grp/OMS Uom   IF
      * Rtv Comm/Group        RT - Buy Order Header  * 
     C                     EXSR TPRVGN
      * Rtv Commod Group U/M  XF - STR Order Management Sys  * 
     C                     CALL 'PDUVXFR'              90  Rtv Commod Grou
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WN0791    WQ0062  7        BOH Commodity P
     C           WN0789    PARM *BLANK    WQ0063  2        Pricing UOM USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDUVXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: PAR.Pricing UOM USR is Carcass Hundred Weight
     C           WN0789    IFEQ 'CW'                       *IF
      * Convert the Meat price to a Live Price
     C           .74       MULT WAAMPR    WULLPR           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAAMPR    WULLPR           Re-imbursement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calculate if there are Head and the limit hasnt already been reac
      * CASE:
      *  - c1 AND c2
      *   |- c1    : WRK.Re-imbursement hd NEW USR is Greater than 0
      *   |- c2    : WRK.Re-imbursement head totl is Less than upper limi
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WUDENB    IFGT 0                          *IF
     C           WUDDNB    IFLT 4                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADD*ZERO     WUDFNB           Re-imbursement
     C                     Z-ADD*ZERO     WUDGNB           Re-imbursement
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     Z-ADD*ZERO     WUCEPR           Trans Unit Amt
      * Reduce the Tattoos head count as head are accumed either full or
      * DO WHILE: WRK.Re-imbursement hd NEW USR is Greater than 0
     C           WUDENB    DOWGT0                          *DOW
     C                     SUB  1         WUDENB           Re-imbursement
     C                     ADD  1         WUDDNB           Re-imbursement
      * Accum hd to be paid full and head to be paid half value.
      * CASE: WRK.Re-imbursement head totl is Less than/eq full limit 2
     C           WUDDNB    IFLE 4                          *IF
     C                     ADD  1         WUDFNB           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: WRK.Re-imbursement head totl is Less than/eq half limit 4
     C           WUDDNB    IFLE 0                          *IF
     C                     ADD  1         WUDGNB           Re-imbursement
     C                     ELSE
      * CASE: *OTHERWISE
      * Fall-out because the limit has been reached.
     C                     Z-ADD*ZERO     WUDENB           Re-imbursement
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *ITR
      * CASE: WRK.Re-imbursement full   USR is Greater than 0
     C           WUDFNB    IFGT 0                          *IF
      * Compute: Paid Full value
      * WRK.Trans Extended Amt Usr =
      *    *COMPUTE ((x1 * (x2 / x3)) * x4)
      * x1    : WRK.Re-imbursement Price  USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Re-imbursement Wgt    USR
      * /     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Re-imbursement full   USR
     C           WUDWNB    DIV  100       W0WA02           *Synon (15,2) w
     C           WULLPR    MULT W0WA02    W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUDFNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
      * CASE: WRK.Re-imbursement half   USR is Greater than 0
     C           WUDGNB    IFGT 0                          *IF
      * Compute: Paid Half value
      * WRK.Trans Unit Amt Usr =
      *    *COMPUTE (((x1 * (x2 / x3)) / x5) * x4)
      * x1    : WRK.Re-imbursement Price  USR
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.Re-imbursement Wgt    USR
      * /     : PGM.*Synon (15,2) work field *
      * x3    : CON.100
      * /     : PGM.*Synon (15,2) work field *
      * x5    : CON.2
      * *     : PGM.*Synon (15,2) work field *
      * x4    : WRK.Re-imbursement half   USR
     C           WUDWNB    DIV  100       W0WA03           *Synon (15,2) w
     C           WULLPR    MULT W0WA03    W0WA02    H      *Synon (15,2) w
     C           W0WA02    DIV  2         W0WA01           *Synon (15,2) w
     C           W0WA01    MULT WUDGNB    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCEPR           Trans Unit Amt
      * Add calc'd half value to calc'd full value
     C                     ADD  WUCEPR    WUCFPR           Trans Extended
     C                     END                             *FI
      * Add calc'd half hd & calc'd full hd  to total re-imb hd for new r
     C           WUDFNB    ADD  WUDGNB    WUAQNB           THD Re-imbursem
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TQCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.DED Prdcr Special Proc is Yard Dead Reimbursement
     C           WLNXST    IFEQ 'Y'                        *IF
      * If the Tattoo is hold over.
      * CASE:
      *  - c2 AND c3
      *   |- c2    : PAR.TH Held Over Record is Yes
      *   |- c3    : PAR.TH Yard Deads is Not Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAE1ST    IFEQ 'Y'                        *IF
     C           WAFCNB    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Rtv Held Over KillDts RT - Tattoo Header  * 
     C                     EXSR TRRVGN
      * LCL.Held Over Days USR = PAR.TH Kill Date - LCL.Kill Date Usr *DA
     C                     MOVEL'1'       XDSEL   1
     C                     MOVEL'1111111' XDCDW   7
     C                     EXSR XDOWS
     C           YL0011    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     Z-ADDXDAY1     XDAY2   60
     C           WAB0DT    ADD  1000000   XDINDT
     C                     EXSR XCVTA
     C                     MOVEL'NONE'    WUDLN  10
     C                     EXSR XDUDY
      * Negative duration, when date1<date2
     C           XDAY1     IFGE XDAY2
     C                     Z-ADDXDURR     YL0012
     C                     ELSE
     C           XDURR     MULT -1        YL0012
     C                     END
      * CASE: LCL.Held Over Days USR is GT 1
     C           YL0012    IFGT 1                          *IF
      * Do not send in miles, this is yard reim.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
     C           WATAPR    MULT 1         YL0013           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WXEVST    OREQ 'RH'
     C           WXEVST    OREQ 'YH'
     C           WXEVST    OREQ 'CH'
     C           WXEVST    OREQ 'KH'
     C           WXEVST    OREQ 'NH'
     C           WXEVST    OREQ 'DY'
     C           WXEVST    OREQ 'RX'
     C           WXEVST    OREQ 'HM'
     C           WXEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WXEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WXEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WXEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WXEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WXEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WXEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WXEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WXEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WATAPR    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WXEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WATAPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WXEVST    IFEQ 'CW'                       *IF
     C           WXEVST    OREQ 'LW'
     C           WXEVST    OREQ 'NL'
     C           WXEVST    OREQ 'SW'
     C           WXEVST    OREQ 'LX'
     C           WXEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WXEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WXEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WXEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WXEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WXEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WATAPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WXEVST    IFEQ 'GV'                       *IF
     C           WXEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WXEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WXEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0064  30       BOH Company Num
     C                     PARM WAAWDT    WQ0065  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0066  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0067  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0068  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WATAPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WXEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WXEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WATAPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    YL0013           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: LCL.Trans Extended Amt Usr NE WRK.Zero USR
     C           YL0013    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TSCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.DED Prdcr Special Proc is Deferred Payment
     C           WLNXST    IFEQ 'D'                        *IF
      * 41404 slm add for deferred payment TFM
      * Retrieve BREAK EVEN % from producer sub contract
      * Rtv PurchPrc Clc BrkEORT - Producer Sub-Contract  * 
     C                     EXSR TTRVGN
     C                     Z-ADD*ZERO     WUU5PR           Deferred Price
      * Deferred Price
      * WRK.Deferred Price Usr =
      *    *COMPUTE (x4 - (x1 * (x2 / x3)))
      * x4    : PAR.TH CM Base Mkt Price
      * -     : PGM.*Synon (15,2) work field
      * x1    : PAR.TH CM Market Price
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : WRK.PSC Break Even Percent
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x3    : CON.100
     C           WUA7PR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           WAB8PR    MULT W0WB02    W0WA01    H      *Synon (15,2) w
     C           WAAMPR    SUB  W0WA01    W0WA00           *Synon (15,2) w
     C                     Z-ADDW0WA00    WUU5PR           Deferred Price
     C                     Z-ADDWUU5PR    WUCEPR           Trans Unit Amt
      * PLD miles = zero
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(PAR) WAEDDT' defaulted for 'TH Head EUT/KOA'.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
     C           WUCEPR    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WXEVST    OREQ 'RH'
     C           WXEVST    OREQ 'YH'
     C           WXEVST    OREQ 'CH'
     C           WXEVST    OREQ 'KH'
     C           WXEVST    OREQ 'NH'
     C           WXEVST    OREQ 'DY'
     C           WXEVST    OREQ 'RX'
     C           WXEVST    OREQ 'HM'
     C           WXEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WXEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WXEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WXEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WXEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WXEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WXEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WXEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WXEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WUCEPR    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WXEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WUCEPR    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WXEVST    IFEQ 'CW'                       *IF
     C           WXEVST    OREQ 'LW'
     C           WXEVST    OREQ 'NL'
     C           WXEVST    OREQ 'SW'
     C           WXEVST    OREQ 'LX'
     C           WXEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WXEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WXEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WXEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WXEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WXEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WUCEPR    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WXEVST    IFEQ 'GV'                       *IF
     C           WXEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WXEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WXEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0069  30       BOH Company Num
     C                     PARM WAAWDT    WQ0070  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0071  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0072  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0073  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCEPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WXEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WXEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WUCEPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TUCRRC
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.DED Reserve Account Upd is Yes
     C           WLNWST    IFEQ 'Y'                        *IF
      * CASE: PAR.TH Payment Type is Live
     C           WAJ9ST    IFEQ 'L'                        *IF
     C                     Z-ADDYL0002    WN0633           Tot Cost Live C
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWAEGPR    WN0633           Tot Cost Live C
     C                     END                             *FI
      *
     C                     Z-ADD*ZERO     WN0792  52       PSC FLoor Price
     C                     MOVEL*BLANK    WN0793  1        PSC Sub-Contrac
     C                     Z-ADD*ZERO     WN0794  70       PFP Week Ending
     C                     Z-ADD*ZERO     WN0795  52       PFP Adjusted Fl
     C                     MOVEL*BLANK    WN0796  5        PC Contract Cod
     C                     MOVEL*BLANK    WN0797  5        PSC Sub-Contrac
     C                     MOVEL*BLANK    WN0798  1        Balance Exists
      *
      * Clc Reserve Amount    IF
     C                     Z-ADD*ZERO     WN0632           Var Net Pay Usr
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
     C                     EXSR TVRVGN
      * Rtv Prior Sunday      XF - STR Order Management Sys  * 
     C                     CALL 'PDLNXFR'              90  Rtv Prior Sunda
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0074  30       Company Number
     C                     PARM WAAWDT    WQ0075  70       Kill Date Usr
     C           WN0794    PARM *ZERO     WQ0076  70       Date USR
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDLNXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * RTV Floor Price       RT - Producer SC Floor Price  * 
     C                     EXSR TXRVGN
      * Val Reserv Acct Exists RT - Producer Cntrct RsvAct Hd  * 
     C                     EXSR TYRVGN
      * Calculate the unit price
      * CASE: PAR.Balance Exists USR is Yes
     C           WN0798    IFEQ 'Y'                        *IF
     C           WN0795    ADD  WN0792    W0WA             *Synon (15,2) w
      * Determine unit price if there is a reserve account balance
      * CASE: PAR.TH CM Gross Live /CWT GT PGM.*Synon (15,2) work field
     C           WN0633    IFGT W0WA                       *IF
     C                     Z-ADDW0WA      WN0632           Var Net Pay Usr
     C                     ELSE
      * CASE: PAR.TH CM Gross Live /CWT GT PAR.PFP Adjusted Floor Price
     C           WN0633    IFGT WN0795                     *IF
     C                     Z-ADDWN0633    WN0632           Var Net Pay Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0795    WN0632           Var Net Pay Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Determine unit price if there is no reserve account balance
      * CASE: PAR.TH CM Gross Live /CWT GT PAR.PFP Adjusted Floor Price
     C           WN0633    IFGT WN0795                     *IF
     C                     Z-ADDWN0633    WN0632           Var Net Pay Usr
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDWN0795    WN0632           Var Net Pay Usr
     C                     END                             *FI
     C                     END                             *FI
     C                     SUB  WN0633    WN0632           Var Net Pay Usr
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
     C           WN0632    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WXEVST    OREQ 'RH'
     C           WXEVST    OREQ 'YH'
     C           WXEVST    OREQ 'CH'
     C           WXEVST    OREQ 'KH'
     C           WXEVST    OREQ 'NH'
     C           WXEVST    OREQ 'DY'
     C           WXEVST    OREQ 'RX'
     C           WXEVST    OREQ 'HM'
     C           WXEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WXEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WXEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WXEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WXEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WXEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WXEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WXEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WXEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WN0632    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WXEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WN0632    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WXEVST    IFEQ 'CW'                       *IF
     C           WXEVST    OREQ 'LW'
     C           WXEVST    OREQ 'NL'
     C           WXEVST    OREQ 'SW'
     C           WXEVST    OREQ 'LX'
     C           WXEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WXEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0632    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WXEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0632    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0632    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WXEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0632    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WXEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0632    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WXEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WN0632    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WXEVST    IFEQ 'GV'                       *IF
     C           WXEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WXEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0632    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0632    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WXEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0077  30       BOH Company Num
     C                     PARM WAAWDT    WQ0078  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0079  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0080  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0081  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WN0632    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WXEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WXEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WN0632    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR TZCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR NARVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * Normal processing for the d/a code
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           WXEVST    IFEQ 'FL'                       *IF
     C           WXA1VA    MULT 1         WUCFPR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WXEVST    OREQ 'RH'
     C           WXEVST    OREQ 'YH'
     C           WXEVST    OREQ 'CH'
     C           WXEVST    OREQ 'KH'
     C           WXEVST    OREQ 'NH'
     C           WXEVST    OREQ 'DY'
     C           WXEVST    OREQ 'RX'
     C           WXEVST    OREQ 'HM'
     C           WXEVST    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           WXEVST    IFEQ 'RH'                       *IF
     C           WACWNB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           WXEVST    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           WXEVST    IFEQ 'KH'                       *IF
     C           WAFENB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           WXEVST    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           WXEVST    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           WXEVST    IFEQ 'DH'                       *IF
     C           WACXNB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           WXEVST    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           WXEVST    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           WXEVST    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT WXA1VA    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           WXEVST    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           YL0010    MULT WAFENB    W0WA01           *Synon (15,2) w
     C           WXA1VA    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           WXEVST    IFEQ 'CW'                       *IF
     C           WXEVST    OREQ 'LW'
     C           WXEVST    OREQ 'NL'
     C           WXEVST    OREQ 'SW'
     C           WXEVST    OREQ 'LX'
     C           WXEVST    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           WXEVST    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WXA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           WXEVST    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WXA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WXA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           WXEVST    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WXA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           WXEVST    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WXA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           WXEVST    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WXA1VA    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           WXEVST    IFEQ 'GV'                       *IF
     C           WXEVST    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           WXEVST    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WXA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           WXEVST    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WXA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           WXEVST    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0082  30       BOH Company Num
     C                     PARM WAAWDT    WQ0083  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0084  71       TH Live Wgt
     C                     PARM WLBQCD    WQ0085  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0086  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WXA1VA    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           WXEVST    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           WXEVST    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           WXA1VA    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WUCBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUCFPR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * CASE: WRK.Trans Extended Amt Usr NE WRK.Zero USR
     C           WUCFPR    IFNE WUE9NB                     *IF
      * Date 03/24/2004 Slm -- Update the Deferred Payment in place of Bl
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
     C                     EXSR NCCRRC
      * CASE: WRK.THD Commission Deduction is Yes
     C           WUPIST    IFEQ 'Y'                        *IF
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
     C                     EXSR NDRVGN
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TJEXIT    ENDSR
      /EJECT
     CSR         TKRVGN    BEGSR
      *================================================================
      * Rtv Buy Order Type - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTK     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WMBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTK     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMA5ST    WUA5ST           BOH Buy Order T
     C                     MOVELWMAKCD    WUAKCD           PC Contract Cod
     C                     MOVELWMALCD    WUALCD           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         TKEXIT    ENDSR
      /EJECT
     CSR         TLCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWLAEPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWLI9ST    WIJBST           THD Unit Amt Si
     C                     MOVELWLCAST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVELWUPIST    WIPIST           THD Commission
     C                     MOVELWUPJST    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTL    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTL    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TLEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TLEXIT    ENDSR
      /EJECT
     CSR         TMRVGN    BEGSR
      *================================================================
      * Rtv/Chg Commission StsRT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WOHMNB    WQTM01           BOH Company Num
     C           *LIKE     DEFN WOBNNB    WQTM02           BOH Buy Order N
     C           *LIKE     DEFN WOBONB    WQTM03           BOL Load Number
     C           *LIKE     DEFN WOB0DT    WQTM04           TH Kill Date
     C           *LIKE     DEFN WOCVNB    WQTM05           TH Tattoo Numbe
      * Define keylist
     C           KRSTM     KLIST
     C                     KFLD           WQTM01           BOH Company Num
     C                     KFLD           WQTM02           BOH Buy Order N
     C                     KFLD           WQTM03           BOL Load Number
     C                     KFLD           WQTM04           TH Kill Date
     C                     KFLD           WQTM05           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQTM01           BOH Company Num
     C                     Z-ADDWABNNB    WQTM02           BOH Buy Order N
     C                     Z-ADDWABONB    WQTM03           BOL Load Number
     C                     Z-ADDWAB0DT    WQTM04           TH Kill Date
     C                     Z-ADDWACVNB    WQTM05           TH Tattoo Numbe
      * Establish starting position
     C           KRSTM     SETLL@A1CPOC                    *
     C           KRSTM     READE@A1CPOC                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
     C                     EXSR TNCHRC
     C           KRSTM     READE@A1CPOC                  90*
     C                     ENDDO
      *================================================================
     CSR         TMEXIT    ENDSR
      /EJECT
     CSR         TNCHRC    BEGSR
      *================================================================
      * Chg Commission Sts/Dt CH - Tattoo Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0634  70       TH Purchase Dat
     C                     MOVEL*BLANK    WN0635 10        TH Group Refere
     C                     MOVEL*BLANK    WN0636  2        TH Live Purchas
     C                     Z-ADD*ZERO     WN0637  52       TH Live Purchas
     C                     Z-ADD*ZERO     WN0638  72       TH Live Gross A
     C                     Z-ADD*ZERO     WN0639  72       TH LIve Net Amt
     C                     MOVEL*BLANK    WN0640  2        TH Resale UOM
     C                     Z-ADD*ZERO     WN0641  52       TH Recalc Live
     C                     Z-ADD*ZERO     WN0642  70       TH Pricing Date
     C                     MOVEL*BLANK    WN0643  1        TH Resale Sprea
     C                     Z-ADD*ZERO     WN0644  50       TH Dead On Arri
     C                     Z-ADD*ZERO     WN0645  50       TH Head Receive
     C                     Z-ADD*ZERO     WN0646  50       TH Yard Deads
     C                     Z-ADD*ZERO     WN0647  50       TH Held Over
     C                     Z-ADD*ZERO     WN0648  50       TH Head Condemn
     C                     Z-ADD*ZERO     WN0649  50       TH Head Killed
     C                     Z-ADD*ZERO     WN0650  50       TH Head Adds
     C                     Z-ADD*ZERO     WN0651  50       TH Head Accepte
     C                     Z-ADD*ZERO     WN0652  71       TH Live Wgt
     C                     Z-ADD*ZERO     WN0653  71       TH Adj Live Wgt
     C                     Z-ADD*ZERO     WN0654  71       TH Hot Wgt
     C                     Z-ADD*ZERO     WN0655  61       TH Tot Loin Eye
     C                     Z-ADD*ZERO     WN0656  61       TH Tot Backfat
     C                     Z-ADD*ZERO     WN0657  61       TH Tot Light Re
     C                     Z-ADD*ZERO     WN0658  51       TH Avg Live Wgt
     C                     Z-ADD*ZERO     WN0659  51       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0660  31       TH Avg Light Re
     C                     Z-ADD*ZERO     WN0661  31       TH Avg Lean Per
     C                     Z-ADD*ZERO     WN0662  31       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0663  31       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0664  52       TH Std Yield Pe
     C                     Z-ADD*ZERO     WN0665  52       TH Actual Yield
     C                     Z-ADD*ZERO     WN0666  52       TH Adj Actual Y
     C                     Z-ADD*ZERO     WN0667  52       TH Yield Differ
     C                     Z-ADD*ZERO     WN0668  31       TH Recalc Live
     C                     Z-ADD*ZERO     WN0669  52       TH CM Market Pr
     C                     Z-ADD*ZERO     WN0670  52       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0671  72       TH CM Base Mkt
     C                     Z-ADD*ZERO     WN0672  72       TH CM Sort Disc
     C                     Z-ADD*ZERO     WN0673  72       TH CM Yield Gai
     C                     Z-ADD*ZERO     WN0674  72       TH CM Base Carc
     C                     Z-ADD*ZERO     WN0675  72       TH CM LN AddOn/
     C                     Z-ADD*ZERO     WN0676  72       TH CM Carcass G
     C                     Z-ADD*ZERO     WN0677  72       TH Deduction Am
     C                     Z-ADD*ZERO     WN0678  72       TH Total Net WO
     C                     Z-ADD*ZERO     WN0679  72       TH Carcass Net
     C                     Z-ADD*ZERO     WN0680  72       TH Additions Am
     C                     Z-ADD*ZERO     WN0681  72       TH Payment Gros
     C                     Z-ADD*ZERO     WN0682  72       Th Payment Net
     C                     Z-ADD*ZERO     WN0683  80       TH AP Voucher/D
     C                     Z-ADD*ZERO     WN0684  72       TH Freight Amou
     C                     Z-ADD*ZERO     WN0685  72       TH Accrual Amou
     C                     Z-ADD*ZERO     WN0686  72       TH Fixed Cost A
     C                     MOVEL*BLANK    WN0687  1        TH Calc Net Sts
     C                     MOVEL*BLANK    WN0688  2        TH Payment Sts
     C                     MOVEL*BLANK    WN0689  1        TH Header Error
     C                     MOVEL*BLANK    WN0690  1        TH Detail Error
     C                     MOVEL*BLANK    WN0691  1        TH Kill Balanci
     C                     MOVEL*BLANK    WN0692  1        TH Bal to Kill
     C                     Z-ADD*ZERO     WN0693  70       TH Voucher Paym
     C                     MOVEL*BLANK    WN0694  1        TH User Error O
     C                     MOVEL*BLANK    WN0695  1        TH Held Over Re
     C                     MOVEL*BLANK    WN0696  1        TH Sex
     C                     Z-ADD*ZERO     WN0697  70       TH Held/Ovr Com
     C                     Z-ADD*ZERO     WN0698  70       TH Actual Check
     C                     Z-ADD*ZERO     WN0699  71       TH Shipped Weig
     C                     Z-ADD*ZERO     WN0700  71       TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WN0701  31       TH FFLI
     C                     Z-ADD*ZERO     WN0702  72       TH Kill Product
     C                     Z-ADD*ZERO     WN0703  72       TH Cut Product
     C                     Z-ADD*ZERO     WN0704  72       TH Render Produ
     C                     Z-ADD*ZERO     WN0705  50       TH Head Exclude
     C                     Z-ADD*ZERO     WN0706  52       TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WN0707  52       TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WN0708  52       TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WN0709  52       TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WN0710  52       TH CM Yld G/L L
     C                     Z-ADD*ZERO     WN0711  52       TH CM Yld G/L C
     C                     Z-ADD*ZERO     WN0712  52       TH CM Crc Val L
     C                     Z-ADD*ZERO     WN0713  52       TH CM Crc Val C
     C                     Z-ADD*ZERO     WN0714  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0715  52       TH CM Lean Prem
     C                     Z-ADD*ZERO     WN0716  52       TH CM Gross Liv
     C                     Z-ADD*ZERO     WN0717  52       TH CM Gross Car
     C                     MOVEL*BLANK    WN0718  1        TH Source Type
     C                     MOVEL*BLANK    WN0719  1        TH Scale Ticket
     C                     MOVEL*BLANK    WN0720  1        TH Payment Type
     C                     Z-ADD*ZERO     WN0721  70       TH HPS Movement
     C                     MOVEL*BLANK    WN0722  3        TH Source Code
     C                     MOVEL*BLANK    WN0723  1        TH Hog Class Ty
     C                     MOVEL*BLANK    WN0724  1        TH Posted to HP
     C                     MOVEL*BLANK    WN0725  1        TH Schedule Kil
     C                     MOVEL*BLANK    WN0726  1        TH Shift Held O
     C                     MOVEL*BLANK    WN0727  3        TH State
     C                     MOVEL*BLANK    WN0728  3        TH Unused Code
     C                     MOVEL*BLANK    WN0729  2        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0730  1        TH Paid 2 Week
     C                     MOVEL*BLANK    WN0731  1        TH Unused Sts 1
     C                     Z-ADD*ZERO     WN0732  71       TH DOA Weight
     C                     Z-ADD*ZERO     WN0733  71       TH Avg Lean % E
     C                     Z-ADD*ZERO     WN0734  50       TH HPS Farm Sit
     C                     Z-ADD*ZERO     WN0735  50       TH Shift Held O
     C                     Z-ADD*ZERO     WN0736  72       TH Sorting Amou
     C                     Z-ADD*ZERO     WN0737  50       TH Head Identif
     C                     Z-ADD*ZERO     WN0738  52       TH Percent Iden
     C                     Z-ADD*ZERO     WN0739  52       TH Percent Acce
     C                     Z-ADD*ZERO     WN0740  50       TH Head Adjuste
     C                     Z-ADD*ZERO     WN0741  50       TH PHA Head Add
     C                     MOVEL*BLANK    WN0742  1        TH PHA Add Type
     C                     MOVEL*BLANK    WN0743  3        TH PHA Average
     C                     MOVEL*BLANK    WN0744  1        TH PHA Add Reas
     C                     Z-ADD*ZERO     WN0745  52       TH PHA Yield Pe
     C                     Z-ADD*ZERO     WN0746  52       TH PHA Lean Prm
     C                     Z-ADD*ZERO     WN0747  52       TH VC Gross Val
     C                     Z-ADD*ZERO     WN0748  72       TH Excluded Gro
     C                     Z-ADD*ZERO     WN0749  50       TH Avg Lean %
     C                     Z-ADD*ZERO     WN0750  50       TH Broken Back
     C                     Z-ADD*ZERO     WN0751  70       TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WN0752  70       TH Unused Nbr 4
     C                     Z-ADD*ZERO     WN0753  72       TH Excluded Car
     C                     Z-ADD*ZERO     WN0754  72       TH Excluded Pre
     C                     Z-ADD*ZERO     WN0755  71       TH Unused Nbr 7
     C                     Z-ADD*ZERO     WN0756  71       TH Unused Nbr 8
     C                     Z-ADD*ZERO     WN0757 111       TH Unused Nbr 9
     C                     Z-ADD*ZERO     WN0758 111       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0759 112       TH Break Even P
     C                     Z-ADD*ZERO     WN0760 112       TH Meat Value F
     C                     Z-ADD*ZERO     WN0761  52       TH Yld Parm Adj
     C                     Z-ADD*ZERO     WN0762  52       TH PHA Sort Dis
     C                     Z-ADD*ZERO     WN0763  52       TH Avg Loin Eye
     C                     Z-ADD*ZERO     WN0764  52       TH Avg Backfat
     C                     Z-ADD*ZERO     WN0765  92       TH HITCH Old Pa
     C                     Z-ADD*ZERO     WN0766  92       TH MPR Sort Los
     C                     Z-ADD*ZERO     WN0767  90       TH Unused Nbr 1
     C                     Z-ADD*ZERO     WN0768  90       TH Unused Nbr 2
     C                     Z-ADD*ZERO     WN0769  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0770  70       TH Cold Scl Upl
     C                     Z-ADD*ZERO     WN0771  70       TH Head LFT
     C                     Z-ADD*ZERO     WN0772  70       TH Head EUT/KOA
     C                     Z-ADD*ZERO     WN0773  70       TH Unused Date
     C                     MOVEL*BLANK    WN0774  1        TH Unused Sts 1
     C                     MOVEL*BLANK    WN0775  1        TH Unused Sts 2
     C                     MOVEL*BLANK    WN0776  1        TH Unused Sts 3
     C                     MOVEL*BLANK    WN0777  2        TH Unused Sts 4
     C                     MOVEL*BLANK    WN0778  2        TH Unused Sts 5
     C                     MOVEL*BLANK    WN0779  3        TH Unused Sts 6
     C                     MOVEL*BLANK    WN0780  3        TH Unused Sts 7
     C                     MOVEL*BLANK    WN0781  1        TH Unused Sts 8
     C                     MOVEL*BLANK    WN0782  6        DF Defect Code
     C                     MOVEL*BLANK    WN0783  6        THP Process Cod
     C                     MOVEL*BLANK    WN0784  6        PD Producer Cod
     C                     MOVEL*BLANK    WN0785  6        PL Location Cod
     C                     MOVEL*BLANK    WN0786  3        HB Buyer Code
     C                     MOVEL*BLANK    WN0787  5        GN Genetic Code
     C                     MOVEL*BLANK    WN0788  3        HC Class Code
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YERDC   1
      *
      * Move key fields to @A1CPC5
     C                     Z-ADDWOHMNB    WCHMNB           BOH Company Num
     C                     Z-ADDWOBNNB    WCBNNB           BOH Buy Order N
     C                     Z-ADDWOBONB    WCBONB           BOL Load Number
     C                     Z-ADDWOCVNB    WCCVNB           TH Tattoo Numbe
     C                     Z-ADDWOB0DT    WCB0DT           TH Kill Date
      *
     C           KLCHTN    KLIST
     C                     KFLD           WCHMNB           BOH Company Num
     C                     KFLD           WCBNNB           BOH Buy Order N
     C                     KFLD           WCBONB           BOL Load Number
     C                     KFLD           WCCVNB           TH Tattoo Numbe
     C                     KFLD           WCB0DT           TH Kill Date
     C           KLCHTN    CHAIN@A1CPC5              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'PKA1CPL1'MDACP
     C                     MOVEL'@A1CPC5' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL005.
     C                     MOVEL'LBL005'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO TNEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO TNEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QPKA11    YERDCS
      * Move non-key fields to @A1CPC5
     C                     Z-ADD*ZERO     WCGHNB           TH Commission A
     C                     Z-ADD*ZERO     WCBTDT           TH Commission P
     C                     MOVEL'C'       WCR5ST    P      TH Commission S
     C                     MOVELWOAAVN    WCAAVN    P      RS User Changed
     C                     Z-ADDWOAADT    WCAADT           RS Date Changed
     C                     Z-ADDWOAMTM    WCAMTM           RS Time Changed
     C                     MOVELWOAJST    WCAJST    P      RS Record Statu
     C                     MOVELWOAHVN    WCAHVN    P      RS Job
     C                     MOVELWOAGVN    WCAGVN    P      RS Program
     C                     MOVELWOABVN    WCABVN    P      RS User Added
     C                     Z-ADDWOABDT    WCABDT           RS Date Added
     C                     Z-ADDWOABTM    WCABTM           RS Time Added
      *
      * Set PGM.*Record Data Changed flag
     C           QPKA11    IFNE YERDCS
     C           YERDC     ANDNE'N'
     C                     MOVE 'Y'       YERDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YERDC     IFEQ 'Y'
     C                     UPDAT@A1CPC5                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKPKA1CPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         TNEXIT    ENDSR
      /EJECT
     CSR         TORVGN    BEGSR
      *================================================================
      * Rtv BOL Reimb hd sum  RT - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADDWUE9NB    WUDDNB           Re-imbursement
      * Declare restrictor key work fields
     C           *LIKE     DEFN WRHMNB    WQTO01           BOH Company Num
     C           *LIKE     DEFN WRBNNB    WQTO02           BOH Buy Order N
     C           *LIKE     DEFN WRBONB    WQTO03           BOL Load Number
      * Define keylist
     C           KRSTO     KLIST
     C                     KFLD           WQTO01           BOH Company Num
     C                     KFLD           WQTO02           BOH Buy Order N
     C                     KFLD           WQTO03           BOL Load Number
      * Setup key
     C                     Z-ADDWAHMNB    WQTO01           BOH Company Num
     C                     Z-ADDWABNNB    WQTO02           BOH Buy Order N
     C                     Z-ADDWABONB    WQTO03           BOL Load Number
      * Establish starting position
     C           KRSTO     SETLL@CDCPV4                    *
     C           KRSTO     READE@CDCPV4                  90*
      * Data record not found
     C   90                MOVEL'PRK0174' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C                     ADD  WRAQNB    WUDDNB           Re-imbursement
     C           KRSTO     READE@CDCPV4                  90*
     C                     ENDDO
      *================================================================
     CSR         TOEXIT    ENDSR
      /EJECT
     CSR         TPRVGN    BEGSR
      *================================================================
      * Rtv Comm/Group        RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTP     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WMBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTP     CHAIN@AWCPBI              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0049' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    WN0790           BOH Commodity M
     C                     MOVEL*BLANK    WN0791           BOH Commodity P
     C                     GOTO TPEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMETCD    WN0790           BOH Commodity M
     C                     MOVELWMEUCD    WN0791           BOH Commodity P
     C                     GOTO TPEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         TPEXIT    ENDSR
      /EJECT
     CSR         TQCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWULLPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWXJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWXEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUAQNB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL*BLANK    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTQ    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTQ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TQEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TQEXIT    ENDSR
      /EJECT
     CSR         TRRVGN    BEGSR
      *================================================================
      * Rtv Held Over KillDts RT - Tattoo Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSHMNB    WQTR01           BOH Company Num
     C           *LIKE     DEFN WSBNNB    WQTR02           BOH Buy Order N
     C           *LIKE     DEFN WSBONB    WQTR03           BOL Load Number
     C           *LIKE     DEFN WSCVNB    WQTR04           TH Tattoo Numbe
      * Define keylist
     C           KRSTR     KLIST
     C                     KFLD           WQTR01           BOH Company Num
     C                     KFLD           WQTR02           BOH Buy Order N
     C                     KFLD           WQTR03           BOL Load Number
     C                     KFLD           WQTR04           TH Tattoo Numbe
      * Setup key
     C                     Z-ADDWAHMNB    WQTR01           BOH Company Num
     C                     Z-ADDWABNNB    WQTR02           BOH Buy Order N
     C                     Z-ADDWABONB    WQTR03           BOL Load Number
     C                     Z-ADDWACVNB    WQTR04           TH Tattoo Numbe
      * Establish starting position
     C           KRSTR     SETLL@A1CPC7                    *
     C           KRSTR     READE@A1CPC7                  90*
      * Data record not found
     C   90                MOVEL'PRK0061' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.TH Kill Date NE PAR.Kill Date 1 Usr
     C           WSB0DT    IFNE WAB0DT                     *IF
     C                     Z-ADDWSB0DT    YL0011           Kill Date Usr
     C                     GOTO TREXIT                     *QUIT
     C                     END                             *FI
     C           KRSTR     READE@A1CPC7                  90*
     C                     ENDDO
      *================================================================
     CSR         TREXIT    ENDSR
      /EJECT
     CSR         TSCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWATAPR    WIAZVA           THD Unit Amt
     C                     Z-ADDYL0013    WIA0VA           THD Ded/Add Amo
     C                     MOVELWXJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWXEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWAFCNB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL*BLANK    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTS    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTS    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TSEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TSEXIT    ENDSR
      /EJECT
     CSR         TTRVGN    BEGSR
      *================================================================
      * Rtv PurchPrc Clc BrkEORT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTT     KLIST
     C                     KFLD           WTAKCD           PC Contract Cod
     C                     KFLD           WTALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWUAKCD    WTAKCD           PC Contract Cod
     C                     MOVELWUALCD    WTALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSTT     CHAIN@AQCPA0              90    *
      * Data record not found
     C   90                MOVEL'PRK0037' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTA7PR    WUA7PR           PSC Break Even
     C                     ENDIF
      *================================================================
     CSR         TTEXIT    ENDSR
      /EJECT
     CSR         TUCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWUCEPR    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWXJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWXEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADD*ZERO     WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVEL*BLANK    WIPGST           THD Reserve Acc
     C                     MOVEL*BLANK    WIPIST           THD Commission
     C                     MOVEL'Y'       WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTU    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTU    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TUEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TUEXIT    ENDSR
      /EJECT
     CSR         TVRVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Buy Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTV     KLIST
     C                     KFLD           WMHMNB           BOH Company Num
     C                     KFLD           WMBNNB           BOH Buy Order N
      * Setup key
     C                     Z-ADDWAHMNB    WMHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WMBNNB           BOH Buy Order N
      * Establish starting position
     C           KRSTV     CHAIN@AWCPBI              90    *
      * Data record not found
     C   90                MOVEL'PRK0049' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWMAKCD    WN0796           PC Contract Cod
     C                     MOVELWMALCD    WN0797           PSC Sub-Contrac
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
     C                     EXSR TWRVGN
     C                     ENDIF
      *================================================================
     CSR         TVEXIT    ENDSR
      /EJECT
     CSR         TWRVGN    BEGSR
      *================================================================
      * Rtv Sub-Contract Type RT - Producer Sub-Contract  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTW     KLIST
     C                     KFLD           WTAKCD           PC Contract Cod
     C                     KFLD           WTALCD           PSC Sub-Contrac
      * Setup key
     C                     MOVELWMAKCD    WTAKCD           PC Contract Cod
     C                     MOVELWMALCD    WTALCD           PSC Sub-Contrac
      * Establish starting position
     C           KRSTW     CHAIN@AQCPA0              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0037' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0792           PSC FLoor Price
     C                     MOVEL*BLANK    WN0793           PSC Sub-Contrac
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TWEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWTA8PR    WN0792           PSC FLoor Price
     C                     MOVELWTF3ST    WN0793           PSC Sub-Contrac
     C                     ENDIF
      *================================================================
     CSR         TWEXIT    ENDSR
      /EJECT
     CSR         TXRVGN    BEGSR
      *================================================================
      * RTV Floor Price       RT - Producer SC Floor Price  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSTX     KLIST
     C                     KFLD           WVAKCD           PC Contract Cod
     C                     KFLD           WVALCD           PSC Sub-Contrac
     C                     KFLD           WVDJDT           PFP Week Ending
      * Setup key
     C                     MOVELWN0796    WVAKCD           PC Contract Cod
     C                     MOVELWN0797    WVALCD           PSC Sub-Contrac
     C                     Z-ADDWN0794    WVDJDT           PFP Week Ending
      * Establish starting position
     C           KRSTX     CHAIN@ECCPAG              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0816' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0795           PFP Adjusted Fl
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TXEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWVODPR    WN0795           PFP Adjusted Fl
     C                     ENDIF
      *================================================================
     CSR         TXEXIT    ENDSR
      /EJECT
     CSR         TYRVGN    BEGSR
      *================================================================
      * Val Reserv Acct Exists RT - Producer Cntrct RsvAct Hd  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     MOVEL'N'       WN0798           Balance Exists
      * Define keylist
     C           KRSTY     KLIST
     C                     KFLD           WWAKCD           PC Contract Cod
      * Setup key
     C                     MOVELWN0796    WWAKCD           PC Contract Cod
      * Establish starting position
     C           KRSTY     CHAIN@EECPAP              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'PRK0820' W0RTN   7
      * USER: Processing if Data record not found
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO TYEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * CASE: DB1.PAH Account Balance GT WRK.Zero USR
     C           WWEJVA    IFGT WUE9NB                     *IF
     C                     MOVEL'Y'       WN0798           Balance Exists
     C                     END                             *FI
     C                     ENDIF
      *================================================================
     CSR         TYEXIT    ENDSR
      /EJECT
     CSR         TZCRRC    BEGSR
      *================================================================
      * Create Tattoo Deduction - Tattoo Ded/Add  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Move all fields to @CDCPIT
     C                     Z-ADDWAHMNB    WIHMNB           BOH Company Num
     C                     Z-ADDWABNNB    WIBNNB           BOH Buy Order N
     C                     Z-ADDWABONB    WIBONB           BOL Load Number
     C                     Z-ADDWACVNB    WICVNB           TH Tattoo Numbe
     C                     Z-ADDWAB0DT    WIB0DT           TH Kill Date
     C                     MOVELWLBQCD    WIBQCD           DED D/A Code
     C                     Z-ADDWXA1VA    WIAZVA           THD Unit Amt
     C                     Z-ADDWUCFPR    WIA0VA           THD Ded/Add Amo
     C                     MOVELWXJAST    WIJBST           THD Unit Amt Si
     C                     MOVELWXEVST    WIEIST           THD UOM
     C                     MOVEL'S'       WIJDST           THD Transaction
     C                     MOVELWLF7TX    WIDPCD           THD GL Code
     C                     MOVELWLE2CD    WIE3CD           THD Contra Gl C
     C                     Z-ADDWUE9NB    WIAQNB           THD Re-imbursem
     C                     MOVELWACWST    WIOCST           THD Payment Sts
     C                     MOVELWUPEST    WIPEST           THD Expense Pai
     C                     MOVELWUPFST    WIPFST           THD Expense Typ
     C                     MOVELWLNWST    WIPGST           THD Reserve Acc
     C                     MOVELWUPIST    WIPIST           THD Commission
     C                     MOVELWUPJST    WIPJST           THD Deferred Pa
     C                     MOVEL*BLANK    WIPKST           THD Status 4
     C                     MOVEL*BLANK    WIPLST           THD Status 5
     C                     MOVEL*BLANK    WIAAVN           RS User Changed
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##JOB     WIAHVN           RS Job
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
      *
      * USER: Processing before Data update
      * Rtv Add Stamp         IF
     C                     MOVEL'A'       WIAJST           RS Record Statu
     C                     MOVEL##USR     WIABVN           RS User Added
     C                     Z-ADD##JDT     WIABDT           RS Date Added
     C                     Z-ADD##JTM     WIABTM           RS Time Added
     C                     MOVEL##PGM     WIAGVN           RS Program
     C                     MOVEL##JOB     WIAHVN           RS Job
     C           KLCRTZ    KLIST
     C                     KFLD           WIHMNB           BOH Company Num
     C                     KFLD           WIBNNB           BOH Buy Order N
     C                     KFLD           WIBONB           BOL Load Number
     C                     KFLD           WICVNB           TH Tattoo Numbe
     C                     KFLD           WIB0DT           TH Kill Date
     C                     KFLD           WIBQCD           DED D/A Code
      * Check for duplicate primary key
     C           KLCRTZ    SETLL@CDCPIT                  90*
     C           *IN90     IFEQ '1'
     C                     MOVEL'PRK0175' W0RTN   7
      * Send message 'Tattoo Ded/Add         EX'
     C                     MOVEL'PRK0175' ZAMSID
     C                     EXSR ZASNMS
     C                     GOTO TZEXIT
     C                     ENDIF
      *
     C                     WRITE@CDCPIT                91  *
      *
     C           *IN91     IFEQ '1'
      * Write error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
     C                     ENDIF
      *================================================================
     CSR         TZEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Modifications and Comments
      *================================================================
      * 05/16/17 slm Add Company to Producer Std Ded/Add and also
      * the producer location std ded/add
      * E3814 JJH 10/07/15 - Recompile because PS Premises ID added to
      *   Producer Site. - No logic changes.
      * H16853 ISE 11/02/20 - Increased the Buy Order Number field
      *                       length from 5 to 7.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Set Live Gross and Payment Gross to Zeros and all net's to zero
      *================================================================
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA4VA           TH Total Net WO
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         UCSUBR    BEGSR
      *================================================================
      * If live and paid then calculate carcass net pay
      *================================================================
      * Clc carcass net, Live, and Payment
     C                     EXSR UDSUBR                     Clc carcass net
      *================================================================
     CSR         UCEXIT    ENDSR
      /EJECT
     CSR         UDSUBR    BEGSR
      *================================================================
      * Clc carcass net, Live, and Payment
      *================================================================
     C           WACBPR    SUB  WAASPR    WUA4VA           TH Total Net WO
      * CASE: DB1.TH Hog Class Type is Market
     C           WALLST    IFEQ 'M'                        *IF
     C           WAAPPR    ADD  WAA5VA    WUATPR           TH Carcass Net
     C                     SUB  WAASPR    WUATPR           TH Carcass Net
     C                     END                             *FI
      *================================================================
     CSR         UDEXIT    ENDSR
      /EJECT
     CSR         UESUBR    BEGSR
      *================================================================
      * Set Live Gross and Payment Gross to Zeros and all net's to zero
      *================================================================
     C                     Z-ADD*ZERO     WUB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WUCBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WUCCPR           Th Payment Net
     C                     Z-ADD*ZERO     WUCAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WUATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WUA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WUA7VA           TH Accrual Amou
      *================================================================
     CSR         UEEXIT    ENDSR
      /EJECT
     CSR         UFSUBR    BEGSR
      *================================================================
      * Clc Live Gross and Payment Gross
      *================================================================
      * E2521 03/27/13  slm mpr cutout or hog cutout. hard code remove in
      * Calculate Live Price  PK0202
      * CASE:
      *  - c1 AND c2
      *   |- c1    : DB1.TH Live Purchase Price is Zeros
      *   |- c2    : DB1.TH Hog Class Type is Resale
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WAACPR    IFEQ 0                          *IF
     C           WALLST    IFEQ 'R'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     MOVEL'LW'      YL0001           TH Live Purchas
      * Clc Live Price        RT - Tattoo Defect  * 
     C                     EXSR SDRVGN
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVELWACPST    YL0001           TH Live Purchas
     C                     Z-ADDWAACPR    YL0002           TH Live Purchas
     C                     END                             *FI
      * calculate live gross amount
      * CASE: LCL.TH Live Purchase Price is Not Zeros
     C           YL0002    IFNE 0                          *IF
      * Calculate Live Gross
      * Miles = zero
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WAEDDT' defaulted for 'TH Head EUT/KOA'.
      * Clc UOM Extension     IF
      * Extension
      * CASE: PAR.Trans UOM USR is Flat
     C           YL0001    IFEQ 'FL'                       *IF
      * * * * * *   FLAT    * * * * *
      * FLAT
      * CASE: PAR.Trans UOM USR is Flat
     C           YL0001    IFEQ 'FL'                       *IF
     C           YL0002    MULT 1         WUB9PR           Trans Extended
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Head UOM
     C           YL0001    IFEQ 'DH'                       *IF
     C           YL0001    OREQ 'RH'
     C           YL0001    OREQ 'YH'
     C           YL0001    OREQ 'CH'
     C           YL0001    OREQ 'KH'
     C           YL0001    OREQ 'NH'
     C           YL0001    OREQ 'DY'
     C           YL0001    OREQ 'RX'
     C           YL0001    OREQ 'HM'
     C           YL0001    OREQ 'DE'
      * * * * * *    HEAD   * * * * *
      * HEAD
      * CASE: PAR.Trans UOM USR is Received Head
     C           YL0001    IFEQ 'RH'                       *IF
     C           WACWNB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Hd less Yard Dd
     C           YL0001    IFEQ 'RX'                       *IF
     C           WACWNB    SUB  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Killed Head
     C           YL0001    IFEQ 'KH'                       *IF
     C           WAFENB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Condemned Head
     C           YL0001    IFEQ 'CH'                       *IF
     C           WAFDNB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Yard Deads Head
     C           YL0001    IFEQ 'YH'                       *IF
     C           WAFCNB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head
     C           YL0001    IFEQ 'DH'                       *IF
     C           WACXNB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Head
     C           YL0001    IFEQ 'NH'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA Head + Yard Dead Head
     C           YL0001    IFEQ 'DY'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C           WUF6NB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is DOA HD + Yard Dead + EUT
     C           YL0001    IFEQ 'DE'                       *IF
     C           WACXNB    ADD  WAFCNB    WUF6NB           Net Head Usr
     C                     ADD  WAEDDT    WUF6NB           Net Head Usr
     C           WUF6NB    MULT YL0002    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Received Head /100 Miles
     C           YL0001    IFEQ 'HM'                       *IF
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (x1 * x2 * (x3/x4))
      * x1    : PAR.PSM Miles to Company
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x2    : PAR.TH Head Killed
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,5) work field *Rounded
      * x4    : CON.100
     C           *ZERO     MULT WAFENB    W0WA01           *Synon (15,2) w
     C           YL0002    DIV  100       W0WB02    H      *Synon (15,5) w
     C           W0WA01    MULT W0WB02    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUB9PR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Weight UOM
     C           YL0001    IFEQ 'CW'                       *IF
     C           YL0001    OREQ 'LW'
     C           YL0001    OREQ 'NL'
     C           YL0001    OREQ 'SW'
     C           YL0001    OREQ 'LX'
     C           YL0001    OREQ 'SX'
      * * * * * *    WEIGHT   * * * * *
      * WEIGHT
      * CASE: PAR.Trans UOM USR is Live Hundred Weight
     C           YL0001    IFEQ 'LW'                       *IF
      * Live hundred wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Live Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACYNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0002    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is LW less Yard Dead Wgt
     C           YL0001    IFEQ 'LX'                       *IF
      *  Calc wgt of yard dead based on Th avg live wgt
     C           WAF7NB    MULT WAFCNB    WUCCNB           Yard dead weigh
      *   Subtract Yard Dead wgt from Live Wgt
     C           WACYNB    SUB  WUCCNB    WUOONB           Live Weight
      * Live hundred wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Live Weight           USR
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUOONB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0002    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           YL0001    IFEQ 'CW'                       *IF
      * Carcass Hundred Wgt
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0002    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Net Live Weight
     C           YL0001    IFEQ 'NL'                       *IF
     C                     Z-ADDWACWNB    WUF6NB           Net Head Usr
     C                     SUB  WAFCNB    WUF6NB           Net Head Usr
     C                     SUB  WAFDNB    WUF6NB           Net Head Usr
      * * Insert avg live weight
     C           WUF6NB    MULT WAF7NB    WUVBNB           Net Live Weight
      * Net Live Weight
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Net Live Weight Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUVBNB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0002    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Shipped Weight - Doa's
     C           YL0001    IFEQ 'SW'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract doa's from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped Weight Total Ext
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0002    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is SW - Doa's WT - Yrd Dd WT
     C           YL0001    IFEQ 'SX'                       *IF
      *   Calc Avg shipped wgt, then calc wgt of DOA'S and Yard Deads
      * This rule was defined on 01/14/97
      * The Calculations for Avg Shipped Weights are
      * Head Received should be the live hogs that walk across the scale
      * Doa's should be the hogs that died either after we collected
      *       or before we weighed them
      * Avg Shipped Weight : Shipped Weight /(Head Received + Doa's)
     C           WACWNB    ADD  WACXNB    WUEXNB           Hd Cnt Org Ship
      * CASE: WRK.Hd Cnt Org Ship Usr is *Zeros
     C           WUEXNB    IFEQ 0                          *IF
     C                     Z-ADD*ZERO     WUY9NB           Avg Weight USR
     C                     ELSE
      * CASE: *OTHERWISE
     C           WAHGNB    DIV  WUEXNB    WUY9NB           Avg Weight USR
     C                     END                             *FI
     C           WUY9NB    MULT WAFCNB    WUCCNB           Yard dead weigh
     C           WUY9NB    MULT WACXNB    WUEVNB           Doa's Avg Weigh
      *   Subtract Doa's and Subtract Yard Dead wgt from Shipped Wgt
     C           WAHGNB    SUB  WUEVNB    WUZ4NB           Ship Wgt Tot Us
     C                     SUB  WUCCNB    WUZ4NB           Ship Wgt Tot Us
      * Shipped wgt less Yd
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Ship Wgt Tot Usr
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUZ4NB    DIV  100       W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT YL0002    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    WUB9PR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Value UOM
     C           YL0001    IFEQ 'GV'                       *IF
     C           YL0001    OREQ 'BD'
      * * * * * *    VALUE    * * * * *
      * VALUE
      * CASE: PAR.Trans UOM USR is Gross Hundred Value
     C           YL0001    IFEQ 'GV'                       *IF
      * Gross Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Payment Gross
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WACBPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0002    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Carcass Hundred Weight
     C           YL0001    IFEQ 'CW'                       *IF
      * Carcass Hundred Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.TH Hot Wgt
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WAE0NB    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0002    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Base Market Dollars
     C           YL0001    IFEQ 'BD'                       *IF
      * Clc Base Mkt Dollars  XF - STR Unit of Measure Calc  * 
     C                     CALL 'PKBSE01'              90  Clc Base Mkt Do
     C                     PARM *BLANK    W0RTN   7
     C                     PARM WAHMNB    WQ0017  30       BOH Company Num
     C                     PARM WAAWDT    WQ0018  70       TH Purchase Dat
     C                     PARM WACYNB    WQ0019  71       TH Live Wgt
     C                     PARM *BLANK    WQ0020  5        DED D/A Code
     C           WUCSPR    PARM *ZERO     WQ0021  92       Base Mkt Prc Am
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PKBSE01' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * CASE: WRK.Base Mkt Prc Amt Tot USR GE WRK.Zero USR
     C           WUCSPR    IFGE WUE9NB                     *IF
      * Base Market Dollars
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : WRK.Base Mkt Prc Amt Tot USR
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.Trans Unit Amt Usr
     C           WUCSPR    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT YL0002    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUB9PR           Trans Extended
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     WUB9PR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Trans UOM USR is Percent UOM
     C           YL0001    IFEQ *BLANK                     *IF
      * * * * * *    PERCENT   * * * * *
      * PERCENT
      * CASE: PAR.Trans UOM USR is Percent of Gross Value
     C           YL0001    IFEQ *BLANK                     *IF
      * Percent of Gross Value
      * PAR.Trans Extended Amt Usr =
      *    *COMPUTE (((x1 / x2) * x3))
      * x1    : PAR.Trans Unit Amt Usr
      * /     : PGM.*Synon (15,2) work field *Rounded
      * x2    : CON.100
      * *     : PGM.*Synon (15,2) work field *Rounded
      * x3    : PAR.TH Payment Gross
     C           YL0002    DIV  100       W0WA01    H      *Synon (15,2) w
     C           W0WA01    MULT WACBPR    W0WA00    H      *Synon (15,2) w
     C                     Z-ADDW0WA00    WUB9PR           Trans Extended
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * Calculate Payment Gross
      * CASE: DB1.TH Payment Sts is Live Payment
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C           WACWST    OREQ 'NL'
     C                     Z-ADDWUB9PR    WUCBPR           TH Payment Gros
     C                     MOVEL'L'       WUJ9ST           TH Payment Type
      * ++++++++++++++++++++++++++++++++
     C                     ELSE
      * CASE: DB1.TH Payment Sts is Carcass Merit Payment
     C           WACWST    IFEQ 'SC'                       *IF
     C           WACWST    OREQ 'IC'
     C                     Z-ADDWAAPPR    WUCBPR           TH Payment Gros
     C                     MOVEL'C'       WUJ9ST           TH Payment Type
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UFEXIT    ENDSR
      /EJECT
     CSR         UGSUBR    BEGSR
      *================================================================
      * Hog Cutout - Hard code for special features.
      *================================================================
      * Review by Purva and Susan, at this time both plants do
      * not use this due to the markets and commodity on the
      * hog defect does not have this entered.
      * but they did you this at one time.
      * will leave this feature in incase they go back to this calculatio
      *================================================================
     CSR         UGEXIT    ENDSR
      /EJECT
     CSR         UHSUBR    BEGSR
      *================================================================
      * Accumulate d/a and calculate net pay
      *================================================================
      * HPE053P- Include Dead Head Uom
      * Rtv Tattoo Hdr Totls RT - Tattoo Ded/Add  * 
     C                     EXSR NFRVGN
      * Clc Net for Carcass, Live, and Payment
     C                     EXSR UISUBR                     Clc Net for Car
      *================================================================
     CSR         UHEXIT    ENDSR
      /EJECT
     CSR         UISUBR    BEGSR
      *================================================================
      * Clc Net for Carcass, Live, and Payment
      *================================================================
     C           WUCBPR    SUB  WUASPR    WUA4VA           TH Total Net WO
     C           WUCBPR    ADD  WUA5VA    WUCCPR           Th Payment Net
     C                     SUB  WUASPR    WUCCPR           Th Payment Net
      * Calculate either live net or carcass net
      * CASE: DB1.TH Payment Sts is Live Payment
     C           WACWST    IFEQ 'ML'                       *IF
     C           WACWST    OREQ 'SL'
     C           WACWST    OREQ 'IL'
     C           WACWST    OREQ 'NL'
      * Calculate net amount for live payment
     C           WUB9PR    ADD  WUA5VA    WUCAPR           TH LIve Net Amt
     C                     SUB  WUASPR    WUCAPR           TH LIve Net Amt
      * Paying live if market hog will have carcass merit totals
      * CASE: DB1.TH Hog Class Type is Market
     C           WALLST    IFEQ 'M'                        *IF
     C           WAAPPR    ADD  WUA5VA    WUATPR           TH Carcass Net
     C                     SUB  WUASPR    WUATPR           TH Carcass Net
     C                     END                             *FI
     C                     ELSE
      * CASE: DB1.TH Payment Sts is Carcass Merit Payment
     C           WACWST    IFEQ 'SC'                       *IF
     C           WACWST    OREQ 'IC'
      * Calculate net amount for carcass merit fields
      * and total without adds
     C           WAAPPR    ADD  WUA5VA    WUATPR           TH Carcass Net
     C                     SUB  WUASPR    WUATPR           TH Carcass Net
     C                     END                             *FI
     C                     END                             *FI
      *================================================================
     CSR         UIEXIT    ENDSR
      /EJECT
     CSR         XCVTA     BEGSR
      *================================================================
      * Convert date to absolute day (from 01/01/01)
      *================================================================
      * Absolute day =
      * 365*(YY-1)+(YY-1)/4 (past years w/extra days of leap ones) ...
     C           XDINYY    SUB  1         XDWK1   80
     C           XDWK1     MULT 365.25    XDAY1   60
     C           XDWK1     IFGE 300
     C                     SUB  2         XDAY1
     C                     ELSE
     C           XDWK1     IFGE 100
     C                     SUB  1         XDAY1
     C                     END
     C                     END
      * (from the beginning of the year to the beginning of the month:)
     C           XDINMM    SUB  1         XDWK1
     C           XDINMM    IFLT 3
      *     ...+31*(MM-1) (for January-February) ...
     C                     MULT 31        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *     ...+30*(MM-1) (for March-December) ...
     C                     MULT 30        XDWK1
     C                     ADD  XDWK1     XDAY1
      *         ...-2 (for preceding February) ...
     C                     SUB  2         XDAY1
     C           XDINYY    IFNE 100
     C           XDINYY    ANDNE300
      *         ...+1 (for preceding February, if leap year) ...
     C           XDINYY    DIV  4         XDWK1
     C                     MVR            XDWK1
     C           XDWK1     IFEQ 0
     C                     ADD  1         XDAY1
     C                     END
     C                     END
     C           XDINMM    IFLT 8
      *         ...+MM/2 (preceding 31-sts for March-July) ...
     C           XDINMM    MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     ELSE
      *         ...+(MM+1)/2 (same for August-December) ...
     C           XDINMM    ADD  1         XDWK1
     C                     MULT .5        XDWK1
     C                     ADD  XDWK1     XDAY1
     C                     END
     C                     END
      * ...+DD (days in the month up to the ending date)
     C                     ADD  XDINDD    XDAY1
      *================================================================
     CSR         XCVTAE    ENDSR
      /EJECT
     CSR         XDOWS     BEGSR
      *================================================================
      * Setup days of week array
      *================================================================
     C                     MOVEAXDCDW     YDOW
     C                     Z-ADD0         XDWSL   10
     C                     Z-ADD1         YY
     C           YY        DOWLE7
     C           YDOW,YY   IFEQ XDSEL
     C                     ADD  1         XDWSL
     C                     END
     C                     ADD  1         YY
     C                     END
      *================================================================
     CSR         XDOWSE    ENDSR
      /EJECT
     CSR         XDUDY     BEGSR
      *================================================================
      * Calculate duration, *DAYS
      *================================================================
     C           XDAY1     IFLT 1
     C           XDAY2     ORLT 1
     C                     Z-ADD0         XDURR
     C                     MOVEL'Y2U0006' W0RTN   7
     C                     GOTO XDUDYE
     C                     END
     C           XDAY1     IFGE XDAY2
      * From date2 to date1
     C                     Z-ADDXDAY2     XABEG   60
     C                     Z-ADDXDAY1     XAEND   60
     C                     ELSE
      * From date1 to date2
     C                     Z-ADDXDAY1     XABEG   60
     C                     Z-ADDXDAY2     XAEND   60
     C                     END
     C           XDWSL     IFEQ 0
      * None days of week selected
     C                     Z-ADD0         XDURR
     C                     GOTO XDUDYC
     C                     END
     C           XAEND     SUB  XABEG     XDURR   80
     C           XDWSL     IFEQ 7
      * All days of week selected
     C                     GOTO XDUDYC
     C                     END
      * Some days of week selected
     C                     DIV  7         XDURR
     C                     MVR            XDLSW   10
     C                     MULT XDWSL     XDURR
     C           XDLSW     IFNE 0
      * Determine day of week of the beginning date
     C           XABEG     ADD  3         YY      60
     C                     DIV  7         YY
     C                     MVR            YY
      * Loop: Increment the date by the last week
     C           XDLSW     DOWGT0
      * Increment the day of week
     C                     ADD  1         YY
     C                     SUB  1         XDLSW
      * Put day of week into the range 1-7
     C           YY        IFEQ 8
     C                     Z-ADD1         YY
     C                     END
      * Selected day of the last week has been processed
     C           YDOW,YY   IFEQ XDSEL
      * Increment duration
     C                     ADD  1         XDURR
     C                     END
      * End of loop
     C                     END
     C                     END
     C           XDUDYC    TAG
     C           XDURR     IFEQ 0
      * Return Code: Unable to calculate duration
     C                     MOVEL'Y2U0060' W0RTN   7
     C                     ELSE
     C                     MOVEL*BLANK    W0RTN   7
     C                     END
      *================================================================
     CSR         XDUDYE    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
      * If no message file specified, use default
     C           ZAMSGF    IFEQ *BLANK
     C                     MOVELZADFMF    ZAMSGF
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Copy any undisplayed messages back to caller
     C                     CALL 'Y2CPMSC'
     C                     PARM           ##PGM
      *
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WAHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WABNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WABONB           BOL Load Number
     C                     Z-ADD*ZERO     WACVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WAB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WAAWDT           TH Purchase Dat
     C                     Z-ADD*ZERO     WAACPR           TH Live Purchas
     C                     Z-ADD*ZERO     WAB9PR           TH Live Gross A
     C                     Z-ADD*ZERO     WACAPR           TH LIve Net Amt
     C                     Z-ADD*ZERO     WAAIPR           TH Recalc Live
     C                     Z-ADD*ZERO     WAA6DT           TH Pricing Date
     C                     Z-ADD*ZERO     WACXNB           TH Dead On Arri
     C                     Z-ADD*ZERO     WACWNB           TH Head Receive
     C                     Z-ADD*ZERO     WAFCNB           TH Yard Deads
     C                     Z-ADD*ZERO     WAH9NB           TH Held Over
     C                     Z-ADD*ZERO     WAFDNB           TH Head Condemn
     C                     Z-ADD*ZERO     WAFENB           TH Head Killed
     C                     Z-ADD*ZERO     WAHENB           TH Head Adds
     C                     Z-ADD*ZERO     WAHFNB           TH Head Accepte
     C                     Z-ADD*ZERO     WACYNB           TH Live Wgt
     C                     Z-ADD*ZERO     WALRNB           TH Adj Live Wgt
     C                     Z-ADD*ZERO     WAE0NB           TH Hot Wgt
     C                     Z-ADD*ZERO     WAA5PC           TH Tot Loin Eye
     C                     Z-ADD*ZERO     WAFBNB           TH Tot Backfat
     C                     Z-ADD*ZERO     WAA4PC           TH Tot Light Re
     C                     Z-ADD*ZERO     WAF7NB           TH Avg Live Wgt
     C                     Z-ADD*ZERO     WAHDNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAF5NB           TH Avg Light Re
     C                     Z-ADD*ZERO     WAF4NB           TH Avg Lean Per
     C                     Z-ADD*ZERO     WAF3NB           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAF2NB           TH Avg Backfat
     C                     Z-ADD*ZERO     WAAVPC           TH Std Yield Pe
     C                     Z-ADD*ZERO     WAAWPC           TH Actual Yield
     C                     Z-ADD*ZERO     WACWPC           TH Adj Actual Y
     C                     Z-ADD*ZERO     WAA8PC           TH Yield Differ
     C                     Z-ADD*ZERO     WAA7PC           TH Recalc Live
     C                     Z-ADD*ZERO     WAB8PR           TH CM Market Pr
     C                     Z-ADD*ZERO     WAAMPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAANPR           TH CM Base Mkt
     C                     Z-ADD*ZERO     WAAYVA           TH CM Sort Disc
     C                     Z-ADD*ZERO     WAAWVA           TH CM Yield Gai
     C                     Z-ADD*ZERO     WAAOPR           TH CM Base Carc
     C                     Z-ADD*ZERO     WAAXVA           TH CM LN AddOn/
     C                     Z-ADD*ZERO     WAAPPR           TH CM Carcass G
     C                     Z-ADD*ZERO     WAASPR           TH Deduction Am
     C                     Z-ADD*ZERO     WAA4VA           TH Total Net WO
     C                     Z-ADD*ZERO     WAATPR           TH Carcass Net
     C                     Z-ADD*ZERO     WAA5VA           TH Additions Am
     C                     Z-ADD*ZERO     WACBPR           TH Payment Gros
     C                     Z-ADD*ZERO     WACCPR           Th Payment Net
     C                     Z-ADD*ZERO     WALPNB           TH AP Voucher/D
     C                     Z-ADD*ZERO     WACDPR           TH Freight Amou
     C                     Z-ADD*ZERO     WAA7VA           TH Accrual Amou
     C                     Z-ADD*ZERO     WAA2PR           TH Fixed Cost A
     C                     Z-ADD*ZERO     WAGHNB           TH Commission A
     C                     Z-ADD*ZERO     WABYDT           TH Voucher Paym
     C                     Z-ADD*ZERO     WABSDT           TH Held/Ovr Com
     C                     Z-ADD*ZERO     WABTDT           TH Commission P
     C                     Z-ADD*ZERO     WABUDT           TH Actual Check
     C                     Z-ADD*ZERO     WAHGNB           TH Shipped Weig
     C                     Z-ADD*ZERO     WAHHNB           TH Avg Hot Wgt
     C                     Z-ADD*ZERO     WAHINB           TH FFLI
     C                     Z-ADD*ZERO     WAA3PR           TH Kill Product
     C                     Z-ADD*ZERO     WAA4PR           TH Cut Product
     C                     Z-ADD*ZERO     WAA6PR           TH Render Produ
     C                     Z-ADD*ZERO     WAJ9NB           TH Head Exclude
     C                     Z-ADD*ZERO     WAD6PR           TH CM Bse Mkt L
     C                     Z-ADD*ZERO     WAD7PR           TH CM Bse Mkt C
     C                     Z-ADD*ZERO     WAD8PR           TH CM Srt Dsc L
     C                     Z-ADD*ZERO     WAD9PR           TH CM Srt Dsc C
     C                     Z-ADD*ZERO     WAEAPR           TH CM Yld G/L L
     C                     Z-ADD*ZERO     WAEBPR           TH CM Yld G/L C
     C                     Z-ADD*ZERO     WAECPR           TH CM Crc Val L
     C                     Z-ADD*ZERO     WAEDPR           TH CM Crc Val C
     C                     Z-ADD*ZERO     WAEEPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEFPR           TH CM Lean Prem
     C                     Z-ADD*ZERO     WAEGPR           TH CM Gross Liv
     C                     Z-ADD*ZERO     WAEHPR           TH CM Gross Car
     C                     Z-ADD*ZERO     WAOXNB           TH HPS Movement
     C                     Z-ADD*ZERO     WATHWT           TH DOA Weight
     C                     Z-ADD*ZERO     WAT2WT           TH Avg Lean % E
     C                     Z-ADD*ZERO     WATHHD           TH HPS Farm Sit
     C                     Z-ADD*ZERO     WAT2HD           TH Shift Held O
     C                     Z-ADD*ZERO     WAOBPR           TH Sorting Amou
     C                     Z-ADD*ZERO     WAKOER           TH Head Identif
     C                     Z-ADD*ZERO     WAOPIR           TH Percent Iden
     C                     Z-ADD*ZERO     WAOPEM           TH Percent Acce
     C                     Z-ADD*ZERO     WAIORP           TH Head Adjuste
     C                     Z-ADD*ZERO     WAOWEO           TH PHA Head Add
     C                     Z-ADD*ZERO     WAHHPC           TH PHA Yield Pe
     C                     Z-ADD*ZERO     WAS9PR           TH PHA Lean Prm
     C                     Z-ADD*ZERO     WATAPR           TH VC Gross Val
     C                     Z-ADD*ZERO     WATBPR           TH Excluded Gro
     C                     Z-ADD*ZERO     WAJFUR           TH Avg Lean %
     C                     Z-ADD*ZERO     WAKRIF           TH Broken Back
     C                     Z-ADD*ZERO     WAKORF           TH Hot Scl Uplo
     C                     Z-ADD*ZERO     WAKAPR           TH Unused Nbr 4
     C                     Z-ADD*ZERO     WAKROT           TH Excluded Car
     C                     Z-ADD*ZERO     WAOTJG           TH Excluded Pre
     C                     Z-ADD*ZERO     WAIRJG           TH Unused Nbr 7
     C                     Z-ADD*ZERO     WAIMJF           TH Unused Nbr 8
     C                     Z-ADD*ZERO     WAIRGF           TH Unused Nbr 9
     C                     Z-ADD*ZERO     WAKRJF           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAOJRF           TH Break Even P
     C                     Z-ADD*ZERO     WAKFOR           TH Meat Value F
     C                     Z-ADD*ZERO     WAORJK           TH Yld Parm Adj
     C                     Z-ADD*ZERO     WAOMVJ           TH PHA Sort Dis
     C                     Z-ADD*ZERO     WAMVNF           TH Avg Loin Eye
     C                     Z-ADD*ZERO     WAMCNF           TH Avg Backfat
     C                     Z-ADD*ZERO     WANCNF           TH HITCH Old Pa
     C                     Z-ADD*ZERO     WANCHF           TH MPR Sort Los
     C                     Z-ADD*ZERO     WAIGIR           TH Unused Nbr 1
     C                     Z-ADD*ZERO     WAKFJR           TH Unused Nbr 2
     C                     Z-ADD*ZERO     WAEADT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAEBDT           TH Cold Scl Upl
     C                     Z-ADD*ZERO     WAECDT           TH Head LFT
     C                     Z-ADD*ZERO     WAEDDT           TH Head EUT/KOA
     C                     Z-ADD*ZERO     WAEEDT           TH Unused Date
     C                     Z-ADD*ZERO     WAAADT           RS Date Changed
     C                     Z-ADD*ZERO     WAAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WAABDT           RS Date Added
     C                     Z-ADD*ZERO     WAABTM           RS Time Added
      * Define work field Freight Gl Code Usr
     C                     MOVEL*BLANK    WUDQCD  8
      * Define work field Freight Contra Gl Cde Usr
     C                     MOVEL*BLANK    WUE4CD  8
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBAEPR           DED Fixed Unit
     C                     Z-ADD*ZERO     WBOTNB           DED Ranking
     C                     Z-ADD*ZERO     WBAADT           RS Date Changed
     C                     Z-ADD*ZERO     WBAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WBABDT           RS Date Added
     C                     Z-ADD*ZERO     WBABTM           RS Time Added
      * Define work field TH Carcass Net Amt
     C                     Z-ADD*ZERO     WUATPR  72
      * Define work field TH Total Net WO Adds
     C                     Z-ADD*ZERO     WUA4VA  72
      * Define work field TH Calc Net Sts
     C                     MOVEL*BLANK    WUJWST  1
      * Define work field TH Live Gross Amt
     C                     Z-ADD*ZERO     WUB9PR  72
      * Define work field TH Payment Gross
     C                     Z-ADD*ZERO     WUCBPR  72
      * Define work field Th Payment Net Amt
     C                     Z-ADD*ZERO     WUCCPR  72
      * Define work field TH LIve Net Amt
     C                     Z-ADD*ZERO     WUCAPR  72
      * Define work field TH Accrual Amount
     C                     Z-ADD*ZERO     WUA7VA  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WDBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WDBONB           BOL Load Number
     C                     Z-ADD*ZERO     WDCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WDB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WDLJNB           TDF Head Defect
     C                     Z-ADD*ZERO     WDNXA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WDNYA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WDNZA1           TDF Unused Nbr
     C                     Z-ADD*ZERO     WDAADT           RS Date Changed
     C                     Z-ADD*ZERO     WDAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WDABDT           RS Date Added
     C                     Z-ADD*ZERO     WDABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAEA1           DF Market Perce
     C                     Z-ADD*ZERO     WEUOPR           DF Unused Price
     C                     Z-ADD*ZERO     WEUPPR           DF Unused Price
     C                     Z-ADD*ZERO     WEUQPR           DF Unused Price
     C                     Z-ADD*ZERO     WEAADT           RS Date Changed
     C                     Z-ADD*ZERO     WEAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WEABDT           RS Date Added
     C                     Z-ADD*ZERO     WEABTM           RS Time Added
      * Define work field Zero USR
     C                     Z-ADD*ZERO     WUE9NB  10
      * Define work field Net Head Usr
     C                     Z-ADD*ZERO     WUF6NB  50
      * Define work field Yard dead weight      USR
     C                     Z-ADD*ZERO     WUCCNB  71
      * Define work field Live Weight           USR
     C                     Z-ADD*ZERO     WUOONB  71
      * Define work field Net Live Weight Usr
     C                     Z-ADD*ZERO     WUVBNB  71
      * Define work field Hd Cnt Org Ship Usr
     C                     Z-ADD*ZERO     WUEXNB  50
      * Define work field Avg Weight USR
     C                     Z-ADD*ZERO     WUY9NB  51
      * Define work field Doa's Avg Weight Usr
     C                     Z-ADD*ZERO     WUEVNB  71
      * Define work field Ship Wgt Tot Usr
     C                     Z-ADD*ZERO     WUZ4NB  71
      * Define work field Base Mkt Prc Amt Tot USR
     C                     Z-ADD*ZERO     WUCSPR  92
      * Define work field TH Payment Type
     C                     MOVEL*BLANK    WUJ9ST  1
      * Define work field PS Site ID
     C                     MOVEL*BLANK    WUNYCD 10
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WFBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WFBONB           BOL Load Number
     C                     Z-ADD*ZERO     WFCVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WFB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WFI5PR           TH CA Market Pr
     C                     Z-ADD*ZERO     WFJBPR           TH CA Base Mark
     C                     Z-ADD*ZERO     WFI6PR           TH CA Base Mkt
     C                     Z-ADD*ZERO     WFI7PR           TH CA Sort Disc
     C                     Z-ADD*ZERO     WFI8PR           TH CA Yield Gai
     C                     Z-ADD*ZERO     WFI9PR           TH CA Base Carc
     C                     Z-ADD*ZERO     WFJAPR           TH CA Lean Prem
     C                     Z-ADD*ZERO     WFJCPR           TH CA Carcass G
     C                     Z-ADD*ZERO     WFJDPR           TH CA Bse Mkt L
     C                     Z-ADD*ZERO     WFJEPR           TH CA Bse Mkt C
     C                     Z-ADD*ZERO     WFJFPR           TH CA Srt Dsc L
     C                     Z-ADD*ZERO     WFJGPR           TH CA Srt Dsc C
     C                     Z-ADD*ZERO     WFJHPR           TH CA Yld G/L L
     C                     Z-ADD*ZERO     WFJIPR           TH CA Yld G/L C
     C                     Z-ADD*ZERO     WFJJPR           TH CA Crc Val L
     C                     Z-ADD*ZERO     WFJKPR           TH CA Crc Val C
     C                     Z-ADD*ZERO     WFJLPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WFJMPR           TH CA Lean Prm
     C                     Z-ADD*ZERO     WFJNPR           TH CA Gross Liv
     C                     Z-ADD*ZERO     WFJOPR           TH CA Gross Car
     C                     Z-ADD*ZERO     WFLTBF           TH Min LT Backf
     C                     Z-ADD*ZERO     WFHZPC           TH Min LT LoinE
     C                     Z-ADD*ZERO     WFLTHW           TH Min LT Hot W
     C                     Z-ADD*ZERO     WFH0PC           TH Min LT Lean
     C                     Z-ADD*ZERO     WFGTBF           TH Max GT Backf
     C                     Z-ADD*ZERO     WFH1PC           TH Max GT LoinE
     C                     Z-ADD*ZERO     WFGTHW           TH Max GT Hot W
     C                     Z-ADD*ZERO     WFH2PC           TH Max GT Lean
     C                     Z-ADD*ZERO     WFHLBF           TH Head LT Back
     C                     Z-ADD*ZERO     WFHLLE           TH Head LT Loin
     C                     Z-ADD*ZERO     WFHLHW           TH Head LT Hot
     C                     Z-ADD*ZERO     WFHLLP           TH Head LT Lean
     C                     Z-ADD*ZERO     WFHGBF           TH Head GT Back
     C                     Z-ADD*ZERO     WFHGLE           TH Head GT Loin
     C                     Z-ADD*ZERO     WFHGHW           TH Head GT Hot
     C                     Z-ADD*ZERO     WFHFLP           TH Head GT Lean
     C                     Z-ADD*ZERO     WFSNA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WFSOA1           TE UnUsed Numbe
     C                     Z-ADD*ZERO     WFSPA1           TE Unused Numbe
     C                     Z-ADD*ZERO     WFAADT           RS Date Changed
     C                     Z-ADD*ZERO     WFAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WFABDT           RS Date Added
     C                     Z-ADD*ZERO     WFABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGLKA1           PSM Company Num
     C                     Z-ADD*ZERO     WGLLA1           PSM Miles to Co
     C                     Z-ADD*ZERO     WGAADT           RS Date Changed
     C                     Z-ADD*ZERO     WGAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WGABDT           RS Date Added
     C                     Z-ADD*ZERO     WGABTM           RS Time Added
      * Define work field Trans Extended Amt Usr
     C                     Z-ADD*ZERO     WUCFPR  72
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WIHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WIBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WIBONB           BOL Load Number
     C                     Z-ADD*ZERO     WICVNB           TH Tattoo Numbe
     C                     Z-ADD*ZERO     WIB0DT           TH Kill Date
     C                     Z-ADD*ZERO     WIAZVA           THD Unit Amt
     C                     Z-ADD*ZERO     WIA0VA           THD Ded/Add Amo
     C                     Z-ADD*ZERO     WIAQNB           THD Re-imbursem
     C                     Z-ADD*ZERO     WIAADT           RS Date Changed
     C                     Z-ADD*ZERO     WIAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WIABDT           RS Date Added
     C                     Z-ADD*ZERO     WIABTM           RS Time Added
      * Obtain default message file
     C           *NAMVAR   DEFN PKMGFLA   ZADFMF 10
     C                     IN   ZADFMF
      * Define work field THD Expense Type
     C                     MOVEL*BLANK    WUPFST  1
      * Define work field BOL Freight Exp Paid By
     C                     MOVEL*BLANK    WUO8ST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WJHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WJBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WJBONB           BOL Load Number
     C                     Z-ADD*ZERO     WJCQDT           BOL Kill Date
     C                     Z-ADD*ZERO     WJABTH           BOL Pln Delv St
     C                     Z-ADD*ZERO     WJACTH           BOL Pln Delv En
     C                     Z-ADD*ZERO     WJBPNB           BOL Pln Head De
     C                     Z-ADD*ZERO     WJCSNB           BOL Shipped Wgt
     C                     Z-ADD*ZERO     WJAUDT           BOL Pln Delv Da
     C                     Z-ADD*ZERO     WJAGPR           BOL Freight Uni
     C                     Z-ADD*ZERO     WJATVA           BOL Freight Amt
     C                     Z-ADD*ZERO     WJDHNB           BOL Head Receiv
     C                     Z-ADD*ZERO     WJDINB           BOL Live Wgt Re
     C                     Z-ADD*ZERO     WJGINB           BOL Trucker Che
     C                     Z-ADD*ZERO     WJBZDT           BOL Trucker Che
     C                     Z-ADD*ZERO     WJLSNB           BOL AP Voucher
     C                     Z-ADD*ZERO     WJLDSH           BOL Shipped Hea
     C                     Z-ADD*ZERO     WJJKRU           BOL HPS Movemen
     C                     Z-ADD*ZERO     WJKEOR           BOL Head LFT
     C                     Z-ADD*ZERO     WJIOEW           BOL Head EUT/KO
     C                     Z-ADD*ZERO     WJKJIO           BOL Auth Gate E
     C                     Z-ADD*ZERO     WJIOJR           BOL Head Receiv
     C                     Z-ADD*ZERO     WJEIRR           BOL Unused Wgt
     C                     Z-ADD*ZERO     WJITMF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WJODJE           BOL Unused Wgt
     C                     Z-ADD*ZERO     WJRJIF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WJOEJF           BOL Unused Wgt
     C                     Z-ADD*ZERO     WJD0DT           BOL Auth Gate E
     C                     Z-ADD*ZERO     WJD1DT           BOL Unused Date
     C                     Z-ADD*ZERO     WJD2DT           BOL Unused Date
     C                     Z-ADD*ZERO     WJD3DT           BOL Unused Date
     C                     Z-ADD*ZERO     WJD4DT           BOL Unused Date
     C                     Z-ADD*ZERO     WJAADT           RS Date Changed
     C                     Z-ADD*ZERO     WJAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WJABDT           RS Date Added
     C                     Z-ADD*ZERO     WJABTM           RS Time Added
      * Define work field THD Expense Paid by
     C                     MOVEL*BLANK    WUPEST  1
      * Define work field THD Unit Amt Sign
     C                     MOVEL*BLANK    WUJBST  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKZCA1           PSDP Company Nu
     C                     Z-ADD*ZERO     WKA1VA           PSD Variable Am
     C                     Z-ADD*ZERO     WKC0DT           PSD Accept Date
     C                     Z-ADD*ZERO     WKC1DT           PSD Decline Dat
     C                     Z-ADD*ZERO     WKAADT           RS Date Changed
     C                     Z-ADD*ZERO     WKAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WKABDT           RS Date Added
     C                     Z-ADD*ZERO     WKABTM           RS Time Added
      * Define work field Process Flag User
     C                     MOVEL*BLANK    WUYUST  1
      * Define work field THP Process Code
     C                     MOVEL*BLANK    WUCSCD  6
      * Define work field Record was selected usr
     C                     MOVEL*BLANK    WUMXST  1
      * Define work field BOH Buy Order Type
     C                     MOVEL*BLANK    WUA5ST  1
      * Define work field PC Contract Code
     C                     MOVEL*BLANK    WUAKCD  5
      * Define work field PSC Sub-Contract Code
     C                     MOVEL*BLANK    WUALCD  5
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WMHMNB           BOH Company Num
     C                     Z-ADD*ZERO     WMBNNB           BOH Buy Order N
     C                     Z-ADD*ZERO     WMARDT           BOH Buy Order D
     C                     Z-ADD*ZERO     WMASDT           BOH Kill Date
     C                     Z-ADD*ZERO     WMAAPR           BOH Market Add/
     C                     Z-ADD*ZERO     WMALPR           BOH Quoted Base
     C                     Z-ADD*ZERO     WMD5DT           BOH MPR Reporti
     C                     Z-ADD*ZERO     WMD6DT           BOH Hedge Date
     C                     Z-ADD*ZERO     WMD7DT           BOH Unused Date
     C                     Z-ADD*ZERO     WMD8DT           BOH Unused Date
     C                     Z-ADD*ZERO     WMD9DT           BOH Unused Date
     C                     Z-ADD*ZERO     WMJOEJ           BOH Hedge Head
     C                     Z-ADD*ZERO     WMKOFF           BOH Hedge Refer
     C                     Z-ADD*ZERO     WMKWPE           BOH Hedge Time
     C                     Z-ADD*ZERO     WMIMBF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMOPTR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMOEJD           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMIRMF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMJIRM           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMJRKF           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMKFIR           BOH Unused Nbr
     C                     Z-ADD*ZERO     WMHXNB           PPWS Company Nu
     C                     Z-ADD*ZERO     WMGANB           CW Year
     C                     Z-ADD*ZERO     WMGBNB           CW Week Number
     C                     Z-ADD*ZERO     WMAADT           RS Date Changed
     C                     Z-ADD*ZERO     WMAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WMABDT           RS Date Added
     C                     Z-ADD*ZERO     WMABTM           RS Time Added
      * Define work field THD Commission Deduction
     C                     MOVEL*BLANK    WUPIST  1
      * Define work field THD Deferred Payment
     C                     MOVEL*BLANK    WUPJST  1
      * Define work field Blank USR
     C                     MOVEL*BLANK    WUCRTX 80
      * Define work field Re-imbursement head totl
     C                     Z-ADD*ZERO     WUDDNB  50
      * Define work field Re-imbursement hd NEW USR
     C                     Z-ADD*ZERO     WUDENB  50
      * Define work field Re-imbursement Price  USR
     C                     Z-ADD*ZERO     WULLPR  72
      * Define work field Re-imbursement Wgt    USR
     C                     Z-ADD*ZERO     WUDWNB  50
      * Define work field Re-imbursement full   USR
     C                     Z-ADD*ZERO     WUDFNB  50
      * Define work field Re-imbursement half   USR
     C                     Z-ADD*ZERO     WUDGNB  50
      * Define work field Trans Unit Amt Usr
     C                     Z-ADD*ZERO     WUCEPR  72
      * Define work field THD Re-imbursement Head
     C                     Z-ADD*ZERO     WUAQNB  50
      * Define work field PSC Break Even Percent
     C                     Z-ADD*ZERO     WUA7PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WTAHDT           PSC Date
     C                     Z-ADD*ZERO     WTAZPR           PSC Floor Price
     C                     Z-ADD*ZERO     WTA0PR           PSC Ceiling Pri
     C                     Z-ADD*ZERO     WTA9PC           PSC Market Perc
     C                     Z-ADD*ZERO     WTA7PR           PSC Break Even
     C                     Z-ADD*ZERO     WTA8PR           PSC FLoor Price
     C                     Z-ADD*ZERO     WTA9PR           PSC Mkt Percent
     C                     Z-ADD*ZERO     WTF6PR           PSC Mkt + or -
     C                     Z-ADD*ZERO     WTAADT           RS Date Changed
     C                     Z-ADD*ZERO     WTAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WTABDT           RS Date Added
     C                     Z-ADD*ZERO     WTABTM           RS Time Added
      * Define work field Deferred Price Usr
     C                     Z-ADD*ZERO     WUU5PR  52
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVDJDT           PFP Week Ending
     C                     Z-ADD*ZERO     WVOCPR           PFP Base Floor
     C                     Z-ADD*ZERO     WVODPR           PFP Adjusted Fl
     C                     Z-ADD*ZERO     WVOEPR           PFP Week Avg Fl
     C                     Z-ADD*ZERO     WVOFPR           PFP Unused Pric
     C                     Z-ADD*ZERO     WVOGPR           PFP Unused Pric
     C                     Z-ADD*ZERO     WVOHPR           PFP Unused Pric
     C                     Z-ADD*ZERO     WVOIPR           PFP Unused Pric
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WWEJVA           PAH Account Bal
     C                     Z-ADD*ZERO     WWDLDT           PAH Activation
     C                     Z-ADD*ZERO     WWAADT           RS Date Changed
     C                     Z-ADD*ZERO     WWAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WWABDT           RS Date Added
     C                     Z-ADD*ZERO     WWABTM           RS Time Added
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WXZDA1           PSDL Company Nu
     C                     Z-ADD*ZERO     WXA1VA           PSD Variable Am
     C                     Z-ADD*ZERO     WXC0DT           PSD Accept Date
     C                     Z-ADD*ZERO     WXC1DT           PSD Decline Dat
     C                     Z-ADD*ZERO     WXAADT           RS Date Changed
     C                     Z-ADD*ZERO     WXAMTM           RS Time Changed
     C                     Z-ADD*ZERO     WXABDT           RS Date Added
     C                     Z-ADD*ZERO     WXABTM           RS Time Added
      * Define work field TH Deduction Amt
     C                     Z-ADD*ZERO     WUASPR  72
      * Define work field TH Additions Amt
     C                     Z-ADD*ZERO     WUA5VA  72
      * Define work field Freight Tot Ded/Add Exp
     C                     Z-ADD*ZERO     WUMCPR  72
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WA01 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB02 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WA00 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WB01 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WB03 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WA02 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA03 152       *Synon (15,2) w
     C                     Z-ADD*ZEROS    W0WA   152       *Synon (15,2) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local work field TH Live Purchase UOM
     C                     MOVEL*BLANK    YL0001  2
      * Define local work field TH Live Purchase Price
     C                     Z-ADD*ZERO     YL0002  52
      * Define local work field Count USR
     C                     Z-ADD*ZERO     YL0003  30
      * Define local work field OMS Market Price Amt Usr
     C                     Z-ADD*ZERO     YL0004 114
      * Define local work field Pricing Date USR
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field OMS Error Return Usr
     C                     MOVEL*BLANK    YL0006  5
      * Define local work field Zero USR
     C                     Z-ADD*ZERO     YL0007  10
      * Define local work field System Value Numeric  USR
     C                     Z-ADD*ZERO     YL0008 155
      * Define local work field Percent Decimal       USR
     C                     Z-ADD*ZERO     YL0009  74
      * Define null work field PD Producer Code
     C                     MOVEL*BLANK    YN0001  6
      * Define local work field PSM Miles to Company
     C                     Z-ADD*ZERO     YL0010  50
      * Define local work field Kill Date Usr
     C                     Z-ADD*ZERO     YL0011  70
      * Define local work field Held Over Days USR
     C                     Z-ADD*ZERO     YL0012  50
      * Define local work field Trans Extended Amt Usr
     C                     Z-ADD*ZERO     YL0013  72
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 CUTOUT
