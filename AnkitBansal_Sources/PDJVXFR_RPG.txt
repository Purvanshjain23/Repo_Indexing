     H/TITLE UPD Rated Frt Post Shp XF Execute external functio
     H            Y
     Z* CRTRPGPGM
     Z* CVTOPT(*DATETIME)
      *
     H* SYNOPSIS :
     H*  Perform user function
     H*  As defined by action diagram
      *
     H* Generated by CA 2E release 8.6 (1547)
     H* Function type : Execute external function
      *
     H* Company       : OMS Development Model
     H* System        : OMS Development Model
     H* User name     : ISDNGUY
     H* Date          : 07/30/19  Time  : 12:50:44
     H* Copyright     : OMS Development Model
      *
      *================================================================
     M* Maintenance   :
      *================================================================
     FOMFJCPL0IF  E           K        DISK
      * RTV : Load Header               Retrieval index
      *
     FOMFLCPL4IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop(Desc)/Order
      *
     FOPBFCPL1IF  E           K        DISK
      * RTV : Order Header TRG          Retrieval index       NV
      *
     FPDJEREL2IF  E           K        DISK
      * RTV : Sales Route               Active Records
      *
     FCAAPREL2IF  E           K        DISK
      * RTV : Salesperson               Retrieval index       V
      *
     FCAADREL1IF  E           K        DISK
      * RTV : Warehouse                 Retrieval index       NV
      *
     FPMABREL2IF  E           K        DISK
      * RSQ : Carrier Freight Charge    Carr/cfc chrg/Dt(D)/Line
      *
     FPDLECPL1IF  E           K        DISK
      * RTV : Carrier Destination Rate  Retrieval index
      *
     FOPBFCPL8IF  E           K        DISK
      * RSQ : Order Header TRG          Load #/All orders
      *
     FOMFLCPL8IF  E           K        DISK
      * RSQ : Load Detail               Co/Order
      *
     FOMCQWKL1IF  E           K        DISK
      * RTV : Order Header Fin          Retrieval index
      *
     FOMFLCPL2IF  E           K        DISK
      * RSQ : Load Detail               Load/Stop/Order
      *
     FOMFLCPL1IF  E           K        DISK
      * RTV : Load Detail               Retrieval index
      *
     FOPBFCPLJIF  E           K        DISK
      * RSQ : Order Header TRG          Load(Desc) not bl
      *
     FOPBGWKL1IF  E           K        DISK
      * RTV : Order Detail              Retrieval index
      *
     FOMFJCPL1UF  E           K        DISK
      * UPD : Load Header               Update index
      *
     FOMFLCPL0UF  E           K        DISK
      * UPD : Load Detail               Update index
      *
     FOPBFCPL0UF  E           K        DISK
      * UPD : Order Header TRG          Update index
      *
     FOPBGWKL0UF  E           K        DISK
      * UPD : Order Detail              Update index
      *
     E                    AR1        30  1               ARRAY 1
     E                    AR2        30  1               ARRAY 2
      * Long constants
     E                    @CN#    1  01  6   @CN    25
     I@FJCPBN
      * Load Header               Retrieval index
      * Renamed input format fields
     I              FJRMNB                          WARMNB
     I              FJAIC3                          WAAIC3
     I              FJAODT                          WAAODT
     I              FJPJST                          WAPJST
     I              FJPKST                          WAPKST
     I              FJRNNB                          WARNNB
     I              FJDMTX                          WADMTX
     I              FJDNTX                          WADNTX
     I              FJDOTX                          WADOTX
     I              FJWTTX                          WAWTTX
     I              FJWUTX                          WAWUTX
     I              FJRPNB                          WARPNB
     I              FJFLAM                          WAFLAM
     I              FJXQST                          WAXQST
     I              FJRRNB                          WARRNB
     I              FJDXTX                          WADXTX
     I              FJDYTX                          WADYTX
     I              FJSBNB                          WASBNB
     I              FJBZNA                          WABZNA
     I              FJRONB                          WARONB
     I              FJSQNB                          WASQNB
     I              FJR1NB                          WAR1NB
     I              FJVCST                          WAVCST
     I              FJVDST                          WAVDST
     I              FJSDNB                          WASDNB
     I              FJPAOU                          WAPAOU
     I              FJDGWG                          WADGWG
     I              FJSXNB                          WASXNB
     I              FJHADT                          WAHADT
     I              FJAART                          WAAART
     I              FJDHWG                          WADHWG
     I              FJDIWG                          WADIWG
     I              FJAQDT                          WAAQDT
     I              FJS6NB                          WAS6NB
     I              FJT4NB                          WAT4NB
     I              FJPRTM                          WAPRTM
     I              FJNPSV                          WANPSV
     I              FJJ8TX                          WAJ8TX
     I              FJTLMI                          WATLMI
     I              FJJ9TX                          WAJ9TX
     I              FJQ2CD                          WAQ2CD
     I              FJVPCD                          WAVPCD
     I              FJDBCD                          WADBCD
     I              FJGRWE                          WAGRWE
     I              FJXCCD                          WAXCCD
     I              FJU2ST                          WAU2ST
     I              FJF9DT                          WAF9DT
     I              FJONTM                          WAONTM
     I              FJJ4DT                          WAJ4DT
     I              FJTRTM                          WATRTM
     I              FJJ5DT                          WAJ5DT
     I              FJSPTM                          WASPTM
     I              FJJ6DT                          WAJ6DT
     I              FJLFTM                          WALFTM
     I              FJJ7DT                          WAJ7DT
     I              FJBOTM                          WABOTM
     I              FJJ8DT                          WAJ8DT
     I              FJBLTM                          WABLTM
     I              FJKIDT                          WAKIDT
     I              FJASTM                          WAASTM
     I              FJKADT                          WAKADT
     I              FJAJCM                          WAAJCM
     I              FJXACD                          WAXACD
     I              FJOANA                          WAOANA
     I              FJK4TX                          WAK4TX
     I              FJVOAG                          WAVOAG
     I              FJKBDT                          WAKBDT
     I              FJNBBO                          WANBBO
     I              FJW4CD                          WAW4CD
     I              FJEFDT                          WAEFDT
     I              FJCNTN                          WACNTN
     I              FJKCDT                          WAKCDT
     I              FJTMIN                          WATMIN
     I              FJKDDT                          WAKDDT
     I              FJVMNB                          WAVMNB
     I              FJOCFR                          WAOCFR
     I              FJKJDT                          WAKJDT
     I              FJATTM                          WAATTM
     I              FJOTRS                          WAOTRS
     I              FJRNST                          WARNST
     I              FJBRBK                          WABRBK
     I              FJEIDT                          WAEIDT
     I              FJRMST                          WARMST
     I              FJAJCD                          WAAJCD
     I              FJKKDT                          WAKKDT
     I              FJAVTM                          WAAVTM
     I              FJKZDT                          WAKZDT
     I              FJAXTM                          WAAXTM
     I              FJLHOS                          WALHOS
     I              FJLHOR                          WALHOR
     I              FJWNTX                          WAWNTX
     I              FJOITX                          WAOITX
     I              FJOJTX                          WAOJTX
     I              FJLLDT                          WALLDT
     I              FJLSHG                          WALSHG
     I              FJYPST                          WAYPST
     I              FJK0DT                          WAK0DT
     I              FJAYTM                          WAAYTM
     I              FJKNNX                          WAKNNX
     I              FJICWG                          WAICWG
     I              FJIDWG                          WAIDWG
     I              FJH9SX                          WAH9SX
     I              FJWOTX                          WAWOTX
     I              FJK1DT                          WAK1DT
     I              FJAZTM                          WAAZTM
     I              FJK2DT                          WAK2DT
     I              FJA0TM                          WAA0TM
     I              FJROST                          WAROST
     I              FJRPST                          WARPST
     I              FJRQST                          WARQST
     I              FJRRST                          WARRST
     I              FJZBVA                          WAZBVA
     I              FJWPTX                          WAWPTX
     I              FJWQTX                          WAWQTX
     I              FJWRTX                          WAWRTX
     I              FJWSTX                          WAWSTX
     I              FJRVSX                          WARVSX
     I              FJRUSX                          WARUSX
     I              FJRWSX                          WARWSX
     I              FJRXSX                          WARXSX
     I              FJRYSX                          WARYSX
     I              FJRZSX                          WARZSX
     I              FJR0SX                          WAR0SX
     I              FJR1SX                          WAR1SX
     I              FJR2SX                          WAR2SX
     I              FJR3SX                          WAR3SX
     I              FJR4SX                          WAR4SX
     I              FJPYDT                          WAPYDT
     I              FJCKTM                          WACKTM
     I              FJPZDT                          WAPZDT
     I              FJCLTM                          WACLTM
     I              FJP0DT                          WAP0DT
     I              FJCMTM                          WACMTM
     I              FJP1DT                          WAP1DT
     I              FJCNTM                          WACNTM
     I              FJP2DT                          WAP2DT
     I              FJCOTM                          WACOTM
     I              FJP3DT                          WAP3DT
     I              FJCQTM                          WACQTM
     I              FJUVST                          WAUVST
     I              FJUWST                          WAUWST
     I              FJUXST                          WAUXST
     I              FJAATM                          WAAATM
     I              FJAYNA                          WAAYNA
     I              FJA0NA                          WAA0NA
     I              FJAXDT                          WAAXDT
      *
     I@FLCPE8
      * Load Detail               Load/Stop(Desc)/Order
      * Renamed input format fields
     I              FLRMNB                          WBRMNB
     I              FLRUNB                          WBRUNB
     I              FLRVNB                          WBRVNB
     I              FLDQTX                          WBDQTX
     I              FLRWNB                          WBRWNB
     I              FLRXNB                          WBRXNB
     I              FLSQNB                          WBSQNB
     I              FLT0NB                          WBT0NB
     I              FLT1NB                          WBT1NB
     I              FLR1NB                          WBR1NB
     I              FLAIC3                          WBAIC3
     I              FLC4NB                          WBC4NB
     I              FLVCST                          WBVCST
     I              FLKEDT                          WBKEDT
     I              FLSXNB                          WBSXNB
     I              FLKFDT                          WBKFDT
     I              FLACTM                          WBACTM
     I              FLK5TX                          WBK5TX
     I              FLW5CD                          WBW5CD
     I              FLEJDT                          WBEJDT
     I              FLAGTM                          WBAGTM
     I              FLKJDT                          WBKJDT
     I              FLATTM                          WBATTM
     I              FLHDDT                          WBHDDT
     I              FLAUTM                          WBAUTM
     I              FLKKDT                          WBKKDT
     I              FLAVTM                          WBAVTM
     I              FLZ4NB                          WBZ4NB
     I              FLY7ST                          WBY7ST
     I              FLY2ST                          WBY2ST
     I              FLWHTX                          WBWHTX
     I              FLWITX                          WBWITX
     I              FLWJTX                          WBWJTX
     I              FLWKTX                          WBWKTX
     I              FLWLTX                          WBWLTX
     I              FLN7DT                          WBN7DT
     I              FLN8DT                          WBN8DT
     I              FLN9DT                          WBN9DT
     I              FLB3TM                          WBB3TM
     I              FLB4TM                          WBB4TM
     I              FLB5TM                          WBB5TM
     I              FLIASX                          WBIASX
     I              FLIBSX                          WBIBSX
     I              FLICSX                          WBICSX
     I              FLWVTX                          WBWVTX
     I              FLWWTX                          WBWWTX
     I              FLWXTX                          WBWXTX
     I              FLUVST                          WBUVST
     I              FLUWST                          WBUWST
     I              FLUXST                          WBUXST
     I              FLAATM                          WBAATM
     I              FLAYNA                          WBAYNA
     I              FLA0NA                          WBA0NA
     I              FLAXDT                          WBAXDT
      *
     I@BECPFK
      * Order Header TRG          Retrieval index       NV
      * Renamed input format fields
     I              BEAIC3                          WCAIC3
     I              BEC4NB                          WCC4NB
     I              BEJNCD                          WCJNCD
     I              BEANC7                          WCANC7
     I              BEBKC7                          WCBKC7
     I              BEBRTX                          WCBRTX
     I              BEHMNA                          WCHMNA
     I              BEHONA                          WCHONA
     I              BEHPNA                          WCHPNA
     I              BEHNNA                          WCHNNA
     I              BEDBCD                          WCDBCD
     I              BECKTX                          WCCKTX
     I              BEB0C7                          WCB0C7
     I              BEAETX                          WCAETX
     I              BEB1NA                          WCB1NA
     I              BEB3NA                          WCB3NA
     I              BEB4NA                          WCB4NA
     I              BEB2NA                          WCB2NA
     I              BEBHCD                          WCBHCD
     I              BEC8TX                          WCC8TX
     I              BEBCNA                          WCBCNA
     I              BEA0DT                          WCA0DT
     I              BEA5DT                          WCA5DT
     I              BEGNDT                          WCGNDT
     I              BEACDT                          WCACDT
     I              BEAQCD                          WCAQCD
     I              BEB6NA                          WCB6NA
     I              BEBYNA                          WCBYNA
     I              BEBZNA                          WCBZNA
     I              BEGTST                          WCGTST
     I              BEGVST                          WCGVST
     I              BEGUST                          WCGUST
     I              BEQFST                          WCQFST
     I              BECQCD                          WCCQCD
     I              BEGJST                          WCGJST
     I              BEGWST                          WCGWST
     I              BEGXST                          WCGXST
     I              BEGYST                          WCGYST
     I              BEAODT                          WCAODT
     I              BEAIVN                          WCAIVN
     I              BECXDT                          WCCXDT
     I              BEJZVA                          WCJZVA
     I              BEA1WG                          WCA1WG
     I              BEXIST                          WCXIST
     I              BEXJST                          WCXJST
     I              BEXKST                          WCXKST
     I              BEEIDT                          WCEIDT
     I              BEAFTM                          WCAFTM
     I              BEE8CD                          WCE8CD
     I              BEE9CD                          WCE9CD
     I              BERMNB                          WCRMNB
     I              BETBNB                          WCTBNB
     I              BER1NB                          WCR1NB
     I              BEPJST                          WCPJST
     I              BEU0ST                          WCU0ST
     I              BEU1ST                          WCU1ST
     I              BEQ2CD                          WCQ2CD
     I              BEU2ST                          WCU2ST
     I              BEVEST                          WCVEST
     I              BEVFST                          WCVFST
     I              BEVGST                          WCVGST
     I              BERPCD                          WCRPCD
     I              BERNNB                          WCRNNB
     I              BEVDST                          WCVDST
     I              BEATIN                          WCATIN
     I              BEU4ST                          WCU4ST
     I              BEU5ST                          WCU5ST
     I              BERSRN                          WCRSRN
     I              BEMHNA                          WCMHNA
     I              BEMINA                          WCMINA
     I              BEWBST                          WCWBST
     I              BER4CD                          WCR4CD
     I              BEBFCD                          WCBFCD
     I              BEQ4CD                          WCQ4CD
     I              BET3NB                          WCT3NB
     I              BESICD                          WCSICD
     I              BECONB                          WCCONB
     I              BECEST                          WCCEST
     I              BEAWDT                          WCAWDT
     I              BEJPCD                          WCJPCD
     I              BEXUST                          WCXUST
     I              BEZ1ST                          WCZ1ST
     I              BEVRVA                          WCVRVA
     I              BEOBST                          WCOBST
     I              BEBCST                          WCBCST
     I              BEBDST                          WCBDST
     I              BEB7VL                          WCB7VL
     I              BEGASX                          WCGASX
     I              BEGBSX                          WCGBSX
     I              BEGCSX                          WCGCSX
     I              BEGDSX                          WCGDSX
     I              BEFNSX                          WCFNSX
     I              BEFOSX                          WCFOSX
     I              BEFPSX                          WCFPSX
     I              BEFQSX                          WCFQSX
     I              BEFRSX                          WCFRSX
     I              BEFSSX                          WCFSSX
     I              BEFTSX                          WCFTSX
     I              BEFUSX                          WCFUSX
     I              BEFVSX                          WCFVSX
     I              BEFWSX                          WCFWSX
     I              BEFXSX                          WCFXSX
     I              BEFYSX                          WCFYSX
     I              BENODT                          WCNODT
     I              BENPDT                          WCNPDT
     I              BENQDT                          WCNQDT
     I              BENRDT                          WCNRDT
     I              BENSDT                          WCNSDT
     I              BEBPTM                          WCBPTM
     I              BEBQTM                          WCBQTM
     I              BEBRTM                          WCBRTM
     I              BEBSTM                          WCBSTM
     I              BEBTTM                          WCBTTM
     I              BEH0NX                          WCH0NX
     I              BEH1NX                          WCH1NX
     I              BEH2NX                          WCH2NX
     I              BEH3NX                          WCH3NX
     I              BEH4NX                          WCH4NX
     I              BEC0C7                          WCC0C7
     I              BEUVST                          WCUVST
     I              BEUWST                          WCUWST
     I              BEUXST                          WCUXST
     I              BEAATM                          WCAATM
     I              BEAYNA                          WCAYNA
     I              BEA0NA                          WCA0NA
     I              BEAXDT                          WCAXDT
      *
     I@JEREWS
      * Sales Route               Active Records
      * Renamed input format fields
     I              JER4CD                          WDR4CD
     I              JEMZNA                          WDMZNA
     I              JEBCCD                          WDBCCD
     I              JEBFCD                          WDBFCD
     I              JEQ4CD                          WDQ4CD
     I              JEWOST                          WDWOST
     I              JER8CD                          WDR8CD
     I              JEUVST                          WDUVST
     I              JEUWST                          WDUWST
     I              JEUXST                          WDUXST
     I              JEVSST                          WDVSST
     I              JEAATM                          WDAATM
     I              JEAYNA                          WDAYNA
     I              JEA0NA                          WDA0NA
     I              JEAXDT                          WDAXDT
      *
     I@APREBU
      * Salesperson               Retrieval index       V
      * Renamed input format fields
     I              APBCCD                          WEBCCD
     I              APALTX                          WEALTX
     I              APACNA                          WEACNA
     I              APADNA                          WEADNA
     I              APAENA                          WEAENA
     I              APAJNA                          WEAJNA
     I              APBGCD                          WEBGCD
     I              APBTTX                          WEBTTX
     I              APBVTX                          WEBVTX
     I              APBWTX                          WEBWTX
     I              APDZTX                          WEDZTX
     I              APD0TX                          WED0TX
     I              APD1TX                          WED1TX
     I              APLVCD                          WELVCD
     I              APKZCD                          WEKZCD
     I              APAIC3                          WEAIC3
     I              APAVNB                          WEAVNB
     I              APDSCD                          WEDSCD
     I              APUVST                          WEUVST
     I              APUWST                          WEUWST
     I              APUXST                          WEUXST
     I              APVSST                          WEVSST
     I              APAATM                          WEAATM
     I              APAYNA                          WEAYNA
     I              APA0NA                          WEA0NA
     I              APAXDT                          WEAXDT
      *
     I@ADREAO
      * Warehouse                 Retrieval index       NV
      * Renamed input format fields
     I              ADAJCD                          WFAJCD
     I              ADF8NA                          WFF8NA
     I              ADACNA                          WFACNA
     I              ADADNA                          WFADNA
     I              ADAENA                          WFAENA
     I              ADAJNA                          WFAJNA
     I              ADBTTX                          WFBTTX
     I              ADAOCD                          WFAOCD
     I              ADBGCD                          WFBGCD
     I              ADVHST                          WFVHST
     I              ADMPNA                          WFMPNA
     I              ADWPST                          WFWPST
     I              ADXUST                          WFXUST
     I              ADT0ST                          WFT0ST
     I              ADT1ST                          WFT1ST
     I              ADDBNB                          WFDBNB
     I              ADT2ST                          WFT2ST
     I              ADT3ST                          WFT3ST
     I              ADT4ST                          WFT4ST
     I              ADT6ST                          WFT6ST
     I              ADBWC3                          WFBWC3
     I              ADBTC3                          WFBTC3
     I              ADBUC3                          WFBUC3
     I              ADBVC3                          WFBVC3
     I              ADFCAA                          WFFCAA
     I              ADRQSX                          WFRQSX
     I              ADRRSX                          WFRRSX
     I              ADRSSX                          WFRSSX
     I              ADRTSX                          WFRTSX
     I              ADT7ST                          WFT7ST
     I              ADT8ST                          WFT8ST
     I              ADRNSX                          WFRNSX
     I              ADROSX                          WFROSX
     I              ADRPSX                          WFRPSX
     I              ADUVST                          WFUVST
     I              ADUWST                          WFUWST
     I              ADUXST                          WFUXST
     I              ADVSST                          WFVSST
     I              ADAATM                          WFAATM
     I              ADAYNA                          WFAYNA
     I              ADA0NA                          WFA0NA
     I              ADAXDT                          WFAXDT
      *
     I@ABREHD
      * Carrier Freight Charge    Carr/cfc chrg/Dt(D)/Line
      * Renamed input format fields
     I              ABBZNA                          WGBZNA
     I              ABG7AA                          WGG7AA
     I              ABFDNY                          WGFDNY
     I              ABFENY                          WGFENY
     I              ABAWTX                          WGAWTX
     I              ABQODT                          WGQODT
     I              ABAXTX                          WGAXTX
     I              ABAZTX                          WGAZTX
     I              ABFFNY                          WGFFNY
     I              ABVSST                          WGVSST
     I              ABMJDT                          WGMJDT
     I              ABBETM                          WGBETM
     I              ABCCVN                          WGCCVN
     I              ABCDVN                          WGCDVN
     I              ABMKDT                          WGMKDT
     I              ABBFTM                          WGBFTM
     I              ABCEVN                          WGCEVN
     I              ABCFVN                          WGCFVN
      *
     I@LECPM7
      * Carrier Destination Rate  Retrieval index
      * Renamed input format fields
     I              LEBZNA                          WHBZNA
     I              LEAJCD                          WHAJCD
     I              LEXECD                          WHXECD
     I              LEBGCD                          WHBGCD
     I              LENMVA                          WHNMVA
     I              LEAVTX                          WHAVTX
     I              LEEPPR                          WHEPPR
     I              LEEQPR                          WHEQPR
     I              LEERPR                          WHERPR
     I              LELUSX                          WHLUSX
     I              LELVSX                          WHLVSX
     I              LEOQDT                          WHOQDT
     I              LEORDT                          WHORDT
     I              LEGXVL                          WHGXVL
     I              LEAATM                          WHAATM
     I              LEAYNA                          WHAYNA
     I              LEA0NA                          WHA0NA
     I              LEAXDT                          WHAXDT
      *
     I@BFCPD9
      * Order Header TRG          Load #/All orders
      * Renamed input format fields
     I              BEAIC3                          WIAIC3
     I              BEC4NB                          WIC4NB
     I              BEJNCD                          WIJNCD
     I              BEANC7                          WIANC7
     I              BEBKC7                          WIBKC7
     I              BEBRTX                          WIBRTX
     I              BEHMNA                          WIHMNA
     I              BEHONA                          WIHONA
     I              BEHPNA                          WIHPNA
     I              BEHNNA                          WIHNNA
     I              BEDBCD                          WIDBCD
     I              BECKTX                          WICKTX
     I              BEB0C7                          WIB0C7
     I              BEAETX                          WIAETX
     I              BEB1NA                          WIB1NA
     I              BEB3NA                          WIB3NA
     I              BEB4NA                          WIB4NA
     I              BEB2NA                          WIB2NA
     I              BEBHCD                          WIBHCD
     I              BEC8TX                          WIC8TX
     I              BEBCNA                          WIBCNA
     I              BEA0DT                          WIA0DT
     I              BEA5DT                          WIA5DT
     I              BEGNDT                          WIGNDT
     I              BEACDT                          WIACDT
     I              BEAQCD                          WIAQCD
     I              BEB6NA                          WIB6NA
     I              BEBYNA                          WIBYNA
     I              BEBZNA                          WIBZNA
     I              BEGTST                          WIGTST
     I              BEGVST                          WIGVST
     I              BEGUST                          WIGUST
     I              BEQFST                          WIQFST
     I              BECQCD                          WICQCD
     I              BEGJST                          WIGJST
     I              BEGWST                          WIGWST
     I              BEGXST                          WIGXST
     I              BEGYST                          WIGYST
     I              BEAODT                          WIAODT
     I              BEAIVN                          WIAIVN
     I              BECXDT                          WICXDT
     I              BEJZVA                          WIJZVA
     I              BEA1WG                          WIA1WG
     I              BEXIST                          WIXIST
     I              BEXJST                          WIXJST
     I              BEXKST                          WIXKST
     I              BEEIDT                          WIEIDT
     I              BEAFTM                          WIAFTM
     I              BEE8CD                          WIE8CD
     I              BEE9CD                          WIE9CD
     I              BERMNB                          WIRMNB
     I              BETBNB                          WITBNB
     I              BER1NB                          WIR1NB
     I              BEPJST                          WIPJST
     I              BEU0ST                          WIU0ST
     I              BEU1ST                          WIU1ST
     I              BEQ2CD                          WIQ2CD
     I              BEU2ST                          WIU2ST
     I              BEVEST                          WIVEST
     I              BEVFST                          WIVFST
     I              BEVGST                          WIVGST
     I              BERPCD                          WIRPCD
     I              BERNNB                          WIRNNB
     I              BEVDST                          WIVDST
     I              BEATIN                          WIATIN
     I              BEU4ST                          WIU4ST
     I              BEU5ST                          WIU5ST
     I              BERSRN                          WIRSRN
     I              BEMHNA                          WIMHNA
     I              BEMINA                          WIMINA
     I              BEWBST                          WIWBST
     I              BER4CD                          WIR4CD
     I              BEBFCD                          WIBFCD
     I              BEQ4CD                          WIQ4CD
     I              BET3NB                          WIT3NB
     I              BESICD                          WISICD
     I              BECONB                          WICONB
     I              BECEST                          WICEST
     I              BEAWDT                          WIAWDT
     I              BEJPCD                          WIJPCD
     I              BEXUST                          WIXUST
     I              BEZ1ST                          WIZ1ST
     I              BEVRVA                          WIVRVA
     I              BEOBST                          WIOBST
     I              BEBCST                          WIBCST
     I              BEBDST                          WIBDST
     I              BEB7VL                          WIB7VL
     I              BEGASX                          WIGASX
     I              BEGBSX                          WIGBSX
     I              BEGCSX                          WIGCSX
     I              BEGDSX                          WIGDSX
     I              BEFNSX                          WIFNSX
     I              BEFOSX                          WIFOSX
     I              BEFPSX                          WIFPSX
     I              BEFQSX                          WIFQSX
     I              BEFRSX                          WIFRSX
     I              BEFSSX                          WIFSSX
     I              BEFTSX                          WIFTSX
     I              BEFUSX                          WIFUSX
     I              BEFVSX                          WIFVSX
     I              BEFWSX                          WIFWSX
     I              BEFXSX                          WIFXSX
     I              BEFYSX                          WIFYSX
     I              BENODT                          WINODT
     I              BENPDT                          WINPDT
     I              BENQDT                          WINQDT
     I              BENRDT                          WINRDT
     I              BENSDT                          WINSDT
     I              BEBPTM                          WIBPTM
     I              BEBQTM                          WIBQTM
     I              BEBRTM                          WIBRTM
     I              BEBSTM                          WIBSTM
     I              BEBTTM                          WIBTTM
     I              BEH0NX                          WIH0NX
     I              BEH1NX                          WIH1NX
     I              BEH2NX                          WIH2NX
     I              BEH3NX                          WIH3NX
     I              BEH4NX                          WIH4NX
     I              BEC0C7                          WIC0C7
     I              BEUVST                          WIUVST
     I              BEUWST                          WIUWST
     I              BEUXST                          WIUXST
     I              BEAATM                          WIAATM
     I              BEAYNA                          WIAYNA
     I              BEA0NA                          WIA0NA
     I              BEAXDT                          WIAXDT
      *
     I@FLCPW9
      * Load Detail               Co/Order
      * Renamed input format fields
     I              FLRMNB                          WJRMNB
     I              FLRUNB                          WJRUNB
     I              FLRVNB                          WJRVNB
     I              FLDQTX                          WJDQTX
     I              FLRWNB                          WJRWNB
     I              FLRXNB                          WJRXNB
     I              FLSQNB                          WJSQNB
     I              FLT0NB                          WJT0NB
     I              FLT1NB                          WJT1NB
     I              FLR1NB                          WJR1NB
     I              FLAIC3                          WJAIC3
     I              FLC4NB                          WJC4NB
     I              FLVCST                          WJVCST
     I              FLKEDT                          WJKEDT
     I              FLSXNB                          WJSXNB
     I              FLKFDT                          WJKFDT
     I              FLACTM                          WJACTM
     I              FLK5TX                          WJK5TX
     I              FLW5CD                          WJW5CD
     I              FLEJDT                          WJEJDT
     I              FLAGTM                          WJAGTM
     I              FLKJDT                          WJKJDT
     I              FLATTM                          WJATTM
     I              FLHDDT                          WJHDDT
     I              FLAUTM                          WJAUTM
     I              FLKKDT                          WJKKDT
     I              FLAVTM                          WJAVTM
     I              FLZ4NB                          WJZ4NB
     I              FLY7ST                          WJY7ST
     I              FLY2ST                          WJY2ST
     I              FLWHTX                          WJWHTX
     I              FLWITX                          WJWITX
     I              FLWJTX                          WJWJTX
     I              FLWKTX                          WJWKTX
     I              FLWLTX                          WJWLTX
     I              FLN7DT                          WJN7DT
     I              FLN8DT                          WJN8DT
     I              FLN9DT                          WJN9DT
     I              FLB3TM                          WJB3TM
     I              FLB4TM                          WJB4TM
     I              FLB5TM                          WJB5TM
     I              FLIASX                          WJIASX
     I              FLIBSX                          WJIBSX
     I              FLICSX                          WJICSX
     I              FLWVTX                          WJWVTX
     I              FLWWTX                          WJWWTX
     I              FLWXTX                          WJWXTX
     I              FLUVST                          WJUVST
     I              FLUWST                          WJUWST
     I              FLUXST                          WJUXST
     I              FLAATM                          WJAATM
     I              FLAYNA                          WJAYNA
     I              FLA0NA                          WJA0NA
     I              FLAXDT                          WJAXDT
      *
     I@CQWKL1
      * Order Header Fin          Retrieval index
      * Renamed input format fields
     I              N2AIC3                          WKAIC3
     I              N2C4NB                          WKC4NB
     I              N2DXNB                          WKDXNB
     I              N2G4ST                          WKG4ST
     I              N2BSVA                          WKBSVA
     I              N2G5NA                          WKG5NA
     I              N2DQCD                          WKDQCD
     I              N2DRCD                          WKDRCD
     I              N2AVNB                          WKAVNB
     I              N2DSCD                          WKDSCD
     I              N2GFST                          WKGFST
     I              N2SANB                          WKSANB
     I              N2OJCD                          WKOJCD
     I              N2CKNB                          WKCKNB
     I              N2BMST                          WKBMST
     I              N2UVST                          WKUVST
     I              N2UWST                          WKUWST
     I              N2UXST                          WKUXST
     I              N2AATM                          WKAATM
     I              N2AYNA                          WKAYNA
     I              N2A0NA                          WKA0NA
     I              N2AXDT                          WKAXDT
      *
     I@FJCPBO
      * Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WLRMNB
     I              FJAIC3                          WLAIC3
     I              FJAODT                          WLAODT
     I              FJPJST                          WLPJST
     I              FJPKST                          WLPKST
     I              FJRNNB                          WLRNNB
     I              FJDMTX                          WLDMTX
     I              FJDNTX                          WLDNTX
     I              FJDOTX                          WLDOTX
     I              FJWTTX                          WLWTTX
     I              FJWUTX                          WLWUTX
     I              FJRPNB                          WLRPNB
     I              FJFLAM                          WLFLAM
     I              FJXQST                          WLXQST
     I              FJRRNB                          WLRRNB
     I              FJDXTX                          WLDXTX
     I              FJDYTX                          WLDYTX
     I              FJSBNB                          WLSBNB
     I              FJBZNA                          WLBZNA
     I              FJRONB                          WLRONB
     I              FJSQNB                          WLSQNB
     I              FJR1NB                          WLR1NB
     I              FJVCST                          WLVCST
     I              FJVDST                          WLVDST
     I              FJSDNB                          WLSDNB
     I              FJPAOU                          WLPAOU
     I              FJDGWG                          WLDGWG
     I              FJSXNB                          WLSXNB
     I              FJHADT                          WLHADT
     I              FJAART                          WLAART
     I              FJDHWG                          WLDHWG
     I              FJDIWG                          WLDIWG
     I              FJAQDT                          WLAQDT
     I              FJS6NB                          WLS6NB
     I              FJT4NB                          WLT4NB
     I              FJPRTM                          WLPRTM
     I              FJNPSV                          WLNPSV
     I              FJJ8TX                          WLJ8TX
     I              FJTLMI                          WLTLMI
     I              FJJ9TX                          WLJ9TX
     I              FJQ2CD                          WLQ2CD
     I              FJVPCD                          WLVPCD
     I              FJDBCD                          WLDBCD
     I              FJGRWE                          WLGRWE
     I              FJXCCD                          WLXCCD
     I              FJU2ST                          WLU2ST
     I              FJF9DT                          WLF9DT
     I              FJONTM                          WLONTM
     I              FJJ4DT                          WLJ4DT
     I              FJTRTM                          WLTRTM
     I              FJJ5DT                          WLJ5DT
     I              FJSPTM                          WLSPTM
     I              FJJ6DT                          WLJ6DT
     I              FJLFTM                          WLLFTM
     I              FJJ7DT                          WLJ7DT
     I              FJBOTM                          WLBOTM
     I              FJJ8DT                          WLJ8DT
     I              FJBLTM                          WLBLTM
     I              FJKIDT                          WLKIDT
     I              FJASTM                          WLASTM
     I              FJKADT                          WLKADT
     I              FJAJCM                          WLAJCM
     I              FJXACD                          WLXACD
     I              FJOANA                          WLOANA
     I              FJK4TX                          WLK4TX
     I              FJVOAG                          WLVOAG
     I              FJKBDT                          WLKBDT
     I              FJNBBO                          WLNBBO
     I              FJW4CD                          WLW4CD
     I              FJEFDT                          WLEFDT
     I              FJCNTN                          WLCNTN
     I              FJKCDT                          WLKCDT
     I              FJTMIN                          WLTMIN
     I              FJKDDT                          WLKDDT
     I              FJVMNB                          WLVMNB
     I              FJOCFR                          WLOCFR
     I              FJKJDT                          WLKJDT
     I              FJATTM                          WLATTM
     I              FJOTRS                          WLOTRS
     I              FJRNST                          WLRNST
     I              FJBRBK                          WLBRBK
     I              FJEIDT                          WLEIDT
     I              FJRMST                          WLRMST
     I              FJAJCD                          WLAJCD
     I              FJKKDT                          WLKKDT
     I              FJAVTM                          WLAVTM
     I              FJKZDT                          WLKZDT
     I              FJAXTM                          WLAXTM
     I              FJLHOS                          WLLHOS
     I              FJLHOR                          WLLHOR
     I              FJWNTX                          WLWNTX
     I              FJOITX                          WLOITX
     I              FJOJTX                          WLOJTX
     I              FJLLDT                          WLLLDT
     I              FJLSHG                          WLLSHG
     I              FJYPST                          WLYPST
     I              FJK0DT                          WLK0DT
     I              FJAYTM                          WLAYTM
     I              FJKNNX                          WLKNNX
     I              FJICWG                          WLICWG
     I              FJIDWG                          WLIDWG
     I              FJH9SX                          WLH9SX
     I              FJWOTX                          WLWOTX
     I              FJK1DT                          WLK1DT
     I              FJAZTM                          WLAZTM
     I              FJK2DT                          WLK2DT
     I              FJA0TM                          WLA0TM
     I              FJROST                          WLROST
     I              FJRPST                          WLRPST
     I              FJRQST                          WLRQST
     I              FJRRST                          WLRRST
     I              FJZBVA                          WLZBVA
     I              FJWPTX                          WLWPTX
     I              FJWQTX                          WLWQTX
     I              FJWRTX                          WLWRTX
     I              FJWSTX                          WLWSTX
     I              FJRVSX                          WLRVSX
     I              FJRUSX                          WLRUSX
     I              FJRWSX                          WLRWSX
     I              FJRXSX                          WLRXSX
     I              FJRYSX                          WLRYSX
     I              FJRZSX                          WLRZSX
     I              FJR0SX                          WLR0SX
     I              FJR1SX                          WLR1SX
     I              FJR2SX                          WLR2SX
     I              FJR3SX                          WLR3SX
     I              FJR4SX                          WLR4SX
     I              FJPYDT                          WLPYDT
     I              FJCKTM                          WLCKTM
     I              FJPZDT                          WLPZDT
     I              FJCLTM                          WLCLTM
     I              FJP0DT                          WLP0DT
     I              FJCMTM                          WLCMTM
     I              FJP1DT                          WLP1DT
     I              FJCNTM                          WLCNTM
     I              FJP2DT                          WLP2DT
     I              FJCOTM                          WLCOTM
     I              FJP3DT                          WLP3DT
     I              FJCQTM                          WLCQTM
     I              FJUVST                          WLUVST
     I              FJUWST                          WLUWST
     I              FJUXST                          WLUXST
     I              FJAATM                          WLAATM
     I              FJAYNA                          WLAYNA
     I              FJA0NA                          WLA0NA
     I              FJAXDT                          WLAXDT
      *
     I@FLCPEB
      * Load Detail               Load/Stop/Order
      * Renamed input format fields
     I              FLRMNB                          WMRMNB
     I              FLRUNB                          WMRUNB
     I              FLRVNB                          WMRVNB
     I              FLDQTX                          WMDQTX
     I              FLRWNB                          WMRWNB
     I              FLRXNB                          WMRXNB
     I              FLSQNB                          WMSQNB
     I              FLT0NB                          WMT0NB
     I              FLT1NB                          WMT1NB
     I              FLR1NB                          WMR1NB
     I              FLAIC3                          WMAIC3
     I              FLC4NB                          WMC4NB
     I              FLVCST                          WMVCST
     I              FLKEDT                          WMKEDT
     I              FLSXNB                          WMSXNB
     I              FLKFDT                          WMKFDT
     I              FLACTM                          WMACTM
     I              FLK5TX                          WMK5TX
     I              FLW5CD                          WMW5CD
     I              FLEJDT                          WMEJDT
     I              FLAGTM                          WMAGTM
     I              FLKJDT                          WMKJDT
     I              FLATTM                          WMATTM
     I              FLHDDT                          WMHDDT
     I              FLAUTM                          WMAUTM
     I              FLKKDT                          WMKKDT
     I              FLAVTM                          WMAVTM
     I              FLZ4NB                          WMZ4NB
     I              FLY7ST                          WMY7ST
     I              FLY2ST                          WMY2ST
     I              FLWHTX                          WMWHTX
     I              FLWITX                          WMWITX
     I              FLWJTX                          WMWJTX
     I              FLWKTX                          WMWKTX
     I              FLWLTX                          WMWLTX
     I              FLN7DT                          WMN7DT
     I              FLN8DT                          WMN8DT
     I              FLN9DT                          WMN9DT
     I              FLB3TM                          WMB3TM
     I              FLB4TM                          WMB4TM
     I              FLB5TM                          WMB5TM
     I              FLIASX                          WMIASX
     I              FLIBSX                          WMIBSX
     I              FLICSX                          WMICSX
     I              FLWVTX                          WMWVTX
     I              FLWWTX                          WMWWTX
     I              FLWXTX                          WMWXTX
     I              FLUVST                          WMUVST
     I              FLUWST                          WMUWST
     I              FLUXST                          WMUXST
     I              FLAATM                          WMAATM
     I              FLAYNA                          WMAYNA
     I              FLA0NA                          WMA0NA
     I              FLAXDT                          WMAXDT
      *
     I@FLCPBM
      * Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     I@BECPFJ
      * Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     I@FLCPBW
      * Load Detail               Retrieval index
      * Renamed input format fields
     I              FLRMNB                          WSRMNB
     I              FLRUNB                          WSRUNB
     I              FLRVNB                          WSRVNB
     I              FLDQTX                          WSDQTX
     I              FLRWNB                          WSRWNB
     I              FLRXNB                          WSRXNB
     I              FLSQNB                          WSSQNB
     I              FLT0NB                          WST0NB
     I              FLT1NB                          WST1NB
     I              FLR1NB                          WSR1NB
     I              FLAIC3                          WSAIC3
     I              FLC4NB                          WSC4NB
     I              FLVCST                          WSVCST
     I              FLKEDT                          WSKEDT
     I              FLSXNB                          WSSXNB
     I              FLKFDT                          WSKFDT
     I              FLACTM                          WSACTM
     I              FLK5TX                          WSK5TX
     I              FLW5CD                          WSW5CD
     I              FLEJDT                          WSEJDT
     I              FLAGTM                          WSAGTM
     I              FLKJDT                          WSKJDT
     I              FLATTM                          WSATTM
     I              FLHDDT                          WSHDDT
     I              FLAUTM                          WSAUTM
     I              FLKKDT                          WSKKDT
     I              FLAVTM                          WSAVTM
     I              FLZ4NB                          WSZ4NB
     I              FLY7ST                          WSY7ST
     I              FLY2ST                          WSY2ST
     I              FLWHTX                          WSWHTX
     I              FLWITX                          WSWITX
     I              FLWJTX                          WSWJTX
     I              FLWKTX                          WSWKTX
     I              FLWLTX                          WSWLTX
     I              FLN7DT                          WSN7DT
     I              FLN8DT                          WSN8DT
     I              FLN9DT                          WSN9DT
     I              FLB3TM                          WSB3TM
     I              FLB4TM                          WSB4TM
     I              FLB5TM                          WSB5TM
     I              FLIASX                          WSIASX
     I              FLIBSX                          WSIBSX
     I              FLICSX                          WSICSX
     I              FLWVTX                          WSWVTX
     I              FLWWTX                          WSWWTX
     I              FLWXTX                          WSWXTX
     I              FLUVST                          WSUVST
     I              FLUWST                          WSUWST
     I              FLUXST                          WSUXST
     I              FLAATM                          WSAATM
     I              FLAYNA                          WSAYNA
     I              FLA0NA                          WSA0NA
     I              FLAXDT                          WSAXDT
      *
     I@BFCPNQ
      * Order Header TRG          Load(Desc) not bl
      * Renamed input format fields
     I              BEAIC3                          WTAIC3
     I              BEC4NB                          WTC4NB
     I              BEJNCD                          WTJNCD
     I              BEANC7                          WTANC7
     I              BEBKC7                          WTBKC7
     I              BEBRTX                          WTBRTX
     I              BEHMNA                          WTHMNA
     I              BEHONA                          WTHONA
     I              BEHPNA                          WTHPNA
     I              BEHNNA                          WTHNNA
     I              BEDBCD                          WTDBCD
     I              BECKTX                          WTCKTX
     I              BEB0C7                          WTB0C7
     I              BEAETX                          WTAETX
     I              BEB1NA                          WTB1NA
     I              BEB3NA                          WTB3NA
     I              BEB4NA                          WTB4NA
     I              BEB2NA                          WTB2NA
     I              BEBHCD                          WTBHCD
     I              BEC8TX                          WTC8TX
     I              BEBCNA                          WTBCNA
     I              BEA0DT                          WTA0DT
     I              BEA5DT                          WTA5DT
     I              BEGNDT                          WTGNDT
     I              BEACDT                          WTACDT
     I              BEAQCD                          WTAQCD
     I              BEB6NA                          WTB6NA
     I              BEBYNA                          WTBYNA
     I              BEBZNA                          WTBZNA
     I              BEGTST                          WTGTST
     I              BEGVST                          WTGVST
     I              BEGUST                          WTGUST
     I              BEQFST                          WTQFST
     I              BECQCD                          WTCQCD
     I              BEGJST                          WTGJST
     I              BEGWST                          WTGWST
     I              BEGXST                          WTGXST
     I              BEGYST                          WTGYST
     I              BEAODT                          WTAODT
     I              BEAIVN                          WTAIVN
     I              BECXDT                          WTCXDT
     I              BEJZVA                          WTJZVA
     I              BEA1WG                          WTA1WG
     I              BEXIST                          WTXIST
     I              BEXJST                          WTXJST
     I              BEXKST                          WTXKST
     I              BEEIDT                          WTEIDT
     I              BEAFTM                          WTAFTM
     I              BEE8CD                          WTE8CD
     I              BEE9CD                          WTE9CD
     I              BERMNB                          WTRMNB
     I              BETBNB                          WTTBNB
     I              BER1NB                          WTR1NB
     I              BEPJST                          WTPJST
     I              BEU0ST                          WTU0ST
     I              BEU1ST                          WTU1ST
     I              BEQ2CD                          WTQ2CD
     I              BEU2ST                          WTU2ST
     I              BEVEST                          WTVEST
     I              BEVFST                          WTVFST
     I              BEVGST                          WTVGST
     I              BERPCD                          WTRPCD
     I              BERNNB                          WTRNNB
     I              BEVDST                          WTVDST
     I              BEATIN                          WTATIN
     I              BEU4ST                          WTU4ST
     I              BEU5ST                          WTU5ST
     I              BERSRN                          WTRSRN
     I              BEMHNA                          WTMHNA
     I              BEMINA                          WTMINA
     I              BEWBST                          WTWBST
     I              BER4CD                          WTR4CD
     I              BEBFCD                          WTBFCD
     I              BEQ4CD                          WTQ4CD
     I              BET3NB                          WTT3NB
     I              BESICD                          WTSICD
     I              BECONB                          WTCONB
     I              BECEST                          WTCEST
     I              BEAWDT                          WTAWDT
     I              BEJPCD                          WTJPCD
     I              BEXUST                          WTXUST
     I              BEZ1ST                          WTZ1ST
     I              BEVRVA                          WTVRVA
     I              BEOBST                          WTOBST
     I              BEBCST                          WTBCST
     I              BEBDST                          WTBDST
     I              BEB7VL                          WTB7VL
     I              BEGASX                          WTGASX
     I              BEGBSX                          WTGBSX
     I              BEGCSX                          WTGCSX
     I              BEGDSX                          WTGDSX
     I              BEFNSX                          WTFNSX
     I              BEFOSX                          WTFOSX
     I              BEFPSX                          WTFPSX
     I              BEFQSX                          WTFQSX
     I              BEFRSX                          WTFRSX
     I              BEFSSX                          WTFSSX
     I              BEFTSX                          WTFTSX
     I              BEFUSX                          WTFUSX
     I              BEFVSX                          WTFVSX
     I              BEFWSX                          WTFWSX
     I              BEFXSX                          WTFXSX
     I              BEFYSX                          WTFYSX
     I              BENODT                          WTNODT
     I              BENPDT                          WTNPDT
     I              BENQDT                          WTNQDT
     I              BENRDT                          WTNRDT
     I              BENSDT                          WTNSDT
     I              BEBPTM                          WTBPTM
     I              BEBQTM                          WTBQTM
     I              BEBRTM                          WTBRTM
     I              BEBSTM                          WTBSTM
     I              BEBTTM                          WTBTTM
     I              BEH0NX                          WTH0NX
     I              BEH1NX                          WTH1NX
     I              BEH2NX                          WTH2NX
     I              BEH3NX                          WTH3NX
     I              BEH4NX                          WTH4NX
     I              BEC0C7                          WTC0C7
     I              BEUVST                          WTUVST
     I              BEUWST                          WTUWST
     I              BEUXST                          WTUXST
     I              BEAATM                          WTAATM
     I              BEAYNA                          WTAYNA
     I              BEA0NA                          WTA0NA
     I              BEAXDT                          WTAXDT
      *
     I@BGWKL1
      * Order Detail              Retrieval index
      * Renamed input format fields
     I              OMAIC3                          WVAIC3
     I              OMC4NB                          WVC4NB
     I              OMDPNB                          WVDPNB
     I              OMUENB                          WVUENB
     I              OMHGCD                          WVHGCD
     I              OMAJCD                          WVAJCD
     I              OMBKC7                          WVBKC7
     I              OMCFC7                          WVCFC7
     I              OMGMST                          WVGMST
     I              OMGNST                          WVGNST
     I              OMMAVA                          WVMAVA
     I              OMKDVA                          WVKDVA
     I              OML8VA                          WVL8VA
     I              OML9VA                          WVL9VA
     I              OMGTST                          WVGTST
     I              OMGVST                          WVGVST
     I              OMGUST                          WVGUST
     I              OMQFST                          WVQFST
     I              OMAYVA                          WVAYVA
     I              OMEXDT                          WVEXDT
     I              OMLQCD                          WVLQCD
     I              OMRDCD                          WVRDCD
     I              OMQ7CD                          WVQ7CD
     I              OMBZPR                          WVBZPR
     I              OML6NB                          WVL6NB
     I              OMU1ST                          WVU1ST
     I              OMGIDT                          WVGIDT
     I              OMCRCD                          WVCRCD
     I              OMAGCD                          WVAGCD
     I              OMRZST                          WVRZST
     I              OMR0ST                          WVR0ST
     I              OMR1ST                          WVR1ST
     I              OMG7NA                          WVG7NA
     I              OMG8NA                          WVG8NA
     I              OMRPCD                          WVRPCD
     I              OMVEST                          WVVEST
     I              OMVGST                          WVVGST
     I              OMAVST                          WVAVST
     I              OMU0ST                          WVU0ST
     I              OMRFCD                          WVRFCD
     I              OMFZST                          WVFZST
     I              OMR1NB                          WVR1NB
     I              OMAVQT                          WVAVQT
     I              OMD0WG                          WVD0WG
     I              OMCCQT                          WVCCQT
     I              OMAUWG                          WVAUWG
     I              OMCBQT                          WVCBQT
     I              OMATWG                          WVATWG
     I              OMAQCS                          WVAQCS
     I              OMAGCS                          WVAGCS
     I              OMAKPR                          WVAKPR
     I              OMALPR                          WVALPR
     I              OMAUPR                          WVAUPR
     I              OMAVWG                          WVAVWG
     I              OMA4WG                          WVA4WG
     I              OMA5DT                          WVA5DT
     I              OMAODT                          WVAODT
     I              OMGNDT                          WVGNDT
     I              OMAMST                          WVAMST
     I              OMANST                          WVANST
     I              OMVAST                          WVVAST
     I              OMRGNB                          WVRGNB
     I              OMRHNB                          WVRHNB
     I              OMRINB                          WVRINB
     I              OMRBCD                          WVRBCD
     I              OMHICD                          WVHICD
     I              OMRNCD                          WVRNCD
     I              OMROCD                          WVROCD
     I              OMCXDT                          WVCXDT
     I              OMAJVN                          WVAJVN
     I              OMKXCD                          WVKXCD
     I              OMJPCD                          WVJPCD
     I              OMCQCD                          WVCQCD
     I              OMR4CD                          WVR4CD
     I              OMZ1ST                          WVZ1ST
     I              OMZ3ST                          WVZ3ST
     I              OMZ4ST                          WVZ4ST
     I              OMDUPR                          WVDUPR
     I              OMB6VL                          WVB6VL
     I              OMA1AA                          WVA1AA
     I              OMFZSX                          WVFZSX
     I              OMF0SX                          WVF0SX
     I              OMF1SX                          WVF1SX
     I              OMF2SX                          WVF2SX
     I              OMF3SX                          WVF3SX
     I              OMF4SX                          WVF4SX
     I              OMF5SX                          WVF5SX
     I              OMF6SX                          WVF6SX
     I              OMF7SX                          WVF7SX
     I              OMNTDT                          WVNTDT
     I              OMNUDT                          WVNUDT
     I              OMNVDT                          WVNVDT
     I              OMNWDT                          WVNWDT
     I              OMNXDT                          WVNXDT
     I              OMBUTM                          WVBUTM
     I              OMBVTM                          WVBVTM
     I              OMBWTM                          WVBWTM
     I              OMBXTM                          WVBXTM
     I              OMBYTM                          WVBYTM
     I              OMH5NX                          WVH5NX
     I              OMH6NX                          WVH6NX
     I              OMH7NX                          WVH7NX
     I              OMH8NX                          WVH8NX
     I              OMH9NX                          WVH9NX
     I              OMDVPR                          WVDVPR
     I              OMDWPR                          WVDWPR
     I              OMDXPR                          WVDXPR
     I              OMDYPR                          WVDYPR
     I              OMDZPR                          WVDZPR
     I              OMGSPR                          WVGSPR
     I              OMGTPR                          WVGTPR
     I              OMGUPR                          WVGUPR
     I              OMHOST                          WVHOST
     I              OMHPST                          WVHPST
     I              OMIOST                          WVIOST
     I              OMPEWG                          WVPEWG
     I              OMRINY                          WVRINY
     I              OMTIDT                          WVTIDT
     I              OMTJDT                          WVTJDT
     I              OMH2ST                          WVH2ST
     I              OMH0ST                          WVH0ST
     I              OMH1ST                          WVH1ST
     I              OMTKDT                          WVTKDT
     I              OMTLDT                          WVTLDT
     I              OMTMDT                          WVTMDT
     I              OMUVST                          WVUVST
     I              OMUWST                          WVUWST
     I              OMUXST                          WVUXST
     I              OMAATM                          WVAATM
     I              OMAYNA                          WVAYNA
     I              OMA0NA                          WVA0NA
     I              OMAXDT                          WVAXDT
      *
     I@BGWKL0
      * Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WWAIC3
     I              OMC4NB                          WWC4NB
     I              OMDPNB                          WWDPNB
     I              OMUENB                          WWUENB
     I              OMHGCD                          WWHGCD
     I              OMAJCD                          WWAJCD
     I              OMBKC7                          WWBKC7
     I              OMCFC7                          WWCFC7
     I              OMGMST                          WWGMST
     I              OMGNST                          WWGNST
     I              OMMAVA                          WWMAVA
     I              OMKDVA                          WWKDVA
     I              OML8VA                          WWL8VA
     I              OML9VA                          WWL9VA
     I              OMGTST                          WWGTST
     I              OMGVST                          WWGVST
     I              OMGUST                          WWGUST
     I              OMQFST                          WWQFST
     I              OMAYVA                          WWAYVA
     I              OMEXDT                          WWEXDT
     I              OMLQCD                          WWLQCD
     I              OMRDCD                          WWRDCD
     I              OMQ7CD                          WWQ7CD
     I              OMBZPR                          WWBZPR
     I              OML6NB                          WWL6NB
     I              OMU1ST                          WWU1ST
     I              OMGIDT                          WWGIDT
     I              OMCRCD                          WWCRCD
     I              OMAGCD                          WWAGCD
     I              OMRZST                          WWRZST
     I              OMR0ST                          WWR0ST
     I              OMR1ST                          WWR1ST
     I              OMG7NA                          WWG7NA
     I              OMG8NA                          WWG8NA
     I              OMRPCD                          WWRPCD
     I              OMVEST                          WWVEST
     I              OMVGST                          WWVGST
     I              OMAVST                          WWAVST
     I              OMU0ST                          WWU0ST
     I              OMRFCD                          WWRFCD
     I              OMFZST                          WWFZST
     I              OMR1NB                          WWR1NB
     I              OMAVQT                          WWAVQT
     I              OMD0WG                          WWD0WG
     I              OMCCQT                          WWCCQT
     I              OMAUWG                          WWAUWG
     I              OMCBQT                          WWCBQT
     I              OMATWG                          WWATWG
     I              OMAQCS                          WWAQCS
     I              OMAGCS                          WWAGCS
     I              OMAKPR                          WWAKPR
     I              OMALPR                          WWALPR
     I              OMAUPR                          WWAUPR
     I              OMAVWG                          WWAVWG
     I              OMA4WG                          WWA4WG
     I              OMA5DT                          WWA5DT
     I              OMAODT                          WWAODT
     I              OMGNDT                          WWGNDT
     I              OMAMST                          WWAMST
     I              OMANST                          WWANST
     I              OMVAST                          WWVAST
     I              OMRGNB                          WWRGNB
     I              OMRHNB                          WWRHNB
     I              OMRINB                          WWRINB
     I              OMRBCD                          WWRBCD
     I              OMHICD                          WWHICD
     I              OMRNCD                          WWRNCD
     I              OMROCD                          WWROCD
     I              OMCXDT                          WWCXDT
     I              OMAJVN                          WWAJVN
     I              OMKXCD                          WWKXCD
     I              OMJPCD                          WWJPCD
     I              OMCQCD                          WWCQCD
     I              OMR4CD                          WWR4CD
     I              OMZ1ST                          WWZ1ST
     I              OMZ3ST                          WWZ3ST
     I              OMZ4ST                          WWZ4ST
     I              OMDUPR                          WWDUPR
     I              OMB6VL                          WWB6VL
     I              OMA1AA                          WWA1AA
     I              OMFZSX                          WWFZSX
     I              OMF0SX                          WWF0SX
     I              OMF1SX                          WWF1SX
     I              OMF2SX                          WWF2SX
     I              OMF3SX                          WWF3SX
     I              OMF4SX                          WWF4SX
     I              OMF5SX                          WWF5SX
     I              OMF6SX                          WWF6SX
     I              OMF7SX                          WWF7SX
     I              OMNTDT                          WWNTDT
     I              OMNUDT                          WWNUDT
     I              OMNVDT                          WWNVDT
     I              OMNWDT                          WWNWDT
     I              OMNXDT                          WWNXDT
     I              OMBUTM                          WWBUTM
     I              OMBVTM                          WWBVTM
     I              OMBWTM                          WWBWTM
     I              OMBXTM                          WWBXTM
     I              OMBYTM                          WWBYTM
     I              OMH5NX                          WWH5NX
     I              OMH6NX                          WWH6NX
     I              OMH7NX                          WWH7NX
     I              OMH8NX                          WWH8NX
     I              OMH9NX                          WWH9NX
     I              OMDVPR                          WWDVPR
     I              OMDWPR                          WWDWPR
     I              OMDXPR                          WWDXPR
     I              OMDYPR                          WWDYPR
     I              OMDZPR                          WWDZPR
     I              OMGSPR                          WWGSPR
     I              OMGTPR                          WWGTPR
     I              OMGUPR                          WWGUPR
     I              OMHOST                          WWHOST
     I              OMHPST                          WWHPST
     I              OMIOST                          WWIOST
     I              OMPEWG                          WWPEWG
     I              OMRINY                          WWRINY
     I              OMTIDT                          WWTIDT
     I              OMTJDT                          WWTJDT
     I              OMH2ST                          WWH2ST
     I              OMH0ST                          WWH0ST
     I              OMH1ST                          WWH1ST
     I              OMTKDT                          WWTKDT
     I              OMTLDT                          WWTLDT
     I              OMTMDT                          WWTMDT
     I              OMUVST                          WWUVST
     I              OMUWST                          WWUWST
     I              OMUXST                          WWUXST
     I              OMAATM                          WWAATM
     I              OMAYNA                          WWAYNA
     I              OMA0NA                          WWA0NA
     I              OMAXDT                          WWAXDT
      *
      /EJECT
      * Data structures:
     IPGMDS     ESDSY2PGDSP
      * Modified Program data structure
     IJBDTTM      DS
      * Job date/time
     I                                        1   70##JDT
     I                                        1   10##JCC
     I                                        2   30##JYY
     I                                        4   50##JMM
     I                                        6   70##JDD
     I                                        8  130##JTM
     I                                        8   90##JHH
     I                                       10  110##JNN
     I                                       12  130##JSS
     IQOMFJ1    E DSOMFJCPL1
      * UPD : Load Header               Update index
      * Renamed input format fields
     I              FJRMNB                          WLRMNB
     I              FJAIC3                          WLAIC3
     I              FJAODT                          WLAODT
     I              FJPJST                          WLPJST
     I              FJPKST                          WLPKST
     I              FJRNNB                          WLRNNB
     I              FJDMTX                          WLDMTX
     I              FJDNTX                          WLDNTX
     I              FJDOTX                          WLDOTX
     I              FJWTTX                          WLWTTX
     I              FJWUTX                          WLWUTX
     I              FJRPNB                          WLRPNB
     I              FJFLAM                          WLFLAM
     I              FJXQST                          WLXQST
     I              FJRRNB                          WLRRNB
     I              FJDXTX                          WLDXTX
     I              FJDYTX                          WLDYTX
     I              FJSBNB                          WLSBNB
     I              FJBZNA                          WLBZNA
     I              FJRONB                          WLRONB
     I              FJSQNB                          WLSQNB
     I              FJR1NB                          WLR1NB
     I              FJVCST                          WLVCST
     I              FJVDST                          WLVDST
     I              FJSDNB                          WLSDNB
     I              FJPAOU                          WLPAOU
     I              FJDGWG                          WLDGWG
     I              FJSXNB                          WLSXNB
     I              FJHADT                          WLHADT
     I              FJAART                          WLAART
     I              FJDHWG                          WLDHWG
     I              FJDIWG                          WLDIWG
     I              FJAQDT                          WLAQDT
     I              FJS6NB                          WLS6NB
     I              FJT4NB                          WLT4NB
     I              FJPRTM                          WLPRTM
     I              FJNPSV                          WLNPSV
     I              FJJ8TX                          WLJ8TX
     I              FJTLMI                          WLTLMI
     I              FJJ9TX                          WLJ9TX
     I              FJQ2CD                          WLQ2CD
     I              FJVPCD                          WLVPCD
     I              FJDBCD                          WLDBCD
     I              FJGRWE                          WLGRWE
     I              FJXCCD                          WLXCCD
     I              FJU2ST                          WLU2ST
     I              FJF9DT                          WLF9DT
     I              FJONTM                          WLONTM
     I              FJJ4DT                          WLJ4DT
     I              FJTRTM                          WLTRTM
     I              FJJ5DT                          WLJ5DT
     I              FJSPTM                          WLSPTM
     I              FJJ6DT                          WLJ6DT
     I              FJLFTM                          WLLFTM
     I              FJJ7DT                          WLJ7DT
     I              FJBOTM                          WLBOTM
     I              FJJ8DT                          WLJ8DT
     I              FJBLTM                          WLBLTM
     I              FJKIDT                          WLKIDT
     I              FJASTM                          WLASTM
     I              FJKADT                          WLKADT
     I              FJAJCM                          WLAJCM
     I              FJXACD                          WLXACD
     I              FJOANA                          WLOANA
     I              FJK4TX                          WLK4TX
     I              FJVOAG                          WLVOAG
     I              FJKBDT                          WLKBDT
     I              FJNBBO                          WLNBBO
     I              FJW4CD                          WLW4CD
     I              FJEFDT                          WLEFDT
     I              FJCNTN                          WLCNTN
     I              FJKCDT                          WLKCDT
     I              FJTMIN                          WLTMIN
     I              FJKDDT                          WLKDDT
     I              FJVMNB                          WLVMNB
     I              FJOCFR                          WLOCFR
     I              FJKJDT                          WLKJDT
     I              FJATTM                          WLATTM
     I              FJOTRS                          WLOTRS
     I              FJRNST                          WLRNST
     I              FJBRBK                          WLBRBK
     I              FJEIDT                          WLEIDT
     I              FJRMST                          WLRMST
     I              FJAJCD                          WLAJCD
     I              FJKKDT                          WLKKDT
     I              FJAVTM                          WLAVTM
     I              FJKZDT                          WLKZDT
     I              FJAXTM                          WLAXTM
     I              FJLHOS                          WLLHOS
     I              FJLHOR                          WLLHOR
     I              FJWNTX                          WLWNTX
     I              FJOITX                          WLOITX
     I              FJOJTX                          WLOJTX
     I              FJLLDT                          WLLLDT
     I              FJLSHG                          WLLSHG
     I              FJYPST                          WLYPST
     I              FJK0DT                          WLK0DT
     I              FJAYTM                          WLAYTM
     I              FJKNNX                          WLKNNX
     I              FJICWG                          WLICWG
     I              FJIDWG                          WLIDWG
     I              FJH9SX                          WLH9SX
     I              FJWOTX                          WLWOTX
     I              FJK1DT                          WLK1DT
     I              FJAZTM                          WLAZTM
     I              FJK2DT                          WLK2DT
     I              FJA0TM                          WLA0TM
     I              FJROST                          WLROST
     I              FJRPST                          WLRPST
     I              FJRQST                          WLRQST
     I              FJRRST                          WLRRST
     I              FJZBVA                          WLZBVA
     I              FJWPTX                          WLWPTX
     I              FJWQTX                          WLWQTX
     I              FJWRTX                          WLWRTX
     I              FJWSTX                          WLWSTX
     I              FJRVSX                          WLRVSX
     I              FJRUSX                          WLRUSX
     I              FJRWSX                          WLRWSX
     I              FJRXSX                          WLRXSX
     I              FJRYSX                          WLRYSX
     I              FJRZSX                          WLRZSX
     I              FJR0SX                          WLR0SX
     I              FJR1SX                          WLR1SX
     I              FJR2SX                          WLR2SX
     I              FJR3SX                          WLR3SX
     I              FJR4SX                          WLR4SX
     I              FJPYDT                          WLPYDT
     I              FJCKTM                          WLCKTM
     I              FJPZDT                          WLPZDT
     I              FJCLTM                          WLCLTM
     I              FJP0DT                          WLP0DT
     I              FJCMTM                          WLCMTM
     I              FJP1DT                          WLP1DT
     I              FJCNTM                          WLCNTM
     I              FJP2DT                          WLP2DT
     I              FJCOTM                          WLCOTM
     I              FJP3DT                          WLP3DT
     I              FJCQTM                          WLCQTM
     I              FJUVST                          WLUVST
     I              FJUWST                          WLUWST
     I              FJUXST                          WLUXST
     I              FJAATM                          WLAATM
     I              FJAYNA                          WLAYNA
     I              FJA0NA                          WLA0NA
     I              FJAXDT                          WLAXDT
      *
     IYARDCS      DS                            793
      * Message data for message Y2U0009.
     IMD0009      DS
     I                                        1  10 MDPGM
     I                                       11  20 MDACP
     I                                       21  30 MDFMT
     I                                       31  34 MDACT
     I                                       35  40 MDLBL
     IQOMFL1    E DSOMFLCPL0
      * UPD : Load Detail               Update index
      * Renamed input format fields
     I              FLRMNB                          WORMNB
     I              FLRUNB                          WORUNB
     I              FLRVNB                          WORVNB
     I              FLDQTX                          WODQTX
     I              FLRWNB                          WORWNB
     I              FLRXNB                          WORXNB
     I              FLSQNB                          WOSQNB
     I              FLT0NB                          WOT0NB
     I              FLT1NB                          WOT1NB
     I              FLR1NB                          WOR1NB
     I              FLAIC3                          WOAIC3
     I              FLC4NB                          WOC4NB
     I              FLVCST                          WOVCST
     I              FLKEDT                          WOKEDT
     I              FLSXNB                          WOSXNB
     I              FLKFDT                          WOKFDT
     I              FLACTM                          WOACTM
     I              FLK5TX                          WOK5TX
     I              FLW5CD                          WOW5CD
     I              FLEJDT                          WOEJDT
     I              FLAGTM                          WOAGTM
     I              FLKJDT                          WOKJDT
     I              FLATTM                          WOATTM
     I              FLHDDT                          WOHDDT
     I              FLAUTM                          WOAUTM
     I              FLKKDT                          WOKKDT
     I              FLAVTM                          WOAVTM
     I              FLZ4NB                          WOZ4NB
     I              FLY7ST                          WOY7ST
     I              FLY2ST                          WOY2ST
     I              FLWHTX                          WOWHTX
     I              FLWITX                          WOWITX
     I              FLWJTX                          WOWJTX
     I              FLWKTX                          WOWKTX
     I              FLWLTX                          WOWLTX
     I              FLN7DT                          WON7DT
     I              FLN8DT                          WON8DT
     I              FLN9DT                          WON9DT
     I              FLB3TM                          WOB3TM
     I              FLB4TM                          WOB4TM
     I              FLB5TM                          WOB5TM
     I              FLIASX                          WOIASX
     I              FLIBSX                          WOIBSX
     I              FLICSX                          WOICSX
     I              FLWVTX                          WOWVTX
     I              FLWWTX                          WOWWTX
     I              FLWXTX                          WOWXTX
     I              FLUVST                          WOUVST
     I              FLUWST                          WOUWST
     I              FLUXST                          WOUXST
     I              FLAATM                          WOAATM
     I              FLAYNA                          WOAYNA
     I              FLA0NA                          WOA0NA
     I              FLAXDT                          WOAXDT
      *
     IYBRDCS      DS                            367
     IQOPBF1    E DSOPBFCPL0
      * UPD : Order Header TRG          Update index
      * Renamed input format fields
     I              BEAIC3                          WRAIC3
     I              BEC4NB                          WRC4NB
     I              BEJNCD                          WRJNCD
     I              BEANC7                          WRANC7
     I              BEBKC7                          WRBKC7
     I              BEBRTX                          WRBRTX
     I              BEHMNA                          WRHMNA
     I              BEHONA                          WRHONA
     I              BEHPNA                          WRHPNA
     I              BEHNNA                          WRHNNA
     I              BEDBCD                          WRDBCD
     I              BECKTX                          WRCKTX
     I              BEB0C7                          WRB0C7
     I              BEAETX                          WRAETX
     I              BEB1NA                          WRB1NA
     I              BEB3NA                          WRB3NA
     I              BEB4NA                          WRB4NA
     I              BEB2NA                          WRB2NA
     I              BEBHCD                          WRBHCD
     I              BEC8TX                          WRC8TX
     I              BEBCNA                          WRBCNA
     I              BEA0DT                          WRA0DT
     I              BEA5DT                          WRA5DT
     I              BEGNDT                          WRGNDT
     I              BEACDT                          WRACDT
     I              BEAQCD                          WRAQCD
     I              BEB6NA                          WRB6NA
     I              BEBYNA                          WRBYNA
     I              BEBZNA                          WRBZNA
     I              BEGTST                          WRGTST
     I              BEGVST                          WRGVST
     I              BEGUST                          WRGUST
     I              BEQFST                          WRQFST
     I              BECQCD                          WRCQCD
     I              BEGJST                          WRGJST
     I              BEGWST                          WRGWST
     I              BEGXST                          WRGXST
     I              BEGYST                          WRGYST
     I              BEAODT                          WRAODT
     I              BEAIVN                          WRAIVN
     I              BECXDT                          WRCXDT
     I              BEJZVA                          WRJZVA
     I              BEA1WG                          WRA1WG
     I              BEXIST                          WRXIST
     I              BEXJST                          WRXJST
     I              BEXKST                          WRXKST
     I              BEEIDT                          WREIDT
     I              BEAFTM                          WRAFTM
     I              BEE8CD                          WRE8CD
     I              BEE9CD                          WRE9CD
     I              BERMNB                          WRRMNB
     I              BETBNB                          WRTBNB
     I              BER1NB                          WRR1NB
     I              BEPJST                          WRPJST
     I              BEU0ST                          WRU0ST
     I              BEU1ST                          WRU1ST
     I              BEQ2CD                          WRQ2CD
     I              BEU2ST                          WRU2ST
     I              BEVEST                          WRVEST
     I              BEVFST                          WRVFST
     I              BEVGST                          WRVGST
     I              BERPCD                          WRRPCD
     I              BERNNB                          WRRNNB
     I              BEVDST                          WRVDST
     I              BEATIN                          WRATIN
     I              BEU4ST                          WRU4ST
     I              BEU5ST                          WRU5ST
     I              BERSRN                          WRRSRN
     I              BEMHNA                          WRMHNA
     I              BEMINA                          WRMINA
     I              BEWBST                          WRWBST
     I              BER4CD                          WRR4CD
     I              BEBFCD                          WRBFCD
     I              BEQ4CD                          WRQ4CD
     I              BET3NB                          WRT3NB
     I              BESICD                          WRSICD
     I              BECONB                          WRCONB
     I              BECEST                          WRCEST
     I              BEAWDT                          WRAWDT
     I              BEJPCD                          WRJPCD
     I              BEXUST                          WRXUST
     I              BEZ1ST                          WRZ1ST
     I              BEVRVA                          WRVRVA
     I              BEOBST                          WROBST
     I              BEBCST                          WRBCST
     I              BEBDST                          WRBDST
     I              BEB7VL                          WRB7VL
     I              BEGASX                          WRGASX
     I              BEGBSX                          WRGBSX
     I              BEGCSX                          WRGCSX
     I              BEGDSX                          WRGDSX
     I              BEFNSX                          WRFNSX
     I              BEFOSX                          WRFOSX
     I              BEFPSX                          WRFPSX
     I              BEFQSX                          WRFQSX
     I              BEFRSX                          WRFRSX
     I              BEFSSX                          WRFSSX
     I              BEFTSX                          WRFTSX
     I              BEFUSX                          WRFUSX
     I              BEFVSX                          WRFVSX
     I              BEFWSX                          WRFWSX
     I              BEFXSX                          WRFXSX
     I              BEFYSX                          WRFYSX
     I              BENODT                          WRNODT
     I              BENPDT                          WRNPDT
     I              BENQDT                          WRNQDT
     I              BENRDT                          WRNRDT
     I              BENSDT                          WRNSDT
     I              BEBPTM                          WRBPTM
     I              BEBQTM                          WRBQTM
     I              BEBRTM                          WRBRTM
     I              BEBSTM                          WRBSTM
     I              BEBTTM                          WRBTTM
     I              BEH0NX                          WRH0NX
     I              BEH1NX                          WRH1NX
     I              BEH2NX                          WRH2NX
     I              BEH3NX                          WRH3NX
     I              BEH4NX                          WRH4NX
     I              BEC0C7                          WRC0C7
     I              BEUVST                          WRUVST
     I              BEUWST                          WRUWST
     I              BEUXST                          WRUXST
     I              BEAATM                          WRAATM
     I              BEAYNA                          WRAYNA
     I              BEA0NA                          WRA0NA
     I              BEAXDT                          WRAXDT
      *
     IYCRDCS      DS                            779
      * Outward parameters
     IPARC        DS                            779
      * RCD : Order Header TRG          Retrieval index       NV
      * I :  Company Number
     I                                    P   1   20PAAIC3
      * I :  Order Number
     I                                    P   3   60PAC4NB
      * I :  Order Type - Sales
     I                                        7   8 PAJNCD
      * I :  A/R Customer Number
     I                                    P   9  120PAANC7
      * I :  Ship To Customer
     I                                    P  13  160PABKC7
      * I :  Ship To Name
     I                                       17  46 PABRTX
      * I :  Ship To Address Line 1
     I                                       47  76 PAHMNA
      * I :  Ship To Address Line 2
     I                                       77 106 PAHONA
      * I :  Ship To Address Line 3
     I                                      107 136 PAHPNA
      * I :  Ship To City
     I                                      137 156 PAHNNA
      * I :  Ship To State Code
     I                                      157 158 PADBCD
      * I :  Ship To Zip/Postal Code
     I                                      159 169 PACKTX
      * I :  Bill to Customer
     I                                    P 170 1730PAB0C7
      * I :  Bill to Name
     I                                      174 203 PAAETX
      * I :  Bill to Address Line 1
     I                                      204 233 PAB1NA
      * I :  Bill to Address Line 2
     I                                      234 263 PAB3NA
      * I :  Bill to Address Line 3
     I                                      264 293 PAB4NA
      * I :  Bill to City
     I                                      294 313 PAB2NA
      * I :  Bill to State Code
     I                                      314 315 PABHCD
      * I :  Bill to Zip/Postal Code
     I                                      316 326 PAC8TX
      * I :  Customer Purchase Order #
     I                                      327 341 PABCNA
      * I :  Order Date
     I                                    P 342 3450PAA0DT
      * I :  Requested Ship Date
     I                                    P 346 3490PAA5DT
      * I :  Actual Shipped Date
     I                                    P 350 3530PAGNDT
      * I :  Cancel Date
     I                                    P 354 3570PAACDT
      * I :  Terms Code
     I                                      358 359 PAAQCD
      * I :  Special Instructions
     I                                      360 399 PAB6NA
      * I :  Special Instructions 2
     I                                      400 439 PABYNA
      * I :  Carrier Code
     I                                      440 442 PABZNA
      * I :  Comment Print Acknowledge
     I                                      443 443 PAGTST
      * I :  Comment Print Inv/Cr.Memo
     I                                      444 444 PAGVST
      * I :  Comment Print Pick Slip
     I                                      445 445 PAGUST
      * I :  Comment Print Ship Doc
     I                                      446 446 PAQFST
      * I :  Reason Code
     I                                      447 449 PACQCD
      * I :  Order in Use
     I                                      450 450 PAGJST
      * I :  Header Status
     I                                      451 451 PAGWST
      * I :  Header Status Last
     I                                      452 452 PAGXST
      * I :  Order Type Print Status
     I                                      453 453 PAGYST
      * I :  Scheduled Ship Date
     I                                    P 454 4570PAAODT
      * I :  User Original Entry
     I                                      458 467 PAAIVN
      * I :  Date of Original Entry
     I                                    P 468 4710PACXDT
      * I :  Order Value Total
     I                                    P 472 4772PAJZVA
      * I :  Order Weight Total
     I                                    P 478 4832PAA1WG
      * I :  Credit Hold
     I                                      484 484 PAXIST
      * I :  Production Hold
     I                                      485 485 PAXJST
      * I :  New Customer Hold
     I                                      486 486 PAXKST
      * I :  Requested Delivery Date
     I                                    P 487 4900PAEIDT
      * I :  Requested Delivery Time
     I                                    P 491 4930PAAFTM
      * I :  Accounts Receiv. Ent 1
     I                                      494 497 PAE8CD
      * I :  Accounts Receiv. Ent 2
     I                                      498 509 PAE9CD
      * I :  Load ID
     I                                    P 510 5130PARMNB
      * I :  Absorbed Freight Rate CWT
     I                                    P 514 5162PATBNB
      * I :  Rated Freight
     I                                    P 517 5222PAR1NB
      * I :  LTL Flag
     I                                      523 523 PAPJST
      * I :  Price Audit
     I                                      524 524 PAU0ST
      * I :  Price Status
     I                                      525 525 PAU1ST
      * I :  Shipping Method
     I                                      526 527 PAQ2CD
      * I :  Export Status
     I                                      528 528 PAU2ST
      * I :  Palletize
     I                                      529 529 PAVEST
      * I :  Shrink Wrap
     I                                      530 530 PAVFST
      * I :  Slip Sheet
     I                                      531 531 PAVGST
      * I :  Age Code
     I                                      532 532 PARPCD
      * I :  Reefer Temperature
     I                                    P 533 5352PARNNB
      * I :  Load Type
     I                                      536 536 PAVDST
      * I :  Attach to Invoice Number
     I                                    P 537 5400PAATIN
      * I :  Load Plan Order
     I                                      541 541 PAU4ST
      * I :  Print Pick Slip
     I                                      542 542 PAU5ST
      * I :  Resell Reference Number
     I                                    P 543 5460PARSRN
      * I :  Special Comment 1
     I                                      547 576 PAMHNA
      * I :  Special Comment 2
     I                                      577 606 PAMINA
      * I :  Affect Auto Accruals
     I                                      607 607 PAWBST
      * I :  Sales Route Code
     I                                      608 610 PAR4CD
      * I :  Manager Level Code
     I                                      611 612 PABFCD
      * I :  VP Level Code
     I                                      613 615 PAQ4CD
      * I :  Attach to Order Number
     I                                    P 616 6190PAT3NB
      * I :  Reason for Price Audit
     I                                      620 622 PASICD
      * I :  Invoice Number
     I                                    P 623 6260PACONB
      * I :  Invoice Suffix
     I                                      627 628 PACEST
      * I :  Invoice Date
     I                                    P 629 6320PAAWDT
      * I :  Event Code
     I                                      633 634 PAJPCD
      * I :  Trans Contol AS400/Plant
     I                                      635 635 PAXUST
      * I :  Modified Flag
     I                                      636 636 PAZ1ST
      * I :  A/R order Value Total
     I                                    P 637 6422PAVRVA
      * I :  Billing Activity Type
     I                                      643 643 PAOBST
      * I :  Block Order Flag
     I                                      644 644 PABCST
      * I :  Order Certification Flag
     I                                      645 645 PABDST
      * I :  Invoice Order Value Tot
     I                                    P 646 6512PAB7VL
      * I :  Process Sts for 3C
     I                                      652 652 PAGASX
      * I :  Order Conf Fax Sts
     I                                      653 653 PAGBSX
      * I :  Manifest Fax Sts
     I                                      654 654 PAGCSX
      * I :  Invoice Fax Sts
     I                                      655 655 PAGDSX
      * I :  Transfer in Storage Ind
     I                                      656 656 PAFNSX
      * I :  Email Cust On Order Ship
     I                                      657 657 PAFOSX
      * I :  Order Emailed
     I                                      658 658 PAFPSX
      * I :  Export Docs Go w/Driver
     I                                      659 659 PAFQSX
      * I :  Shipping Temp Code C/F
     I                                      660 660 PAFRSX
      * I :  Broker Order Status
     I                                      661 661 PAFSSX
      * I :  Air Freight Order
     I                                      662 662 PAFTSX
      * I :  Order Requires Review
     I                                      663 664 PAFUSX
      * I :  OH Load Plan Ready
     I                                      665 666 PAFVSX
      * I :  Export USDA Approved
     I                                      667 668 PAFWSX
      * I :  HPB Ship to Warehouse
     I                                      669 671 PAFXSX
      * I :  OH TF Exempt Code
     I                                      672 674 PAFYSX
      * I :  OH Appt Confirmation Dt
     I                                    P 675 6780PANODT
      * I :  JPN Invoice Issuance Date
     I                                    P 679 6820PANPDT
      * I :  Load Actual Shipped Date
     I                                    P 683 6860PANQDT
      * I :  Load BOL Complete Date
     I                                    P 687 6900PANRDT
      * I :  Load Truck Departure Date
     I                                    P 691 6940PANSDT
      * I :  Maximum Gross Weight
     I                                    P 695 6980PABPTM
      * I :  Time of Original Entry
     I                                    P 699 7020PABQTM
      * I :  OH Appt Confirmation Tm
     I                                    P 703 7060PABRTM
      * I :  Load BOL Complete Time
     I                                    P 707 7100PABSTM
      * I :  Load Truck Departure Time
     I                                    P 711 7140PABTTM
      * I :  Act Frt Reference Amount
     I                                    P 715 7202PAH0NX
      * I :  Act Non-Ref Frt Amount
     I                                    P 721 7262PAH1NX
      * I :  OH Fuel Surcharge Amount
     I                                    P 727 7322PAH2NX
      * I :  OH Total Non-Ref Frt Amt
     I                                    P 733 7382PAH3NX
      * I :  OH Total Ref Frt Amt
     I                                    P 739 7442PAH4NX
      * I :  Claim Number
     I                                    P 745 7480PAC0C7
      * I :  EDI Status 1
     I                                      749 749 PAUVST
      * I :  EDI Status 2
     I                                      750 750 PAUWST
      * I :  EDI Status 3
     I                                      751 751 PAUXST
      * I :  Job Time
     I                                    P 752 7550PAAATM
      * I :  User Id
     I                                      756 765 PAAYNA
      * I :  Job Name
     I                                      766 775 PAA0NA
      * I :  Job Date
     I                                    P 776 7790PAAXDT
      *
     IQOPBG1    E DSOPBGWKL0
      * UPD : Order Detail              Update index
      * Renamed input format fields
     I              OMAIC3                          WWAIC3
     I              OMC4NB                          WWC4NB
     I              OMDPNB                          WWDPNB
     I              OMUENB                          WWUENB
     I              OMHGCD                          WWHGCD
     I              OMAJCD                          WWAJCD
     I              OMBKC7                          WWBKC7
     I              OMCFC7                          WWCFC7
     I              OMGMST                          WWGMST
     I              OMGNST                          WWGNST
     I              OMMAVA                          WWMAVA
     I              OMKDVA                          WWKDVA
     I              OML8VA                          WWL8VA
     I              OML9VA                          WWL9VA
     I              OMGTST                          WWGTST
     I              OMGVST                          WWGVST
     I              OMGUST                          WWGUST
     I              OMQFST                          WWQFST
     I              OMAYVA                          WWAYVA
     I              OMEXDT                          WWEXDT
     I              OMLQCD                          WWLQCD
     I              OMRDCD                          WWRDCD
     I              OMQ7CD                          WWQ7CD
     I              OMBZPR                          WWBZPR
     I              OML6NB                          WWL6NB
     I              OMU1ST                          WWU1ST
     I              OMGIDT                          WWGIDT
     I              OMCRCD                          WWCRCD
     I              OMAGCD                          WWAGCD
     I              OMRZST                          WWRZST
     I              OMR0ST                          WWR0ST
     I              OMR1ST                          WWR1ST
     I              OMG7NA                          WWG7NA
     I              OMG8NA                          WWG8NA
     I              OMRPCD                          WWRPCD
     I              OMVEST                          WWVEST
     I              OMVGST                          WWVGST
     I              OMAVST                          WWAVST
     I              OMU0ST                          WWU0ST
     I              OMRFCD                          WWRFCD
     I              OMFZST                          WWFZST
     I              OMR1NB                          WWR1NB
     I              OMAVQT                          WWAVQT
     I              OMD0WG                          WWD0WG
     I              OMCCQT                          WWCCQT
     I              OMAUWG                          WWAUWG
     I              OMCBQT                          WWCBQT
     I              OMATWG                          WWATWG
     I              OMAQCS                          WWAQCS
     I              OMAGCS                          WWAGCS
     I              OMAKPR                          WWAKPR
     I              OMALPR                          WWALPR
     I              OMAUPR                          WWAUPR
     I              OMAVWG                          WWAVWG
     I              OMA4WG                          WWA4WG
     I              OMA5DT                          WWA5DT
     I              OMAODT                          WWAODT
     I              OMGNDT                          WWGNDT
     I              OMAMST                          WWAMST
     I              OMANST                          WWANST
     I              OMVAST                          WWVAST
     I              OMRGNB                          WWRGNB
     I              OMRHNB                          WWRHNB
     I              OMRINB                          WWRINB
     I              OMRBCD                          WWRBCD
     I              OMHICD                          WWHICD
     I              OMRNCD                          WWRNCD
     I              OMROCD                          WWROCD
     I              OMCXDT                          WWCXDT
     I              OMAJVN                          WWAJVN
     I              OMKXCD                          WWKXCD
     I              OMJPCD                          WWJPCD
     I              OMCQCD                          WWCQCD
     I              OMR4CD                          WWR4CD
     I              OMZ1ST                          WWZ1ST
     I              OMZ3ST                          WWZ3ST
     I              OMZ4ST                          WWZ4ST
     I              OMDUPR                          WWDUPR
     I              OMB6VL                          WWB6VL
     I              OMA1AA                          WWA1AA
     I              OMFZSX                          WWFZSX
     I              OMF0SX                          WWF0SX
     I              OMF1SX                          WWF1SX
     I              OMF2SX                          WWF2SX
     I              OMF3SX                          WWF3SX
     I              OMF4SX                          WWF4SX
     I              OMF5SX                          WWF5SX
     I              OMF6SX                          WWF6SX
     I              OMF7SX                          WWF7SX
     I              OMNTDT                          WWNTDT
     I              OMNUDT                          WWNUDT
     I              OMNVDT                          WWNVDT
     I              OMNWDT                          WWNWDT
     I              OMNXDT                          WWNXDT
     I              OMBUTM                          WWBUTM
     I              OMBVTM                          WWBVTM
     I              OMBWTM                          WWBWTM
     I              OMBXTM                          WWBXTM
     I              OMBYTM                          WWBYTM
     I              OMH5NX                          WWH5NX
     I              OMH6NX                          WWH6NX
     I              OMH7NX                          WWH7NX
     I              OMH8NX                          WWH8NX
     I              OMH9NX                          WWH9NX
     I              OMDVPR                          WWDVPR
     I              OMDWPR                          WWDWPR
     I              OMDXPR                          WWDXPR
     I              OMDYPR                          WWDYPR
     I              OMDZPR                          WWDZPR
     I              OMGSPR                          WWGSPR
     I              OMGTPR                          WWGTPR
     I              OMGUPR                          WWGUPR
     I              OMHOST                          WWHOST
     I              OMHPST                          WWHPST
     I              OMIOST                          WWIOST
     I              OMPEWG                          WWPEWG
     I              OMRINY                          WWRINY
     I              OMTIDT                          WWTIDT
     I              OMTJDT                          WWTJDT
     I              OMH2ST                          WWH2ST
     I              OMH0ST                          WWH0ST
     I              OMH1ST                          WWH1ST
     I              OMTKDT                          WWTKDT
     I              OMTLDT                          WWTLDT
     I              OMTMDT                          WWTMDT
     I              OMUVST                          WWUVST
     I              OMUWST                          WWUWST
     I              OMUXST                          WWUXST
     I              OMAATM                          WWAATM
     I              OMAYNA                          WWAYNA
     I              OMA0NA                          WWA0NA
     I              OMAXDT                          WWAXDT
      *
     IYDRDCS      DS                            525
      /EJECT
      * Parameter declarations
     IP1PARM      DS
      * FLD: Load Header
      * I :  Load ID
     I                                    P   1   40P1RMNB
      * I :  Company Number
     I                                    P   5   60P1AIC3
      * N :  Total Load Order Weight
     I                                    P   7  100P1RPNB
      * N :  Flat Amount
     I                                    P  11  162P1FLAM
      * N :  Allocate Pounds/Miles
     I                                       17  17 P1XQST
      * N :  Total Stops
     I                                    P  18  200P1RRNB
      * N :  Carrier Code
     I                                       21  23 P1BZNA
      * N :  Load Type
     I                                       24  24 P1VDST
      * N :  Total Load Miles
     I                                    P  25  280P1TLMI
      * N :  Ship From Warehouse
     I                                       29  31 P1VPCD
      * N :  Ship To State Code
     I                                       32  33 P1DBCD
      * N :  Carrier Broker
     I                                       34  36 P1XCCD
      * N :  Export Status
     I                                       37  37 P1U2ST
      * N :  Shipping Line
     I                                       38  40 P1XACD
      * N :  Port Delv Terminal
     I                                       41  60 P1OANA
      * N :  Discharge Port
     I                                       61  80 P1W4CD
      * N :  LH Power Only Load
     I                                       81  81 P1RXSX
     IP2PARM      DS
      * N :  Total Base Cost
     I                                    P   1   62P2TLNB
     IP3PARM      DS
      * N :  Total Miscellaneous Cost
     I                                    P   1   62P3TNNB
     IP4PARM      DS
      * FLD: *Arrays
      * N :  @Rated Freight
     I                                    P   1   62P4RAFR
      * N :  Total Stops Cost
     I                                    P   7  122P4TMNB
      * N :  @Number to Rank
     I                                    P  13  150P4RCNB
      * N :  Unused Rate Per Stop
     I                                    P  16  192P4NPVA
      * N :  Unused Mile Rate 1
     I                                    P  20  254P4BQPR
      * N : MAP Unused Weight Rate 1
     I                                    P  26  314P4B2PR
      * N :  Order Freight  USR
     I                                    P  32  372P4JFNX
      * N :  Total Weight Work
     I                                    P  38  440P4BMNB
      * N :  Total Base Cost  USR
     I                                    P  45  502P4JHNX
      * N :  Destination City
     I                                       51  70 P4XECD
      * N :  Bulk Rate
     I                                    P  71  764P4EPPR
      * N :  Export Fresh Flat Amt
     I                                    P  77  824P4EQPR
      * N :  Export Frozen Flat Amt
     I                                    P  83  884P4ERPR
     IP5PARM      DS
      * N :  Total Rated Freight
     I                                    P   1   62P5TONB
     IP6PARM      DS
      * N :  @Sequence Number 5.0
     I                                    P   1   30P6SQCD
     I            DS
     I                                        1 132 ZAMSDA
      /EJECT
      *****************************************************************
      * Entry parameters
     C           *ENTRY    PLIST
     C                     PARM           P0RTN   7
     C           P1RMNB    PARM           WP0001  70       Load ID
     C           P1AIC3    PARM           WP0002  30       Company Number
      *****************************************************************
      * Initialize
     C                     EXSR ZZINIT
      *
      * UPD Rated Frt Post Shp XF
      * RTV MG Created Load   RT - Load Header  * 
     C                     EXSR SARVGN
      * CASE: LCL.MG Created Load is Yes
     C           YL0001    IFEQ 'Y'                        *IF
     C                     GOTO AAEXIT                     *QUIT
     C                     END                             *FI
      * RTV Last Stop Info    RT - Load Detail  * 
     C                     EXSR SBRVGN
      * RTV Load for Rated Frt RT - Load Header  * 
     C                     EXSR SFRVGN
      * ** Retrieve Override Miles             E00207 8/13/08
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
     C                     EXSR SGRVGN
      * ** Put miles into total miles work field to use later    E00207
      * CASE: WRK.Override Total Load Miles is Entered
     C           WUK2DT    IFNE *ZERO                      *IF
     C                     Z-ADDWUK2DT    WUTKNB           Total Miles
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP1TLMI    WUTKNB           Total Miles
     C                     END                             *FI
      * ** Export State Code is retrieved from the Order Header file.
      * RTV ExpOrd Info for LD XF - Order Header TRG  * 
     C                     CALL 'PMJMXFR'              90  RTV ExpOrd Info
     C                     PARM *BLANK    W0RTN   7
     C           YL0005    PARM *ZERO     WQ0001  70       Order Number
     C           YL0006    PARM *ZERO     WQ0002  70       Ship To Custome
     C           YL0007    PARM *BLANK    WQ0003 30        Ship To Name
     C           YL0008    PARM *BLANK    WQ0004 30        Ship To Address
     C           YL0009    PARM *BLANK    WQ0005 30        Ship To Address
     C           YL0010    PARM *BLANK    WQ0006 30        Ship To Address
     C           YL0011    PARM *BLANK    WQ0007 20        Ship To City
     C           YL0012    PARM *BLANK    WQ0008  2        Ship To State C
     C           YL0013    PARM *BLANK    WQ0009 11        Ship To Zip/Pos
     C           YL0014    PARM *BLANK    WQ0010  3        Carrier Code
     C                     PARM P1RMNB    WQ0011  70       Load ID
     C           YL0015    PARM *BLANK    WQ0012  1        Export Status
     C           YL0016    PARM *BLANK    WQ0013  1        Export Docs Go
     C           YL0017    PARM *BLANK    WQ0014  1        Air Freight Ord
     C           YL0018    PARM *BLANK    WQ0015  2        Export USDA App
     C           YL0019    PARM *ZERO     WQ0016  30       Company Number
     C           YL0020    PARM *ZERO     WQ0017  50       Stop/Drop Seque
     C           P1XACD    PARM *BLANK    WQ0018  3        Shipping Line
     C           P1OANA    PARM *BLANK    WQ0019 20        Port Delv Termi
     C           YL0021    PARM *BLANK    WQ0020 25        OHE City
     C           YL0022    PARM *BLANK    WQ0021 30        OHE Vessel/Airl
     C           YL0023    PARM *BLANK    WQ0022 15        OHE Voyage/Flig
     C           YL0024    PARM *BLANK    WQ0023 15        OHE Booking Num
     C           YL0025    PARM *BLANK    WQ0024 20        OHE Discharge P
     C           YL0026    PARM *ZERO     WQ0025  70       OHE Sail/Flight
     C           YL0027    PARM *ZERO     WQ0026  70       OHE Port Cut Da
     C           YL0028    PARM *ZERO     WQ0027  70       OHE Arrival Dat
     C           YL0029    PARM *BLANK    WQ0028  3        OHE Late Delive
     C           YL0030    PARM *BLANK    WQ0029  1        OHE Ship Status
     C           YL0031    PARM *BLANK    WQ0030 12        OHE Container N
     C           YL0032    PARM *BLANK    WQ0031 35        OHE Comment 1
     C           YL0033    PARM *BLANK    WQ0032 75        OHE Comment 2
     C           YL0034    PARM *BLANK    WQ0033 25        Port City
     C           YL0035    PARM *BLANK    WQ0034 25        Port Address Li
     C           YL0036    PARM *BLANK    WQ0035 25        Port Address Li
     C           YL0037    PARM *BLANK    WQ0036  2        Sail Port State
     C           YL0038    PARM *BLANK    WQ0037 11        Port Zip/Postal
     C           YL0039    PARM *ZERO     WQ0038 110       Port Phone Numb
     C           YL0040    PARM *BLANK    WQ0039 25        Port Fax Number
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PMJMXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * ** Export - Retrieve Port City if International Accounts  FP1101
      * CASE: LCL.Ship To State Code is International Accounts
     C           YL0012    IFEQ '.'                        *IF
     C                     MOVELYL0037    P1DBCD           Ship To State C
     C                     MOVELYL0034    P4XECD           Destination Cit
      * RTV Warehouse Type     RT - Warehouse  * 
     C                     EXSR SHRVGN
     C                     END                             *FI
      * ***************
      * TRF015 RMC 11/3/06 Get minimum charge for carrier
      * Rtv Carrier Frt Chr   RT - Carrier Freight Charge  * 
     C                     EXSR SIRVGN
      * ***************
      * CVT Str to Upper Alpha US - /UT User Source  * 
     C                     MOVEAP4XECD    AR1              LOAD ARRAY
     C                     MOVEA*BLANK    AR2              LOAD ARRAY
     C                     Z-ADD1         X1      20       SET COUNTER
     C                     Z-ADD1         Y1      20       SET COUNTER
      * * * * * * * CHECK FOR ALPHABETIC CHARACTERS * * * * * * *
     C           X1        DOWLT31
     C           AR1,X1    IFEQ ' '
     C           AR1,X1    ORGE 'a'
     C           AR1,X1    ANDLE'Z'
     C           AR1,X1    ANDNE'~'
     C           AR1,X1    ANDNE'{'
     C           AR1,X1    ANDNE'}'
     C           AR1,X1    ANDNE'\'
     C                     MOVE AR1,X1    AR2,Y1
     C                     ADD  1         Y1
     C                     ADD  1         X1
     C                     ELSE
     C                     ADD  1         X1
     C                     END
     C                     END
     C                     Z-ADD1         Y1
     C           Y1        DOWLT31
     C           AR2,Y1    IFEQ 'a'
     C                     MOVEL'A'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'b'
     C                     MOVEL'B'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'c'
     C                     MOVEL'C'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'd'
     C                     MOVEL'D'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'e'
     C                     MOVEL'E'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'f'
     C                     MOVEL'F'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'g'
     C                     MOVEL'G'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'h'
     C                     MOVEL'H'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'i'
     C                     MOVEL'I'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'j'
     C                     MOVEL'J'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'k'
     C                     MOVEL'K'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'l'
     C                     MOVEL'L'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'm'
     C                     MOVEL'M'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'n'
     C                     MOVEL'N'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'o'
     C                     MOVEL'O'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'p'
     C                     MOVEL'P'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'q'
     C                     MOVEL'Q'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'r'
     C                     MOVEL'R'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 's'
     C                     MOVEL'S'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 't'
     C                     MOVEL'T'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'u'
     C                     MOVEL'U'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'v'
     C                     MOVEL'V'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'w'
     C                     MOVEL'W'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'x'
     C                     MOVEL'X'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'y'
     C                     MOVEL'Y'       AR2,Y1
     C                     ELSE
     C           AR2,Y1    IFEQ 'z'
     C                     MOVEL'Z'       AR2,Y1
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     END
     C                     ADD  1         Y1
     C                     END
     C                     MOVEAAR2       P4XECD           LOAD OUTPUT
     C                     MOVELP4XECD    YL0044           Destination Cit
      * Rtv Destination Rates RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0001    P      Carrier Code
     C                     MOVELP1VPCD    WL0002    P      Warehouse Code
     C                     MOVELYL0044    WL0003    P      Destination Cit
     C                     MOVELP1DBCD    WL0004    P      State Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0045           Flat Rate
     C                     MOVELWL0006    YL0046    P      CDR Unit of Mea
     C                     Z-ADDWL0007    P4EPPR           Bulk Rate
     C                     Z-ADDWL0008    P4EQPR           Export Fresh Fl
     C                     Z-ADDWL0009    P4ERPR           Export Frozen F
     C                     MOVELWL0010    WULUSX    P      Double Fuel Sur
      * New code:     get the frt rate per carr/whse/State/state    TRF01
      *   Set the Dest city = State Code to get rate for entire state.
      * If found, this is used before the Rate per Region for rated frt c
      * RMC 12/19 do this if city/st rate not found
      * CASE: PGM.*Return code is *Record does not exist
     C           W0RTN     IFEQ @CN,001                    *IF
     C                     MOVEL*BLANK    YL0044           Destination Cit
     C                     MOVELP1DBCD    YL0044           Destination Cit
      * Rtv Destination Rates RT - Carrier Destination Rate  * 
      * Move input parameters to subroutine local variables.
     C                     MOVELP1BZNA    WL0001    P      Carrier Code
     C                     MOVELP1VPCD    WL0002    P      Warehouse Code
     C                     MOVELYL0044    WL0003    P      Destination Cit
     C                     MOVELP1DBCD    WL0004    P      State Code
     C                     EXSR SJRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0005    YL0047           Flat Rate
     C                     MOVELWL0006    YL0046    P      CDR Unit of Mea
     C                     Z-ADDWL0007    P4EPPR           Bulk Rate
     C                     Z-ADDWL0008    P4EQPR           Export Fresh Fl
     C                     Z-ADDWL0009    P4ERPR           Export Frozen F
     C                     MOVELWL0010    YL0048    P      Double Fuel Sur
     C                     END                             *FI
      * *********************
      * ** For City to City, if flat rate <> 0, put into Flat Amount
      * Destination Flat Rate (New)
      * CASE: LCL.Flat Rate is GT Zero
     C           YL0045    IFGT *ZERO                      *IF
      * CASE: LCL.CDR Unit of Measure is Flat
     C           YL0046    IFEQ 'FL'                       *IF
     C                     Z-ADDYL0045    P1FLAM           Flat Amount
     C                     END                             *FI
     C                     END                             *FI
      * get first stop number
      * CLC Maximum Load Miles RT - Load Detail  * 
     C                     EXSR SKRVGN
      * Retrieve total freight entered on Order Header Financial  ELB Loa
      * Rtv Order Freight ELB  RT - Order Header TRG  * 
     C                     EXSR SLRVGN
     C                     SUB  P4BMNB    P1RPNB           Total Load Orde
      * ** Use Override miles here, if they exist
      * ** Update Total Base Cost in each section in the following:
      * Pounds/Miles/Ton computation
      * CASE: PAR.Flat Amount is GT Zero
     C           P1FLAM    IFGT *ZERO                      *IF
      * ** Flat amount from Load Header takes precedence in calcs - DLY02
     C                     Z-ADD*ZERO     W0WB             *Synon (15,5) w
      * ** FP1251 LJB 01/22/2008 Update Total Base Cost from flat amount
     C                     Z-ADDP1FLAM    P2TLNB           Total Base Cost
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Destination City NE PAR.Ship To State Code
      *   |- c2    : LCL.Flat Rate is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0044    IFNE P1DBCD                     *IF
     C           YL0045    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** city calcs                              dly029 07/16/2007 ljb
      * CASE: LCL.CDR Unit of Measure is Flat
     C           YL0046    IFEQ 'FL'                       *IF
     C                     Z-ADD*ZERO     YL0047           Freight Rate US
     C                     Z-ADDYL0045    P1FLAM           Flat Amount
     C                     Z-ADDYL0045    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     ELSE
      * CASE: LCL.CDR Unit of Measure is Mile
     C           YL0046    IFEQ 'ML'                       *IF
     C                     Z-ADDYL0045    P4BQPR           Unused Mile Rat
      * ** Total miles work field will have either override miles or
      * ** total load miles. Override miles takes precedence.   E00207
     C           WUTKNB    MULT P4BQPR    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE:
      *  - c1 AND c2
      *   |- c1    : LCL.Destination City EQ PAR.Ship To State Code
      *   |- c2    : LCL.Freight Rate USR NE WRK.ZERO
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0044    IFEQ P1DBCD                     *IF
     C           YL0047    IFNE WUW0NB                     *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** state to state calcs                    dly029 07/16/2007 ljb
      * CASE: LCL.CDR Unit of Measure is Flat
     C           YL0046    IFEQ 'FL'                       *IF
     C                     Z-ADDYL0047    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     ELSE
      * CASE: LCL.CDR Unit of Measure is Mile
     C           YL0046    IFEQ 'ML'                       *IF
     C                     Z-ADDYL0047    P4BQPR           Unused Mile Rat
      * ** Total miles work field will have either override miles or
      * ** total load miles. Override miles takes precedence.   E00207
     C           WUTKNB    MULT P4BQPR    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Allocate Pounds/Miles is Miles
     C           P1XQST    IFEQ 'M'                        *IF
      * RTV Shipping Co        RT - Warehouse  * 
     C                     EXSR SORVGN
      * ** Total miles work field will have either override miles or
      * ** total load miles. Override miles takes precedence.   E00207
      * CLC Mile Rate          XF - Carrier Rates  * 
     C                     CALL 'PDELXFR'              90  CLC Mile Rate
     C                     PARM *BLANK    W0RTN   7
     C                     PARM YL0049    WQ0040  30       Company Number
     C                     PARM P1VPCD    WQ0041  3        Warehouse Code
     C                     PARM P1XCCD    WQ0042  3        Carrier Code
     C                     PARM WUTKNB    WQ0043  70       Starting Miles
     C           P4BQPR    PARM *ZERO     WQ0044 114       Carrier Rate
     C                     PARM P1DBCD    WQ0045  2        Ship To State C
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDELXFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Use Region Rate or Rate per State       TRF015 11/3/6 RMC
      * CASE: LCL.Freight Rate USR is Equal to Zero
     C           YL0047    IFEQ *ZERO                      *IF
      * CASE:
      *  - c1ANDc2
      *   |- c1    : LCL.CDR Unit of Measure is Mile
      *   |- c2    : LCL.Flat Rate is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           YL0046    IFEQ 'ML'                       *IF
     C           YL0045    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * ** Total miles work field will have either override miles or
      * ** total load miles. Override miles takes precedence.   E00207
     C           WUTKNB    MULT YL0045    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     ELSE
      * CASE: *OTHERWISE
      * ** Total miles work field will have either override miles or
      * ** total load miles. Override miles takes precedence.   E00207
     C           WUTKNB    MULT P4BQPR    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     ELSE
      * CASE: *OTHERWISE
      * TRF015 RMC 11/3/6 new calc
      * ** Total miles work field will have either override miles or
      * ** total load miles. Override miles takes precedence.   E00207
     C           WUTKNB    MULT YL0047    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     ELSE
      * CASE: PAR.Allocate Pounds/Miles is Ton
     C           P1XQST    IFEQ 'T'                        *IF
      * *Synon (15,5) work field
      * PGM.*Synon (15,5) work field =
      *    *COMPUTE ((x1 / x3) * x2)
      * x1    : PAR.Total Load Order Weight
      * /     : PGM.*Synon (17,5) work field *Rounded
      * x3    : CON.2000
      * *     : PGM.*Synon (15,5) work field *Rounded
      * x2    : PAR.Bulk Rate
     C           P1RPNB    DIV  2000      W0WC01    H      *Synon (17,5) w
     C           W0WC01    MULT P4EPPR    W0WB00    H      *Synon (15,5) w
     C                     Z-ADDW0WB00    W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADD*ZERO     W0WB             *Synon (15,5) w
     C                     Z-ADDW0WB      P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
     C                     END                             *FI
      * ** Don't add flat amount to work field per Rose - 7/13/2007 DLY02
      * Remove Order freight for Elberton.
      * CASE: PAR.Flat Amount GE PAR.Order Freight  USR
     C           P1FLAM    IFGE P4JFNX                     *IF
      * Remove Order Freight ELB
      * PAR.Total Base Cost  USR =
      *    *COMPUTE (x1 - x3)
      * x1    : PAR.Total Base Cost
      * -     : PGM.*Synon (17,7) work field
      * x3    : PAR.Order Freight  USR
     C           P2TLNB    SUB  P4JFNX    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4JHNX           Total Base Cost
     C                     ELSE
      * CASE: *OTHERWISE
     C                     Z-ADDP2TLNB    P4JHNX           Total Base Cost
     C                     END                             *FI
      * *****************************************************************
     C                     Z-ADDP2TLNB    P5TONB           Total Rated Fre
      * *******************
      * TRF015 11/3/06 RMC Use minimum charge if found for carrier
      * TRF015 RMC 11/3/6 Use Carrier Minimum Charge if flat amt=0 and ..
      * CASE:
      *  - c1ANDc2
      *   |- c1    : PAR.Flat Amount is EQ Zero
      *   |- c2    : LCL.CFC Charge Amount is GT Zero
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P1FLAM    IFEQ 0                          *IF
     C           YL0042    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * and Rated Freight is < minimum charge AND rated>0 RMC 01/25/07
      * CASE:
      *  - c1AND c2
      *   |- c1    : PAR.Total Rated Freight LT LCL.CFC Charge Amount
      *   |- c2    : PAR.Total Rated Freight is GT 0
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           P5TONB    IFLT YL0042                     *IF
     C           P5TONB    IFGT *ZERO                      *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C                     Z-ADDYL0042    P5TONB           Total Rated Fre
     C                     Z-ADDYL0042    P4JHNX           Total Base Cost
     C                     Z-ADDYL0042    P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     END                             *FI
      * *******************
      * E1647 PKD 0/28/11 PKD If Load is identified as a Power Only Load
      *                       and Flat Amount is not entered, then do
      *                       not calculate the Rated Freight.
      *                       not calculate the Rated Freight.
      * OVERRIDE Rated Freight: Power Only Load
      * CASE: PAR.Flat Amount is EQ Zero
     C           P1FLAM    IFEQ 0                          *IF
      * CASE: PAR.LH Power Only Load is Yes
     C           P1RXSX    IFEQ 'Y'                        *IF
     C                     Z-ADD*ZERO     P5TONB           Total Rated Fre
     C                     Z-ADD*ZERO     P4JHNX           Total Base Cost
     C                     Z-ADD*ZERO     P2TLNB           Total Base Cost
     C                     END                             *FI
     C                     END                             *FI
      * *******************
      * update load details with new rated freight calculation
      * CHG Recovery Freight   CH - Load Header  * 
     C                     EXSR SPCHRC
      * CHG Update Rated Frt   RT - Load Detail  * 
     C                     EXSR SQRVGN
      * Check totals
      * Adjust totals
      * CASE: PAR.Total Rated Freight NE PAR.@Rated Freight
     C           P5TONB    IFNE P4RAFR                     *IF
     C           P5TONB    SUB  P4RAFR    WUAIVA           Adjustment Amou
      * adjust last load detail, and order header for that detail
      * CHG Adjust Rated Frt   RT - Load Detail  * 
     C                     EXSR SVRVGN
     C                     END                             *FI
      * Update all order detail rated freight
      * Chg Adjust Rated Frt   RT - Order Header TRG  * 
     C                     EXSR SWRVGN
      *----------------------------------------------------------------
      * Exit program
     C           AAEXIT    TAG
     C                     MOVEL*BLANK    P0RTN
     C                     EXSR ZYEXPG
      *================================================================
      /EJECT
     CSR         SARVGN    BEGSR
      *================================================================
      * RTV MG Created Load   RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSA     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSA     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0001           MG Created Load
     C                     GOTO SAEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWARYSX    YL0001           MG Created Load
     C                     GOTO SAEXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SAEXIT    ENDSR
      /EJECT
     CSR         SBRVGN    BEGSR
      *================================================================
      * RTV Last Stop Info    RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSB02           Load ID
      * Define keylist
     C           KRSSB     KLIST
     C                     KFLD           WQSB02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSB02           Load ID
      * Establish starting position
     C           KRSSB     SETLL@FLCPE8                    *
     C           KRSSB     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * RTV Last Stop Info     RT - Order Header TRG  * 
     C                     EXSR SCRVGN
      * RTV Salesman Code      RT - Sales Route  * 
     C                     EXSR SDRVGN
      * RTV Salesperson Name   RT - Salesperson  * 
     C                     EXSR SERVGN
     C                     GOTO SBEXIT                     *QUIT
     C           KRSSB     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SBEXIT    ENDSR
      /EJECT
     CSR         SCRVGN    BEGSR
      *================================================================
      * RTV Last Stop Info     RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSC     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWBAIC3    WCAIC3           Company Number
     C                     Z-ADDWBC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSC     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWCHNNA    P4XECD           Ship To City
     C                     MOVELWCDBCD    P1DBCD           Ship To State C
     C                     MOVELWCBCNA    WUG0TX           Customer Purcha
     C                     MOVELWCB6NA    WUG0TX           Special Instruc
     C                     MOVELWCBYNA    WUG0TX           Special Instruc
     C                     Z-ADDWCEIDT    WUNFNN           Requested Deliv
     C                     Z-ADDWCAFTM    WUNFNN           Requested Deliv
     C                     MOVELWCR4CD    YL0002           Sales Route Cod
     C                     ENDIF
      *================================================================
     CSR         SCEXIT    ENDSR
      /EJECT
     CSR         SDRVGN    BEGSR
      *================================================================
      * RTV Salesman Code      RT - Sales Route  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSD     KLIST
     C                     KFLD           WDR4CD           Sales Route Cod
      * Setup key
     C                     MOVELYL0002    WDR4CD           Sales Route Cod
      * Establish starting position
     C           KRSSD     CHAIN@JEREWS              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1800' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Salesperson Cod
     C                     GOTO SDEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWDBCCD    YL0003           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SDEXIT    ENDSR
      /EJECT
     CSR         SERVGN    BEGSR
      *================================================================
      * RTV Salesperson Name   RT - Salesperson  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSE     KLIST
     C                     KFLD           WEBCCD           Salesperson Cod
      * Setup key
     C                     MOVELYL0003    WEBCCD           Salesperson Cod
      * Establish starting position
     C           KRSSE     CHAIN@APREBU              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0039' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0003           Salesperson Cod
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SEEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWEBCCD    YL0003           Salesperson Cod
     C                     ENDIF
      *================================================================
     CSR         SEEXIT    ENDSR
      /EJECT
     CSR         SFRVGN    BEGSR
      *================================================================
      * RTV Load for Rated Frt RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSF     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSF     CHAIN@FJCPBN              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1188' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0004           Scheduled Ship
     C                     MOVEL*BLANK    WUPKST           Load Status
     C                     Z-ADD*ZERO     P1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     P1FLAM           Flat Amount
     C                     MOVEL*BLANK    P1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     P1RRNB           Total Stops
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     Z-ADD*ZERO     P5TONB           Rated Freight
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     Z-ADD*ZERO     P1TLMI           Total Load Mile
     C                     MOVEL*BLANK    WUQ2CD           Shipping Method
     C                     MOVEL*BLANK    P1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    P1XCCD           Carrier Broker
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     MOVEL*BLANK    P1RXSX           LH Power Only L
     C                     GOTO SFEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWAAODT    YL0004           Scheduled Ship
     C                     MOVELWAPKST    WUPKST           Load Status
     C                     Z-ADDWARPNB    P1RPNB           Total Load Orde
     C                     Z-ADDWAFLAM    P1FLAM           Flat Amount
     C                     MOVELWAXQST    P1XQST           Allocate Pounds
     C                     Z-ADDWARRNB    P1RRNB           Total Stops
     C                     MOVELWABZNA    P1BZNA           Carrier Code
     C                     Z-ADDWAR1NB    P5TONB           Rated Freight
     C                     MOVELWAVDST    P1VDST           Load Type
     C                     Z-ADDWATLMI    P1TLMI           Total Load Mile
     C                     MOVELWAQ2CD    WUQ2CD           Shipping Method
     C                     MOVELWAVPCD    P1VPCD           Ship From Wareh
     C                     MOVELWAXCCD    P1XCCD           Carrier Broker
     C                     MOVELWAU2ST    P1U2ST           Export Status
     C                     MOVELWARXSX    P1RXSX           LH Power Only L
     C                     ENDIF
      *================================================================
     CSR         SFEXIT    ENDSR
      /EJECT
     CSR         SGRVGN    BEGSR
      *================================================================
      * RTV Total Ld Mi/Sts    RT - Load Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSG     KLIST
     C                     KFLD           WARMNB           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WARMNB           Load ID
      * Establish starting position
     C           KRSSG     CHAIN@FJCPBN              90    *
      * Data record not found
     C   90                MOVEL'USR1188' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWAPKST    WUG0TX           Load Status
     C                     Z-ADDWATLMI    P1TLMI           Total Load Mile
     C                     Z-ADDWAK2DT    WUK2DT           Override Total
     C                     ENDIF
      *================================================================
     CSR         SGEXIT    ENDSR
      /EJECT
     CSR         SHRVGN    BEGSR
      *================================================================
      * RTV Warehouse Type     RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSH     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1VPCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSH     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     MOVEL*BLANK    YL0041           Warehouse Type
     C                     GOTO SHEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     MOVELWFWPST    YL0041           Warehouse Type
     C                     ENDIF
      *================================================================
     CSR         SHEXIT    ENDSR
      /EJECT
     CSR         SIRVGN    BEGSR
      *================================================================
      * Rtv Carrier Frt Chr   RT - Carrier Freight Charge  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WGBZNA    WQSI01           Carrier Code
     C           *LIKE     DEFN WGG7AA    WQSI02           CFC Freight Cha
      * Define keylist
     C           KPSSI     KLIST
     C                     KFLD           WQSI01           Carrier Code
     C                     KFLD           WQSI02           CFC Freight Cha
     C                     KFLD           WGQODT           CFC Effective D
     C                     KFLD           WGFDNY           CFC Line/Stop N
      * Define keylist
     C           KRSSI     KLIST
     C                     KFLD           WQSI01           Carrier Code
     C                     KFLD           WQSI02           CFC Freight Cha
      * Setup key
     C                     MOVELP1BZNA    WQSI01           Carrier Code
     C                     MOVE *BLANK    WQSI02           CFC Freight Cha
     C                     MOVEL'MINIM'   WQSI02           CFC Freight Cha
     C                     Z-ADD##JDT     WGQODT           CFC Effective D
     C                     Z-ADD*ZERO     WGFDNY           CFC Line/Stop N
      * Establish starting position
     C           KPSSI     SETLL@ABREHD                    *
     C           KRSSI     READE@ABREHD                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR3652' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0042           CFC Charge Amou
     C                     MOVEL*BLANK    YL0043           CFC Unit of Mea
     C                     GOTO SIEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWGFENY    YL0042           CFC Charge Amou
     C                     MOVELWGAWTX    YL0043           CFC Unit of Mea
     C                     GOTO SIEXIT                     *QUIT
     C           KRSSI     READE@ABREHD                  90*
     C                     ENDDO
      *================================================================
     CSR         SIEXIT    ENDSR
      /EJECT
     CSR         SJRVGN    BEGSR
      *================================================================
      * Rtv Destination Rates RT - Carrier Destination Rate  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSJ     KLIST
     C                     KFLD           WHBZNA           Carrier Code
     C                     KFLD           WHAJCD           Warehouse Code
     C                     KFLD           WHXECD           Destination Cit
     C                     KFLD           WHBGCD           State Code
      * Setup key
     C                     MOVELWL0001    WHBZNA           Carrier Code
     C                     MOVELWL0002    WHAJCD           Warehouse Code
     C                     MOVELWL0003    WHXECD           Destination Cit
     C                     MOVELWL0004    WHBGCD           State Code
      * Establish starting position
     C           KRSSJ     CHAIN@LECPM7              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR2455' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WL0005           Flat Rate
     C                     MOVEL*BLANK    WL0006           CDR Unit of Mea
     C                     Z-ADD*ZERO     WL0007           Bulk Rate
     C                     Z-ADD*ZERO     WL0008           Export Fresh Fl
     C                     Z-ADD*ZERO     WL0009           Export Frozen F
     C                     MOVEL*BLANK    WL0010           Double Fuel Sur
     C                     MOVEL'Y2U0005' W0RTN            *Return code
     C                     GOTO SJEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWHNMVA    WL0005           Flat Rate
     C                     MOVELWHAVTX    WL0006           CDR Unit of Mea
     C                     Z-ADDWHEPPR    WL0007           Bulk Rate
     C                     Z-ADDWHEQPR    WL0008           Export Fresh Fl
     C                     Z-ADDWHERPR    WL0009           Export Frozen F
     C                     MOVELWHLUSX    WL0010           Double Fuel Sur
     C                     ENDIF
      *================================================================
     CSR         SJEXIT    ENDSR
      /EJECT
     CSR         SKRVGN    BEGSR
      *================================================================
      * CLC Maximum Load Miles RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0001  50       Stop/Drop
     C                     Z-ADD*ZERO     WN0002  50       Miles to next s
     C                     Z-ADD*ZERO     WN0003  92       Mileage To Cust
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * Change Log
     C                     EXSR UASUBR                     Change Log
     C                     Z-ADD0         WUMXML           Maximum Miles
     C                     Z-ADD0         WN0001           Stop/Drop
     C                     Z-ADD0         WN0002           Miles to next s
     C                     Z-ADD99999     P4RCNB           @Number to Rank
      * Declare restrictor key work fields
     C           *LIKE     DEFN WBRMNB    WQSK02           Load ID
      * Define keylist
     C           KRSSK     KLIST
     C                     KFLD           WQSK02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSK02           Load ID
      * Establish starting position
     C           KRSSK     SETLL@FLCPE8                    *
     C           KRSSK     READE@FLCPE8                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Assumption:  1 customer per stop
      * Set up 1st stop
      * CASE: PAR.Stop/Drop NE DB1.Stop/Drop
     C           WN0001    IFNE WBRVNB                     *IF
     C                     Z-ADDWBRVNB    WN0001           Stop/Drop
      * Set 1st stop (number to rank)
      * CASE: DB1.Stop/Drop LT PAR.@Number to Rank
     C           WBRVNB    IFLT P4RCNB                     *IF
     C                     Z-ADDWBRVNB    P4RCNB           @Number to Rank
     C                     END                             *FI
     C                     END                             *FI
      * CASE: DB1.Miles to next stop GT PAR.Maximum Miles
     C           WBRWNB    IFGT WUMXML                     *IF
     C                     Z-ADDWBRWNB    WUMXML           Maximum Miles
     C                     END                             *FI
     C           KRSSK     READE@FLCPE8                  90*
     C                     ENDDO
      *================================================================
     CSR         SKEXIT    ENDSR
      /EJECT
     CSR         SLRVGN    BEGSR
      *================================================================
      * Rtv Order Freight ELB  RT - Order Header TRG  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0004 112       Transaction Amo
     C                     Z-ADD*ZERO     WN0005 112       Freight Misc. C
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/14/04 SLM PKTR01 Multi-Company - Funct chg remove Company RST
     C                     Z-ADD0         P4JFNX           Order Freight
     C                     Z-ADD0         P4BMNB           Total Weight Wo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WIRMNB    WQSL02           Load ID
      * Define keylist
     C           KRSSL     KLIST
     C                     KFLD           WQSL02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSL02           Load ID
      * Establish starting position
     C           KRSSL     SETLL@BFCPD9                    *
     C           KRSSL     READE@BFCPD9                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Rtv Misc Cost for Ord  RT - Load Detail  * 
     C                     EXSR SMRVGN
      * RTV Ttl Frght for Ord  RT - Order Header Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWIAIC3    WL0011           Company Number
     C                     Z-ADDWIC4NB    WL0012           Order Number
     C                     Z-ADDWN0004    WL0013           Transaction Amo
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WN0004           Transaction Amo
      * Order freight
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.Transaction Amount is greater than zero
      *   |- c2    : PAR.Freight Misc. Charge is Entered
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0004    IFGT 0                          *IF
     C           WN0005    IFNE 0                          *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
      * Order freight
      * PAR.Order Freight  USR =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : PAR.Order Freight  USR
      * +     : PAR.Order Freight  USR = PAR.Order Freight  USR + PAR.Tra
      * x2    : PAR.Transaction Amount
      * +     : PGM.*Synon (17,7) work field
      * x3    : PAR.Freight Misc. Charge
     C                     ADD  WN0004    P4JFNX           Order Freight
     C           P4JFNX    ADD  WN0005    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4JFNX           Order Freight
     C                     ELSE
      * CASE: *OTHERWISE
     C                     ADD  WN0004    P4JFNX           Order Freight
     C                     END                             *FI
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Transaction Amount is greater than zero
      *   |- c2    : DB1.Order Type - Sales is Sample Order
      *   '-
     C           WN0004    IFGT 0                          *IF
     C           WIJNCD    OREQ 'SA'                       *OR
     C                     ADD  WIA1WG    P4BMNB           Total Weight Wo
     C                     END                             *FI
     C           KRSSL     READE@BFCPD9                  90*
     C                     ENDDO
      *================================================================
     CSR         SLEXIT    ENDSR
      /EJECT
     CSR         SMRVGN    BEGSR
      *================================================================
      * Rtv Misc Cost for Ord  RT - Load Detail  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WJAIC3    WQSM01           Company Number
     C           *LIKE     DEFN WJC4NB    WQSM02           Order Number
      * Define keylist
     C           KRSSM     KLIST
     C                     KFLD           WQSM01           Company Number
     C                     KFLD           WQSM02           Order Number
      * Setup key
     C                     Z-ADDWIAIC3    WQSM01           Company Number
     C                     Z-ADDWIC4NB    WQSM02           Order Number
      * Establish starting position
     C           KRSSM     SETLL@FLCPW9                    *
     C           KRSSM     READE@FLCPW9                  90*
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR1192' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0005           Freight Misc. C
     C                     GOTO SMEXIT
     C                     ENDIF
      *
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWJT0NB    WN0005           Freight Misc. C
     C           KRSSM     READE@FLCPW9                  90*
     C                     ENDDO
      *================================================================
     CSR         SMEXIT    ENDSR
      /EJECT
     CSR         SNRVGN    BEGSR
      *================================================================
      * RTV Ttl Frght for Ord  RT - Order Header Fin  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
     C                     Z-ADD0         WL0013           Transaction Amo
      * Declare restrictor key work fields
     C           *LIKE     DEFN WKAIC3    WQSN01           Company Number
     C           *LIKE     DEFN WKC4NB    WQSN02           Order Number
      * Define keylist
     C           KRSSN     KLIST
     C                     KFLD           WQSN01           Company Number
     C                     KFLD           WQSN02           Order Number
      * Setup key
     C                     Z-ADDWL0011    WQSN01           Company Number
     C                     Z-ADDWL0012    WQSN02           Order Number
      * Establish starting position
     C           KRSSN     SETLL@CQWKL1                    *
     C           KRSSN     READE@CQWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1319' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Financial Type is Freight Charge
     C           WKG4ST    IFEQ 'F'                        *IF
     C                     ADD  WKBSVA    WL0013           Transaction Amo
     C                     END                             *FI
     C           KRSSN     READE@CQWKL1                  90*
     C                     ENDDO
      *================================================================
     CSR         SNEXIT    ENDSR
      /EJECT
     CSR         SORVGN    BEGSR
      *================================================================
      * RTV Shipping Co        RT - Warehouse  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSO     KLIST
     C                     KFLD           WFAJCD           Warehouse Code
      * Setup key
     C                     MOVELP1VPCD    WFAJCD           Warehouse Code
      * Establish starting position
     C           KRSSO     CHAIN@ADREAO              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0007' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     YL0049           Shipping Compan
     C                     GOTO SOEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWFBWC3    YL0049           Shipping Compan
     C                     ENDIF
      *================================================================
     CSR         SOEXIT    ENDSR
      /EJECT
     CSR         SPCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Header  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0006  30       Company Number
     C                     Z-ADD*ZERO     WN0007  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0008  1        LTL Flag
     C                     MOVEL*BLANK    WN0009  1        Load Status
     C                     Z-ADD*ZERO     WN0010  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0011 15        Seal 1
     C                     MOVEL*BLANK    WN0012 15        Seal 2
     C                     MOVEL*BLANK    WN0013 15        Seal 3
     C                     MOVEL*BLANK    WN0014 15        Seal 4
     C                     MOVEL*BLANK    WN0015 15        Seal 2 Unused
     C                     Z-ADD*ZERO     WN0016  70       Total Load Orde
     C                     Z-ADD*ZERO     WN0017  50       Total Stops
     C                     MOVEL*BLANK    WN0018 20        Trailer Id
     C                     MOVEL*BLANK    WN0019  3        Transloader Car
     C                     Z-ADD*ZERO     WN0020  40       BOL Time
     C                     MOVEL*BLANK    WN0021  3        Carrier Code
     C                     MOVEL*BLANK    WN0022  7        Truck Size
     C                     Z-ADD*ZERO     WN0023  70       Ld Hdr/Ld Dtl U
     C                     MOVEL*BLANK    WN0024  1        Ship Status
     C                     MOVEL*BLANK    WN0025  1        Load Type
     C                     Z-ADD*ZERO     WN0026  50       Number Pallets
     C                     Z-ADD*ZERO     WN0027  50       Number Pallets
     C                     Z-ADD*ZERO     WN0028 112       Load Carrier Pa
     C                     Z-ADD*ZERO     WN0029  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0030  70       Actual Arrival
     C                     Z-ADD*ZERO     WN0031  40       Actual Arrival
     C                     Z-ADD*ZERO     WN0032 112       Trailer IN Weig
     C                     Z-ADD*ZERO     WN0033 112       Trailer OUT Wei
     C                     Z-ADD*ZERO     WN0034  70       Actual Departur
     C                     Z-ADD*ZERO     WN0035  40       Departure Time
     C                     Z-ADD*ZERO     WN0036  50       Schedule Sequen
     C                     Z-ADD*ZERO     WN0037  52       Product Tempera
     C                     Z-ADD*ZERO     WN0038  50       Number Spacers
     C                     MOVEL*BLANK    WN0039 12        Car/Veh. Initia
     C                     MOVEL*BLANK    WN0040 12        Recorder ID
     C                     MOVEL*BLANK    WN0041  2        Shipping Method
     C                     MOVEL*BLANK    WN0042  3        Ship From Wareh
     C                     MOVEL*BLANK    WN0043  2        Ship To State C
     C                     Z-ADD*ZERO     WN0044  70       Gross Weight
     C                     MOVEL*BLANK    WN0045  3        Carrier Broker
     C                     MOVEL*BLANK    WN0046  1        Export Status
     C                     Z-ADD*ZERO     WN0047  70       Actual Ship Dat
     C                     MOVEL*BLANK    WN0048  1        On Time - (Y/N)
     C                     Z-ADD*ZERO     WN0049  70       Truck Ready Dat
     C                     Z-ADD*ZERO     WN0050  60       Truck Ready Tim
     C                     Z-ADD*ZERO     WN0051  70       Spotted Date
     C                     Z-ADD*ZERO     WN0052  60       Spotted Time
     C                     Z-ADD*ZERO     WN0053  70       Load Finished D
     C                     Z-ADD*ZERO     WN0054  60       Load Finished T
     C                     Z-ADD*ZERO     WN0055  70       BOL Complete Da
     C                     Z-ADD*ZERO     WN0056  60       BOL Complete Ti
     C                     Z-ADD*ZERO     WN0057  70       BOL Received Da
     C                     Z-ADD*ZERO     WN0058  60       BOL Received Ti
     C                     Z-ADD*ZERO     WN0059  70       Truck Departure
     C                     Z-ADD*ZERO     WN0060  60       Truck Departure
     C                     Z-ADD*ZERO     WN0061  70       Adjusted Depart
     C                     Z-ADD*ZERO     WN0062  60       Adjusted Depart
     C                     MOVEL*BLANK    WN0063  3        Shipping Line
     C                     MOVEL*BLANK    WN0064 20        Port Delv Termi
     C                     MOVEL*BLANK    WN0065 30        Vessel Name
     C                     Z-ADD*ZERO     WN0066  50       Voyage
     C                     Z-ADD*ZERO     WN0067  70       Sail Date
     C                     MOVEL*BLANK    WN0068 12        Booking Number
     C                     MOVEL*BLANK    WN0069 20        Discharge Port
     C                     Z-ADD*ZERO     WN0070  70       Arrival Date
     C                     MOVEL*BLANK    WN0071 12        Container Numbe
     C                     Z-ADD*ZERO     WN0072  70       Date In
     C                     Z-ADD*ZERO     WN0073  60       Time In
     C                     Z-ADD*ZERO     WN0074  70       Date Out
     C                     Z-ADD*ZERO     WN0075  60       Time Out
     C                     Z-ADD*ZERO     WN0076 112       Load Total Frei
     C                     Z-ADD*ZERO     WN0077  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0078  60       Scheduled Deliv
     C                     MOVEL*BLANK    WN0079  1        LH Unused Sts
     C                     MOVEL*BLANK    WN0080  1        LH Carrier Paym
     C                     Z-ADD*ZERO     WN0081  70       Bring Back Mile
     C                     Z-ADD*ZERO     WN0082  70       Requested Deliv
     C                     MOVEL*BLANK    WN0083  1        Load Acceptance
     C                     MOVEL*BLANK    WN0084  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0085  70       On Yard Date
     C                     Z-ADD*ZERO     WN0086  60       On Yard Time
     C                     Z-ADD*ZERO     WN0087  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0088  60       Deadline Depart
     C                     MOVEL*BLANK    WN0089  1        Load Held Over
     C                     MOVEL*BLANK    WN0090  1        Load Held Over
     C                     MOVEL*BLANK    WN0091 15        Load Held Over
     C                     MOVEL*BLANK    WN0092 25        Ocean BOL Numbe
     C                     MOVEL*BLANK    WN0093 20        Express Mail Nu
     C                     Z-ADD*ZERO     WN0094  70       Express Mail Da
     C                     MOVEL*BLANK    WN0095  1        Load Shag Flag
     C                     MOVEL*BLANK    WN0096  1        Load Wash Flag
     C                     Z-ADD*ZERO     WN0097  70       Product Complet
     C                     Z-ADD*ZERO     WN0098  60       Product Complet
     C                     Z-ADD*ZERO     WN0099  50       Pallets Loaded
     C                     Z-ADD*ZERO     WN0100  92       Avg Pallet Tare
     C                     Z-ADD*ZERO     WN0101  92       Tot Pallet Tare
     C                     MOVEL*BLANK    WN0102  1        Load Confirmed
     C                     MOVEL*BLANK    WN0103 25        Load Confirmed
     C                     Z-ADD*ZERO     WN0104  70       Load Confirmati
     C                     Z-ADD*ZERO     WN0105  60       Load Door 1
     C                     Z-ADD*ZERO     WN0106  60       Load Door 2
     C                     MOVEL*BLANK    WN0107  1        Partial Load
     C                     MOVEL*BLANK    WN0108  1        Load Confirmati
     C                     MOVEL*BLANK    WN0109  1        Export Load USD
     C                     MOVEL*BLANK    WN0110  1        Late Delivery E
     C                     Z-ADD*ZERO     WN0111 112       Load Actual Fre
     C                     MOVEL*BLANK    WN0112 15        Hide on WW Load
     C                     MOVEL*BLANK    WN0113 15        Late Billing Em
     C                     MOVEL*BLANK    WN0114 25        Shipping Temp C
     C                     MOVEL*BLANK    WN0115 25        LH Held Over Rs
     C                     MOVEL*BLANK    WN0116  1        Multi Company L
     C                     MOVEL*BLANK    WN0117  1        Fax Sent to SSI
     C                     MOVEL*BLANK    WN0118  1        Schedule Pos Lo
     C                     MOVEL*BLANK    WN0119  1        MG Created Load
     C                     MOVEL*BLANK    WN0120  1        LH Unused Sts 5
     C                     MOVEL*BLANK    WN0121  2        Load U/M
     C                     MOVEL*BLANK    WN0122  2        TPM Shipment St
     C                     MOVEL*BLANK    WN0123  2        LH Unused Sts 8
     C                     MOVEL*BLANK    WN0124  3        LH On-Time Reas
     C                     MOVEL*BLANK    WN0125  3        LH Held Over Re
     C                     Z-ADD*ZERO     WN0126  70       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0127  60       LH Carrier Paid
     C                     Z-ADD*ZERO     WN0128  70       LH Last Combo P
     C                     Z-ADD*ZERO     WN0129  60       LH Last Combo P
     C                     Z-ADD*ZERO     WN0130  70       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0131  60       LPT Load Plan S
     C                     Z-ADD*ZERO     WN0132  70       TPM Planned Shi
     C                     Z-ADD*ZERO     WN0133  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0134  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0135  60       LH Unused Time
     C                     Z-ADD*ZERO     WN0136  70       LH Unused Date
     C                     Z-ADD*ZERO     WN0137  60       LH Unused Time
     C                     MOVEL*BLANK    WN0138  1        EDI Status 1
     C                     MOVEL*BLANK    WN0139  1        EDI Status 2
     C                     MOVEL*BLANK    WN0140  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0141  60       Job Time
     C                     MOVEL*BLANK    WN0142 10        User Id
     C                     MOVEL*BLANK    WN0143 10        Job Name
     C                     Z-ADD*ZERO     WN0144  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YARDC   1
      *
      * Move key fields to @FJCPBO
     C                     Z-ADDP1RMNB    WLRMNB           Load ID
      *
     C           KLCHSP    KLIST
     C                     KFLD           WLRMNB           Load ID
     C           KLCHSP    CHAIN@FJCPBO              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFJCPL1'MDACP
     C                     MOVEL'@FJCPBO' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL001.
     C                     MOVEL'LBL001'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SPEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SPEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFJ1    YARDCS
      * Move non-key fields to @FJCPBO
     C                     Z-ADDP1FLAM    WLFLAM           Flat Amount
     C                     MOVELP1XQST    WLXQST    P      Allocate Pounds
     C                     Z-ADDP5TONB    WLR1NB           Rated Freight
     C                     Z-ADDP1TLMI    WLTLMI           Total Load Mile
     C                     Z-ADDWUK2DT    WLK2DT           Override Total
     C                     MOVELP1RXSX    WLRXSX    P      LH Power Only L
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WLAATM' defaulted for 'Job Time'.
      * Field '(DB1) WLAYNA' defaulted for 'User Id'.
      * Field '(DB1) WLA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WLAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WLAATM           Job Time
     C                     MOVEL##USR     WLAYNA           User Id
     C                     MOVEL##JOB     WLA0NA           Job Name
     C                     Z-ADD##JDT     WLAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFJ1    IFNE YARDCS
     C           YARDC     ANDNE'N'
     C                     MOVE 'Y'       YARDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YARDC     IFEQ 'Y'
     C                     UPDAT@FJCPBO                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFJCPL1               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
      * USER: Processing after Data update
     C                     MOVEL*BLANK    W0RTN            *Return code
     C                     ENDIF
      *================================================================
     CSR         SPEXIT    ENDSR
      /EJECT
     CSR         SQRVGN    BEGSR
      *================================================================
      * CHG Update Rated Frt   RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0145  50       Stop/Drop
     C                     Z-ADD*ZERO     WN0146  96       @Percent 9/6
     C                     Z-ADD*ZERO     WN0147  72       Freight Stop Ch
     C                     Z-ADD*ZERO     WN0148  50       USR Orders on S
     C                     Z-ADD*ZERO     WN0149 112       USR Stop Total
     C                     Z-ADD*ZERO     WN0150 112       USR Order Weigh
     C                     Z-ADD*ZERO     WN0151 112       USR Misc. Amoun
     C                     Z-ADD*ZERO     WN0152 112       Order Freight
     C                     MOVEL*BLANK    WN0153  2        Order Type - Sa
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.stop/drop is used for stop break processing
     C                     Z-ADD0         WN0145           Stop/Drop
      * par.@rated freight is the sum of all detail rated frt, used in ad
     C                     Z-ADD0         P4RAFR           @Rated Freight
      * par.@sequence number 5.0 is the last seq. no.  on the load for ad
     C                     Z-ADD0         P6SQCD           @Sequence Numbe
      * Declare restrictor key work fields
     C           *LIKE     DEFN WMRMNB    WQSQ02           Load ID
      * Define keylist
     C           KRSSQ     KLIST
     C                     KFLD           WQSQ02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSQ02           Load ID
      * Establish starting position
     C           KRSSQ     SETLL@FLCPEB                    *
     C           KRSSQ     READE@FLCPEB                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * Retrieve order freight from Order Header Financial  ELB Load Plan
      * RTV Ttl Frght for Ord  RT - PD Order Header Fin  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0011           Company Number
     C                     Z-ADDWMC4NB    WL0012           Order Number
     C                     Z-ADDWN0152    WL0013           Transaction Amo
     C                     EXSR SNRVGN
      * Move subroutine local variables to output parameters.
     C                     Z-ADDWL0013    WN0152           Transaction Amo
      * RTV Order Type         RT - PD Order Header  * 
     C                     EXSR SRRVGN
      * If sample order or order header has freight, rated freight = 0 EL
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Freight  USR is Not Zero
      *   |- c2    : PAR.Order Type - Sales is Sample Order
      *   '-
     C           WN0152    IFNE 0                          *IF
     C           WN0153    OREQ 'SA'                       *OR
     C                     Z-ADDWMT0NB    WUR1NB           Rated Freight
      * Rated freight check
      * PAR.@Rated Freight =
      *    *COMPUTE (x1 + x2 + x3)
      * x1    : PAR.@Rated Freight
      * +     : PGM.*Synon (17,7) work field
      * x2    : PAR.Order Freight  USR
      * +     : PGM.*Synon (17,7) work field
      * x3    : DB1.Freight Misc. Charge
     C           P4RAFR    ADD  WN0152    W0WD01           *Synon (17,7) w
     C           W0WD01    ADD  WMT0NB    W0WD00           *Synon (17,7) w
     C                     Z-ADDW0WD00    P4RAFR           @Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * @sequence number 5.0 will be the last sequence number, used for a
     C                     Z-ADDWMRUNB    P6SQCD           @Sequence Numbe
      * RTV Order Weight       RT - OP Order Header  * 
     C                     EXSR SSRVGN
      * Compute rated freight
     C                     EXSR UBSUBR                     Compute rated f
     C                     ADD  WUR1NB    P4RAFR           @Rated Freight
     C                     END                             *FI
      * Update from new computations
      * CASE: WRK.Rated Freight NE DB1.Rated Freight
     C           WUR1NB    IFNE WMR1NB                     *IF
      * CHG Recovery Freight   CH - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMRMNB    WL0014           Load ID
     C                     Z-ADDWMRUNB    WL0015           Stop/Drop Seque
     C                     Z-ADDWMRWNB    WL0016           Miles to next s
     C                     Z-ADDWMT0NB    WL0017           Freight Misc. C
     C                     Z-ADDWN0147    WL0018           Freight Stop Ch
     C                     Z-ADDWUR1NB    WL0019           Rated Freight
     C                     EXSR STCHRC
      * CHG Rated Freight      CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWMAIC3    WL0020           Company Number
     C                     Z-ADDWMC4NB    WL0021           Order Number
     C                     Z-ADDWUR1NB    WL0022           Rated Freight
     C                     EXSR SUCHRC
     C                     END                             *FI
     C           KRSSQ     READE@FLCPEB                  90*
     C                     ENDDO
      *================================================================
     CSR         SQEXIT    ENDSR
      /EJECT
     CSR         SRRVGN    BEGSR
      *================================================================
      * RTV Order Type         RT - PD Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSR     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WCAIC3           Company Number
     C                     Z-ADDWMC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSR     CHAIN@BECPFK              90    *
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     IFEQ '0'
      * USER: Process Data record
     C                     MOVELWCJNCD    WN0153           Order Type - Sa
     C                     GOTO SREXIT                     *QUIT
     C                     ENDIF
      *================================================================
     CSR         SREXIT    ENDSR
      /EJECT
     CSR         SSRVGN    BEGSR
      *================================================================
      * RTV Order Weight       RT - OP Order Header  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * Define keylist
     C           KRSSS     KLIST
     C                     KFLD           WCAIC3           Company Number
     C                     KFLD           WCC4NB           Order Number
      * Setup key
     C                     Z-ADDWMAIC3    WCAIC3           Company Number
     C                     Z-ADDWMC4NB    WCC4NB           Order Number
      * Establish starting position
     C           KRSSS     CHAIN@BECPFK              90    *
     C           *IN90     IFEQ '1'
      * Data record not found
     C                     MOVEL'USR0176' W0RTN   7
      * USER: Processing if Data record not found
      * PAR = CON By name
     C                     Z-ADD*ZERO     WN0150           Order Weight To
     C                     GOTO SSEXIT
     C                     ENDIF
      *
     C           *IN90     IFEQ '0'
      * USER: Process Data record
      * PAR = DB1 By name
     C                     Z-ADDWCA1WG    WN0150           Order Weight To
     C                     ENDIF
      *================================================================
     CSR         SSEXIT    ENDSR
      /EJECT
     CSR         STCHRC    BEGSR
      *================================================================
      * CHG Recovery Freight   CH - Load Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0154  50       Stop/Drop
     C                     MOVEL*BLANK    WN0155 30        Comments for Pi
     C                     Z-ADD*ZERO     WN0156  72       Freight Charge
     C                     Z-ADD*ZERO     WN0157  70       Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WN0158  30       Company Number
     C                     Z-ADD*ZERO     WN0159  70       Order Number
     C                     MOVEL*BLANK    WN0160  1        Ship Status
     C                     Z-ADD*ZERO     WN0161  70       Estimated Arriv
     C                     Z-ADD*ZERO     WN0162  60       Estimated Arriv
     C                     Z-ADD*ZERO     WN0163  70       Appointment Con
     C                     Z-ADD*ZERO     WN0164  60       Appointment Con
     C                     MOVEL*BLANK    WN0165 30        Confirmation Ma
     C                     MOVEL*BLANK    WN0166 10        Confirmation Nu
     C                     Z-ADD*ZERO     WN0167  70       Actual Delivery
     C                     Z-ADD*ZERO     WN0168  60       Actual Delivery
     C                     Z-ADD*ZERO     WN0169  70       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0170  60       Scheduled Deliv
     C                     Z-ADD*ZERO     WN0171  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0172  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0173  70       On Yard Date
     C                     Z-ADD*ZERO     WN0174  60       On Yard Time
     C                     Z-ADD*ZERO     WN0175  70       MPC Number
     C                     MOVEL*BLANK    WN0176  1        Load Dtl On Tim
     C                     MOVEL*BLANK    WN0177  1        On Time Add'l R
     C                     MOVEL*BLANK    WN0178 15        Seal Nbr 1
     C                     MOVEL*BLANK    WN0179 15        Seal Nbr 2
     C                     MOVEL*BLANK    WN0180 15        Seal Nbr 3
     C                     MOVEL*BLANK    WN0181 15        Seal Nbr 4
     C                     MOVEL*BLANK    WN0182 15        Seal Nbr 5
     C                     Z-ADD*ZERO     WN0183  70       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0184  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0185  70       LD Unused Date
     C                     Z-ADD*ZERO     WN0186  60       LD Carrier Appt
     C                     Z-ADD*ZERO     WN0187  60       LD Unused Time
     C                     Z-ADD*ZERO     WN0188  60       LD Unused Time
     C                     MOVEL*BLANK    WN0189  1        Miles Error Sts
     C                     MOVEL*BLANK    WN0190  1        LD Unused Sts 2
     C                     MOVEL*BLANK    WN0191  2        HPB Transload S
     C                     MOVEL*BLANK    WN0192 15        LD Cst Svc Trac
     C                     MOVEL*BLANK    WN0193 25        LD Unused Txt 2
     C                     MOVEL*BLANK    WN0194 25        LD Unused Txt 3
     C                     MOVEL*BLANK    WN0195  1        EDI Status 1
     C                     MOVEL*BLANK    WN0196  1        EDI Status 2
     C                     MOVEL*BLANK    WN0197  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0198  60       Job Time
     C                     MOVEL*BLANK    WN0199 10        User Id
     C                     MOVEL*BLANK    WN0200 10        Job Name
     C                     Z-ADD*ZERO     WN0201  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YBRDC   1
      *
      * Move key fields to @FLCPBM
     C                     Z-ADDWL0014    WORMNB           Load ID
     C                     Z-ADDWL0015    WORUNB           Stop/Drop Seque
      *
     C           KLCHST    KLIST
     C                     KFLD           WORMNB           Load ID
     C                     KFLD           WORUNB           Stop/Drop Seque
     C           KLCHST    CHAIN@FLCPBM              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OMFLCPL0'MDACP
     C                     MOVEL'@FLCPBM' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL002.
     C                     MOVEL'LBL002'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO STEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO STEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOMFL1    YBRDCS
      * Move non-key fields to @FLCPBM
     C                     Z-ADDWL0016    WORWNB           Miles to next s
     C                     Z-ADDWL0017    WOT0NB           Freight Misc. C
     C                     Z-ADDWL0018    WOT1NB           Freight Stop Ch
     C                     Z-ADDWL0019    WOR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * USER: Processing before Data update
     W* Y2W0053 - One or more arguments defaulted to available contexts
      * Field '(DB1) WOAATM' defaulted for 'Job Time'.
      * Field '(DB1) WOAYNA' defaulted for 'User Id'.
      * Field '(DB1) WOA0NA' defaulted for 'Job Name'.
      * Field '(DB1) WOAXDT' defaulted for 'Job Date'.
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WOAATM           Job Time
     C                     MOVEL##USR     WOAYNA           User Id
     C                     MOVEL##JOB     WOA0NA           Job Name
     C                     Z-ADD##JDT     WOAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOMFL1    IFNE YBRDCS
     C           YBRDC     ANDNE'N'
     C                     MOVE 'Y'       YBRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YBRDC     IFEQ 'Y'
     C                     UPDAT@FLCPBM                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOMFLCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         STEXIT    ENDSR
      /EJECT
     CSR         SUCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - Order Header TRG  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     MOVEL*BLANK    WN0202  2        Order Type - Sa
     C                     Z-ADD*ZERO     WN0203  70       A/R Customer Nu
     C                     Z-ADD*ZERO     WN0204  70       Ship To Custome
     C                     MOVEL*BLANK    WN0205 30        Ship To Name
     C                     MOVEL*BLANK    WN0206 30        Ship To Address
     C                     MOVEL*BLANK    WN0207 30        Ship To Address
     C                     MOVEL*BLANK    WN0208 30        Ship To Address
     C                     MOVEL*BLANK    WN0209 20        Ship To City
     C                     MOVEL*BLANK    WN0210  2        Ship To State C
     C                     MOVEL*BLANK    WN0211 11        Ship To Zip/Pos
     C                     Z-ADD*ZERO     WN0212  70       Bill to Custome
     C                     MOVEL*BLANK    WN0213 30        Bill to Name
     C                     MOVEL*BLANK    WN0214 30        Bill to Address
     C                     MOVEL*BLANK    WN0215 30        Bill to Address
     C                     MOVEL*BLANK    WN0216 30        Bill to Address
     C                     MOVEL*BLANK    WN0217 20        Bill to City
     C                     MOVEL*BLANK    WN0218  2        Bill to State C
     C                     MOVEL*BLANK    WN0219 11        Bill to Zip/Pos
     C                     MOVEL*BLANK    WN0220 15        Customer Purcha
     C                     Z-ADD*ZERO     WN0221  70       Order Date
     C                     Z-ADD*ZERO     WN0222  70       Requested Ship
     C                     Z-ADD*ZERO     WN0223  70       Actual Shipped
     C                     Z-ADD*ZERO     WN0224  70       Cancel Date
     C                     MOVEL*BLANK    WN0225  2        Terms Code
     C                     MOVEL*BLANK    WN0226 40        Special Instruc
     C                     MOVEL*BLANK    WN0227 40        Special Instruc
     C                     MOVEL*BLANK    WN0228  3        Carrier Code
     C                     MOVEL*BLANK    WN0229  1        Comment Print A
     C                     MOVEL*BLANK    WN0230  1        Comment Print I
     C                     MOVEL*BLANK    WN0231  1        Comment Print P
     C                     MOVEL*BLANK    WN0232  1        Comment Print S
     C                     MOVEL*BLANK    WN0233  3        Reason Code
     C                     MOVEL*BLANK    WN0234  1        Order in Use
     C                     MOVEL*BLANK    WN0235  1        Header Status
     C                     MOVEL*BLANK    WN0236  1        Header Status L
     C                     MOVEL*BLANK    WN0237  1        Order Type Prin
     C                     Z-ADD*ZERO     WN0238  70       Scheduled Ship
     C                     MOVEL*BLANK    WN0239 10        User Original E
     C                     Z-ADD*ZERO     WN0240  70       Date of Origina
     C                     Z-ADD*ZERO     WN0241 112       Order Value Tot
     C                     Z-ADD*ZERO     WN0242 112       Order Weight To
     C                     MOVEL*BLANK    WN0243  1        Credit Hold
     C                     MOVEL*BLANK    WN0244  1        Production Hold
     C                     MOVEL*BLANK    WN0245  1        New Customer Ho
     C                     Z-ADD*ZERO     WN0246  70       Requested Deliv
     C                     Z-ADD*ZERO     WN0247  40       Requested Deliv
     C                     MOVEL*BLANK    WN0248  4        Accounts Receiv
     C                     MOVEL*BLANK    WN0249 12        Accounts Receiv
     C                     Z-ADD*ZERO     WN0250  70       Load ID
     C                     Z-ADD*ZERO     WN0251  52       Absorbed Freigh
     C                     MOVEL*BLANK    WN0252  1        LTL Flag
     C                     MOVEL*BLANK    WN0253  1        Price Audit
     C                     MOVEL*BLANK    WN0254  1        Price Status
     C                     MOVEL*BLANK    WN0255  2        Shipping Method
     C                     MOVEL*BLANK    WN0256  1        Export Status
     C                     MOVEL*BLANK    WN0257  1        Palletize
     C                     MOVEL*BLANK    WN0258  1        Shrink Wrap
     C                     MOVEL*BLANK    WN0259  1        Slip Sheet
     C                     MOVEL*BLANK    WN0260  1        Age Code
     C                     Z-ADD*ZERO     WN0261  52       Reefer Temperat
     C                     MOVEL*BLANK    WN0262  1        Load Type
     C                     Z-ADD*ZERO     WN0263  70       Attach to Invoi
     C                     MOVEL*BLANK    WN0264  1        Load Plan Order
     C                     MOVEL*BLANK    WN0265  1        Print Pick Slip
     C                     Z-ADD*ZERO     WN0266  70       Resell Referenc
     C                     MOVEL*BLANK    WN0267 30        Special Comment
     C                     MOVEL*BLANK    WN0268 30        Special Comment
     C                     MOVEL*BLANK    WN0269  1        Affect Auto Acc
     C                     MOVEL*BLANK    WN0270  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0271  2        Manager Level C
     C                     MOVEL*BLANK    WN0272  3        VP Level Code
     C                     Z-ADD*ZERO     WN0273  70       Attach to Order
     C                     MOVEL*BLANK    WN0274  3        Reason for Pric
     C                     Z-ADD*ZERO     WN0275  70       Invoice Number
     C                     MOVEL*BLANK    WN0276  2        Invoice Suffix
     C                     Z-ADD*ZERO     WN0277  70       Invoice Date
     C                     MOVEL*BLANK    WN0278  2        Event Code
     C                     MOVEL*BLANK    WN0279  1        Trans Contol AS
     C                     MOVEL*BLANK    WN0280  1        Modified Flag
     C                     Z-ADD*ZERO     WN0281 112       A/R order Value
     C                     MOVEL*BLANK    WN0282  1        Billing Activit
     C                     MOVEL*BLANK    WN0283  1        Block Order Fla
     C                     MOVEL*BLANK    WN0284  1        Order Certifica
     C                     Z-ADD*ZERO     WN0285 112       Invoice Order V
     C                     MOVEL*BLANK    WN0286  1        Process Sts for
     C                     MOVEL*BLANK    WN0287  1        Order Conf Fax
     C                     MOVEL*BLANK    WN0288  1        Manifest Fax St
     C                     MOVEL*BLANK    WN0289  1        Invoice Fax Sts
     C                     MOVEL*BLANK    WN0290  1        Transfer in Sto
     C                     MOVEL*BLANK    WN0291  1        Email Cust On O
     C                     MOVEL*BLANK    WN0292  1        Order Emailed
     C                     MOVEL*BLANK    WN0293  1        Export Docs Go
     C                     MOVEL*BLANK    WN0294  1        Shipping Temp C
     C                     MOVEL*BLANK    WN0295  1        Broker Order St
     C                     MOVEL*BLANK    WN0296  1        Air Freight Ord
     C                     MOVEL*BLANK    WN0297  2        Order Requires
     C                     MOVEL*BLANK    WN0298  2        OH Load Plan Re
     C                     MOVEL*BLANK    WN0299  2        Export USDA App
     C                     MOVEL*BLANK    WN0300  3        HPB Ship to War
     C                     MOVEL*BLANK    WN0301  3        OH TF Exempt Co
     C                     Z-ADD*ZERO     WN0302  70       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0303  70       JPN Invoice Iss
     C                     Z-ADD*ZERO     WN0304  70       Load Actual Shi
     C                     Z-ADD*ZERO     WN0305  70       Load BOL Comple
     C                     Z-ADD*ZERO     WN0306  70       Load Truck Depa
     C                     Z-ADD*ZERO     WN0307  60       Maximum Gross W
     C                     Z-ADD*ZERO     WN0308  60       Time of Origina
     C                     Z-ADD*ZERO     WN0309  60       OH Appt Confirm
     C                     Z-ADD*ZERO     WN0310  60       Load BOL Comple
     C                     Z-ADD*ZERO     WN0311  60       Load Truck Depa
     C                     Z-ADD*ZERO     WN0312 112       Act Frt Referen
     C                     Z-ADD*ZERO     WN0313 112       Act Non-Ref Frt
     C                     Z-ADD*ZERO     WN0314 112       OH Fuel Surchar
     C                     Z-ADD*ZERO     WN0315 112       OH Total Non-Re
     C                     Z-ADD*ZERO     WN0316 112       OH Total Ref Fr
     C                     Z-ADD*ZERO     WN0317  70       Claim Number
     C                     MOVEL*BLANK    WN0318  1        EDI Status 1
     C                     MOVEL*BLANK    WN0319  1        EDI Status 2
     C                     MOVEL*BLANK    WN0320  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0321  60       Job Time
     C                     MOVEL*BLANK    WN0322 10        User Id
     C                     MOVEL*BLANK    WN0323 10        Job Name
     C                     Z-ADD*ZERO     WN0324  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YCRDC   1
      *
      * Move key fields to @BECPFJ
     C                     Z-ADDWL0020    WRAIC3           Company Number
     C                     Z-ADDWL0021    WRC4NB           Order Number
      *
     C           KLCHSU    KLIST
     C                     KFLD           WRAIC3           Company Number
     C                     KFLD           WRC4NB           Order Number
     C           KLCHSU    CHAIN@BECPFJ              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBFCPL0'MDACP
     C                     MOVEL'@BECPFJ' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL003.
     C                     MOVEL'LBL003'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SUEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SUEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBF1    YCRDCS
      * Move non-key fields to @BECPFJ
     C                     Z-ADDWL0022    WRR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp.PgmIF
     C                     Z-ADD##JTM     WRAATM           Job Time
     C                     MOVEL##USR     WRAYNA           User Id
     C                     MOVEL##PGM     WRA0NA           Job Name
     C                     Z-ADD##JDT     WRAXDT           Job Date
      * TRG Order Hdr CHG Trig XT - PD Order Header  * 
     C                     CLEARPARC
     C                     Z-ADDWRAIC3    PAAIC3           Company Number
     C                     Z-ADDWRC4NB    PAC4NB           Order Number
     C                     MOVELWRJNCD    PAJNCD    P      Order Type - Sa
     C                     Z-ADDWRANC7    PAANC7           A/R Customer Nu
     C                     Z-ADDWRBKC7    PABKC7           Ship To Custome
     C                     MOVELWRBRTX    PABRTX    P      Ship To Name
     C                     MOVELWRHMNA    PAHMNA    P      Ship To Address
     C                     MOVELWRHONA    PAHONA    P      Ship To Address
     C                     MOVELWRHPNA    PAHPNA    P      Ship To Address
     C                     MOVELWRHNNA    PAHNNA    P      Ship To City
     C                     MOVELWRDBCD    PADBCD    P      Ship To State C
     C                     MOVELWRCKTX    PACKTX    P      Ship To Zip/Pos
     C                     Z-ADDWRB0C7    PAB0C7           Bill to Custome
     C                     MOVELWRAETX    PAAETX    P      Bill to Name
     C                     MOVELWRB1NA    PAB1NA    P      Bill to Address
     C                     MOVELWRB3NA    PAB3NA    P      Bill to Address
     C                     MOVELWRB4NA    PAB4NA    P      Bill to Address
     C                     MOVELWRB2NA    PAB2NA    P      Bill to City
     C                     MOVELWRBHCD    PABHCD    P      Bill to State C
     C                     MOVELWRC8TX    PAC8TX    P      Bill to Zip/Pos
     C                     MOVELWRBCNA    PABCNA    P      Customer Purcha
     C                     Z-ADDWRA0DT    PAA0DT           Order Date
     C                     Z-ADDWRA5DT    PAA5DT           Requested Ship
     C                     Z-ADDWRGNDT    PAGNDT           Actual Shipped
     C                     Z-ADDWRACDT    PAACDT           Cancel Date
     C                     MOVELWRAQCD    PAAQCD    P      Terms Code
     C                     MOVELWRB6NA    PAB6NA    P      Special Instruc
     C                     MOVELWRBYNA    PABYNA    P      Special Instruc
     C                     MOVELWRBZNA    PABZNA    P      Carrier Code
     C                     MOVELWRGTST    PAGTST    P      Comment Print A
     C                     MOVELWRGVST    PAGVST    P      Comment Print I
     C                     MOVELWRGUST    PAGUST    P      Comment Print P
     C                     MOVELWRQFST    PAQFST    P      Comment Print S
     C                     MOVELWRCQCD    PACQCD    P      Reason Code
     C                     MOVELWRGJST    PAGJST    P      Order in Use
     C                     MOVELWRGWST    PAGWST    P      Header Status
     C                     MOVELWRGXST    PAGXST    P      Header Status L
     C                     MOVELWRGYST    PAGYST    P      Order Type Prin
     C                     Z-ADDWRAODT    PAAODT           Scheduled Ship
     C                     MOVELWRAIVN    PAAIVN    P      User Original E
     C                     Z-ADDWRCXDT    PACXDT           Date of Origina
     C                     Z-ADDWRJZVA    PAJZVA           Order Value Tot
     C                     Z-ADDWRA1WG    PAA1WG           Order Weight To
     C                     MOVELWRXIST    PAXIST    P      Credit Hold
     C                     MOVELWRXJST    PAXJST    P      Production Hold
     C                     MOVELWRXKST    PAXKST    P      New Customer Ho
     C                     Z-ADDWREIDT    PAEIDT           Requested Deliv
     C                     Z-ADDWRAFTM    PAAFTM           Requested Deliv
     C                     MOVELWRE8CD    PAE8CD    P      Accounts Receiv
     C                     MOVELWRE9CD    PAE9CD    P      Accounts Receiv
     C                     Z-ADDWRRMNB    PARMNB           Load ID
     C                     Z-ADDWRTBNB    PATBNB           Absorbed Freigh
     C                     Z-ADDWRR1NB    PAR1NB           Rated Freight
     C                     MOVELWRPJST    PAPJST    P      LTL Flag
     C                     MOVELWRU0ST    PAU0ST    P      Price Audit
     C                     MOVELWRU1ST    PAU1ST    P      Price Status
     C                     MOVELWRQ2CD    PAQ2CD    P      Shipping Method
     C                     MOVELWRU2ST    PAU2ST    P      Export Status
     C                     MOVELWRVEST    PAVEST    P      Palletize
     C                     MOVELWRVFST    PAVFST    P      Shrink Wrap
     C                     MOVELWRVGST    PAVGST    P      Slip Sheet
     C                     MOVELWRRPCD    PARPCD    P      Age Code
     C                     Z-ADDWRRNNB    PARNNB           Reefer Temperat
     C                     MOVELWRVDST    PAVDST    P      Load Type
     C                     Z-ADDWRATIN    PAATIN           Attach to Invoi
     C                     MOVELWRU4ST    PAU4ST    P      Load Plan Order
     C                     MOVELWRU5ST    PAU5ST    P      Print Pick Slip
     C                     Z-ADDWRRSRN    PARSRN           Resell Referenc
     C                     MOVELWRMHNA    PAMHNA    P      Special Comment
     C                     MOVELWRMINA    PAMINA    P      Special Comment
     C                     MOVELWRWBST    PAWBST    P      Affect Auto Acc
     C                     MOVELWRR4CD    PAR4CD    P      Sales Route Cod
     C                     MOVELWRBFCD    PABFCD    P      Manager Level C
     C                     MOVELWRQ4CD    PAQ4CD    P      VP Level Code
     C                     Z-ADDWRT3NB    PAT3NB           Attach to Order
     C                     MOVELWRSICD    PASICD    P      Reason for Pric
     C                     Z-ADDWRCONB    PACONB           Invoice Number
     C                     MOVELWRCEST    PACEST    P      Invoice Suffix
     C                     Z-ADDWRAWDT    PAAWDT           Invoice Date
     C                     MOVELWRJPCD    PAJPCD    P      Event Code
     C                     MOVELWRXUST    PAXUST    P      Trans Contol AS
     C                     MOVELWRZ1ST    PAZ1ST    P      Modified Flag
     C                     Z-ADDWRVRVA    PAVRVA           A/R order Value
     C                     MOVELWROBST    PAOBST    P      Billing Activit
     C                     MOVELWRBCST    PABCST    P      Block Order Fla
     C                     MOVELWRBDST    PABDST    P      Order Certifica
     C                     Z-ADDWRB7VL    PAB7VL           Invoice Order V
     C                     MOVELWRGASX    PAGASX    P      Process Sts for
     C                     MOVELWRGBSX    PAGBSX    P      Order Conf Fax
     C                     MOVELWRGCSX    PAGCSX    P      Manifest Fax St
     C                     MOVELWRGDSX    PAGDSX    P      Invoice Fax Sts
     C                     MOVELWRFNSX    PAFNSX    P      Transfer in Sto
     C                     MOVELWRFOSX    PAFOSX    P      Email Cust On O
     C                     MOVELWRFPSX    PAFPSX    P      Order Emailed
     C                     MOVELWRFQSX    PAFQSX    P      Export Docs Go
     C                     MOVELWRFRSX    PAFRSX    P      Shipping Temp C
     C                     MOVELWRFSSX    PAFSSX    P      Broker Order St
     C                     MOVELWRFTSX    PAFTSX    P      Air Freight Ord
     C                     MOVELWRFUSX    PAFUSX    P      Order Requires
     C                     MOVELWRFVSX    PAFVSX    P      OH Load Plan Re
     C                     MOVELWRFWSX    PAFWSX    P      Export USDA App
     C                     MOVELWRFXSX    PAFXSX    P      HPB Ship to War
     C                     MOVELWRFYSX    PAFYSX    P      OH TF Exempt Co
     C                     Z-ADDWRNODT    PANODT           OH Appt Confirm
     C                     Z-ADDWRNPDT    PANPDT           JPN Invoice Iss
     C                     Z-ADDWRNQDT    PANQDT           Load Actual Shi
     C                     Z-ADDWRNRDT    PANRDT           Load BOL Comple
     C                     Z-ADDWRNSDT    PANSDT           Load Truck Depa
     C                     Z-ADDWRBPTM    PABPTM           Maximum Gross W
     C                     Z-ADDWRBQTM    PABQTM           Time of Origina
     C                     Z-ADDWRBRTM    PABRTM           OH Appt Confirm
     C                     Z-ADDWRBSTM    PABSTM           Load BOL Comple
     C                     Z-ADDWRBTTM    PABTTM           Load Truck Depa
     C                     Z-ADDWRH0NX    PAH0NX           Act Frt Referen
     C                     Z-ADDWRH1NX    PAH1NX           Act Non-Ref Frt
     C                     Z-ADDWRH2NX    PAH2NX           OH Fuel Surchar
     C                     Z-ADDWRH3NX    PAH3NX           OH Total Non-Re
     C                     Z-ADDWRH4NX    PAH4NX           OH Total Ref Fr
     C                     Z-ADDWRC0C7    PAC0C7           Claim Number
     C                     MOVELWRUVST    PAUVST    P      EDI Status 1
     C                     MOVELWRUWST    PAUWST    P      EDI Status 2
     C                     MOVELWRUXST    PAUXST    P      EDI Status 3
     C                     Z-ADDWRAATM    PAAATM           Job Time
     C                     MOVELWRAYNA    PAAYNA    P      User Id
     C                     MOVELWRA0NA    PAA0NA    P      Job Name
     C                     Z-ADDWRAXDT    PAAXDT           Job Date
      *
     C                     CALL 'PDW9XFR'              90  TRG Order Hdr C
     C                     PARM *BLANK    W0RTN   7
     C                     PARM           PARC             RCD: Order Head
      *
     C           *IN90     IFEQ '1'
      * Call to program ended in error
     C                     MOVEL'Y2U0032' W0RTN
     C                     MOVEL*BLANKS   W0CLPG 10
     C                     MOVEL'PDW9XFR' W0CLPG
      * Send message '*Error occured on CALL...'
     C                     MOVEL'Y2U0032' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELW0CLPG    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     END
      * Error detected?
     C           W0RTN     IFNE *BLANK
     C                     SETON                     99    *
     C                     END
      * Set PGM.*Record Data Changed flag
     C           QOPBF1    IFNE YCRDCS
     C           YCRDC     ANDNE'N'
     C                     MOVE 'Y'       YCRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YCRDC     IFEQ 'Y'
     C                     UPDAT@BECPFJ                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBFCPL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SUEXIT    ENDSR
      /EJECT
     CSR         SVRVGN    BEGSR
      *================================================================
      * CHG Adjust Rated Frt   RT - Load Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0325 112       Rated Freight
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Declare restrictor key work fields
     C           *LIKE     DEFN WSRMNB    WQSV01           Load ID
      * Define keylist
     C           KPSSV     KLIST
     C                     KFLD           WQSV01           Load ID
     C                     KFLD           WSRUNB           Stop/Drop Seque
      * Define keylist
     C           KRSSV     KLIST
     C                     KFLD           WQSV01           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSV01           Load ID
     C                     Z-ADDP6SQCD    WSRUNB           Stop/Drop Seque
      * Establish starting position
     C           KPSSV     SETLL@FLCPBW                    *
     C           KRSSV     READE@FLCPBW                  90*
      * Data record not found
     C   90                MOVEL'USR1192' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
     C           WSR1NB    ADD  WUAIVA    WN0325           Rated Freight
      * CASE: PAR.Rated Freight is GE Zero
     C           WN0325    IFGE 0                          *IF
      * CHG Recovery Freight   CH - Load Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSRMNB    WL0014           Load ID
     C                     Z-ADDWSRUNB    WL0015           Stop/Drop Seque
     C                     Z-ADDWSRWNB    WL0016           Miles to next s
     C                     Z-ADDWST0NB    WL0017           Freight Misc. C
     C                     Z-ADDWST1NB    WL0018           Freight Stop Ch
     C                     Z-ADDWN0325    WL0019           Rated Freight
     C                     EXSR STCHRC
      * CHG Rated Freight      CH - Order Header TRG  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWSAIC3    WL0020           Company Number
     C                     Z-ADDWSC4NB    WL0021           Order Number
     C                     Z-ADDWN0325    WL0022           Rated Freight
     C                     EXSR SUCHRC
     C                     GOTO SVEXIT                     *QUIT
     C                     END                             *FI
     C           KRSSV     READE@FLCPBW                  90*
     C                     ENDDO
      *================================================================
     CSR         SVEXIT    ENDSR
      /EJECT
     CSR         SWRVGN    BEGSR
      *================================================================
      * Chg Adjust Rated Frt   RT - Order Header TRG  * 
      *================================================================
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * 05/12/04 SLM PKTR01 Multi-Company - Function was changed
      *                                     to remove Company RST or Pos
      * Declare restrictor key work fields
     C           *LIKE     DEFN WTRMNB    WQSW02           Load ID
      * Define keylist
     C           KRSSW     KLIST
     C                     KFLD           WQSW02           Load ID
      * Setup key
     C                     Z-ADDP1RMNB    WQSW02           Load ID
      * Establish starting position
     C           KRSSW     SETLL@BFCPNQ                    *
     C           KRSSW     READE@BFCPNQ                  90*
      * Data record not found
     C   90                MOVEL'USR0176' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * UPD Rated Freight      RT - Order Detail  * 
     C                     EXSR SXRVGN
     C           KRSSW     READE@BFCPNQ                  90*
     C                     ENDDO
      *================================================================
     CSR         SWEXIT    ENDSR
      /EJECT
     CSR         SXRVGN    BEGSR
      *================================================================
      * UPD Rated Freight      RT - Order Detail  * 
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0326  30       Order Sequence
     C                     Z-ADD*ZERO     WN0327  30       Order Secondary
     C                     Z-ADD*ZERO     WN0328 112       Rated Freight
     C                     Z-ADD*ZERO     WN0329 112       @Rated Freight
     C                     MOVEL*BLANK    WN0330  1        USR Process sta
      *
     C                     MOVEL*BLANK    W0RTN   7
      * USER: Initialize routine
      * par.@rated freight is the sum of all the detail rated frt, for ad
     C                     Z-ADD0         WN0329           @Rated Freight
      * par.usr process status is used to indicate if there are detail pr
     C                     MOVEL'N'       WN0330           USR Process sta
      * Declare restrictor key work fields
     C           *LIKE     DEFN WVAIC3    WQSX01           Company Number
     C           *LIKE     DEFN WVC4NB    WQSX02           Order Number
      * Define keylist
     C           KRSSX     KLIST
     C                     KFLD           WQSX01           Company Number
     C                     KFLD           WQSX02           Order Number
      * Setup key
     C                     Z-ADDWTAIC3    WQSX01           Company Number
     C                     Z-ADDWTC4NB    WQSX02           Order Number
      * Establish starting position
     C           KRSSX     SETLL@BGWKL1                    *
     C           KRSSX     READE@BGWKL1                  90*
      * Data record not found
     C   90                MOVEL'USR1309' W0RTN   7
     C           *IN90     DOWEQ'0'
      * USER: Process Data record
      * CASE: DB1.Detail Line Status is Cancelled
     C           WVGMST    IFEQ 'X'                        *IF
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0023           Company Number
     C                     Z-ADDWVC4NB    WL0024           Order Number
     C                     Z-ADDWVDPNB    WL0025           Order Sequence
     C                     Z-ADDWVUENB    WL0026           Order Secondary
     C                     Z-ADD0         WL0027           Rated Freight
     C                     EXSR SYCHRC
     C                     ELSE
      * CASE: *OTHERWISE
     C                     MOVEL'Y'       WN0330           USR Process sta
      * CASE:
      *  - c1 OR c2
      *   |- c1    : PAR.Order Weight Total is Equal to zero
      *   |- c2    : PAR.Total Rated Freight is Zero
      *   '-
     C           WTA1WG    IFEQ 0                          *IF
     C           WTR1NB    OREQ 0                          *OR
     C                     Z-ADD0         WN0328           Rated Freight
     C                     ELSE
      * CASE: *OTHERWISE
      * CASE: DB1.Detail Line Status is Confirmed & Complete
     C           WVGMST    IFEQ 'C'                        *IF
     C           WVGMST    OREQ 'R'
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE (x1 / x3 * x4)
      * x1    : DB1.Weight Shipped Total
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WVATWG    DIV  WTA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WTR1NB    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     ELSE
      * CASE: *OTHERWISE
      * Compute Dtl Rated Freight
      * PGM.*Synon (17,9) work field =
      *    *COMPUTE ((x1 * x2) / x3 * x4)
      * x1    : DB1.Quantity Ordered
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : DB1.Unit Weight Ordered U/M
      * /     : PGM.*Synon (17,7) work field *Rounded
      * x3    : PAR.Order Weight Total
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x4    : PAR.Total Rated Freight
     C           WVAVQT    MULT WVAVWG    W0WD02           *Synon (17,7) w
     C           W0WD02    DIV  WTA1WG    W0WD01    H      *Synon (17,7) w
     C           W0WD01    MULT WTR1NB    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WE             *Synon (17,9) w
     C                     END                             *FI
     C           W0WE      MULT 1         WN0328    H      Rated Freight
     C                     END                             *FI
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWVAIC3    WL0023           Company Number
     C                     Z-ADDWVC4NB    WL0024           Order Number
     C                     Z-ADDWVDPNB    WL0025           Order Sequence
     C                     Z-ADDWVUENB    WL0026           Order Secondary
     C                     Z-ADDWN0328    WL0027           Rated Freight
     C                     EXSR SYCHRC
     C                     ADD  WN0328    WN0329           @Rated Freight
     C                     Z-ADDWVDPNB    WN0326           Order Sequence
     C                     Z-ADDWVUENB    WN0327           Order Secondary
     C                     END                             *FI
     C           KRSSX     READE@BGWKL1                  90*
     C                     ENDDO
      * USER: Exit processing
      * Adjust totals
      * CASE:
      *  - c1 AND c2
      *   |- c1    : PAR.@Rated Freight NE PAR.Total Rated Freight
      *   |- c2    : PAR.USR Process status is yes
      *   '-
     C                     MOVEL'0'       Y0CX01  1
     C           WN0329    IFNE WTR1NB                     *IF
     C           WN0330    IFEQ 'Y'                        *IF
     C                     MOVEL'1'       Y0CX01
     C                     END                             *FI
     C                     END                             *FI
     C           Y0CX01    IFEQ '1'                        *IF
     C           WTR1NB    SUB  WN0329    WUICVA           USR Adjustment
     C                     ADD  WUICVA    WN0328           Rated Freight
      * Update last detail line processed
      * CHG Rated Freight      CH - PD Order Detail  * 
      * Move input parameters to subroutine local variables.
     C                     Z-ADDWTAIC3    WL0023           Company Number
     C                     Z-ADDWTC4NB    WL0024           Order Number
     C                     Z-ADDWN0326    WL0025           Order Sequence
     C                     Z-ADDWN0327    WL0026           Order Secondary
     C                     Z-ADDWN0328    WL0027           Rated Freight
     C                     EXSR SYCHRC
     C                     END                             *FI
      *================================================================
     CSR         SXEXIT    ENDSR
      /EJECT
     CSR         SYCHRC    BEGSR
      *================================================================
      * CHG Rated Freight      CH - PD Order Detail  * 
      *================================================================
      * This is a shared subroutine
      *================================================================
      *
     C                     Z-ADD*ZERO     WN0331  70       Item Code
     C                     MOVEL*BLANK    WN0332  3        Warehouse Code
     C                     Z-ADD*ZERO     WN0333  70       Ship To Custome
     C                     Z-ADD*ZERO     WN0334  70       Order Group Cod
     C                     MOVEL*BLANK    WN0335  1        Detail Line Sta
     C                     MOVEL*BLANK    WN0336  1        Detail Line Sta
     C                     Z-ADD*ZERO     WN0337 112       Billing Detail
     C                     Z-ADD*ZERO     WN0338 112       Billing Detail
     C                     Z-ADD*ZERO     WN0339 112       Billing Detail
     C                     Z-ADD*ZERO     WN0340 112       Quantity to Sub
     C                     MOVEL*BLANK    WN0341  1        Comment Print A
     C                     MOVEL*BLANK    WN0342  1        Comment Print I
     C                     MOVEL*BLANK    WN0343  1        Comment Print P
     C                     MOVEL*BLANK    WN0344  1        Comment Print S
     C                     Z-ADD*ZERO     WN0345 112       Extended Amount
     C                     Z-ADD*ZERO     WN0346  70       Market Pricing
     C                     MOVEL*BLANK    WN0347  3        Commodity Marke
     C                     MOVEL*BLANK    WN0348  3        Date Method Cod
     C                     MOVEL*BLANK    WN0349  3        Price Method Co
     C                     Z-ADD*ZERO     WN0350 114       Price Overage O
     C                     Z-ADD*ZERO     WN0351  70       Contract Number
     C                     MOVEL*BLANK    WN0352  1        Price Status
     C                     Z-ADD*ZERO     WN0353  70       Pricing Date Us
     C                     MOVEL*BLANK    WN0354  2        U/M - Base Pric
     C                     MOVEL*BLANK    WN0355  2        U/M - Ordered
     C                     MOVEL*BLANK    WN0356  1        Work Confirm St
     C                     MOVEL*BLANK    WN0357  1        Work Over/Short
     C                     MOVEL*BLANK    WN0358  1        OD Production P
     C                     MOVEL*BLANK    WN0359 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0360 30        Order Desc. Lin
     C                     MOVEL*BLANK    WN0361  1        Age Code
     C                     MOVEL*BLANK    WN0362  1        Palletize
     C                     MOVEL*BLANK    WN0363  1        Slip Sheet
     C                     MOVEL*BLANK    WN0364  1        Catch Weight St
     C                     MOVEL*BLANK    WN0365  1        Price Audit
     C                     MOVEL*BLANK    WN0366  3        Price Audit Rea
     C                     MOVEL*BLANK    WN0367  1        Production Date
     C                     Z-ADD*ZERO     WN0368 112       Quantity Ordere
     C                     Z-ADD*ZERO     WN0369 112       Weight Ordered
     C                     Z-ADD*ZERO     WN0370 112       Quantity Schedu
     C                     Z-ADD*ZERO     WN0371 112       Weight Schedule
     C                     Z-ADD*ZERO     WN0372 112       Quantity Shippe
     C                     Z-ADD*ZERO     WN0373 112       Weight Shipped
     C                     Z-ADD*ZERO     WN0374 114       Unit Cost Prici
     C                     Z-ADD*ZERO     WN0375 114       Unit Cost Per P
     C                     Z-ADD*ZERO     WN0376 114       Unit Price
     C                     Z-ADD*ZERO     WN0377 114       Unit Price - Cr
     C                     Z-ADD*ZERO     WN0378 114       Unit Price Orde
     C                     Z-ADD*ZERO     WN0379 112       Unit Weight Ord
     C                     Z-ADD*ZERO     WN0380 112       Tare Weight Tot
     C                     Z-ADD*ZERO     WN0381  70       Requested Ship
     C                     Z-ADD*ZERO     WN0382  70       Scheduled Ship
     C                     Z-ADD*ZERO     WN0383  70       Actual Shipped
     C                     MOVEL*BLANK    WN0384  1        Affect Inventor
     C                     MOVEL*BLANK    WN0385  1        Affect Sales Do
     C                     MOVEL*BLANK    WN0386  1        Affect Sales Pn
     C                     Z-ADD*ZERO     WN0387  30       Item Structure
     C                     Z-ADD*ZERO     WN0388  30       Item Structure
     C                     Z-ADD*ZERO     WN0389  30       Item Structure
     C                     MOVEL*BLANK    WN0390  2        Item Level
     C                     MOVEL*BLANK    WN0391  2        Quality Level
     C                     MOVEL*BLANK    WN0392  2        Pricing Product
     C                     MOVEL*BLANK    WN0393  2        Season Product
     C                     Z-ADD*ZERO     WN0394  70       Date of Origina
     C                     MOVEL*BLANK    WN0395 10        User Profile Na
     C                     MOVEL*BLANK    WN0396  6        Country Code
     C                     MOVEL*BLANK    WN0397  2        Event Code
     C                     MOVEL*BLANK    WN0398  3        Reason Code
     C                     MOVEL*BLANK    WN0399  3        Sales Route Cod
     C                     MOVEL*BLANK    WN0400  1        Modified Flag
     C                     MOVEL*BLANK    WN0401  1        Substituted Fla
     C                     MOVEL*BLANK    WN0402  1        OD Schedule Ove
     C                     Z-ADD*ZERO     WN0403 114       Invoice Unit Pr
     C                     Z-ADD*ZERO     WN0404 112       Invoice Extende
     C                     Z-ADD*ZERO     WN0405  30       Ham Group Numbe
     C                     MOVEL*BLANK    WN0406  1        OD Adj Type Ove
     C                     MOVEL*BLANK    WN0407  1        Affect Trade Fu
     C                     MOVEL*BLANK    WN0408  1        Affect Commissi
     C                     MOVEL*BLANK    WN0409  1        Affect Pricing
     C                     MOVEL*BLANK    WN0410  1        Released by Use
     C                     MOVEL*BLANK    WN0411  2        Ord TF Exempt C
     C                     MOVEL*BLANK    WN0412  2        OD Pallet Type
     C                     MOVEL*BLANK    WN0413  3        Production Ware
     C                     MOVEL*BLANK    WN0414  3        OD Price Type
     C                     Z-ADD*ZERO     WN0415  70       Warehouse Palle
     C                     Z-ADD*ZERO     WN0416  70       Consumed Item C
     C                     Z-ADD*ZERO     WN0417  70       Deadline Depart
     C                     Z-ADD*ZERO     WN0418  70       OD Price Type R
     C                     Z-ADD*ZERO     WN0419  70       OD Unused Date
     C                     Z-ADD*ZERO     WN0420  60       Deadline Depart
     C                     Z-ADD*ZERO     WN0421  60       Price Code
     C                     Z-ADD*ZERO     WN0422  60       Maximum Net Wei
     C                     Z-ADD*ZERO     WN0423  60       Substitution Li
     C                     Z-ADD*ZERO     WN0424  60       Max Qty to sche
     C                     Z-ADD*ZERO     WN0425 112       Warehouse Palle
     C                     Z-ADD*ZERO     WN0426 112       Warehouse Avg P
     C                     Z-ADD*ZERO     WN0427 112       OD Item Target
     C                     Z-ADD*ZERO     WN0428 112       OD Estimated Gr
     C                     Z-ADD*ZERO     WN0429 112       OD Maximum Unit
     C                     Z-ADD*ZERO     WN0430 114       Order Gate/Fina
     C                     Z-ADD*ZERO     WN0431 114       OD Ceiling Pric
     C                     Z-ADD*ZERO     WN0432 114       OD Gate/Final P
     C                     Z-ADD*ZERO     WN0433 114       OD Weighted Avg
     C                     Z-ADD*ZERO     WN0434 114       OD Unused Prc 5
     C                     Z-ADD*ZERO     WN0435 114       OD Unused Prc 6
     C                     Z-ADD*ZERO     WN0436 114       OD Unused Prc 7
     C                     Z-ADD*ZERO     WN0437 114       OD Unused Prc 8
     C                     MOVEL*BLANK    WN0438  1        OD MPR Sent to
     C                     MOVEL*BLANK    WN0439  1        OD MPR Prc Read
     C                     MOVEL*BLANK    WN0440  1        OD UnUsed Price
     C                     Z-ADD*ZERO     WN0441 112       Weight Amount E
     C                     Z-ADD*ZERO     WN0442  40       Item Age Days
     C                     Z-ADD*ZERO     WN0443  70       Production Ovr
     C                     Z-ADD*ZERO     WN0444  70       Production Ovr
     C                     MOVEL*BLANK    WN0445  1        OD UnUsed Statu
     C                     MOVEL*BLANK    WN0446  2        OD Clm Full Ret
     C                     MOVEL*BLANK    WN0447  3        Order Line Erro
     C                     Z-ADD*ZERO     WN0448  70       OD Market Begin
     C                     Z-ADD*ZERO     WN0449  70       OD Market Endin
     C                     Z-ADD*ZERO     WN0450  70       OD Atch to Ord
     C                     MOVEL*BLANK    WN0451  1        EDI Status 1
     C                     MOVEL*BLANK    WN0452  1        EDI Status 2
     C                     MOVEL*BLANK    WN0453  1        EDI Status 3
     C                     Z-ADD*ZERO     WN0454  60       Job Time
     C                     MOVEL*BLANK    WN0455 10        User Id
     C                     MOVEL*BLANK    WN0456 10        Job Name
     C                     Z-ADD*ZERO     WN0457  70       Job Date
      *
     C                     MOVEL*BLANK    W0RTN   7
      * Set PGM.*Record Data Changed flag
     C                     MOVE *BLANK    YDRDC   1
      *
      * Move key fields to @BGWKL0
     C                     Z-ADDWL0023    WWAIC3           Company Number
     C                     Z-ADDWL0024    WWC4NB           Order Number
     C                     Z-ADDWL0025    WWDPNB           Order Sequence
     C                     Z-ADDWL0026    WWUENB           Order Secondary
      *
     C           KLCHSY    KLIST
     C                     KFLD           WWAIC3           Company Number
     C                     KFLD           WWC4NB           Order Number
     C                     KFLD           WWDPNB           Order Sequence
     C                     KFLD           WWUENB           Order Secondary
     C           KLCHSY    CHAIN@BGWKL0              9091  *
      *
     C           *IN90     IFEQ '1'
      * Record not found
     C                     MOVEL'Y2U0009' W0RTN   7
     C                     MOVEL##PGM     MDPGM
     C                     MOVEL'OPBGWKL0'MDACP
     C                     MOVEL'@BGWKL0' MDFMT
     C                     MOVEL'*CHG'    MDACT
      * Record not found label: LBL004.
     C                     MOVEL'LBL004'  MDLBL
      * Send message '*Record no longer on file'
     C                     MOVEL'Y2U0009' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     MOVELMD0009    ZAMSDA           Message data
     C                     EXSR ZASNMS
     C                     MOVEL*BLANKS   MD0009
     C                     GOTO SYEXIT
     C                     ENDIF
      *
     C           *IN91     IFEQ '1'
      * Record locked
     C                     MOVEL'Y2U0004' W0RTN   7
      * Send message '*Database operation error'
     C                     MOVEL'Y2U0004' ZAMSID
     C                     MOVEL'Y2USRMSG'ZAMSGF
     C                     EXSR ZASNMS
     C                     GOTO SYEXIT
     C                     ENDIF
      *
      * Store record data for null update check
     C                     MOVE QOPBG1    YDRDCS
      * Move non-key fields to @BGWKL0
     C                     Z-ADDWL0027    WWR1NB           Rated Freight
      *
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * USER: Processing before Data update
      * Set Date/Time Stamp   IF
     C                     Z-ADD##JTM     WWAATM           Job Time
     C                     MOVEL##USR     WWAYNA           User Id
     C                     MOVEL##JOB     WWA0NA           Job Name
     C                     Z-ADD##JDT     WWAXDT           Job Date
      * Set PGM.*Record Data Changed flag
     C           QOPBG1    IFNE YDRDCS
     C           YDRDC     ANDNE'N'
     C                     MOVE 'Y'       YDRDC
     C                     ENDIF
      * If changed update record otherwise release record
     C           YDRDC     IFEQ 'Y'
     C                     UPDAT@BGWKL0                91  *
     C                     ELSE
      * Release record lock
     C                     UNLCKOPBGWKL0               91  *
     C                     ENDIF
     C           *IN91     IFEQ '1'
      * Change error detected
     C                     MOVEL'Y2U0004' W0RTN   7
     C                     ELSE
      *
      * DBF change successful
     C                     ENDIF
      *================================================================
     CSR         SYEXIT    ENDSR
      /EJECT
     CSR         UASUBR    BEGSR
      *================================================================
      * Change Log
      *================================================================
      * OMS186 2/12/97 PLL
      *    changed so use Miles to Next Stop instead of retrieving mileag
      *    customer from co/cust file.
      *================================================================
     CSR         UAEXIT    ENDSR
      /EJECT
     CSR         UBSUBR    BEGSR
      *================================================================
      * Compute rated freight
      *================================================================
      * Compute ratio
      * CASE: PAR.Total Weight EQ WRK.ZERO
     C           P1RPNB    IFEQ WUW0NB                     *IF
     C                     Z-ADD0         WN0146           @Percent 9/6
     C                     ELSE
      * CASE: *OTHERWISE
     C           WN0150    DIV  P1RPNB    WN0146    H      @Percent 9/6
     C                     END                             *FI
      * Compute Rated Freight
      * PGM.*Synon (17,5) work field =
      *    *COMPUTE ((x1 * x2))
      * x1    : PAR.@Percent 9/6
      * *     : PGM.*Synon (17,7) work field *Rounded
      * x2    : PAR.Total Base Cost
     C           WN0146    MULT P4JHNX    W0WD00    H      *Synon (17,7) w
     C                     Z-ADDW0WD00    W0WC             *Synon (17,5) w
     C           W0WC      MULT 1         WUR1NB    H      Rated Freight
      *================================================================
     CSR         UBEXIT    ENDSR
      /EJECT
     CSR         ZASNMS    BEGSR
      *================================================================
      * Send message to program's message queue
      *================================================================
     C           ZAPGMQ    IFEQ *BLANK
     C                     MOVEL##PGM     ZAPGMQ
     C                     END
     C                     CALL 'Y2SNMGC'
     C                     PARM           ZAPGMQ 10        Program queue
     C                     PARM           ZAPGRL  5        Rel queue
     C                     PARM           ZAMSID  7        Message ID
     C                     PARM           ZAMSGF 10        Message file
     C                     PARM           ZAMSDA           Message data
     C                     PARM           ZAMSTP  7        Message type
      * Clear all fields for default mechanism next time
     C                     MOVEL*BLANK    ZAPGMQ
     C                     MOVEL*BLANK    ZAPGRL
     C                     MOVEL*BLANK    ZAMSID
     C                     MOVEL*BLANK    ZAMSGF
     C                     MOVEL*BLANK    ZAMSDA
     C                     MOVEL*BLANK    ZAMSTP
      *================================================================
     CSR         ZAEXIT    ENDSR
      /EJECT
     CSR         ZXEXPG    BEGSR
      *================================================================
      * Exit program: Normal
      *================================================================
     C                     EXSR ZYEXPG
      *================================================================
     CSR         ZXEXIT    ENDSR
      /EJECT
     CSR         ZYEXPG    BEGSR
      *================================================================
      * Exit program: Direct
      *================================================================
      * Terminate program
     C                     SETON                     LR
      *
      * Exit program
     C                     RETRN
      *
      *================================================================
     CSR         ZYEXIT    ENDSR
      /EJECT
     CSR         ZZINIT    BEGSR
      *================================================================
      * Initialisation
      *================================================================
     C           W0ICL     IFEQ *BLANK
     C                     MOVEL'Y'       W0ICL   1        *Initial call
     C                     ELSE
     C                     MOVEL'N'       W0ICL
     C                     END
     C                     MOVE *BLANK    P0RTN
     C                     MOVE *BLANK    W0RTN   7
     C                     MOVEL*BLANK    W0RSL   1
     C                     MOVEL*BLANK    W0RSF   1
     C                     MOVEL*ZEROS    W0RTW   90
     C                     MOVEL'400'     W0ENV   3
      * Clear all neither parameters
     C                     Z-ADD*ZERO     P1RPNB           Total Load Orde
     C                     Z-ADD*ZERO     P1FLAM           Flat Amount
     C                     MOVEL*BLANK    P1XQST           Allocate Pounds
     C                     Z-ADD*ZERO     P1RRNB           Total Stops
     C                     MOVEL*BLANK    P1BZNA           Carrier Code
     C                     MOVEL*BLANK    P1VDST           Load Type
     C                     Z-ADD*ZERO     P1TLMI           Total Load Mile
     C                     MOVEL*BLANK    P1VPCD           Ship From Wareh
     C                     MOVEL*BLANK    P1DBCD           Ship To State C
     C                     MOVEL*BLANK    P1XCCD           Carrier Broker
     C                     MOVEL*BLANK    P1U2ST           Export Status
     C                     MOVEL*BLANK    P1XACD           Shipping Line
     C                     MOVEL*BLANK    P1OANA           Port Delv Termi
     C                     MOVEL*BLANK    P1W4CD           Discharge Port
     C                     MOVEL*BLANK    P1RXSX           LH Power Only L
     C                     Z-ADD*ZERO     P2TLNB           Total Base Cost
     C                     Z-ADD*ZERO     P3TNNB           Total Miscellan
     C                     Z-ADD*ZERO     P4RAFR           @Rated Freight
     C                     Z-ADD*ZERO     P4TMNB           Total Stops Cos
     C                     Z-ADD*ZERO     P4RCNB           @Number to Rank
     C                     Z-ADD*ZERO     P4NPVA           Unused Rate Per
     C                     Z-ADD*ZERO     P4BQPR           Unused Mile Rat
     C                     Z-ADD*ZERO     P4B2PR           Unused Weight R
     C                     Z-ADD*ZERO     P4JFNX           Order Freight
     C                     Z-ADD*ZERO     P4BMNB           Total Weight Wo
     C                     Z-ADD*ZERO     P4JHNX           Total Base Cost
     C                     MOVEL*BLANK    P4XECD           Destination Cit
     C                     Z-ADD*ZERO     P4EPPR           Bulk Rate
     C                     Z-ADD*ZERO     P4EQPR           Export Fresh Fl
     C                     Z-ADD*ZERO     P4ERPR           Export Frozen F
     C                     Z-ADD*ZERO     P5TONB           Total Rated Fre
     C                     Z-ADD*ZERO     P6SQCD           @Sequence Numbe
      *
      * Retrieve job attributes
     C                     CALL 'Y2RTJCR'
     C                     PARM           PGMDS
      * Setup job date/time
     C                     Z-ADD##SD7     ##JDT
     C                     TIME           ##JTM
      * Update screen time
     C                     TIME           ##TME   60
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WARMNB           Load ID
     C                     Z-ADD*ZERO     WAAIC3           Company Number
     C                     Z-ADD*ZERO     WAAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WARNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WARPNB           Total Load Orde
     C                     Z-ADD*ZERO     WAFLAM           Flat Amount
     C                     Z-ADD*ZERO     WARRNB           Total Stops
     C                     Z-ADD*ZERO     WASBNB           BOL Time
     C                     Z-ADD*ZERO     WASQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WAR1NB           Rated Freight
     C                     Z-ADD*ZERO     WASDNB           Number Pallets
     C                     Z-ADD*ZERO     WAPAOU           Number Pallets
     C                     Z-ADD*ZERO     WADGWG           Load Carrier Pa
     C                     Z-ADD*ZERO     WASXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WAHADT           Actual Arrival
     C                     Z-ADD*ZERO     WAAART           Actual Arrival
     C                     Z-ADD*ZERO     WADHWG           Trailer IN Weig
     C                     Z-ADD*ZERO     WADIWG           Trailer OUT Wei
     C                     Z-ADD*ZERO     WAAQDT           Actual Departur
     C                     Z-ADD*ZERO     WAS6NB           Departure Time
     C                     Z-ADD*ZERO     WAT4NB           Schedule Sequen
     C                     Z-ADD*ZERO     WAPRTM           Product Tempera
     C                     Z-ADD*ZERO     WANPSV           Number Spacers
     C                     Z-ADD*ZERO     WATLMI           Total Load Mile
     C                     Z-ADD*ZERO     WAGRWE           Gross Weight
     C                     Z-ADD*ZERO     WAF9DT           Actual Ship Dat
     C                     Z-ADD*ZERO     WAJ4DT           Truck Ready Dat
     C                     Z-ADD*ZERO     WATRTM           Truck Ready Tim
     C                     Z-ADD*ZERO     WAJ5DT           Spotted Date
     C                     Z-ADD*ZERO     WASPTM           Spotted Time
     C                     Z-ADD*ZERO     WAJ6DT           Load Finished D
     C                     Z-ADD*ZERO     WALFTM           Load Finished T
     C                     Z-ADD*ZERO     WAJ7DT           BOL Complete Da
     C                     Z-ADD*ZERO     WABOTM           BOL Complete Ti
     C                     Z-ADD*ZERO     WAJ8DT           BOL Received Da
     C                     Z-ADD*ZERO     WABLTM           BOL Received Ti
     C                     Z-ADD*ZERO     WAKIDT           Truck Departure
     C                     Z-ADD*ZERO     WAASTM           Truck Departure
     C                     Z-ADD*ZERO     WAKADT           Adjusted Depart
     C                     Z-ADD*ZERO     WAAJCM           Adjusted Depart
     C                     Z-ADD*ZERO     WAVOAG           Voyage
     C                     Z-ADD*ZERO     WAKBDT           Sail Date
     C                     Z-ADD*ZERO     WAEFDT           Arrival Date
     C                     Z-ADD*ZERO     WAKCDT           Date In
     C                     Z-ADD*ZERO     WATMIN           Time In
     C                     Z-ADD*ZERO     WAKDDT           Date Out
     C                     Z-ADD*ZERO     WAVMNB           Time Out
     C                     Z-ADD*ZERO     WAOCFR           Load Total Frei
     C                     Z-ADD*ZERO     WAKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WAATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WABRBK           Bring Back Mile
     C                     Z-ADD*ZERO     WAEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WAKKDT           On Yard Date
     C                     Z-ADD*ZERO     WAAVTM           On Yard Time
     C                     Z-ADD*ZERO     WAKZDT           Deadline Depart
     C                     Z-ADD*ZERO     WAAXTM           Deadline Depart
     C                     Z-ADD*ZERO     WALLDT           Express Mail Da
     C                     Z-ADD*ZERO     WAK0DT           Product Complet
     C                     Z-ADD*ZERO     WAAYTM           Product Complet
     C                     Z-ADD*ZERO     WAKNNX           Pallets Loaded
     C                     Z-ADD*ZERO     WAICWG           Avg Pallet Tare
     C                     Z-ADD*ZERO     WAIDWG           Tot Pallet Tare
     C                     Z-ADD*ZERO     WAK1DT           Load Confirmati
     C                     Z-ADD*ZERO     WAAZTM           Load Door 1
     C                     Z-ADD*ZERO     WAK2DT           Override Total
     C                     Z-ADD*ZERO     WAA0TM           Load Door 2
     C                     Z-ADD*ZERO     WAZBVA           Load Actual Fre
     C                     Z-ADD*ZERO     WAPYDT           LH Carrier Paid
     C                     Z-ADD*ZERO     WACKTM           LH Carrier Paid
     C                     Z-ADD*ZERO     WAPZDT           LH Last Combo P
     C                     Z-ADD*ZERO     WACLTM           LH Last Combo P
     C                     Z-ADD*ZERO     WAP0DT           LPT Load Plan S
     C                     Z-ADD*ZERO     WACMTM           LPT Load Plan S
     C                     Z-ADD*ZERO     WAP1DT           TPM Planned Shi
     C                     Z-ADD*ZERO     WACNTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP2DT           LH Unused Date
     C                     Z-ADD*ZERO     WACOTM           LH Unused Time
     C                     Z-ADD*ZERO     WAP3DT           LH Unused Date
     C                     Z-ADD*ZERO     WACQTM           LH Unused Time
     C                     Z-ADD*ZERO     WAAATM           Job Time
     C                     Z-ADD*ZERO     WAAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WBRMNB           Load ID
     C                     Z-ADD*ZERO     WBRUNB           Stop/Drop Seque
     C                     Z-ADD*ZERO     WBRVNB           Stop/Drop
     C                     Z-ADD*ZERO     WBRWNB           Miles to next s
     C                     Z-ADD*ZERO     WBRXNB           Freight Charge
     C                     Z-ADD*ZERO     WBSQNB           Ld Hdr/Ld Dtl U
     C                     Z-ADD*ZERO     WBT0NB           Freight Misc. C
     C                     Z-ADD*ZERO     WBT1NB           Freight Stop Ch
     C                     Z-ADD*ZERO     WBR1NB           Rated Freight
     C                     Z-ADD*ZERO     WBAIC3           Company Number
     C                     Z-ADD*ZERO     WBC4NB           Order Number
     C                     Z-ADD*ZERO     WBKEDT           Estimated Arriv
     C                     Z-ADD*ZERO     WBSXNB           Estimated Arriv
     C                     Z-ADD*ZERO     WBKFDT           Appointment Con
     C                     Z-ADD*ZERO     WBACTM           Appointment Con
     C                     Z-ADD*ZERO     WBEJDT           Actual Delivery
     C                     Z-ADD*ZERO     WBAGTM           Actual Delivery
     C                     Z-ADD*ZERO     WBKJDT           Scheduled Deliv
     C                     Z-ADD*ZERO     WBATTM           Scheduled Deliv
     C                     Z-ADD*ZERO     WBHDDT           Deadline Depart
     C                     Z-ADD*ZERO     WBAUTM           Deadline Depart
     C                     Z-ADD*ZERO     WBKKDT           On Yard Date
     C                     Z-ADD*ZERO     WBAVTM           On Yard Time
     C                     Z-ADD*ZERO     WBZ4NB           MPC Number
     C                     Z-ADD*ZERO     WBN7DT           LD Carrier Appt
     C                     Z-ADD*ZERO     WBN8DT           LD Unused Date
     C                     Z-ADD*ZERO     WBN9DT           LD Unused Date
     C                     Z-ADD*ZERO     WBB3TM           LD Carrier Appt
     C                     Z-ADD*ZERO     WBB4TM           LD Unused Time
     C                     Z-ADD*ZERO     WBB5TM           LD Unused Time
     C                     Z-ADD*ZERO     WBAATM           Job Time
     C                     Z-ADD*ZERO     WBAXDT           Job Date
      * Define work field TXT field not needed
     C                     MOVEL*BLANK    WUG0TX 20
      * Define work field Numeric Field Not Needed
     C                     Z-ADD*ZERO     WUNFNN  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WCAIC3           Company Number
     C                     Z-ADD*ZERO     WCC4NB           Order Number
     C                     Z-ADD*ZERO     WCANC7           A/R Customer Nu
     C                     Z-ADD*ZERO     WCBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WCB0C7           Bill to Custome
     C                     Z-ADD*ZERO     WCA0DT           Order Date
     C                     Z-ADD*ZERO     WCA5DT           Requested Ship
     C                     Z-ADD*ZERO     WCGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WCACDT           Cancel Date
     C                     Z-ADD*ZERO     WCAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WCCXDT           Date of Origina
     C                     Z-ADD*ZERO     WCJZVA           Order Value Tot
     C                     Z-ADD*ZERO     WCA1WG           Order Weight To
     C                     Z-ADD*ZERO     WCEIDT           Requested Deliv
     C                     Z-ADD*ZERO     WCAFTM           Requested Deliv
     C                     Z-ADD*ZERO     WCRMNB           Load ID
     C                     Z-ADD*ZERO     WCTBNB           Absorbed Freigh
     C                     Z-ADD*ZERO     WCR1NB           Rated Freight
     C                     Z-ADD*ZERO     WCRNNB           Reefer Temperat
     C                     Z-ADD*ZERO     WCATIN           Attach to Invoi
     C                     Z-ADD*ZERO     WCRSRN           Resell Referenc
     C                     Z-ADD*ZERO     WCT3NB           Attach to Order
     C                     Z-ADD*ZERO     WCCONB           Invoice Number
     C                     Z-ADD*ZERO     WCAWDT           Invoice Date
     C                     Z-ADD*ZERO     WCVRVA           A/R order Value
     C                     Z-ADD*ZERO     WCB7VL           Invoice Order V
     C                     Z-ADD*ZERO     WCNODT           OH Appt Confirm
     C                     Z-ADD*ZERO     WCNPDT           JPN Invoice Iss
     C                     Z-ADD*ZERO     WCNQDT           Load Actual Shi
     C                     Z-ADD*ZERO     WCNRDT           Load BOL Comple
     C                     Z-ADD*ZERO     WCNSDT           Load Truck Depa
     C                     Z-ADD*ZERO     WCBPTM           Maximum Gross W
     C                     Z-ADD*ZERO     WCBQTM           Time of Origina
     C                     Z-ADD*ZERO     WCBRTM           OH Appt Confirm
     C                     Z-ADD*ZERO     WCBSTM           Load BOL Comple
     C                     Z-ADD*ZERO     WCBTTM           Load Truck Depa
     C                     Z-ADD*ZERO     WCH0NX           Act Frt Referen
     C                     Z-ADD*ZERO     WCH1NX           Act Non-Ref Frt
     C                     Z-ADD*ZERO     WCH2NX           OH Fuel Surchar
     C                     Z-ADD*ZERO     WCH3NX           OH Total Non-Re
     C                     Z-ADD*ZERO     WCH4NX           OH Total Ref Fr
     C                     Z-ADD*ZERO     WCC0C7           Claim Number
     C                     Z-ADD*ZERO     WCAATM           Job Time
     C                     Z-ADD*ZERO     WCAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WDAATM           Job Time
     C                     Z-ADD*ZERO     WDAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WEAIC3           Company Number
     C                     Z-ADD*ZERO     WEAATM           Job Time
     C                     Z-ADD*ZERO     WEAXDT           Job Date
      * Define work field Load Status
     C                     MOVEL*BLANK    WUPKST  1
      * Define work field Shipping Method
     C                     MOVEL*BLANK    WUQ2CD  2
      * Define work field Override Total Load Miles
     C                     Z-ADD*ZERO     WUK2DT  70
      * Define work field Total Miles
     C                     Z-ADD*ZERO     WUTKNB  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WFDBNB           Warehouse Chill
     C                     Z-ADD*ZERO     WFBWC3           Shipping Compan
     C                     Z-ADD*ZERO     WFBTC3           Accounting Comp
     C                     Z-ADD*ZERO     WFBUC3           WHS Sched Prod
     C                     Z-ADD*ZERO     WFBVC3           WHS Inventory C
     C                     Z-ADD*ZERO     WFAATM           Job Time
     C                     Z-ADD*ZERO     WFAXDT           Job Date
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WGFDNY           CFC Line/Stop N
     C                     Z-ADD*ZERO     WGFENY           CFC Charge Amou
     C                     Z-ADD*ZERO     WGQODT           CFC Effective D
     C                     Z-ADD*ZERO     WGFFNY           CFC Unused Amou
     C                     Z-ADD*ZERO     WGMJDT           Create Date
     C                     Z-ADD*ZERO     WGBETM           Create Time
     C                     Z-ADD*ZERO     WGMKDT           Change Date
     C                     Z-ADD*ZERO     WGBFTM           Change Time
      * Define work field Double Fuel Surcharge Sts
     C                     MOVEL*BLANK    WULUSX  1
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WHNMVA           Flat Rate
     C                     Z-ADD*ZERO     WHEPPR           Bulk Rate
     C                     Z-ADD*ZERO     WHEQPR           Export Fresh Fl
     C                     Z-ADD*ZERO     WHERPR           Export Frozen F
     C                     Z-ADD*ZERO     WHOQDT           CDR Unused Date
     C                     Z-ADD*ZERO     WHORDT           CDR Unused Date
     C                     Z-ADD*ZERO     WHGXVL           CDR Unused Amou
     C                     Z-ADD*ZERO     WHAATM           Job Time
     C                     Z-ADD*ZERO     WHAXDT           Job Date
      * Define work field Maximum Miles
     C                     Z-ADD*ZERO     WUMXML  70
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WKAIC3           Company Number
     C                     Z-ADD*ZERO     WKC4NB           Order Number
     C                     Z-ADD*ZERO     WKDXNB           Sequence Number
     C                     Z-ADD*ZERO     WKBSVA           Transaction Amo
     C                     Z-ADD*ZERO     WKSANB           Special Charge
     C                     Z-ADD*ZERO     WKCKNB           G/L Document Nu
     C                     Z-ADD*ZERO     WKAATM           Job Time
     C                     Z-ADD*ZERO     WKAXDT           Job Date
      * Define work field ZERO
     C                     Z-ADD*ZERO     WUW0NB 305
      * Define work field Rated Freight
     C                     Z-ADD*ZERO     WUR1NB 112
      * Define work field Adjustment Amount
     C                     Z-ADD*ZERO     WUAIVA 112
      * Initialize renamed input format fields
     C                     Z-ADD*ZERO     WVAIC3           Company Number
     C                     Z-ADD*ZERO     WVC4NB           Order Number
     C                     Z-ADD*ZERO     WVDPNB           Order Sequence
     C                     Z-ADD*ZERO     WVUENB           Order Secondary
     C                     Z-ADD*ZERO     WVHGCD           Item Code
     C                     Z-ADD*ZERO     WVBKC7           Ship To Custome
     C                     Z-ADD*ZERO     WVCFC7           Order Group Cod
     C                     Z-ADD*ZERO     WVMAVA           Billing Detail
     C                     Z-ADD*ZERO     WVKDVA           Billing Detail
     C                     Z-ADD*ZERO     WVL8VA           Billing Detail
     C                     Z-ADD*ZERO     WVL9VA           Quantity to Sub
     C                     Z-ADD*ZERO     WVAYVA           Extended Amount
     C                     Z-ADD*ZERO     WVEXDT           Market Pricing
     C                     Z-ADD*ZERO     WVBZPR           Price Overage O
     C                     Z-ADD*ZERO     WVL6NB           Contract Number
     C                     Z-ADD*ZERO     WVGIDT           Pricing Date Us
     C                     Z-ADD*ZERO     WVR1NB           Rated Freight
     C                     Z-ADD*ZERO     WVAVQT           Quantity Ordere
     C                     Z-ADD*ZERO     WVD0WG           Weight Ordered
     C                     Z-ADD*ZERO     WVCCQT           Quantity Schedu
     C                     Z-ADD*ZERO     WVAUWG           Weight Schedule
     C                     Z-ADD*ZERO     WVCBQT           Quantity Shippe
     C                     Z-ADD*ZERO     WVATWG           Weight Shipped
     C                     Z-ADD*ZERO     WVAQCS           Unit Cost Prici
     C                     Z-ADD*ZERO     WVAGCS           Unit Cost Per P
     C                     Z-ADD*ZERO     WVAKPR           Unit Price
     C                     Z-ADD*ZERO     WVALPR           Unit Price - Cr
     C                     Z-ADD*ZERO     WVAUPR           Unit Price Orde
     C                     Z-ADD*ZERO     WVAVWG           Unit Weight Ord
     C                     Z-ADD*ZERO     WVA4WG           Tare Weight Tot
     C                     Z-ADD*ZERO     WVA5DT           Requested Ship
     C                     Z-ADD*ZERO     WVAODT           Scheduled Ship
     C                     Z-ADD*ZERO     WVGNDT           Actual Shipped
     C                     Z-ADD*ZERO     WVRGNB           Item Structure
     C                     Z-ADD*ZERO     WVRHNB           Item Structure
     C                     Z-ADD*ZERO     WVRINB           Item Structure
     C                     Z-ADD*ZERO     WVCXDT           Date of Origina
     C                     Z-ADD*ZERO     WVDUPR           Invoice Unit Pr
     C                     Z-ADD*ZERO     WVB6VL           Invoice Extende
     C                     Z-ADD*ZERO     WVA1AA           Ham Group Numbe
     C                     Z-ADD*ZERO     WVNTDT           Warehouse Palle
     C                     Z-ADD*ZERO     WVNUDT           Consumed Item C
     C                     Z-ADD*ZERO     WVNVDT           Deadline Depart
     C                     Z-ADD*ZERO     WVNWDT           OD Price Type R
     C                     Z-ADD*ZERO     WVNXDT           OD Unused Date
     C                     Z-ADD*ZERO     WVBUTM           Deadline Depart
     C                     Z-ADD*ZERO     WVBVTM           Price Code
     C                     Z-ADD*ZERO     WVBWTM           Maximum Net Wei
     C                     Z-ADD*ZERO     WVBXTM           Substitution Li
     C                     Z-ADD*ZERO     WVBYTM           Max Qty to sche
     C                     Z-ADD*ZERO     WVH5NX           Warehouse Palle
     C                     Z-ADD*ZERO     WVH6NX           Warehouse Avg P
     C                     Z-ADD*ZERO     WVH7NX           OD Item Target
     C                     Z-ADD*ZERO     WVH8NX           OD Estimated Gr
     C                     Z-ADD*ZERO     WVH9NX           OD Maximum Unit
     C                     Z-ADD*ZERO     WVDVPR           Order Gate/Fina
     C                     Z-ADD*ZERO     WVDWPR           OD Ceiling Pric
     C                     Z-ADD*ZERO     WVDXPR           OD Gate/Final P
     C                     Z-ADD*ZERO     WVDYPR           OD Weighted Avg
     C                     Z-ADD*ZERO     WVDZPR           OD Unused Prc 5
     C                     Z-ADD*ZERO     WVGSPR           OD Unused Prc 6
     C                     Z-ADD*ZERO     WVGTPR           OD Unused Prc 7
     C                     Z-ADD*ZERO     WVGUPR           OD Unused Prc 8
     C                     Z-ADD*ZERO     WVPEWG           Weight Amount E
     C                     Z-ADD*ZERO     WVRINY           Item Age Days
     C                     Z-ADD*ZERO     WVTIDT           Production Ovr
     C                     Z-ADD*ZERO     WVTJDT           Production Ovr
     C                     Z-ADD*ZERO     WVTKDT           OD Market Begin
     C                     Z-ADD*ZERO     WVTLDT           OD Market Endin
     C                     Z-ADD*ZERO     WVTMDT           OD Atch to Ord
     C                     Z-ADD*ZERO     WVAATM           Job Time
     C                     Z-ADD*ZERO     WVAXDT           Job Date
      * Define work field USR Adjustment Amount 1
     C                     Z-ADD*ZERO     WUICVA 112
      * Define *Synon program work fields
     C                     Z-ADD*ZEROS    W0WD00 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WB   155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WC01 175       *Synon (17,5) w
     C                     Z-ADD*ZEROS    W0WB00 155       *Synon (15,5) w
     C                     Z-ADD*ZEROS    W0WD01 177       *Synon (17,7) w
     C                     Z-ADD*ZEROS    W0WC   175       *Synon (17,5) w
     C                     Z-ADD*ZEROS    W0WE   179       *Synon (17,9) w
     C                     Z-ADD*ZEROS    W0WD02 177       *Synon (17,7) w
      * Dummy move for compiler
     C                     MOVE '0'       @CN#,1
     C                     MOVEL'N'       W0PMT   1
      * Define local variables for subroutine SJRVGN.
     C                     MOVEL*BLANK    WL0001  3
     C                     MOVEL*BLANK    WL0002  3
     C                     MOVEL*BLANK    WL0003 20
     C                     MOVEL*BLANK    WL0004  2
     C                     Z-ADD*ZERO     WL0005 112
     C                     MOVEL*BLANK    WL0006  2
     C                     Z-ADD*ZERO     WL0007 114
     C                     Z-ADD*ZERO     WL0008 114
     C                     Z-ADD*ZERO     WL0009 114
     C                     MOVEL*BLANK    WL0010  1
      * Define local variables for subroutine SNRVGN.
     C                     Z-ADD*ZERO     WL0011  30
     C                     Z-ADD*ZERO     WL0012  70
     C                     Z-ADD*ZERO     WL0013 112
      * Define local variables for subroutine STCHRC.
     C                     Z-ADD*ZERO     WL0014  70
     C                     Z-ADD*ZERO     WL0015  50
     C                     Z-ADD*ZERO     WL0016  50
     C                     Z-ADD*ZERO     WL0017 112
     C                     Z-ADD*ZERO     WL0018  72
     C                     Z-ADD*ZERO     WL0019 112
      * Define local variables for subroutine SUCHRC.
     C                     Z-ADD*ZERO     WL0020  30
     C                     Z-ADD*ZERO     WL0021  70
     C                     Z-ADD*ZERO     WL0022 112
      * Define local variables for subroutine SYCHRC.
     C                     Z-ADD*ZERO     WL0023  30
     C                     Z-ADD*ZERO     WL0024  70
     C                     Z-ADD*ZERO     WL0025  30
     C                     Z-ADD*ZERO     WL0026  30
     C                     Z-ADD*ZERO     WL0027 112
      * Define local work field MG Created Load
     C                     MOVEL*BLANK    YL0001  1
      * Define null work field Ship To Customer
     C                     Z-ADD*ZERO     YN0001  70
      * Define null work field Ship To Name
     C                     MOVEL*BLANK    YN0002 30
      * Define null work field Ship To Address Line 1
     C                     MOVEL*BLANK    YN0003 30
      * Define null work field Ship To Address Line 2
     C                     MOVEL*BLANK    YN0004 30
      * Define null work field Ship To Address Line 3
     C                     MOVEL*BLANK    YN0005 30
      * Define null work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YN0006 11
      * Define null work field Salesperson Name
     C                     MOVEL*BLANK    YN0007 30
      * Define local work field Sales Route Code
     C                     MOVEL*BLANK    YL0002  3
      * Define local work field Salesperson Code
     C                     MOVEL*BLANK    YL0003  3
      * Define local work field Scheduled Ship Date
     C                     Z-ADD*ZERO     YL0004  70
      * Define null work field Ship To State Code
     C                     MOVEL*BLANK    YN0008  2
      * Define null work field Shipping Line
     C                     MOVEL*BLANK    YN0009  3
      * Define null work field Port Delv Terminal
     C                     MOVEL*BLANK    YN0010 20
      * Define null work field Discharge Port
     C                     MOVEL*BLANK    YN0011 20
      * Define local work field Order Number
     C                     Z-ADD*ZERO     YL0005  70
      * Define local work field Ship To Customer
     C                     Z-ADD*ZERO     YL0006  70
      * Define local work field Ship To Name
     C                     MOVEL*BLANK    YL0007 30
      * Define local work field Ship To Address Line 1
     C                     MOVEL*BLANK    YL0008 30
      * Define local work field Ship To Address Line 2
     C                     MOVEL*BLANK    YL0009 30
      * Define local work field Ship To Address Line 3
     C                     MOVEL*BLANK    YL0010 30
      * Define local work field Ship To City
     C                     MOVEL*BLANK    YL0011 20
      * Define local work field Ship To State Code
     C                     MOVEL*BLANK    YL0012  2
      * Define local work field Ship To Zip/Postal Code
     C                     MOVEL*BLANK    YL0013 11
      * Define local work field Carrier Code
     C                     MOVEL*BLANK    YL0014  3
      * Define local work field Export Status
     C                     MOVEL*BLANK    YL0015  1
      * Define local work field Export Docs Go w/Driver
     C                     MOVEL*BLANK    YL0016  1
      * Define local work field Air Freight Order
     C                     MOVEL*BLANK    YL0017  1
      * Define local work field Export USDA Approved
     C                     MOVEL*BLANK    YL0018  2
      * Define local work field Company Number
     C                     Z-ADD*ZERO     YL0019  30
      * Define local work field Stop/Drop Sequence Number
     C                     Z-ADD*ZERO     YL0020  50
      * Define local work field OHE City
     C                     MOVEL*BLANK    YL0021 25
      * Define local work field OHE Vessel/Airline
     C                     MOVEL*BLANK    YL0022 30
      * Define local work field OHE Voyage/Flight
     C                     MOVEL*BLANK    YL0023 15
      * Define local work field OHE Booking Number
     C                     MOVEL*BLANK    YL0024 15
      * Define local work field OHE Discharge Port/Airprt
     C                     MOVEL*BLANK    YL0025 20
      * Define local work field OHE Sail/Flight Date
     C                     Z-ADD*ZERO     YL0026  70
      * Define local work field OHE Port Cut Date
     C                     Z-ADD*ZERO     YL0027  70
      * Define local work field OHE Arrival Date
     C                     Z-ADD*ZERO     YL0028  70
      * Define local work field OHE Late Delivery Code
     C                     MOVEL*BLANK    YL0029  3
      * Define local work field OHE Ship Status
     C                     MOVEL*BLANK    YL0030  1
      * Define local work field OHE Container Number
     C                     MOVEL*BLANK    YL0031 12
      * Define local work field OHE Comment 1
     C                     MOVEL*BLANK    YL0032 35
      * Define local work field OHE Comment 2
     C                     MOVEL*BLANK    YL0033 75
      * Define local work field Port City
     C                     MOVEL*BLANK    YL0034 25
      * Define local work field Port Address Line 1
     C                     MOVEL*BLANK    YL0035 25
      * Define local work field Port Address Line 2
     C                     MOVEL*BLANK    YL0036 25
      * Define local work field Sail Port State
     C                     MOVEL*BLANK    YL0037  2
      * Define local work field Port Zip/Postal Code
     C                     MOVEL*BLANK    YL0038 11
      * Define local work field Port Phone Number
     C                     Z-ADD*ZERO     YL0039 110
      * Define local work field Port Fax Number
     C                     MOVEL*BLANK    YL0040 25
      * Define local work field Warehouse Type
     C                     MOVEL*BLANK    YL0041  2
      * Define local work field CFC Charge Amount
     C                     Z-ADD*ZERO     YL0042 112
      * Define local work field CFC Unit of Measure
     C                     MOVEL*BLANK    YL0043  2
      * Define local work field Destination City
     C                     MOVEL*BLANK    YL0044 20
      * Define local work field Flat Rate
     C                     Z-ADD*ZERO     YL0045 112
      * Define local work field CDR Unit of Measure
     C                     MOVEL*BLANK    YL0046  2
      * Define local work field Freight Rate USR
     C                     Z-ADD*ZERO     YL0047  94
      * Define local work field Double Fuel Surcharge Sts
     C                     MOVEL*BLANK    YL0048  1
      * Define local work field Shipping Company
     C                     Z-ADD*ZERO     YL0049  30
      *================================================================
     CSR         ZZEXIT    ENDSR
** @CN
00001 Y2U0005
