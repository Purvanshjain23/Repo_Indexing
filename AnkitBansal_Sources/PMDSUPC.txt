/********************************************************************/
/*                                                                  */
/*  SYNOPSIS -  JOB CONTROL PROMPT FOR PRINTER OVERRIDE INFORMATION */
/*              GENERIC PROMPTING FUNCTION USED BY ANY PROGRAM      */
/*              NEEDING PRINTER OVERRIDE PROMPTING AND PASSING      */
/*              COMPANY NO AND DATES.                               */
/*                                                                  */
/*  SYSTEM    - TRAFFIC SYSTEM                                      */
/*  PROGRAM   - PRT EXCESS FRT CHG CL   (CLP) PMDSUPC               */
/*              SUBMITS PMDUUPC WHICH CALLS:                        */
/*                PMDVPFR FOR REPORT BY SALESPERSON                 */
/*                PMDZPFR FOR REPORT BY CARRIER CODE                */
/*                PMPHPFR FOR REPORT BY CARRIER CODE       11/12/07 */
/*              THIS PROGRAM IS CALLED FROM AN RPG PROGRAM          */
/*                                                                  */
/*  DATE      - 01/31/2007                                          */
/*  PROGRAMMER- LARA BUSER                                          */
/*                                                                  */
/*      PARAMETERS:                                                 */
/*                                                                  */
/*     O    &RETURN     - RETURN CODE                               */
/*     I    &APPLIC     - APPLICATION CODE                          */
/*     I    &COMPNYN    - COMPANY NUMBER                            */
/*     I    &FRDATE     - FROM DATE                                 */
/*     I    &TODATE     - TO DATE                                   */
/*     B    &COPYN      - NO. OF COPIES 15.5                        */
/*     I    &DESC       - DESCRIPTION (FOR PROMPT SCREEN)           */
/*     B    &OUTQ       - OUTPUT QUEUE                              */
/*     B    &HOLD       - HOLD STATUS                               */
/*     B    &SAVE       - SAVE STATUS                               */
/*     B    &NQSTAT     - INDICATOR WHETHER MUST RUN IN NIGHT Q     */
/*     B    &NIGHTQ     - NIGHT JOB QUEUE                           */
/*     I    &FRTCODE    - FREIGHT CODE                              */
/*     I    &EMAIL      - EMAIL ADDRESS                             */
/*     I    &EMAILFMT   - EMAIL FORMAT                              */
/*     I    &SLSPRSN    - SALESPERSON CODE                          */
/*     I    &CARRIER    - CARRIER CODE                              */
/*     I    &SHIPTON    - CUSTOMER NUMBER                           */
/*     I    &WHSE1      - WAREHOUSE 1                               */
/*     I    &WHSE2      - WAREHOUSE 2                               */
/*     I    &WHSE3      - WAREHOUSE 3                               */
/*     I    &WHSE4      - WAREHOUSE 4                               */
/*     I    &WHSE5      - WAREHOUSE 5                               */
/*     I    &WHSE6      - WAREHOUSE 6                               */
/*     I    &WHSE7      - WAREHOUSE 7                               */
/*     I    &WHSE8      - WAREHOUSE 8                               */
/*     I    &WHSE9      - WAREHOUSE 9                               */
/*     I    &WHSE10     - WAREHOUSE 10                              */
/*     I    &SOFLAG     - SELECT/OMIT                               */
/*     I    &RPTTYP     - REPORT TYPE                               */
/********************************************************************/
/*                       MODIFICATIONS                              */
/*------------------------------------------------------------------*/
/* LJB 11/12/2007 FT381                                             */
/*     ADD CUSTOMER# AS AN INPUT PARM FOR NEW PROGRAM (SHIP TO)     */
/* LJB 05/19/2008 FP1225                                            */
/*     ADD PARENT CUSTOMER NUMBER AS AN INPUT PARM FOR NEW PROGRAM  */
/* LJB 04/13/2009 E00384                                            */
/*     ADD 10 WAREHOUSE CODES AND SELECT/OMIT FLAG FOR NEW PROGRAM  */
/*     ADD WAREHOUSE CODES AND SELECT OMIT FLAG TO EXISTING         */
/*     PROGRAMS AS WELL.                                            */
/********************************************************************/
 PMDSUPC:    PGM        PARM(&RETURN &DESC &OUTQ &HOLD &SAVE &NQSTAT +
                          &NIGHTQ &COMPNYN &PARENTN &FRDATE &TODATE +
                          &COPYN &SHIPTON &FRTCODE &CARRIER +
                          &SLSPRSN &FRTGRP &WHSE1 &WHSE2 &WHSE3 +
                          &WHSE4 &WHSE5 &WHSE6 &WHSE7 &WHSE8 &WHSE9 +
                          &WHSE10 &SOFLAG &RPTTYP &EMAILFMT &EMAIL)
/* PARMS                                                                      */
        DCL    &RETURN     *CHAR   (7)  /* RETURN CODE               */
        DCL    &DESC       *CHAR   (25) /* PRT PGM DESCRIPTION       */
        DCL    &OUTQ       *CHAR   (10) /* OUTPUT QUEUE              */
        DCL    &HOLD       *CHAR   (4)  /* HOLD STATUS               */
        DCL    &SAVE       *CHAR   (4)  /* SAVE STATUS               */
        DCL    &NQSTAT     *CHAR   (01) /* IF MUST RUN IN NIGHT Q    */
        DCL    &NIGHTQ     *CHAR   (10) /* NIGHT JOB QUEUE           */
        DCL    &COMPNYN    *DEC         /* COMPANY NUMBER (PASSED)   */
        DCL    &FRDATE     *DEC         /* FROM DATE (PASSED)        */
        DCL    &TODATE     *DEC         /* TO DATE (PASSED)          */
        DCL    &COPYN      *DEC         /* NO. OF COPIES             */
        DCL    &CARRIER    *CHAR   (3)  /* CARRIER CODE              */
        DCL    &SHIPTON    *DEC         /* CUSTOMER NUMBER           */
        DCL    &PARENTN    *DEC         /* PARENT CUSTOMER NUMBER    */
        DCL    &SLSPRSN    *CHAR   (3)  /* SALES PERSON CODE         */
        DCL    &FRTCODE    *CHAR   (6)  /* FREIGHT CHARGE CODE       */
        DCL    &EMAIL      *CHAR   (50) /* EMAIL ADDRESS             */
        DCL    &EMAILFMT   *CHAR   (5)  /* EMAIL FORMAT              */
        DCL    &APPLIC     *CHAR   (6)  /* APPLICATION               */
        DCL    &FRTGRP     *CHAR   (6)  /* FREIGHT GROUP             */
        DCL    &WHSE1      *CHAR   (3)  /* WAREHOUSE 1               */
        DCL    &WHSE2      *CHAR   (3)  /* WAREHOUSE 2               */
        DCL    &WHSE3      *CHAR   (3)  /* WAREHOUSE 3               */
        DCL    &WHSE4      *CHAR   (3)  /* WAREHOUSE 4               */
        DCL    &WHSE5      *CHAR   (3)  /* WAREHOUSE 5               */
        DCL    &WHSE6      *CHAR   (3)  /* WAREHOUSE 6               */
        DCL    &WHSE7      *CHAR   (3)  /* WAREHOUSE 7               */
        DCL    &WHSE8      *CHAR   (3)  /* WAREHOUSE 8               */
        DCL    &WHSE9      *CHAR   (3)  /* WAREHOUSE 9               */
        DCL    &WHSE10     *CHAR   (3)  /* WAREHOUSE 10              */
        DCL    &SOFLAG     *CHAR   (1)  /* SELECT/OMIT FLAG          */
        DCL    &RPTTYP     *CHAR   (1)  /* REPORT TYPE (1-4)         */

/* INTERNAL FIELDS                                                   */
        DCL    &COPY       *DEC    (2 0)/* NUMBER OF COPIES          */

/* ERROR MESSAGE FIELDS                                                       */
        DCL    &MSG        *CHAR   (512)         /* message                   */
        DCL    &MSGID      *CHAR   (7)           /* message id                */
        DCL    &MSGL       *DEC    (5 0)

/********************************************************************/
/*   INITIALIZE VARIABLES                                           */
/********************************************************************/
             CHGVAR     VAR(&RETURN) VALUE('       ')
             CHGVAR     VAR(&COPY) VALUE(&COPYN)
             CHGVAR     VAR(&APPLIC) VALUE('TRF')

/********************************************************************/
/*   MONITOR FOR ALL MESSAGES AT PROGRAM LEVEL                      */
/********************************************************************/
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(MSGTRAP))

/********************************************************************/
/*   CALL PRINT PROMPT PROGRAM                                      */
/********************************************************************/
             CALL       PGM(PDG0PVR) PARM(&RETURN &DESC &OUTQ &HOLD +
                          &SAVE &COPY &NQSTAT &NIGHTQ &APPLIC)
             CHGVAR     VAR(&COPYN) VALUE(&COPY)
             IF         COND(&RETURN *NE ' ') THEN(GOTO +
                          CMDLBL(USERQUIT))

/********************************************************************/
/*   SUBMIT PRINT CL PROGRAM                                        */
/********************************************************************/
/* >>>>> USE FOR TESTING ONLY     <<<<<<<<<< */
/* >>>>>     CALL       PGM(PMDUUPC) PARM(&RETURN &DESC &OUTQ &HOLD +
                          &SAVE &NQSTAT &NIGHTQ &COMPNYN &FRDATE +
                          &TODATE &COPYN &CARRIER &SLSPRSN &SHIPTON +
                          &PARENTN &FRTCODE &FRTGRP &WHSE1 &WHSE2 +
                          &WHSE3 &WHSE4 &WHSE5 &WHSE6 &WHSE7 &WHSE8 +
                          &WHSE9 &WHSE10 &SOFLAG &RPTTYP &EMAILFMT +
                          &EMAIL)                      <<<<<<<<<< */

             SBMJOB     CMD(CALL PGM(PMDUUPC) PARM(&RETURN &DESC +
                          &OUTQ &HOLD &SAVE &NQSTAT &NIGHTQ +
                          &COMPNYN &FRDATE &TODATE &COPYN &CARRIER +
                          &SLSPRSN &SHIPTON &PARENTN &FRTCODE +
                          &FRTGRP &WHSE1 &WHSE2 &WHSE3 &WHSE4 +
                          &WHSE5 &WHSE6 &WHSE7 &WHSE8 &WHSE9 +
                          &WHSE10 &SOFLAG &RPTTYP &EMAILFMT +
                          &EMAIL)) JOB(EXCSSFRT)

             GOTO       CMDLBL(END)

/*-------------------------USER QUIT--------------------------------*/
 USERQUIT:   CHGVAR     VAR(&RETURN) VALUE('Y2U0005')
             GOTO       CMDLBL(END)

/*----------------------RECEIVE MESSAGES----------------------------*/
 MSGTRAP:    RCVMSG     MSGTYPE(*EXCP) MSGDTA(&MSG) MSGDTALEN(&MSGL) +
                          MSGID(&MSGID)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

             SNDPGMMSG  MSGID(&MSGID) MSGF(QCPFMSG) MSGDTA(%SST(&MSG +
                          1 &MSGL)) MSGTYPE(*ESCAPE)
             MONMSG     MSGID(CPF0000) EXEC(GOTO CMDLBL(END))

 END:        ENDPGM
